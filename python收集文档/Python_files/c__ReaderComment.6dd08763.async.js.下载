/*! For license information please see c__ReaderComment.6dd08763.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1282,588,667,802,902,1157,1243,1281,1288,1540],{1003:function(e,t,n){var r=n(568),o=n(213),i=n(262),a=n(76),c=n(190),u=n(263),l=n(265),s=n(365),f=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(c(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||s(e)||i(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!r(e).length;for(var n in e)if(f.call(e,n))return!1;return!0}},1212:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(){return o(Object(r.useReducer)((function(e){return e+1}),0),2)[1]}},1329:function(e,t,n){"use strict";n.r(t);n(581);var r=n(301),o=(n(489),n(98)),i=(n(42),n(9)),a=n(0),c=n.n(a),u=n(2),l=n.n(u),s=n(5),f=n.n(s),p=n(45),m=n(57),d=n(23),y=n(1452),h=n(24),b="index-module_belongs_A3uam",v="index-module_meta_Jn6WP",g="index-module_truncation_g-6vp";function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===w(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S={};S.Login=function(e){var t,n=e.goto,r=e.registerWithScene,o=n?"/login?goto=".concat(encodeURIComponent(n)):"/login",u=null===(t=document.querySelector('meta[name="pagename"]'))||void 0===t?void 0:t.getAttribute("content"),l=m.a.genCreateFromKey(d.CREATE_FROM.official_website_top_button);return r&&(o="/"===window.location.pathname||"/about"===window.location.pathname?"/login?register_with_scene=true&defaultType=org&register_from=".concat(l):"/login?register_with_scene=true&register_from=".concat(l)),Object(a.useEffect)((function(){Object(y.b)()}),[]),c.a.createElement(c.a.Fragment,null,"doc_read"===u?c.a.createElement(i.a,{onClick:function(e){h.g&&(e.preventDefault(),e.stopPropagation(),window.YuqueDesktopAppJSBridge.logout())},href:o,size:e.size,type:"primary","data-aspm-click":"d65962"},__("免费使用")):c.a.createElement(i.a,{onClick:function(e){h.g&&(e.preventDefault(),e.stopPropagation(),window.YuqueDesktopAppJSBridge.logout())},href:o,size:e.size,type:"primary","data-aspm-click":"d65962"},__("登录 / 注册")))},S.Login.propTypes={size:l.a.oneOf(["small","large"]),goto:l.a.string},S.Job=function(e){var t=e.user,n=e.truncation;if(t)return c.a.createElement("span",{className:f()(v,O({},g,n))},c.a.createElement(p.b,{name:"user-job",width:16,height:16}),c.a.createElement("span",null,t.job_title||__("未填写")))},S.Job.propTypes={user:l.a.object.isRequired,truncation:l.a.bool},S.Location=function(e){var t=e.user,n=e.truncation,r=e.size,o=void 0===r?16:r;return t=t||{},c.a.createElement("span",{className:f()(v,O({},g,n))},c.a.createElement(p.b,{name:"user-location",width:o,height:o}),c.a.createElement("span",null,t.location||__("未填写")))},S.Location.propTypes={size:l.a.object.number,user:l.a.object.isRequired,truncation:l.a.bool},S.Department=function(e){var t,n=e.user,r=e.truncation;if(n)return c.a.createElement("div",null,null!==(t=n.departments)&&void 0!==t&&t.length?n.departments.map((function(e){return c.a.createElement("span",{className:f()(v,O({},g,r))},c.a.createElement(p.b,{name:"department",width:16,height:16}),c.a.createElement("span",null,e))})):c.a.createElement("span",{className:f()(v,O({},g,r))},c.a.createElement(p.b,{name:"department",width:16,height:16}),c.a.createElement("span",null,n.department||__("未填写"))))},S.Department.propTypes={user:l.a.object.isRequired,truncation:l.a.bool},S.Link=function(e){var t=e.user,n=e.className;return c.a.createElement("a",{href:"/".concat(t.login),title:t.name,className:n},t.name)},S.Link.propTypes={user:l.a.object.isRequired,className:l.a.string},S.Name=function(e){var t=e.user,n=e.className;return c.a.createElement("span",{title:t.name,className:n},t.name)},S.Name.propTypes={user:l.a.object.isRequired,className:l.a.string};var j=function(e){var t=e.belongs,n=e.onChange,i=_(Object(a.useState)(__("管理员")),2),u=i[0],l=i[1];return c.a.createElement(r.a,{trigger:["click"],overlay:c.a.createElement(o.a,{className:"dashboard-dropdown-menu",selectedKeys:[]},t.map((function(e,t){return c.a.createElement(o.a.Item,{key:e.type},c.a.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),function(e){n(e.type),l(e.text)}(e)}},e.text))})))},c.a.createElement("span",null,u,c.a.createElement("span",{className:f()("larkicon","larkicon-arrow-down",b)})))};j.propTypes={belongs:l.a.array.isRequired,onChange:l.a.func.isRequired},S.BelongMenu=j;t.default=S},1452:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return f}));var r=n(198),o="new_session",i="register",a="register/source",c=["attachments","dashboard","feedbacks","assets","office","video","oauth2","notifications"];function u(){var e=new URLSearchParams(window.location.search),t=e.get("source");if(t)return t;var n=e.get("goto");if(null!=n&&n.length){var o=null==n?void 0:n.match(/(^|&|\?)source=([^&]*)(&|$)/);if(null!=o&&o[2])return null==o?void 0:o[2]}var i=r.a.get(a);if(i)return i;var c,u=(window.Tracert||{})._refSpm,l=(c=u)&&c.split(".")[1];return l||null}function l(e){var t,n=e||(null===(t=document.querySelector('meta[name="pagename"]'))||void 0===t?void 0:t.getAttribute("content"));n&&([o,i].includes(n)||r.a.set(a,n))}function s(e){"complete"===document.readyState?l(e):window.addEventListener("load",(function(){l(e)}))}function f(){var e,t,n=u();if(n)return s(n);if(null===(e=window.appData)||void 0===e||null===(t=e.organization)||void 0===t?void 0:t.id)return s("org");var r=new URLSearchParams(window.location.search).get("goto");if(r){r.startsWith("/")&&(r=window.location.origin+r);var o=new URL(r).pathname;if(o){var i=o.split("/");if(i.length>1&&""===i[0]&&i.shift(),null==i||!i.length)return;if(["g","r"].includes(i[0]))return;if(c.includes(i[0]))return s(i[0]);if(2===i.length||3===i.length)return s("doc_read")}}}},1492:function(e,t,n){var r=n(306),o=n(504),i=n(1200),a=Math.ceil,c=Math.max;e.exports=function(e,t,n){t=(n?o(e,t,n):void 0===t)?1:c(i(t),0);var u=null==e?0:e.length;if(!u||t<1)return[];for(var l=0,s=0,f=Array(a(u/t));l<u;)f[s++]=r(e,l,l+=t);return f}},1617:function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},1623:function(e,t,n){"use strict";n.r(t);var r=n(0);t.default=e=>r.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-arrow-right",e.className].filter(Boolean).join(" ")}),r.createElement("path",{d:"M101.005 198.563c-3.834-3.834-3.904-10.008-.21-13.927l.21-.215 48.99-48.99c3.834-3.834 3.904-10.008.21-13.927l-.21-.215-48.99-48.99c-3.905-3.905-3.905-10.237 0-14.142 3.834-3.834 10.008-3.904 13.927-.21l.215.21 48.99 48.99c11.599 11.598 11.715 30.331.348 42.072l-.348.354-48.99 48.99c-3.905 3.905-10.237 3.905-14.142 0Z",fill:"currentColor",fillRule:"nonzero"}))},1624:function(e,t,n){"use strict";n.r(t);var r=n(0);t.default=e=>r.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-help-search",e.className].filter(Boolean).join(" ")}),r.createElement("path",{d:"M114 20c51.362 0 93 41.638 93 93 0 21.782-7.489 41.816-20.032 57.666l45.82 46.277c4.275 4.317 4.24 11.282-.077 15.556-4.317 4.275-11.281 4.24-15.556-.077l-45.774-46.23C155.576 198.602 135.652 206 114 206c-51.362 0-93-41.638-93-93s41.638-93 93-93Zm0 20c-40.317 0-73 32.683-73 73s32.683 73 73 73 73-32.683 73-73-32.683-73-73-73Z",fill:"currentColor",fillRule:"nonzero"}))},1724:function(e,t,n){"use strict";n.r(t);var r=n(0);t.default=e=>r.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 17",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-icon-nolable",e.className].filter(Boolean).join(" ")}),r.createElement("path",{d:"m3.779 5.94.884.885-1.177 1.177a1.253 1.253 0 0 0 0 1.77l2.941 2.94.12.106a1.249 1.249 0 0 0 1.6-.061l.012-.01 1.213-1.214.884.884-1.158 1.158-.15.143a2.499 2.499 0 0 1-3.405-.123l-2.94-2.94A2.503 2.503 0 0 1 2.6 7.119l1.178-1.178Zm.078-2.183a.6.6 0 0 1 .849 0l7.637 7.637a.6.6 0 1 1-.849.849L3.857 4.606a.6.6 0 0 1 0-.849Zm5.208-2.044.183.009L12.557 2a1.875 1.875 0 0 1 1.714 1.743l.216 3.23.005.227a2.5 2.5 0 0 1-.731 1.707l-1.244 1.246-.883-.883 1.243-1.246a1.25 1.25 0 0 0 .362-.967l-.216-3.23a.625.625 0 0 0-.57-.582l-3.31-.278-.137-.004a1.25 1.25 0 0 0-.852.366l-1.23 1.232-.883-.884L7.27 2.446a2.5 2.5 0 0 1 1.978-.724Zm1.591 2.662a.969.969 0 1 1 0 1.937.969.969 0 0 1 0-1.937Z",fill:"#585A5A",fillRule:"nonzero"}))},1725:function(e,t,n){"use strict";n.r(t);var r=n(0);t.default=e=>r.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{className:["larkui-icon","larkui-icon-insert-doc",e.className].filter(Boolean).join(" ")}),r.createElement("defs",null,r.createElement("path",{id:"58591898a",d:"M0 0h256v256H0z"})),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("mask",{id:"58591898b",fill:"#fff"},r.createElement("use",{xlinkHref:"#58591898a"})),r.createElement("g",{mask:"url(#58591898b)"},r.createElement("path",{d:"M17 25h222v222H17z"}),r.createElement("path",{d:"M218 212c1.657 0 3.157.672 4.243 1.757A5.981 5.981 0 0 1 224 218a5.981 5.981 0 0 1-1.757 4.243A5.981 5.981 0 0 1 218 224H38a5.981 5.981 0 0 1-4.243-1.757A5.981 5.981 0 0 1 32 218c0-1.657.672-3.157 1.757-4.243A5.981 5.981 0 0 1 38 212ZM129.365 75.746l.312.012a6.967 6.967 0 0 1 4.267 1.79l1.033 1.163a6.986 6.986 0 0 1 1.265 4.456 6.967 6.967 0 0 1-1.861 4.345L99.919 122H218c1.657 0 3.157.672 4.243 1.757A5.981 5.981 0 0 1 224 128a5.981 5.981 0 0 1-1.757 4.243A5.981 5.981 0 0 1 218 134H99.91l34.19 34.201.863.999a6.988 6.988 0 0 1 1.272 4.579 6.97 6.97 0 0 1-2.03 4.426 6.977 6.977 0 0 1-4.848 2.05 6.976 6.976 0 0 1-4.868-1.873l-45.335-45.329-.862-.998a6.986 6.986 0 0 1-1.28-4.477 6.967 6.967 0 0 1 1.862-4.345L124.202 77.9l.998-.862a6.986 6.986 0 0 1 4.477-1.28ZM218 32c1.657 0 3.157.672 4.243 1.757A5.981 5.981 0 0 1 224 38a5.981 5.981 0 0 1-1.757 4.243A5.981 5.981 0 0 1 218 44H38a5.981 5.981 0 0 1-4.243-1.757A5.981 5.981 0 0 1 32 38c0-1.657.672-3.157 1.757-4.243A5.981 5.981 0 0 1 38 32Z",stroke:"#096DD9",strokeWidth:8,fill:"#096DD9"}))))},1726:function(e,t,n){"use strict";n.r(t),n.d(t,"getFileAccept",(function(){return _})),n.d(t,"getImageAccept",(function(){return E})),n.d(t,"EmbedButtonStatus",(function(){return O})),n.d(t,"getIsDiabledPreviewAndEmbed",(function(){return S})),n.d(t,"getLocalDocAcceptArr",(function(){return j})),n.d(t,"getFileAcceptArr",(function(){return T})),n.d(t,"getImageAcceptArr",(function(){return C})),n.d(t,"getVideoAcceptArr",(function(){return P})),n.d(t,"getAudioAcceptArr",(function(){return R}));var r=n(345),o=n(585),i=r.a.LOCAL_DOC_EXT,a=r.a.LOCAL_DOC_EXT_NORMAL,c=r.a.LOCAL_DOC_EXT_PAID,u=r.a.FILE_EXT,l=r.a.FILE_EXT_NORMAL,s=r.a.FILE_EXT_PAID,f=r.a.IMAGE_EXT,p=r.a.IMAGE_EXT_NORMAL,m=r.a.IMAGE_EXT_PAID,d=r.a.VIDEO_EXT,y=r.a.VIDEO_EXT_NORMAL,h=r.a.VIDEO_EXT_PAID,b=r.a.AUDIO_EXT,v=r.a.AUDIO_EXT_NORMAL,g=r.a.AUDIO_EXT_PAID,w=function(){var e="undefined"!=typeof navigator?navigator.userAgent:"";return/android/i.test(e)};function _(){return w()?"*/*":(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?s.join(","):l.join(","):u.join(",")}function E(){return w()?"image/*":(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?m.join(","):p.join(","):f.join(",")}var O={NORMAL:0,DISABLE:1,PREVENT:2};function S(){return!(window.appData||{}).isYuque||Object(o.isPaidCheckAll)()?O.NORMAL:O.PREVENT}function j(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?c:a:i}function T(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?s:l:u}function C(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?m:p:f}function P(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?h:y:d}function R(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?g:v:b}},281:function(e,t,n){"use strict";n(1497);var r=n(800);n(790);t.a=r.a},3317:function(e,t,n){"use strict";n.r(t),n.d(t,"isDesktopApp",(function(){return y})),n.d(t,"isYuque",(function(){return h})),n.d(t,"isDev",(function(){return b})),n.d(t,"isWin",(function(){return v})),n.d(t,"myNotesConsts",(function(){return g})),n.d(t,"getFilterBarConfig",(function(){return w})),n.d(t,"downloadFileHandler",(function(){return _}));var r=n(464);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=window,c=a.appData,u=a.navigator,l=c||{},s=l.env,f=l.me,p=void 0===f?{}:f,m="note/pinned/show/".concat(p.id),d="note/order/".concat(p.id),y=c.isDesktopApp,h=c.isYuque,b="local"===s,v="win32"===u.platform.toLowerCase(),g={NOTE_ORDER_KEY:d,NOTE_PINNED_SHOW_KEY:m,NOTE_ITEM_CONTENT_MIN_HEIGHT:214,NOTE_LIST_VIEW_MODES:{lite:"lite",full:"full"},COLLAPSE_BTN_CLASS:"note-item-collapse",SUBMIT_BTN_CLASS:"note-item-submit",NOTE_LIST_ITEM_CLASS:"note-list-item",NOTE_LIST_READ_TAG_ADD_CLASS:"note-list-item-read-tag-add"},w=function(){var e,t;return h?(i(e={},r.FILTER_TYPES.image,__("图片")),i(e,r.FILTER_TYPES.bookmark,__("书签")),i(e,r.FILTER_TYPES.attachment,__("附件")),i(e,r.FILTER_TYPES.wechatRobot,__("来自微信")),i(e,r.FILTER_TYPES.yuqueChromeExtension,__("来自插件")),i(e,r.FILTER_TYPES.share,__("分享中")),e):(i(t={},r.FILTER_TYPES.image,__("图片")),i(t,r.FILTER_TYPES.bookmark,__("书签")),i(t,r.FILTER_TYPES.attachment,__("附件")),i(t,r.FILTER_TYPES.dingTalkRobot,__("来自钉钉")),i(t,r.FILTER_TYPES.share,__("分享中")),t)},_=function(e,t){var n=new URL(e);n.searchParams.append("yuque-desktop-download",""),t&&n.searchParams.append("filename",encodeURIComponent(t)),fetch(n.toString())}},3324:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(65),a=n.n(i),c=n(212),u=n.n(c),l=n(80),s=n.n(l),f=n(3339),p=n.n(f),m=n(3492),d=n(1726),y=n(3196),h=n(108),b=n(3489),v=n.n(b),g=n(3490),w=n.n(g),_=n(3482),E=n.n(_),O=n(3491),S=n(348),j=n(154),T=n(198),C=n(51);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===P(i)?i:String(i)),r)}var o,i}var k,L=a()("editor:cache"),A=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t}var t,n,r;return t=e,(n=[{key:"retrieve",value:function(){var e={format:null,value:null};L("[retrieve]key: ",this.key);var t=T.a.get(this.key);if(!t)return null;L("[retrieve]find text: ",t);var n=p.a.guessFormat(t);return e.format=n,e.value=t,L("[retrieve]doc: ",e),e}},{key:"put",value:function(e,t){L("[put]content cached: ","".concat(this.key," -> ").concat(e)),T.a.set(this.key,e)}},{key:"clear",value:function(){T.a.remove(this.key)}}])&&R(t.prototype,n),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function N(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(){I=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==x(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(x(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function M(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){M(i,r,o,a,c,"next",e)}function c(e){M(i,r,o,a,c,"throw",e)}a(void 0)}))}}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,G(r.key),r)}}function U(e,t,n){return(t=G(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===x(t)?t:String(t)}var q=a()("biz:lakex_mini_editor_base"),Y=(null===(k=window.appData)||void 0===k?void 0:k.me)||{},V=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),U(this,"getDefaultSuggestions",(function(){return t.options.getDefaultSuggestions?t.options.getDefaultSuggestions():[]})),U(this,"setEngine",(function(e){t._engine=e,t.ocrListenerRemover=y.a.onEditorEngineLoaded(e,t.getType())})),U(this,"getEngine",(function(){return t._engine})),U(this,"setValue",(function(e){var n=e;e?e.startsWith("<")?(n={type:"lake",value:e},t._engine.setDocument(n)):"string"==typeof e&&(n={type:"json",value:JSON.parse(e)},t._engine.setDocument(n)):t._engine.setDocument()})),U(this,"getValue",(function(){return t._engine?t._engine.getPureContent():t.getDefaultValue()})),U(this,"isEmpty",(function(){return!t._engine||t._engine.isEmpty()})),U(this,"getSafetyValue",F(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.contentReady();case 2:return e.abrupt("return",t.getValue());case 3:case"end":return e.stop()}}),e)})))),U(this,"getHtml",(function(){return t._engine?t._engine.getPureHtml():null})),U(this,"focus",(function(e){if(!t._engine)return null;t._engine.focus(e)})),U(this,"contentReady",F(I().mark((function e(){var n,r;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._engine){e.next=2;break}return e.abrupt("return",null);case 2:return n=0,r=function e(r,o){t._engine.canGetDocument()?r():n>10?o():(n++,setTimeout((function(){e(r,o)}),1e3))},e.abrupt("return",new Promise(r));case 5:case"end":return e.stop()}}),e)})))),U(this,"saveAll",(function(){if(!t.options.disableCache){var e={format:s.a.FORMAT.LAKE,value:t.getValue(),html:t.getHtml()};t.saveToCache(e)}})),this.options=n,this.from=n.from||"reply",this.targetType=n.targetType,this.belong=n.belong,this.belongType=n.belongType,this.group=n.group,this.target=n.target,this.attachType=n.attachType,this.isEditMode=!!n.target,this.type=this.getType(),this.ctoken=Object(S.a)(window);var r=this.getCacheKey();this.cacheKeys={title:"".concat(r,"/title"),content:"".concat(r,"/content")},n.disableCache||(this.editorCache=new A(this.cacheKeys.content)),this.uuid=this.getUuid(),this._engine=null,this.ocrListenerRemover=null,this.initialDocument=null,this.init()}var t,n,r;return t=e,n=[{key:"init",value:function(){this.initialDocument=this.getInitialDocument(),q("init use: ",this.initialDocument)}},{key:"buildOptions",value:function(e){var t=this,n={translate:{supportTranslate:w()()},hideVipIcon:Object(O.a)(),board:{boardWebProxyParams:{webProxy:C.a,userId:null==Y?void 0:Y.id,spm:h,appData:window.appData}},image:{supportImgOCR:E()(),uploadFileURL:function(){return y.a.adaptOcrImageUploadUrl(t.getImageUploadUrl())},accept:Object(d.getImageAcceptArr)()},file:{hideEmbedButton:v()(),uploadFileURL:this.getFileUploadUrl(),accept:Object(d.getFileAcceptArr)(),localdocAccept:Object(d.getLocalDocAcceptArr)(),embedButtonStatus:Object(d.getIsDiabledPreviewAndEmbed)()},transfer:{transferFilesURL:this.getTransferUrl()},localdoc:{uploadFileURL:this.getFileUploadUrl(),accept:Object(d.getLocalDocAcceptArr)()},mention:{mentionURL:j.a.patchGroupIdToUrl(this.getMentionActionUrl()),defaultList:this.getDefaultSuggestions()},lockedtext:{action:this.getCryptoUrl()},placeholder:(null==e?void 0:e.placeholder)||this.getPlaceholder(),link:{autoCompleteLink:null==e?void 0:e.autoCompleteLink},video:{uploadAction:this.getMediaUploadUrl("video"),queryAction:"/api/video",accept:Object(d.getVideoAcceptArr)()},audio:{uploadFileURL:this.getMediaUploadUrl("audio"),queryURL:"/api/video",accept:Object(d.getAudioAcceptArr)()},vote:{allowVote:!0,queryDetailUrl:"api/votes",queryCheckUrl:"api/votes/mine",voteUrl:"api/votes"},yuque:{disableEmbedView:this.getDisableYuqueCardEmbedView()},materialLibrary:{component:o.a.createElement(m.a,{storage:T.a,webProxy:C.a})},fullscreen:{enable:this.getEnableFullEditor()}},r=[],i=this.getBlockedCards();return i&&i.length>1&&(r=Array.from(new Set([].concat(N(r),N(i))))),n.disabledPlugins=r,n}},{key:"getProps",value:function(){return{format:this.getFormat(),defaultValue:this.getDefaultValue(),autoFocus:this.getAutoFocus(),isMiniSize:this.isMiniSize()}}},{key:"getType",value:function(){return this.options.type||"unknown"}},{key:"getAutoFocus",value:function(){var e=this.options.autoFocus;return null!=e?e:!!this.options.useMiniGuide}},{key:"isMiniSize",value:function(){return!1}},{key:"getEnableFullEditor",value:function(){return!0}},{key:"getBlockedCards",value:function(){return["video","checkIn","vote","audio"]}},{key:"getUuid",value:function(){var e=this.cacheKeys.uuid,t=T.a.get(e);return t||(t=u()(32)+u()(32),T.a.set(e,t)),t}},{key:"getDefaultFormat",value:function(){return s.a.FORMAT.LAKE}},{key:"getFormat",value:function(){var e=this.options.format;return e||this.initialDocument.format}},{key:"getPlaceholder",value:function(){return this.options.placeholder}},{key:"getInitialDocument",value:function(){if(this.initialDocument)return this.initialDocument;var e=this.loadFromCache();if(q("cached document:",e),this.isEditMode){var t=this.getContentObject();return q("adapted content: ",t),e&&(q("merge with cached content",e),t.format=e.format||t.format,t.title=e.title||t.title,t.value=e.value||t.value),t}if(e)return e.format=e.format||this.getDefaultFormat(),e;var n=this.loadFromUrl();return n||{format:this.getDefaultFormat(),title:null,value:null}}},{key:"getContentObject",value:function(e){return{format:(e=e||this.target||{}).format||this.getDefaultFormat(),title:e.title||e.name||"",value:e.value||e.body_asl||e.content}}},{key:"getDefaultValue",value:function(){var e=this.options.defaultValue;return e||this.initialDocument.value}},{key:"getFullUrl",value:function(e){return this.isEditMode&&!this.options.useBelongAttach?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}},{key:"getTransferUrl",value:function(){return this.getFullUrl("/api/upload/copy?type=attachment")}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.getFullUrl(e)}},{key:"getMediaUploadUrl",value:function(e){var t="/api/video?ctoken=".concat(this.ctoken,"&format=").concat(e);return this.getFullUrl(t)}},{key:"getImageUploadUrl",value:function(){var e=this.getFileUploadUrl();return e?e.replace("&type=attachment","&type=image"):null}},{key:"getMentionActionUrl",value:function(){var e="";return this.isEditMode&&!this.options.useBelongAttach?e="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.target.id):this.belong&&(e="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.belong.id)),e}},{key:"getCryptoUrl",value:function(){return"/api/services/crypto"}},{key:"getDisableYuqueCardEmbedView",value:function(){return this.options.disableYuqueCardEmbedView}},{key:"saveToCache",value:function(e){var t;q("save to cache:",e),e.format&&(e.title&&T.a.set(this.cacheKeys.title,e.title),this.needCacheContent(e)?null===(t=this.editorCache)||void 0===t||t.put(e.value,e.format):q("value is empty or the same as origin, ignore cache"))}},{key:"needCacheContent",value:function(e){if(this.options.disableCache)return!1;if(!e.value)return!1;var t;if(p.a.isBlank(e))return null===(t=this.editorCache)||void 0===t||t.clear(),!1;if(!this.target)return!0;var n=this.getContentObject();return!p.a.isContentSame(e.format,n.value,e.value)}},{key:"reset",value:function(){q("reset editor"),this.clearCache(),this._engine&&this._engine.setDocument()}},{key:"isContentChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e){var t=this.loadFromCache();t&&(e=t.value)}if(!this.target)return!0;var n="<cursor />";return this.target.body_asl.trim().replace(n,"")!==e.trim().replace(n,"")}},{key:"clearCache",value:function(){var e=this;q("clear cache"),Object.keys(this.cacheKeys).forEach((function(t){T.a.remove(e.cacheKeys[t])}))}},{key:"getCacheKey",value:function(){return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/new"):"autosave/".concat(this.type)}},{key:"loadFromUrl",value:function(){}},{key:"loadFromCache",value:function(){if(this.options.disableCache)return null;var e=!1,t={format:null,title:null,value:null},n=this.editorCache.retrieve();if(n&&(e=!0,t.format=n.format,t.value=n.value),this.cacheKeys.title){var r=T.a.get(this.cacheKeys.title);r&&(e=!0,t.title=r)}return e?t:null}},{key:"destroy",value:function(){var e;null===(e=this.ocrListenerRemover)||void 0===e||e.call(this)}}],r=[{key:"getEmptyDocument",value:function(){return{format:s.a.FORMAT.LAKE,value:null}}}],n&&B(t.prototype,n),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=V},3340:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var a=n(3317).myNotesConsts,c=n(491),u=n(1378),l=i((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)})),s=a.COLLAPSE_BTN_CLASS,f=a.SUBMIT_BTN_CLASS;function p(e){var t=document.querySelectorAll(".".concat(e));if(t&&t.length){var n=document.body.getBoundingClientRect().height;t.forEach((function(t){var r=t.getBoundingClientRect().top,o=t.closest(".note-list-item").querySelector(".right-tool-".concat(e));o&&(o.style.display=r-n>10?"flex":"none")}))}}l.scrollToTop=c((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=document.querySelector("#mynote-container .note-list-scroll"),n={top:0,left:0};e.silent||(n.behavior="smooth"),t.scrollTo(n)}),100),l.scrollToElem=c((function(e){var t=e.id,n=document.querySelector("#note-".concat(t));if(n){var r=n.offsetTop;document.querySelector("#mynote-container .note-list-scroll").scrollTo({top:r,left:0,behavior:"smooth"})}}),100),l.fixListContainerHeight=function(){var e=document.querySelector(".material-library-view"),t=document.querySelector(".note-list-container .note-list");if(e&&t){var n=e.getBoundingClientRect().height-82,r=document.querySelector(".note-tag-container");r&&(n-=r.getBoundingClientRect().height),t.style.height="".concat(n,"px")}},l.fixNoteViewer=c((function(e){var t=e.id,n=document.querySelector("#note-".concat(t)),r=document.querySelector("#mynote-container .note-list-scroll");if(n&&r&&n.offsetTop>=0&&n.offsetTop+10<r.scrollTop){var o=n.offsetTop;r.scrollTo({top:o,left:0,behavior:"smooth"})}}),100),l.checkSubmitBtnShow=function(){return p(f)},l.checkCollapseBtnShow=function(){return p(s)};var m=u((function(){l.checkSubmitBtnShow(),l.checkCollapseBtnShow()}),500);l.handleListScroll=function(){var e=document.querySelector("#mynote-container .note-list-scroll");e&&(e.removeEventListener("scroll",m),e.addEventListener("scroll",m))},e.exports=l},3375:function(e,t,n){e.exports=n(464)},3387:function(e,t,n){"use strict";var r=n(67);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},a.apply(this,arguments)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,o,s=u(f);function f(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),s.apply(this,arguments)}return t=f,(n=[{key:"buildOptions",value:function(e){var t=a(l(f.prototype),"buildOptions",this).call(this,e);return t.disabledPlugins.push("mobile"),r.ua.mobile&&t.disabledPlugins.push("placeholder","slash"),t}},{key:"getBlockedCards",value:function(){return["video","audio","checkIn"]}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),f}(n(3324).a);t.a=s},3415:function(e,t,n){"use strict";var r=n(80),o=n.n(r),i={_bookGrayscaleConfig:null,getDefaultDocumentFormat:function(e,t,n){return t=t||"",n=n||{},o.a.DOC_DEFAULT_FORMAT[e]||o.a.FORMAT.LAKE}};t.a=i},345:function(e,t,n){"use strict";var r=n(133),o=n.n(r),i=n(67),a=n(104),c=n.n(a),u=n(109),l=n.n(u),s=n(110),f=n.n(s),p=n(115),m=n.n(p),d=n(122),y=n.n(d),h=n(123),b=n.n(h),v=n(129),g=n.n(v),w=n(468),_=n.n(w);function E(e){return i.ua.chrome?e.filter((function(e){return!/\.\w+\./.test(e)})):e}var O=E(o.a),S=E(o.a.normal),j=E(o.a.paid),T=[y.a,b.a,m.a,g.a],C=E(_()(T).concat([".pdf"])),P=E(_()(T.map((function(e){return e.paid}))).concat([".pdf"])),R=c.a,k=c.a.normal,L=c.a.paid,A=l.a,x=l.a.paid,N=f.a,D=f.a.paid;t.a={LOCAL_DOC_EXT:C,LOCAL_DOC_EXT_NORMAL:[],LOCAL_DOC_EXT_PAID:P,FILE_EXT:O,FILE_EXT_NORMAL:S,FILE_EXT_PAID:j,IMAGE_EXT:R,IMAGE_EXT_NORMAL:k,IMAGE_EXT_PAID:L,VIDEO_EXT:A,VIDEO_EXT_NORMAL:[],VIDEO_EXT_PAID:x,AUDIO_EXT:N,AUDIO_EXT_NORMAL:[],AUDIO_EXT_PAID:D}},3482:function(e,t,n){var r=n(953).getInterest,o=n(53).INTEREST_CODE;e.exports=function(){return r().interests[o.open_ocr]}},3489:function(e,t){e.exports=function(){var e=window.appData||{},t=e.isYuque,n=e.organization,r=e.group,o=void 0===r?{}:r,i=n&&n.id;return!!t&&(!("Group"!==(null==o?void 0:o.type)||i)||!(!n||n.isPremium))}},3490:function(e,t,n){var r=n(585).isPaidCheckAll;e.exports=function(){return!(window.appData||{}).isYuque||!!r()}},3491:function(e,t,n){"use strict";var r=n(585).isPaidCheckAll;t.a=function(){if(!(window.appData||{}).isYuque)return!0;var e=window.appData,t=e.organization,n=e.group,o=void 0===n?{}:n;return!(!t||!r())||!t&&"Group"===(null==o?void 0:o.type)}},3492:function(e,t,n){"use strict";n.d(t,"a",(function(){return $t}));n(790);var r=n(281),o=n(0),i=n.n(o),a=n(2),c=n.n(a),u=(n(41),n(10)),l=(n(258),n(135)),s=n(5),f=n.n(s),p=n(1003),m=n.n(p),d=n(1210),y=n(1208),h=n.n(y),b=n(45),v=n(461),g=n(3497),w=n(464),_=n(164),E=n.n(_),O=n(3375),S=n(3317),j=n(1198),T="note-status-module_dev_g73YZ",C="note-status-module_text_ZLRRs",P=function(e){var t=e.item,n=e.orderBy,r=t.published_at,o=t.content.updated_at,a=n===O.ORDER_BY.content_updated_at,c=a?o:r,u=new Date(o).getFullYear()!==(new Date).getFullYear();return i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:C},a?__("更新于"):__("创建于")," ",j.default.format(c,{onlyDate:u,disableYear:!1})),function(e){if(!S.isDev)return null;var t=null===o;return i.a.createElement("span",{className:T},e.id," ",t?"mirror":""," ",E()(e.content_updated_at).format("YYYY-MM-DD HH:mm:ss"))}(t))},R=n(3340),k=(n(75),n(33)),L=n(1402),A=n(251),x=(n(151),n(66)),N=n(1378),D=n.n(N),I=n(1623),M=n(586),F=n(1724),B="TagList-module_list_g-vtQ",U="TagList-module_item_bUgF8",G="TagList-module_active_EPfJt",q="TagList-module_delete_NtLM0",Y="TagList-module_wrapper_wAu1a",V="TagList-module_hideMore_2Kx5n",z="TagList-module_expand_J-EtW",W="TagList-module_expandForMini_G9K8m",H="TagList-module_line_pgNjs",K="TagList-module_addTag_P9XTi",X="TagList-module_rightSide_65+zS",J="TagList-module_noTag_XGuDy",$="TagList-module_canSelect_XVnT1",Z="TagList-module_name_-HZCJ",Q="TagList-module_highLight_Fx+g3",ee="TagList-module_count_JG6aO",te="TagList-module_listForMini_n1Fjy",ne="TagList-module_expandBtn_kA52P",re="TagList-module_expanded_tVFvP",oe="TagList-module_icon_zLTbc";function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e,t,n){return t=function(e){var t=function(e,t){if("object"!==ie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ie(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var le=function(e){var t,n,r=e.data,a=e.onDelete,c=e.renderFirstItem,u=e.showCount,l=e.hideMore,s=e.storageKey,p=e.localStorage,m=e.currentTagId,d=e.onSelect,y=e.renderRightSide,h=e.query,b=e.isFilter,v=e.expandForMini,g=r||[];h&&(g=g.filter((function(e){return null==e?void 0:e.name.includes(h)})));var w=!1;s&&p&&p.get(s)&&(w=!0);var _=ce(Object(o.useState)(w),2),E=_[0],S=_[1],j=ce(Object(o.useState)(!1),2),T=j[0],C=j[1],P=Object(o.useRef)(null),R=function(){if(l&&P&&P.current){var e=P.current.children;if(!e||e.length<=2)C(!1);else{var t=e[1],n=e[e.length-1],r=t.getBoundingClientRect().top!==n.getBoundingClientRect().top;C(r)}}};function k(e){if(!h)return i.a.createElement("span",{className:Z},e);var t=e.indexOf(h);return t<0?i.a.createElement("span",{className:Z},e):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:Z},e.slice(0,t)),i.a.createElement("span",{className:f()(Z,Q)},h),i.a.createElement("span",{className:Z},e.slice(t+h.length)))}return Object(o.useEffect)((function(){R()}),[r,h]),Object(o.useEffect)((function(){p&&s&&(E?p.set(s,"true"):p.remove(s))}),[E]),Object(o.useEffect)((function(){var e=D()(R,200);return l&&window.addEventListener("resize",e,!1),function(){window.removeEventListener("resize",e,!1)}}),[]),i.a.createElement("div",{"data-testid":"note-tag-list-wrapper",className:f()(Y,(t={},ae(t,z,E),ae(t,V,l),ae(t,W,v),t),"note-tag-list")},i.a.createElement("div",{className:f()(B,"tag-list",ae({},te,v)),ref:P},c&&i.a.createElement("div",{className:K},c()),y||T?i.a.createElement("div",{className:X},T&&i.a.createElement("div",{className:f()(ne,"tag-list-expand",ae({},re,E)),onClick:function(e){e.stopPropagation(),S(!E)}},i.a.createElement(I.default,{className:oe})),!h&&y&&y()):null,g.map((function(e){var t,n=null==e?void 0:e.name;if(!n)return null;var r=n.length>20,o=r?"".concat(n.slice(0,20),"..."):n,c=m===e.id;return i.a.createElement(x.a,{title:r?n:null},i.a.createElement("div",{"data-testid":"note-tag-list-item",className:f()(U,(t={},ae(t,G,c),ae(t,$,!!d),t)),key:null==e?void 0:e.name,onClick:function(){d&&d(e.id)}},k(o),function(e){return u&&void 0!==e.count?i.a.createElement("span",{className:ee},"(",e.count,")"):null}(e),a&&i.a.createElement("span",{"data-testid":"note-tag-list-delete",className:q,onClick:function(){return a(e)}},i.a.createElement(M.default,null))))})),g.length>0&&!h&&b&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:H}),i.a.createElement("div",{"data-testid":"note-tag-list-item",className:f()(U,J,(n={},ae(n,G,m===O.FILTER_TAGS.noTag),ae(n,$,!!d),n)),onClick:function(){d&&d(O.FILTER_TAGS.noTag)}},i.a.createElement(F.default,{width:16,height:16}),k(__("无标签"))))))},se={toolBarBtn:"index-module_toolBarBtn_kG8Cd",wrapper:"index-module_wrapper_8ethE",noteItem:"index-module_noteItem_dVp5J",note:"index-module_note_geZ56",viewBlank:"index-module_viewBlank_ecM7l",tagPinned:"index-module_tagPinned_--NI2",descMoreIcon:"index-module_descMoreIcon_wlBa3",tab:"index-module_tab_zkK5m",arrowUp:"index-module_arrowUp_lRGKc",arrowDown:"index-module_arrowDown_3-EN3",tabNote:"index-module_tabNote_8V7gj",hidden:"index-module_hidden_M8z9j",tagPinnedContainer:"index-module_tagPinnedContainer_hB8jT",selected:"index-module_selected_aA0w-",rightToolBar:"index-module_rightToolBar_e1gvN",noteItemExpand:"index-module_noteItemExpand_PjrCj",leftToolBar:"index-module_leftToolBar_JMyy5",content:"index-module_content_Yf3Cm",loading:"index-module_loading_uVMCS",mask:"index-module_mask_-nOYf",reading:"index-module_reading_dfUvx",isTemplate:"index-module_isTemplate_7o8Q-",viewMore:"index-module_viewMore_gsQbm",searchMode:"index-module_searchMode_jG3fm",meta:"index-module_meta_B+ClL",radio:"index-module_radio_2HGaM",contentExpanded:"index-module_contentExpanded_lWgEI",editing:"index-module_editing_nW8gJ",hasTag:"index-module_hasTag_wtzsZ",viewMoreShow:"index-module_viewMoreShow_pN6H7",images:"index-module_images_fAoGp",date:"index-module_date_095hy",imagesContent:"index-module_imagesContent_t0q35",item:"index-module_item_2FEiU",bookmark:"index-module_bookmark_-+dy+",title:"index-module_title_6RJyp",desc:"index-module_desc_WTwbK",belong:"index-module_belong_Csy5b",text:"index-module_text_bro5m",left:"index-module_left_s-MXM",right:"index-module_right_RJVuX",attachment:"index-module_attachment_H4LKm",file:"index-module_file_e9W5F",name:"index-module_name_fKT1c",size:"index-module_size_xQNXJ",empty:"index-module_empty_cBT2k",loadMoreBtn:"index-module_loadMoreBtn_t6j9W",theEndTips:"index-module_theEndTips_tq+NY",blank:"index-module_blank_2HJdh",desktop:"index-module_desktop_oahLD",toolbarStyle:"index-module_toolbarStyle_cNHWw",batchProcess:"index-module_batchProcess_BqhA4",checkBox:"index-module_checkBox_mz+g+",rightToolBarCollapse:"index-module_rightToolBarCollapse_cPTfb",rightToolBarSave:"index-module_rightToolBarSave_vhDcz",tagContainer:"index-module_tagContainer_nVqVt"};function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pe.apply(this,arguments)}function me(e,t,n){return t=function(e){var t=function(e,t){if("object"!==fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===fe(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(){de=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==fe(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(fe(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ge(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function he(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function be(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){he(i,r,o,a,c,"next",e)}function c(e){he(i,r,o,a,c,"throw",e)}a(void 0)}))}}function ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _e=Object(A.b)((function(){return Promise.all([n.e(4),n.e(5),n.e(6),n.e(0),n.e(1238)]).then(n.bind(null,5710))}),{suspense:!0}),Ee=S.myNotesConsts.COLLAPSE_BTN_CLASS,Oe=function(e){var t,n,r=e.note,a=e.noteTags,c=e.enableDynamicTaskList,u=e.onLoadNote,l=e.onCollapseNote,s=e.renderEditor,p=e.onChangeNote,m=e.onUpdateContentUpdatedAt,d=r.id,y=r.content,h=y.updated_at,v=y.abstract,g=y.source,_=y.doc_dynamic_data,E=r.tags,O=void 0===E?[]:E,j=r.content_show_at,T=r.expanded_at,C=r.changed_at,P=r.save_from,A=ve(Object(o.useState)(!g),2),x=A[0],N=A[1],D=ve(Object(o.useState)(!!g),2),I=D[0],M=D[1],F=ve(Object(o.useState)(!g),2),B=F[0],U=F[1],G=ve(Object(o.useState)(!!g),2),q=G[0],Y=G[1],V=Object(o.useRef)(null),z=Object(o.useRef)(null),W=Object(o.useRef)(null);Object(o.useEffect)((function(){j&&(N(!1),M(!0),U(!1),Y(!0))}),[j]);var H=r.editing,K=r.loading,X=null===h;if(!S.isDev&&X)return null;var J="item-".concat(r.id,"-").concat(h),$={};S.isDesktopApp&&($.downloadFileHandler=S.downloadFileHandler);var Z=O&&O.map((function(e){var t=a&&a.find((function(t){return t.id===e.id}));return t||null})).filter((function(e){return!!e})),Q=function(){var e=be(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=setInterval((function(){var r=t.querySelectorAll('ne-card[data-card-name="image"] img');if(0===r.length)return clearInterval(n),e();var o,i=[],a=ye(r);try{for(a.s();!(o=a.n()).done;){var c=o.value;c.complete||i.push(c)}}catch(e){a.e(e)}finally{a.f()}0===i.length&&(clearInterval(n),setTimeout((function(){e()}),100))}),10);setTimeout((function(){clearInterval(n),e()}),800)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=be(de().mark((function e(t){var n;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=13;break}if(Y(!0),M(!1),z){e.next=5;break}return e.abrupt("return");case 5:return n=z.current,e.next=8,Q(n);case 8:N(!1),U(!1),M(!0),e.next=16;break;case 13:U(!0),N(!1),setTimeout(be(de().mark((function e(){var t,n;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=V.current){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Q(t);case 5:N(!0),Y(!0),M(!1),null==(n=document.getElementById("doclet-viewmore-".concat(d)))||n.scrollIntoView(!1);case 10:case"end":return e.stop()}}),e)}))),30);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=!H&&Z&&!!Z.length,ne=P&&[w.SAVE_FROM_TYPE.TEMPLATE_NOTE,w.SAVE_FROM_TYPE.TEMPLATE_TODO].includes(P);if(r.editing)return i.a.createElement("div",{className:f()(se.content,me({},se.contentExpanded,T),se.editing)},s(r));function re(){null==p||p(r),null==m||m(r.id)}return i.a.createElement(k.a,{className:f()(se.content,"note-item-normal",(t={},me(t,se.contentExpanded,!!ne||T),me(t,se.reading,!H),me(t,se.hasTag,te),me(t,se.isTemplate,ne),t))},i.a.createElement("div",null,B&&i.a.createElement("div",{style:{display:x?"relative":"absolute",zIndex:x?3:-1,left:0,top:0,overflow:I?"hidden":"none"},ref:V},i.a.createElement(_e,pe({docId:d,key:"".concat(J,"-description-").concat(r.updated_at),content:v,onDynamicDataChange:re,enableDynamicTaskList:c,dynamicData:_},$))),q&&i.a.createElement("div",{style:{position:I?"relative":"absolute",zIndex:I?3:-1,left:0,top:0,overflow:I?"hidden":"none"},ref:z},i.a.createElement(_e,pe({docId:d,key:"".concat(J,"-doclet-").concat(d,"-").concat(h),content:g,onDynamicDataChange:re,enableDynamicTaskList:c,dynamicData:_},$)))),te&&i.a.createElement(le,{data:Z}),i.a.createElement("div",{className:f()(se.viewBlank,"view-blank"),onClick:function(e){var t=e.currentTarget;t&&"pointer"===t.style.cursor&&t.nextSibling&&t.nextSibling.click()}}),i.a.createElement("div",{ref:W,key:"doclet-viewmore-".concat(d),id:"doclet-viewmore-".concat(d),className:f()(se.viewMore,(n={},me(n,se.viewMoreShow,T),me(n,se.expanded,T),n),"view-more"),onClick:function(){var e=be(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),!T){e.next=14;break}if(!C){e.next=10;break}return e.next=5,u(r);case 5:return l(r),e.next=8,ee(!1);case 8:e.next=12;break;case 10:l(r),ee(!1);case 12:e.next=19;break;case 14:return e.next=16,u(r);case 16:return e.next=18,ee(!0);case 18:setTimeout((function(){Object(R.checkCollapseBtnShow)()}),100);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(null==v?void 0:v.includes(w.VIEW_MORE_TAG))&&(T?i.a.createElement("span",{className:f()(Ee,se.descMoreIcon)},i.a.createElement(b.b,{name:"arrow-up",size:14,className:se.descMoreIcon}),__("收起")):i.a.createElement("span",{className:f()(Ee,se.descMoreIcon)},i.a.createElement(b.b,{name:"arrow-down",size:14,className:se.descMoreIcon}),__("展开")))),K&&i.a.createElement("div",{className:se.loading},i.a.createElement(L.default,null)))};function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function je(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Se(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Se(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Te(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pe=S.myNotesConsts.NOTE_LIST_ITEM_CLASS,Re=S.myNotesConsts.NOTE_LIST_READ_TAG_ADD_CLASS,ke=function(e){var t,n=e.state,r=n.hasMore,a=n.listData,c=n.pinnedListData,u=n.listLoading,l=n.searchValue,s=n.orderBy,p=n.filterTab,d=n.currentTagId,y=n.noteTags,_=n.noteStatus,E=n.showPinned,O=e.getNotes,j=e.onSelectNote,T=e.onLoadNote,C=e.setLoadRef,k=e.renderToolBar,L=e.isAlipayWebApp,A=p===w.FILTER_TYPES.all,x=Object(v.a)().isDarkMode;function N(){if(!d||l)return null;var e=y.find((function(e){var t;return(null===(t=e.tag_meta)||void 0===t?void 0:t.id)===d}));if(!e||!e.count)return null;var t=a&&a.length;c&&c.length>0&&(t+=c.length);var n=e.count-t;return!n||n<0?null:__("{num} 篇小记不包含{text}",{num:n,text:Object(S.getFilterBarConfig)()[p]})}Object(o.useEffect)((function(){if(A){var e=document.querySelector("#mynote-container .note-list");if(e){var t=e.querySelectorAll(".yuque-doc-content");setTimeout((function(){var e,n=Te(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;l?(r.searchPad||(r.searchPad=new g.a({target:r,style:{highlight:{fill:"rgba(255, 230, 0, 0.5)"},select:{fill:"rgba(255, 140, 0, 0.5)"}}})),r.searchPad.find(l.trim())):r.searchPad&&r.searchPad.clear()}}catch(e){n.e(e)}finally{n.f()}}),100),Object(R.handleListScroll)()}}}),[a]),Object(o.useEffect)((function(){var e=h.a.parse(window.location.search).scroll_to;setTimeout((function(){Object(R.scrollToElem)({id:e})}),200)}),[]);var D=function(t){var n="item-".concat(t.id,"-").concat(t.content_updated_at),r={note:t,filterTab:p,noteTags:y,isAlipayWebApp:L,orderBy:s,onSelectNote:j,renderToolBar:k,enableDynamicTaskList:e.enableDynamicTaskList,onLoadNote:T};return i.a.createElement("div",{id:"note-".concat(t.id),key:n,className:f()(se.note,Pe),onDoubleClick:function(e){var n;null!=e&&null!==(n=e.target)&&void 0!==n&&n.closest(".share-note-button")||j(t)}},i.a.createElement("div",{className:f()(se.noteItem,"note-item")},t.pinned_at&&i.a.createElement("div",{className:se.tagPinnedContainer},i.a.createElement(b.b,{name:"IconTop",size:14,className:se.tagPinned})),i.a.createElement("div",{className:se.meta},i.a.createElement(P,{item:t,orderBy:s}),k(t)),i.a.createElement(Oe,r),i.a.createElement("div",{className:f()(se.tagContainer,Re)})))};return m()(null==c?void 0:c.concat(a))?i.a.createElement("div",{"data-testid":"note-list-empty",className:f()(se.wrapper,se.empty,je({},se.desktop,S.isDesktopApp),"note-list-empty")},function(){if(u)return null;if(l)return i.a.createElement("div",{className:se.blank},__("未能找到相关{type}",{type:__("小记")}));var e=N(),t=__("灵光乍现，小记一下");return _===w.STATUS.archived&&(t=__("不再使用的小记可归档于此")),i.a.createElement(i.a.Fragment,null,i.a.createElement("img",{src:x?"https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*HSmhT7fKgwMAAAAAAAAAAAAAARQnAQ":"https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*HshzTKOlvckAAAAAAAAAAAAAARQnAQ"}),i.a.createElement("p",null,e||t))}()):i.a.createElement("div",{className:f()(se.wrapper,(t={},je(t,se.desktop,S.isDesktopApp),je(t,se.win,S.isWin),je(t,se.searchMode,l),t),"note-list"),"data-testid":"note-list"},i.a.createElement("div",{className:f()(je({},se.hidden,!E))},function(e){if(w.NEED_PINNED_TYPE.includes(p))return e.map(D)}(c)),w.NEED_PINNED_TYPE.includes(p)&&E&&c.length>0&&a.length>0&&i.a.createElement("span",{className:f()(se.tab,se.tabNote)},__("小记")),a.sort((function(e,t){return new Date(t[s]).getTime()-new Date(e[s]).getTime()})).map(D),function(){if(r)return i.a.createElement("div",{className:se.loadMoreBtn,onClick:O,ref:function(e){return C(e)}},__("点击加载更多"));var e=N();return e?i.a.createElement("div",{className:se.theEndTips},e):a&&a.length>9?i.a.createElement("div",{className:se.theEndTips},__("我是有底线的")):void 0}())};ke.propTypes={isAlipayWebApp:c.a.bool,setLoadRef:c.a.func,state:c.a.object,getNotes:c.a.func,onLoadNote:c.a.func,onSelectNote:c.a.func,onInsertToLakeEditor:c.a.func,renderToolBar:c.a.func,renderResourceIcon:c.a.func,enableDynamicTaskList:c.a.bool,setToDocList:c.a.func,setBatchProcess:c.a.func};var Le=ke,Ae=(n(56),n(12)),xe=n(1624),Ne={wrapper:"search-module_wrapper_S445p",searchBar:"search-module_searchBar_x3Krl",active:"search-module_active_eYHT+",isLiteMode:"search-module_isLiteMode_C4hZN",searchMini:"search-module_searchMini_V+K7h",searchMiniShow:"search-module_searchMiniShow_xFcgm"};function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Ie(e,t,n){return t=function(e){var t=function(e,t){if("object"!==De(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===De(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Be=function(e){var t,n,r,a=e.activeMode,c=e.isDesktopApp,u=e.searchValue,l=e.searchActive,s=e.setSearchActive,p=e.isLiteMode,m=e.onSearchNote,d=e.onSearchReset,y=Me(Object(o.useState)(null),2),h=y[0],b=y[1],v=Object(o.useRef)(null);Object(o.useEffect)((function(){u||(b(null),s(!1))}),[u]);var g={ref:v,value:h,prefix:i.a.createElement(xe.default,null),placeholder:__("搜索"),autoComplete:"nope",allowClear:!0,onSearch:m,onBlur:function(e){e.target.value||(s(!1),d())},onChange:function(e){var t=e.target.value;b(t)},onClear:function(){b(null)}};return"dark"!==(null===(t=window.yuqueThemeManager)||void 0===t?void 0:t.current)&&(g.style={borderColor:"#e8e8e8"}),i.a.createElement("div",{"data-testid":"note-search",className:f()(Ne.wrapper,"note-search")},i.a.createElement("div",{className:f()(Ne.searchBar,(n={},Ie(n,Ne.active,a||l),Ie(n,Ne.isLiteMode,p),n))},i.a.createElement(Ae.a.Search,g)),!a&&i.a.createElement("div",{className:f()(Ne.searchMini,(r={},Ie(r,Ne.searchMiniShow,!l),Ie(r,Ne.desktop,c),r)),onClick:function(){s(!0),v&&v.current&&v.current.focus()}},i.a.createElement(xe.default,{width:16,height:16,style:{color:"#262626"}})))};Be.defaultProps={activeMode:!1,isDesktopApp:!1},Be.propTypes={searchValue:c.a.string,searchActive:c.a.bool,isDesktopApp:c.a.bool,onSearchNote:c.a.func,onSearchReset:c.a.func,setSearchActive:c.a.func,activeMode:c.a.bool};var Ue=Be,Ge=n(1725),qe="sidebar-toolbar-module_wrapper_oE4lW",Ye="sidebar-toolbar-module_insertBtn_RY-1c",Ve=f()(qe,"note-list-toolbar"),ze=function(e){var t=e.item,n=e.onInsertToLakeEditor;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:Ve,"data-testid":"note-list-toolbar"},i.a.createElement("span",{className:Ye,onClick:function(){return n(t)}},i.a.createElement(Ge.default,{width:14,height:14}),__("插入文档"))))};ze.defaultProps={onInsertToLakeEditor:function(){}},ze.propTypes={item:c.a.object,onInsertToLakeEditor:c.a.func};var We=ze,He=n(3341);function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function Xe(){Xe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Ke(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Ke(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Je(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qe=function(e){var t,n=e.getNotes,r=e.listData,i=e.isDesktopApp,a=$e(Object(o.useState)(null),2),c=a[0],l=a[1];function s(){var e;return e=Xe().mark((function e(t){return Xe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t[0].isIntersecting&&n({noLoading:!0});case 1:case"end":return e.stop()}}),e)})),s=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Je(i,r,o,a,c,"next",e)}function c(e){Je(i,r,o,a,c,"throw",e)}a(void 0)}))},s.apply(this,arguments)}return i&&u.a.config({top:80,duration:1.5}),Object(o.useEffect)((function(){var e=document.querySelector("#siteTipGuide");return e&&(e.style.display="none"),i&&u.a.config({top:80,duration:1.5}),function(){var e=document.querySelector("#siteTipGuide");e&&(e.style.display="block")}}),[]),window.IntersectionObserver&&(t=new IntersectionObserver((function(e){return s.apply(this,arguments)}),{threshold:.1})),Object(o.useEffect)((function(){if(c&&t)return t.observe(c),function(){t.unobserve(c)}}),[c,r]),{setLoadRef:l}},et=n(198),tt=n(3411);function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function rt(){rt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==nt(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(nt(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function ot(e){return function(e){if(Array.isArray(e))return pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ft(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function at(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){it(i,r,o,a,c,"next",e)}function c(e){it(i,r,o,a,c,"throw",e)}a(void 0)}))}}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){lt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lt(e,t,n){return t=function(e){var t=function(e,t){if("object"!==nt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===nt(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||ft(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(e,t){if(e){if("string"==typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pt(e,t):void 0}}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var mt=S.myNotesConsts.NOTE_ORDER_KEY,dt={status:w.STATUS.unarchived,filterTab:tt.a.all,orderBy:tt.b.content_updated_at,currentTagId:null,search:""},yt=function(e){var t=e.currentUuid,n=e.refreshBatchProcess,r=st(Object(o.useState)([]),2),i=r[0],a=r[1],c=st(Object(o.useState)([]),2),l=c[0],s=c[1],f=st(Object(o.useState)(!1),2),p=f[0],m=f[1],d=st(Object(o.useState)(!0),2),y=d[0],h=d[1],b=st(Object(o.useState)([]),2),v=b[0],g=b[1],_=st(Object(o.useState)(ut(ut({},dt),{},{orderBy:et.a.get(mt)||tt.b.content_updated_at})),2),E=_[0],O=_[1],S=Object(o.useCallback)((function(e){s([]),a([]),O(ut(ut({},E),e))}),[E]),j=Object(o.useCallback)((function(e){return l.find((function(t){return t.id===e}))?[l,s]:[i,a]}),[i,l]),T=Object(o.useCallback)(at(rt().mark((function e(){var t,n,r,o,c,u,l=arguments;return rt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=l.length>0&&void 0!==l[0]?l[0]:{}).noLoading||m(!0),n={offset:i.length,q:E.search,filter_type:E.filterTab,status:E.status,merge_dynamic_data:0,order:E.orderBy,with_pinned_notes:!0},E.currentTagId&&(n.tag=E.currentTagId),w.NEED_PINNED_TYPE.includes(E.filterTab)||delete n.with_pinned_notes,t.fromQuery&&(n.offset=0),n.q&&(n.order=tt.b.first_published_at),w.DEFAULT_TYPE.includes(n.filter_type)||(n.include_body=!0,n.order=tt.b.first_published_at),e.prev=8,e.next=11,He.a.NoteCtlImpl.index(n,{useOriginResp:!0});case 11:r=e.sent,o=r.has_more,c=r.notes,u=r.pin_notes,h(o),0===n.offset?w.NEED_PINNED_TYPE.includes(E.filterTab)?(s(u),a(c)):a(c):a([].concat(ot(i),ot(c)));case 17:return e.prev=17,m(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[8,,17,20]])}))),[E,i]),C=Object(o.useCallback)(at(rt().mark((function e(){var t,n;return rt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.NoteTagCtlImpl.count({status:E.status,filter_type:E.filterTab});case 2:t=e.sent,(n=t.data)&&(g(n),E.currentTagId&&!n.some((function(e){return e.id===E.currentTagId}))&&E.currentTagId!==w.FILTER_TAGS.noTag&&S({currentTagId:null}));case 5:case"end":return e.stop()}}),e)}))),[E]);var P=Object(o.useCallback)((function(e){return He.a.NoteOperateCtlImpl.batchDelete({ids:e,latest_update_user_uuid:t}).then((function(){null==n||n();var t=i.slice().filter((function(t){return!e.includes(t.id)}));a(t);var r=l.slice().filter((function(t){return!e.includes(t.id)}));s(r),!t.length&&y&&T(),C(),u.a.success(__("小记已移至回收站"))})).catch((function(){u.a.error(__("删除失败"))}))}),[j,t]),R=function(){var e=at(rt().mark((function e(t){var n;return rt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.NoteOperateCtlImpl.batchPin({ids:[t.id]});case 2:t.pinned_at=new Date,n=i.filter((function(e){return e.id!==t.id})),l.unshift(t),a(n),s(l),u.a.success(__("小记置顶成功"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=at(rt().mark((function e(t){var n;return rt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.NoteOperateCtlImpl.batchUnPin({ids:[t.id]});case 2:t.pinned_at=null,n=l.filter((function(e){return e.id!==t.id})),i.unshift(t),a(i),s(n),u.a.success(__("取消置顶成功"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){T(),C()}),[E]),{state:{listData:i,listLoading:p,hasMore:y,noteTags:v,noteFilterParams:E,pinnedListData:l},setListData:a,getNotes:T,getNoteTags:C,onChangeFilterParams:S,onReset:function(){s([]),O(dt)},onRemoveNote:function(e){var t=e.id;P([t])},setPinnedListData:s,getListData:j,pinnedNote:R,deletePinnedNote:k,onRemoveNotes:P}};function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e,t,n){return t=function(e){var t=function(e,t){if("object"!==ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ht(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _t(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Et=function(){var e=wt(Object(o.useState)(!1),2),t=e[0],n=e[1],r=wt(Object(o.useState)(!0),2),i=r[0],a=r[1],c=yt({}),l=c.state,s=l.listData,f=l.listLoading,p=l.hasMore,m=l.noteTags,d=l.noteFilterParams,y=l.pinnedListData,h=c.getListData,b=c.getNotes,v=c.getNoteTags,g=c.onChangeFilterParams,w=c.onReset,_=c.onRemoveNote,E=c.onRemoveNotes,O=Qe({listData:s,getNotes:b,isDesktopApp:S.isDesktopApp}).setLoadRef,j=Object(o.useCallback)((function(){d.search&&w()}),[d]),T=Object(o.useCallback)((function(e){e!==d.currentTagId?g({currentTagId:e}):g({currentTagId:null})}),[d]);return{state:{listData:s,pinnedListData:y,listLoading:f,orderBy:d.orderBy,hasMore:p,searchValue:d.search,searchActive:t,filterTab:d.filterTab,noteTags:m,currentTagId:d.currentTagId,noteStatus:d.status,toDocList:[],showPinned:i},getNotes:b,onLoadNote:function(e){var t=e.id,n=wt(h(t),2),r=n[0],o=n[1],i=r.slice(),a=i.findIndex((function(e){return e.id===t}));return i[a].loading=!0,o(i),He.a.NoteCtlImpl.show({id:t,merge_dynamic_data:0}).then((function(e){var t=r.slice();t[a]=vt(vt({},e),{},{expanded_at:new Date}),o(t)})).catch((function(){var e=r.slice();i[a].loading=!1,o(e),u.a.error(__("获取内容失败，请再试一次"))}))},onCollapseNote:function(e){var t=e.id,n=wt(h(t),2),r=n[0],o=n[1],i=r.slice(),a=i.findIndex((function(e){return e.id===t}));delete i[a].expanded_at,delete i[a].changed_at,delete i[a].loading,o(i)},onRemoveNote:_,onRemoveNotes:E,onSearchNote:function(e){g({search:e})},onSearchReset:j,setSearchActive:n,getNoteTags:v,onSelectTag:T,onChangeFilterParams:g,onReset:w,setLoadRef:O,setShowPinned:a}},Ot="index-module_wrapper_kkqhF",St="index-module_tagContainer_TFFU4",jt="index-module_show_oAR0z",Tt="index-module_tagContainerExpand_7mxch",Ct="index-module_tagTipBar_g7usD",Pt="index-module_icon_nCjEV",Rt="index-module_notesList_xu6a8",kt="index-module_liteWrapper_fYo2B";function Lt(e){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lt(e)}function At(){return At=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},At.apply(this,arguments)}function xt(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Lt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Lt(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var It=function(e){var t,n=Et(e),r=e.storage,a=Nt(Object(o.useState)(!1),2),c=a[0],u=a[1],s=n.state,p=s.listLoading,y=s.noteTags,h=s.currentTagId,b=n.onSelectTag,v=n.setSearchActive,g=n.onSearchReset,w=n.onSearchNote;Object(o.useEffect)((function(){Object(R.fixListContainerHeight)()}),[c]);var _=!m()(y);return i.a.createElement("div",{"data-testid":"mynote-list-container",id:"mynote-container",className:Ot},i.a.createElement(Ue,{searchValue:n.state.searchValue,searchActive:n.state.searchActive,setSearchActive:v,onSearchReset:g,onSearchNote:w,activeMode:!0,isDesktopApp:S.isDesktopApp,isLiteMode:!0}),i.a.createElement("div",{className:f()(St,(t={},xt(t,Tt,c),xt(t,jt,_),t),"note-tag-container")},i.a.createElement("div",{onClick:function(){return u(!c)},className:Ct},i.a.createElement("span",null,c?__("收起所有标签"):__("展开所有标签")),i.a.createElement(d.default,{className:Pt,width:16})),i.a.createElement("div",{className:kt},i.a.createElement(le,{hideMore:!1,showCount:!0,currentTagId:h,onSelect:b,localStorage:r,storageKey:"NOTE_LIST_TAG_MANAGER",data:y}))),i.a.createElement(l.a,{spinning:p},i.a.createElement("div",{className:f()(Rt,"note-list-container")},i.a.createElement(Le,At({},n,{isMobile:!0,isLiteMode:!0,renderToolBar:function(t){return i.a.createElement(We,{item:t,showFeather:!n.state.searchValue,onInsertToLakeEditor:e.onInsertToLakeEditor})}})))))};It.fetchData=function(e){return He.a.NoteCtlImpl.show({id:e.id})},It.defaultProps={onInsertToLakeEditor:function(){}},It.propTypes={webProxy:a.PropTypes.object,storage:a.PropTypes.object,onInsertToLakeEditor:a.PropTypes.func};var Mt=It;function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vt(r.key),r)}}function Ut(e,t){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ut(e,t)}function Gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yt(e);if(t){var o=Yt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ft(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qt(e)}(this,n)}}function qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yt(e){return Yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yt(e)}function Vt(e){var t=function(e,t){if("object"!==Ft(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ft(t)?t:String(t)}var zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ut(e,t)}(a,e);var t,n,r,o=Gt(a);function a(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return e=o.call.apply(o,[this].concat(c)),t=qt(e),r=function(t){Mt.fetchData(t).then((function(t){e.props.onInsertDocument("text/lake",t.content.source)})).catch((function(){u.a.error(__("小记插入失败"))}))},(n=Vt(n="onInsertToLakeEditor"))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,e}return t=a,(n=[{key:"render",value:function(){var e=this.props.storage;return i.a.createElement("div",{className:"material-library-note"},i.a.createElement(Mt,{storage:e,onInsertToLakeEditor:this.onInsertToLakeEditor}))}}])&&Bt(t.prototype,n),r&&Bt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.Component);function Wt(){return Wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wt.apply(this,arguments)}zt.propTypes={storage:c.a.object,onInsertDocument:c.a.func};var Ht=r.a.TabPane,Kt="storage/sidebar-tab-key",Xt={note:"note"},Jt=function(e){var t=e.storage;return{tabKey:t.get(Kt)||Xt.note,onTabChange:function(e){t.set(Kt,e)}}};function $t(e){var t=Jt(e),n=e.storage;return i.a.createElement("div",{className:"material-library-view"},i.a.createElement(r.a,{defaultActiveKey:t.tabKey,onChange:t.onTabChange},i.a.createElement(Ht,{tab:__("插入小记"),key:Xt.note},i.a.createElement(zt,Wt({},e.note,{storage:n})))))}$t.propTypes={storage:c.a.object,webProxy:c.a.object,note:c.a.object}},3497:function(e,t,n){"use strict";var r=n(72),o=n.n(r),i=n(191),a={}.toString,c=function(e,t){return a.call(e)==="[object "+t+"]"};function u(e){return null==e}function l(e,t,n){try{return window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.currentStyle[t]}catch(e){return u(n)?null:n}}function s(e,t){var n=[];if(e){if(t&&!t(e))return n;for(var r=e.childNodes,o=0;o<r.length;o++){var i=r[o],a=i.nodeType;3===a?n.push(i):1!==a&&9!==a&&11!==a||(n=n.concat(s(i,t)))}}return n}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var o=g(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(a,e);var t,n,r,o=v(a);function a(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=o.call(this,e),!e.target)throw new Error("please set a dom element as target!");return t.options=m({target:null,style:{highlight:{fill:"rgba(255, 230, 0, 0.5)"},select:{fill:"rgba(255, 140, 0, 0.5)"}},filter:null},e),t.ranges=[],t._initTarget(),t._createCanvas(),t}return t=a,(n=[{key:"_initTarget",value:function(){var e=this.options.target;"static"===l(e,"position")&&(e.style.position="relative")}},{key:"_createCanvas",value:function(){var e=this.options.target,t=document.createElement("div");t.style.position="absolute",t.style.top=0,t.style.left=0,t.style["pointer-events"]="none",t.style["z-index"]=99,e.appendChild(t);var n=new i.TinyCanvas({container:t});this.container=t,this.canvas=n}},{key:"_resizeCanvas",value:function(){var e=this.options.target,t=this.canvas,n=function(e,t){var n=l(e,"width",t);return"auto"===n&&(n=e.offsetWidth),parseFloat(n)}(e),r=function(e,t){var n=l(e,"height",t);return"auto"===n&&(n=e.offsetHeight),parseFloat(n)}(e);t.resize(n,r)}},{key:"_getRelativeRect",value:function(e){var t=this.container,n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:n.left-r.left,y:n.top-r.top,width:n.right-n.left,height:n.bottom-n.top}}},{key:"_cacheRange",value:function(e){return{startOffset:e.startOffset,endOffset:e.endOffset,startContainer:e.startContainer,endContainer:e.endContainer,commonAncestorContainer:e.commonAncestorContainer}}},{key:"_isRangeWrap",value:function(e){var t=this._cacheRange(e);e.setEnd(t.startContainer,t.startOffset+1);var n=e.getBoundingClientRect();e.setEnd(t.startContainer,t.endOffset-1),e.setStart(t.endContainer,t.endOffset);var r=e.getBoundingClientRect();return e.setStart(t.startContainer,t.startOffset),e.setEnd(t.endContainer,t.endOffset),n.bottom!==r.bottom}},{key:"_drawOneByOne",value:function(e,t){for(var n=this._cacheRange(e),r=this.canvas,o=n.startOffset;o<n.endOffset;){e.setStart(n.commonAncestorContainer,o),e.setEnd(n.commonAncestorContainer,o+1);var i=this._getRelativeRect(e);r.clearRect(i),r.draw("Rect",m(m({},i),t)),o++}e.setStart(n.startContainer,n.startOffset),e.setEnd(n.endContainer,n.endOffset)}},{key:"_drawRangeBackground",value:function(e,t){var n=this.canvas;if(this._isRangeWrap(e))return this._drawOneByOne(e,t);var r=this._getRelativeRect(e);n.clearRect(r),n.draw("Rect",m(m({},r),t))}},{key:"_highlightRanges",value:function(e){var t=this;e.forEach((function(e){t._highlightRange(e)}))}},{key:"_clearRange",value:function(e){var t=this.canvas,n=this._getRelativeRect(e);t.clearRect(n)}},{key:"_highlightRange",value:function(e){var t=this.options.style.highlight;this._drawRangeBackground(e,t)}},{key:"_selectRange",value:function(e){var t=this.options.style.select;this._drawRangeBackground(e,t)}},{key:"_clearCanvas",value:function(){this.canvas.clear()}},{key:"_move",value:function(e){var t=this.selectedRange,n=this.ranges;if(t){var r=n.indexOf(t),o=n[r+e];o||(o=e>0?n[e-1]:n[n.length+e]),this._highlightRange(t),this.select(o),this.scrollIntoView()}}},{key:"_replace",value:function(e,t){var n=e.commonAncestorContainer.parentNode,r=document.createTextNode(t);"A"===n.tagName&&n.getAttribute("href")===n.innerText&&n.setAttribute("href",t),e.deleteContents(),e.insertNode(r)}},{key:"replace",value:function(e){if(!u(e)){var t=this.selectedRange;if(this.ranges.length>0){var n={range:t};this.emit("before:replace",n),this._replace(t,e),this._clearRange(t),this.emit("after:replace",n)}}}},{key:"replaceAll",value:function(e){var t=this;if(!u(e)){var n=this.ranges,r={ranges:n};this.emit("before:replaceAll",r),n.forEach((function(n){t._replace(n,e)})),this.emit("after:replaceAll",r),n.forEach((function(e){t._saveCardValue(e)})),this.clear()}}},{key:"show",value:function(){this.container.style.display=""}},{key:"hide",value:function(){this.container.style.display="none"}},{key:"find",value:function(e,t){var n=[];if(this.clear(),e&&c(e,"String")&&e.length>0){t=function(e){return c(e,"Function")}(t)?t:function(){return!0},this._resizeCanvas();var r=s(this.options.target,(function(e){return"none"!==e.style.display&&t(e)}));r.length>0&&(n=function(e,t){var n=[];return e.forEach((function(e){var r=e.nodeValue,o=t.length,i=function(e,t){for(var n=[],r=t.length,o=e.indexOf(t);o>-1;)n.push(o),o=e.indexOf(t,o+r);return n}((r||"").toLowerCase(),(t||"").toLowerCase());i.forEach((function(t){var r=document.createRange();r.setStart(e,t),r.setEnd(e,t+o),n.push(r)}))})),n}(r,e),this._highlightRanges(n),this.ranges=n,this.keyword=e)}return this.ranges=n,n}},{key:"reFind",value:function(){var e=this.selectedRangeIndex,t=this.find(this.keyword);if(t.length>0&&!u(e)){var n=t[e]?t[e]:t[0];this.select(n)}return t}},{key:"scrollIntoView",value:function(){if(this.selectedRange){var e=this.selectedRange.commonAncestorContainer.parentElement;(t=e.getBoundingClientRect()).top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||(e.scrollIntoView({block:"center"}),document.documentElement.scrollTop=0,document.body.scrollTop=0)}var t}},{key:"select",value:function(e){if(!u(e)){var t=this.ranges,n=e;c(e,"Number")&&(n=t[e]);var r={range:n};this.emit("before:select",r),this._selectRange(n),this.selectedRange=n,this.selectedRangeIndex=t.indexOf(n),this.emit("after:select",r)}}},{key:"next",value:function(){this._move(1)}},{key:"prev",value:function(){this._move(-1)}},{key:"findIndex",value:function(e){this._move(e)}},{key:"clear",value:function(){this._clearCanvas(),this.selectedRange=void 0,this.ranges=[],this.keyword=void 0}},{key:"count",value:function(){var e=this.ranges;if(0===e.length)return 0;var t=this.selectedRange;return[e.indexOf(t)+1,e.length]}},{key:"destroy",value:function(){var e=this.container;this.options=null,e.parentElement.removeChild(e)}}])&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a);t.a=w},3536:function(e,t,n){"use strict";var r=n(211),o=n.n(r),i=n(52);function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u={adaptAbilities:function(e){var t=e.me,n=e.comment,r=e.target_type,o=e.target,i={edit:!1,delete:!1};return t&&t.id===n.user_id?(i.edit=!0,i.delete=!0):"Doc"===r&&(i.delete=o.abilities&&o.abilities.destroy_comment),i},getPostActions:function(e,t){var n=[];return n.push({cmd:"copy_link",title:__("复制链接")}),n.push({cmd:"reply",title:__("评论")}),e.edit&&n.push({cmd:"edit",title:__("编辑")}),e.delete&&n.push({cmd:"delete",title:__("删除"),confirm:!0}),t&&n.push({cmd:"content_report",title:__("举报")}),n},includesHashAnchoredComment:function(e,t){if(!t||!t.startsWith("#comment-"))return!1;var n=parseInt(t.substring(9),10);return!!e.find((function(e){return e.id===n}))},getParticipants:function(e,t,n){var r=n.groupMembers,c=n.targetType,u=[];return"Doc"!==c&&"Resource"!==c||(e.contributors=e.contributors||[],u=a(e.contributors)),t&&t.length>0&&t.forEach((function(e){var t=u.find((function(t){return t&&e.user&&t.id===e.user.id}));e.user&&!t&&u.push(e.user)})),r&&r.length>0&&r.forEach((function(e){u.push(e.user)})),u=o()(u,"login"),window.appData.isYuque&&(u=u&&u.filter((function(e){return e.status!==i.STATUS.terminated}))),u},getAnchorId:function(e,t){return"comment-".concat(e)},TARGET_TYPES:["Doc","DocVersion","Resource","Artboard","Note"]};t.a=u},3542:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return w})),n.d(t,"m",(function(){return P})),n.d(t,"k",(function(){return q})),n.d(t,"i",(function(){return X})),n.d(t,"j",(function(){return ne})),n.d(t,"l",(function(){return le})),n.d(t,"h",(function(){return he})),n.d(t,"f",(function(){return Ee})),n.d(t,"d",(function(){return Pe})),n.d(t,"e",(function(){return Ne})),n.d(t,"g",(function(){return Ge})),n.d(t,"b",(function(){return Ke}));var r=n(80),o=n.n(r),i=n(3415),a=n(3324);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===c(i)?i:String(i)),r)}var o,i}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,r,a=s(c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a.apply(this,arguments)}return t=c,r=[{key:"getEmptyDocument",value:function(){return{format:o.a.FORMAT.LAKE,value:null}}}],(n=[{key:"getType",value:function(){var e=this.options.targetType;return e?"".concat(e,"_comment").toLowerCase():"comment"}},{key:"getCacheKey",value:function(){var e=this.options.replyId;return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(e,"/new"):"autosave/".concat(this.type)}},{key:"isMiniSize",value:function(){return this.options.useMiniGuide||this.options.isMiniSize||window.h5}},{key:"getDefaultFormat",value:function(){return i.a.getDefaultDocumentFormat()}},{key:"getEnableFullEditor",value:function(){return"Artboard"!==this.targetType}}])&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(a.a),m=p;function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===d(i)?i:String(i)),r)}var o,i}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(i,e);var t,n,r,o=b(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="Resource",e.useBelongAttach=!0,e.from="reply",o.call(this,e)}return t=i,(n=[{key:"getType",value:function(){return"area_comment"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(m),w=g;function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==_(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===_(i)?i:String(i)),r)}var o,i}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},O.apply(this,arguments)}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T(e);if(t){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(i,e);var t,n,r,o=j(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="Doc",e.useBelongAttach=!0,e.from="reply",o.call(this,e)}return t=i,(n=[{key:"buildOptions",value:function(e){var t,n=O(T(i.prototype),"buildOptions",this).call(this,e);return n.image.showMiniToolbarWhen="never",null===(t=n.disabledPlugins)||void 0===t||t.push("slash"),n}},{key:"getType",value:function(){return"word_comment"}},{key:"getAutoFocus",value:function(){return!1}},{key:"isMiniSize",value:function(){return!0}},{key:"getEnableFullEditor",value:function(){return!1}}])&&E(t.prototype,n),r&&E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(m),P=C,R=n(14),k=n.n(R),L=n(3387);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function I(e){var t=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===A(t)?t:String(t)}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var o=B(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var U={daily:{title:"#prefix# #day# 日报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>建议 TL 每天组织日会，将一天的重点事项安排于此</p><p>每位同学下班前，在此提交日报</p><p><br /></p><p>日报不要记流水账，尽量在 200 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的日报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},weekly:{title:"#prefix# #day# 周报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>将一周的工作总结回复于此</p><p><br /></p><p>不要记流水账，尽量在 800 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的周报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},vote:{title:"一起来投票吧",content:'<!doctype lake><meta name="doc-version" content="1" /><card type="block" name="vote" value="data:%7B%22margin%22%3Atrue%2C%22id%22%3A%22jTHWG%22%2C%22type%22%3A%22single%22%7D"></card><p><br /><cursor /></p>'},default:{title:"",content:"<!doctype lake><p></p>"}},G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(i,e);var t,n,r,o=F(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.apply(this,arguments)}return t=i,r=[{key:"getTemplate",value:function(e,t){var n=U[e];if(!n)return{title:null,content:null};var r=k()(new Date).format("YYYY-MM-DD"),o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);return o.title=o.title.replace("#prefix#",t),o.title=o.title.replace("#day#",r),o}}],(n=[{key:"getType",value:function(){return"thread"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.belongType||"Book","&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):this.group?"".concat(e,"&attachable_type=User&attachable_id=").concat(this.group.id,"&from=").concat(this.from):null}},{key:"getFileCopyUrl",value:function(){return this.isEditMode?"".concat("/api/upload/copy?type=attachment","&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):null}}])&&D(t.prototype,n),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(L.a),q=G;function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Y(i)?i:String(i)),r)}var o,i}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H(e);if(t){var o=H(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(i,e);var t,n,r,o=W(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"getType",value:function(){return"thread_board"}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode&&!this.options.useBelongAttach?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.belongType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}}])&&V(t.prototype,n),r&&V(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a),X=K;function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==J(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===J(i)?i:String(i)),r)}var o,i}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ee(e);if(t){var o=ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function ee(e){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ee(e)}var te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(i,e);var t,n,r,o=Q(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"getType",value:function(){return"thread_comment"}}])&&$(t.prototype,n),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(m),ne=te;function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===re(i)?i:String(i)),r)}var o,i}function ie(){return ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ie.apply(this,arguments)}function ae(e,t){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ae(e,t)}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ue(e);if(t){var o=ue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(i,e);var t,n,r,o=ce(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="User",e.useBelongAttach=!0,o.call(this,e)}return t=i,(n=[{key:"buildOptions",value:function(e){var t=ie(ue(i.prototype),"buildOptions",this).call(this,e);return t.typography={mustTypography:"classic",typography:"classic",paragraphSpacing:"default"},t}},{key:"getType",value:function(){return"user_readme"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&oe(t.prototype,n),r&&oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==se(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===se(i)?i:String(i)),r)}var o,i}function pe(){return pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ye(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},pe.apply(this,arguments)}function me(e,t){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},me(e,t)}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ye(e);if(t){var o=ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ye(e)}var he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(i,e);var t,n,r,o=de(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="Doc",e.useBelongAttach=!0,e.disableCache=!0,e.from="table",o.call(this,e)}return t=i,(n=[{key:"buildOptions",value:function(e){var t=pe(ye(i.prototype),"buildOptions",this).call(this,e);return t.typography={mustTypography:"classic",typography:"classic",paragraphSpacing:"default"},this.options.scrollNode&&(t.scrollNode=this.options.scrollNode),t}},{key:"getType",value:function(){return"table_record_desc"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!1}},{key:"getInitialDocument",value:function(){return{format:this.getDefaultFormat(),title:null,value:null}}}])&&fe(t.prototype,n),r&&fe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===be(i)?i:String(i)),r)}var o,i}function ge(e,t){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ge(e,t)}function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_e(e);if(t){var o=_e(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t)}(i,e);var t,n,r,o=we(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.from="group_custom",e.attachType="User",e.useBelongAttach=!0,o.call(this,e)}return t=i,(n=[{key:"getType",value:function(){return"group_custom"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Oe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Oe(i)?i:String(i)),r)}var o,i}function je(e,t){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},je(e,t)}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&je(e,t)}(i,e);var t,n,r,o=Te(i);function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var t=e.feedback;return e.attachType="User",e.useBelongAttach=!0,e.from="feedback",e.placeholder={tip:t&&t.abilities.manage?"你将要代表语雀回复用户，请使用官方口吻，慎重填写":"",emptyParagraphTip:""},o.call(this,e)}return t=i,(n=[{key:"getType",value:function(){return"feedback_comment"}},{key:"getCacheKey",value:function(){var e=this.getType();if(this.target)return"autosave/".concat(e,"/").concat(this.target.id,"/edit");var t=this.options.feedback;return t?"autosave/".concat(e,"/").concat(t.id,"/new"):"autosave/".concat(e)}},{key:"getContentObject",value:function(){var e=this.target.content||{source:"",format:"lake"};return{format:e.format,value:e.source||""}}},{key:"isMiniSize",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}}])&&Se(t.prototype,n),r&&Se(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(L.a);function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Re(i)?i:String(i)),r)}var o,i}function Le(e,t){return Le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Le(e,t)}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xe(e);if(t){var o=xe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(e)}var Ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Le(e,t)}(i,e);var t,n,r,o=Ae(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="User",e.useBelongAttach=!0,e.placeholder={tip:"",emptyParagraphTip:""},e.from="feedback",o.call(this,e)}return t=i,(n=[{key:"getType",value:function(){return"feedback_remark"}},{key:"getContentObject",value:function(){return{format:"lake",value:this.target.remark||""}}},{key:"getCacheKey",value:function(){return this.target?"autosave/".concat(this.type,"/").concat(this.target.id):"autosave/".concat(this.type)}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&ke(t.prototype,n),r&&ke(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(L.a);function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==De(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===De(i)?i:String(i)),r)}var o,i}function Me(){return Me="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ue(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Me.apply(this,arguments)}function Fe(e,t){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fe(e,t)}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ue(e);if(t){var o=Ue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Ue(e){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ue(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}(i,e);var t,n,r,o=Be(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.target&&(e.attachType="Doclet"),o.call(this,e)}return t=i,(n=[{key:"getCards",value:function(){return this.options.target?Me(Ue(i.prototype),"getCards",this).call(this):["label"]}},{key:"getFullCards",value:function(){return this.options.target?Me(Ue(i.prototype),"getFullCards",this).call(this):["label"]}},{key:"getType",value:function(){return"org_board"}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return!1}}])&&Ie(t.prototype,n),r&&Ie(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==qe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===qe(i)?i:String(i)),r)}var o,i}function Ve(){return Ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=He(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ve.apply(this,arguments)}function ze(e,t){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ze(e,t)}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=He(e);if(t){var o=He(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function He(e){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},He(e)}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}(i,e);var t,n,r,o=We(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="Doclet",o.call(this,e)}return t=i,(n=[{key:"buildOptions",value:function(e){var t=Ve(He(i.prototype),"buildOptions",this).call(this,e);return t.disabledPlugins=["collaboration","vote","checkIn","toc","dataTable","materialLibrary","okr"],t.typography={typography:"classic",paragraphSpacing:"relax"},t}},{key:"getType",value:function(){return"book_overview"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&Ye(t.prototype,n),r&&Ye(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a)},3547:function(e,t,n){"use strict";var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}var a=function(e,t){this.target=t,this.type=e},c=function(e){function t(t,n){var r=e.call(this,"error",n)||this;return r.message=t.message,r.error=t,r}return o(t,e),t}(a),u=function(e){function t(t,n,r){void 0===t&&(t=1e3),void 0===n&&(n="");var o=e.call(this,"close",r)||this;return o.wasClean=!0,o.code=t,o.reason=n,o}return o(t,e),t}(a),l=function(){if("undefined"!=typeof WebSocket)return WebSocket},s={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},f=function(){function e(e,t,n){var r=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){r._debug("open event");var t=r._options.minUptime,n=void 0===t?s.minUptime:t;clearTimeout(r._connectTimeout),r._uptimeTimeout=setTimeout((function(){return r._acceptOpen()}),n),r._ws.binaryType=r._binaryType,r._messageQueue.forEach((function(e){return r._ws.send(e)})),r._messageQueue=[],r.onopen&&r.onopen(e),r._listeners.open.forEach((function(t){return r._callEventListener(e,t)}))},this._handleMessage=function(e){r._debug("message event"),r.onmessage&&r.onmessage(e),r._listeners.message.forEach((function(t){return r._callEventListener(e,t)}))},this._handleError=function(e){r._debug("error event",e.message),r._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),r.onerror&&r.onerror(e),r._debug("exec error listeners"),r._listeners.error.forEach((function(t){return r._callEventListener(e,t)})),r._connect()},this._handleClose=function(e){r._debug("close event"),r._clearTimeouts(),r._shouldReconnect&&r._connect(),r.onclose&&r.onclose(e),r._listeners.close.forEach((function(t){return r._callEventListener(e,t)}))},this._url=e,this._protocols=t,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce((function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e}),0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,n=void 0===t?s.maxEnqueuedMessages:t;this._messageQueue.length<n&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,n,r=this._listeners[e.type];if(r)try{for(var o=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(r),i=o.next();!i.done;i=o.next()){var a=i.value;this._callEventListener(e,a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter((function(e){return e!==t})))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e}(["RWS>"],e))},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?s.reconnectionDelayGrowFactor:t,r=e.minReconnectionDelay,o=void 0===r?s.minReconnectionDelay:r,i=e.maxReconnectionDelay,a=void 0===i?s.maxReconnectionDelay:i,c=0;return this._retryCount>0&&(c=o*Math.pow(n,this._retryCount-1))>a&&(c=a),this._debug("next delay",c),c},e.prototype._wait=function(){var e=this;return new Promise((function(t){setTimeout(t,e._getNextDelay())}))},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,r=void 0===n?s.maxRetries:n,o=t.connectionTimeout,i=void 0===o?s.connectionTimeout:o,a=t.WebSocket,c=void 0===a?l():a;if(this._retryCount>=r)this._debug("max retries reached",this._retryCount,">=",r);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(u=c)||!u||2!==u.CLOSING)throw Error("No valid WebSocket class provided");var u;this._wait().then((function(){return e._getNextUrl(e._url)})).then((function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new c(t,e._protocols):new c(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout((function(){return e._handleTimeout()}),i))}))}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new c(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new u(e,t,this))}catch(e){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();t.a=f},3596:function(e,t,n){"use strict";var r=n(3547),o=n(72),i=n.n(o),a=n(212),c=n.n(a),u=n(65);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,n)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===l(t)?t:String(t)}var g=new(n.n(u).a)("connect_base"),w={connectionTimeout:2e4,maxRetries:0,heartBeatInterval:1e4,congestionTimeout:8e3},_="connecting",E="offline",O="connected",S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var t,n,o,i=d(a);function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),b(y(t=i.call(this)),"onOpen",(function(){g("connected"),t.status=O,t.stopCongestionMonitor(),t.emit("ready",t.socket),t._heartBeat=null})),b(y(t),"onClose",(function(e){g("close",{retryCount:t.socket.retryCount,readyState:t.socket.readyState}),t.disconnect(),t.emit("close",e)})),b(y(t),"onMessage",(function(e){try{var n=JSON.parse(e.data);t.pong(n),g("message",n)}catch(t){g("invalid message",e.data)}})),b(y(t),"onError",(function(e){g("error",{message:e.message,retryCount:t.socket.retryCount,readyStatus:t.socket.readyState,error:e}),"TIMEOUT"===e.message&&(t.status=E),t.emit("error",e)})),t.url=e,t.socket=null,t.status=null,t._heartBeat=null,t.heartBeatInterval=n.heartBeatInterval||w.heartBeatInterval,t.option=f(f({},w),n),t.connect(),t}return t=a,(n=[{key:"connect",value:function(){this.status=_;var e=new r.a(this.url,[],this.option);this.socket=e,e.addEventListener("open",this.onOpen),e.addEventListener("close",this.onClose),e.addEventListener("message",this.onMessage),e.addEventListener("error",this.onError),this.startCongestionMonitor()}},{key:"startCongestionMonitor",value:function(){var e=this;this.stopCongestionMonitor(),this.congestTimer=setTimeout((function(){e.emit("congestion")}),this.option.congestionTimeout)}},{key:"stopCongestionMonitor",value:function(){this.congestTimer&&clearTimeout(this.congestTimer)}},{key:"disconnect",value:function(){this.stopHeartBeat(),this.stopCongestionMonitor(),this.socket&&(this.socket.removeEventListener("open",this.onOpen),this.socket.removeEventListener("close",this.onClose),this.socket.removeEventListener("message",this.onMessage),this.socket.removeEventListener("error",this.onError),this.socket.close(),this.socket=null),this.status=E}},{key:"ping",value:function(){var e=this;if(this.socket){var t={action:"heartbeat",pingId:c()(10),pingAt:+new Date};this._heartBeat&&this.transmitNetStatus("congestion"),this._heartBeat=t,this.socket.send(JSON.stringify(t)),g("ping",t),this.status!==E&&(this.pingTimer=setTimeout((function(){e.ping()}),this.heartBeatInterval))}}},{key:"pong",value:function(e){e&&"heartbeat"===e.action&&this._heartBeat&&this._heartBeat.pingId===e.pingId&&(new Date-this._heartBeat.pingAt>this.option.congestionTimeout?(this.transmitNetStatus("congestion"),g("pong congestion")):(this.transmitNetStatus("congestionEnd"),g("pong congestionEnd")),this._heartBeat=null)}},{key:"transmitNetStatus",value:function(e){this.netStatus!==e&&(this.emit(e),this.netStatus=e)}},{key:"stopHeartBeat",value:function(){g("stopHeartBeat"),this.pingTimer&&clearTimeout(this.pingTimer)}},{key:"startHeartBeat",value:function(){var e=this;g("startHeartBeat"),this.pingTimer=setTimeout((function(){e.ping()}),1e3)}},{key:"broadcast",value:function(e,t){if(this.socket){var n={action:"broadcast",data:{type:e,body:t,sender:t.user}};g("broadcast",n),this.socket.send(JSON.stringify(n))}}}])&&p(t.prototype,n),o&&p(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a);t.a=S},3614:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s}));var r=n(0),o=n(1212);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function c(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"leftSidebarWidth",get:function(){return this._leftSidebarWidth}},{key:"rightSidebarWidth",get:function(){return this._rightSidebarWidth}},{key:"addChangedListener",value:function(e){var t=this;return this._listeners.push(e),function(){return t.removeChangedListener(e)}}},{key:"removeChangedListener",value:function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))}},{key:"handleSidebarWidthChange",value:function(e){var t=e.leftWidth,n=e.rightWidth;null!=t&&this._leftSidebarWidth!==t&&(this._leftSidebarWidth=t,this._listeners.forEach((function(e){var n;null===(n=e.onLeftSidebarWidth)||void 0===n||n.call(e,t)}))),null!=n&&this._rightSidebarWidth!==n&&(this._rightSidebarWidth=n,this._listeners.forEach((function(e){var t;null===(t=e.onRightSidebarWidth)||void 0===t||t.call(e,n)})));var r=document.getElementsByClassName("main-wrapper")[0];if(r){var o=this._leftSidebarWidth+this._rightSidebarWidth;r.style.width="calc(100vw - ".concat(o,"px)"),r.style["margin-left"]="".concat(this._leftSidebarWidth,"px"),r.style["margin-right"]="".concat(this._rightSidebarWidth,"px"),window.dispatchEvent(new CustomEvent("DashboardSideBar.resize",{detail:{leftSidebarWidth:this._leftSidebarWidth,rightSidebarWidth:this._rightSidebarWidth}}))}}}],(n=null)&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(){var e=Object(o.a)();return Object(r.useEffect)((function(){return l.addChangedListener({onRightSidebarWidth:e})}),[]),{rightSidebarWidth:l.rightSidebarWidth}}c(l,"_leftSidebarWidth",0),c(l,"_rightSidebarWidth",0),c(l,"_listeners",[])},3663:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(11),o=n(181),i=function(e,t,n){var i=window.appData.note;return i?1===i.public:(e=e||window.appData.group,t=t||window.appData.book,n=n||window.appData.doc,!(!e||!t)&&(n?Object(o.c)({type:"doc",target:n,group:e,book:t}):Object(o.c)({type:"book",target:t,group:e}))===r.PRIVACY.public)},a=function(e,t,n){var r=window.appData.note;return r?!!r.is_public:(e=e||window.appData.share,t=t||window.appData.book,n=n||window.appData.doc,!!(e&&t&&n&&n.book_id===t.id)&&(0===e.status&&0===e.scope&&(e.target_id===n.book_id||e.target_id===n.id)))}},3678:function(e,t,n){"use strict";var r,o=[{id:1,title:__("加油")},{id:2,title:__("开心")},{id:3,title:__("很忙")},{id:4,title:__("想哭")},{id:5,title:__("生气")}],i=(r={},o.forEach((function(e){r[e.id]=e})),r),a=[{id:"thumbs_up",title:__("支持"),icon:"https://gw.alipayobjects.com/zos/basement_prod/40dd7f62-e6ad-48c6-b2c1-aeed729ff753.svg"},{id:"thumbs_down",title:__("反对"),icon:"https://gw.alipayobjects.com/zos/basement_prod/49753f89-a52b-47f8-8dff-ca2b7d5ab29e.svg"},{id:"applause",title:__("喝彩"),icon:"https://gw.alipayobjects.com/zos/basement_prod/39b96288-777c-4ad9-8065-fe27ee2366d5.svg"},{id:"momo",title:__("摸摸"),icon:"https://gw.alipayobjects.com/zos/basement_prod/486defba-93e3-4151-8b23-6fb09dfb7f97.svg"},{id:"+1",title:__("+1"),icon:"https://gw.alipayobjects.com/zos/bmw-prod/cd3682d7-3cc9-44a1-87d3-1feb83baee73.svg"},{id:"OK",title:"OK",icon:"https://gw.alipayobjects.com/zos/bmw-prod/70ec25dc-2ad6-42f3-b802-76ba015becde.svg"}],c=function(){var e={};return a.forEach((function(t){e[t.id]=t})),e}(),u={REACTIONS:a,getMoodTitleById:function(e){return(i[e]||{}).title||""},getPostUrl:function(e){var t=window.location.hash||"",n=window.location.href;return n=n.substring(0,n.length-t.length),"".concat(n,"#comment-").concat(e)},classifyReactions:function(e){var t=Object.keys(c),n={};return t.forEach((function(e){n[e]={count:0,user_ids:[]}})),e.forEach((function(e){e.action_option.split(",").forEach((function(t){n[t]&&(n[t].count++,n[t].user_ids.push(e.user_id))}))})),n},getReactionById:function(e){return c[e]}};t.a=u},3691:function(e,t,n){"use strict";n.r(t);n(176);var r=n(64),o=(n(71),n(31)),i=(n(151),n(66)),a=n(0),c=n.n(a),u=n(2),l=n.n(u),s=n(502),f=n.n(s),p=n(5),m=n.n(p),d=n(78),y=n(145),h=n(52),b=n(45),v={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t=e.icon,n=e.content,r=e.style,o=e.showClose,i=g(Object(a.useState)(!0),2),u=i[0],l=i[1];return u?c.a.createElement("div",{className:v.wrap,style:r},t&&c.a.createElement("div",{className:v.icon},t),c.a.createElement("div",{className:v.content},n),o&&c.a.createElement("div",{className:v.close,onClick:function(){l(!1)}},c.a.createElement("span",{className:m()("lake-icon","lake-icon-close",v.closeIcon)}))):null};_.propTypes={icon:l.a.node,content:l.a.node.isRequired,style:l.a.object,showClose:l.a.bool};var E=_,O=n(302),S="ReaderAudit-module_closeBtn_hHU+3",j="ReaderAudit-module_detail_mWCgN",T="ReaderAudit-module_toggleDetail_pq7CA",C="ReaderAudit-module_moreLink_oxcCo",P="ReaderAudit-module_tagModeWrapper_xupeI",R="ReaderAudit-module_tagText_Womh9",k="ReaderAudit-module_pending_m3C28",L="ReaderAudit-module_illegal_B8aJ7",A="ReaderAudit-module_banned_sHuxy",x="ReaderAudit-module_isIntranet_WPBjb",N="ReaderAudit-module_tagClose_YIxR7";function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G(e){var t,n=B(Object(a.useState)(!1),2),u=n[0],l=n[1],s=B(Object(a.useState)(!0),2),p=s[0],v=s[1],g=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,w=e.doc,_=e.type,O=e.tagMode,D=w.audits,I=w.read_status,U=w.id,G=w.content_updated_at,q=w.abilities,Y=void 0===q?{}:q,V=window.appData,z=V.book,W=V.group,H=V.me,K=e.isYuque||window.appData.isYuque;var X="audit_ignored_".concat(_,"_").concat(U);function J(e){null==e||e.preventDefault(),localStorage.setItem(X,Date.now()),v(!1)}function $(e){var t=e.filter((function(e){return null!==e}));return f()(t)}if(Object(a.useEffect)((function(){if(I===d.READ_STATUS.insecure)if(H.isAdmin||Y.update){if(!g){var e=localStorage.getItem(X);if(e&&G){var t=new Date(G).getTime();v(t>e)}}}else v(!1)}),[]),I<=d.READ_STATUS.ok&&(null==z?void 0:z.status)!==y.STATUS.banned&&(null==W?void 0:W.status)!==h.STATUS.blocked)return null;if(I<=d.READ_STATUS.ok&&((null==z?void 0:z.status)===y.STATUS.banned||(null==W?void 0:W.status)===h.STATUS.blocked))return null!=H&&H.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==W?void 0:W.status)===h.STATUS.blocked,", bookBlocked: ").concat((null==z?void 0:z.status)===y.STATUS.banned)),null;if(null!=W&&W.isPermanentPunished)return null!=H&&H.isAdmin&&I>d.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===_&&I<=d.READ_STATUS.ok)return null;if(!p)return null;var Z=[];D&&(D.forbidden||D.reason)&&(Z=D.forbidden||[D.reason]);var Q,ee={};if(ee[d.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),ee[d.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),ee[d.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[d.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[d.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[d.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[d.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),K)Q=ee[I]||ee[d.READ_STATUS.suspect];else{var te=!O&&Z.length>0?c.a.createElement("a",{onClick:function(e){e.preventDefault(),l(!u)},className:T},u?"收起详情":"展开详情"):null,ne=c.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:C},__("了解更多"));Q=g||I!==d.READ_STATUS.insecure?c.a.createElement(c.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),ne,te," "):c.a.createElement(c.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ne,te)}var re=K?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(O){if(K){var oe,ie,ae,ce,ue=(F(oe={},d.READ_STATUS.pending,__("审核中")),F(oe,d.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),F(oe,d.READ_STATUS.banned,__("该内容已屏蔽#tag")),oe);switch(I){case d.READ_STATUS.pending:case d.READ_STATUS.suspect:ce=d.READ_STATUS.pending;break;case d.READ_STATUS.illegal:case d.READ_STATUS.illegal_polity:case d.READ_STATUS.illegal_ak:case d.READ_STATUS.illegal_privacy:ce=d.READ_STATUS.illegal;break;case d.READ_STATUS.banned:ce=d.READ_STATUS.banned;break;default:ce=null}return(ae=ue[ce])?c.a.createElement(i.a,{title:c.a.createElement("span",{className:R},Q),placement:"bottom"},c.a.createElement("div",{className:m()(P,(ie={},F(ie,k,ce===d.READ_STATUS.pending),F(ie,L,ce===d.READ_STATUS.illegal),F(ie,A,ce===d.READ_STATUS.banned),ie))},c.a.createElement("span",{className:R},ae))):null}return c.a.createElement("div",{className:m()(P,x),onClick:function(){o.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:c.a.createElement(c.a.Fragment,null,Q,Z.length>0&&c.a.createElement("ul",{className:j},$(Z).map((function(e){return c.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){J()}})}},c.a.createElement("span",{className:R},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),c.a.createElement("div",{className:N,onClick:function(e){e.stopPropagation(),J()}},c.a.createElement(b.b,{name:"close",width:10,height:10})))}return c.a.createElement(E,{style:M({marginBottom:"Doc"===_?24:0,marginTop:4},re),icon:c.a.createElement(b.b,{name:"doc-has-content-risk",height:17,width:15}),content:c.a.createElement(c.a.Fragment,null,!K&&c.a.createElement(r.a,{title:__("确认忽略该提醒？"),onConfirm:J,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},c.a.createElement("span",{className:S},c.a.createElement(b.b,{name:"close",width:14}))),c.a.createElement("span",{"data-testid":"audit-tip"},Q),u&&c.a.createElement("ul",{className:j},$(Z).map((function(e){return c.a.createElement("li",{key:e},e)}))))})}G.defaultProps={isYuque:window.appData.isYuque},G.propTypes={doc:l.a.object.isRequired,type:l.a.string,isYuque:l.a.bool,tagMode:l.a.bool};t.default=Object(O.b)(G)},3752:function(e,t,n){},3768:function(e,t,n){e.exports=n(3775)},3775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=c(o),a=c(n(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollListener=n.scrollListener.bind(n),n.eventListenerOptions=n.eventListenerOptions.bind(n),n.mousewheelListener=n.mousewheelListener.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}},{key:"componentDidUpdate",value:function(){if(this.props.isReverse&&this.loadMore){var e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}},{key:"componentWillUnmount",value:function(){this.detachScrollListener(),this.detachMousewheelListener()}},{key:"isPassiveSupported",value:function(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(e){}return e}},{key:"eventListenerOptions",value:function(){this.props.useCapture;return this.isPassiveSupported()?{useCapture:this.props.useCapture,passive:!0}:{passive:!1}}},{key:"setDefaultLoader",value:function(e){this.defaultLoader=e}},{key:"detachMousewheelListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}},{key:"detachScrollListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}},{key:"getParentElement",value:function(e){var t=this.props.getScrollParent&&this.props.getScrollParent();return null!=t?t:e&&e.parentNode}},{key:"filterProps",value:function(e){return e}},{key:"attachScrollListener",value:function(){var e=this.getParentElement(this.scrollComponent);if(this.props.hasMore&&e){var t=window;!1===this.props.useWindow&&(t=e),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}}},{key:"mousewheelListener",value:function(e){1!==e.deltaY||this.isPassiveSupported()||e.preventDefault()}},{key:"scrollListener",value:function(){var e=this.scrollComponent,t=window,n=this.getParentElement(e),r=void 0;if(this.props.useWindow){var o=document.documentElement||document.body.parentNode||document.body,i=void 0!==t.pageYOffset?t.pageYOffset:o.scrollTop;r=this.props.isReverse?i:this.calculateOffset(e,i)}else r=this.props.isReverse?n.scrollTop:e.scrollHeight-n.scrollTop-n.clientHeight;r<Number(this.props.threshold)&&e&&null!==e.offsetParent&&(this.detachScrollListener(),this.beforeScrollHeight=n.scrollHeight,this.beforeScrollTop=n.scrollTop,"function"==typeof this.props.loadMore&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}},{key:"calculateOffset",value:function(e,t){return e?this.calculateTopPosition(e)+(e.offsetHeight-t-window.innerHeight):0}},{key:"calculateTopPosition",value:function(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}},{key:"render",value:function(){var e=this,t=this.filterProps(this.props),n=t.children,r=t.element,o=t.hasMore,a=(t.initialLoad,t.isReverse),c=t.loader,u=(t.loadMore,t.pageStart,t.ref),l=(t.threshold,t.useCapture,t.useWindow,t.getScrollParent,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["children","element","hasMore","initialLoad","isReverse","loader","loadMore","pageStart","ref","threshold","useCapture","useWindow","getScrollParent"]));l.ref=function(t){e.scrollComponent=t,u&&u(t)};var s=[n];return o&&(c?a?s.unshift(c):s.push(c):this.defaultLoader&&(a?s.unshift(this.defaultLoader):s.push(this.defaultLoader))),i.default.createElement(r,l,s)}}]),t}(o.Component);u.propTypes={children:a.default.node.isRequired,element:a.default.node,hasMore:a.default.bool,initialLoad:a.default.bool,isReverse:a.default.bool,loader:a.default.node,loadMore:a.default.func.isRequired,pageStart:a.default.number,ref:a.default.func,getScrollParent:a.default.func,threshold:a.default.number,useCapture:a.default.bool,useWindow:a.default.bool},u.defaultProps={element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null},t.default=u,e.exports=t.default},3797:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n.n(r),i=n(2),a=n.n(i);function c(e){var t=e.disableLink,n=e.url,r=e.children,i=e.className,a=e.target,c=e.rel,u=e.dataAspmClick,l=e.title,s=e.desktopTarget;return o.a.createElement("a",{href:t?"#":n,className:i,target:a,rel:c,title:l,"data-aspm-click":u,"data-desktoptarget":s||""},r)}c.propTypes={disableLink:a.a.bool,url:a.a.string,children:a.a.arrayOf(a.a.element),className:a.a.string,rel:a.a.string,target:a.a.string,dataAspmClick:a.a.string,title:a.a.string}},3801:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(469),a=n(2),c=n.n(a),u=n(1329),l=n(587),s=n(1452);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===f(i)?i:String(i)),r)}var o,i}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var t,n,r,i=d(a);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"componentDidMount",value:function(){Object(s.b)()}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.children,r=e.place,i=e.registerWithScene;return!window.appData.isYuque||t&&t.id?n:"comment"===r?o.a.createElement("div",{className:"comment-action"},__("{registerLogin} 语雀进行评论",{registerLogin:o.a.createElement("a",{onClick:function(){l.a.login()},"data-aspm-click":"d65962"},__("注册 / 登录"))})):o.a.createElement("div",{className:"login-action"},o.a.createElement(u.default.Login,{registerWithScene:i}))}}])&&p(t.prototype,n),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.Component);h.propTypes={me:c.a.object,place:c.a.string,children:c.a.node,registerWithScene:c.a.bool};t.a=Object(i.d)((function(e){return{me:e.me}}))(h)},3819:function(e,t,n){},3820:function(e,t,n){"use strict";n(71);var r=n(31),o=n(0),i=n.n(o),a=n(2),c=n.n(a),u=n(160),l=n.n(u),s=n(469),f=n(3826);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var m=["children"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(){b=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:P(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var m="suspendedStart",d="suspendedYield",y="executing",h="completed",v={};function g(){}function w(){}function _(){}var E={};l(E,a,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(x([])));S&&S!==n&&r.call(S,a)&&(E=S);var j=_.prototype=g.prototype=Object.create(E);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==p(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,n,r){var o=m;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===h){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=R(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===m)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?h:d,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=h,r.method="throw",r.arg=l.arg)}}}function R(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,R(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(p(t)+" is not iterable")}return w.prototype=_,o(j,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,u,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},T(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(j),l(j,u,"Generator"),l(j,a,(function(){return this})),l(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}function g(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=function(e){var t=_(Object(o.useState)(!1),2),n=t[0],a=t[1];function c(){a(!1)}function u(){var t;return t=b().mark((function t(){return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dispatch({type:"proxy.web/contentReport.check",payload:{data:{target_id:e.targetId,target_type:e.targetType,token:window.appData.sharePage&&window.appData.share.token}}});case 2:a(!0);case 3:case"end":return t.stop()}}),t)})),u=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){w(i,r,o,a,c,"next",e)}function c(e){w(i,r,o,a,c,"throw",e)}a(void 0)}))},u.apply(this,arguments)}var l=e.children,s=g(e,m);return i.a.createElement(i.a.Fragment,null,l({onShowPanel:function(){return u.apply(this,arguments)}}),i.a.createElement(r.a,{destroyOnClose:!0,title:null,footer:null,visible:n,onCancel:c},i.a.createElement(f.default,v({},s,{onClose:c}))))};O.propTypes=y(y({},l()(f.default.propTypes,["targetId","targetType"])),{},{token:c.a.string,children:c.a.func.isRequired}),t.a=Object(s.d)()(O)},3826:function(e,t,n){"use strict";n.r(t);n(41);var r=n(10),o=(n(42),n(9)),i=(n(187),n(48)),a=(n(56),n(12)),c=n(0),u=n.n(c),l=n(2),s=n.n(l),f=n(469),p=n(1208),m=n.n(p),d=n(150),y="ReportForm-module_container_CFFvb",h="ReportForm-module_title_NFreI",b="ReportForm-module_subtitle_iS17z",v="ReportForm-module_reportType_F9Aq+",g="ReportForm-module_reportTypeItem_fcNpj",w="ReportForm-module_btns_P3Kpd",_="ReportForm-module_reportReason_Ll05f",E="ReportForm-module_backBtn_Epa1y";function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function S(){S=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:P(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(x([])));E&&E!==n&&r.call(E,a)&&(w=E);var j=g.prototype=b.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==O(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function P(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=R(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function R(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,R(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(O(t)+" is not iterable")}return v.prototype=g,o(j,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},T(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(j),l(j,u,"Generator"),l(j,a,(function(){return this})),l(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function j(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return L(e)}(this,n)}}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function x(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===O(t)?t:String(t)}var D=[{name:__("含有广告等引导性内容"),type:"normal",code:d.REPORT_TYPE.ad},{name:__("含有辱骂等不友善内容"),type:"normal",code:d.REPORT_TYPE.abuse},{name:__("含有色情、淫秽内容"),type:"normal",code:d.REPORT_TYPE.vulgar},{name:__("含有反社会、血腥暴力等内容"),type:"normal",code:d.REPORT_TYPE.political},{name:__("“清朗”系列专项举报"),type:"normal",code:d.REPORT_TYPE.clearnet},{name:__("传播不实信息（政治类、财经类、疫情类等）"),type:"normal",code:d.REPORT_TYPE.infact},{name:__("国家企业敏感信息泄露"),type:"normal",code:d.REPORT_TYPE.sensitive},{name:__("其他违法犯罪（如毒品、枪支、违规借贷等）"),type:"normal",code:d.REPORT_TYPE.illegal},{name:__("侵犯知识产权"),type:"tort"}],I=[{name:__("个人侵权"),type:"tort",code:d.REPORT_TYPE.personal_tort},{name:__("企业侵权"),type:"tort",code:d.REPORT_TYPE.enterprise_tort}],M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(l,e);var t,n,r,c=k(l);function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x(L(e=c.call.apply(c,[this].concat(n))),"handleSubmit",(function(t){t.preventDefault();var n=e.props,r=n.onOk;(0,n.form.validateFields)((function(e,t){e||r(t)}))})),e}return t=l,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(i.a,null,u.a.createElement("div",{className:b},__("具体说明")),u.a.createElement(i.a.Item,{required:!1},e("reason",{validateFirst:!0,rules:[{required:!0,max:500,message:__("请输入举报原因（字数不多于500）")}]})(u.a.createElement(a.a.TextArea,{className:_,rows:5,maxLength:500,placeholder:__("举报原因（字数不多于 500）")}))),u.a.createElement("div",{className:w},u.a.createElement(o.a,{block:!0,onClick:this.props.onCancel},__("返回")),u.a.createElement(o.a,{block:!0,type:"primary",htmlType:"submit",onClick:this.handleSubmit},__("提交"))))}}])&&P(t.prototype,n),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(u.a.PureComponent);x(M,"propTypes",{onOk:s.a.func.isRequired,onCancel:s.a.func.isRequired,form:s.a.object.isRequired});var F=i.a.create()(M),B=function(e){var t=e.onCancel,n=e.onOk;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:b},window.h5?__("侵权类举报请到 PC 端完成"):__("请选择类型")),!window.h5&&u.a.createElement("ul",{className:v},I.map((function(e,t){return u.a.createElement("li",{key:e.code||t,className:g,onClick:function(){return function(e){n(e)}(e)}},e.name)}))),u.a.createElement(o.a,{block:!0,className:E,onClick:function(){t()}},__("返回")))};B.propTypes={onOk:s.a.func.isRequired,onCancel:s.a.func.isRequired};var U=function(e){var t=T(Object(c.useState)(),2),n=t[0],o=t[1];function i(e,t){t.preventDefault(),o(e)}var a=function(t){return function(){var n,o=(n=S().mark((function n(o){var i,a;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=window.appData.sharePage&&window.appData.share.token,"tort"!==t.type){n.next=6;break}return e.onClose(),a=m.a.stringify({report_type:o.code,target_id:e.targetId,target_type:e.targetType,token:i}),window.open("/r/content_reports?".concat(a)),n.abrupt("return");case 6:return n.next=8,e.dispatch({type:"proxy.web/contentReport.create",payload:{data:{report_type:t.code,target_id:e.targetId,target_type:e.targetType,token:i,meta:{reason:o.reason,referer_url:window.location.href}}}});case 8:e.onClose(),r.a.success(__("已收到你的举报，感谢反馈"));case 10:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){j(i,r,o,a,c,"next",e)}function c(e){j(i,r,o,a,c,"throw",e)}a(void 0)}))});return function(e){return o.apply(this,arguments)}}()};function l(){o(null)}return n?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:h},n.name),"tort"===n.type?u.a.createElement(B,{onOk:a(n),onCancel:l}):u.a.createElement(F,{onOk:a(n),onCancel:l})):u.a.createElement("div",{className:y},u.a.createElement("div",{className:h},__("举报")),u.a.createElement("div",{className:b},__("请选举报原因")),u.a.createElement("ul",{className:v},D.map((function(e,t){return u.a.createElement("li",{key:e.code||t,onClick:i.bind(null,e)},u.a.createElement("div",{className:g},e.name))}))))};U.propTypes={targetId:s.a.number.isRequired,targetType:s.a.oneOf(["Doc"]).isRequired,onClose:s.a.func.isRequired};t.default=Object(f.d)()(U)},3849:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n(0),o=n.n(r),i=n(2),a=n(154),c={bookTips:"index-module_bookTips_cZ25F",groupTips:"index-module_groupTips_znta0",commentTips:"index-module_commentTips_eS4uK"};function u(e){var t=e.targetType,n=o.a.createElement("a",{href:"https://www.yuque.com/yuque/cdgcvd/zsw0w0",className:"wording-comment-link",target:"_blank",style:{marginLeft:"8px"}},__("了解更多"));switch(t){case"Book":return o.a.createElement("span",{className:c.bookTips,"data-testid":"forbid-tip"},__("注册 7 天后可设置为互联网可见 {learnMoreLink}",{learnMoreLink:n}));case"Group":return o.a.createElement("div",{className:c.groupTips,"data-testid":"forbid-tip"},__("注册 7 天后，即可创建知识小组 {learnMoreLink}",{learnMoreLink:n}));default:return o.a.createElement("span",{className:c.commentTips,"data-testid":"forbid-tip"},__("注册 7 天后即可参与评论 {learnMoreLink}",{learnMoreLink:n}))}}function l(e,t){var n,r=window.appData,o=r.settings,i=void 0===o?{}:o,c=r.organization,u=r.isPublicCloud,l=t||{},s=l.me,f=void 0===s?window.appData.me||{}:s,p=l.group,m=void 0===p?window.appData.group:p,d=c&&c.id;m&&a.a.isGroupOrPublication(m)&&(n=m.abilities&&m.abilities.read_private);var y=e&&e.abilities&&e.abilities.update;return!!(u&&!d&&i.enable_new_user_public_ability_forbid&&f.isNewbie&&!n&&!y)}u.propTypes={targetType:i.PropTypes.string}},3851:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),o=Object(r.createContext)(null)},3856:function(e,t,n){"use strict";n(42);var r=n(9),o=(n(151),n(66)),i=n(0),a=n.n(i),c=n(2),u=n.n(c),l=n(5),s=n.n(l),f=n(65),p=n.n(f),m=n(80),d=n.n(m),y=n(251),h=n(3849),b=n(1401),v=n(3536),g=n(490),w=n(3542);n(3819);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T(e);if(t){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j(e)}(this,n)}}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function C(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_(t)?t:String(t)}var R=p()("comment:editor.ui"),k=Object(y.b)((function(){return Promise.all([n.e(4),n.e(5),n.e(6),n.e(0),n.e(1236)]).then(n.bind(null,3863))}),{suspense:!0}),L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(u,e);var t,n,i,c=S(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),C(j(t=c.call(this,e)),"focusEditor",(function(){t.editor.focus(!0)})),C(j(t),"onLoad",(function(){t.onChange()})),C(j(t),"onChange",(function(){t.setState({hasValue:!t.editor.isEmpty()})})),C(j(t),"handleSubmit",(function(){t.editor.contentReady().then((function(){if(!t.editor.isEmpty()){var e={format:d.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};R("submit: ",e),t.props.onSubmit(e,(function(){t.reset()}))}}))})),C(j(t),"renderEditor",(function(){return a.a.createElement(k,{key:"".concat(t.state.editorInstanceId),editor:t.editor,onLoad:t.onLoad,onChange:t.onChange,onSubmit:t.handleSubmit})})),C(j(t),"renderReplyTo",(function(){var e=t.props,n=e.replyId,r=e.showReply;if(!n||!r)return null;var i,c=(t.props.comments||[]).find((function(e){return e.id===n}));return c?(i=c.user?c.user.name:__("用户已注销"),a.a.createElement("div",{className:"reply-tip"},__("回复")," ",a.a.createElement("a",{href:"#comment-".concat(c.id)},"@",i),a.a.createElement(o.a,{title:__("取消回复")},a.a.createElement("span",{className:"remove-reply",onClick:t.props.cancelReplyTo},a.a.createElement("span",{className:"larkicon larkicon-close"}))))):(R("comment ".concat(n," not exists")),null)})),t.editor=new w.c({disableYuqueCardEmbedView:e.disableYuqueCardEmbedView,belong:e.target,targetType:e.type,attachType:e.type,getDefaultSuggestions:e.getDefaultSuggestions,useMiniGuide:e.useMiniGuide,isMiniSize:e.isMiniSize,placeholder:e.placeholder||" ",replyId:e.replyId||""}),t.initialDocument=t.editor.getInitialDocument(),R("init use: ",t.initialDocument),t.state={hasValue:!1,editorInstanceId:"reply_main_".concat(e.replyId||"")},t}return t=u,(n=[{key:"componentDidUpdate",value:function(e){var t=this.props.replyId;t&&e.replyId!==t&&this.focusEditor(),e.replyId!==t&&this.editor._engine.engine.renderer.updatePlaceholder(this.props.placeholder)}},{key:"reset",value:function(){var e="reply_main_".concat(this.props.replyId||"","_").concat((new Date).getTime());this.editor.reset(),this.initialDocument=w.c.getEmptyDocument(),this.editor.initialDocument=this.initialDocument,this.setState({hasValue:!1,editorInstanceId:e}),R("reset editor, new instance: ".concat(e,", document: "),this.initialDocument)}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.submitting,o=e.showAvatar,i=e.useMiniGuide,c=e.isMiniSize,u=e.group,l=e.reverseReplyButton,f=this.editor.isEditMode,p=s()({"comments-form-wrapper":!0,"edit-mode":f,"no-avatar":!o,"mini-size":c}),m=Object(h.b)(this.props.target,{me:t,group:u}),d=c?24:32;return a.a.createElement(b.a,{tooltipPlacement:"top"},a.a.createElement("div",{className:"comments-form-editor"},o&&a.a.createElement("div",{className:"avatar"},a.a.createElement(g.a,{src:t.avatar_url,size:d,name:t.name})),a.a.createElement("div",{className:p},a.a.createElement("div",{className:"editor-wrapper"},a.a.createElement("div",{className:"editor"},this.renderReplyTo(),this.renderEditor())),l?a.a.createElement("div",{className:"action clearfix",style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},(i||this.props.cancelable)&&a.a.createElement(r.a,{style:{marginRight:6},onClick:this.props.onCancelCreate},__("取消")),n?a.a.createElement(r.a,{disabled:"disabled"},a.a.createElement("span",null,__("提交中..."))):a.a.createElement(r.a,{disabled:this.state.hasValue&&!m?"":"disabled",onClick:this.handleSubmit},f?__("确定"):__("评论")),m&&a.a.createElement(h.a,null)):a.a.createElement("div",{className:"action clearfix"},n?a.a.createElement(r.a,{disabled:"disabled",style:{marginRight:12}},a.a.createElement("span",null,__("提交中..."))):a.a.createElement(r.a,{type:"primary",disabled:this.state.hasValue&&!m?"":"disabled",onClick:this.handleSubmit,style:{marginRight:12}},f?__("确定"):__("回复")),(i||this.props.cancelable)&&a.a.createElement("a",{className:"btn-cancel",onClick:this.props.onCancelCreate},__("取消")),m&&a.a.createElement(h.a,null)))))}}])&&E(t.prototype,n),i&&E(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component);L.defaultProps={showAvatar:!0,useMiniGuide:!1,cancelable:!1,showReply:!0,reverseReplyButton:!1},L.propTypes={me:u.a.object.isRequired,type:u.a.oneOf(v.a.TARGET_TYPES),group:u.a.object,target:u.a.object.isRequired,targetType:u.a.object,replyId:u.a.number,comments:u.a.array,cancelReplyTo:u.a.func,onSubmit:u.a.func,getDefaultSuggestions:u.a.func,submitting:u.a.bool,showAvatar:u.a.bool,useMiniGuide:u.a.bool,onCancelCreate:u.a.func,isMiniSize:u.a.bool,cancelable:u.a.bool,disableYuqueCardEmbedView:u.a.bool,placeholder:u.a.string,showReply:u.a.bool,reverseReplyButton:u.a.bool},t.a=L},3873:function(e,t,n){"use strict";n(782);var r=n(379),o=n(0),i=n.n(o),a=n(2),c=n.n(a),u=n(5),l=n.n(u);n(3752);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=e.reaction,n=e.users,a=e.myReaction,c=s(Object(o.useState)(!1),2),u=c[0],f=c[1];return i.a.createElement(r.a,{className:"post-reaction-detail",overlayClassName:"post-reaction-detail-popover",getPopupContainer:function(e){return e.parentNode},mouseEnterDelay:.618,trigger:["hover"],placement:"bottomLeft",onVisibleChange:function(n){f(n),!1===n?e.reset(t.id):e.loadUsers(t.id)},visible:u,content:i.a.createElement("ul",{className:"post-reaction-users"},n.map((function(e){return i.a.createElement("li",{key:e.id},i.a.createElement("a",{href:"/".concat(e.login),target:"_blank"},e.name))})))},i.a.createElement("div",{onClick:e.onReactionClick,className:l()({"post-reaction-detail-type":!0,"post-reaction-detail-active":a&&a.reaction_types&&a.reaction_types.includes(t.id)})},i.a.createElement("img",{className:"post-interaction-icon",src:t.icon,height:20}),i.a.createElement("span",{className:"post-interaction-num"},e.total)))}p.defaultProps={onReactionClick:function(){}},p.propTypes={myReaction:c.a.object,users:c.a.array.isRequired,total:c.a.number.isRequired,reaction:c.a.object.isRequired,loadUsers:c.a.func.isRequired,reset:c.a.func.isRequired,onReactionClick:c.a.func},t.a=p},3874:function(e,t,n){"use strict";n(782);var r=n(379),o=n(0),i=n.n(o),a=n(2),c=n.n(a),u=n(3678),l=n(45);n(3752);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=u.a.REACTIONS;function m(e){var t=e.active,n=e.totalReaction,a=e.reactionIcon,c=s(Object(o.useState)(!1),2),u=c[0],f=c[1];return i.a.createElement("div",{className:"post-reaction"},i.a.createElement(r.a,{getPopupContainer:function(e){return e.parentNode},trigger:window.h5?["click"]:["hover"],placement:e.placement,autoAdjustOverflow:!1,visible:u,arrowPointAtCenter:!0,onVisibleChange:function(e){f(e)},content:i.a.createElement("div",null,i.a.createElement("ul",{className:"post-reaction-items"},p.map((function(n){return i.a.createElement("li",{className:t.includes(n.id)?"post-reaction-active":"",key:n.id},i.a.createElement("img",{src:n.icon,onClick:function(){var r;r=n,t.includes(r.id)?e.onCancelReaction(r.id):e.onReaction(r.id),e.onReactionUpdate(r),f(!1)}}))}))))},i.a.createElement("div",null,i.a.createElement("span",{className:"post-reaction-entry"},a||i.a.createElement(l.b,{name:"comment-reaction",width:20,height:20})),n>0&&i.a.createElement("span",{className:"post-interaction-action-total"},n))))}m.defaultProps={onReactionUpdate:function(){}},m.propTypes={active:c.a.array,onReaction:c.a.func.isRequired,onCancelReaction:c.a.func.isRequired,onReactionUpdate:c.a.func,totalReaction:c.a.number,reactionIcon:c.a.element,placement:c.a.string},t.a=m},3875:function(e,t,n){"use strict";var r=n(0),o=n(65),i=n.n(o),a=n(117);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=new i.a("thread:post.port");t.a=function(e){var t=e.me,n=e.comment,o=e.onReactionUpdate,i=f(Object(r.useState)(n.reactions||[]),2),c=i[0],p=i[1],m=f(Object(r.useState)({}),2),y=m[0],h=m[1],b=f(Object(r.useState)(!1),2),v=b[0],g=b[1],w="Comment";Object(r.useEffect)((function(){p(n.reactions||[])}),[n]);var _=function(){var e=null;return t&&t.id&&(e=c.find((function(e){return e.user_id===t.id})))&&(e.reaction_types=e.action_option.split(",")),e},E=function(e){return a.webProxy.actions.create({target_id:n.id,target_type:w,action_type:"reaction",action_option:e}).then((function(n){d("success",n);var r=c.filter((function(e){return e.user_id!==t.id}));r.push({user_id:t.id,action_type:"reaction",action_option:e}),p(r),o&&o(r,{actionType:"create",userId:t.id,actionOption:e})}))};return{state:{reactions:c,reactionUserMap:y},reaction:function(e){d("reaction",e);var t=e,n=_();if(n){var r=s(n.reaction_types);if(r.includes(e))return Promise.resolve({});r.push(e),t=r.join(",")}return E(t)},cancelReaction:function(e){d("cancel reaction:",e);var r=_();if(!r)return Promise.resolve({});var i=r.reaction_types.filter((function(t){return t!==e}));if(i.length>0){var u=i.join(",");return d("update action_option",i.join(",")),E(u)}return a.webProxy.actions.destroy({target_id:n.id,target_type:w,action_type:"reaction"}).then((function(){var n=c.filter((function(e){return e.user_id!==t.id}));p(n),o&&o(n,{actionType:"delete",userId:t.id,reactionType:e})}))},loadReactionUser:function(e){d("load users for reaction",e),v||(g(!0),a.webProxy.actions.users({target_id:n.id,target_type:w,action_type:"reaction",action_option:"".concat(e),limit:30}).then((function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},y);n[e]=t,g(!1),h(n)})))},resetReactionUser:function(e){h({})},getMyReaction:_}}},3990:function(e,t,n){"use strict";n(151);var r=n(66),o=(n(782),n(379)),i=n(0),a=n.n(i),c=n(2),u=n.n(c),l=n(825),s=n.n(l),f=n(5),p=n.n(f),m=n(45),d=n(3614),y="CornerBubble-module_cornerBubble_2kGnu",h="CornerBubble-module_cornerCount_O3YTX",b="CornerBubble-module_cornerCountLarge_3x8Br",v="CornerBubble-module_cornerCountHover_x2J7h",g="CornerBubble-module_cornerIcon_N8Ibc",w="CornerBubble-module_btnWord_-QoZm",_="CornerBubble-module_badge_SQuZN";function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(e){var t,n,i,c=e.count,u=e.style,l=e.onClick,f=e.iconName,E=e.iconSize,O=e.countPopoverContent,T=e.countPopoverClassName,C=e.renderBadge,P=e.tooltipText,R=e.btnWord,k=Object(d.b)().rightSidebarWidth;return a.a.createElement(r.a,{title:P},a.a.createElement("div",{className:y,onClick:l,style:S(S({},u),{},{right:k+24})},s()(c)&&c>0&&(n=!!O,i=a.a.createElement("div",{className:p()((t={},j(t,h,!0),j(t,v,n),j(t,b,c>99),t))},c>99?"99+":c),n?a.a.createElement(o.a,{placement:"topRight",trigger:"hover",overlayClassName:T,content:O},i):i),C&&a.a.createElement("div",{className:_},C()),!!f&&a.a.createElement(m.b,{className:g,name:f,width:E||20}),!!R&&a.a.createElement("p",{className:w},R)))};T.propTypes={iconName:u.a.string.isRequired,iconSize:u.a.number,count:u.a.number,style:u.a.object,onClick:u.a.func,countPopoverContent:u.a.element,countPopoverClassName:u.a.string,renderBadge:u.a.func,tooltipText:u.a.string,btnWord:u.a.string};t.a=T},3993:function(e,t,n){"use strict";var r=n(65),o=n.n(r),i=n(72),a=n.n(i),c=n(3596);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var o=m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}(this,n)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function d(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}var h=o()("biz.comment_collab"),b={inactive:"inactive",error:"error",usersChange:"usersChange",broadcast:"broadcast",statusChange:"statusChange"},v={COMMENT_CREATE:"create",COMMENT_UPDATE:"update",COMMENT_DELETE:"destroy",BELONG_UPDATE:"belong_update",REACTION_UPDATE:"reaction_update"},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(i,e);var t,n,r,o=f(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),d(p(t=o.call(this)),"conn",void 0),d(p(t),"collab",void 0),d(p(t),"options",void 0),d(p(t),"currentMember",void 0),d(p(t),"socket",void 0),t.options=e,t.collab=e.collab,t.conn=t.createConnect(),t}return t=i,(n=[{key:"createConnect",value:function(){var e=this,t=this.collab,n="".concat(t.host,"/?id=").concat(t.id,"&token=").concat(t.token);h("connect",n);var r=new c.a(n);return r.on("ready",(function(t){e.socket=t,t.addEventListener("message",(function(t){var n;try{n=JSON.parse(t.data)}catch(e){console.error(e)}if(n&&("ready"===n.action&&(e.currentMember=n.data),"broadcast"===n.action)){var r=n.data,o=r.body,i=r.type;o.user.uuid!==e.currentMember.uuid&&e.emit(b.broadcast,{type:i,body:o})}}))})),r}},{key:"reset",value:function(){this.currentMember=null,this.conn.disconnect()}},{key:"updateReaction",value:function(e,t,n){h("reaction update"),this.conn.broadcast(v.REACTION_UPDATE,{user:this.currentMember,reaction:e,comment:t,reactionAction:n})}},{key:"updateBelong",value:function(e){h("comment create"),this.conn.broadcast(v.BELONG_UPDATE,{user:this.currentMember,belong:e})}},{key:"createComment",value:function(e){h("comment create"),this.conn.broadcast(v.COMMENT_CREATE,{user:this.currentMember,comment:e})}},{key:"updateComment",value:function(e){h("comment update"),this.conn.broadcast(v.COMMENT_UPDATE,{user:this.currentMember,comment:e})}},{key:"destroyComment",value:function(e){h("comment destroy"),this.conn.broadcast(v.COMMENT_DELETE,{user:this.currentMember,comment:e})}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);d(g,"EVENT",b),d(g,"MESSAGE",v),t.a=g},3994:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return l}));var r=n(72);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var l={SCROLL:"SCROLL"},s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(u,e);var t,n,r,o=c(u);function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),o.apply(this,arguments)}return t=u,n&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.n(r).a),f=new s;function p(){return f}},4006:function(e,t,n){"use strict";n(42);var r=n(9),o=n(0),i=n.n(o),a=n(2),c=n.n(a),u=n(5),l=n.n(u),s=n(65),f=n.n(s),p=n(80),m=n.n(p),d=n(3542),y=n(251);n(3819);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var o=_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(this,n)}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function E(e,t,n){return(t=O(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}var S=Object(y.b)((function(){return Promise.all([n.e(4),n.e(5),n.e(6),n.e(0),n.e(1236)]).then(n.bind(null,3863))}),{suspense:!0}),j=f()("comment:update.editor.ui"),T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(c,e);var t,n,o,a=g(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),E(w(t=a.call(this,e)),"onLoad",(function(){t.onChange()})),E(w(t),"onChange",(function(){t.setState({hasValue:!t.editor.isEmpty()})})),E(w(t),"handleCancel",(function(){t.reset(),t.props.onCancel()})),E(w(t),"handleSubmit",(function(){var e=t.props,n=e.comment,r=e.commentMoodChanged;t.editor.contentReady().then((function(){var e={format:m.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};j("on save: ".concat(n.id,", document: "),e),r||t.editor.isContentChanged()?t.props.onSave(n.id,e,(function(){t.handleCancel()})):t.handleCancel()}))})),E(w(t),"renderEditor",(function(){return i.a.createElement(S,{editor:t.editor,onLoad:t.onLoad,onChange:t.onChange,onSubmit:t.handleSubmit,key:"".concat(t.state.editorInstanceId)})}));var n=e.comment;return t.editor=new d.c({target:n,belong:e.target,attachType:e.type,useBelongAttach:!0,from:"reply",useMiniGuide:e.useMiniGuide,getDefaultSuggestions:e.getDefaultSuggestions,autoFocus:!0}),t.initialDocument=t.editor.getInitialDocument(),j("init use: ",t.initialDocument),t.state={hasValue:!0,editorInstanceId:"reply_update_".concat(n.id)},t}return t=c,(n=[{key:"reset",value:function(){this.editor.reset()}},{key:"render",value:function(){var e=l()({"comments-form-wrapper":!0,"edit-mode":!0});return i.a.createElement("div",{className:"comments-form-editor"},i.a.createElement("div",{className:e},i.a.createElement("div",{className:"editor-wrapper"},i.a.createElement("div",{className:"editor"},this.renderEditor())),i.a.createElement("div",{className:"action clearfix"},this.state.submitting?i.a.createElement(r.a,{disabled:"disabled",style:{marginRight:12}},i.a.createElement("span",null,__("提交中..."))):i.a.createElement(r.a,{type:"primary",disabled:this.state.hasValue?"":"disabled",onClick:this.handleSubmit,style:{marginRight:12}},i.a.createElement("span",null,__("提交"))),i.a.createElement("a",{className:"btn-cancel",onClick:this.handleCancel},i.a.createElement("span",null,__("取消"))))))}}])&&b(t.prototype,n),o&&b(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Component);T.propTypes={type:c.a.oneOf(["Doc","Resource"]),target:c.a.object.isRequired,comment:c.a.object.isRequired,onSave:c.a.func,onCancel:c.a.func,getDefaultSuggestions:c.a.func,commentMoodChanged:c.a.bool,useMiniGuide:c.a.bool},t.a=T},4026:function(e,t,n){"use strict";n(258);var r=n(135),o=n(1492),i=n.n(o),a=n(0),c=n.n(a),u=n(2),l=n.n(u),s=n(65),f=n.n(s),p=n(5),m=n.n(p),d=n(469),y=n(3768),h=n.n(y),b=n(52),v=n(372),g=n.n(v),w=n(51),_=n(3536),E=(n(42),n(9)),O=n(45),S=n(198),j=n(3856),T=n(3801),C={miniGuide:"Editor-module_miniGuide_71Yr9",areaBtn:"Editor-module_areaBtn_aMxhW",active:"Editor-module_active_Nin9i",icon:"Editor-module_icon_tywji",miniGuideLeft:"Editor-module_miniGuideLeft_6qlDi",replyIcon:"Editor-module_replyIcon_YVDPO",text:"Editor-module_text_ayCNj",miniWrapper:"Editor-module_miniWrapper_bgh3f",editorInput:"Editor-module_editorInput_pjxNG"};function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function R(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===P(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(){k=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(x([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==P(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(P(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function L(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var N=f()("comment:editor"),D=function(e){var t,n,r=e.targetType,o=e.target,i=e.useMiniGuide,u=e.dispatch,l=e.onCancelCreate,s=e.showReply,f="autosave/".concat(r,"_comments/").concat(o.id,"/replyId"),p=c.a.createRef(),m=Object(a.useState)(function(){if(!s)return null;var e=S.a.get(f);return N("cached reply id: ","".concat(f," -> ").concat(e)),e?Number(e):null}()),d=A(m,2),y=d[0],h=d[1],b=A(Object(a.useState)(!!i),2),v=b[0],_=b[1],E=function(){l&&"function"==typeof l?l():_(!v)},O=function(){h(null),S.a.remove(f),e.onCloseReply()},j=A(Object(a.useState)(!1),2),T=j[0],C=j[1];return{state:{submitting:T,replyId:y,showMiniGuide:v},editorRef:p,handleReplyTo:function(e){h(e),i&&v&&E(),S.a.set(f,e)},cancelReply:O,toggleEditor:E,toggleAreaCommenting:function(e){e.stopPropagation(),u&&u({type:"litecomment/toggleAreaCommenting"})},createReply:(t=k().mark((function t(n,a){var c,u,l,s,f,p,m,d;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return C(!0),c=e.litecomment,l=(u=void 0===c?{}:c).page,s=u.rect,f=e.comments,p={commentable_type:r,commentable_id:o.id,parent_id:y,body_asl:n.value,body:n.html,format:n.format,page:l,rect:s},(l||s)&&(p.type=g.a.TYPE.AREA_COMMENT),y&&((null==(m=f.find((function(e){return e.id===y})))?void 0:m.type)===g.a.TYPE.WORDING_COMMENT&&(p.type=g.a.TYPE.WORDING_COMMENT,p.selection=m.selection),m&&(p.root_id=m.parent_id?m.root_id:m.id,p.to_user_id=m.user_id)),"lake"!==p.format&&(p.body=n.html),t.prev=6,t.next=9,w.a.comments.create(p);case 9:d=t.sent,C(!1),N("reply success: ",d),a&&a(),e.onCreate&&e.onCreate(d),O(),i&&_(!0),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),C(!1);case 21:case"end":return t.stop()}}),t,null,[[6,18]])})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){L(i,r,o,a,c,"next",e)}function c(e){L(i,r,o,a,c,"throw",e)}a(void 0)}))},function(e,t){return n.apply(this,arguments)})}},I=c.a.forwardRef((function(e,t){var n=D(e),r=n.state,o=r.replyId,i=r.showMiniGuide,u=r.submitting,l=c.a.createRef();Object(a.useImperativeHandle)(t,(function(){return{handleReplyTo:function(e){n.handleReplyTo(e),l&&l.current&&l.current.focusEditor()},cancelReply:n.cancelReply,focusEditor:function(){l&&l.current&&l.current.focusEditor()}}}));var s=e.className,f=e.group,p=e.targetType,d=e.target,y=e.comments,h=e.canComment,b=e.useMiniGuide,v=e.isMiniSize,g=e.areaCommenting,w=e.withAreaSelection,_=e.disableYuqueCardEmbedView,S=e.cancelable,P=e.me,k=e.showReply,L=e.placeholder,A=e.commentTipText;if(!h)return null;var x=m()(C.areaBtn,R({},C.active,g));return c.a.createElement("div",{className:m()(s,C.wrapper,R({},C.miniWrapper,v))},c.a.createElement(T.a,{me:P,place:"comment"},i?c.a.createElement("div",{className:C.miniGuide,onClick:n.toggleEditor,"data-testid":"comment-mini-guide"},c.a.createElement("div",{className:C.miniGuideLeft},c.a.createElement(O.b,{name:"comment-reply",className:C.replyIcon}),c.a.createElement("span",{className:C.text},A||__("点击添加评论"))),w&&c.a.createElement(E.a,{onClick:n.toggleAreaCommenting,className:x,"data-testid":"area-selection-button"},c.a.createElement(O.b,{name:"area-comment",size:14,className:C.icon}),__("框选评论"))):c.a.createElement("div",{className:C.editorInput,"data-testid":"comment-editor"},c.a.createElement(j.a,{me:P,group:f,type:p,submitting:u,target:d,replyId:o,cancelReplyTo:n.cancelReply,comments:y,onSubmit:n.createReply,getDefaultSuggestions:e.getDefaultSuggestions,showAvatar:!b,useMiniGuide:b,onCancelCreate:n.toggleEditor,isMiniSize:v,ref:l,cancelable:S,disableYuqueCardEmbedView:_,showReply:k,placeholder:L}))))}));I.defaultProps={me:window.appData.me,onCloseReply:function(){}},I.propTypes={className:l.a.string,group:l.a.object.isRequired,target:l.a.object.isRequired,targetType:l.a.oneOf(_.a.TARGET_TYPES),comments:l.a.array,useMiniGuide:l.a.bool,canComment:l.a.bool,onCreate:l.a.func,cancelable:l.a.bool,onCancelCreate:l.a.func,getDefaultSuggestions:l.a.func,type:l.a.oneOf(["default","timeline"]),isMiniSize:l.a.bool,editorAffixed:l.a.bool,litecomment:l.a.object,withAreaSelection:l.a.bool,dispatch:l.a.func,areaCommenting:l.a.bool,disableYuqueCardEmbedView:l.a.bool,me:l.a.object,showReply:l.a.bool,placeholder:l.a.string,onCloseReply:l.a.func,commentTipText:l.a.string},I.displayName="LiteCommentEditor";var M=I,F=n(787),B=n(3851),U=n(3993),G=n(951),q=n(587),Y=n(420),V=n(260),z=n(490),W=n(1400),H=n(4035),K=n(3797),X=n(3994),J="wordCommentSelection-module_container_LBNIq",$="wordCommentSelection-module_prefixIcon_nL7Bk",Z="wordCommentSelection-module_quotation_qfH3Q",Q="wordCommentSelection-module_quotationTip_S-QRh",ee="wordCommentSelection-module_quotationContent_atDX4",te="wordCommentSelection-module_quotationContentMini_5dM90";function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ne(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ne(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e){var t,n=e.comment,r=e.getViewEngine,o=e.isMiniSize,i=Object(a.useCallback)((function(){var e,t=Object(X.b)(),o=null==n||null===(e=n.selection)||void 0===e?void 0:e.paragraph_id,i=r();i&&o&&i.execCommand("tryUnfold",o),t.emit(X.a.SCROLL,oe(oe({},n.selection),{},{comment_id:n.id}))}),[n,r,X.b]);return n.selection_type===g.a.SELECTION_TYPE.Review?null:c.a.createElement("div",{className:J},c.a.createElement("span",{className:$}),c.a.createElement("div",{className:Z,onClick:i},c.a.createElement("span",{className:m()((t={},ie(t,ee,!o),ie(t,te,o),t))},c.a.createElement("span",{className:Q},__("引用原文：")),n.selection.text)))}ae.defaultProps={isMiniSize:!1},ae.propTypes={comment:l.a.object.isRequired,getViewEngine:l.a.func.isRequired,isMiniSize:l.a.bool};var ce=ae,ue=n(3663),le=n(4006),se=n(3691),fe=n(251),pe=["children"],me=["children"];function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function ye(){return ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ve(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ge(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function ge(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ee(r.key),r)}}function Ee(e){var t=function(e,t){if("object"!==de(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===de(t)?t:String(t)}function Oe(){return window.WeakMap?new WeakMap:new(function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r={},(n=Ee(n="_map"))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,r;return t=e,(n=[{key:"has",value:function(e){return!!this._map[e]}},{key:"delete",value:function(e){this._map[e]=void 0,delete this._map[e]}},{key:"get",value:function(e){return this._map[e]}}])&&_e(t.prototype,n),r&&_e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}())}var Se=Oe(),je=Oe(),Te=window.IntersectionObserver?new IntersectionObserver((function(e){var t,n=ve(e);try{for(n.s();!(t=n.n()).done;){var r,o=t.value;if(Se.has(o.target))null===(r=Se.get(o.target))||void 0===r||r(o.intersectionRatio,o.intersectionRect.height)}}catch(e){n.e(e)}finally{n.f()}}),{rootMargin:"100%",threshold:[0,.1,1]}):null,Ce=window.ResizeObserver?new window.ResizeObserver((function(e){var t,n=ve(e);try{for(n.s();!(t=n.n()).done;){var r,o=t.value;if(je.has(o.target))null===(r=je.get(o.target))||void 0===r||r(o.contentRect)}}catch(e){n.e(e)}finally{n.f()}})):null;function Pe(e){var t=e.children,n=be(e,pe);return c.a.createElement("div",n,t)}Pe.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired};var Re=window.DELAY_COMMENTS_DEFAULT_HEIGHT||400;function ke(){var e=he(Object(a.useState)(null),2),t=e[0],n=e[1],r=Object(a.useCallback)((function(e){e!==t&&n(e)}),[t]);return{current:t,setRef:r}}function Le(e){var t=e.children,n=be(e,me),r=ke(),o=ke(),i=he(Object(a.useState)(!0),2),u=i[0],l=i[1],s=he(Object(a.useState)(0),2),f=s[0],p=s[1],m=he(Object(a.useState)(Re),2),d=m[0],y=m[1];return Object(a.useEffect)((function(){if(r.current){var e=r.current;return Se.set(e,(function(e){e>0&&u&&l(!1),p(e)})),Te.observe(e),function(){Se.delete(e),Te.unobserve(e)}}}),[r,u,p]),Object(a.useEffect)((function(){if(o.current){var e=o.current;return je.set(e,(function(e){0!==e.height&&y(e.height)})),Ce.observe(e),function(){je.delete(e),Ce.unobserve(e)}}}),[o,y]),c.a.createElement("div",ye({ref:r.setRef},n,{style:{minHeight:d}}),u?null:c.a.createElement("div",{style:{display:f>0?"block":"none"},ref:o.setRef},t))}Le.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired};var Ae=function(e){return Te&&e.enableDelay?c.a.createElement(Le,e):c.a.createElement(Pe,e)};Ae.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired};var xe=Ae,Ne=Object(fe.b)((function(){return Promise.all([n.e(4),n.e(5),n.e(6),n.e(0),n.e(1241)]).then(n.bind(null,2948))}),{suspense:!0});function De(e){var t=e.comment,n=e.group,r=e.target,o=e.commentableType,i=e.onClick,a=e.mode,u=e.onCancelEdit,l=e.onSave,s=e.getDefaultSuggestions,f=e.useMiniGuide,p=e.disableYuqueCardEmbedView,m=e.enableDelay,d={read_status:-1===t.status?99:0,id:t.id};if("edit"===a)return c.a.createElement("div",{style:{marginBottom:16}},c.a.createElement(le.a,{type:o,group:n,comment:t,target:r,onCancel:u,onSave:l,getDefaultSuggestions:s,useMiniGuide:f}));var y=Object(ue.a)()||Object(ue.b)();return c.a.createElement(c.a.Fragment,null,c.a.createElement(xe,{className:"content-detail",onClick:function(){return i(t)},enableDelay:m},y&&c.a.createElement("div",{style:{marginBottom:6}},c.a.createElement(se.default,{key:"audits",doc:d,type:"Comment"})),c.a.createElement(Ne,{id:t.id,key:"reply-".concat(t.id),genOutline:!1,genAnchor:!1,content:t.body_asl,disableYuqueCardEmbedView:p,simpleUI:!0,imageLazyLoad:!0})))}function Ie(){}De.defaultProps={onCancelEdit:Ie,onSave:Ie,onClick:Ie},De.propTypes={comment:l.a.object.isRequired,group:l.a.object.isRequired,target:l.a.object.isRequired,getDefaultSuggestions:l.a.func.isRequired,commentableType:l.a.oneOf(_.a.TARGET_TYPES),mode:l.a.oneOf(["edit","view"]),useMiniGuide:l.a.bool,disableYuqueCardEmbedView:l.a.bool,onCancelEdit:l.a.func,onSave:l.a.func,onClick:l.a.func};var Me=De,Fe=n(3678),Be=n(3873),Ue=n(1401),Ge=Fe.a.REACTIONS;function qe(e){var t=e.comment,n=e.onReactionUpdate,r=e.reactionMap,o=e.reactions,i=e.myReaction,a=e.reactionViewModel,u=e.reactionUserMap;return o.length>0?c.a.createElement("div",{className:"post-interaction",style:{marginTop:12}},c.a.createElement("div",{className:"post-interaction-reaction-summary"},c.a.createElement("ul",null,Ge.map((function(e){var o=r[e.id].count;return 0===o?null:c.a.createElement(Ue.a,null,c.a.createElement("li",{key:e.id},c.a.createElement(Be.a,{myReaction:i,reaction:e,users:u[e.id]||[],total:o,loadUsers:function(){a.loadReactionUser(e.id)},reset:function(){a.resetReactionUser(e.id)},onReactionClick:function(){var r;(null!=i&&null!==(r=i.action_option)&&void 0!==r&&r.includes(e.id)?a.cancelReaction(e.id):a.reaction(e.id)).then((function(){a.loadReactionUser(e.id),n(e,t)}))}})))}))))):null}qe.defaultProps={onReactionUpdate:function(){}},qe.propTypes={comment:l.a.object.isRequired,onReactionUpdate:l.a.func,reactionMap:l.a.object.isRequired,reactions:l.a.array.isRequired,myReaction:l.a.object,reactionViewModel:l.a.object.isRequired,reactionUserMap:l.a.object.isRequired};var Ye=qe,Ve=(n(782),n(379)),ze=(n(489),n(98)),We=(n(176),n(64)),He=n(3820),Ke=n(3874),Xe={container:"commentActions-module_container_Pd8UE",actionsHiddenArea:"commentActions-module_actionsHiddenArea_rwxN3",offlineItem:"commentActions-module_offlineItem_liJrK",actionItem:"commentActions-module_actionItem_IYkZw",actionItemWithoutMargin:"commentActions-module_actionItemWithoutMargin_UTjq4"},Je="commentFloorListItem-module_commentFloorListItem_hEa7c",$e="commentFloorListItem-module_listItemWrapper_WP5Au",Ze="commentFloorListItem-module_hashActive_QOVC4",Qe="commentFloorListItem-module_isSelected_KRAD2",et="commentFloorListItem-module_isMiniSize_LwzVw",tt="commentFloorListItem-module_avatar_MHjSF",nt="commentFloorListItem-module_commentOrder_Iuwe4",rt="commentFloorListItem-module_main_gfOyp",ot="commentFloorListItem-module_commentMain_sXNkM",it="commentFloorListItem-module_actionsHiddenArea_sIy27",at="commentFloorListItem-module_head_HFLrS",ct="commentFloorListItem-module_name_pqKOI",ut="commentFloorListItem-module_miniName_SV4Rr",lt="commentFloorListItem-module_toUserName_ODbN0",st="commentFloorListItem-module_miniToUserName_tSChh",ft="commentFloorListItem-module_arrowRight_KtPw0",pt="commentFloorListItem-module_time_juhkg",mt="commentFloorListItem-module_commentIpRegion_jl233",dt="commentFloorListItem-module_wordCommentSelectionWrapper_7T0sG",yt="commentFloorListItem-module_content_Zn013",ht="commentFloorListItem-module_replyEditor_PeaGC",bt="commentFloorListItem-module_deleted_2GyFb",vt="commentFloorListItem-module_rootCommentFloorListItem_KZW6g";function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function wt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==gt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===gt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _t(e){var t=e.comment,n=e.me,r=e.isMobile,o=e.canComment,i=e.canEdit,a=e.canReport,u=e.canDelete,l=e.onRemove,s=e.onEdit,f=e.onReplyTo,p=e.onCopyCommentLink,d=e.reactionViewModel,y=e.myReaction,h=e.onReactionUpdate;return n&&n.id?c.a.createElement("div",{className:Xe.container},o&&c.a.createElement(Ue.a,{buttonClassName:Xe.offlineItem},c.a.createElement("span",{className:Xe.actionItem},c.a.createElement(O.b,{name:"comment-bubble",color:"#8C8C8C",width:16,height:16,onClick:f}))),o&&c.a.createElement(Ue.a,null,c.a.createElement(Ke.a,{placement:r?"topLeft":void 0,reactionIcon:c.a.createElement("span",{className:Xe.actionItemWithoutMargin},c.a.createElement(O.b,{className:Xe.action,name:"comment-reaction",color:"#8C8C8C",width:16,height:16})),active:(null==y?void 0:y.reaction_types)||[],onReaction:d.reaction,onCancelReaction:d.cancelReaction,onReactionUpdate:function(e){return h(e,t)}})),c.a.createElement("div",{className:m()(Xe.actionsHiddenArea,wt({},it,!r))},i&&c.a.createElement(Ue.a,{buttonClassName:Xe.offlineItem},c.a.createElement("span",{className:Xe.actionItem},c.a.createElement(O.b,{className:Xe.action,name:"edit-border",width:16,height:16,color:"#8C8C8C",onClick:s}))),u&&c.a.createElement(Ue.a,{buttonClassName:Xe.offlineItem},c.a.createElement(We.a,{title:__("确认删除该评论么？"),onConfirm:l},c.a.createElement("span",{className:Xe.actionItem},c.a.createElement(O.b,{className:Xe.action,name:"icon-delete",color:"#8C8C8C",width:16,height:16})))),c.a.createElement(Ve.a,{type:"menu",getPopupContainer:function(e){return e.parentNode},placement:"bottomRight",arrowPointAtCenter:!0,trigger:r?"click":"hover",content:c.a.createElement(ze.a,null,c.a.createElement(ze.a.Item,{key:"copy"},c.a.createElement("span",{onClick:p},__("复制评论链接"))),a&&c.a.createElement(Ue.a,null,c.a.createElement(ze.a.Item,{key:"report"},c.a.createElement(He.a,{targetId:t.id,targetType:"Comment"},(function(e){return c.a.createElement("span",{className:"action-link",onClick:e.onShowPanel},__("举报"))}))))),hideWhenInactive:!0},c.a.createElement("span",{className:Xe.actionItem},c.a.createElement(O.b,{className:Xe.action,name:"comment-more",color:"#8C8C8C",width:16,height:16}))))):null}_t.defaultProps={isMobile:!1},_t.propTypes={comment:l.a.object.isRequired,me:l.a.object,canComment:l.a.bool,canEdit:l.a.bool,canReport:l.a.bool,canDelete:l.a.bool,onRemove:l.a.func.isRequired,onEdit:l.a.func.isRequired,onReplyTo:l.a.func.isRequired,onCopyCommentLink:l.a.func,onReactionUpdate:l.a.func,reactionViewModel:l.a.object,myReaction:l.a.object,isMobile:l.a.bool};var Et=_t;function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function St(){St=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Ot(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Ot(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function jt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pt=f()("comment:editor"),Rt=function(e){var t,n=e.commentableType,r=e.target,o=e.dispatch,i=e.rootId,u=e.replyToComment,l=e.litecomment,s=void 0===l?{}:l,f=e.onCancelReply,p=e.onCreate,m=c.a.createRef(),d=Tt(Object(a.useState)(!1),2),y=d[0],h=d[1];t=u.user?u.user.name:__("用户已注销");var b,v;return{state:{submitting:y,replyId:u.id,placeholder:__("回复 {user}",{user:t})},editorRef:m,handleCancelReply:function(){f()},toggleAreaCommenting:function(e){e.stopPropagation(),o&&o({type:"litecomment/toggleAreaCommenting"})},createReply:(b=St().mark((function e(t,o){var a,c,l,m;return St().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),a=s.page,c=s.rect,l={commentable_type:n,commentable_id:r.id,parent_id:u.id,to_user_id:u.user_id,body_asl:t.value,body:t.html,format:t.format,page:a,rect:c},(a||c)&&(l.type=g.a.TYPE.AREA_COMMENT),u&&(u.type===g.a.TYPE.WORDING_COMMENT&&(l.type=g.a.TYPE.WORDING_COMMENT,l.selection=u.selection),l.root_id=i),"lake"!==l.format&&(l.body=t.html),e.prev=6,e.next=9,w.a.comments.create(l);case 9:(m=e.sent).to_user=u.user,h(!1),Pt("reply success: ",m),o&&o(),p&&p(m),f(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),h(!1);case 21:case"end":return e.stop()}}),e,null,[[6,18]])})),v=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=b.apply(e,t);function i(e){jt(o,n,r,i,a,"next",e)}function a(e){jt(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e,t){return v.apply(this,arguments)})}},kt=c.a.forwardRef((function(e,t){var n=Rt(e),r=n.state,o=r.replyId,i=r.submitting,u=r.placeholder,l=c.a.createRef();Object(a.useImperativeHandle)(t,(function(){return{focusEditor:function(){l&&l.current&&l.current.focusEditor()}}}));var s=e.group,f=e.canComment,p=e.isMiniSize,m=e.disableYuqueCardEmbedView,d=e.cancelable,y=e.me,h=e.comments,b=e.useMiniGuide,v=e.replyToComment,g=e.commentableType,w=e.target,_=e.reverseReplyButton;return f?c.a.createElement(T.a,{me:y,place:"comment"},c.a.createElement(j.a,{ref:l,placeholder:u,me:y,group:s,type:g,submitting:i,target:w,replyId:o,replyToComment:v,showReply:!1,cancelReplyTo:n.cancelReply,comments:h,onSubmit:n.createReply,getDefaultSuggestions:e.getDefaultSuggestions,showAvatar:!1,useMiniGuide:b,onCancelCreate:n.handleCancelReply,isMiniSize:p,cancelable:d,disableYuqueCardEmbedView:m,reverseReplyButton:_})):null}));kt.defaultProps={me:window.appData.me,onCancelReply:function(){}},kt.propTypes={group:l.a.object.isRequired,target:l.a.object.isRequired,commentableType:l.a.oneOf(_.a.TARGET_TYPES),comments:l.a.array,canComment:l.a.bool,cancelable:l.a.bool,getDefaultSuggestions:l.a.func,isMiniSize:l.a.bool,useMiniGuide:l.a.bool,litecomment:l.a.object,dispatch:l.a.func,disableYuqueCardEmbedView:l.a.bool,me:l.a.object,rootId:l.a.number,replyToComment:l.a.object,onCancelReply:l.a.func,onCreate:l.a.func,reverseReplyButton:l.a.bool},kt.displayName="CommentReplyEditor";var Lt=kt,At=(n(41),n(10)),xt=n(958),Nt=n.n(xt),Dt=n(3875);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function Mt(){Mt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==It(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(It(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Ft(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Bt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ft(i,r,o,a,c,"next",e)}function c(e){Ft(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==It(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===It(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zt=function(e){var t,n,r,o,i,c=e.isRootComment,u=e.comment,l=e.commentableType,s=e.me,f=e.target,p=e.dispatch,m=e.onRemoveComment,d=e.onUpdateComment,y=e.canComment,h=e.onCreateComment,b=e.isMobile,E=e.onReplyToComment,O=Object(a.useContext)(B.a),S=Yt(Object(a.useState)("view"),2),j=S[0],T=S[1],C=Object(a.useRef)(null),P=Yt(Object(a.useState)(!1),2),R=P[0],k=P[1],L=!window.h5&&u.meta&&u.meta.ip,A=!c&&u.parent_id&&u.parent_id!==u.root_id,x=_.a.getAnchorId(u.id),N=c&&u.type===g.a.TYPE.WORDING_COMMENT,D=!!u.deleted_at,I=Object(Dt.a)({me:s,comment:u,onReactionUpdate:function(e,t){var n=Gt(Gt({},u),{},{reactions:e});p({type:"litecomment/updateOne",payload:n}),null==O||O.updateReaction(null,n,t)}}),M=I.state,F=M.reactions,U=M.reactionUserMap,G=Object(a.useMemo)((function(){var e={reactionMap:Fe.a.classifyReactions(F),myReaction:I.getMyReaction(),totalReaction:0};return Object.keys(e.reactionMap).forEach((function(t){e.totalReaction+=e.reactionMap[t].count})),e}),[F]),q=G.reactionMap,Y=G.myReaction;return{state:{showReplyToUser:A,anchor:x,wordingCommentVisible:N,contentEditorMode:j,isDeleted:D,reactionMap:q,myReaction:Y,reactions:F,reactionUserMap:U,replyEditorVisible:R,metaInfoVisible:L},reactionViewModel:I,editorRef:C,handleEdit:function(){T("edit")},handleCancelEdit:function(){T("view")},handleEditorSave:(i=Bt(Mt().mark((function e(t,n,r){var o,i;return Mt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={id:t,format:n.format,body_asl:n.value,body:n.html},e.next=3,w.a.comments.update(o);case 3:(i=e.sent).to_user=u.to_user,i.reactions=u.reactions,i.sub_comments=u.sub_comments,r&&r(),d(i),p({type:"litecomment/updateOne",payload:i}),null==O||O.updateComment(i);case 11:case"end":return e.stop()}}),e)}))),function(e,t,n){return i.apply(this,arguments)}),handleCommentContentClick:function(){"Resource"===l&&p({type:"litecomment/updateCurrentCommentId",payload:u.id})},canComment:function(){return!D&&y},canEdit:function(){return!D&&(s&&s.id===u.user_id)},canReport:function(){if(D)return!1;if(!window.appData.isPublicCloud)return!1;var e=Object(ue.a)()||Object(ue.b)();return u.status===v.STATUS.normal&&e&&s&&s.id!==u.user_id},canDelete:function(){var e;return!D&&(!!s&&(s.id===u.user_id||!("Doc"!==l||null===(e=f.abilities)||void 0===e||!e.destroy_comment)))},handleReplyToComment:(o=Bt(Mt().mark((function e(){return Mt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b?E(u):(k(!0),setTimeout((function(){var e;null===(e=C.current)||void 0===e||e.focusEditor()}),200));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),handleCreateComment:(r=Bt(Mt().mark((function e(t){return Mt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.to_user=u.user,p({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==O||O.createComment(t),h(t);case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),handleCancelReply:(n=Bt(Mt().mark((function e(){return Mt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(!1);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)}),handleRemoveComment:(t=Bt(Mt().mark((function e(){var t;return Mt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={id:u.id},w.a.comments.destroy(t).then((function(){p({type:"litecomment/remove",payload:t}),At.a.success(__("操作成功"),3),m(t),null==O||O.destroyComment(u)}));case 2:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),handleReactionUpdate:function(){},handleCopyCommentLink:function(){var e=Fe.a.getPostUrl(u.id);Nt()(e),At.a.success(__("评论链接复制成功"))}}};function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function Ht(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Wt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Wt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kt(e){var t,n=e.comment,r=e.flattenFloorComments,o=e.isRootComment,i=e.commentableType,a=e.getViewEngine,u=e.target,l=e.useMiniGuide,s=e.getDefaultSuggestions,f=e.disableYuqueCardEmbedView,p=e.group,d=e.me,y=e.canComment,h=e.dispatch,v=e.onUpdateComment,g=(e.editorAffixed,e.isMobile),w=e.isMiniSize,_=(e.areaCommenting,e.cancelable,e.onCancelCreate,e.litecomment),E=e.urlHash,S=e.currentCommentId,j=e.onCreateComment,T=e.onEditComment,C=e.onRemoveComment,P=e.onReplyToComment,R=e.reverseReplyButton,k=e.enableDelay,L=n.user,A=n.to_user,x=zt({isRootComment:o,comment:n,commentableType:i,me:d,target:u,onRemoveComment:C,onEditComment:T,dispatch:h,onUpdateComment:v,canComment:y,onCreateComment:j,onReplyToComment:P,isMobile:g}),N=x.state,D=N.showReplyToUser,I=N.anchor,M=N.wordingCommentVisible,F=N.contentEditorMode,B=N.replyEditorVisible,U=N.isDeleted,G=N.reactionMap,q=N.myReaction,X=N.reactions,J=N.reactionUserMap,$=x.reactionViewModel,Z=x.editorRef,Q=o?n.id:n.root_id,ee=E==="#".concat(I),te=S===n.id,ne=w?24:32,re={paddingLeft:ne+12};return c.a.createElement("div",{id:I,className:m()(Je,Ht({},vt,o)),style:o?null:re},c.a.createElement("div",{className:m()($e,(t={},Ht(t,Ze,ee),Ht(t,Qe,te),Ht(t,et,w),t))},L?c.a.createElement("div",{className:tt},c.a.createElement(K.a,{url:"/".concat(L.login)},c.a.createElement(c.a.Fragment,null,c.a.createElement(W.a,{user:L},c.a.createElement(z.a,{src:L.avatar_url,size:ne,name:L.name})),n.order&&c.a.createElement("span",{className:nt},n.order)))):c.a.createElement("div",{className:tt},c.a.createElement(z.a,{src:Y.avatar.user,size:ne,name:__("用户已注销")}),n.order&&c.a.createElement("span",{className:nt},n.order)),c.a.createElement("div",{className:rt},c.a.createElement("div",{className:ot},c.a.createElement("div",{className:at},L?c.a.createElement(K.a,{url:"/".concat(L.login),className:m()(ct,Ht({},ut,w))},c.a.createElement(c.a.Fragment,null,L.name,(null==d?void 0:d.isAdmin)&&[b.STATUS.banned,b.STATUS.blocked].includes(L.status)&&c.a.createElement("span",{className:"book-name-scope"},c.a.createElement(O.b,{name:"doc-has-content-risk",width:13,style:{opacity:.375,marginLeft:4}})))):c.a.createElement("a",{className:ct},__("用户已注销")),D&&(A?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:ft}),w?c.a.createElement(K.a,{url:"/".concat(A.login),className:m()(lt,st)},A.name):c.a.createElement(W.a,{user:A},c.a.createElement(K.a,{url:"/".concat(A.login),className:lt},A.name))):c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:ft}),c.a.createElement("a",{className:lt},__("用户已注销")))),!w&&c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{href:"#".concat(I),className:pt},c.a.createElement(V.a,{time:n.created_at})),c.a.createElement("span",{className:mt},c.a.createElement(H.a,{target:n,type:"Comment"})))),w&&c.a.createElement("div",null,c.a.createElement("a",{href:"#".concat(I),className:pt},c.a.createElement(V.a,{time:n.created_at})),c.a.createElement("span",{className:mt},c.a.createElement(H.a,{target:n,type:"Comment"}))),M&&c.a.createElement("div",{className:dt},c.a.createElement(ce,{isMiniSize:w,comment:n,getViewEngine:a})),U?c.a.createElement("div",{className:yt},c.a.createElement("div",{className:bt},__("该评论已删除"))):c.a.createElement("div",{className:yt},c.a.createElement(Me,{comment:n,group:p,target:u,getDefaultSuggestions:s,commentableType:i,mode:F,useMiniGuide:l,disableYuqueCardEmbedView:f,onCancelEdit:x.handleCancelEdit,onSave:x.handleEditorSave,onClick:x.handleCommentContentClick,enableDelay:k})),!U&&c.a.createElement(Ye,{comment:n,onReactionUpdate:x.handleReactionUpdate,reactionViewModel:$,myReaction:q,reactionMap:G,reactions:X,reactionUserMap:J}),!U&&c.a.createElement(Et,{isMobile:g,comment:n,me:d,canComment:x.canComment(),canEdit:x.canEdit(),canReport:x.canReport(),canDelete:x.canDelete(),onReplyTo:x.handleReplyToComment,onEdit:x.handleEdit,onRemove:x.handleRemoveComment,onCopyCommentLink:x.handleCopyCommentLink,reactionViewModel:$,reactionMap:G,myReaction:q,reactions:X,reactionUserMap:J,onReactionUpdate:x.handleReactionUpdate}),B&&c.a.createElement("div",{className:ht},c.a.createElement(Lt,{ref:Z,rootId:Q,replyToComment:n,group:p,me:d,target:u,commentableType:i,litecomment:_,comments:r,cancelable:!0,isMiniSize:w,disableYuqueCardEmbedView:f,getDefaultSuggestions:s,dispatch:h,canComment:y,onCancelReply:x.handleCancelReply,onCreate:x.handleCreateComment,reverseReplyButton:R}))))))}Kt.defaultProps={canComment:!0,onEditComment:function(){},onRemoveComment:function(){},onCreateComment:function(){},getViewEngine:function(){}},Kt.propTypes={comment:l.a.object.isRequired,flattenFloorComments:l.a.arrayOf(l.a.object),getViewEngine:l.a.func,isRootComment:l.a.bool,commentableType:l.a.oneOf(_.a.TARGET_TYPES),target:l.a.object.isRequired,useMiniGuide:l.a.bool,getDefaultSuggestions:l.a.func,disableYuqueCardEmbedView:l.a.bool,group:l.a.object.isRequired,me:l.a.object.isRequired,canComment:l.a.bool,onEditComment:l.a.func,onCreateComment:l.a.func,onRemoveComment:l.a.func,onUpdateComment:l.a.func,dispatch:l.a.func,editorAffixed:l.a.bool,isMobile:l.a.bool,isMiniSize:l.a.bool,areaCommenting:l.a.bool,cancelable:l.a.bool,onCancelCreate:l.a.func,litecomment:l.a.object,urlHash:l.a.string,currentCommentId:l.a.number,onReplyToComment:l.a.func.isRequired};var Xt=Kt,Jt="index-module_default_FTDOK",$t="index-module_commentEditor_yI7Ow",Zt="index-module_mini_6PdDj",Qt="index-module_emptyView_t1FqB",en="index-module_miniEditor_CRXwG",tn="index-module_editorMobile_0VdOM",nn="index-module_miniFloorList_+ysrM";function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function on(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==rn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===rn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function an(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function un(e){var t=e.flattenFloorComments,n=e.commentableType,r=e.getViewEngine,o=e.target,i=e.useMiniGuide,u=e.getDefaultSuggestions,l=e.disableYuqueCardEmbedView,s=e.group,f=e.me,p=e.canComment,d=e.onReplyToComment,y=e.onEditComment,h=e.onCreateComment,b=e.onRemoveComment,v=e.onUpdateComment,g=e.dispatch,w=e.litecomment,_=e.isMiniSize,E=e.currentCommentId,O=e.isMobile,S=e.reverseReplyButton,j="";try{j=decodeURIComponent(window.location.hash)}catch(e){}var T=an(Object(a.useState)(j),2),C=T[0],P=T[1];Object(a.useEffect)((function(){var e=function(){try{P(decodeURIComponent(window.location.hash)),q.a.scrollToHash({top:60})}catch(e){}};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}}),[]);var R=t.length;return c.a.createElement("div",{className:m()(on({},nn,_))},t.map((function(e){return c.a.createElement(Xt,{key:e.id,enableDelay:R>100,flattenFloorComments:t,isRootComment:!e.parent_id,comment:e,commentableType:n,getViewEngine:r,target:o,useMiniGuide:i,getDefaultSuggestions:u,disableYuqueCardEmbedView:l,group:s,me:f,canComment:p,dispatch:g,onReplyToComment:d,onCreateComment:h,onEditComment:y,onRemoveComment:b,onUpdateComment:v,litecomment:w,isMiniSize:_,urlHash:C,currentCommentId:E,isMobile:O,reverseReplyButton:S})})))}un.defaultProps={onReplyToComment:function(){},onEditComment:function(){},onCreateComment:function(){},onRemoveComment:function(){},onUpdateComment:function(){},getViewEngine:function(){}},un.propTypes={flattenFloorComments:l.a.arrayOf(l.a.object),getViewEngine:l.a.func,commentableType:l.a.oneOf(_.a.TARGET_TYPES),target:l.a.object.isRequired,useMiniGuide:l.a.bool,getDefaultSuggestions:l.a.func,disableYuqueCardEmbedView:l.a.bool,group:l.a.object.isRequired,me:l.a.object,canComment:l.a.bool,dispatch:l.a.func,onReplyToComment:l.a.func,onEditComment:l.a.func,onRemoveComment:l.a.func,onCreateComment:l.a.func,onUpdateComment:l.a.func,litecomment:l.a.object,isMiniSize:l.a.bool,currentCommentId:l.a.number,isMobile:l.a.bool,reverseReplyButton:l.a.bool};var ln=un;function sn(e){return sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sn(e)}function fn(){return fn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fn.apply(this,arguments)}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==sn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==sn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===sn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yn(){yn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new k(r||[]);return o(a,"_invoke",{value:T(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function b(){}function v(){}function g(){}var w={};l(w,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==n&&r.call(E,a)&&(w=E);var O=g.prototype=b.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==sn(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(s).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function T(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=C(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?y:m,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(sn(t)+" is not iterable")}return v.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},S(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new j(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(O),l(O,u,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function hn(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function bn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){hn(i,r,o,a,c,"next",e)}function c(e){hn(i,r,o,a,c,"throw",e)}a(void 0)}))}}function vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wn=f()("commnent_floor");function _n(e){var t=e.commentableType,n=e.target,r=e.group,o=e.me,c=e.litecomment.comments,u=e.canMentionMembers,l=e.dispatch,s=e.isMobile,f=vn(Object(a.useState)(!1),2),p=f[0],m=f[1],y=vn(Object(a.useState)(!1),2),h=y[0],g=y[1],E=vn(Object(a.useState)(0),2),O=E[0],S=E[1],j=vn(Object(a.useState)(""),2),T=j[0],C=j[1],P=vn(Object(a.useState)(null),2),R=P[0],k=P[1],L=Object(d.f)((function(e){return{comments:e.litecomment.comments}})),A=Object(a.useRef)([]),x=Object(a.useContext)(B.a),N=function(){var e=document.querySelector("#scroll-to-comment");if(e){e.scrollIntoView();var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;window.scrollTo(0,t-40)}},D=function(){var e=bn(yn().mark((function e(){var i,a,c,s,f;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e){var t;return v.TYPE.THIRD_WORDING_COMMENT!==e.type&&("Review"===e.selection_type?!(![v.TYPE.REVIEW_APPROVAL,v.TYPE.REVIEW_REJECTION,v.TYPE.REVIEW_OPINION].includes(e.type)||!e.body)&&(e.body_asl=e.body,!0):!!((null==o?void 0:o.id)===e.user_id||null!=o&&o.isAdmin)||![b.STATUS.banned,b.STATUS.blocked].includes(null==e||null===(t=e.user)||void 0===t?void 0:t.status))},i={commentable_type:t,commentable_id:n.id,include_section:!0,include_to_user:!0,include_reactions:!0},h||m(!0),e.next=5,w.a.comments.floorComments(i,{useOriginResp:!0,ignoreGlobalMessage:!0});case 5:a=e.sent,c=(c=a.data.comments).filter((function(e){return e.sub_comments=(e.sub_comments||[]).filter(s),s(e)})),f=c.reduce((function(e,t){var n;return e++,null===(n=t.sub_comments)||void 0===n||n.forEach((function(t){e++})),e}),0),0===L.comments.length&&0===c.length||l({type:"litecomment/updateModel",payload:{comments:c,commentCount:f}}),m(!1),g(!0),u&&(r.members.length>0||(wn("load members"),l({type:"group/getMembers",payload:{data:{group_id:r.id,with_invited:!1}}})));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=Object(a.useMemo)((function(){var e=null==c?void 0:c.filter((function(e){var t;return e.comment_area&&(null===(t=e.comment_area)||void 0===t?void 0:t.rect)}));return e?(e.forEach((function(e,t){e.order=t+1})),c.sort((function(e,t){return new Date(e.created_at)-new Date(t.created_at)}))):c}),[c]),M=Object(a.useMemo)((function(){var e=I.reduce((function(e,t){var n;return e.push(t),null===(n=t.sub_comments)||void 0===n||n.forEach((function(t){e.push(t)})),e}),[]);return A.current=e,e}),[I]),F=function(){var t=i()(M,e.pageSize).length;S(t)};return Object(G.a)((function(){function e(){return(e=bn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),m(!1);case 8:null==x||x.on("broadcast",(function(e){var t=e.type,n=e.body;if(t===U.a.MESSAGE.REACTION_UPDATE){var r=n.reactionAction,o=r.actionType,i=r.userId,a=r.actionOption,c=n.comment,u=M.find((function(e){return e.id===c.id}));if(u){var s=u.reactions||[],f=s;"create"===o?(f=s.filter((function(e){return e.user_id!==i}))).push({user_id:i,action_type:"reaction",action_option:a}):"delete"===o&&(f=s.filter((function(e){return e.user_id!==i}))),l({type:"litecomment/updateOne",payload:mn(mn({},u),{},{reactions:f})})}}else if(t===U.a.MESSAGE.COMMENT_CREATE){if(A.current.find((function(e){return e.id===n.comment.id})))return;l({type:"litecomment/create",payload:{data:n.comment,commentListStyle:"floor",insertToBottom:!0}})}else t===U.a.MESSAGE.COMMENT_UPDATE?l({type:"litecomment/updateOne",payload:n.comment}):t===U.a.MESSAGE.COMMENT_DELETE&&l({type:"litecomment/remove",payload:n.comment})}));case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){null==x||x.reset()}}),[]),{state:{loading:p,loaded:h,pageNo:O,flattenFloorComments:M,bottomEditorPlaceholder:T,replyToComment:R,commentCollab:x},setBottomEditorPlaceHolder:C,setReplyToComment:k,setPageNo:S,getDefaultSuggestions:function(){return _.a.getParticipants(n,M,{groupMembers:r.members,targetType:t})},handleCreateRootComment:function(t){l({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==x||x.createComment(t),F(),"mini"===e.size&&N(),e.onCreate&&e.onCreate(t)},handleCreateReplyToComment:function(t){t.to_user=null==R?void 0:R.user,l({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==x||x.createComment(t),F(),e.onCreate&&e.onCreate(t),s&&setTimeout((function(){var e=document.querySelector("#comment-".concat(t.id));null==e||e.scrollIntoView({behavior:"smooth",block:"center"})}),100)},renderAllComments:F,scrollToEditor:N}}function En(e){var t,n,o=e.group,u=e.book,l=e.doc,s=e.target,f=e.commentableType,p=e.canComment,d=e.useMiniGuide,y=e.size,b=e.withAreaSelection,v=e.cancelable,g=e.onCancelCreate,w=e.dispatch,_=e.litecomment,E=void 0===_?{}:_,O=E.areaCommenting,S=void 0!==O&&O,j=E.currentCommentId,T=e.me,C=e.isMobile,P=e.getViewEngine,R=e.openInfiniteScroll,k=e.pageSize,L=e.onCommentLoaded,A=e.commentTipText,x=e.reverseReplyButton,N=vn(Object(a.useState)(!1),2),D=N[0],I=N[1],B=vn(Object(a.useState)(!1),2),U=B[0],G=B[1],q=Object(a.useRef)(null),Y=Object(a.useRef)(!1),V=_n(e),z=V.state,W=z.loading,H=z.pageNo,K=z.flattenFloorComments,X=z.bottomEditorPlaceholder;Object(a.useEffect)((function(){W||Y.current||(Y.current=!0,null==L||L())}),[W,L]);var J=F.a.isPrivate(l,u,o),$=c.a.createRef(),Z=function(e){$&&$.current&&(V.setReplyToComment(e),R&&(V.renderAllComments(),G(!0)),V.setBottomEditorPlaceHolder(__("回复 {user}",{user:e.user.name})),$.current.handleReplyTo(e.id),V.scrollToEditor())},Q=function(){var e=document.querySelector("#lark-mini-editor");e&&e.scrollIntoView({block:"center"})};if(Object(a.useEffect)((function(){e.focusToEditor&&$&&$.current&&$.current.focusEditor()}),[e.focusToEditor]),Object(a.useEffect)((function(){D||e.onEditorReady&&$&&$.current&&(I(!0),e.onEditorReady($.current))}),[$]),Object(a.useEffect)((function(){var e;U&&(Q(),null==$||null===(e=$.current)||void 0===e||e.focusEditor())}),[U]),Object(a.useImperativeHandle)(e.forwardedRef,(function(){return{renderAllComments:V.renderAllComments}})),W)return c.a.createElement(r.a,{justify:"block"});var ee="mini"===y||C,te=ee&&d,ne=i()(K,k).length,re=K.slice(0,k*(H+1));return c.a.createElement("div",{className:m()((t={},dn(t,Jt,!ee),dn(t,Zt,ee),t),"comment-floor-mini"),ref:q},R?c.a.createElement(h.a,{loadMore:function(){V.setPageNo(H+1)},hasMore:H<ne,useWindow:"mini"!==y,getScrollParent:function(){return q.current}},c.a.createElement(ln,{comments:re,flattenFloorComments:K,me:T,group:o,target:s,commentableType:f,currentCommentId:j,isMiniSize:ee,useMiniGuide:d,disableYuqueCardEmbedView:!J,canComment:p,getViewEngine:P,getDefaultSuggestions:V.getDefaultSuggestions,onReplyToComment:Z,onEditComment:Q,onRemoveComment:e.onRemove,onCreateComment:e.onCreate,dispatch:w,editorAffixed:te,isMobile:C,areaCommenting:S,cancelable:v,onCancelCreate:g,litecomment:e.litecomment,reverseReplyButton:x})):c.a.createElement(ln,{comments:K,flattenFloorComments:K,me:T,group:o,target:s,commentableType:f,currentCommentId:j,isMiniSize:ee,useMiniGuide:d,disableYuqueCardEmbedView:!J,canComment:p,getViewEngine:P,getDefaultSuggestions:V.getDefaultSuggestions,onReplyToComment:Z,onEditComment:Q,onRemoveComment:e.onRemove,onCreateComment:e.onCreate,dispatch:w,editorAffixed:te,isMobile:C,areaCommenting:S,cancelable:v,onCancelCreate:g,litecomment:e.litecomment,reverseReplyButton:x}),te&&!K.length&&c.a.createElement("div",{className:Qt},__("暂无回复")),c.a.createElement("div",{id:"scroll-to-comment"}),c.a.createElement("div",{className:m()($t,(n={},dn(n,en,te),dn(n,tn,C),n))},c.a.createElement(M,{ref:$,disableYuqueCardEmbedView:!J,group:o,target:s,targetType:f,comments:K,litecomment:e.litecomment,useMiniGuide:d,canComment:p,onCreate:C?V.handleCreateReplyToComment:V.handleCreateRootComment,getDefaultSuggestions:V.getDefaultSuggestions,isMiniSize:ee,editorAffixed:te,withAreaSelection:b,dispatch:w,areaCommenting:S,cancelable:v,onCancelCreate:g,me:T,showReply:C,placeholder:X,onCloseReply:function(){V.setBottomEditorPlaceHolder("")},commentTipText:A})))}En.defaultProps={canComment:!0,canMentionMembers:!1,useMiniGuide:!1,size:"default",me:window.appData.me,isMobile:window.h5,openInfiniteScroll:!1,pageSize:15},En.propTypes={commentableType:l.a.oneOf(_.a.TARGET_TYPES),group:l.a.object.isRequired,book:l.a.object,doc:l.a.object,target:l.a.object.isRequired,canMentionMembers:l.a.bool,cancelable:l.a.bool,onCancelCreate:l.a.func,useMiniGuide:l.a.bool,onCreate:l.a.func,onRemove:l.a.func,focusToEditor:l.a.bool,canComment:l.a.bool,size:l.a.oneOf(["default","mini"]),withAreaSelection:l.a.bool,litecomment:l.a.object,onEditorReady:l.a.func,me:l.a.object,isMobile:l.a.bool,dispatch:l.a.func,getViewEngine:l.a.func,openInfiniteScroll:l.a.bool,pageSize:l.a.number,onCommentLoaded:l.a.func,commentTipText:l.a.string,reverseReplyButton:l.a.bool};Object(d.d)((function(e){return{litecomment:e.litecomment}}))(En);var On=Object(d.d)((function(e){return{litecomment:e.litecomment,group:e.group}}))(En);t.a=Object(a.forwardRef)((function(e,t){return c.a.createElement(On,fn({},e,{forwardedRef:t}))}))},4035:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(3663),a=n(2),c=n.n(a),u=function(e){var t,n=e.type,r=void 0===n?"Doc":n,a=e.target,c=e.style;return r&&a&&window.appData.isYuque?((null===(t=window.appData)||void 0===t?void 0:t.settings)||{}).disable_ip_region_model?null:(Object(i.a)()||Object(i.b)())&&("Doc"!==r||a.first_published_at)&&a.region?o.a.createElement("span",{style:c},__("IP 属地"),a.region||__("未知")):null:null};u.propTypes={target:c.a.object.isRequired,type:c.a.string},t.a=u},4776:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(2),a=n.n(i),c=n(5),u=n.n(c),l=n(469),s=n(45),f=n(108),p=n(4026),m=n(302),d=n(3990),y=n(787),h={commmentHeader:"ReaderComment-module_commmentHeader_U8YZ5",mobileCommmentHeaderWrapper:"ReaderComment-module_mobileCommmentHeaderWrapper_MxoIa",mobileCommmentHeader:"ReaderComment-module_mobileCommmentHeader_O2gLE",count:"ReaderComment-module_count_6syjv",replayBtn:"ReaderComment-module_replayBtn_YG364",text:"ReaderComment-module_text_E5A0E",commentFloorContainer:"ReaderComment-module_commentFloorContainer_hYRys",mobileCommentFloorContainer:"ReaderComment-module_mobileCommentFloorContainer_6CVJy",header:"ReaderComment-module_header_9Ej69",headerTitle:"ReaderComment-module_headerTitle_MaqXh",headerBtn:"ReaderComment-module_headerBtn_YdQfC",mobile:"ReaderComment-module_mobile_f+LqA"};function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===b(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n,i=e.target,a=e.isShare,c=e.group,l=e.book,m=e.withCornerBubble,b=e.getViewEngine,w=e.onRemoveComment,_=e.onCreateComment,E=e.litecomment,O=e.autoScrollToComment,S=a?"share":"read",j=null===(t=window.location.hash)||void 0===t?void 0:t.match(/#comment-(\d+)/),T=j?j[1]:void 0,C=!!T,P=!C,R=g(Object(r.useState)(!1),2),k=R[0],L=R[1],A=Object(r.useRef)(),x=function(){var e=document.querySelector("#lark-mini-editor");e?(P&&A.current&&A.current.renderAllComments(),e.scrollIntoView(),L(!0)):document.querySelector("#scroll-to-comment").scrollIntoView()},N=E.commentCount>0?o.a.createElement("div",{className:h.commmentHeader},__("所有评论（{count}）",{count:E.commentCount})):null,D=E.commentCount>0?o.a.createElement("div",{className:h.mobileCommmentHeaderWrapper},o.a.createElement("div",{className:h.mobileCommmentHeader},o.a.createElement("span",{className:h.count},__("所有评论（{count}）",{count:E.commentCount})),o.a.createElement("a",{className:h.replayBtn,onClick:x},o.a.createElement(s.b,{name:"edit-border",width:20}),o.a.createElement("span",{className:h.text},__("回复"))))):null,I=window.h5,M=o.a.createElement("div",{className:h.wrapper},I?D:N,o.a.createElement("div",{className:u()((n={},v(n,h.mobileCommentFloorContainer,I),v(n,h.commentFloorContainer,!I),n))},o.a.createElement(p.a,{ref:A,key:i.id,commentableType:e.targetType,target:e.target,group:c,book:l,doc:i,canMentionMembers:y.a.canMentionMembers(S,{group:c}),onCreate:_,onRemove:w,canComment:!0,focusToEditor:k,getViewEngine:b,openInfiniteScroll:P,onCommentLoaded:function(){O&&T&&setTimeout((function(){var e=document.querySelector("#comment-".concat(T));null==e||e.scrollIntoView(!0)}),1e3)}})),m&&o.a.createElement(d.a,{iconName:"comment-bubble",style:{bottom:"86px"},"data-aspm-click":"d348477",onClick:function(){Object(f.spmClick)("d348477"),x()},count:E.commentCount>0?E.commentCount:0})),F=g(Object(r.useState)(C?M:null),2),B=F[0],U=F[1];return Object(r.useEffect)((function(){U(M)}),[k]),Object(r.useEffect)((function(){U(M)}),[E.commentCount]),o.a.createElement(o.a.Fragment,null,B)};_.defaultProps={isShare:!1,onCreateComment:function(){},onRemoveComment:function(){}},_.propTypes={target:a.a.object.isRequired,litecomment:a.a.object.isRequired,targetType:a.a.oneOf(["Doc","DocVersion"]).isRequired,book:a.a.object.isRequired,group:a.a.object.isRequired,autoScrollToComment:a.a.bool,isShare:a.a.bool,onCreateComment:a.a.func,onRemoveComment:a.a.func,withCornerBubble:a.a.bool,getViewEngine:a.a.func};t.default=Object(m.b)(Object(l.d)((function(e){return{litecomment:e.litecomment}}))(_),!0)},585:function(e,t){e.exports={isPaid:function(e){var t,n,r=("undefined"==typeof window?{}:window).appData,o=e||r,i=o.group,a=o.organization,c=o.isYuque,u=o.me,l=(e||r).checkSelf;return l=l||/(my\/notes)|(dashboard\/notes)|(desktop\/notes)/.test(null===(t=window)||void 0===t||null===(n=t.location)||void 0===n?void 0:n.pathname),!c||(a?a.isPremium:i?i.isPaid:!(!u||!l)&&u.isPaid)},isPaidCheckAll:function(){var e=("undefined"==typeof window?{}:window).appData,t=e.group,n=e.organization,r=e.isYuque,o=e.me;return!r||(n?n.isPremium:t?t.isPaid:!!o&&o.isPaid)}}},958:function(e,t,n){"use strict";var r=n(1617),o={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,i,a,c,u,l,s=!1;t||(t={}),n=t.debug||!1;try{if(a=r(),c=document.createRange(),u=document.getSelection(),(l=document.createElement("span")).textContent=e,l.ariaHidden="true",l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",l.addEventListener("copy",(function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),void 0===r.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=o[t.format]||o.default;window.clipboardData.setData(i,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))})),document.body.appendChild(l),c.selectNodeContents(l),u.addRange(c),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");s=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),s=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{u&&("function"==typeof u.removeRange?u.removeRange(c):u.removeAllRanges()),l&&document.body.removeChild(l),a()}return s}}}]);