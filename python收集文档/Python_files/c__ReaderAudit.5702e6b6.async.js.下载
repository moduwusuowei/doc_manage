(window.webpackJsonp=window.webpackJsonp||[]).push([[1281],{3691:function(e,t,n){"use strict";n.r(t);n(176);var r=n(64),a=(n(71),n(31)),l=(n(151),n(66)),o=n(0),i=n.n(o),c=n(2),u=n.n(c),s=n(502),d=n.n(s),m=n(5),f=n.n(m),_=n(78),p=n(145),S=n(52),A=n(45),b={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,o,i=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.icon,n=e.content,r=e.style,a=e.showClose,l=T(Object(o.useState)(!0),2),c=l[0],u=l[1];return c?i.a.createElement("div",{className:b.wrap,style:r},t&&i.a.createElement("div",{className:b.icon},t),i.a.createElement("div",{className:b.content},n),a&&i.a.createElement("div",{className:b.close,onClick:function(){u(!1)}},i.a.createElement("span",{className:f()("lake-icon","lake-icon-close",b.closeIcon)}))):null};y.propTypes={icon:u.a.node,content:u.a.node.isRequired,style:u.a.object,showClose:u.a.bool};var E=y,v=n(302),R="ReaderAudit-module_closeBtn_hHU+3",D="ReaderAudit-module_detail_mWCgN",h="ReaderAudit-module_toggleDetail_pq7CA",w="ReaderAudit-module_moreLink_oxcCo",U="ReaderAudit-module_tagModeWrapper_xupeI",O="ReaderAudit-module_tagText_Womh9",j="ReaderAudit-module_pending_m3C28",k="ReaderAudit-module_illegal_B8aJ7",N="ReaderAudit-module_banned_sHuxy",x="ReaderAudit-module_isIntranet_WPBjb",C="ReaderAudit-module_tagClose_YIxR7";function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===I(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,o,i=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e){var t,n=M(Object(o.useState)(!1),2),c=n[0],u=n[1],s=M(Object(o.useState)(!0),2),m=s[0],b=s[1],T=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,g=e.doc,y=e.type,v=e.tagMode,I=g.audits,P=g.read_status,Y=g.id,F=g.content_updated_at,W=g.abilities,H=void 0===W?{}:W,J=window.appData,K=J.book,L=J.group,$=J.me,z=e.isYuque||window.appData.isYuque;var G="audit_ignored_".concat(y,"_").concat(Y);function Q(e){null==e||e.preventDefault(),localStorage.setItem(G,Date.now()),b(!1)}function V(e){var t=e.filter((function(e){return null!==e}));return d()(t)}if(Object(o.useEffect)((function(){if(P===_.READ_STATUS.insecure)if($.isAdmin||H.update){if(!T){var e=localStorage.getItem(G);if(e&&F){var t=new Date(F).getTime();b(t>e)}}}else b(!1)}),[]),P<=_.READ_STATUS.ok&&(null==K?void 0:K.status)!==p.STATUS.banned&&(null==L?void 0:L.status)!==S.STATUS.blocked)return null;if(P<=_.READ_STATUS.ok&&((null==K?void 0:K.status)===p.STATUS.banned||(null==L?void 0:L.status)===S.STATUS.blocked))return null!=$&&$.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==L?void 0:L.status)===S.STATUS.blocked,", bookBlocked: ").concat((null==K?void 0:K.status)===p.STATUS.banned)),null;if(null!=L&&L.isPermanentPunished)return null!=$&&$.isAdmin&&P>_.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===y&&P<=_.READ_STATUS.ok)return null;if(!m)return null;var X=[];I&&(I.forbidden||I.reason)&&(X=I.forbidden||[I.reason]);var Z,ee={};if(ee[_.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),ee[_.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),ee[_.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[_.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[_.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[_.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[_.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),z)Z=ee[P]||ee[_.READ_STATUS.suspect];else{var te=!v&&X.length>0?i.a.createElement("a",{onClick:function(e){e.preventDefault(),u(!c)},className:h},c?"收起详情":"展开详情"):null,ne=i.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:w},__("了解更多"));Z=T||P!==_.READ_STATUS.insecure?i.a.createElement(i.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),ne,te," "):i.a.createElement(i.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ne,te)}var re=z?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(v){if(z){var ae,le,oe,ie,ce=(B(ae={},_.READ_STATUS.pending,__("审核中")),B(ae,_.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),B(ae,_.READ_STATUS.banned,__("该内容已屏蔽#tag")),ae);switch(P){case _.READ_STATUS.pending:case _.READ_STATUS.suspect:ie=_.READ_STATUS.pending;break;case _.READ_STATUS.illegal:case _.READ_STATUS.illegal_polity:case _.READ_STATUS.illegal_ak:case _.READ_STATUS.illegal_privacy:ie=_.READ_STATUS.illegal;break;case _.READ_STATUS.banned:ie=_.READ_STATUS.banned;break;default:ie=null}return(oe=ce[ie])?i.a.createElement(l.a,{title:i.a.createElement("span",{className:O},Z),placement:"bottom"},i.a.createElement("div",{className:f()(U,(le={},B(le,j,ie===_.READ_STATUS.pending),B(le,k,ie===_.READ_STATUS.illegal),B(le,N,ie===_.READ_STATUS.banned),le))},i.a.createElement("span",{className:O},oe))):null}return i.a.createElement("div",{className:f()(U,x),onClick:function(){a.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:i.a.createElement(i.a.Fragment,null,Z,X.length>0&&i.a.createElement("ul",{className:D},V(X).map((function(e){return i.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){Q()}})}},i.a.createElement("span",{className:O},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),i.a.createElement("div",{className:C,onClick:function(e){e.stopPropagation(),Q()}},i.a.createElement(A.b,{name:"close",width:10,height:10})))}return i.a.createElement(E,{style:q({marginBottom:"Doc"===y?24:0,marginTop:4},re),icon:i.a.createElement(A.b,{name:"doc-has-content-risk",height:17,width:15}),content:i.a.createElement(i.a.Fragment,null,!z&&i.a.createElement(r.a,{title:__("确认忽略该提醒？"),onConfirm:Q,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},i.a.createElement("span",{className:R},i.a.createElement(A.b,{name:"close",width:14}))),i.a.createElement("span",{"data-testid":"audit-tip"},Z),c&&i.a.createElement("ul",{className:D},V(X).map((function(e){return i.a.createElement("li",{key:e},e)}))))})}F.defaultProps={isYuque:window.appData.isYuque},F.propTypes={doc:u.a.object.isRequired,type:u.a.string,isYuque:u.a.bool,tagMode:u.a.bool};t.default=Object(v.b)(F)}}]);