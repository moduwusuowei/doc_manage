/*! For license information please see lakex_table_yq.941b6184.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{3687:function(e,t,r){},3688:function(e,t,r){"use strict";r.r(t),function(e,n){r.d(t,"ABILITY_ID",(function(){return aR})),r.d(t,"ABILITY_TYPE",(function(){return oR})),r.d(t,"Ability",(function(){return gR})),r.d(t,"AbilityRegistry",(function(){return dR})),r.d(t,"AbilityService",(function(){return bR})),r.d(t,"Abstract",(function(){return Yi})),r.d(t,"AbstractPluginManager",(function(){return hE})),r.d(t,"ActiveTableServiceToken",(function(){return Bz})),r.d(t,"AfterRefreshProps",(function(){return QO})),r.d(t,"AsyncParallelBailHook",(function(){return tE})),r.d(t,"AsyncParallelHook",(function(){return rE})),r.d(t,"AsyncSeriesBailHook",(function(){return nE})),r.d(t,"AsyncSeriesHook",(function(){return iE})),r.d(t,"AsyncSeriesLoopHook",(function(){return oE})),r.d(t,"AsyncSeriesWaterfallHook",(function(){return aE})),r.d(t,"BASE_TYPE",(function(){return gE})),r.d(t,"BASE_TYPE_MAP",(function(){return mE})),r.d(t,"BaseAbility",(function(){return sR})),r.d(t,"BeforeRefreshProps",(function(){return QO})),r.d(t,"COL_MAPPER",(function(){return PE})),r.d(t,"CONDITION_FUNC_GROUPS",(function(){return DE})),r.d(t,"COVER_DISPLAY_TYPE",(function(){return UE})),r.d(t,"CURRENT_VERSION",(function(){return VE})),r.d(t,"Cell",(function(){return xE})),r.d(t,"CellId",(function(){return ije})),r.d(t,"CellModel",(function(){return Ek})),r.d(t,"CollaborationKernelPluginContribution",(function(){return FN})),r.d(t,"Column",(function(){return xw})),r.d(t,"ColumnGroup",(function(){return oje})),r.d(t,"CommandCancelEventDetail",(function(){return LI})),r.d(t,"CommandEventDetail",(function(){return LI})),r.d(t,"CommandExecutorToken",(function(){return VI})),r.d(t,"CommandFinishEventDetail",(function(){return LI})),r.d(t,"CommandFunc",(function(){return uje})),r.d(t,"CommandRegistryToken",(function(){return jI})),r.d(t,"CommandService",(function(){return zI})),r.d(t,"CommentContribution",(function(){return gze})),r.d(t,"Configuration",(function(){return Np})),r.d(t,"ConfigurationEvent",(function(){return cp})),r.d(t,"ConfigurationModel",(function(){return Rp})),r.d(t,"ConfigurationRegistry",(function(){return kp})),r.d(t,"ConfigurationToken",(function(){return lp})),r.d(t,"Container",(function(){return yh})),r.d(t,"ContentEditorContribution",(function(){return JUe})),r.d(t,"ContentService",(function(){return xO})),r.d(t,"ContentViewerContribution",(function(){return XUe})),r.d(t,"ContextService",(function(){return Tk})),r.d(t,"Contribution",(function(){return Ch})),r.d(t,"CopyRecordParams",(function(){return aje})),r.d(t,"CreateActionParams",(function(){return sR})),r.d(t,"CreateEmptyRecordParams",(function(){return aje})),r.d(t,"DATE_FORMATTER",(function(){return Cf})),r.d(t,"Debug",(function(){return Jo})),r.d(t,"Decorator",(function(){return Yi})),r.d(t,"DefaultContributionProvider",(function(){return Co})),r.d(t,"Destroyable",(function(){return fp})),r.d(t,"DestroyableCollection",(function(){return gp})),r.d(t,"Driver",(function(){return ap})),r.d(t,"DriverExecuteOption",(function(){return sp})),r.d(t,"DriverStatus",(function(){return Fh})),r.d(t,"DriverToken",(function(){return jh})),r.d(t,"Emitter",(function(){return _p})),r.d(t,"EventDeliveryQueue",(function(){return yp})),r.d(t,"FIELD_TYPE",(function(){return pE})),r.d(t,"FIELD_TYPES",(function(){return yE})),r.d(t,"FIELD_TYPE_CONFIGS",(function(){return _E})),r.d(t,"FILTER_FUNC",(function(){return OE})),r.d(t,"FILTER_OPERATOR",(function(){return IE})),r.d(t,"FULL_SCREEN_STATUS",(function(){return nze})),r.d(t,"Field",(function(){return xE})),r.d(t,"FieldAbility",(function(){return OR})),r.d(t,"FieldBase",(function(){return lI})),r.d(t,"FieldBoolean",(function(){return xE})),r.d(t,"FieldBooleanModel",(function(){return KE})),r.d(t,"FieldByCreate",(function(){return xE})),r.d(t,"FieldCreateParams",(function(){return sje})),r.d(t,"FieldDate",(function(){return xE})),r.d(t,"FieldDateModel",(function(){return XE})),r.d(t,"FieldDetail",(function(){return cje})),r.d(t,"FieldGroup",(function(){return xE})),r.d(t,"FieldGroupModel",(function(){return NS})),r.d(t,"FieldId",(function(){return vE})),r.d(t,"FieldModel",(function(){return tS})),r.d(t,"FieldMultiSelect",(function(){return xE})),r.d(t,"FieldNumber",(function(){return xE})),r.d(t,"FieldNumberModel",(function(){return oS})),r.d(t,"FieldOption",(function(){return xE})),r.d(t,"FieldOptionModel",(function(){return cS})),r.d(t,"FieldRecordDetail",(function(){return cje})),r.d(t,"FieldRegistry",(function(){return Fk})),r.d(t,"FieldRule",(function(){return vE})),r.d(t,"FieldSelect",(function(){return xE})),r.d(t,"FieldSelectBase",(function(){return xE})),r.d(t,"FieldSelectModel",(function(){return hS})),r.d(t,"FieldSingleSelect",(function(){return xE})),r.d(t,"FieldString",(function(){return xE})),r.d(t,"FieldStringModel",(function(){return vS})),r.d(t,"FieldTypeHelper",(function(){return zE})),r.d(t,"FieldURIModel",(function(){return wS})),r.d(t,"FieldUri",(function(){return xE})),r.d(t,"FieldValue",(function(){return xE})),r.d(t,"Filter",(function(){return xE})),r.d(t,"FilterData",(function(){return oje})),r.d(t,"FilterModel",(function(){return kS})),r.d(t,"FullScreenService",(function(){return sze})),r.d(t,"FullWidthService",(function(){return hze})),r.d(t,"GROUP_ORDER",(function(){return NE})),r.d(t,"GlobalContainer",(function(){return bh})),r.d(t,"Group",(function(){return xE})),r.d(t,"GroupData",(function(){return oje})),r.d(t,"GroupModel",(function(){return RS})),r.d(t,"GroupOption",(function(){return xE})),r.d(t,"GroupViewRecordDetail",(function(){return cje})),r.d(t,"HistoryToken",(function(){return rg})),r.d(t,"HookMap",(function(){return sE})),r.d(t,"IAbility",(function(){return sR})),r.d(t,"IActiveTableService",(function(){return Uz})),r.d(t,"IBindingLoggerSettings",(function(){return XPe})),r.d(t,"IBulkSetCell",(function(){return ije})),r.d(t,"ICell",(function(){return ije})),r.d(t,"ICellBase",(function(){return ije})),r.d(t,"ICellCheckbox",(function(){return ije})),r.d(t,"ICellDate",(function(){return ije})),r.d(t,"ICellFileItem",(function(){return ije})),r.d(t,"ICellLink",(function(){return ije})),r.d(t,"ICellLinkValue",(function(){return vE})),r.d(t,"ICellMention",(function(){return ije})),r.d(t,"ICellMultiSelect",(function(){return ije})),r.d(t,"ICellSelect",(function(){return ije})),r.d(t,"ICellText",(function(){return ije})),r.d(t,"ICellUser",(function(){return ije})),r.d(t,"ICellUserBase",(function(){return ije})),r.d(t,"ICellValue",(function(){return ije})),r.d(t,"ICellValueFile",(function(){return ije})),r.d(t,"ICommand",(function(){return dje})),r.d(t,"ICommandContext",(function(){return uje})),r.d(t,"ICommandExecutor",(function(){return LI})),r.d(t,"ICommandHook",(function(){return dje})),r.d(t,"ICommandRegistry",(function(){return FI})),r.d(t,"ICommandService",(function(){return fje})),r.d(t,"IConfigurationNode",(function(){return cp})),r.d(t,"IConfigurationPropertySchema",(function(){return cp})),r.d(t,"ICreateField",(function(){return vE})),r.d(t,"ICreateFieldOption",(function(){return vE})),r.d(t,"IDriver",(function(){return Vh})),r.d(t,"IEditor",(function(){return e9})),r.d(t,"IEmitter",(function(){return QPe})),r.d(t,"IEvent",(function(){return QPe})),r.d(t,"IField",(function(){return vE})),r.d(t,"IFieldValue",(function(){return xE})),r.d(t,"IFilter",(function(){return XPe})),r.d(t,"IFilterTarget",(function(){return XPe})),r.d(t,"IHistory",(function(){return ng})),r.d(t,"IJSONSchema",(function(){return pje})),r.d(t,"IJSONSchemaMap",(function(){return pje})),r.d(t,"IKernel",(function(){return iR})),r.d(t,"IKernelOptions",(function(){return iR})),r.d(t,"IKernelPlugin",(function(){return iR})),r.d(t,"IKernelService",(function(){return rR})),r.d(t,"IKernelServiceInitOptions",(function(){return rR})),r.d(t,"ILifecycleService",(function(){return Oh})),r.d(t,"ILogData",(function(){return pze})),r.d(t,"ILogEntry",(function(){return XPe})),r.d(t,"ILogger",(function(){return uI})),r.d(t,"ILoggerSettings",(function(){return XPe})),r.d(t,"IModelContribution",(function(){return tg})),r.d(t,"IPluginOpt",(function(){return nje})),r.d(t,"IPlugins",(function(){return nje})),r.d(t,"IProcessKernelPluginProvider",(function(){return QM})),r.d(t,"IProcessKernelPluginRegistry",(function(){return QM})),r.d(t,"IProcessRecordsMiddleware",(function(){return QM})),r.d(t,"IProcessTableMiddleware",(function(){return QM})),r.d(t,"IProcessUsersMiddleware",(function(){return QM})),r.d(t,"IProcessor",(function(){return oje})),r.d(t,"IRenderContextService",(function(){return Fz})),r.d(t,"IRequestLoggerSettings",(function(){return XPe})),r.d(t,"ISetCell",(function(){return ije})),r.d(t,"ISpell",(function(){return Uh})),r.d(t,"ISpellProcess",(function(){return Uh})),r.d(t,"IStorage",(function(){return Hh})),r.d(t,"IStruct",(function(){return jp})),r.d(t,"ITablePlugin",(function(){return nje})),r.d(t,"ITablePluginCtor",(function(){return nje})),r.d(t,"ITablePluginManager",(function(){return nje})),r.d(t,"ITargetLoggerSettings",(function(){return XPe})),r.d(t,"ITaskBase",(function(){return vI})),r.d(t,"ITransFieldType",(function(){return vE})),r.d(t,"ITransaction",(function(){return hje})),r.d(t,"IUpdateField",(function(){return vE})),r.d(t,"IUpdateFieldName",(function(){return vE})),r.d(t,"IUpdateFieldProperty",(function(){return vE})),r.d(t,"IUpdateValueOrder",(function(){return ije})),r.d(t,"IUser",(function(){return xE})),r.d(t,"JSONSchema",(function(){return qUe})),r.d(t,"JSONSchemaInstanceOf",(function(){return pje})),r.d(t,"JSONSchemaOption",(function(){return YUe})),r.d(t,"JSONSchemaType",(function(){return pje})),r.d(t,"JSONSchemaTypeOf",(function(){return pje})),r.d(t,"JSONStringParser",(function(){return oje})),r.d(t,"KEYCODE",(function(){return SN})),r.d(t,"KernelCommand",(function(){return PI})),r.d(t,"KernelCommandConstructor",(function(){return FI})),r.d(t,"KernelModel",(function(){return UO})),r.d(t,"KernelModelToken",(function(){return EE})),r.d(t,"KernelPluginContribution",(function(){return nR})),r.d(t,"KernelService",(function(){return jR})),r.d(t,"KernelServiceToken",(function(){return tR})),r.d(t,"KeyCode",(function(){return kN})),r.d(t,"KeyboardKey",(function(){return xN})),r.d(t,"LOCAL_TIME_FORMAT",(function(){return wf})),r.d(t,"LakeTable",(function(){return oje})),r.d(t,"LakeTableFormView",(function(){return oje})),r.d(t,"LakeTableFormViewField",(function(){return oje})),r.d(t,"LakeTableRecord",(function(){return oje})),r.d(t,"LakeTableSheet",(function(){return oje})),r.d(t,"LakeTableString",(function(){return oje})),r.d(t,"LakeTableView",(function(){return oje})),r.d(t,"LazyServiceIdentifer",(function(){return an})),r.d(t,"LifeCycleServiceToken",(function(){return xh})),r.d(t,"LifecycleService",(function(){return Ah})),r.d(t,"LifecycleStatus",(function(){return kh})),r.d(t,"LifecycleStatusMap",(function(){return Th})),r.d(t,"Literal",(function(){return eje})),r.d(t,"Locale",(function(){return Dh})),r.d(t,"LogObj",(function(){return uI})),r.d(t,"LoggerOptions",(function(){return XPe})),r.d(t,"LoggerToken",(function(){return cI})),r.d(t,"ModalServiceToken",(function(){return c8})),r.d(t,"Model",(function(){return Ok})),r.d(t,"ModelBase",(function(){return Ow})),r.d(t,"ModelChangeType",(function(){return nw})),r.d(t,"ModelContribution",(function(){return eg})),r.d(t,"ModelCtor",(function(){return tg})),r.d(t,"ModelEvent",(function(){return rw})),r.d(t,"ModelEventService",(function(){return Bk})),r.d(t,"ModelEventToken",(function(){return Lh})),r.d(t,"ModelInitial",(function(){return dw})),r.d(t,"ModelInitialToken",(function(){return $h})),r.d(t,"ModelInitializeOptions",(function(){return zO})),r.d(t,"ModelQuery",(function(){return mw})),r.d(t,"ModelRegistry",(function(){return sw})),r.d(t,"ModelService",(function(){return _w})),r.d(t,"ModelStruct",(function(){return Qp})),r.d(t,"ModelType",(function(){return SE})),r.d(t,"Module",(function(){return xo})),r.d(t,"ModuleContrib",(function(){return Lxe})),r.d(t,"MultiHook",(function(){return lE})),r.d(t,"NO_VALUE_CONDITIONS",(function(){return jE})),r.d(t,"Option",(function(){return po})),r.d(t,"OptionSymbol",(function(){return lo})),r.d(t,"OtherActionParams",(function(){return sR})),r.d(t,"PerformanceLog",(function(){return Zo})),r.d(t,"ProcessKernelPluginContribution",(function(){return ZM})),r.d(t,"Processor",(function(){return lN})),r.d(t,"Provider",(function(){return ho})),r.d(t,"QueueTask",(function(){return bI})),r.d(t,"QueueTaskJob",(function(){return vI})),r.d(t,"QueueTaskJobEvent",(function(){return vI})),r.d(t,"QueueTaskStatusEvent",(function(){return vI})),r.d(t,"QuqueTaskOption",(function(){return vI})),r.d(t,"REFRESH_TYPE",(function(){return XO})),r.d(t,"ROW_HEIGHT",(function(){return ME})),r.d(t,"ReadService",(function(){return KO})),r.d(t,"RecordAbility",(function(){return AR})),r.d(t,"RecordModel",(function(){return FS})),r.d(t,"RecordRes",(function(){return Vh})),r.d(t,"RecordType",(function(){return xE})),r.d(t,"RefreshEventService",(function(){return ZO})),r.d(t,"RenderContextService",(function(){return Wz})),r.d(t,"RepeatTask",(function(){return yI})),r.d(t,"RepeatTaskOption",(function(){return vI})),r.d(t,"RowHeightData",(function(){return oje})),r.d(t,"SORT_ORDER",(function(){return jN})),r.d(t,"START_DATE",(function(){return _f})),r.d(t,"STAT_TYPE",(function(){return lje})),r.d(t,"SafeDestroyable",(function(){return hp})),r.d(t,"SelectOption",(function(){return ije})),r.d(t,"SelectionService",(function(){return qte})),r.d(t,"Sort",(function(){return xE})),r.d(t,"SortData",(function(){return oje})),r.d(t,"SortModel",(function(){return BS})),r.d(t,"SortViewRecord",(function(){return cje})),r.d(t,"SpellColumn",(function(){return Uh})),r.d(t,"SpellCommand",(function(){return Bh})),r.d(t,"SpellCondition",(function(){return Uh})),r.d(t,"SpellOption",(function(){return Uh})),r.d(t,"SpellProcess",(function(){return rje})),r.d(t,"StackService",(function(){return Sw})),r.d(t,"Stat",(function(){return xE})),r.d(t,"StatData",(function(){return oje})),r.d(t,"StatDetail",(function(){return cje})),r.d(t,"StatModel",(function(){return WS})),r.d(t,"Storage",(function(){return Zp})),r.d(t,"StorageChangeEnum",(function(){return Xp})),r.d(t,"StorageChangeType",(function(){return Qp})),r.d(t,"StorageToken",(function(){return zh})),r.d(t,"StringKeyOf",(function(){return jp})),r.d(t,"Struct",(function(){return Z_})),r.d(t,"StructToken",(function(){return Pp})),r.d(t,"SyncBailHook",(function(){return cE})),r.d(t,"SyncHook",(function(){return uE})),r.d(t,"SyncLoopHook",(function(){return dE})),r.d(t,"SyncWaterfallHook",(function(){return fE})),r.d(t,"Syringe",(function(){return $i})),r.d(t,"SyringeModule",(function(){return So})),r.d(t,"TIMESTAMPS",(function(){return tg})),r.d(t,"TIMESTAMP_NAMES",(function(){return ZPe})),r.d(t,"Table",(function(){return xE})),r.d(t,"TableAbility",(function(){return ER})),r.d(t,"TableColumn",(function(){return eje})),r.d(t,"TableKernel",(function(){return FR})),r.d(t,"TableModel",(function(){return YS})),r.d(t,"TableService",(function(){return DO})),r.d(t,"TableType",(function(){return eje})),r.d(t,"TaskService",(function(){return EI})),r.d(t,"TaskStatus",(function(){return mI})),r.d(t,"ToProcessLaketable",(function(){return UR})),r.d(t,"TokenOption",(function(){return Yi})),r.d(t,"TransactionExecuteResult",(function(){return hje})),r.d(t,"UserModel",(function(){return QS})),r.d(t,"Utils",(function(){return Bi})),r.d(t,"VIEW_TYPE",(function(){return LE})),r.d(t,"VIEW_TYPES",(function(){return $E})),r.d(t,"Validator",(function(){return tje})),r.d(t,"View",(function(){return xE})),r.d(t,"ViewConfig",(function(){return xE})),r.d(t,"ViewConfigModel",(function(){return nk})),r.d(t,"ViewCoverDisplayType",(function(){return AE})),r.d(t,"ViewField",(function(){return xE})),r.d(t,"ViewFieldModel",(function(){return sk})),r.d(t,"ViewFilterDetail",(function(){return cje})),r.d(t,"ViewGroupDetail",(function(){return cje})),r.d(t,"ViewGroupItem",(function(){return xE})),r.d(t,"ViewGroupRecord",(function(){return xE})),r.d(t,"ViewModel",(function(){return dk})),r.d(t,"ViewRecord",(function(){return xE})),r.d(t,"ViewRecordDetail",(function(){return cje})),r.d(t,"ViewRecordModel",(function(){return gk})),r.d(t,"ViewRecordOrderDirectionEnum",(function(){return RE})),r.d(t,"ViewService",(function(){return CO})),r.d(t,"ViewShare",(function(){return xE})),r.d(t,"ViewShareModel",(function(){return bk})),r.d(t,"ViewShareStatus",(function(){return kE})),r.d(t,"ViewType",(function(){return TE})),r.d(t,"WriteService",(function(){return nI})),r.d(t,"Y",(function(){return G_})),r.d(t,"YArray",(function(){return jp})),r.d(t,"YArrayImpl",(function(){return Yh})),r.d(t,"YMap",(function(){return jp})),r.d(t,"YMapImpl",(function(){return Kp})),r.d(t,"__",(function(){return Ph})),r.d(t,"configurationModule",(function(){return Dp})),r.d(t,"contrib",(function(){return wh})),r.d(t,"createDocCardEditor",(function(){return e5e})),r.d(t,"createDocCardEditorH5",(function(){return u5e})),r.d(t,"createForm",(function(){return H3e})),r.d(t,"createStandardEditor",(function(){return a3e})),r.d(t,"createStandardEditorH5",(function(){return E3e})),r.d(t,"createStandardReader",(function(){return h3e})),r.d(t,"decorate",(function(){return Si})),r.d(t,"defaultColumns",(function(){return bE})),r.d(t,"defaultCount",(function(){return FE})),r.d(t,"defaultViewConfig",(function(){return BE})),r.d(t,"escape",(function(){return ff})),r.d(t,"escapeText",(function(){return vf})),r.d(t,"fixCount",(function(){return uf})),r.d(t,"getDefaultNameByType",(function(){return wE})),r.d(t,"getFieldConfigNameByType",(function(){return CE})),r.d(t,"getHotkeyText",(function(){return df})),r.d(t,"getLink",(function(){return Tf})),r.d(t,"getLocalTimeBySeconds",(function(){return Ef})),r.d(t,"getNumberString",(function(){return Df})),r.d(t,"getTime",(function(){return TN})),r.d(t,"getTimeDiference",(function(){return AN})),r.d(t,"getURLSearchParams",(function(){return Nf})),r.d(t,"inject",(function(){return ao})),r.d(t,"injectable",(function(){return no})),r.d(t,"isDate",(function(){return Vo})),r.d(t,"isDateLike",(function(){return dh})),r.d(t,"isDecimal",(function(){return mh})),r.d(t,"isEamil",(function(){return nh})),r.d(t,"isFullHttpURL",(function(){return Mf})),r.d(t,"isFunction",(function(){return No})),r.d(t,"isMobilePhone",(function(){return gh})),r.d(t,"isNil",(function(){return Lo})),r.d(t,"isNumber",(function(){return Po})),r.d(t,"isNumberLike",(function(){return Pf})),r.d(t,"isObject",(function(){return Fo})),r.d(t,"isPromise",(function(){return $o})),r.d(t,"isRegexp",(function(){return Do})),r.d(t,"isString",(function(){return jo})),r.d(t,"isSyringeModule",(function(){return ko})),r.d(t,"isType",(function(){return Mo})),r.d(t,"isURL",(function(){return uh})),r.d(t,"isWeakEmail",(function(){return pf})),r.d(t,"isWeakPhone",(function(){return hf})),r.d(t,"kernelAbilityModule",(function(){return MR})),r.d(t,"kernelCommandModule",(function(){return eR})),r.d(t,"kernelModelModule",(function(){return iI})),r.d(t,"kernelModule",(function(){return VR})),r.d(t,"loggerModule",(function(){return gI})),r.d(t,"loop",(function(){return IN})),r.d(t,"makeLoggerMiddleware",(function(){return PN})),r.d(t,"modelModule",(function(){return kw})),r.d(t,"named",(function(){return so})),r.d(t,"nextTick",(function(){return Oo})),r.d(t,"noop",(function(){return YPe})),r.d(t,"optional",(function(){return cN})),r.d(t,"parseDateNumToDate",(function(){return Sf})),r.d(t,"postConstruct",(function(){return Oi})),r.d(t,"preDestroy",(function(){return Ii})),r.d(t,"printableKey",(function(){return ON})),r.d(t,"promisifyBooleanFunction",(function(){return JPe})),r.d(t,"random",(function(){return gf})),r.d(t,"randomString",(function(){return mf})),r.d(t,"register",(function(){return _h})),r.d(t,"registerSideOption",(function(){return co})),r.d(t,"sanitizeUrl",(function(){return Af})),r.d(t,"singleton",(function(){return io})),r.d(t,"sleep",(function(){return Bxe})),r.d(t,"taskModule",(function(){return SI})),r.d(t,"transient",(function(){return oo})),r.d(t,"uid",(function(){return To})),r.d(t,"unmanaged",(function(){return $xe})),r.d(t,"yevery",(function(){return Wp})),r.d(t,"yfilter",(function(){return Vp})),r.d(t,"yfind",(function(){return Fp})),r.d(t,"yfindIndex",(function(){return Lp})),r.d(t,"ykeyBy",(function(){return Gp})),r.d(t,"ymap",(function(){return Bp})),r.d(t,"yreduce",(function(){return $p})),r.d(t,"yreverse",(function(){return Up})),r.d(t,"yslice",(function(){return Hp})),r.d(t,"ysome",(function(){return zp}));r(3687);var i,o,a=r(0),s=r.n(a),l=r(62),c=r.n(l),u=r(12),d=r(98),f=r(379),h=r(186),p=r(66),g=r(37),m=r(10),v=r(135),y=r(183),b=r(9),_=r(301),w=r(22),C=r(31),E=r(557),S=r(34),k=r(583),x=r(94),O=r(707),I=r(281),R=r(714),T=r(264),A=r(2995),M=r(904),N=r(1733),D=r(1731),P=r(1720),j=r(1730),F=r(1737),V=r(1210),L=r(1427),$=r(1623),B=r(1615),U=r(1738),z=r(1856),H=r(1616),W=r(1721),G=r(1625),K=r(1735),q=r(1739),Y=r(1425),J=r(1740),X=r(1741),Z=r(1742),Q=r(1743),ee=r(1744),te=r(1745),re=r(1746),ne=r(1747),ie=r(1748),oe=r(1749),ae=r(1750),se=r(1751),le=r(1752),ce=r(1753),ue=r(1754),de=r(1755),fe=r(1756),he=r(1757),pe=r(1758),ge=r(1759),me=r(1624),ve=r(1760),ye=r(1761),be=r(1408),_e=r(1732),we=r(1762),Ce=r(1763),Ee=r(1764),Se=r(1765),ke=r(1766),xe=r(1767),Oe=r(1768),Ie=r(1736),Re=r(1769),Te=r(1770),Ae=r(1771),Me=r(1722),Ne=r(1729),De=r(1772),Pe=r(1773),je=r(1774),Fe=r(1775),Ve=r(1429),Le=r(1776),$e=r(1777),Be=r(1778),Ue=r(1779),ze=r(1780),He=r(1781),We=r(1782),Ge=r(1783),Ke=r(1784),qe=r(1785),Ye=r(1786),Je=r(1787),Xe=r(1788),Ze=r(1789),Qe=r(1790),et=r(1791),tt=r(1792),rt=r(1793),nt=r(1794),it=r(1795),ot=r(1796),at=r(1797),st=r(1798),lt=r(1799),ct=r(1800),ut=r(1801),dt=r(1802),ft=r(1803),ht=r(1804),pt=r(1805),gt=r(1806),mt=r(1807),vt=r(1808),yt=r(1809),bt=r(1810),_t=r(1811),wt=r(1812),Ct=r(1813),Et=r(1814),St=r(1815),kt=r(1816),xt=r(1817),Ot=r(1818),It=r(1819),Rt=r(1820),Tt=r(1821),At=r(1402),Mt=r(1822),Nt=r(1823),Dt=r(1727),Pt=r(1728),jt=r(1698),Ft=r(1824),Vt=r(1825),Lt=r(1826),$t=r(1827),Bt=r(1213),Ut=(r(562),r(89)),zt=r.n(Ut),Ht=r(491),Wt=r.n(Ht),Gt=r(4e3),Kt=r(3200),qt=r.n(Kt),Yt=r(3725),Jt=r.n(Yt),Xt=r(211),Zt=r.n(Xt),Qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof e<"u"?e:typeof self<"u"?self:{},er={exports:{}},tr=er.exports={};function rr(){throw new Error("setTimeout has not been defined")}function nr(){throw new Error("clearTimeout has not been defined")}function ir(e){if(i===setTimeout)return setTimeout(e,0);if((i===rr||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch{try{return i.call(null,e,0)}catch{return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:rr}catch{i=rr}try{o="function"==typeof clearTimeout?clearTimeout:nr}catch{o=nr}}();var or,ar=[],sr=!1,lr=-1;function cr(){!sr||!or||(sr=!1,or.length?ar=or.concat(ar):lr=-1,ar.length&&ur())}function ur(){if(!sr){var e=ir(cr);sr=!0;for(var t=ar.length;t;){for(or=ar,ar=[];++lr<t;)or&&or[lr].run();lr=-1,t=ar.length}or=null,sr=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===nr||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{return o(e)}catch{try{return o.call(null,e)}catch{return o.call(this,e)}}}(e)}}function dr(e,t){this.fun=e,this.array=t}function fr(){}tr.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];ar.push(new dr(e,t)),1===ar.length&&!sr&&ir(ur)},dr.prototype.run=function(){this.fun.apply(null,this.array)},tr.title="browser",tr.browser=!0,tr.env={},tr.argv=[],tr.version="",tr.versions={},tr.on=fr,tr.addListener=fr,tr.once=fr,tr.off=fr,tr.removeListener=fr,tr.removeAllListeners=fr,tr.emit=fr,tr.prependListener=fr,tr.prependOnceListener=fr,tr.listeners=function(e){return[]},tr.binding=function(e){throw new Error("process.binding is not supported")},tr.cwd=function(){return"/"},tr.chdir=function(e){throw new Error("process.chdir is not supported")},tr.umask=function(){return 0};const hr=typeof e<"u"?e:typeof self<"u"?self:typeof window<"u"?window:{};var pr="named",gr="name",mr="unmanaged",vr="optional",yr="inject",br="multi_inject",_r="inversify:tagged",wr="inversify:tagged_props",Cr="inversify:paramtypes",Er="design:paramtypes",Sr="post_construct",kr="pre_destroy";var xr=[yr,br,gr,mr,pr,vr],Or={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Ir={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Rr={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},Tr=0;function Ar(){return Tr++}var Mr=function(){function e(e,t){this.id=Ar(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=Ir.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===Or.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),Nr="Cannot apply @injectable decorator multiple times.",Dr="Metadata key was used more than once in a parameter:",Pr="NULL argument",jr="Key Not Found",Fr="Ambiguous match found for serviceIdentifier:",Vr="No matching bindings found for serviceIdentifier:",Lr="Missing required @injectable annotation in:",$r="Missing required @inject or @multiInject annotation in:",Br="Circular dependency found:",Ur="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",zr=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},Hr=function(e,t){return"@postConstruct error in class "+e+": "+t},Wr=function(e,t){return"@preDestroy error in class "+e+": "+t},Gr=function(e,t){return"onDeactivation() error in class "+e+": "+t},Kr="Maximum call stack size exceeded",qr=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(Cr,e),userGeneratedMetadata:Reflect.getMetadata(_r,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(wr,e)||[]},e}(),Yr={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function Jr(e){return e instanceof RangeError||e.message===Kr}function Xr(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function Zr(e,t,r){var n="",i=r(e,t);return 0!==i.length&&(n="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=tn(e.implementationType)),n=n+"\n "+t,e.constraint.metaData&&(n=n+" - "+e.constraint.metaData)}))),n}function Qr(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||Qr(e.parentRequest,t))}function en(e){e.childRequests.forEach((function(e){if(Qr(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,r){void 0===r&&(r=[]);var n=Xr(t.serviceIdentifier);return r.push(n),null!==t.parentRequest?e(t.parentRequest,r):r}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(Br+" "+t)}en(e)}))}function tn(e){if(e.name)return e.name;var t=e.toString(),r=t.match(/^function\s*([^\s(]+)/);return r?r[1]:"Anonymous function: "+t}var rn=function(){function e(e){this.id=Ar(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),nn=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===pr?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}(),on=function(e,t){this.parentContext=e,this.rootRequest=t},an=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),sn=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,r=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},r)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),ln=function(){function e(e,t,r,n){this.id=Ar(),this.type=e,this.serviceIdentifier=r;var i="symbol"==typeof t?function(e){return e.toString().slice(7,-1)}(t):t;this.name=new sn(i||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof n?o=new nn(pr,n):n instanceof nn&&(o=n),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,r=this.metadata;t<r.length;t++){if(r[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(br)},e.prototype.matchesArray=function(e){return this.matchesTag(br)(e)},e.prototype.isNamed=function(){return this.hasTag(pr)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return xr.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(vr)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===pr}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return xr.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(pr)(e)},e.prototype.matchesTag=function(e){var t=this;return function(r){for(var n=0,i=t.metadata;n<i.length;n++){var o=i[n];if(o.key===e&&o.value===r)return!0}return!1}},e}(),cn=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};function un(e,t,r,n){var i=e.getConstructorMetadata(r),o=i.compilerGeneratedMetadata;if(void 0===o)throw new Error(Lr+" "+t+".");var a=i.userGeneratedMetadata,s=Object.keys(a),l=0===r.length&&s.length>0,c=s.length>r.length,u=function(e,t,r,n,i){for(var o=[],a=0;a<i;a++){var s=dn(a,e,t,r,n);null!==s&&o.push(s)}return o}(n,t,o,a,l||c?s.length:r.length),d=hn(e,r,t);return cn(cn([],u,!0),d,!0)}function dn(e,t,r,n,i){var o=i[e.toString()]||[],a=gn(o),s=!0!==a.unmanaged,l=n[e];if((l=a.inject||a.multiInject||l)instanceof an&&(l=l.unwrap()),s){if(!t&&(l===Object||l===Function||void 0===l))throw new Error($r+" argument "+e+" in class "+r+".");var c=new ln(Rr.ConstructorArgument,a.targetName,l);return c.metadata=o,c}return null}function fn(e,t,r,n){var i=e||t;if(void 0===i){var o=Lr+" for property "+String(r)+" in class "+n+".";throw new Error(o)}return i}function hn(e,t,r){for(var n=e.getPropertiesMetadata(t),i=[],o=Object.getOwnPropertySymbols(n),a=0,s=Object.keys(n).concat(o);a<s.length;a++){var l=s[a],c=n[l],u=gn(c),d=u.targetName||l,f=fn(u.inject,u.multiInject,l,r),h=new ln(Rr.ClassProperty,d,f);h.metadata=c,i.push(h)}var p=Object.getPrototypeOf(t.prototype).constructor;if(p!==Object){var g=hn(e,p,r);i=cn(cn([],i,!0),g,!0)}return i}function pn(e,t){var r=Object.getPrototypeOf(t.prototype).constructor;if(r!==Object){var n=un(e,tn(r),r,!0),i=n.map((function(e){return e.metadata.filter((function(e){return e.key===mr}))})),o=[].concat.apply([],i).length,a=n.length-o;return a>0?a:pn(e,r)}return 0}function gn(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[yr],multiInject:t[br],targetName:t[gr],unmanaged:t[mr]}}var mn=function(){function e(e,t,r,n,i){this.id=Ar(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=r,this.target=i,this.childRequests=[],this.bindings=Array.isArray(n)?n:[n],this.requestScope=null===r?new Map:null}return e.prototype.addChildRequest=function(t,r,n){var i=new e(t,this.parentContext,this,r,n);return this.childRequests.push(i),i},e}();function vn(e){return e._bindingDictionary}function yn(e,t,r,n,i){var o=_n(r.container,i.serviceIdentifier),a=[];return o.length===Yr.NoBindingsAvailable&&r.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(i.serviceIdentifier).toSelf(),o=_n(r.container,i.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new mn(e.serviceIdentifier,r,n,e,i);return e.constraint(t)})),function(e,t,r,n){switch(t.length){case Yr.NoBindingsAvailable:if(r.isOptional())return t;var i=Xr(e),o=Vr;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var r="",n=t.getNamedTag(),i=t.getCustomTags();return null!==n&&(r+=n.toString()+"\n"),null!==i&&i.forEach((function(e){r+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+r}return" "+e}(i,r),o+=Zr(n,i,_n),new Error(o);case Yr.OnlyOneBindingAvailable:return t;case Yr.MultipleBindingsAvailable:default:if(r.isArray())return t;i=Xr(e),o=Fr+" "+i;throw o+=Zr(n,i,_n),new Error(o)}}(i.serviceIdentifier,a,i,r.container),a}function bn(e,t,r,n,i,o){var a,s;if(null===i){a=yn(e,t,n,null,o),s=new mn(r,n,null,a,o);var l=new on(n,s);n.addPlan(l)}else a=yn(e,t,n,i,o),s=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(t){var r=null;if(o.isArray())r=s.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;r=s}if(t.type===Ir.Instance&&null!==t.implementationType){var i=function(e,t){return un(e,tn(t),t,!1)}(e,t.implementationType);if(!n.container.options.skipBaseClassChecks){var a=pn(e,t.implementationType);if(i.length<a){var l=zr(tn(t.implementationType));throw new Error(l)}}i.forEach((function(t){bn(e,!1,t.serviceIdentifier,n,r,t)}))}}))}function _n(e,t){var r=[],n=vn(e);return n.hasKey(t)?r=n.get(t):null!==e.parent&&(r=_n(e.parent,t)),r}function wn(e,t,r,n,i,o,a,s){void 0===s&&(s=!1);var l=new rn(t),c=function(e,t,r,n,i,o){var a=new nn(e?br:yr,r),s=new ln(t,n,r,a);if(void 0!==i){var l=new nn(i,o);s.metadata.push(l)}return s}(r,n,i,"",o,a);try{return bn(e,s,i,l,null,c),l}catch(e){throw Jr(e)&&en(l.plan.rootRequest),e}}function Cn(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function En(e){return!!Cn(e)||Array.isArray(e)&&e.some(Cn)}var Sn,kn,xn=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},On=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},In=function(e,t,r){e.has(t.id)||e.set(t.id,r)},Rn=function(e,t){e.cache=t,e.activated=!0,Cn(t)&&Tn(e,t)},Tn=function(e,t){return xn(void 0,void 0,void 0,(function(){var r,n;return On(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return r=i.sent(),e.cache=r,[3,3];case 2:throw n=i.sent(),e.cache=null,e.activated=!1,n;case 3:return[2]}}))}))};(kn=Sn||(Sn={})).DynamicValue="toDynamicValue",kn.Factory="toFactory",kn.Provider="toProvider";var An=globalThis&&globalThis.__assign||function(){return An=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},An.apply(this,arguments)},Mn=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Nn=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Dn=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};function Pn(e,t,r){var n;if(t.length>0){var i=function(e,t){return e.reduce((function(e,r){var n=t(r);return r.target.type===Rr.ConstructorArgument?e.constructorInjections.push(n):(e.propertyRequests.push(r),e.propertyInjections.push(n)),e.isAsync||(e.isAsync=En(n)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,r),o=An(An({},i),{constr:e});n=i.isAsync?function(e){return Mn(this,void 0,void 0,(function(){var t,r;return Nn(this,(function(n){switch(n.label){case 0:return[4,Fn(e.constructorInjections)];case 1:return t=n.sent(),[4,Fn(e.propertyInjections)];case 2:return r=n.sent(),[2,jn(An(An({},e),{constructorInjections:t,propertyInjections:r}))]}}))}))}(o):jn(o)}else n=new e;return n}function jn(e){var t,r=new((t=e.constr).bind.apply(t,Dn([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,n){var i=t.target.identifier,o=e.propertyInjections[n];(!t.target.isOptional()||void 0!==o)&&(r[i]=o)})),r}function Fn(e){return Mn(this,void 0,void 0,(function(){var t,r,n,i;return Nn(this,(function(o){for(t=[],r=0,n=e;r<n.length;r++)i=n[r],Array.isArray(i)?t.push(Promise.all(i)):t.push(i);return[2,Promise.all(t)]}))}))}function Vn(e,t){var r=function(e,t){var r,n;if(Reflect.hasMetadata(Sr,e)){var i=Reflect.getMetadata(Sr,e);try{return null===(n=(r=t)[i.value])||void 0===n?void 0:n.call(r)}catch(t){if(t instanceof Error)throw new Error(Hr(e.name,t.message))}}}(e,t);return Cn(r)?r.then((function(){return t})):t}function Ln(e,t){e.scope!==Or.Singleton&&function(e,t){var r="Class cannot be instantiated in "+(e.scope===Or.Request?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error(Gr(t.name,r));if(Reflect.hasMetadata(kr,t))throw new Error(Wr(t.name,r))}(e,t)}var $n=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Bn=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Un=function(e){return function(t){t.parentContext.setCurrentRequest(t);var r=t.bindings,n=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return n.map((function(t){return Un(e)(t)}));if(!t.target.isOptional()||0!==r.length){var a=r[0];return Gn(e,t,a)}}},zn=function(e,t){var r=function(e){switch(e.type){case Ir.Factory:return{factory:e.factory,factoryType:Sn.Factory};case Ir.Provider:return{factory:e.provider,factoryType:Sn.Provider};case Ir.DynamicValue:return{factory:e.dynamicValue,factoryType:Sn.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(e,t){try{return e()}catch(e){throw Jr(e)&&(e=t()),e}}((function(){return r.factory.bind(e)(t)}),(function(){return new Error(function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings with service identifier '"+t+"'."}(r.factoryType,t.currentRequest.serviceIdentifier.toString()))}))},Hn=function(e,t,r){var n,i=t.childRequests;switch(function(e){var t=null;switch(e.type){case Ir.ConstantValue:case Ir.Function:t=e.cache;break;case Ir.Constructor:case Ir.Instance:t=e.implementationType;break;case Ir.DynamicValue:t=e.dynamicValue;break;case Ir.Provider:t=e.provider;break;case Ir.Factory:t=e.factory}if(null===t){var r=Xr(e.serviceIdentifier);throw new Error("Invalid binding type: "+r)}}(r),r.type){case Ir.ConstantValue:case Ir.Function:n=r.cache;break;case Ir.Constructor:n=r.implementationType;break;case Ir.Instance:n=function(e,t,r,n){Ln(e,t);var i=Pn(t,r,n);return Cn(i)?i.then((function(e){return Vn(t,e)})):Vn(t,i)}(r,r.implementationType,i,Un(e));break;default:n=zn(r,t.parentContext)}return n},Wn=function(e,t,r){var n=function(e,t){return t.scope===Or.Singleton&&t.activated?t.cache:t.scope===Or.Request&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==n||function(e,t,r){t.scope===Or.Singleton&&Rn(t,r),t.scope===Or.Request&&In(e,t,r)}(e,t,n=r()),n},Gn=function(e,t,r){return Wn(e,r,(function(){var n=Hn(e,t,r);return n=Cn(n)?n.then((function(e){return Kn(t,r,e)})):Kn(t,r,n)}))};function Kn(e,t,r){var n,i=qn(e.parentContext,t,r),o=Zn(e.parentContext.container),a=o.next();do{n=a.value;var s=e.parentContext,l=e.serviceIdentifier,c=Xn(n,l);i=Cn(i)?Jn(c,s,i):Yn(c,s,i),a=o.next()}while(!0!==a.done&&!vn(n).hasKey(e.serviceIdentifier));return i}var qn=function(e,t,r){return"function"==typeof t.onActivation?t.onActivation(e,r):r},Yn=function(e,t,r){for(var n=e.next();!n.done;){if(Cn(r=n.value(t,r)))return Jn(e,t,r);n=e.next()}return r},Jn=function(e,t,r){return $n(void 0,void 0,void 0,(function(){var n,i;return Bn(this,(function(o){switch(o.label){case 0:return[4,r];case 1:n=o.sent(),i=e.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(t,n)];case 3:return n=o.sent(),i=e.next(),[3,2];case 4:return[2,n]}}))}))},Xn=function(e,t){var r=e._activations;return r.hasKey(t)?r.get(t).values():[].values()},Zn=function(e){for(var t=[e],r=e.parent;null!==r;)t.push(r),r=r.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var Qn=function(e,t){var r=e.parentRequest;return null!==r&&(!!t(r)||Qn(r,t))},ei=function(e){return function(t){var r=function(r){return null!==r&&null!==r.target&&r.target.matchesTag(e)(t)};return r.metaData=new nn(e,t),r}},ti=ei(pr),ri=function(e){return function(t){var r=null;if(null!==t){if(r=t.bindings[0],"string"==typeof e)return r.serviceIdentifier===e;var n=t.bindings[0].implementationType;return e===n}return!1}},ni=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new ii(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=ti(e),new ii(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new ii(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=ei(e)(t),new ii(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&ri(e)(t.parentRequest)},new ii(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&ti(e)(t.parentRequest)},new ii(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(r){return null!==r&&ei(e)(t)(r.parentRequest)},new ii(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&Qn(t,ri(e))},new ii(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!Qn(t,ri(e))},new ii(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Qn(t,ti(e))},new ii(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!Qn(t,ti(e))},new ii(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(r){return null!==r&&Qn(r,ei(e)(t))},new ii(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(r){return null!==r&&!Qn(r,ei(e)(t))},new ii(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&Qn(t,e)},new ii(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!Qn(t,e)},new ii(this._binding)},e}(),ii=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ni(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ni(this._binding)},e}(),oi=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ni(this._binding),this._bindingOnSyntax=new ii(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),ai=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=Or.Request,new oi(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=Or.Transient,new oi(this._binding)},e}(),si=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ni(this._binding),this._bindingOnSyntax=new ii(this._binding),this._bindingInSyntax=new ai(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),li=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=Ir.Instance,this._binding.implementationType=e,new si(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=Ir.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=Ir.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new si(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=Ir.Constructor,this._binding.implementationType=e,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=Ir.Factory,this._binding.factory=e,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error("Value provided to function binding must be a function!");var t=this.toConstantValue(e);return this._binding.type=Ir.Function,this._binding.scope=Or.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=Ir.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=Ir.Factory,this._binding.factory=function(t){return function(r){return t.container.getNamed(e,r)}},new oi(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=Ir.Provider,this._binding.provider=e,this._binding.scope=Or.Singleton,new oi(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),ci=function(){function e(){}return e.of=function(t,r,n,i,o){var a=new e;return a.bindings=t,a.middleware=r,a.deactivations=i,a.activations=n,a.moduleActivationStore=o,a},e}();var ui=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(Pr);if(null==t)throw new Error(Pr);var r=this._map.get(e);void 0!==r?r.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(Pr);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(jr)},e.prototype.remove=function(e){if(null==e)throw new Error(Pr);if(!this._map.delete(e))throw new Error(jr)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(r,n){var i=e.hasKey(r)?e.get(r):void 0;if(void 0!==i){var o=n.filter((function(e){return!i.some((function(t){return e===t}))}));t._setValue(r,o)}}))},e.prototype.removeByCondition=function(e){var t=this,r=[];return this._map.forEach((function(n,i){for(var o=[],a=0,s=n;a<s.length;a++){var l=s[a];e(l)?r.push(l):o.push(l)}t._setValue(i,o)})),r},e.prototype.hasKey=function(e){if(null==e)throw new Error(Pr);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,r){e.forEach((function(e){return t.add(r,function(e){return"object"==typeof e&&null!==e&&"clone"in e&&"function"==typeof e.clone}(e)?e.clone():e)}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,r){e(r,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),di=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,r){this._getModuleActivationHandlers(e).onDeactivations.add(t,r)},e.prototype.addActivation=function(e,t,r){this._getModuleActivationHandlers(e).onActivations.add(t,r)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,r){t._map.set(r,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new ui,onDeactivations:new ui}},e}(),fi=globalThis&&globalThis.__assign||function(){return fi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fi.apply(this,arguments)},hi=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},pi=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},gi=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},mi=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===t.defaultScope)t.defaultScope=Or.Transient;else if(t.defaultScope!==Or.Singleton&&t.defaultScope!==Or.Transient&&t.defaultScope!==Or.Request)throw new Error('Invalid Container option. Default scope must be a string ("singleton" or "transient").');if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Ar(),this._bindingDictionary=new ui,this._snapshots=[],this._middleware=null,this._activations=new ui,this._deactivations=new ui,this.parent=null,this._metadataReader=new qr,this._moduleActivationStore=new di}return e.merge=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new e,a=gi([t,r],n,!0).map((function(e){return vn(e)})),s=vn(o);return a.forEach((function(e){!function(e,t){e.traverse((function(e,r){r.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}(e,s)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._getContainerModuleHelpersFactory(),n=0,i=e;n<i.length;n++){var o=i[n],a=r(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return hi(this,void 0,void 0,(function(){var t,r,n,i,o;return pi(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),r=0,n=e,a.label=1;case 1:return r<n.length?(i=n[r],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){var r=e._removeModuleBindings(t.id);e._deactivateSingletons(r),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return hi(this,void 0,void 0,(function(){var t,r,n,i;return pi(this,(function(o){switch(o.label){case 0:t=0,r=e,o.label=1;case 1:return t<r.length?(n=r[t],i=this._removeModuleBindings(n.id),[4,this._deactivateSingletonsAsync(i)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(n.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||Or.Transient,r=new Mr(e,t);return this._bindingDictionary.add(e,r),new li(r)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return hi(this,void 0,void 0,(function(){return pi(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return hi(this,void 0,void 0,(function(){var t;return pi(this,(function(r){switch(r.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,r){e._deactivateSingletons(r)})),this._bindingDictionary=new ui},e.prototype.unbindAllAsync=function(){return hi(this,void 0,void 0,(function(){var e,t=this;return pi(this,(function(r){switch(r.label){case 0:return e=[],this._bindingDictionary.traverse((function(r,n){e.push(t._deactivateSingletonsAsync(n))})),[4,Promise.all(e)];case 1:return r.sent(),this._bindingDictionary=new ui,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,pr,t)},e.prototype.isBoundTagged=function(e,t,r){var n=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=function(e,t,r,n){var i=new ln(Rr.Variable,"",t,new nn(r,n)),o=new rn(e);return new mn(t,o,null,[],i)}(this,e,t,r);n=i.some((function(e){return e.constraint(o)}))}return!n&&this.parent&&(n=this.parent.isBoundTagged(e,t,r)),n},e.prototype.snapshot=function(){this._snapshots.push(ci.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var r=new e(t||this.options);return r.parent=this,r},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),r)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return hi(this,void 0,void 0,(function(){var t;return pi(this,(function(r){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,r){var n=this._getNotAllArgs(e,!1,t,r);return this._getButThrowIfAsync(n)},e.prototype.getTaggedAsync=function(e,t,r){return hi(this,void 0,void 0,(function(){var n;return pi(this,(function(i){return n=this._getNotAllArgs(e,!1,t,r),[2,this._get(n)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,pr,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,pr,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,r){var n=this._getNotAllArgs(e,!0,t,r);return this._getButThrowIfAsync(n)},e.prototype.getAllTaggedAsync=function(e,t,r){var n=this._getNotAllArgs(e,!0,t,r);return this._getAll(n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,pr,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,pr,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var r=this.get(e);return t||this.unbind(e),r},e.prototype._preDestroy=function(e,t){var r,n;if(Reflect.hasMetadata(kr,e))return null===(n=(r=t)[Reflect.getMetadata(kr,e).value])||void 0===n?void 0:n.call(r)},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var r=this,n=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var i=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(Cn(i))return this._handleDeactivationError(i.then((function(){return r._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,n)})),n)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,n);if(Cn(o))return this._handleDeactivationError(o,n)}catch(e){if(e instanceof Error)throw new Error(Gr(n.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return hi(this,void 0,void 0,(function(){var r;return pi(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return n.sent(),[3,3];case 2:if((r=n.sent())instanceof Error)throw new Error(Gr(t.name,r.message));return[3,3];case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var r=this,n=t.next();n.value;){var i=n.value(e);if(Cn(i))return i.then((function(){return r._deactivateContainerAsync(e,t)}));n=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return hi(this,void 0,void 0,(function(){var r;return pi(this,(function(n){switch(n.label){case 0:r=t.next(),n.label=1;case 1:return r.value?[4,r.value(e)]:[3,3];case 2:return n.sent(),r=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},r=function(r){return function(n){var i=e.bind(n);return t(i,r),i}},n=function(r){return function(n){var i=e.rebind(n);return t(i,r),i}},i=function(t){return function(r,n){e._moduleActivationStore.addActivation(t,r,n),e.onActivation(r,n)}},o=function(t){return function(r,n){e._moduleActivationStore.addDeactivation(t,r,n),e.onDeactivation(r,n)}};return function(t){return{bindFunction:r(t),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:i(t),onDeactivationFunction:o(t),rebindFunction:n(t),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}}}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=fi(fi({},e),{contextInterceptor:function(e){return e},targetType:Rr.Variable});if(this._middleware){var r=this._middleware(t);if(null==r)throw new Error("Invalid return type in middleware. Middleware must return!");return r}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(En(t))throw new Error(function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."}(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,r,n){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:r,value:n}},e.prototype._planAndResolve=function(){var e=this;return function(t){var r=wn(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints),n=function(e){return Un(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(r=t.contextInterceptor(r));return n}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return Cn(e.cache)?e.cache.then((function(r){return t._deactivate(e,r)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];if(Cn(this._deactivateIfSingleton(n)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}},e.prototype._deactivateSingletonsAsync=function(e){return hi(this,void 0,void 0,(function(){var t=this;return pi(this,(function(r){switch(r.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return r.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,r){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,r)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,r){return hi(this,void 0,void 0,(function(){return pi(this,(function(n){switch(n.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,r)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error("Could not unbind serviceIdentifier: "+Xr(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,r){var n=this;if("function"==typeof e.onDeactivation){var i=e.onDeactivation(t);if(Cn(i))return i.then((function(){return n._preDestroy(r,t)}))}return this._preDestroy(r,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,r){return hi(this,void 0,void 0,(function(){return pi(this,(function(n){switch(n.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:n.sent(),n.label=2;case 2:return[4,this._preDestroy(r,t)];case 3:return n.sent(),[2]}}))}))},e}(),vi=function(e){this.id=Ar(),this.registry=e};function yi(e,t,r,n){(function(e){if(void 0!==e)throw new Error(Ur)})(t),_i(_r,e,r.toString(),n)}function bi(e){var t=[];if(Array.isArray(e)){var r=function(e){for(var t=new Set,r=0,n=e;r<n.length;r++){var i=n[r];if(t.has(i))return i;t.add(i)}}((t=e).map((function(e){return e.key})));if(void 0!==r)throw new Error(Dr+" "+r.toString())}else t=[e];return t}function _i(e,t,r,n){var i=bi(n),o={};Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var a=o[r];if(void 0===a)a=[];else for(var s=function(e){if(i.some((function(t){return t.key===e.key})))throw new Error(Dr+" "+e.key.toString())},l=0,c=a;l<c.length;l++){s(c[l])}a.push.apply(a,i),o[r]=a,Reflect.defineMetadata(e,o,t)}function wi(e){return function(t,r,n){"number"==typeof n?yi(t,r,n,e):function(e,t,r){if(function(e){return void 0!==e.prototype}(e))throw new Error(Ur);_i(wr,e.constructor,t,r)}(t,r,e)}}function Ci(e,t){Reflect.decorate(e,t)}function Ei(e,t){return function(r,n){t(r,n,e)}}function Si(e,t,r){"number"==typeof r?Ci([Ei(r,e)],t):"string"==typeof r?Reflect.decorate([e],t,r):Ci([e],t)}var ki=function(e){return function(t){return function(r,n,i){if(void 0===t){var o="function"==typeof r?r.name:r.constructor.name;throw new Error(function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."}(o))}return wi(new nn(e,t))(r,n,i)}}}(yr);function xi(e,t){return function(){return function(r,n){var i=new nn(e,n);if(Reflect.hasOwnMetadata(e,r.constructor))throw new Error(t);Reflect.defineMetadata(e,i,r.constructor)}}}var Oi=xi(Sr,"Cannot apply @postConstruct decorator multiple times in the same class"),Ii=xi(kr,"Cannot apply @preDestroy decorator multiple times in the same class"),Ri=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof hr<"u"?hr:typeof self<"u"?self:{};function Ti(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ai,Mi,Ni={exports:{}},Di=Ni.exports={};function Pi(){throw new Error("setTimeout has not been defined")}function ji(){throw new Error("clearTimeout has not been defined")}function Fi(e){if(Ai===setTimeout)return setTimeout(e,0);if((Ai===Pi||!Ai)&&setTimeout)return Ai=setTimeout,setTimeout(e,0);try{return Ai(e,0)}catch{try{return Ai.call(null,e,0)}catch{return Ai.call(this,e,0)}}}!function(){try{Ai="function"==typeof setTimeout?setTimeout:Pi}catch{Ai=Pi}try{Mi="function"==typeof clearTimeout?clearTimeout:ji}catch{Mi=ji}}();var Vi,Li,$i,Bi,Ui=[],zi=!1,Hi=-1;function Wi(){!zi||!Vi||(zi=!1,Vi.length?Ui=Vi.concat(Ui):Hi=-1,Ui.length&&Gi())}function Gi(){if(!zi){var e=Fi(Wi);zi=!0;for(var t=Ui.length;t;){for(Vi=Ui,Ui=[];++Hi<t;)Vi&&Vi[Hi].run();Hi=-1,t=Ui.length}Vi=null,zi=!1,function(e){if(Mi===clearTimeout)return clearTimeout(e);if((Mi===ji||!Mi)&&clearTimeout)return Mi=clearTimeout,clearTimeout(e);try{return Mi(e)}catch{try{return Mi.call(null,e)}catch{return Mi.call(this,e)}}}(e)}}function Ki(e,t){this.fun=e,this.array=t}function qi(){}Di.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Ui.push(new Ki(e,t)),1===Ui.length&&!zi&&Fi(Gi)},Ki.prototype.run=function(){this.fun.apply(null,this.array)},Di.title="browser",Di.browser=!0,Di.env={},Di.argv=[],Di.version="",Di.versions={},Di.on=qi,Di.addListener=qi,Di.once=qi,Di.off=qi,Di.removeListener=qi,Di.removeAllListeners=qi,Di.emit=qi,Di.prependListener=qi,Di.prependOnceListener=qi,Di.listeners=function(e){return[]},Di.binding=function(e){throw new Error("process.binding is not supported")},Di.cwd=function(){return"/"},Di.chdir=function(e){throw new Error("process.chdir is not supported")},Di.umask=function(){return 0},function(e){!function(t){var r="object"==typeof Ri?Ri:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(e);function i(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}typeof r.Reflect>"u"?r.Reflect=e:n=i(r.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",i=r&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,l={create:o?function(){return ne(Object.create(null))}:a?function(){return ne({__proto__:null})}:function(){return ne({})},has:s?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:s?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof Ni.exports&&Ni.exports.env&&"true"===Ni.exports.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,f=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,h=new(u||"function"!=typeof WeakMap?re():WeakMap);function p(e,t,r,n){if(P(r)){if(!H(e))throw new TypeError;if(!G(t))throw new TypeError;return S(e,t)}if(!H(e))throw new TypeError;if(!V(t))throw new TypeError;if(!V(n)&&!P(n)&&!j(n))throw new TypeError;return j(n)&&(n=void 0),k(e,t,r=z(r),n)}function g(e,t){function r(r,n){if(!V(r))throw new TypeError;if(!P(n)&&!K(n))throw new TypeError;A(e,t,r,n)}return r}function m(e,t,r,n){if(!V(r))throw new TypeError;return P(n)||(n=z(n)),A(e,t,r,n)}function v(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),O(e,t,r)}function y(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),I(e,t,r)}function b(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),R(e,t,r)}function _(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),T(e,t,r)}function w(e,t){if(!V(e))throw new TypeError;return P(t)||(t=z(t)),M(e,t)}function C(e,t){if(!V(e))throw new TypeError;return P(t)||(t=z(t)),N(e,t)}function E(e,t,r){if(!V(t))throw new TypeError;P(r)||(r=z(r));var n=x(t,r,!1);if(P(n)||!n.delete(e))return!1;if(n.size>0)return!0;var i=h.get(t);return i.delete(r),i.size>0||h.delete(t),!0}function S(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!P(n)&&!j(n)){if(!G(n))throw new TypeError;t=n}}return t}function k(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!P(o)&&!j(o)){if(!V(o))throw new TypeError;n=o}}return n}function x(e,t,r){var n=h.get(e);if(P(n)){if(!r)return;n=new d,h.set(e,n)}var i=n.get(t);if(P(i)){if(!r)return;i=new d,n.set(t,i)}return i}function O(e,t,r){if(I(e,t,r))return!0;var n=Q(t);return!j(n)&&O(e,n,r)}function I(e,t,r){var n=x(t,r,!1);return!P(n)&&B(n.has(e))}function R(e,t,r){if(I(e,t,r))return T(e,t,r);var n=Q(t);return j(n)?void 0:R(e,n,r)}function T(e,t,r){var n=x(t,r,!1);if(!P(n))return n.get(e)}function A(e,t,r,n){x(r,n,!0).set(e,t)}function M(e,t){var r=N(e,t),n=Q(e);if(null===n)return r;var i=M(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new f,a=[],s=0,l=r;s<l.length;s++){var c=l[s];o.has(c)||(o.add(c),a.push(c))}for(var u=0,d=i;u<d.length;u++){c=d[u];o.has(c)||(o.add(c),a.push(c))}return a}function N(e,t){var r=[],n=x(e,t,!1);if(P(n))return r;for(var i=Y(n.keys()),o=0;;){var a=X(i);if(!a)return r.length=o,r;var s=J(a);try{r[o]=s}catch(e){try{Z(i)}finally{throw e}}o++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function P(e){return void 0===e}function j(e){return null===e}function F(e){return"symbol"==typeof e}function V(e){return"object"==typeof e?null!==e:"function"==typeof e}function L(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=q(e,n);if(void 0!==i){var o=i.call(e,r);if(V(o))throw new TypeError;return o}return $(e,"default"===r?"number":r)}function $(e,t){if("string"===t){var r=e.toString;if(W(r))if(!V(i=r.call(e)))return i;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i}else{var n;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i;var i,o=e.toString;if(W(o))if(!V(i=o.call(e)))return i}throw new TypeError}function B(e){return!!e}function U(e){return""+e}function z(e){var t=L(e,3);return F(t)?t:U(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function G(e){return"function"==typeof e}function K(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function q(e,t){var r=e[t];if(null!=r){if(!W(r))throw new TypeError;return r}}function Y(e){var t=q(e,i);if(!W(t))throw new TypeError;var r=t.call(e);if(!V(r))throw new TypeError;return r}function J(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c||t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=l.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(l.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:l.create()})}return e[n]}function a(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(e)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];(4===n||6===n||8===n)&&(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",m),e("hasMetadata",v),e("hasOwnMetadata",y),e("getMetadata",b),e("getOwnMetadata",_),e("getMetadataKeys",w),e("getOwnMetadataKeys",C),e("deleteMetadata",E)}(n)}()}(Li||(Li={})),(e=>{e.defineToken=(t,r={multiple:!0,global:!1})=>new e.DefinedToken(t,r);var t;e.DefinedToken=class{constructor(e,t={}){this.prototype={};const{multiple:r=!1,global:n}=t;this.name=e,this.symbol=n?Symbol.for(this.name):Symbol(this.name),this.multiple=r}},e.isModule=function(e){return!!e&&"object"==typeof e&&"id"in e},(t=e.Lifecycle||(e.Lifecycle={})).singleton="singleton",t.transient="transient",e.ClassOptionSymbol=Symbol.for("SyringeClassOption"),e.DefaultOption={lifecycle:"transient"}})($i||($i={})),(e=>{e.toArray=function(e){return Array.isArray(e)?e:void 0===e?[]:[e]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"==typeof e&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!=typeof e||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"==typeof e&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}})(Bi||(Bi={}));const Yi=null;function Ji(e,t){return t.lifecycle===$i.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function Xi(e,t){e.whenTargetNamed(eo(t))}function Zi(e,t){return t.bind(to(e))}function Qi(e,t){if(t.isBound(to(e)))try{return t.rebind(to(e))}catch{return t.bind(to(e))}return t.bind(to(e))}function eo(e){return Bi.isDefinedToken(e)?e.symbol:e}function to(e){return Bi.isDefinedToken(e)?e.symbol:e}const ro=new mi;function no(e={}){const t=function(e){if(Reflect.hasOwnMetadata(Cr,e))throw new Error(Nr);var t=Reflect.getMetadata(Er,e)||[];return Reflect.defineMetadata(Cr,t,e),e};return r=>{Reflect.defineMetadata($i.ClassOptionSymbol,{...e,target:r},r),t(r)}}function io(e={}){return(t,...r)=>(no({...e,lifecycle:$i.Lifecycle.singleton})(t,...r),t)}function oo(e={}){return(t,...r)=>(no({...e,lifecycle:$i.Lifecycle.transient})(t,...r),t)}function ao(e){return ki(e instanceof an?e:to(e))}function so(e){return function(e){return wi(new nn(pr,e))}(eo(e))}const lo=Symbol.for("SyringeSideOption"),co=(e,t)=>{Reflect.defineMetadata(lo,e,t)};const uo=class{static resolveTarget(e,t,r={}){try{try{const r=Reflect.getMetadata(lo,t);r&&uo.resolveOption(e,r)}catch{}if(Bi.isClass(t))if(r.useClass){const e=Bi.toArray(r.useClass);e.unshift(t),r.useClass=e}else r.useClass=[t];let n;try{n=Reflect.getMetadata($i.ClassOptionSymbol,t)}catch{}if(n={...n||{},...r},n.token){const e=Bi.toArray(n.token);e.unshift(t),n.token=e}else n.token=[t];uo.resolveOption(e,n)}catch{}}static resolveOption(e,t){const r=function(e){const t=Bi.toArray(e.token),r=Bi.toArray(e.useClass),n=Bi.toArray(e.useDynamic),i=Bi.toArray(e.useFactory),o=Bi.toArray(e.contrib),a=e.lifecycle||$i.Lifecycle.transient,s={token:t,useClass:r,lifecycle:o.length>0?$i.Lifecycle.singleton:a,contrib:o,useDynamic:n,useFactory:i};return"useValue"in e&&(s.useValue=e.useValue),s}({...uo.globalConfig,...t});0===r.useClass.length&&0===r.useDynamic.length&&0===r.useFactory.length&&!("useValue"in r)||r.token.forEach((t=>{new uo(e,t,{...r}).resolve()}))}constructor(e,t,r){this.register=e,this.token=t,this.option=r,this.rawToken=Bi.isNamedToken(t)?t.token:t,this.named=Bi.isNamedToken(t)?t.named:void 0,this.mutiple=!!this.named||Bi.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}resolve(){const{register:e}=this;!function(e){return e&&"object"==typeof e&&"bind"in e&&"unbind"in e&&"rebind"in e&&"isBound"in e}(e)||(this.mutiple?this.resolveMutilple(e):(this.resolveMono(e),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((t=>{Bi.isMultipleEnabled(t)?Zi(t,e).toService(this.generalToken):Qi(t,e).toService(this.generalToken)}))))}resolveMono(e){if("useValue"in this.option)return Qi(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){const t=this.option.useDynamic[this.option.useDynamic.length-1];return Ji(Qi(this.generalToken,e).toDynamicValue((e=>{const r=yh.getContainer(e.container);return t({container:r})})),this.option)}if(this.option.useFactory.length>0){const t=this.option.useFactory[this.option.useFactory.length-1];return Qi(this.generalToken,e).toFactory((e=>{const r=yh.getContainer(e.container);return t({container:r})}))}if(this.option.useClass.length>0){const t=this.option.useClass[this.option.useClass.length-1];return Ji(Qi(this.generalToken,e).to(t),this.option)}}resolveMutilple(e){const t=this.option.useClass.map((t=>Ji(Zi(this.generalToken,e).to(t),this.option))),r=this.option.useDynamic.map((t=>Ji(Zi(this.generalToken,e).toDynamicValue((e=>{const r=yh.getContainer(e.container);return t({container:r})})),this.option))),n=this.option.useFactory.map((t=>Zi(this.generalToken,e).toFactory((e=>{const r=yh.getContainer(e.container);return t({container:r})})))),i="useValue"in this.option?Zi(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(t.forEach((e=>this.named&&Xi(e,this.named))),r.forEach((e=>this.named&&Xi(e,this.named))),n.forEach((e=>this.named&&Xi(e,this.named))),i&&Xi(i,this.named))}};let fo=uo;fo.globalConfig=$i.DefaultOption;const ho=$i.defineToken("SyringeContributionProvider",{global:!0}),po=null;var go,mo,vo;(e=>{function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"==typeof e&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NONE=t((()=>{}))})(go||(go={})),(e=>{e.is=function(e){return!!e&&"object"==typeof e&&"disposed"in e&&"boolean"==typeof e.disposed}})(mo||(mo={})),(e=>{e.None=()=>go.NONE,e.map=function(e,t){return(r,n)=>e((e=>r.call(n,t(e))),void 0)}})(vo||(vo={}));class yo{constructor(e=!1){this.mono=!1,this.mono=e}get length(){return this._callbacks&&this._callbacks.length||0}add(e,t=void 0){this._callbacks||(this._callbacks=[]),this._callbacks.push([e,t])}remove(e,t=void 0){if(!this._callbacks)return;let r=!1;for(let n=0;n<this._callbacks.length;n+=1)if(this._callbacks[n][0]===e){if(this._callbacks[n][1]===t)return void this._callbacks.splice(n,1);r=!0}if(r)throw new Error("You should remove it with the same context you add it")}[Symbol.iterator](){return this._callbacks?this._callbacks.slice(0).map((e=>(...t)=>e[0].apply(e[1],t)))[Symbol.iterator]():[][Symbol.iterator]()}invoke(...e){const t=[];for(const r of this)try{t.push(r(...e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0}}const bo=class{constructor(e){this._disposed=!1,this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new yo),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const n={dispose:()=>{n.dispose=bo._noop,this._disposed||(this._callbacks.remove(e,t),n.dispose=bo._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(n),n}),this._event}fire(e){this._callbacks&&this._callbacks.invoke(e)}async sequence(e){if(this._callbacks)for(const t of this._callbacks)if(!await e(t))break}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this._disposed=!0}};let _o=bo;_o._noop=()=>{};class wo{constructor(...e){this.disposables=[],this.onDisposeEmitter=new _o,this.disposingElements=!1,e.forEach((e=>this.push(e)))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return 0===this.disposables.length}dispose(){if(!this.disposed&&!this.disposingElements){for(this.disposingElements=!0;!this.disposed;)try{this.disposables.pop().dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}}push(e){const{disposables:t}=this;t.push(e);const r=e.dispose.bind(e),n=go.create((()=>{const r=t.indexOf(e);-1!==r&&t.splice(r,1),this.checkDisposed()}));return e.dispose=()=>{n.dispose(),r()},n}pushAll(e){return e.map((e=>this.push(e)))}}class Co{constructor(e,t,r){this.onChangedEmitter=new _o,this.option={recursive:!1,cache:!0},this.toDispose=new wo,this.onCtxChanged=()=>{this.services=void 0,this.onChangedEmitter.fire()},this.container=t,this.serviceIdentifier=e,r&&(this.option={...this.option,...r}),this.toDispose.push(this.onChangedEmitter),this.toDispose.push(this.container.onModuleChanged(this.onCtxChanged)),this.toDispose.push(this.container.onRegistered(this.onCtxChanged))}get onChanged(){return this.onChangedEmitter.event}dispose(){this.toDispose.dispose(),this.disposed=!0}getServices(e){const t=[];let r=this.container;for(;r;){if(r.isBound(this.serviceIdentifier)){const e=r.getAll(this.serviceIdentifier);t.push(...e)}r=e?r.parent:void 0}return t}getContributions(e={}){const{cache:t,recursive:r=!0}={...this.option,...e};return(!t||void 0===this.services)&&(this.services=this.getServices(!!r)),this.services}}function Eo(e,t,r){e({token:{token:ho,named:t},useDynamic:e=>new Co(t,e.container,r),lifecycle:$i.Lifecycle.singleton})}class So{constructor(e){this.inversifyRegister=(e,t,r,n)=>{const i={bind:e,unbind:t,isBound:r,rebind:n},o=(e,t={})=>{Bi.isInjectOption(e)?fo.resolveOption(i,e):fo.resolveTarget(i,e,t)};this.baseRegistry&&this.baseRegistry(o),this.optionCollection&&this.optionCollection.forEach((e=>o(e)))},this.baseRegistry=e,this.inversifyModule=new vi(this.inversifyRegister),this.id=this.inversifyModule.id}get options(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}register(...e){return e.forEach((e=>this.options.push(e))),this}contribution(...e){return e.forEach((e=>this.options.push(function(e,t){return{token:{token:ho,named:e},useDynamic:r=>new Co(e,r.container,t),lifecycle:$i.Lifecycle.singleton}}(e)))),this}}function ko(e){return e&&"inversifyModule"in e}function xo(e){return new So(e)}const Oo=e=>setTimeout((()=>{e()}),16.666666666666668),Io="abcdefghigklmnopqrstuvwxyz",Ro=Io+"0123456789"+Io.toUpperCase();function To(e){if((e=e||6)<2)throw new RangeError("n 不能小于 2");let t="";for(let r=0;r<e;r++)t+=Ro.charAt(Math.floor(Math.random()*Ro.length));return t}const Ao={}.toString,Mo=(e,t)=>Ao.call(e)==="[object "+t+"]";function No(e){return"function"==typeof e}const Do=function(e){return Mo(e,"RegExp")},Po=function(e){return Mo(e,"Number")},jo=function(e){return Mo(e,"String")},Fo=function(e){return Mo(e,"Object")},Vo=function(e){return e instanceof Date},Lo=function(e){return null==e},$o=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then};var Bo,Uo,zo={exports:{}};function Ho(){if(Uo)return Bo;Uo=1;var e=1e3,t=60*e,r=60*t,n=24*r,i=7*n,o=365.25*n;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}return Bo=function(s,l){l=l||{};var c=typeof s;if("string"===c&&s.length>0)return function(a){if(a=String(a),!(a.length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(s){var l=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*o;case"weeks":case"week":case"w":return l*i;case"days":case"day":case"d":return l*n;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*t;case"seconds":case"second":case"secs":case"sec":case"s":return l*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}(s);if("number"===c&&isFinite(s))return l.long?function(i){var o=Math.abs(i);return o>=n?a(i,o,n,"day"):o>=r?a(i,o,r,"hour"):o>=t?a(i,o,t,"minute"):o>=e?a(i,o,e,"second"):i+" ms"}(s):function(i){var o=Math.abs(i);return o>=n?Math.round(i/n)+"d":o>=r?Math.round(i/r)+"h":o>=t?Math.round(i/t)+"m":o>=e?Math.round(i/e)+"s":i+"ms"}(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))}}var Wo=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,r){const n=t(this.namespace+(typeof r>"u"?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)!n[r]||("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=Ho(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t};!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch{}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch{}return!e&&typeof Ni.exports<"u"&&"env"in Ni.exports&&(e=Ni.exports.env.DEBUG),e},t.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch{}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Wo(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(zo,zo.exports);const Go=zo.exports,Ko="lakex-table",qo=(e,t)=>Ko+":"+e+":"+t,Yo=e=>{const t=localStorage.debug;return"*"===t||t===`${Ko}:*`||t===`${Ko}:${e}:*`};class Jo{static enable(e,t){const r=qo(e,t);Yo(e)||Go.enable(r)}static Infra(e){const t=qo("infra",e);return Go(t)}static Framework(e){return Go(qo("framework",e))}static App(e){return Go(qo("app",e))}static Plugin(e){return Go(qo("plugin",e))}static isInfraDebug(){return Yo("infra")}static isFrameworkDebug(){return Yo("framework")}static isAppDebug(){return Yo("app")}static isPluginDebug(){return Yo("plugin")}}const Xo=Jo.Infra("performanceLog");function Zo(e=200){return(t,r,n)=>{void 0===n&&(n=Object.getOwnPropertyDescriptor(t,r));const i=n.value;return n.value=function(...t){const n=t.map((e=>JSON.stringify(e))).join(","),o=+new Date,a=t=>{const i=+new Date,a=parseFloat((i-o).toFixed(2)),s=JSON.stringify(t),l="Call ["+a+"ms]: "+r+"("+n+") => "+s;return a>e&&console.error(`需要优化函数 ${r} 性能`),Xo(l),t},s=i.apply(this,t);return $o(s)?s.then(a):a(s)},n}}const Qo=Lo(navigator)?"":navigator.userAgent,ea=!Lo(window)&&window.h5,ta=typeof er.exports<"u"&&"string"==typeof er.exports.platform&&"number"==typeof er.exports.pid?er.exports:null,ra=/edge/i.test(Qo),na=!ra&&/chrome/i.test(Qo),ia=/firefox/i.test(Qo),oa=!ra&&!na&&/safari/i.test(Qo),aa=/dingtalk/i.test(Qo),sa=/mobile/i.test(Qo),la=/os [\.\_\d]+ like mac os/i.test(Qo),ca=/android/i.test(Qo),ua=ta?"darwin"===ta.platform:!la&&/mac os x/i.test(Qo),da=ta?"win32"===ta.platform:/windows\s*(?:nt)?\s*[\.\_\d]+/i.test(Qo);var fa,ha;(e=>{e.isAndroid=ca,e.isIOS=la,e.isMac=ua,e.isWin=da,e.isMobile=ea||sa})(fa||(fa={})),(e=>{e.isChrome=na,e.isEdge=ra,e.isFirefox=ia,e.isSafari=oa,e.isDingtalk=aa})(ha||(ha={}));class pa{static onBeforeUnLoad(e){return window.addEventListener("beforeunload",e),{destroy(){window.removeEventListener("beforeunload",e)}}}}const ga=class{constructor(e){this.element=e,this.next=ga.Undefined,this.prev=ga.Undefined}};let ma=ga;ma.Undefined=new ga(void 0);class va{constructor(){this._first=ma.Undefined,this._last=ma.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===ma.Undefined}clear(){let e=this._first;for(;e!==ma.Undefined;){const t=e.next;e.prev=ma.Undefined,e.next=ma.Undefined,e=t}this._first=ma.Undefined,this._last=ma.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const r=new ma(e);if(this._first===ma.Undefined)this._first=r,this._last=r;else if(t){const e=this._last;this._last=r,r.prev=e,e.next=r}else{const e=this._first;this._first=r,r.next=e,e.prev=r}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(r))}}shift(){if(this._first===ma.Undefined)return;const e=this._first.element;return this._remove(this._first),e}pop(){if(this._last===ma.Undefined)return;const e=this._last.element;return this._remove(this._last),e}_remove(e){if(e.prev!==ma.Undefined&&e.next!==ma.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===ma.Undefined&&e.next===ma.Undefined?(this._first=ma.Undefined,this._last=ma.Undefined):e.next===ma.Undefined?(this._last=this._last.prev,this._last.next=ma.Undefined):e.prev===ma.Undefined&&(this._first=this._first.next,this._first.prev=ma.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==ma.Undefined;)yield e.element,e=e.next}}class ya{constructor(e){this._maxSize=e,this.cache=new Map}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}return null}put(e,t){if(this.cache.size>=this._maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}}const ba=typeof hr<"u"?hr:typeof self<"u"?self:typeof window<"u"?window:{};const _a="object"==typeof ba&&ba&&ba.Object===Object&&ba;var wa="object"==typeof self&&self&&self.Object===Object&&self;const Ca=_a||wa||Function("return this")();const Ea=Ca.Symbol;var Sa=Object.prototype,ka=Sa.hasOwnProperty,xa=Sa.toString,Oa=Ea?Ea.toStringTag:void 0;var Ia=Object.prototype.toString;var Ra="[object Null]",Ta="[object Undefined]",Aa=Ea?Ea.toStringTag:void 0;function Ma(e){return null==e?void 0===e?Ta:Ra:Aa&&Aa in Object(e)?function(e){var t=ka.call(e,Oa),r=e[Oa];try{e[Oa]=void 0;var n=!0}catch{}var i=xa.call(e);return n&&(t?e[Oa]=r:delete e[Oa]),i}(e):function(e){return Ia.call(e)}(e)}function Na(e){return null!=e&&"object"==typeof e}var Da="[object Symbol]";function Pa(e){return"symbol"==typeof e||Na(e)&&Ma(e)==Da}function ja(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}const Fa=Array.isArray;var Va=1/0,La=Ea?Ea.prototype:void 0,$a=La?La.toString:void 0;function Ba(e){if("string"==typeof e)return e;if(Fa(e))return ja(e,Ba)+"";if(Pa(e))return $a?$a.call(e):"";var t=e+"";return"0"==t&&1/e==-Va?"-0":t}var Ua=/\s/;function za(e){for(var t=e.length;t--&&Ua.test(e.charAt(t)););return t}var Ha=/^\s+/;function Wa(e){return e&&e.slice(0,za(e)+1).replace(Ha,"")}function Ga(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Ka=NaN,qa=/^[-+]0x[0-9a-f]+$/i,Ya=/^0b[01]+$/i,Ja=/^0o[0-7]+$/i,Xa=parseInt;function Za(e){if("number"==typeof e)return e;if(Pa(e))return Ka;if(Ga(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ga(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Wa(e);var r=Ya.test(e);return r||Ja.test(e)?Xa(e.slice(2),r?2:8):qa.test(e)?Ka:+e}var Qa=1/0,es=17976931348623157e292;function ts(e){return e?(e=Za(e))===Qa||e===-Qa?(e<0?-1:1)*es:e==e?e:0:0===e?e:0}function rs(e){var t=ts(e),r=t%1;return t==t?r?t-r:t:0}function ns(e){return e}var is="[object AsyncFunction]",os="[object Function]",as="[object GeneratorFunction]",ss="[object Proxy]";function ls(e){if(!Ga(e))return!1;var t=Ma(e);return t==os||t==as||t==is||t==ss}const cs=Ca["__core-js_shared__"];var us=function(){var e=/[^.]+$/.exec(cs&&cs.keys&&cs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var ds=Function.prototype.toString;function fs(e){if(null!=e){try{return ds.call(e)}catch{}try{return e+""}catch{}}return""}var hs=/^\[object .+?Constructor\]$/,ps=Function.prototype,gs=Object.prototype,ms=ps.toString,vs=gs.hasOwnProperty,ys=RegExp("^"+ms.call(vs).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bs(e){return!(!Ga(e)||function(e){return!!us&&us in e}(e))&&(ls(e)?ys:hs).test(fs(e))}function _s(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return bs(r)?r:void 0}const ws=_s(Ca,"WeakMap");var Cs=Object.create,Es=function(){function e(){}return function(t){if(!Ga(t))return{};if(Cs)return Cs(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();const Ss=Es;function ks(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function xs(){}function Os(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var Is=Date.now;function Rs(e){var t=0,r=0;return function(){var n=Is(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Ts(e){return function(){return e}}var As=function(){try{var e=_s(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Ms=As;var Ns=Ms?function(e,t){return Ms(e,"toString",{configurable:!0,enumerable:!1,value:Ts(t),writable:!0})}:ns;const Ds=Rs(Ns);function Ps(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function js(e){return e!=e}function Fs(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):Ps(e,js,r)}function Vs(e,t){return!!(null==e?0:e.length)&&Fs(e,t,0)>-1}var Ls=9007199254740991,$s=/^(?:0|[1-9]\d*)$/;function Bs(e,t){var r=typeof e;return!!(t=null==t?Ls:t)&&("number"==r||"symbol"!=r&&$s.test(e))&&e>-1&&e%1==0&&e<t}function Us(e,t,r){"__proto__"==t&&Ms?Ms(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function zs(e,t){return e===t||e!=e&&t!=t}var Hs=Object.prototype.hasOwnProperty;function Ws(e,t,r){var n=e[t];(!Hs.call(e,t)||!zs(n,r)||void 0===r&&!(t in e))&&Us(e,t,r)}function Gs(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),i?Us(r,s,l):Ws(r,s,l)}return r}var Ks=Math.max;function qs(e,t,r){return t=Ks(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Ks(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),ks(e,this,s)}}function Ys(e,t){return Ds(qs(e,t,ns),e+"")}var Js=9007199254740991;function Xs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Js}function Zs(e){return null!=e&&Xs(e.length)&&!ls(e)}function Qs(e,t,r){if(!Ga(r))return!1;var n=typeof t;return!!("number"==n?Zs(r)&&Bs(t,r.length):"string"==n&&t in r)&&zs(r[t],e)}function el(e){return Ys((function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Qs(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,o)}return t}))}var tl=Object.prototype;function rl(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||tl)}function nl(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function il(e){return Na(e)&&"[object Arguments]"==Ma(e)}var ol=Object.prototype,al=ol.hasOwnProperty,sl=ol.propertyIsEnumerable,ll=il(function(){return arguments}())?il:function(e){return Na(e)&&al.call(e,"callee")&&!sl.call(e,"callee")};const cl=ll;function ul(){return!1}var dl="object"==typeof exports&&exports&&!exports.nodeType&&exports,fl=dl&&"object"==typeof n&&n&&!n.nodeType&&n,hl=fl&&fl.exports===dl?Ca.Buffer:void 0;const pl=(hl?hl.isBuffer:void 0)||ul;var gl={};function ml(e){return function(t){return e(t)}}gl["[object Float32Array]"]=gl["[object Float64Array]"]=gl["[object Int8Array]"]=gl["[object Int16Array]"]=gl["[object Int32Array]"]=gl["[object Uint8Array]"]=gl["[object Uint8ClampedArray]"]=gl["[object Uint16Array]"]=gl["[object Uint32Array]"]=!0,gl["[object Arguments]"]=gl["[object Array]"]=gl["[object ArrayBuffer]"]=gl["[object Boolean]"]=gl["[object DataView]"]=gl["[object Date]"]=gl["[object Error]"]=gl["[object Function]"]=gl["[object Map]"]=gl["[object Number]"]=gl["[object Object]"]=gl["[object RegExp]"]=gl["[object Set]"]=gl["[object String]"]=gl["[object WeakMap]"]=!1;var vl="object"==typeof exports&&exports&&!exports.nodeType&&exports,yl=vl&&"object"==typeof n&&n&&!n.nodeType&&n,bl=yl&&yl.exports===vl&&_a.process;const _l=function(){try{return yl&&yl.require&&yl.require("util").types||bl&&bl.binding&&bl.binding("util")}catch{}}();var wl=_l&&_l.isTypedArray,Cl=wl?ml(wl):function(e){return Na(e)&&Xs(e.length)&&!!gl[Ma(e)]};const El=Cl;var Sl=Object.prototype.hasOwnProperty;function kl(e,t){var r=Fa(e),n=!r&&cl(e),i=!r&&!n&&pl(e),o=!r&&!n&&!i&&El(e),a=r||n||i||o,s=a?nl(e.length,String):[],l=s.length;for(var c in e)(t||Sl.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Bs(c,l)))&&s.push(c);return s}function xl(e,t){return function(r){return e(t(r))}}const Ol=xl(Object.keys,Object);var Il=Object.prototype.hasOwnProperty;function Rl(e){if(!rl(e))return Ol(e);var t=[];for(var r in Object(e))Il.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Tl(e){return Zs(e)?kl(e):Rl(e)}var Al=Object.prototype.hasOwnProperty;function Ml(e){if(!Ga(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=rl(e),r=[];for(var n in e)"constructor"==n&&(t||!Al.call(e,n))||r.push(n);return r}function Nl(e){return Zs(e)?kl(e,!0):Ml(e)}var Dl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pl=/^\w*$/;function jl(e,t){if(Fa(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Pa(e))||(Pl.test(e)||!Dl.test(e)||null!=t&&e in Object(t))}const Fl=_s(Object,"create");var Vl=Object.prototype.hasOwnProperty;var Ll=Object.prototype.hasOwnProperty;function $l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Bl(e,t){for(var r=e.length;r--;)if(zs(e[r][0],t))return r;return-1}$l.prototype.clear=function(){this.__data__=Fl?Fl(null):{},this.size=0},$l.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},$l.prototype.get=function(e){var t=this.__data__;if(Fl){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Vl.call(t,e)?t[e]:void 0},$l.prototype.has=function(e){var t=this.__data__;return Fl?void 0!==t[e]:Ll.call(t,e)},$l.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Fl&&void 0===t?"__lodash_hash_undefined__":t,this};var Ul=Array.prototype.splice;function zl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zl.prototype.clear=function(){this.__data__=[],this.size=0},zl.prototype.delete=function(e){var t=this.__data__,r=Bl(t,e);return!(r<0)&&(r==t.length-1?t.pop():Ul.call(t,r,1),--this.size,!0)},zl.prototype.get=function(e){var t=this.__data__,r=Bl(t,e);return r<0?void 0:t[r][1]},zl.prototype.has=function(e){return Bl(this.__data__,e)>-1},zl.prototype.set=function(e,t){var r=this.__data__,n=Bl(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};const Hl=_s(Ca,"Map");function Wl(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Gl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gl.prototype.clear=function(){this.size=0,this.__data__={hash:new $l,map:new(Hl||zl),string:new $l}},Gl.prototype.delete=function(e){var t=Wl(this,e).delete(e);return this.size-=t?1:0,t},Gl.prototype.get=function(e){return Wl(this,e).get(e)},Gl.prototype.has=function(e){return Wl(this,e).has(e)},Gl.prototype.set=function(e,t){var r=Wl(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var Kl="Expected a function";function ql(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Kl);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(ql.Cache||Gl),r}ql.Cache=Gl;var Yl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jl=/\\(\\)?/g,Xl=function(e){var t=ql(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Yl,(function(e,r,n,i){t.push(n?i.replace(Jl,"$1"):r||e)})),t}));const Zl=Xl;function Ql(e){return null==e?"":Ba(e)}function ec(e,t){return Fa(e)?e:jl(e,t)?[e]:Zl(Ql(e))}var tc=1/0;function rc(e){if("string"==typeof e||Pa(e))return e;var t=e+"";return"0"==t&&1/e==-tc?"-0":t}function nc(e,t){for(var r=0,n=(t=ec(t,e)).length;null!=e&&r<n;)e=e[rc(t[r++])];return r&&r==n?e:void 0}function ic(e,t,r){var n=null==e?void 0:nc(e,t);return void 0===n?r:n}function oc(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var ac=Ea?Ea.isConcatSpreadable:void 0;function sc(e){return Fa(e)||cl(e)||!!(ac&&e&&e[ac])}function lc(e,t,r,n,i){var o=-1,a=e.length;for(r||(r=sc),i||(i=[]);++o<a;){var s=e[o];t>0&&r(s)?t>1?lc(s,t-1,r,n,i):oc(i,s):n||(i[i.length]=s)}return i}function cc(e){return(null==e?0:e.length)?lc(e,1):[]}const uc=xl(Object.getPrototypeOf,Object);var dc="[object Object]",fc=Function.prototype,hc=Object.prototype,pc=fc.toString,gc=hc.hasOwnProperty,mc=pc.call(Object);function vc(e){if(!Na(e)||Ma(e)!=dc)return!1;var t=uc(e);if(null===t)return!0;var r=gc.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&pc.call(r)==mc}function yc(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}var bc=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function _c(e){return bc.test(e)}var wc="\\ud800-\\udfff",Cc="["+wc+"]",Ec="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Sc="\\ud83c[\\udffb-\\udfff]",kc="[^"+wc+"]",xc="(?:\\ud83c[\\udde6-\\uddff]){2}",Oc="[\\ud800-\\udbff][\\udc00-\\udfff]",Ic="(?:"+Ec+"|"+Sc+")"+"?",Rc="[\\ufe0e\\ufe0f]?",Tc=Rc+Ic+("(?:\\u200d(?:"+[kc,xc,Oc].join("|")+")"+Rc+Ic+")*"),Ac="(?:"+[kc+Ec+"?",Ec,xc,Oc,Cc].join("|")+")",Mc=RegExp(Sc+"(?="+Sc+")|"+Ac+Tc,"g");function Nc(e){return _c(e)?function(e){return e.match(Mc)||[]}(e):function(e){return e.split("")}(e)}function Dc(e){var t=this.__data__=new zl(e);this.size=t.size}Dc.prototype.clear=function(){this.__data__=new zl,this.size=0},Dc.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Dc.prototype.get=function(e){return this.__data__.get(e)},Dc.prototype.has=function(e){return this.__data__.has(e)},Dc.prototype.set=function(e,t){var r=this.__data__;if(r instanceof zl){var n=r.__data__;if(!Hl||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Gl(n)}return r.set(e,t),this.size=r.size,this};var Pc="object"==typeof exports&&exports&&!exports.nodeType&&exports,jc=Pc&&"object"==typeof n&&n&&!n.nodeType&&n,Fc=jc&&jc.exports===Pc?Ca.Buffer:void 0,Vc=Fc?Fc.allocUnsafe:void 0;function Lc(e,t){if(t)return e.slice();var r=e.length,n=Vc?Vc(r):new e.constructor(r);return e.copy(n),n}function $c(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}function Bc(){return[]}var Uc=Object.prototype.propertyIsEnumerable,zc=Object.getOwnPropertySymbols,Hc=zc?function(e){return null==e?[]:(e=Object(e),$c(zc(e),(function(t){return Uc.call(e,t)})))}:Bc;const Wc=Hc;function Gc(e,t,r){var n=t(e);return Fa(e)?n:oc(n,r(e))}function Kc(e){return Gc(e,Tl,Wc)}const qc=_s(Ca,"DataView");const Yc=_s(Ca,"Promise");const Jc=_s(Ca,"Set");var Xc="[object Map]",Zc="[object Promise]",Qc="[object Set]",eu="[object WeakMap]",tu="[object DataView]",ru=fs(qc),nu=fs(Hl),iu=fs(Yc),ou=fs(Jc),au=fs(ws),su=Ma;(qc&&su(new qc(new ArrayBuffer(1)))!=tu||Hl&&su(new Hl)!=Xc||Yc&&su(Yc.resolve())!=Zc||Jc&&su(new Jc)!=Qc||ws&&su(new ws)!=eu)&&(su=function(e){var t=Ma(e),r="[object Object]"==t?e.constructor:void 0,n=r?fs(r):"";if(n)switch(n){case ru:return tu;case nu:return Xc;case iu:return Zc;case ou:return Qc;case au:return eu}return t});const lu=su;const cu=Ca.Uint8Array;function uu(e){var t=new e.constructor(e.byteLength);return new cu(t).set(new cu(e)),t}function du(e,t){var r=t?uu(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function fu(e){return"function"!=typeof e.constructor||rl(e)?{}:Ss(uc(e))}function hu(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Gl;++t<r;)this.add(e[t])}function pu(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function gu(e,t){return e.has(t)}hu.prototype.add=hu.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},hu.prototype.has=function(e){return this.__data__.has(e)};var mu=1,vu=2;function yu(e,t,r,n,i,o){var a=r&mu,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,h=r&vu?new hu:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],g=t[d];if(n)var m=a?n(g,p,d,t,e,o):n(p,g,d,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!pu(t,(function(e,t){if(!gu(h,t)&&(p===e||i(p,e,r,n,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function bu(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function _u(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var wu=1,Cu=2,Eu="[object Boolean]",Su="[object Date]",ku="[object Error]",xu="[object Map]",Ou="[object Number]",Iu="[object RegExp]",Ru="[object Set]",Tu="[object String]",Au="[object Symbol]",Mu="[object ArrayBuffer]",Nu="[object DataView]",Du=Ea?Ea.prototype:void 0,Pu=Du?Du.valueOf:void 0;var ju=1,Fu=Object.prototype.hasOwnProperty;var Vu=1,Lu="[object Arguments]",$u="[object Array]",Bu="[object Object]",Uu=Object.prototype.hasOwnProperty;function zu(e,t,r,n,i,o){var a=Fa(e),s=Fa(t),l=a?$u:lu(e),c=s?$u:lu(t),u=(l=l==Lu?Bu:l)==Bu,d=(c=c==Lu?Bu:c)==Bu,f=l==c;if(f&&pl(e)){if(!pl(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new Dc),a||El(e)?yu(e,t,r,n,i,o):function(e,t,r,n,i,o,a){switch(r){case Nu:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Mu:return!(e.byteLength!=t.byteLength||!o(new cu(e),new cu(t)));case Eu:case Su:case Ou:return zs(+e,+t);case ku:return e.name==t.name&&e.message==t.message;case Iu:case Tu:return e==t+"";case xu:var s=bu;case Ru:var l=n&wu;if(s||(s=_u),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=Cu,a.set(e,t);var u=yu(s(e),s(t),n,i,o,a);return a.delete(e),u;case Au:if(Pu)return Pu.call(e)==Pu.call(t)}return!1}(e,t,l,r,n,i,o);if(!(r&Vu)){var h=u&&Uu.call(e,"__wrapped__"),p=d&&Uu.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return o||(o=new Dc),i(g,m,r,n,o)}}return!!f&&(o||(o=new Dc),function(e,t,r,n,i,o){var a=r&ju,s=Kc(e),l=s.length;if(l!=Kc(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:Fu.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<l;){var g=e[u=s[c]],m=t[u];if(n)var v=a?n(m,g,u,t,e,o):n(g,m,u,e,t,o);if(!(void 0===v?g===m||i(g,m,r,n,o):v)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(h=!1)}return o.delete(e),o.delete(t),h}(e,t,r,n,i,o))}function Hu(e,t,r,n,i){return e===t||(null==e||null==t||!Na(e)&&!Na(t)?e!=e&&t!=t:zu(e,t,r,n,Hu,i))}var Wu=1,Gu=2;function Ku(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new Dc;if(n)var f=n(c,u,l,e,t,d);if(!(void 0===f?Hu(u,c,Wu|Gu,n,d):f))return!1}}return!0}function qu(e){return e==e&&!Ga(e)}function Yu(e){for(var t=Tl(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,qu(i)]}return t}function Ju(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function Xu(e){var t=Yu(e);return 1==t.length&&t[0][2]?Ju(t[0][0],t[0][1]):function(r){return r===e||Ku(r,e,t)}}function Zu(e,t){return null!=e&&t in Object(e)}function Qu(e,t,r){for(var n=-1,i=(t=ec(t,e)).length,o=!1;++n<i;){var a=rc(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Xs(i)&&Bs(a,i)&&(Fa(e)||cl(e))}function ed(e,t){return null!=e&&Qu(e,t,Zu)}var td=1,rd=2;function nd(e,t){return jl(e)&&qu(t)?Ju(rc(e),t):function(r){var n=ic(r,e);return void 0===n&&n===t?ed(r,e):Hu(t,n,td|rd)}}function id(e){return function(t){return null==t?void 0:t[e]}}function od(e){return jl(e)?id(rc(e)):function(e){return function(t){return nc(t,e)}}(e)}function ad(e){return"function"==typeof e?e:null==e?ns:"object"==typeof e?Fa(e)?nd(e[0],e[1]):Xu(e):od(e)}function sd(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n}function ld(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}}const cd=ld();function ud(e,t){return e&&cd(e,t,Tl)}function dd(e,t){return function(r,n){if(null==r)return r;if(!Zs(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}}const fd=dd(ud);function hd(e,t,r,n){return fd(e,(function(e,i,o){t(n,e,r(e),o)})),n}function pd(e,t){return function(r,n){var i=Fa(r)?sd:hd,o=t?t():{};return i(r,e,ad(n),o)}}function gd(e,t,r){(void 0!==r&&!zs(e[t],r)||void 0===r&&!(t in e))&&Us(e,t,r)}function md(e){return Na(e)&&Zs(e)}function vd(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function yd(e){return Gs(e,Nl(e))}function bd(e,t,r,n,i){e!==t&&cd(t,(function(o,a){if(i||(i=new Dc),Ga(o))!function(e,t,r,n,i,o,a){var s=vd(e,r),l=vd(t,r),c=a.get(l);if(c)gd(e,r,c);else{var u=o?o(s,l,r+"",e,t,a):void 0,d=void 0===u;if(d){var f=Fa(l),h=!f&&pl(l),p=!f&&!h&&El(l);u=l,f||h||p?Fa(s)?u=s:md(s)?u=Os(s):h?(d=!1,u=Lc(l,!0)):p?(d=!1,u=du(l,!0)):u=[]:vc(l)||cl(l)?(u=s,cl(s)?u=yd(s):(!Ga(s)||ls(s))&&(u=fu(l))):d=!1}d&&(a.set(l,u),i(u,l,n,o,a),a.delete(l)),gd(e,r,u)}}(e,t,a,r,bd,n,i);else{var s=n?n(vd(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),gd(e,a,s)}}),Nl)}function _d(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var wd=200;function Cd(e,t,r,n){var i=-1,o=Vs,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;r&&(t=ja(t,ml(r))),n?(o=_d,a=!1):t.length>=wd&&(o=gu,a=!1,t=new hu(t));e:for(;++i<s;){var u=e[i],d=null==r?u:r(u);if(u=n||0!==u?u:0,a&&d==d){for(var f=c;f--;)if(t[f]===d)continue e;l.push(u)}else o(t,d,n)||l.push(u)}return l}var Ed=Ys((function(e,t){return md(e)?Cd(e,lc(t,1,md,!0)):[]}));const Sd=Ed;function kd(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var xd=Object.prototype.hasOwnProperty,Od=pd((function(e,t,r){xd.call(e,r)?e[r].push(t):Us(e,r,[t])}));const Id=Od;var Rd=Math.max,Td=Math.min;function Ad(e,t,r){return t=ts(t),void 0===r?(r=t,t=0):r=ts(r),function(e,t,r){return e>=Td(t,r)&&e<Rd(t,r)}(e=Za(e),t,r)}var Md="[object String]";function Nd(e){return"string"==typeof e||!Fa(e)&&Na(e)&&Ma(e)==Md}function Dd(e,t){return ja(t,(function(t){return e[t]}))}function Pd(e){return null==e?[]:Dd(e,Tl(e))}function jd(e,t){return t.length<2?e:nc(e,yc(t,0,-1))}function Fd(e){return!0===e||!1===e||Na(e)&&"[object Boolean]"==Ma(e)}function Vd(e,t){return Hu(e,t)}function Ld(e){return null==e}var $d=el((function(e,t,r){bd(e,t,r)}));const Bd=$d;var Ud="[object Map]",zd="[object Set]",Hd=Ea?Ea.iterator:void 0;function Wd(e){if(!e)return[];if(Zs(e))return Nd(e)?Nc(e):Os(e);if(Hd&&e[Hd])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[Hd]());var t=lu(e);return(t==Ud?bu:t==zd?_u:Pd)(e)}function Gd(e,t){return null==(e=jd(e,t=ec(t,e)))||delete e[rc(kd(t))]}function Kd(e,t,r,n){if(!Ga(e))return e;for(var i=-1,o=(t=ec(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l=rc(t[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var u=s[l];void 0===(c=n?n(u,l,s):void 0)&&(c=Ga(u)?u:Bs(t[i+1])?[]:{})}Ws(s,l,c),s=s[l]}return e}var qd=Array.prototype.splice;function Yd(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==o){var o=i;Bs(i)?qd.call(e,i,1):Gd(e,i)}}return e}function Jd(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=ad(t);++n<o;){var a=e[n];t(a,n,e)&&(r.push(a),i.push(n))}return Yd(e,i),r}function Xd(e,t,r){return null==e?e:Kd(e,t,r)}function Zd(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&Qs(e,t,r)?(t=0,r=n):(t=null==t?0:rs(t),r=void 0===r?n:rs(r)),yc(e,t,r)):[]}var Qd=Jc&&1/_u(new Jc([,-0]))[1]==1/0?function(e){return new Jc(e)}:xs;const ef=Qd;var tf=200;function rf(e,t,r){var n=-1,i=Vs,o=e.length,a=!0,s=[],l=s;if(r)a=!1,i=_d;else if(o>=tf){var c=t?null:ef(e);if(c)return _u(c);a=!1,i=gu,l=new hu}else l=t?[]:s;e:for(;++n<o;){var u=e[n],d=t?t(u):u;if(u=r||0!==u?u:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(u)}else i(l,d,r)||(l!==s&&l.push(d),s.push(u))}return s}var nf=Ys((function(e){var t=kd(e);return md(t)&&(t=void 0),rf(lc(e,1,md,!0),ad(t))}));const of=nf;function af(e,t){return e&&e.length?rf(e,ad(t)):[]}const sf=class extends ya{constructor(e){super(e||sf.defaultMaxSize),this._canvasCtx=null}_getOrCreateCanvasCtx(){if(this._canvasCtx)return this._canvasCtx;const e=document.createElement("canvas").getContext("2d");return this._canvasCtx=e,this._canvasCtx}calc(e,t){if(!e)return{width:0,height:0};const r=Wd(e);let n=0,i=0;return r.forEach((e=>{const r=this._getWordSize(e,t);n+=r.width,r.height>i&&(i=r.height)})),{width:n,height:i}}getRenderText(e,t,r){if(!jo(e))return e;const n=r||sf.defaultFontStyle,i=n.fontSize,o=3*n.fontSize,a=Math.ceil(t.height/n.lineHeight),s=t.width*a;if(this._getWordSize(e,n.font).width+i<s)return e;let l=0,c=e.length-1;const u=this._getEllipsisWidth(n.font);let d=10;for(;l<=c&&d>0;){d--;const t=Math.floor((l+c)/2),r=e.slice(0,t+1),i=this._getWordSize(r,n.font).width;if(Ad(i+u,s-o,s))return r+"...";i>s?c=t-1:l=t+1}return e.slice(0,l-3)+"..."}_getEllipsisWidth(e){return Math.ceil(this._getWordSize("...",e).width)}_getWordSize(e,t){const r=`${e}-${t}`,n=this.get(r);if(n)return n;this._canvasCtx=this._getOrCreateCanvasCtx(),this._canvasCtx.font=t;const i=this._canvasCtx.measureText(e),o={width:i.width,height:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return this.put(r,o),o}};let lf=sf;lf.defaultMaxSize=1e4,lf.maxFindTime=500,lf.defaultFontStyle={lineHeight:14,font:"14px PingFang SC",fontSize:14};const cf=new lf;function uf(e,t){if(void 0===e||!t)return"";let r=""+e,n="";const i=r.indexOf(".")>=0;if("-"===r[0]&&(r=r.substr(1),n="-"),r.length>=t)return n+r;let o=t-r.length;for(;o--;)r=i?r+"0":"0"+r;return n+r}function df(e){return(e=e.map((e=>("command"===e.toLowerCase()&&(e=fa.isMac?"⌘":"Ctrl"),"shift"===e.toLowerCase()&&(e=fa.isMac?"⇧":"Shift"),e)))).join("")}function ff(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\t/g,"&nbsp;&nbsp;").replace(/\n/g,"<br>")}function hf(e){return/^([0-9]|\+|\-)+$/gi.test(e)}function pf(e){return!/\s/gi.test(e)&&/.+\@.+\..+/gi.test(e)}function gf(e,t){return Math.floor(e+Math.random()*(t-e))}function mf(){let e=8;const t="23456789abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";let r="";for(;e--;)r+=t[gf(0,56)];return r}function vf(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\t/g,"&nbsp;&nbsp;").replace(/\n/g,"<br>")}var yf={exports:{}};!function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",s="day",l="week",c="month",u="quarter",d="year",f="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},v=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},y={s:v,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+v(n,2,"0")+":"+v(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),o=r-i<0,a=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:s,D:f,h:a,m:o,s:i,ms:n,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",_={};_[b]=m;var w="$isDayjsObject",C=function(e){return e instanceof x||!(!e||!e[w])},E=function e(t,r,n){var i;if(!t)return b;if("string"==typeof t){var o=t.toLowerCase();_[o]&&(i=o),r&&(_[o]=r,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;_[s]=t,i=s}return!n&&i&&(b=i),i||!n&&b},S=function(e,t){if(C(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new x(r)},k=y;k.l=E,k.i=C,k.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var x=function(){function m(e){this.$L=E(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var v=m.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(k.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return k},v.isValid=function(){return this.$d.toString()!==h},v.isSame=function(e,t){var r=S(e);return this.startOf(t)<=r&&r<=this.endOf(t)},v.isAfter=function(e,t){return S(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<S(e)},v.$g=function(e,t,r){return k.u(e)?this[t]:this.set(r,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var r=this,n=!!k.u(t)||t,u=k.p(e),h=function(e,t){var i=k.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(s)},p=function(e,t){return k.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},g=this.$W,m=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case d:return n?h(1,0):h(31,11);case c:return n?h(1,m):h(0,m+1);case l:var b=this.$locale().weekStart||0,_=(g<b?g+7:g)-b;return h(n?v-_:v+(6-_),m);case s:case f:return p(y+"Hours",0);case a:return p(y+"Minutes",1);case o:return p(y+"Seconds",2);case i:return p(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var r,l=k.p(e),u="set"+(this.$u?"UTC":""),h=(r={},r[s]=u+"Date",r[f]=u+"Date",r[c]=u+"Month",r[d]=u+"FullYear",r[a]=u+"Hours",r[o]=u+"Minutes",r[i]=u+"Seconds",r[n]=u+"Milliseconds",r)[l],p=l===s?this.$D+(t-this.$W):t;if(l===c||l===d){var g=this.clone().set(f,1);g.$d[h](p),g.init(),this.$d=g.set(f,Math.min(this.$D,g.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[k.p(e)]()},v.add=function(n,u){var f,h=this;n=Number(n);var p=k.p(u),g=function(e){var t=S(h);return k.w(t.date(t.date()+Math.round(e*n)),h)};if(p===c)return this.set(c,this.$M+n);if(p===d)return this.set(d,this.$y+n);if(p===s)return g(1);if(p===l)return g(7);var m=(f={},f[o]=t,f[a]=r,f[i]=e,f)[p]||1,v=this.$d.getTime()+n*m;return k.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||h;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=k.z(this),o=this.$H,a=this.$m,s=this.$M,l=r.weekdays,c=r.months,u=r.meridiem,d=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].slice(0,o)},f=function(e){return k.s(o%12||12,e,"0")},p=u||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(g,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return k.s(t.$y,4,"0");case"M":return s+1;case"MM":return k.s(s+1,2,"0");case"MMM":return d(r.monthsShort,s,c,3);case"MMMM":return d(c,s);case"D":return t.$D;case"DD":return k.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,l,2);case"ddd":return d(r.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(o);case"HH":return k.s(o,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return p(o,a,!0);case"A":return p(o,a,!1);case"m":return String(a);case"mm":return k.s(a,2,"0");case"s":return String(t.$s);case"ss":return k.s(t.$s,2,"0");case"SSS":return k.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(n,f,h){var p,g=this,m=k.p(f),v=S(n),y=(v.utcOffset()-this.utcOffset())*t,b=this-v,_=function(){return k.m(g,v)};switch(m){case d:p=_()/12;break;case c:p=_();break;case u:p=_()/3;break;case l:p=(b-y)/6048e5;break;case s:p=(b-y)/864e5;break;case a:p=b/r;break;case o:p=b/t;break;case i:p=b/e;break;default:p=b}return h?p:k.a(p)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return _[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=E(e,t,!0);return n&&(r.$L=n),r},v.clone=function(){return k.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},m}(),O=x.prototype;return S.prototype=O,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",s],["$M",c],["$y",d],["$D",f]].forEach((function(e){O[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,x,S),e.$i=!0),S},S.locale=E,S.isDayjs=C,S.unix=function(e){return S(1e3*e)},S.en=_[b],S.Ls=_,S.p={},S}()}(yf);const bf=yf.exports,_f="1899-12-30",wf="YYYY-MM-DDTHH:mm:ssZ",Cf="YYYY-MM-DD";function Ef(e){if(Ld(e))return null;if(e>=31708800){e+=bf("1901-01-01").diff("1900-12-31 23:59:59","seconds")-1}return bf(_f).add(e,"seconds").format(wf)}const Sf=e=>{let t=e;return""===e?"":(jo(e)&&4===e.length&&/^(0[1-9]|1[0-2]).*(0[1-9]|[12][0-9]|3[01])/g.test(e)&&(t=bf().year()+e),bf(t).format(Cf))},kf=/^(?:\w+:)?\/\//,xf=/^(javascript:)?\/\//,Of=/^(?:\w+:)?\/\/(\S+)$/,If=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,Rf=/^[^\s\.]+\.\S{2,}$/;function Tf(e){return(e=String(e).trim()).match(kf)&&!e.match(xf)?e:"http://"+e}function Af(e){return function(e){if("string"!=typeof e||e.match(xf))return!1;const t=e.match(Of);if(!t)return!1;const r=t[1];return!(!r||!If.test(r)&&!Rf.test(r))}(e)?e:Tf(e)}function Mf(e){if("string"!=typeof e||!e||/[\u0020\n]/.test(e))return!1;try{const{protocol:t}=new URL(e);return"http:"===t||"https:"===t}catch{return!1}}function Nf(e){return new URL(e).searchParams}function Df(e){return/^-?\d*[.,]?\d*$/.test(e)||/^[-+]?\d{1,3}(,\d{3})*(\.(\d*))?$/.test(e)?e+"":""}const Pf=e=>!(""!==e&&!Ld(e))||""!==Df(e);function jf(e){return(jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ff(e){if(!("string"==typeof e||e instanceof String)){var t=jf(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}}function Vf(e){return(Vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lf(e,t){var r,n;Ff(e),"object"===Vf(t)?(r=t.min||0,n=t.max):(r=arguments[1],n=arguments[2]);var i=encodeURI(e).split(/%..|./).length-1;return i>=r&&(typeof n>"u"||i<=n)}function $f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var r in t)typeof e[r]>"u"&&(e[r]=t[r]);return e}var Bf={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1,ignore_max_length:!1};function Uf(e,t){Ff(e),(t=$f(t,Bf)).allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1)),!0===t.allow_wildcard&&0===e.indexOf("*.")&&(e=e.substring(2));var r=e.split("."),n=r[r.length-1];return!(t.require_tld&&(r.length<2||!t.allow_numeric_tld&&!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(n)||/\s/.test(n))||!t.allow_numeric_tld&&/^\d+$/.test(n))&&r.every((function(e){return!(e.length>63&&!t.ignore_max_length||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(e)||/[\uff01-\uff5e]/.test(e)||/^-|-$/.test(e)||!t.allow_underscores&&/_/.test(e))}))}var zf="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",Hf="(".concat(zf,"[.]){3}").concat(zf),Wf=new RegExp("^".concat(Hf,"$")),Gf="(?:[0-9a-fA-F]{1,4})",Kf=new RegExp("^("+"(?:".concat(Gf,":){7}(?:").concat(Gf,"|:)|")+"(?:".concat(Gf,":){6}(?:").concat(Hf,"|:").concat(Gf,"|:)|")+"(?:".concat(Gf,":){5}(?::").concat(Hf,"|(:").concat(Gf,"){1,2}|:)|")+"(?:".concat(Gf,":){4}(?:(:").concat(Gf,"){0,1}:").concat(Hf,"|(:").concat(Gf,"){1,3}|:)|")+"(?:".concat(Gf,":){3}(?:(:").concat(Gf,"){0,2}:").concat(Hf,"|(:").concat(Gf,"){1,4}|:)|")+"(?:".concat(Gf,":){2}(?:(:").concat(Gf,"){0,3}:").concat(Hf,"|(:").concat(Gf,"){1,5}|:)|")+"(?:".concat(Gf,":){1}(?:(:").concat(Gf,"){0,4}:").concat(Hf,"|(:").concat(Gf,"){1,6}|:)|")+"(?::((?::".concat(Gf,"){0,5}:").concat(Hf,"|(?::").concat(Gf,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function qf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Ff(e),(t=String(t))?"4"===t?Wf.test(e):"6"===t&&Kf.test(e):qf(e,4)||qf(e,6)}var Yf={allow_display_name:!1,allow_underscores:!1,require_display_name:!1,allow_utf8_local_part:!0,require_tld:!0,blacklisted_chars:"",ignore_max_length:!1,host_blacklist:[],host_whitelist:[]},Jf=/^([^\x00-\x1F\x7F-\x9F\cX]+)</i,Xf=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,Zf=/^[a-z\d]+$/,Qf=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,eh=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A1-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,th=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,rh=254;function nh(e,t){if(Ff(e),(t=$f(t,Yf)).require_display_name||t.allow_display_name){var r=e.match(Jf);if(r){var n=r[1];if(e=e.replace(n,"").replace(/(^<|>$)/g,""),n.endsWith(" ")&&(n=n.slice(0,-1)),!function(e){var t=e.replace(/^"(.+)"$/,"$1");if(!t.trim())return!1;if(/[\.";<>]/.test(t)){if(t===e)return!1;if(t.split('"').length!==t.split('\\"').length)return!1}return!0}(n))return!1}else if(t.require_display_name)return!1}if(!t.ignore_max_length&&e.length>rh)return!1;var i=e.split("@"),o=i.pop(),a=o.toLowerCase();if(t.host_blacklist.includes(a)||t.host_whitelist.length>0&&!t.host_whitelist.includes(a))return!1;var s=i.join("@");if(t.domain_specific_validation&&("gmail.com"===a||"googlemail.com"===a)){var l=(s=s.toLowerCase()).split("+")[0];if(!Lf(l.replace(/\./g,""),{min:6,max:30}))return!1;for(var c=l.split("."),u=0;u<c.length;u++)if(!Zf.test(c[u]))return!1}if(!(!1!==t.ignore_max_length||Lf(s,{max:64})&&Lf(o,{max:254})))return!1;if(!Uf(o,{require_tld:t.require_tld,ignore_max_length:t.ignore_max_length,allow_underscores:t.allow_underscores})){if(!t.allow_ip_domain)return!1;if(!qf(o)){if(!o.startsWith("[")||!o.endsWith("]"))return!1;var d=o.slice(1,-1);if(0===d.length||!qf(d))return!1}}if('"'===s[0])return s=s.slice(1,s.length-1),t.allow_utf8_local_part?th.test(s):Qf.test(s);for(var f=t.allow_utf8_local_part?eh:Xf,h=s.split("."),p=0;p<h.length;p++)if(!f.test(h[p]))return!1;return!(t.blacklisted_chars&&-1!==s.search(new RegExp("[".concat(t.blacklisted_chars,"]+"),"g")))}function ih(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(typeof Symbol>"u")&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&null!=s.return&&s.return()}finally{if(i)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return oh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oh(e,t)}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ah={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,allow_fragments:!0,allow_query_components:!0,validate_length:!0},sh=/^\[([^\]]+)\](?::([0-9]+))?$/;function lh(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function ch(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(e===n||lh(n)&&n.test(e))return!0}return!1}const uh=(e,t={})=>function(e,t){if(Ff(e),!e||/[\s<>]/.test(e)||0===e.indexOf("mailto:")||(t=$f(t,ah)).validate_length&&e.length>=2083||!t.allow_fragments&&e.includes("#")||!t.allow_query_components&&(e.includes("?")||e.includes("&")))return!1;var r,n,i,o,a,s,l,c;if(l=e.split("#"),e=l.shift(),l=e.split("?"),e=l.shift(),(l=e.split("://")).length>1){if(r=l.shift().toLowerCase(),t.require_valid_protocol&&-1===t.protocols.indexOf(r))return!1}else{if(t.require_protocol)return!1;if("//"===e.slice(0,2)){if(!t.allow_protocol_relative_urls)return!1;l[0]=e.slice(2)}}if(""===(e=l.join("://")))return!1;if(l=e.split("/"),""===(e=l.shift())&&!t.require_host)return!0;if((l=e.split("@")).length>1){if(t.disallow_auth||""===l[0]||(n=l.shift()).indexOf(":")>=0&&n.split(":").length>2)return!1;var u=ih(n.split(":"),2),d=u[0],f=u[1];if(""===d&&""===f)return!1}s=null,c=null;var h=(o=l.join("@")).match(sh);if(h?(i="",c=h[1],s=h[2]||null):(i=(l=o.split(":")).shift(),l.length&&(s=l.join(":"))),null!==s&&s.length>0){if(a=parseInt(s,10),!/^[0-9]+$/.test(s)||a<=0||a>65535)return!1}else if(t.require_port)return!1;return t.host_whitelist?ch(i,t.host_whitelist):""===i&&!t.require_host||!(!qf(i)&&!Uf(i,t)&&(!c||!qf(c,6))||(i=i||c,t.host_blacklist&&ch(i,t.host_blacklist)))}(e,{require_protocol:!0,...t}),dh=e=>"Invalid Date"!==bf(e).toString(),fh=/^(13\d|14\d|15[012356789]|16[567]|17[01235678]|18\d|19[12356789])\d{8}(\+\d+)?$/,hh=/^\+[1-9]\d{0,2}? \d{1,20}$/,ph=/^\+86 /,gh=e=>!(!e||ph.test(e))&&!(!hh.test(e)&&!fh.test(e)),mh=(e,t={})=>{if(!e)return!1;const r=t.precision||18,n=t.scale||2,i=t.forceDecimal||!1;return!(e.replace(/[-+.]/gi,"").length>r)&&new RegExp(`^[-+]?([0-9]+)?(\\.[0-9]{0,${n}})${i?"":"?"}$`).test(e)},vh=new Map;class yh{constructor(e){this.toDisposeOnParentChange=new wo,this.onModuleChangedEmitter=new _o,this.id=To(),this.onRegisteredEmitter=new _o,this.loadedModules=[],this.inversify=!0,this.container=e||new mi,yh.setContainer(this.container,this)}get onModuleChanged(){return this.onModuleChangedEmitter.event}get onRegistered(){return this.onRegisteredEmitter.event}get parent(){return this._parent}set parent(e){this._parent=e,this.toDisposeOnParentChange&&(this.toDisposeOnParentChange.dispose(),this.toDisposeOnParentChange=new wo),e&&(this.toDisposeOnParentChange.push(e.onModuleChanged((()=>{this.onModuleChangedEmitter.fire()}))),this.toDisposeOnParentChange.push(e.onRegistered((()=>{this.onRegisteredEmitter.fire()}))))}static setContainer(e,t){return vh.set(e.id,t)}static getContainer(e){const t=vh.get(e.id);if(!t){const t=new yh(e);return yh.setContainer(e,t),t}return t}static config(e){fo.globalConfig=e}dispose(){this.toDisposeOnParentChange.dispose(),this.onModuleChangedEmitter.dispose(),this.onRegisteredEmitter.dispose(),this.disposed=!0}load(e,t){return t||!this.loadedModules.includes(e.id)?(ko(e)?(this.container.load(e.inversifyModule),this.onModuleChangedEmitter.fire()):console.warn("Unsupported module.",e),this.loadedModules.push(e.id),{dispose:()=>{this.unload(e)}}):{dispose:()=>{}}}unload(e){ko(e)&&(this.container.unload(e.inversifyModule),this.onModuleChangedEmitter.fire(),this.loadedModules=this.loadedModules.filter((t=>t!==e.id)))}remove(e){return this.container.unbind(to(e))}get(e){let t;const r=to(e);try{t=this.container.get(r)}catch(e){if(e.message.includes("No matching bindings found")&&this.parent)return this.parent.get(r);throw e}return t}getNamed(e,t){return this.container.getNamed(to(e),eo(t))}getAll(e){return this.container.getAll(to(e))}getAllNamed(e,t){return this.container.getAllNamed(to(e),eo(t))}isBound(e){return this.container.isBound(to(e))}isBoundNamed(e,t){return this.container.isBoundNamed(to(e),eo(t))}createChild(){const e=this.container.createChild(),t=new yh(e);return t.parent=this,t}register(e,t={}){Bi.isInjectOption(e)?fo.resolveOption(this.container,e):fo.resolveTarget(this.container,e,t),this.onRegisteredEmitter.fire()}}const bh=new yh(ro),_h=bh.register.bind(bh),wh=e=>(t,r,n)=>{so(e)(t,r,n),ao(ho)(t,r,n)};var Ch;(e=>{e.Provider=ho,e.register=Eo})(Ch||(Ch={}));const Eh=Jo.Infra("di");function Sh(e){const t=function(e){return e.name||e.toString()}(e.serviceIdentifier);Eh(`依赖 ${t} 耗时：${e.time} ms`,e)}var kh=(e=>(e[e.Waiting=-1]="Waiting",e[e.Init=0]="Init",e[e.Configed=1]="Configed",e[e.Inited=2]="Inited",e[e.WorkbenchInited=3]="WorkbenchInited",e[e.Starting=4]="Starting",e[e.Ready=5]="Ready",e[e.RecordInit=6]="RecordInit",e[e.RecordReady=7]="RecordReady",e[e.Rendered=8]="Rendered",e[e.beforeDestroy=9]="beforeDestroy",e[e.Destroyed=10]="Destroyed",e))(kh||{});const xh=$i.defineToken("LifecycleService"),Oh=null;var Ih=Object.defineProperty,Rh=Object.getOwnPropertyDescriptor;const Th={[kh.Waiting]:"Waiting",[kh.Init]:"Init",[kh.Configed]:"Configed",[kh.Inited]:"Inited",[kh.Starting]:"Starting",[kh.Ready]:"Ready",[kh.RecordInit]:"RecordInit",[kh.RecordReady]:"RecordReady",[kh.Rendered]:"Rendered",[kh.WorkbenchInited]:"WorkbenchInited",[kh.beforeDestroy]:"beforeDestroy",[kh.Destroyed]:"Destroyed"};let Ah=class{constructor(){this._status=kh.Waiting,this.statusWhen=new Map,this._statusChangedAt=new Map}get statusStr(){return Th[this.status]}get status(){return this._status}set status(e){if(e<this.status){const t=JSON.stringify({current:this.status,setStatus:e});throw new Error("Lifecycle cannot go backwards"+t)}this.status!==e&&(this._status=e,this._statusChangedAt.set(e,+new Date),this._runCallback())}when(e,t){if(e<=this.status)return;const r=this.statusWhen.get(e);if(Array.isArray(r)){const n=[...r,t];this.statusWhen.set(e,n)}else this.statusWhen.set(e,[t])}_runCallback(){const e=this.statusWhen.get(this.status);!e||e.length&&e.forEach((e=>{e()}))}getStatusChangedAt(e){return this._statusChangedAt.get(e)}};Ah=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rh(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ih(t,r,o),o})([io({token:xh})],Ah);const Mh=/\$(\d+)/g;const Nh=class{static setLanguage(e){Nh._lang="enUS"===e||"en-US"===e||"en"===e||"en-us"===e?"enUS":"zhCN"}static setData(e={}){Nh._data={...Nh._data,...e}}static get(e,...t){return t.length?(e="zhCN"===Nh._lang?e:Nh._data[e]||e)?((t=t.map((e=>"zhCN"===Nh._lang?e:Nh._data[e]||t))).unshift(""),e.replace(Mh,((e,r)=>t[r]||""))):"":"zhCN"===Nh._lang?e:Nh._data[e]||e}};let Dh=Nh;function Ph(e,...t){return Dh.get(e,...t)}Dh._lang="zhCN",Dh._data={},Dh.setLanguage(function(){var e;const t="zh-cn";if(typeof window<"u"&&typeof document<"u"){if(null!=(e=window.appData)&&e.locale)return window.appData.locale;const r=window.location.search,n=new URLSearchParams(r).get("language");if(n)return n;const i=document.cookie.match(/(?:^|; ?)lang=([^;]+)(?:;|$)/);return i?i[1]:t}return t}()||"zhCN");const jh=$i.defineToken("DriverToken");var Fh=(e=>(e.Pending="pending",e.Runing="Runing",e))(Fh||{});const Vh=null,Lh=$i.defineToken("ModelEventToken"),$h=$i.defineToken("ModelInitialToken");var Bh=(e=>(e.SELECT="select",e.INSERT="insert",e.UPDATE="update",e.DELETE="delete",e.UPSERT="upsert",e.BULK_INSERT="bulkInsert",e.MOVE_BEFORE="moveBefore",e.MOVE_AFTER="moveAfter",e.INSERT_AFTER="insertAfter",e.INSERT_BEFORE="insertBefore",e))(Bh||{});const Uh=null,zh=$i.defineToken("StorageToken"),Hh=null;var Wh=Object.defineProperty,Gh=Object.getOwnPropertyDescriptor,Kh=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gh(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wh(t,r,o),o};let qh=class{read(e){return this._storage.getData(e.table,e.where)}};Kh([ao(zh)],qh.prototype,"_storage",2),qh=Kh([io()],qh);class Yh{constructor(e){this._arr=[],Array.isArray(e)?e.forEach((e=>this._arr.push(e))):e&&this._arr.push(e)}get origin(){return this._arr}get length(){return this._arr.length}clone(){const e=new Yh;return this._arr.forEach((t=>{e.push([Object.assign({},t)])})),e}insert(e){}push(e){for(const t of e)this._arr.push(t)}get(e){return this._arr[e]}toArray(){return this._arr}slice(e=0,t=this.length){return this._arr.slice(e,t)}toJSON(){return JSON.parse(JSON.stringify(this._arr))}map(e){return this._arr.map(e)}forEach(e){return this._arr.forEach(e)}delete(e,t){return this._arr.splice(e,t)}unshift(e){for(const t of e)this._arr.unshift(t);return this._arr}[Symbol.iterator](){return function(e){let t=0;return{[Symbol.iterator](){return this},next:()=>{if(0===e.origin.length||null==e.origin[t])return{done:!0,value:void 0};const r=e.origin[t];return t+=1,{done:!1,value:r}}}}(this)}}var Jh=Object.defineProperty,Xh=Object.getOwnPropertyDescriptor;let Zh=class{where(e,t,r){if(r&&r.length>0&&(e=this.getDataByIndexes(e,t,r)),t){const e=Object.keys(t);for(const r of e)if(Array.isArray(t[r])){const e={};for(let n=0;n<t[r].length;n++)e[t[r][n]]=!0;t[`$__${r}`]=e}}if(!e)return new Yh;const n=new Yh;return e.forEach((e=>{this._matchRow(e,t)&&n.push([e])})),n}findIndex(e,t,r){if(r&&(e=this.getDataByIndexes(e,t,r)),t){const e=Object.keys(t);for(const r of e)if(Array.isArray(t[r])){const e={};for(let n=0;n<t[r].length;n++)e[t[r][n]]=!0;t[`$__${r}`]=e}}return e?e.findIndex((e=>this._matchRow(e,t))):-1}getDataByIndexes(e,t,r){if(!e)return new Yh;const n=new Yh;if(2===r.length){let i=[],o=null==t?void 0:t[r[0]];o?Array.isArray(o)||(o=[o]):o=e.keys();for(const t of o){const r=e.get(t);r&&(i=i.concat(r))}let a=null==t?void 0:t[r[1]];a?Array.isArray(a)||(a=[a]):a=i.reduce(((e,t)=>(t&&(e=e.concat(Array.from(t.keys()))),e)),[]);for(const e of a)for(const t of i){const r=t.get(e);r&&n.push(r)}}else{let i=null==t?void 0:t[r[0]];i?Array.isArray(i)||(i=[i]):i=Array.from(e.keys());for(const t of i){const r=e.get(t);r&&n.push(r)}}return n}_matchRow(e,t){let r=!1;if(!t)return!0;const n=Object.keys(t);if(0===n.length||!t)return!0;for(const i of n)if(!i.startsWith("$__")&&(r=this._match(e,i,t),!r))return!1;return r}_match(e,t,r){var n;let i=r[t];return null!=i&&i.$not?(i=i.$not,Array.isArray(i)?!i.find((r=>r==e.get(t))):e.get(t)!=i):Array.isArray(i)?!(null==(n=r[`$__${t}`])||!n[e.get(t)]):e.get(t)==i}};Zh=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xh(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jh(t,r,o),o})([io()],Zh);var Qh=Object.defineProperty,ep=Object.getOwnPropertyDescriptor,tp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ep(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Qh(t,r,o),o};let rp=class{write(e){var t,r,n,i,o,a,s,l;const c=e.table,u=e.sets,d=this._storage.getOriginData(c)||new Yh,f=this._storage.getIndexes(c);if(e.command===Bh.UPSERT){const t=this._dataHelper.where(d,e.where,f);return t&&0!==t.length?(this._storage.update(c,t,u),u):(u.uuid||(u.uuid=To(32)),this._storage.append(c,u),u)}if(e.command===Bh.UPDATE){const t=this._dataHelper.where(d,e.where,f);return this._storage.update(c,t,u),u}if(e.command===Bh.INSERT)return u.uuid||(u.uuid=To(32)),this._storage.append(c,u),u;if(e.command===Bh.INSERT_AFTER){const n=Array.isArray(u)?u[0]:u;if(null!=(t=this._dataHelper.where(d,n,f))&&t.get(0))return;let i;return e.where&&(i=null==(r=this._dataHelper.where(d,e.where,f))?void 0:r.get(0)),this._storage.append(c,n,i),n}if(e.command===Bh.INSERT_BEFORE){const t=Array.isArray(u)?u[0]:u;if(null!=(n=this._dataHelper.where(d,t,f))&&n.get(0))return;let r;return e.where&&(r=null==(i=this._dataHelper.where(d,e.where,f))?void 0:i.get(0)),this._storage.before(c,t,r),t}if(e.command===Bh.DELETE){const t=this._dataHelper.where(d,e.where,f);return this._storage.remove(c,t),u}if(e.command===Bh.BULK_INSERT){for(const e of u)e.uuid||(e.uuid=To(32));for(const e of u)this._storage.append(c,e);return u}if(e.command===Bh.MOVE_AFTER){const t=Array.isArray(u)?u[0]:u,r=null==(o=this._dataHelper.where(d,t,f))?void 0:o.get(0);if(!r)return;let n;e.where&&(n=null==(a=this._dataHelper.where(d,e.where,f))?void 0:a.get(0));const i=r.toJSON();return n?(this._storage.remove(c,[r]),this._storage.append(c,i,n),[n,r]):(this._storage.remove(c,[r]),this._storage.append(c,i),[r])}if(e.command===Bh.MOVE_BEFORE){const t=Array.isArray(u)?u[0]:u,r=null==(s=this._dataHelper.where(d,t,f))?void 0:s.get(0);if(!r)return;let n;e.where&&(n=null==(l=this._dataHelper.where(d,e.where,f))?void 0:l.get(0));const i=r.toJSON();return n?(this._storage.remove(c,[r]),this._storage.before(c,i,n),[r,n]):(this._storage.remove(c,[r]),this._storage.before(c,i),[r])}return null}};tp([ao(zh)],rp.prototype,"_storage",2),tp([ao(Zh)],rp.prototype,"_dataHelper",2),rp=tp([io()],rp);var np=Object.defineProperty,ip=Object.getOwnPropertyDescriptor,op=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ip(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&np(t,r,o),o};let ap=class{constructor(){this._status=Fh.Pending,this._tableMap={}}initTable(e){this._tableMap[e.name]=e,this._storage.setTable(e.name,e.columns,e.indexes)}get tables(){return Object.values(this._tableMap)}get status(){return this._status}set status(e){this._status=e}execute(e,t={}){if(e.command===Bh.SELECT)return this._read(e);if(e.command===Bh.INSERT||e.command===Bh.UPDATE||e.command===Bh.UPSERT||e.command===Bh.DELETE||e.command===Bh.BULK_INSERT||e.command===Bh.MOVE_AFTER||e.command===Bh.MOVE_BEFORE||e.command===Bh.INSERT_AFTER||e.command===Bh.INSERT_BEFORE)return t.slient?this._modelEvent.emitChangeWithSilent({spell:e}):this._modelEvent.emitChange({spell:e}),this._modelEvent.emitChangeAllways({spell:e}),this._write(e);throw new Error(`${e.command} 指令没有实现驱动`)}_read(e){const t=this._driverRead.read(e);return this._parseRes(t)}_write(e){const t=this._driverWrite.write(e);return this._parseRes(t)}_parseRes(e){let t=0;return e?(t=Array.isArray(e)?e.length:1,{rows:e,rowCount:t}):{rows:new Yh,rowCount:t}}};op([ao(zh)],ap.prototype,"_storage",2),op([ao(qh)],ap.prototype,"_driverRead",2),op([ao(rp)],ap.prototype,"_driverWrite",2),op([ao(Lh)],ap.prototype,"_modelEvent",2),ap=op([io({token:jh})],ap);const sp=null,lp=$i.defineToken("ConfigurationToken"),cp=null;var up=Object.defineProperty,dp=Object.getOwnPropertyDescriptor;let fp=class{constructor(){this._store=new Set,this._isDestroyed=!1}_register(e){return this._store.add(e),e}destroy(){if(this._isDestroyed)return;const e=this._store.values();for(const t of e)!t||t.destroy();this._store.clear(),this._isDestroyed=!0}};fp=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&up(t,r,o),o})([no()],fp);class hp{constructor(){this.destroy=()=>{},this.unset=()=>{},this.isset=()=>!1}set(e){let t=e;return this.unset=()=>t=void 0,this.isset=()=>void 0!==t,this.destroy=()=>{t&&(t(),t=void 0,this.unset=void 0,this.isset=void 0)},this}}var pp;(e=>{function t(e){return{destroy:e}}e.is=function(e){return!!e&&"object"==typeof e&&"destroy"in e&&"function"==typeof e.destroy},e.create=t,e.NONE=t((()=>{}))})(pp||(pp={}));class gp{constructor(){this.destroyableList=[],this._isDisposing=!1}get destroyed(){return 0===this.destroyableList.length}destroy(){if(!this.destroyed&&!this._isDisposing){for(this._isDisposing=!0;!this.destroyed;)try{this.destroyableList.pop().destroy()}catch(e){console.error(e)}this._isDisposing=!1}}push(e){const{destroyableList:t}=this;t.push(e);const r=e.destroy.bind(e),n=pp.create((()=>{const r=t.indexOf(e);-1!==r&&t.splice(r,1)}));return e.destroy=()=>{n.destroy(),r()},n}}class mp{constructor(e,t,r){this.callback=e,this.callbackThis=t,this.stack=r,this.subscription=new hp}invoke(e){this.callback.call(this.callbackThis,e)}}class vp{constructor(e,t,r){this.emitter=e,this.listener=t,this.event=r}}class yp{constructor(){this._queue=new va}get size(){return this._queue.size}push(e,t,r){this._queue.push(new vp(e,t,r))}clear(e){const t=new va;for(const r of this._queue)r.emitter!==e&&t.push(r);this._queue=t}deliver(){for(;this._queue.size>0;){const e=this._queue.shift();try{e.listener.invoke(e.event)}catch(e){console.error(e)}}}}class bp extends yp{clear(e){this._queue.clear()}}class _p extends fp{constructor(){super(...arguments),this._id=To(6),this._disposed=!1}get event(){return this._event||(this._event=(e,t,r)=>{this._listeners||(this._listeners=new va);const n=new mp(e,t,undefined),i=this._listeners.push(n),o=n.subscription.set((()=>{this._disposed||i()}));return Array.isArray(r)&&r.push(o),o}),this._event}get id(){return this._id}get listeners(){return this._listeners?this._listeners:null}destroy(){var e;this._disposed||(this._disposed=!0,this._listeners&&this._listeners.clear(),null==(e=this._deliveryQueue)||e.clear(this))}emit(e){if(this.listeners){this._deliveryQueue||(this._deliveryQueue=new bp);for(const t of this.listeners)this._deliveryQueue.push(this,t,e);this._deliveryQueue.deliver()}}hasListeners(){return!!this._listeners&&!this._listeners.isEmpty()}}const wp=/\\(\\)?/g,Cp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var Ep=Object.defineProperty,Sp=Object.getOwnPropertyDescriptor;let kp=class{constructor(){this._configurationProperties={}}getSchema(){return{title:"数据表配置列表",type:"object",properties:this._configurationProperties}}register(e){this._doRegister(e)}_doRegister(e){const t=e.id;if(!t)throw new Error(`配置不合法: ${JSON.stringify(e)}, configuration.id 是必填`);const r=t.split(".");if(1===r.length)this._configurationProperties[r[0]]=e;else{this._configurationProperties[r[0]]?this._configurationProperties[r[0]].properties||(this._configurationProperties[r[0]].properties={}):this._configurationProperties[r[0]]={id:r[0],type:"object",properties:{}};let t=this._configurationProperties[r[0]].properties;r.forEach(((n,i)=>{if(0!==i)if(t[n])t[n].properties||(t[n].properties={}),t=t[n].properties;else if(i===r.length-1)t[n]=e;else{const e=r.slice(i+1);t[n]={id:e.join("."),type:"object",properties:{}}}}))}}getProperty(e){const t=(e=>{const t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Cp,(function(e,r,n,i){t.push(n?i.replace(wp,"$1"):r||e)})),t})(e),[r,...n]=t;let i=this._configurationProperties[r],o=r;for(let e=0;e<n.length;e++){const t=n[e];if(o+="."+t,!i)return null;if(/^\d+$/g.test(t))i=null==i?void 0:i.items;else if(i.properties){const e=Object.keys(i.properties);let n=!1;for(let t=0;t<e.length;t++){const a=e[t],s=r+"."+a;if(s===o){i=i.properties[a],n=!0;break}if(s.startsWith(o)){n=!0;break}}if(n)continue;i=i.properties[t]}}return i}validate(e,t){return!!this.getProperty(e)}};kp=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ep(t,r,o),o})([io()],kp);var xp=Object.defineProperty,Op=Object.getOwnPropertyDescriptor,Ip=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Op(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xp(t,r,o),o};let Rp=class extends fp{constructor(){super(...arguments),this._defaultModel={},this._overrideModel={},this._onDidChange=this._register(new _p),this.onDidChange=this._onDidChange.event}registerDefaultValue(e){const t=Object.keys(e);for(const r of t)this._configurationRegistry.validate(r,e[r]);for(const r of t)Xd(this._defaultModel,r,e[r])}setValue(e,t){this._configurationRegistry.validate(e,t);const r=this.getValue(e);return Oo((()=>{this._onDidChange.emit({type:"valueChanged",path:e,pre:r,cur:t})})),Xd(this._overrideModel,e,t)}getValue(e){if(!e)return this.getValues();this._configurationRegistry.validate(e);const t=ic(this._overrideModel,e);return void 0!==t?t:ic(this._defaultModel,e)}getValues(){return Bd({},this._defaultModel,this._overrideModel)}destroy(){super.destroy()}};Ip([ao(kp)],Rp.prototype,"_configurationRegistry",2),Ip([Ii()],Rp.prototype,"destroy",1),Rp=Ip([io()],Rp);var Tp=Object.defineProperty,Ap=Object.getOwnPropertyDescriptor,Mp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ap(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Tp(t,r,o),o};let Np=class extends fp{constructor(){super(...arguments),this._onConfigurationChange=this._register(new _p),this.onConfigurationChange=this._onConfigurationChange.event}registerConfiguration(e){this._configurationRegistry.register(e)}registerDefaultValue(e){this._configurationModel.registerDefaultValue(e)}setValue(e,t){if("object"==typeof e){const t=Object.keys(e);for(const r of t)this._configurationModel.setValue(r,e[r])}else"string"==typeof e&&this._configurationModel.setValue(e,t);this._onConfigurationChange.emit({key:e,value:t})}getValue(e){return this._configurationModel.getValue(e)}getAllValues(){return this._configurationModel.getValues()}getSchema(){return this._configurationRegistry.getSchema()}onValueChange(e){this._configurationModel.onDidChange((t=>{"valueChanged"===t.type&&e(t)}))}destroy(){super.destroy()}};Mp([ao(kp)],Np.prototype,"_configurationRegistry",2),Mp([ao(Rp)],Np.prototype,"_configurationModel",2),Mp([Ii()],Np.prototype,"destroy",1),Np=Mp([io({token:lp})],Np);const Dp=xo().register(kp).register(Rp).register(Np),Pp=$i.defineToken("StructToken"),jp=null;function Fp(e,t){for(const r of e)if(t(r))return r;return null}function Vp(e,t){const r=new Yh;for(const n of e)t(n)&&r.push([n]);return r}function Lp(e,t){let r=-1;return e.forEach(((e,n)=>{-1===r&&t(e)&&(r=n)})),r}function $p(e,t,r){return e.forEach((e=>{t(r,e)})),r}function Bp(e,t){const r=[];return e.forEach(((e,n)=>{r.push(t(e,n))})),r}function Up(e){const t=[];for(const r of e)t.unshift(r);return t}function zp(e,t){for(const r of e)if(t(r))return!0;return!1}function Hp(e,t,r){return e.slice(t,r)}function Wp(e,t){for(const r of e)if(!t(r))return!1;return!0}function Gp(e,t){const r=new Map;for(const n of e)r.set(n.get(t),n);return r}class Kp{constructor(e){this._map=new Map,e&&Object.keys(e).forEach((t=>{this.set(t,e[t])}))}clone(){return this}keys(){return this._map.keys()}set(e,t){return this._map.set(e,t)}get(e){return this._map.get(e)}has(e){return this._map.has(e)}delete(e){return this._map.delete(e)}values(){return this._map.values()}entries(){return this._map.entries()}forEach(e){return this._map.forEach(e)}toJSON(){return Object.fromEntries(this._map)}[Symbol.iterator](){return this._map[Symbol.iterator]()}get uuid(){return this.get("uuid")}get updated_at(){return this.get("updated_at")}get created_at(){return this.get("created_at")}}var qp=Object.defineProperty,Yp=Object.getOwnPropertyDescriptor,Jp=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Yp(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qp(t,r,o),o},Xp=(e=>(e.INIT="init",e))(Xp||{});let Zp=class{constructor(){this._onBeforeChange=new _p,this.onBeforeChange=this._onBeforeChange.event}init(){}get root(){return this._struct.data||new Kp}getIndexes(e){var t;return(null==(t=this.root.get(e))?void 0:t.get("indexes"))||[]}getColumns(e){var t;return(null==(t=this.root.get(e))?void 0:t.get("columns"))||[]}setTable(e,t,r){let n=this.root.get(e);n||(n=this._struct.newMap(),this.root.set(e,n));const i=[];for(const e of t)e.uuid||(e.uuid=To(32)),i.push(e);n.set("columns",i),n.set("indexes",r)}dropTable(e){this.root.delete(e)}setData(e,t){var r;const n=this.getIndexes(e),i=this.getColumns(e);this._filterColumns(t),this._onBeforeChange.emit({type:"init",table:e,data:t});const o=this.root.get(e);if(o){if(n&&n.length>0){const e=this._struct.newMap(null,i);o.set("data",e);for(const o of t)if(2===n.length){const t=o[n[0]],a=o[n[1]];if(!e.get(t)){const r=this._struct.newMap(null,i);r.set(a,this._struct.newArray()),e.set(t,r)}null!=(r=e.get(t))&&r.get(a)||e.get(t).set(a,this._struct.newArray());if(Fp(e.get(t).get(a),(e=>(null==e?void 0:e.get("uuid"))===o.uuid)))continue;e.get(t).get(a).push([this._struct.newMap(o,i)])}else{const t=o[n[0]];let r=e.get(t);r||(r=this._struct.newArray(),e.set(t,r)),r.push([this._struct.newMap(o,i)])}}else o.set("data",this._struct.newArray(t));return t}}update(e,t,r){const n=this.getIndexes(e),i=this.getColumns(e),o=this.root.get(e);if(!o)return;let a=o.get("data");for(const e of t)if(n&&n.length>0)if(a||(a=this._struct.newMap(null,i),o.set("data",a)),2===n.length){const t=e.get(n[0]),i=e.get(n[1]),o=Fp(a.get(t).get(i),(t=>t.get("uuid")===e.get("uuid")));if(!o)continue;for(const e in r)o.set(e,r[e])}else{const t=e.get(n[0]),i=a.get(t);if(!i)continue;const o=Fp(i,(t=>t.get("uuid")===e.get("uuid")));for(const e in r)o.set(e,r[e])}else{const t=Fp(a,(t=>t.get("uuid")===e.get("uuid")));if(!t)continue;for(const e in r)t.set(e,r[e])}}append(e,t,r){var n;const i=this.getIndexes(e),o=this.getColumns(e),a=this.root.get(e);if(!a)return;let s=a.get("data");if(this._filterColumns(t),i&&i.length>0)if(s||(s=this._struct.newMap(null,o),a.set("data",s)),2===i.length){const e=t[i[0]],a=t[i[1]];if(!s.get(e)){const t=this._struct.newMap(null,o);t.set(a,this._struct.newArray()),s.set(e,t)}null!=(n=s.get(e))&&n.get(a)||s.get(e).set(a,this._struct.newArray());const l=s.get(e).get(a);if(r){const e=Lp(l,(e=>e.get("uuid")===r.get("uuid")));if(e>-1)return void l.insert(e+1,[this._struct.newMap(t,o)])}if(Fp(l,(e=>e.get("uuid")===t.uuid)))return;l.push([this._struct.newMap(t,o)])}else{const e=t[i[0]];if(s.get(e)||s.set(e,this._struct.newArray()),r){const n=Lp(s.get(r.get(i[0])),(e=>e.get("uuid")===r.get("uuid")));if(n>-1)return void s.get(e).insert(n+1,[this._struct.newMap(t,o)])}if(Fp(s.get(e),(e=>e.get("uuid")===t.uuid)))return;s.get(e).push([this._struct.newMap(t,o)])}else{if(s||(s=this._struct.newArray(),a.set("data",s)),r){const e=Lp(s,(e=>e.get("uuid")===r.get("uuid")));if(e>-1)return void s.insert(e+1,[this._struct.newMap(t,o)])}if(Fp(s,(e=>e.get("uuid")===t.uuid)))return;s.push([this._struct.newMap(t,o)])}}before(e,t,r){const n=this.getIndexes(e),i=this.getColumns(e);t=this._filterColumns(t);const o=this.root.get(e);if(!o)return;let a=o.get("data");if(n&&n.length>0)if(a||(a=this._struct.newMap(null,i),o.set("data",a)),2===n.length){const e=t[n[0]],o=t[n[1]];if(!a.get(e)){const t=this._struct.newMap(null,i);t.set(o,this._struct.newArray()),a.set(e,t)}if(a.get(e).get(o)||a.get(e).set(o,this._struct.newArray()),r){const n=Lp(a.get(e).get(o),(e=>e.get("uuid")===r.get("uuid")));if(n>-1)return void a.get(e).get(o).insert(n,[this._struct.newMap(t,i)])}if(Fp(a.get(e).get(o),(e=>e.get("uuid")===t.uuid)))return;a.get(e).get(o).unshift([this._struct.newMap(t,i)])}else{const e=t[n[0]];if(a.get(e)||a.set(e,this._struct.newArray()),r){const o=Lp(a.get(r.get(n[0])),(e=>e.get("uuid")===r.get("uuid")));if(o>-1)return void a.get(e).insert(o,[this._struct.newMap(t,i)])}if(Fp(a.get(e),(e=>e.get("uuid")===t.uuid)))return;a.get(e).unshift([this._struct.newMap(t,i)])}else{if(a||(a=this._struct.newArray(),o.set("data",a)),r){const e=Lp(a,(e=>e.get("uuid")===r.get("uuid")));if(e>-1)return void a.insert(e,[this._struct.newMap(t,i)])}if(Fp(a,(e=>e.get("uuid")===t.uuid)))return;a.unshift([this._struct.newMap(t,i)])}}remove(e,t){var r,n,i;const o=this.getIndexes(e),a=this.getColumns(e),s=this.root.get(e);if(!s)return;let l=s.get("data");for(const e of t)if(o&&o.length>0)if(l||(l=this._struct.newMap(null,a),s.set("data",l)),2===o.length){const t=e.get(o[0]),a=e.get(o[1]),s=null==(r=l.get(t))?void 0:r.get(a);if(!s)continue;const c=Lp(s,(t=>t.get("uuid")===e.get("uuid")));s.delete(c),0===s.length&&(null==(n=l.get(t))||n.delete(a)),0===(null==(i=l.get(t))?void 0:i.size)&&l.delete(t)}else{const t=e.get(o[0]),r=l.get(t);if(!r)continue;const n=Lp(r,(t=>t.get("uuid")===e.get("uuid")));r.delete(n),0===r.length&&l.delete(t)}else{const t=Lp(l,(t=>t.get("uuid")===e.get("uuid")));l.delete(t)}}getData(e,t){var r,n;const i=null==(n=null==(r=this.root)?void 0:r.get(e))?void 0:n.get("data");if(!i)return new Yh;const o=this.getIndexes(e);return t?this._queryHelper.where(i,t,o)||new Yh:o&&o.length>0?this._queryHelper.getDataByIndexes(i,t,o)||new Yh:i}getOriginData(e){return this.root.get(e).get("data")}getAll(){return this.root.toJSON()}clear(e){const t=this._configuration.getValue("model.frozenTable");return(e||Array.from(this.root.keys())).forEach((e=>{var r;null!=t&&t.includes(e)||null==(r=this.root.get(e))||r.delete("data")})),this}_filterColumns(e){const t=e=>{e._map&&(e=e.toJSON()),e.uuid||(e.uuid=To(32));const t=new Date;return e.created_at?Vo(e.created_at)&&(e.created_at=e.created_at.getTime()):e.created_at=+t,e.updated_at?Vo(e.updated_at)&&(e.updated_at=e.updated_at.getTime()):e.updated_at=+t,e};if(!Array.isArray(e))return t(e);for(const r of e)t(r);return e}destroy(){var e,t;null==(e=this._webrtc)||e.disconnect(),null==(t=this._ws)||t.disconnect(),this._struct.destroy(),this._webrtc=null,this._ws=null}};Jp([ao(lp)],Zp.prototype,"_configuration",2),Jp([ao(Zh)],Zp.prototype,"_queryHelper",2),Jp([ao(Pp)],Zp.prototype,"_struct",2),Jp([Oi()],Zp.prototype,"init",1),Jp([Ii()],Zp.prototype,"destroy",1),Zp=Jp([io({token:zh})],Zp);const Qp=null,eg=$i.defineToken("ModelContribution"),tg=null,rg=$i.defineToken("HistoryToken"),ng=null,ig=()=>new Map,og=e=>{const t=ig();return e.forEach(((e,r)=>{t.set(r,e)})),t},ag=(e,t,r)=>{let n=e.get(t);return void 0===n&&e.set(t,n=r()),n},sg=()=>new Set,lg=e=>e[e.length-1],cg=(e,t)=>{for(let r=0;r<t.length;r++)e.push(t[r])},ug=Array.from,dg=Array.isArray;class fg{constructor(){this._observers=ig()}on(e,t){return ag(this._observers,e,sg).add(t),t}once(e,t){const r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){const r=this._observers.get(e);void 0!==r&&(r.delete(t),0===r.size&&this._observers.delete(e))}emit(e,t){return ug((this._observers.get(e)||ig()).values()).forEach((e=>e(...t)))}destroy(){this._observers=ig()}}class hg{constructor(){this._observers=ig()}on(e,t){ag(this._observers,e,sg).add(t)}once(e,t){const r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){const r=this._observers.get(e);void 0!==r&&(r.delete(t),0===r.size&&this._observers.delete(e))}emit(e,t){return ug((this._observers.get(e)||ig()).values()).forEach((e=>e(...t)))}destroy(){this._observers=ig()}}const pg=Math.floor,gg=Math.abs,mg=Math.log10,vg=(e,t)=>e<t?e:t,yg=(e,t)=>e>t?e:t,bg=e=>0!==e?e<0:1/e<0,_g=64,wg=128,Cg=127,Eg=Number.MAX_SAFE_INTEGER,Sg=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&pg(e)===e),kg=String.fromCharCode,xg=/^\s*/g,Og=/([A-Z])/g,Ig=(e,t)=>(e=>e.replace(xg,""))(e.replace(Og,(e=>`${t}${(e=>e.toLowerCase())(e)}`))),Rg=typeof TextEncoder<"u"?new TextEncoder:null,Tg=Rg?e=>Rg.encode(e):e=>{const t=unescape(encodeURIComponent(e)),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.codePointAt(e);return n};let Ag=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Ag&&1===Ag.decode(new Uint8Array).length&&(Ag=null);const Mg=(e,t)=>((e,t)=>{const r=new Array(e);for(let n=0;n<e;n++)r[n]=t(n,r);return r})(t,(()=>e)).join("");class Ng{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Dg=()=>new Ng,Pg=e=>{const t=new Uint8Array((e=>{let t=e.cpos;for(let r=0;r<e.bufs.length;r++)t+=e.bufs[r].length;return t})(e));let r=0;for(let n=0;n<e.bufs.length;n++){const i=e.bufs[n];t.set(i,r),r+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),r),t},jg=(e,t)=>{const r=e.cbuf.length;e.cpos===r&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*r),e.cpos=0),e.cbuf[e.cpos++]=t},Fg=jg,Vg=(e,t)=>{for(;t>Cg;)jg(e,wg|Cg&t),t=pg(t/128);jg(e,Cg&t)},Lg=(e,t)=>{const r=bg(t);for(r&&(t=-t),jg(e,(t>63?wg:0)|(r?_g:0)|63&t),t=pg(t/64);t>0;)jg(e,(t>Cg?wg:0)|Cg&t),t=pg(t/128)},$g=new Uint8Array(3e4),Bg=$g.length/3,Ug=Rg&&Rg.encodeInto?(e,t)=>{if(t.length<Bg){const r=Rg.encodeInto(t,$g).written||0;Vg(e,r);for(let t=0;t<r;t++)jg(e,$g[t])}else Hg(e,Tg(t))}:(e,t)=>{const r=unescape(encodeURIComponent(t)),n=r.length;Vg(e,n);for(let t=0;t<n;t++)jg(e,r.codePointAt(t))},zg=(e,t)=>{const r=e.cbuf.length,n=e.cpos,i=vg(r-n,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),n),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(yg(2*r,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},Hg=(e,t)=>{Vg(e,t.byteLength),zg(e,t)},Wg=(e,t)=>{((e,t)=>{const r=e.cbuf.length;r-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*yg(r,t)),e.cpos=0)})(e,t);const r=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,r},Gg=new DataView(new ArrayBuffer(4)),Kg=(e,t)=>{switch(typeof t){case"string":jg(e,119),Ug(e,t);break;case"number":Sg(t)&&gg(t)<=2147483647?(jg(e,125),Lg(e,t)):(e=>(Gg.setFloat32(0,e),Gg.getFloat32(0)===e))(t)?(jg(e,124),((e,t)=>{Wg(e,4).setFloat32(0,t,!1)})(e,t)):(jg(e,123),((e,t)=>{Wg(e,8).setFloat64(0,t,!1)})(e,t));break;case"bigint":jg(e,122),((e,t)=>{Wg(e,8).setBigInt64(0,t,!1)})(e,t);break;case"object":if(null===t)jg(e,126);else if(dg(t)){jg(e,117),Vg(e,t.length);for(let r=0;r<t.length;r++)Kg(e,t[r])}else if(t instanceof Uint8Array)jg(e,116),Hg(e,t);else{jg(e,118);const r=Object.keys(t);Vg(e,r.length);for(let n=0;n<r.length;n++){const i=r[n];Ug(e,i),Kg(e,t[i])}}break;case"boolean":jg(e,t?120:121);break;default:jg(e,127)}};class qg extends Ng{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Vg(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Yg=e=>{e.count>0&&(Lg(e.encoder,1===e.count?e.s:-e.s),e.count>1&&Vg(e.encoder,e.count-2))};class Jg{constructor(){this.encoder=new Ng,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Yg(this),this.count=1,this.s=e)}toUint8Array(){return Yg(this),Pg(this.encoder)}}const Xg=e=>{if(e.count>0){const t=2*e.diff+(1===e.count?0:1);Lg(e.encoder,t),e.count>1&&Vg(e.encoder,e.count-2)}};class Zg{constructor(){this.encoder=new Ng,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Xg(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Xg(this),Pg(this.encoder)}}class Qg{constructor(){this.sarr=[],this.s="",this.lensE=new Jg}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Ng;return this.sarr.push(this.s),this.s="",Ug(e,this.sarr.join("")),zg(e,this.lensE.toUint8Array()),Pg(e)}}const em=e=>new Error(e),tm=()=>{throw em("Method unimplemented")},rm=()=>{throw em("Unexpected case")},nm=em("Unexpected end of array"),im=em("Integer out of Range");class om{constructor(e){this.arr=e,this.pos=0}}const am=e=>new om(e),sm=e=>e.pos!==e.arr.length,lm=e=>((e,t)=>{const r=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,r})(e,um(e)),cm=e=>e.arr[e.pos++],um=e=>{let t=0,r=1;const n=e.arr.length;for(;e.pos<n;){const n=e.arr[e.pos++];if(t+=(n&Cg)*r,r*=128,n<wg)return t;if(t>Eg)throw im}throw nm},dm=e=>{let t=e.arr[e.pos++],r=63&t,n=64;const i=(t&_g)>0?-1:1;if(0==(t&wg))return i*r;const o=e.arr.length;for(;e.pos<o;){if(t=e.arr[e.pos++],r+=(t&Cg)*n,n*=128,t<wg)return i*r;if(r>Eg)throw im}throw nm},fm=Ag?e=>Ag.decode(lm(e)):e=>{let t=um(e);if(0===t)return"";{let r=String.fromCodePoint(cm(e));if(--t<100)for(;t--;)r+=String.fromCodePoint(cm(e));else for(;t>0;){const n=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+n);e.pos+=n,r+=String.fromCodePoint.apply(null,i),t-=n}return decodeURIComponent(escape(r))}},hm=(e,t)=>{const r=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,r},pm=[e=>{},e=>null,dm,e=>hm(e,4).getFloat32(0,!1),e=>hm(e,8).getFloat64(0,!1),e=>hm(e,8).getBigInt64(0,!1),e=>!1,e=>!0,fm,e=>{const t=um(e),r={};for(let n=0;n<t;n++){r[fm(e)]=gm(e)}return r},e=>{const t=um(e),r=[];for(let n=0;n<t;n++)r.push(gm(e));return r},lm],gm=e=>pm[127-cm(e)](e);class mm extends om{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),sm(this)?this.count=um(this)+1:this.count=-1),this.count--,this.s}}class vm extends om{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=dm(this);const e=bg(this.s);this.count=1,e&&(this.s=-this.s,this.count=um(this)+2)}return this.count--,this.s}}class ym extends om{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const e=dm(this),t=1&e;this.diff=pg(e/2),this.count=1,t&&(this.count=um(this)+2)}return this.s+=this.diff,this.count--,this.s}}class bm{constructor(e){this.decoder=new vm(e),this.str=fm(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const _m=crypto.getRandomValues.bind(crypto),wm=Math.random,Cm=()=>_m(new Uint32Array(1))[0],Em=[1e7]+-1e3+-4e3+-8e3+-1e11,Sm=()=>Em.replace(/[018]/g,(e=>(e^Cm()&15>>e/4).toString(16))),km=Date.now,xm=e=>new Promise(e);Promise.all.bind(Promise);const Om=e=>Promise.resolve(e);for(var Im={},Rm={byteLength:function(e){var t=Pm(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=Pm(e),i=n[0],o=n[1],a=new Mm(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=Am[e.charCodeAt(r)]<<18|Am[e.charCodeAt(r+1)]<<12|Am[e.charCodeAt(r+2)]<<6|Am[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===o&&(t=Am[e.charCodeAt(r)]<<2|Am[e.charCodeAt(r+1)]>>4,a[s++]=255&t),1===o&&(t=Am[e.charCodeAt(r)]<<10|Am[e.charCodeAt(r+1)]<<4|Am[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a},fromByteArray:function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(Fm(e,a,a+o>s?s:a+o));return 1===n?(t=e[r-1],i.push(Tm[t>>2]+Tm[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(Tm[t>>10]+Tm[t>>4&63]+Tm[t<<2&63]+"=")),i.join("")}},Tm=[],Am=[],Mm=typeof Uint8Array<"u"?Uint8Array:Array,Nm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Dm=0;Dm<64;++Dm)Tm[Dm]=Nm[Dm],Am[Nm.charCodeAt(Dm)]=Dm;function Pm(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function jm(e){return Tm[e>>18&63]+Tm[e>>12&63]+Tm[e>>6&63]+Tm[63&e]}function Fm(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(jm(n));return i.join("")}Am["-".charCodeAt(0)]=62,Am["_".charCodeAt(0)]=63;var Vm={read:function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?i-1:0,f=r?-1:1,h=e[t+d];for(d+=f,o=h&(1<<-u)-1,h>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=f,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=f,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),o-=c}return(h?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[r+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+h]=255&a,h+=p,a/=256,c-=8);e[r+h-p]|=128*g}};!function(e){const t=Rm,r=Vm,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},e.INSPECT_MAX_BYTES=50;const i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|h(e,t);let n=o(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);const i=function(e){if(a.isBuffer(e)){const t=0|f(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||q(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),o(e<0?0:0|f(e))}function u(e){const t=e.length<0?0:0|f(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,a.prototype),n}function f(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function h(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(e).length;default:if(i)return n?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return x(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),q(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){let o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*a}else-1!==n&&(o-=o-n),n=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){let r=!0;for(let n=0;n<l;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return-1}function y(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let a;for(n>o/2&&(n=o/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(q(n))return a;e[r+a]=n}return a}function b(e,t,r,n){return G(H(t,e.length-r),e,r,n)}function _(e,t,r,n){return G(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return G(W(t),e,r,n)}function C(e,t,r,n){return G(function(e,t){let r,n,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function E(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function S(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(o=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=a}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(K(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=a.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(K(t,Uint8Array))i+t.length>n.length?(a.isBuffer(t)||(t=a.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!a.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},a.byteLength=h,a.prototype._isBuffer=!0,a.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(K(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const l=Math.min(o,s),c=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<l;++e)if(c[e]!==u[e]){o=c[e],s=u[e];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return _(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function x(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function I(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Y[e[n]];return i}function R(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function T(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function M(e,t,r,n,i){$(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function N(e,t,r,n,i){$(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function D(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function P(e,t,n,i,o){return t=+t,n>>>=0,o||D(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function j(e,t,n,i,o){return t=+t,n>>>=0,o||D(e,0,n,8),r.write(e,t,n,i,52,8),n+8}a.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=J((function(e){B(e>>>=0,"offset");const t=this[e],r=this[e+7];(void 0===t||void 0===r)&&U(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),a.prototype.readBigUInt64BE=J((function(e){B(e>>>=0,"offset");const t=this[e],r=this[e+7];(void 0===t||void 0===r)&&U(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=J((function(e){B(e>>>=0,"offset");const t=this[e],r=this[e+7];(void 0===t||void 0===r)&&U(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),a.prototype.readBigInt64BE=J((function(e){B(e>>>=0,"offset");const t=this[e],r=this[e+7];(void 0===t||void 0===r)&&U(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){A(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){A(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=J((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeBigUInt64BE=J((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);A(this,e,t,r,n-1,-n)}let i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);A(this,e,t,r,n-1,-n)}let i=r-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=J((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeBigInt64BE=J((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeFloatLE=function(e,t,r){return P(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return P(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return j(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return j(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),!n&&0!==n&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=a.isBuffer(e)?e:a.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};const F={};function V(e,t,r){F[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function L(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function $(e,t,r,n,i,o){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){B(t,"offset"),(void 0===e[t]||void 0===e[t+r])&&U(t,e.length-(r+1))}(n,i,o)}function B(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function U(e,t,r){throw Math.floor(e)!==e?(B(e,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",e)):t<0?new F.ERR_BUFFER_OUT_OF_BOUNDS:new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}V("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),V("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),V("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=L(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=L(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const z=/[^+/0-9A-Za-z-_]/g;function H(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!=e}const Y=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return typeof BigInt>"u"?X:e}function X(){throw new Error("BigInt not supported")}}(Im);let Lm=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},$m=!0;try{typeof localStorage<"u"&&localStorage&&(Lm=localStorage,$m=!1)}catch{}const Bm=Lm,Um=Object.assign,zm=Object.keys,Hm=e=>zm(e).length,Wm=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Gm=(e,t,r=0)=>{try{for(;r<e.length;r++)e[r](...t)}finally{r<e.length&&Gm(e,t,r+1)}},Km=()=>{},qm=e=>e,Ym=(e,t)=>{if(null==e||null==t)return((e,t)=>e===t)(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;break;case Set:if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;break;case Map:if(e.size!==t.size)return!1;for(const r of e.keys())if(!t.has(r)||!Ym(e.get(r),t.get(r)))return!1;break;case Object:if(Hm(e)!==Hm(t))return!1;for(const r in e)if(!Wm(e,r)||!Ym(e[r],t[r]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Ym(e[r],t[r]))return!1;break;default:return!1}return!0},Jm=typeof Ni.exports<"u"&&Ni.exports.release&&/node|io\.js/.test(Ni.exports.release.name)&&"[object process]"===Object.prototype.toString.call(typeof Ni.exports<"u"?Ni.exports:0),Xm=typeof window<"u"&&typeof document<"u"&&!Jm;let Zm;typeof navigator<"u"&&/Mac/.test(navigator.platform);const Qm=e=>(()=>{if(void 0===Zm)if(Jm){Zm=ig();const e=Ni.exports.argv;let t=null;for(let r=0;r<e.length;r++){const n=e[r];"-"===n[0]?(null!==t&&Zm.set(t,""),t=n):null!==t&&(Zm.set(t,n),t=null)}null!==t&&Zm.set(t,"")}else"object"==typeof location?(Zm=ig(),(location.search||"?").slice(1).split("&").forEach((e=>{if(0!==e.length){const[t,r]=e.split("=");Zm.set(`--${Ig(t,"-")}`,r),Zm.set(`-${Ig(t,"-")}`,r)}}))):Zm=ig();return Zm})().has(e),ev=e=>(e=>void 0===e?null:e)(Jm?Ni.exports.env[e.toUpperCase()]:Bm.getItem(e));(e=>{Qm("--"+e)||ev(e)})("production");const tv=Jm&&((e,t)=>t.includes(e))(Ni.exports.env.FORCE_COLOR,["true","1","2"]),rv=!Qm("no-colors")&&(!Jm||Ni.exports.stdout.isTTY||tv)&&(!Jm||Qm("color")||tv||null!==ev("COLORTERM")||(ev("TERM")||"").includes("color")),nv=e=>new Uint8Array(e),iv=Xm?e=>{let t="";for(let r=0;r<e.byteLength;r++)t+=kg(e[r]);return btoa(t)}:e=>Im.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),ov=Xm?e=>{const t=atob(e),r=nv(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}:e=>{const t=Im.Buffer.from(e,"base64");return((e,t,r)=>new Uint8Array(e,t,r))(t.buffer,t.byteOffset,t.byteLength)},av=e=>iv(e).replaceAll("+","-").replaceAll("/","_").replaceAll("=","");class sv{constructor(e,t){this.left=e,this.right=t}}const lv=(e,t)=>new sv(e,t),cv=typeof document<"u"?document:{};typeof DOMParser<"u"&&new DOMParser;const uv=e=>((e,t)=>{const r=[];for(const[n,i]of e)r.push(t(i,n));return r})(e,((e,t)=>`${t}:${e};`)).join("");cv.ELEMENT_NODE,cv.TEXT_NODE,cv.CDATA_SECTION_NODE,cv.COMMENT_NODE,cv.DOCUMENT_NODE,cv.DOCUMENT_TYPE_NODE,cv.DOCUMENT_FRAGMENT_NODE;const dv=Symbol,fv=dv(),hv=dv(),pv=dv(),gv=dv(),mv=dv(),vv=dv(),yv=dv(),bv=dv(),_v=dv(),wv=[mv,yv,bv,pv];let Cv=0,Ev=km();const Sv={[fv]:lv("font-weight","bold"),[hv]:lv("font-weight","normal"),[pv]:lv("color","blue"),[mv]:lv("color","green"),[gv]:lv("color","grey"),[vv]:lv("color","red"),[yv]:lv("color","purple"),[bv]:lv("color","orange"),[_v]:lv("color","black")},kv=rv?e=>{const t=[],r=[],n=ig();let i=[],o=0;for(;o<e.length;o++){const i=e[o],a=Sv[i];if(void 0!==a)n.set(a.left,a.right);else{if(i.constructor!==String&&i.constructor!==Number)break;{const e=uv(n);o>0||e.length>0?(t.push("%c"+i),r.push(e)):t.push(i)}}}for(o>0&&(i=r,i.unshift(t.join("")));o<e.length;o++){const t=e[o];t instanceof Symbol||i.push(t)}return i}:e=>{const t=[];let r=0;for(;r<e.length;r++){const n=e[r];n.constructor===String||n.constructor===Number||n.constructor===Object&&t.push(JSON.stringify(n))}return t},xv=(...e)=>{console.log(...kv(e)),Ov.forEach((t=>t.print(e)))},Ov=sg(),Iv=e=>((e,t)=>{const r=wv[Cv],n=ev("log"),i=null!==n&&("*"===n||"true"===n||new RegExp(n,"gi").test(t));return Cv=(Cv+1)%wv.length,t+=": ",i?(...n)=>{const i=km(),o=i-Ev;Ev=i,e(r,t,_v,...n.map((e=>"string"==typeof e||"symbol"==typeof e?e:JSON.stringify(e))),r," +"+o+"ms")}:Km})(xv,e),Rv=e=>({[Symbol.iterator](){return this},next:e}),Tv=(e,t)=>Rv((()=>{const{done:r,value:n}=e.next();return{done:r,value:r?void 0:t(n)}}));class Av{constructor(e,t){this.clock=e,this.len=t}}class Mv{constructor(){this.clients=new Map}}const Nv=(e,t,r)=>t.clients.forEach(((t,n)=>{const i=e.doc.store.clients.get(n);for(let n=0;n<t.length;n++){const o=t[n];Uy(e,i,o.clock,o.len,r)}})),Dv=(e,t)=>{const r=e.clients.get(t.client);return void 0!==r&&null!==((e,t)=>{let r=0,n=e.length-1;for(;r<=n;){const i=pg((r+n)/2),o=e[i],a=o.clock;if(a<=t){if(t<a+o.len)return i;r=i+1}else n=i-1}return null})(r,t.clock)},Pv=e=>{e.clients.forEach((e=>{let t,r;for(e.sort(((e,t)=>e.clock-t.clock)),t=1,r=1;t<e.length;t++){const n=e[r-1],i=e[t];n.clock+n.len>=i.clock?n.len=yg(n.len,i.clock+i.len-n.clock):(r<t&&(e[r]=i),r++)}e.length=r}))},jv=e=>{const t=new Mv;for(let r=0;r<e.length;r++)e[r].clients.forEach(((n,i)=>{if(!t.clients.has(i)){const o=n.slice();for(let t=r+1;t<e.length;t++)cg(o,e[t].clients.get(i)||[]);t.clients.set(i,o)}}));return Pv(t),t},Fv=(e,t,r,n)=>{ag(e.clients,t,(()=>[])).push(new Av(r,n))},Vv=()=>new Mv,Lv=e=>{const t=Vv();return e.clients.forEach(((e,r)=>{const n=[];for(let t=0;t<e.length;t++){const r=e[t];if(r.deleted){const i=r.id.clock;let o=r.length;if(t+1<e.length)for(let r=e[t+1];t+1<e.length&&r.deleted;r=e[1+ ++t])o+=r.length;n.push(new Av(i,o))}}n.length>0&&t.clients.set(r,n)})),t},$v=(e,t)=>{Vg(e.restEncoder,t.clients.size),ug(t.clients.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([t,r])=>{e.resetDsCurVal(),Vg(e.restEncoder,t);const n=r.length;Vg(e.restEncoder,n);for(let t=0;t<n;t++){const n=r[t];e.writeDsClock(n.clock),e.writeDsLen(n.len)}}))},Bv=e=>{const t=new Mv,r=um(e.restDecoder);for(let n=0;n<r;n++){e.resetDsCurVal();const r=um(e.restDecoder),n=um(e.restDecoder);if(n>0){const i=ag(t.clients,r,(()=>[]));for(let t=0;t<n;t++)i.push(new Av(e.readDsClock(),e.readDsLen()))}}return t},Uv=(e,t,r)=>{const n=new Mv,i=um(e.restDecoder);for(let o=0;o<i;o++){e.resetDsCurVal();const i=um(e.restDecoder),o=um(e.restDecoder),a=r.clients.get(i)||[],s=Py(r,i);for(let r=0;r<o;r++){const r=e.readDsClock(),o=r+e.readDsLen();if(r<s){s<o&&Fv(n,i,s,o-s);let e=Fy(a,r),l=a[e];for(!l.deleted&&l.id.clock<r&&(a.splice(e+1,0,F_(t,l,r-l.id.clock)),e++);e<a.length&&(l=a[e++],l.id.clock<o);)l.deleted||(o<l.id.clock+l.length&&a.splice(e,0,F_(t,l,o-l.id.clock)),l.delete(t))}else Fv(n,i,r,o-r)}}if(n.clients.size>0){const e=new Qv;return Vg(e.restEncoder,0),$v(e,n),e.toUint8Array()}return null},zv=(e,t)=>{if(e.clients.size!==t.clients.size)return!1;for(const[r,n]of e.clients.entries()){const e=t.clients.get(r);if(void 0===e||n.length!==e.length)return!1;for(let t=0;t<n.length;t++){const r=n[t],i=e[t];if(r.clock!==i.clock||r.len!==i.len)return!1}}return!0},Hv=Cm;class Wv extends hg{constructor({guid:e=Sm(),collectionid:t=null,gc:r=!0,gcFilter:n=(()=>!0),meta:i=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=n,this.clientID=Hv(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Ny,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=xm((e=>{this.on("load",(()=>{this.isLoaded=!0,e(this)}))}));const s=()=>xm((e=>{const t=r=>{(void 0===r||!0===r)&&(this.off("sync",t),e())};this.on("sync",t)}));this.on("sync",(e=>{!1===e&&this.isSynced&&(this.whenSynced=s()),this.isSynced=void 0===e||!0===e,this.isLoaded||this.emit("load",[])})),this.whenSynced=s()}load(){const e=this._item;null!==e&&!this.shouldLoad&&Jy(e.parent.doc,(e=>{e.subdocsLoaded.add(this)}),null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ug(this.subdocs).map((e=>e.guid)))}transact(e,t=null){return Jy(this,e,t)}get(e,t=xb){const r=ag(this.share,e,(()=>{const e=new t;return e._integrate(this,null),e})),n=r.constructor;if(t!==xb&&n!==t){if(n===xb){const n=new t;n._map=r._map,r._map.forEach((e=>{for(;null!==e;e=e.left)e.parent=n})),n._start=r._start;for(let e=n._start;null!==e;e=e.right)e.parent=n;return n._length=r._length,this.share.set(e,n),n._integrate(this,null),n}throw new Error(`Type with the name ${e} has already been defined with a different constructor`)}return r}getArray(e=""){return this.get(e,Hb)}getText(e=""){return this.get(e,l_)}getMap(e=""){return this.get(e,Gb)}getXmlFragment(e=""){return this.get(e,u_)}toJSON(){const e={};return this.share.forEach(((t,r)=>{e[r]=t.toJSON()})),e}destroy(){ug(this.subdocs).forEach((e=>e.destroy()));const e=this._item;if(null!==e){this._item=null;const t=e.content;t.doc=new Wv({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Jy(e.parent.doc,(r=>{const n=t.doc;e.deleted||r.subdocsAdded.add(n),r.subdocsRemoved.add(this)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(e,t){super.on(e,t)}off(e,t){super.off(e,t)}}class Gv{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return um(this.restDecoder)}readDsLen(){return um(this.restDecoder)}}class Kv extends Gv{readLeftID(){return yy(um(this.restDecoder),um(this.restDecoder))}readRightID(){return yy(um(this.restDecoder),um(this.restDecoder))}readClient(){return um(this.restDecoder)}readInfo(){return cm(this.restDecoder)}readString(){return fm(this.restDecoder)}readParentInfo(){return 1===um(this.restDecoder)}readTypeRef(){return um(this.restDecoder)}readLen(){return um(this.restDecoder)}readAny(){return gm(this.restDecoder)}readBuf(){return(e=>{const t=nv(e.byteLength);return t.set(e),t})(lm(this.restDecoder))}readJSON(){return JSON.parse(fm(this.restDecoder))}readKey(){return fm(this.restDecoder)}}class qv{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=um(this.restDecoder),this.dsCurrVal}readDsLen(){const e=um(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Yv extends qv{constructor(e){super(e),this.keys=[],um(e),this.keyClockDecoder=new ym(lm(e)),this.clientDecoder=new vm(lm(e)),this.leftClockDecoder=new ym(lm(e)),this.rightClockDecoder=new ym(lm(e)),this.infoDecoder=new mm(lm(e),cm),this.stringDecoder=new bm(lm(e)),this.parentInfoDecoder=new mm(lm(e),cm),this.typeRefDecoder=new vm(lm(e)),this.lenDecoder=new vm(lm(e))}readLeftID(){return new my(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new my(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return gm(this.restDecoder)}readBuf(){return lm(this.restDecoder)}readJSON(){return gm(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class Jv{constructor(){this.restEncoder=Dg()}toUint8Array(){return Pg(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Vg(this.restEncoder,e)}writeDsLen(e){Vg(this.restEncoder,e)}}class Xv extends Jv{writeLeftID(e){Vg(this.restEncoder,e.client),Vg(this.restEncoder,e.clock)}writeRightID(e){Vg(this.restEncoder,e.client),Vg(this.restEncoder,e.clock)}writeClient(e){Vg(this.restEncoder,e)}writeInfo(e){Fg(this.restEncoder,e)}writeString(e){Ug(this.restEncoder,e)}writeParentInfo(e){Vg(this.restEncoder,e?1:0)}writeTypeRef(e){Vg(this.restEncoder,e)}writeLen(e){Vg(this.restEncoder,e)}writeAny(e){Kg(this.restEncoder,e)}writeBuf(e){Hg(this.restEncoder,e)}writeJSON(e){Ug(this.restEncoder,JSON.stringify(e))}writeKey(e){Ug(this.restEncoder,e)}}class Zv{constructor(){this.restEncoder=Dg(),this.dsCurrVal=0}toUint8Array(){return Pg(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,Vg(this.restEncoder,t)}writeDsLen(e){0===e&&rm(),Vg(this.restEncoder,e-1),this.dsCurrVal+=e}}class Qv extends Zv{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Zg,this.clientEncoder=new Jg,this.leftClockEncoder=new Zg,this.rightClockEncoder=new Zg,this.infoEncoder=new qg(Fg),this.stringEncoder=new Qg,this.parentInfoEncoder=new qg(Fg),this.typeRefEncoder=new Jg,this.lenEncoder=new Jg}toUint8Array(){const e=Dg();return Vg(e,0),Hg(e,this.keyClockEncoder.toUint8Array()),Hg(e,this.clientEncoder.toUint8Array()),Hg(e,this.leftClockEncoder.toUint8Array()),Hg(e,this.rightClockEncoder.toUint8Array()),Hg(e,Pg(this.infoEncoder)),Hg(e,this.stringEncoder.toUint8Array()),Hg(e,Pg(this.parentInfoEncoder)),Hg(e,this.typeRefEncoder.toUint8Array()),Hg(e,this.lenEncoder.toUint8Array()),zg(e,Pg(this.restEncoder)),Pg(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Kg(this.restEncoder,e)}writeBuf(e){Hg(this.restEncoder,e)}writeJSON(e){Kg(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const ey=(e,t,r)=>{const n=new Map;r.forEach(((e,r)=>{Py(t,r)>e&&n.set(r,e)})),Dy(t).forEach(((e,t)=>{r.has(t)||n.set(t,0)})),Vg(e.restEncoder,n.size),ug(n.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([r,n])=>{((e,t,r,n)=>{n=yg(n,t[0].id.clock);const i=Fy(t,n);Vg(e.restEncoder,t.length-i),e.writeClient(r),Vg(e.restEncoder,n);const o=t[i];o.write(e,n-o.id.clock);for(let r=i+1;r<t.length;r++)t[r].write(e,0)})(e,t.clients.get(r),r,n)}))},ty=(e,t,r,n=new Yv(e))=>Jy(t,(e=>{e.local=!1;let t=!1;const r=e.doc,i=r.store,o=((e,t)=>{const r=ig(),n=um(e.restDecoder);for(let i=0;i<n;i++){const n=um(e.restDecoder),i=new Array(n),o=e.readClient();let a=um(e.restDecoder);r.set(o,{i:0,refs:i});for(let r=0;r<n;r++){const n=e.readInfo();switch(31&n){case 0:{const t=e.readLen();i[r]=new m_(yy(o,a),t),a+=t;break}case 10:{const t=um(e.restDecoder);i[r]=new z_(yy(o,a),t),a+=t;break}default:{const s=0==(192&n),l=new $_(yy(o,a),null,(n&wg)===wg?e.readLeftID():null,null,(n&_g)===_g?e.readRightID():null,s?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,s&&32==(32&n)?e.readString():null,B_(e,n));i[r]=l,a+=l.length}}}}return r})(n,r),a=((e,t,r)=>{const n=[];let i=ug(r.keys()).sort(((e,t)=>e-t));if(0===i.length)return null;const o=()=>{if(0===i.length)return null;let e=r.get(i[i.length-1]);for(;e.refs.length===e.i;){if(i.pop(),!(i.length>0))return null;e=r.get(i[i.length-1])}return e};let a=o();if(null===a&&0===n.length)return null;const s=new Ny,l=new Map,c=(e,t)=>{const r=l.get(e);(null==r||r>t)&&l.set(e,t)};let u=a.refs[a.i++];const d=new Map,f=()=>{for(const e of n){const t=e.id.client,n=r.get(t);n?(n.i--,s.clients.set(t,n.refs.slice(n.i)),r.delete(t),n.i=0,n.refs=[]):s.clients.set(t,[e]),i=i.filter((e=>e!==t))}n.length=0};for(;;){if(u.constructor!==z_){const i=ag(d,u.id.client,(()=>Py(t,u.id.client)))-u.id.clock;if(i<0)n.push(u),c(u.id.client,u.id.clock-1),f();else{const o=u.getMissing(e,t);if(null!==o){n.push(u);const e=r.get(o)||{refs:[],i:0};if(e.refs.length!==e.i){u=e.refs[e.i++];continue}c(o,Py(t,o)),f()}else(0===i||i<u.length)&&(u.integrate(e,i),d.set(u.id.client,u.id.clock+u.length))}}if(n.length>0)u=n.pop();else if(null!==a&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=o(),null===a)break;u=a.refs[a.i++]}}if(s.clients.size>0){const e=new Qv;return ey(e,s,new Map),Vg(e.restEncoder,0),{missing:l,update:e.toUint8Array()}}return null})(e,i,o),s=i.pendingStructs;if(s){for(const[e,r]of s.missing)if(r<Py(i,e)){t=!0;break}if(a){for(const[e,t]of a.missing){const r=s.missing.get(e);(null==r||r>t)&&s.missing.set(e,t)}s.update=cb([s.update,a.update])}}else i.pendingStructs=a;const l=Uv(n,e,i);if(i.pendingDs){const t=new Yv(am(i.pendingDs));um(t.restDecoder);const r=Uv(t,e,i);i.pendingDs=l&&r?cb([l,r]):l||r}else i.pendingDs=l;if(t){const t=i.pendingStructs.update;i.pendingStructs=null,ry(e.doc,t)}}),r,!1),ry=(e,t,r,n=Yv)=>{const i=am(t);ty(i,e,r,new n(i))},ny=(e,t,r)=>ry(e,t,r,Kv),iy=(e,t=new Uint8Array([0]),r=new Qv)=>{((e,t,r=new Map)=>{ey(e,t.store,r),$v(e,Lv(t.store))})(r,e,sy(t));const n=[r.toUint8Array()];if(e.store.pendingDs&&n.push(e.store.pendingDs),e.store.pendingStructs&&n.push(ub(e.store.pendingStructs.update,t)),n.length>1){if(r.constructor===Xv)return ob(n.map(((e,t)=>0===t?e:mb(e))));if(r.constructor===Qv)return cb(n)}return n[0]},oy=(e,t)=>iy(e,t,new Xv),ay=e=>{const t=new Map,r=um(e.restDecoder);for(let n=0;n<r;n++){const r=um(e.restDecoder),n=um(e.restDecoder);t.set(r,n)}return t},sy=e=>ay(new Gv(am(e))),ly=(e,t)=>(Vg(e.restEncoder,t.size),ug(t.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([t,r])=>{Vg(e.restEncoder,t),Vg(e.restEncoder,r)})),e),cy=(e,t=new Zv)=>(e instanceof Map?ly(t,e):((e,t)=>{ly(e,Dy(t.store))})(t,e),t.toUint8Array()),uy=e=>cy(e,new Jv);class dy{constructor(){this.l=[]}}const fy=()=>new dy,hy=(e,t)=>e.l.push(t),py=(e,t)=>{const r=e.l,n=r.length;e.l=r.filter((e=>t!==e)),n===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},gy=(e,t,r)=>Gm(e.l,[t,r]);class my{constructor(e,t){this.client=e,this.clock=t}}const vy=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,yy=(e,t)=>new my(e,t),by=(e,t)=>{Vg(e,t.client),Vg(e,t.clock)},_y=e=>yy(um(e),um(e)),wy=e=>{for(const[t,r]of e.doc.share.entries())if(r===e)return t;throw rm()},Cy=(e,t)=>{for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1};class Ey{constructor(e,t,r,n=0){this.type=e,this.tname=t,this.item=r,this.assoc=n}}class Sy{constructor(e,t,r=0){this.type=e,this.index=t,this.assoc=r}}const ky=(e,t,r)=>{let n=null,i=null;return null===e._item?i=wy(e):n=yy(e._item.id.client,e._item.id.clock),new Ey(n,i,t,r)};class xy{constructor(e,t){this.ds=e,this.sv=t}}const Oy=(e,t=new Zv)=>($v(t,e.ds),ly(t,e.sv),t.toUint8Array()),Iy=(e,t=new qv(am(e)))=>new xy(Bv(t),ay(t)),Ry=(e,t)=>new xy(e,t),Ty=Ry(Vv(),new Map),Ay=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Dv(t.ds,e.id),My=(e,t)=>{const r=ag(e.meta,My,sg),n=e.doc.store;r.has(t)||(t.sv.forEach(((t,r)=>{t<Py(n,r)&&$y(e,yy(r,t))})),Nv(e,t.ds,(e=>{})),r.add(t))};class Ny{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Dy=e=>{const t=new Map;return e.clients.forEach(((e,r)=>{const n=e[e.length-1];t.set(r,n.id.clock+n.length)})),t},Py=(e,t)=>{const r=e.clients.get(t);if(void 0===r)return 0;const n=r[r.length-1];return n.id.clock+n.length},jy=(e,t)=>{let r=e.clients.get(t.id.client);if(void 0===r)r=[],e.clients.set(t.id.client,r);else{const e=r[r.length-1];if(e.id.clock+e.length!==t.id.clock)throw rm()}r.push(t)},Fy=(e,t)=>{let r=0,n=e.length-1,i=e[n],o=i.id.clock;if(o===t)return n;let a=pg(t/(o+i.length-1)*n);for(;r<=n;){if(i=e[a],o=i.id.clock,o<=t){if(t<o+i.length)return a;r=a+1}else n=a-1;a=pg((r+n)/2)}throw rm()},Vy=(e,t)=>{const r=e.clients.get(t.client);return r[Fy(r,t.clock)]},Ly=(e,t,r)=>{const n=Fy(t,r),i=t[n];return i.id.clock<r&&i instanceof $_?(t.splice(n+1,0,F_(e,i,r-i.id.clock)),n+1):n},$y=(e,t)=>{const r=e.doc.store.clients.get(t.client);return r[Ly(e,r,t.clock)]},By=(e,t,r)=>{const n=t.clients.get(r.client),i=Fy(n,r.clock),o=n[i];return r.clock!==o.id.clock+o.length-1&&o.constructor!==m_&&n.splice(i+1,0,F_(e,o,r.clock-o.id.clock+1)),o},Uy=(e,t,r,n,i)=>{if(0===n)return;const o=r+n;let a,s=Ly(e,t,r);do{a=t[s++],o<a.id.clock+a.length&&Ly(e,t,o),i(a)}while(s<t.length&&t[s].id.clock<o)};class zy{constructor(e,t,r){this.doc=e,this.deleteSet=new Mv,this.beforeState=Dy(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Hy=(e,t)=>!(0===t.deleteSet.clients.size&&!((e,t)=>{for(const[r,n]of e)if(t(n,r))return!0;return!1})(t.afterState,((e,r)=>t.beforeState.get(r)!==e)))&&(Pv(t.deleteSet),((e,t)=>{ey(e,t.doc.store,t.beforeState)})(e,t),$v(e,t.deleteSet),!0),Wy=(e,t,r)=>{const n=t._item;(null===n||n.id.clock<(e.beforeState.get(n.id.client)||0)&&!n.deleted)&&ag(e.changed,t,sg).add(r)},Gy=(e,t)=>{let r=e[t],n=e[t-1],i=t;for(;i>0&&(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r));r=n,n=e[--i-1])r instanceof $_&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);const o=t-i;return o&&e.splice(t+1-o,o),o},Ky=(e,t,r)=>{for(const[n,i]of e.clients.entries()){const e=t.clients.get(n);for(let n=i.length-1;n>=0;n--){const o=i[n],a=o.clock+o.len;for(let n=Fy(e,o.clock),i=e[n];n<e.length&&i.id.clock<a;i=e[++n]){const i=e[n];if(o.clock+o.len<=i.id.clock)break;i instanceof $_&&i.deleted&&!i.keep&&r(i)&&i.gc(t,!1)}}}},qy=(e,t)=>{e.clients.forEach(((e,r)=>{const n=t.clients.get(r);for(let t=e.length-1;t>=0;t--){const r=e[t];for(let e=vg(n.length-1,1+Fy(n,r.clock+r.len-1)),t=n[e];e>0&&t.id.clock>=r.clock;t=n[e])e-=1+Gy(n,e)}}))},Yy=(e,t)=>{if(t<e.length){const r=e[t],n=r.doc,i=n.store,o=r.deleteSet,a=r._mergeStructs;try{Pv(o),r.afterState=Dy(r.doc.store),n.emit("beforeObserverCalls",[r,n]);const e=[];r.changed.forEach(((t,n)=>e.push((()=>{(null===n._item||!n._item.deleted)&&n._callObserver(r,t)})))),e.push((()=>{r.changedParentTypes.forEach(((e,t)=>{t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter((e=>null===e.target._item||!e.target._item.deleted))).forEach((e=>{e.currentTarget=t,e._path=null})),e.sort(((e,t)=>e.path.length-t.path.length)),gy(t._dEH,e,r))}))})),e.push((()=>n.emit("afterTransaction",[r,n]))),Gm(e,[]),r._needFormattingCleanup&&o_(r)}finally{n.gc&&Ky(o,i,n.gcFilter),qy(o,i),r.afterState.forEach(((e,t)=>{const n=r.beforeState.get(t)||0;if(n!==e){const e=i.clients.get(t),r=yg(Fy(e,n),1);for(let t=e.length-1;t>=r;)t-=1+Gy(e,t)}}));for(let e=a.length-1;e>=0;e--){const{client:t,clock:r}=a[e].id,n=i.clients.get(t),o=Fy(n,r);o+1<n.length&&Gy(n,o+1)>1||o>0&&Gy(n,o)}if(!r.local&&r.afterState.get(n.clientID)!==r.beforeState.get(n.clientID)&&(xv(bv,fv,"[yjs] ",hv,vv,"Changed the client-id because another client seems to be using it."),n.clientID=Hv()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){const e=new Xv;Hy(e,r)&&n.emit("update",[e.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){const e=new Qv;Hy(e,r)&&n.emit("updateV2",[e.toUint8Array(),r.origin,n,r])}const{subdocsAdded:s,subdocsLoaded:l,subdocsRemoved:c}=r;(s.size>0||c.size>0||l.size>0)&&(s.forEach((e=>{e.clientID=n.clientID,null==e.collectionid&&(e.collectionid=n.collectionid),n.subdocs.add(e)})),c.forEach((e=>n.subdocs.delete(e))),n.emit("subdocs",[{loaded:l,added:s,removed:c},n,r]),c.forEach((e=>e.destroy()))),e.length<=t+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,e])):Yy(e,t+1)}}},Jy=(e,t,r=null,n=!0)=>{const i=e._transactionCleanups;let o=!1,a=null;null===e._transaction&&(o=!0,e._transaction=new zy(e,r,n),i.push(e._transaction),1===i.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{a=t(e._transaction)}finally{if(o){const t=e._transaction===i[0];e._transaction=null,t&&Yy(i,0)}}return a};class Xy{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const Zy=(e,t,r)=>{Nv(e,r.deletions,(e=>{e instanceof $_&&t.scope.some((t=>Cy(t,e)))&&j_(e,!1)}))},Qy=(e,t,r)=>{let n=null,i=null;const o=e.doc,a=e.scope;if(Jy(o,(r=>{for(;t.length>0&&null===n;){const i=o.store,s=t.pop(),l=new Set,c=[];let u=!1;Nv(r,s.insertions,(e=>{if(e instanceof $_){if(null!==e.redone){let{item:t,diff:n}=P_(i,e.id);n>0&&(t=$y(r,yy(t.id.client,t.id.clock+n))),e=t}!e.deleted&&a.some((t=>Cy(t,e)))&&c.push(e)}})),Nv(r,s.deletions,(e=>{e instanceof $_&&a.some((t=>Cy(t,e)))&&!Dv(s.insertions,e.id)&&l.add(e)})),l.forEach((t=>{u=null!==L_(r,t,l,s.insertions,e.ignoreRemoteMapChanges,e)||u}));for(let t=c.length-1;t>=0;t--){const n=c[t];e.deleteFilter(n)&&(n.delete(r),u=!0)}n=u?s:null}r.changed.forEach(((e,t)=>{e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)})),i=r}),e),null!=n){const t=i.changedParentTypes;e.emit("stack-item-popped",[{stackItem:n,type:r,changedParentTypes:t},e])}return n};class eb extends hg{constructor(e,{captureTimeout:t=500,captureTransaction:r=(e=>!0),deleteFilter:n=(()=>!0),trackedOrigins:i=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:a=(dg(e)?e[0].doc:e.doc)}={}){super(),this.scope=[],this.doc=a,this.addToScope(e),this.deleteFilter=n,i.add(this),this.trackedOrigins=i,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=t,this.afterTransactionHandler=e=>{if(!(this.captureTransaction(e)&&this.scope.some((t=>e.changedParentTypes.has(t)))&&(this.trackedOrigins.has(e.origin)||e.origin&&this.trackedOrigins.has(e.origin.constructor))))return;const t=this.undoing,r=this.redoing,n=t?this.redoStack:this.undoStack;t?this.stopCapturing():r||this.clear(!1,!0);const i=new Mv;e.afterState.forEach(((t,r)=>{const n=e.beforeState.get(r)||0,o=t-n;o>0&&Fv(i,r,n,o)}));const o=km();let a=!1;if(this.lastChange>0&&o-this.lastChange<this.captureTimeout&&n.length>0&&!t&&!r){const t=n[n.length-1];t.deletions=jv([t.deletions,e.deleteSet]),t.insertions=jv([t.insertions,i])}else n.push(new Xy(e.deleteSet,i)),a=!0;!t&&!r&&(this.lastChange=o),Nv(e,e.deleteSet,(e=>{e instanceof $_&&this.scope.some((t=>Cy(t,e)))&&j_(e,!0)}));const s=[{stackItem:n[n.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},this];a?this.emit("stack-item-added",s):this.emit("stack-item-updated",s)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",(()=>{this.destroy()}))}addToScope(e){(e=dg(e)?e:[e]).forEach((e=>{this.scope.every((t=>t!==e))&&(e.doc!==this.doc&&((...e)=>{console.warn(...kv(e)),e.unshift(bv),Ov.forEach((t=>t.print(e)))})("[yjs#509] Not same Y.Doc"),this.scope.push(e))}))}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact((r=>{e&&(this.undoStack.forEach((e=>Zy(r,this,e))),this.undoStack=[]),t&&(this.redoStack.forEach((e=>Zy(r,this,e))),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])}))}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=Qy(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=Qy(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class tb{constructor(e,t){this.gen=function*(e){const t=um(e.restDecoder);for(let r=0;r<t;r++){const t=um(e.restDecoder),r=e.readClient();let n=um(e.restDecoder);for(let i=0;i<t;i++){const t=e.readInfo();if(10===t){const t=um(e.restDecoder);yield new z_(yy(r,n),t),n+=t}else if(0!=(31&t)){const i=0==(192&t),o=new $_(yy(r,n),null,(t&wg)===wg?e.readLeftID():null,null,(t&_g)===_g?e.readRightID():null,i?e.readParentInfo()?e.readString():e.readLeftID():null,i&&32==(32&t)?e.readString():null,B_(e,t));yield o,n+=o.length}else{const t=e.readLen();yield new m_(yy(r,n),t),n+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===z_);return this.curr}}const rb=(e,t=Yv)=>{const r=[],n=new t(am(e)),i=new tb(n,!1);for(let e=i.curr;null!==e;e=i.next())r.push(e);xv("Structs: ",r);const o=Bv(n);xv("DeleteSet: ",o)},nb=(e,t=Yv)=>{const r=[],n=new t(am(e)),i=new tb(n,!1);for(let e=i.curr;null!==e;e=i.next())r.push(e);return{structs:r,ds:Bv(n)}};class ib{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const ob=e=>cb(e,Kv,Xv),ab=(e,t=Zv,r=Yv)=>{const n=new t,i=new tb(new r(am(e)),!1);let o=i.curr;if(null!==o){let e=0,t=o.id.client,r=0!==o.id.clock,a=r?0:o.id.clock+o.length;for(;null!==o;o=i.next())t!==o.id.client&&(0!==a&&(e++,Vg(n.restEncoder,t),Vg(n.restEncoder,a)),t=o.id.client,a=0,r=0!==o.id.clock),o.constructor===z_&&(r=!0),r||(a=o.id.clock+o.length);0!==a&&(e++,Vg(n.restEncoder,t),Vg(n.restEncoder,a));const s=Dg();return Vg(s,e),((e,t)=>{zg(e,Pg(t))})(s,n.restEncoder),n.restEncoder=s,n.toUint8Array()}return Vg(n.restEncoder,0),n.toUint8Array()},sb=(e,t=Yv)=>{const r=new Map,n=new Map,i=new tb(new t(am(e)),!1);let o=i.curr;if(null!==o){let e=o.id.client,t=o.id.clock;for(r.set(e,t);null!==o;o=i.next())e!==o.id.client&&(n.set(e,t),r.set(o.id.client,o.id.clock),e=o.id.client),t=o.id.clock+o.length;n.set(e,t)}return{from:r,to:n}},lb=(e,t)=>{if(e.constructor===m_){const{client:r,clock:n}=e.id;return new m_(yy(r,n+t),e.length-t)}if(e.constructor===z_){const{client:r,clock:n}=e.id;return new z_(yy(r,n+t),e.length-t)}{const r=e,{client:n,clock:i}=r.id;return new $_(yy(n,i+t),null,yy(n,i+t-1),null,r.rightOrigin,r.parent,r.parentSub,r.content.splice(t))}},cb=(e,t=Yv,r=Qv)=>{if(1===e.length)return e[0];const n=e.map((e=>new t(am(e))));let i=n.map((e=>new tb(e,!0))),o=null;const a=new r,s=new ib(a);for(;i=i.filter((e=>null!==e.curr)),i.sort(((e,t)=>{if(e.curr.id.client===t.curr.id.client){const r=e.curr.id.clock-t.curr.id.clock;return 0===r?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===z_?1:-1:r}return t.curr.id.client-e.curr.id.client})),0!==i.length;){const e=i[0],t=e.curr.id.client;if(null!==o){let r=e.curr,n=!1;for(;null!==r&&r.id.clock+r.length<=o.struct.id.clock+o.struct.length&&r.id.client>=o.struct.id.client;)r=e.next(),n=!0;if(null===r||r.id.client!==t||n&&r.id.clock>o.struct.id.clock+o.struct.length)continue;if(t!==o.struct.id.client)fb(s,o.struct,o.offset),o={struct:r,offset:0},e.next();else if(o.struct.id.clock+o.struct.length<r.id.clock)if(o.struct.constructor===z_)o.struct.length=r.id.clock+r.length-o.struct.id.clock;else{fb(s,o.struct,o.offset);const e=r.id.clock-o.struct.id.clock-o.struct.length;o={struct:new z_(yy(t,o.struct.id.clock+o.struct.length),e),offset:0}}else{const t=o.struct.id.clock+o.struct.length-r.id.clock;t>0&&(o.struct.constructor===z_?o.struct.length-=t:r=lb(r,t)),o.struct.mergeWith(r)||(fb(s,o.struct,o.offset),o={struct:r,offset:0},e.next())}}else o={struct:e.curr,offset:0},e.next();for(let r=e.curr;null!==r&&r.id.client===t&&r.id.clock===o.struct.id.clock+o.struct.length&&r.constructor!==z_;r=e.next())fb(s,o.struct,o.offset),o={struct:r,offset:0}}null!==o&&(fb(s,o.struct,o.offset),o=null),hb(s);const l=n.map((e=>Bv(e))),c=jv(l);return $v(a,c),a.toUint8Array()},ub=(e,t,r=Yv,n=Qv)=>{const i=sy(t),o=new n,a=new ib(o),s=new r(am(e)),l=new tb(s,!1);for(;l.curr;){const e=l.curr,t=e.id.client,r=i.get(t)||0;if(l.curr.constructor!==z_)if(e.id.clock+e.length>r)for(fb(a,e,yg(r-e.id.clock,0)),l.next();l.curr&&l.curr.id.client===t;)fb(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===t&&l.curr.id.clock+l.curr.length<=r;)l.next();else l.next()}hb(a);const c=Bv(s);return $v(o,c),o.toUint8Array()},db=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Pg(e.encoder.restEncoder)}),e.encoder.restEncoder=Dg(),e.written=0)},fb=(e,t,r)=>{e.written>0&&e.currClient!==t.id.client&&db(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),Vg(e.encoder.restEncoder,t.id.clock+r)),t.write(e.encoder,r),e.written++},hb=e=>{db(e);const t=e.encoder.restEncoder;Vg(t,e.clientStructs.length);for(let r=0;r<e.clientStructs.length;r++){const n=e.clientStructs[r];Vg(t,n.written),zg(t,n.restEncoder)}},pb=(e,t,r,n)=>{const i=new r(am(e)),o=new tb(i,!1),a=new n,s=new ib(a);for(let e=o.curr;null!==e;e=o.next())fb(s,t(e),0);hb(s);const l=Bv(i);return $v(a,l),a.toUint8Array()},gb=({formatting:e=!0,subdocs:t=!0,yxml:r=!0}={})=>{let n=0;const i=ig(),o=ig(),a=ig(),s=ig();return s.set(null,null),l=>{switch(l.constructor){case m_:case z_:return l;case $_:{const c=l,u=c.content;switch(u.constructor){case y_:break;case D_:if(r){const e=u.type;e instanceof d_&&(e.nodeName=ag(o,e.nodeName,(()=>"node-"+n))),e instanceof h_&&(e.hookName=ag(o,e.hookName,(()=>"hook-"+n)))}break;case S_:{const e=u;e.arr=e.arr.map((()=>n));break}case v_:u.content=new Uint8Array([n]);break;case __:{const e=u;t&&(e.opts={},e.doc.guid=n+"");break}case w_:u.embed={};break;case C_:{const t=u;e&&(t.key=ag(a,t.key,(()=>n+"")),t.value=ag(s,t.value,(()=>({i:n}))));break}case E_:{const e=u;e.arr=e.arr.map((()=>n));break}case k_:{const e=u;e.str=Mg(n%10+"",e.str.length);break}default:rm()}return c.parentSub&&(c.parentSub=ag(i,c.parentSub,(()=>n+""))),n++,l}default:rm()}}},mb=e=>pb(e,qm,Yv,Xv),vb="You must not compute changes after the event-handler fired.";class yb{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=bb(this.currentTarget,this.target))}deletes(e){return Dv(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw em(vb);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach((r=>{if(null!==r){const n=t._map.get(r);let i,o;if(this.adds(n)){let e=n.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(n)){if(null===e||!this.deletes(e))return;i="delete",o=lg(e.content.getContent())}else null!==e&&this.deletes(e)?(i="update",o=lg(e.content.getContent())):(i="add",o=void 0)}else{if(!this.deletes(n))return;i="delete",o=lg(n.content.getContent())}e.set(r,{action:i,oldValue:o})}})),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw em(vb);const t=this.target,r=sg(),n=sg(),i=[];if(e={added:r,deleted:n,delta:i,keys:this.keys},this.transaction.changed.get(t).has(null)){let e=null;const o=()=>{e&&i.push(e)};for(let i=t._start;null!==i;i=i.right)i.deleted?this.deletes(i)&&!this.adds(i)&&((null===e||void 0===e.delete)&&(o(),e={delete:0}),e.delete+=i.length,n.add(i)):this.adds(i)?((null===e||void 0===e.insert)&&(o(),e={insert:[]}),e.insert=e.insert.concat(i.content.getContent()),r.add(i)):((null===e||void 0===e.retain)&&(o(),e={retain:0}),e.retain+=i.length);null!==e&&void 0===e.retain&&o()}this._changes=e}return e}}const bb=(e,t)=>{const r=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)r.unshift(t._item.parentSub);else{let e=0,n=t._item.parent._start;for(;n!==t._item&&null!==n;)n.deleted||e++,n=n.right;r.unshift(e)}t=t._item.parent}return r};let _b=0;class wb{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=_b++}}const Cb=(e,t,r)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=r,e.timestamp=_b++},Eb=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;const r=0===e._searchMarker.length?null:e._searchMarker.reduce(((e,r)=>gg(t-e.index)<gg(t-r.index)?e:r));let n=e._start,i=0;for(null!==r&&(n=r.p,i=r.index,(e=>{e.timestamp=_b++})(r));null!==n.right&&i<t;){if(!n.deleted&&n.countable){if(t<i+n.length)break;i+=n.length}n=n.right}for(;null!==n.left&&i>t;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;null!==n.left&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return null!==r&&gg(r.index-i)<n.parent.length/80?(Cb(r,n,i),r):((e,t,r)=>{if(e.length>=80){const n=e.reduce(((e,t)=>e.timestamp<t.timestamp?e:t));return Cb(n,t,r),n}{const n=new wb(t,r);return e.push(n),n}})(e._searchMarker,n,i)},Sb=(e,t,r)=>{for(let n=e.length-1;n>=0;n--){const i=e[n];if(r>0){let t=i.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)t=t.left,t&&!t.deleted&&t.countable&&(i.index-=t.length);if(null===t||!0===t.marker){e.splice(n,1);continue}i.p=t,t.marker=!0}(t<i.index||r>0&&t===i.index)&&(i.index=yg(t,i.index+r))}},kb=(e,t,r)=>{const n=e,i=t.changedParentTypes;for(;ag(i,e,(()=>[])).push(r),null!==e._item;)e=e._item.parent;gy(n._eH,r,t)};class xb{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=fy(),this._dEH=fy(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw tm()}clone(){throw tm()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){hy(this._eH,e)}observeDeep(e){hy(this._dEH,e)}unobserve(e){py(this._eH,e)}unobserveDeep(e){py(this._dEH,e)}toJSON(){}}const Ob=(e,t,r)=>{t<0&&(t=e._length+t),r<0&&(r=e._length+r);let n=r-t;const i=[];let o=e._start;for(;null!==o&&n>0;){if(o.countable&&!o.deleted){const e=o.content.getContent();if(e.length<=t)t-=e.length;else{for(let r=t;r<e.length&&n>0;r++)i.push(e[r]),n--;t=0}}o=o.right}return i},Ib=e=>{const t=[];let r=e._start;for(;null!==r;){if(r.countable&&!r.deleted){const e=r.content.getContent();for(let r=0;r<e.length;r++)t.push(e[r])}r=r.right}return t},Rb=(e,t)=>{let r=0,n=e._start;for(;null!==n;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let n=0;n<i.length;n++)t(i[n],r++,e)}n=n.right}},Tb=(e,t)=>{const r=[];return Rb(e,((n,i)=>{r.push(t(n,i,e))})),r},Ab=e=>{let t=e._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(null===r){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};r=t.content.getContent(),n=0,t=t.right}const e=r[n++];return r.length<=n&&(r=null),{done:!1,value:e}}}},Mb=(e,t)=>{const r=Eb(e,t);let n=e._start;for(null!==r&&(n=r.p,t-=r.index);null!==n;n=n.right)if(!n.deleted&&n.countable){if(t<n.length)return n.content.getContent()[t];t-=n.length}},Nb=(e,t,r,n)=>{let i=r;const o=e.doc,a=o.clientID,s=o.store,l=null===r?t._start:r.right;let c=[];const u=()=>{c.length>0&&(i=new $_(yy(a,Py(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new S_(c)),i.integrate(e,0),c=[])};n.forEach((r=>{if(null===r)c.push(r);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(r);break;default:switch(u(),r.constructor){case Uint8Array:case ArrayBuffer:i=new $_(yy(a,Py(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new v_(new Uint8Array(r))),i.integrate(e,0);break;case Wv:i=new $_(yy(a,Py(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new __(r)),i.integrate(e,0);break;default:if(!(r instanceof xb))throw new Error("Unexpected content type in insert operation");i=new $_(yy(a,Py(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new D_(r)),i.integrate(e,0)}}})),u()},Db=()=>em("Length exceeded!"),Pb=(e,t,r,n)=>{if(r>t._length)throw Db();if(0===r)return t._searchMarker&&Sb(t._searchMarker,r,n.length),Nb(e,t,null,n);const i=r,o=Eb(t,r);let a=t._start;for(null!==o&&(a=o.p,0===(r-=o.index)&&(a=a.prev,r+=a&&a.countable&&!a.deleted?a.length:0));null!==a;a=a.right)if(!a.deleted&&a.countable){if(r<=a.length){r<a.length&&$y(e,yy(a.id.client,a.id.clock+r));break}r-=a.length}return t._searchMarker&&Sb(t._searchMarker,i,n.length),Nb(e,t,a,n)},jb=(e,t,r,n)=>{if(0===n)return;const i=r,o=n,a=Eb(t,r);let s=t._start;for(null!==a&&(s=a.p,r-=a.index);null!==s&&r>0;s=s.right)!s.deleted&&s.countable&&(r<s.length&&$y(e,yy(s.id.client,s.id.clock+r)),r-=s.length);for(;n>0&&null!==s;)s.deleted||(n<s.length&&$y(e,yy(s.id.client,s.id.clock+n)),s.delete(e),n-=s.length),s=s.right;if(n>0)throw Db();t._searchMarker&&Sb(t._searchMarker,i,-o+n)},Fb=(e,t,r)=>{const n=t._map.get(r);void 0!==n&&n.delete(e)},Vb=(e,t,r,n)=>{const i=t._map.get(r)||null,o=e.doc,a=o.clientID;let s;if(null==n)s=new S_([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:s=new S_([n]);break;case Uint8Array:s=new v_(n);break;case Wv:s=new __(n);break;default:if(!(n instanceof xb))throw new Error("Unexpected content type");s=new D_(n)}new $_(yy(a,Py(o.store,a)),i,i&&i.lastId,null,null,t,r,s).integrate(e,0)},Lb=(e,t)=>{const r=e._map.get(t);return void 0===r||r.deleted?void 0:r.content.getContent()[r.length-1]},$b=e=>{const t={};return e._map.forEach(((e,r)=>{e.deleted||(t[r]=e.content.getContent()[e.length-1])})),t},Bb=(e,t)=>{const r=e._map.get(t);return void 0!==r&&!r.deleted},Ub=e=>((e,t)=>Rv((()=>{let r;do{r=e.next()}while(!r.done&&!t(r.value));return r})))(e.entries(),(e=>!e[1].deleted));class zb extends yb{constructor(e,t){super(e,t),this._transaction=t}}class Hb extends xb{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new Hb;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Hb}clone(){const e=new Hb;return e.insert(0,this.toArray().map((e=>e instanceof xb?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),kb(this,e,new zb(this,e))}insert(e,t){null!==this.doc?Jy(this.doc,(r=>{Pb(r,this,e,t)})):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?Jy(this.doc,(t=>{((e,t,r)=>{let n=(t._searchMarker||[]).reduce(((e,t)=>t.index>e.index?t:e),{index:0,p:t._start}).p;if(n)for(;n.right;)n=n.right;Nb(e,t,n,r)})(t,this,e)})):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?Jy(this.doc,(r=>{jb(r,this,e,t)})):this._prelimContent.splice(e,t)}get(e){return Mb(this,e)}toArray(){return Ib(this)}slice(e=0,t=this.length){return Ob(this,e,t)}toJSON(){return this.map((e=>e instanceof xb?e.toJSON():e))}map(e){return Tb(this,e)}forEach(e){Rb(this,e)}[Symbol.iterator](){return Ab(this)}_write(e){e.writeTypeRef(O_)}}class Wb extends yb{constructor(e,t,r){super(e,t),this.keysChanged=r}}class Gb extends xb{constructor(e){super(),this._prelimContent=null,this._prelimContent=void 0===e?new Map:new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach(((e,t)=>{this.set(t,e)})),this._prelimContent=null}_copy(){return new Gb}clone(){const e=new Gb;return this.forEach(((t,r)=>{e.set(r,t instanceof xb?t.clone():t)})),e}_callObserver(e,t){kb(this,e,new Wb(this,e,t))}toJSON(){const e={};return this._map.forEach(((t,r)=>{if(!t.deleted){const n=t.content.getContent()[t.length-1];e[r]=n instanceof xb?n.toJSON():n}})),e}get size(){return[...Ub(this._map)].length}keys(){return Tv(Ub(this._map),(e=>e[0]))}values(){return Tv(Ub(this._map),(e=>e[1].content.getContent()[e[1].length-1]))}entries(){return Tv(Ub(this._map),(e=>[e[0],e[1].content.getContent()[e[1].length-1]]))}forEach(e){this._map.forEach(((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)}))}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?Jy(this.doc,(t=>{Fb(t,this,e)})):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?Jy(this.doc,(r=>{Vb(r,this,e,t)})):this._prelimContent.set(e,t),t}get(e){return Lb(this,e)}has(e){return Bb(this,e)}clear(){null!==this.doc?Jy(this.doc,(e=>{this.forEach((function(t,r,n){Fb(e,n,r)}))})):this._prelimContent.clear()}_write(e){e.writeTypeRef(I_)}}const Kb=(e,t)=>e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&((e,t)=>e===t||Hm(e)===Hm(t)&&((e,t)=>{for(const r in e)if(!t(e[r],r))return!1;return!0})(e,((e,r)=>(void 0!==e||Wm(t,r))&&t[r]===e)))(e,t);class qb{constructor(e,t,r,n){this.left=e,this.right=t,this.index=r,this.currentAttributes=n}forward(){if(null===this.right&&rm(),this.right.content.constructor===C_)this.right.deleted||Zb(this.currentAttributes,this.right.content);else this.right.deleted||(this.index+=this.right.length);this.left=this.right,this.right=this.right.right}}const Yb=(e,t,r)=>{for(;null!==t.right&&r>0;){if(t.right.content.constructor===C_)t.right.deleted||Zb(t.currentAttributes,t.right.content);else t.right.deleted||(r<t.right.length&&$y(e,yy(t.right.id.client,t.right.id.clock+r)),t.index+=t.right.length,r-=t.right.length);t.left=t.right,t.right=t.right.right}return t},Jb=(e,t,r)=>{const n=new Map,i=Eb(t,r);if(i){const t=new qb(i.p.left,i.p,i.index,n);return Yb(e,t,r-i.index)}{const i=new qb(null,t._start,0,n);return Yb(e,i,r)}},Xb=(e,t,r,n)=>{for(;null!==r.right&&(!0===r.right.deleted||r.right.content.constructor===C_&&Kb(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();const i=e.doc,o=i.clientID;n.forEach(((n,a)=>{const s=r.left,l=r.right,c=new $_(yy(o,Py(i.store,o)),s,s&&s.lastId,l,l&&l.id,t,null,new C_(a,n));c.integrate(e,0),r.right=c,r.forward()}))},Zb=(e,t)=>{const{key:r,value:n}=t;null===n?e.delete(r):e.set(r,n)},Qb=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===C_&&Kb(t[e.right.content.key]||null,e.right.content.value));)e.forward()},e_=(e,t,r,n)=>{const i=e.doc,o=i.clientID,a=new Map;for(const s in n){const l=n[s],c=r.currentAttributes.get(s)||null;if(!Kb(c,l)){a.set(s,c);const{left:n,right:u}=r;r.right=new $_(yy(o,Py(i.store,o)),n,n&&n.lastId,u,u&&u.id,t,null,new C_(s,l)),r.right.integrate(e,0),r.forward()}}return a},t_=(e,t,r,n,i)=>{r.currentAttributes.forEach(((e,t)=>{void 0===i[t]&&(i[t]=null)}));const o=e.doc,a=o.clientID;Qb(r,i);const s=e_(e,t,r,i),l=n.constructor===String?new k_(n):n instanceof xb?new D_(n):new w_(n);let{left:c,right:u,index:d}=r;t._searchMarker&&Sb(t._searchMarker,r.index,l.getLength()),u=new $_(yy(a,Py(o.store,a)),c,c&&c.lastId,u,u&&u.id,t,null,l),u.integrate(e,0),r.right=u,r.index=d,r.forward(),Xb(e,t,r,s)},r_=(e,t,r,n,i)=>{const o=e.doc,a=o.clientID;Qb(r,i);const s=e_(e,t,r,i);e:for(;null!==r.right&&(n>0||s.size>0&&(r.right.deleted||r.right.content.constructor===C_));){if(!r.right.deleted)switch(r.right.content.constructor){case C_:{const{key:t,value:o}=r.right.content,a=i[t];if(void 0!==a){if(Kb(a,o))s.delete(t);else{if(0===n)break e;s.set(t,o)}r.right.delete(e)}else r.currentAttributes.set(t,o);break}default:n<r.right.length&&$y(e,yy(r.right.id.client,r.right.id.clock+n)),n-=r.right.length}r.forward()}if(n>0){let i="";for(;n>0;n--)i+="\n";r.right=new $_(yy(a,Py(o.store,a)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,t,null,new k_(i)),r.right.integrate(e,0),r.forward()}Xb(e,t,r,s)},n_=(e,t,r,n,i)=>{let o=t;const a=ig();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===C_){const e=o.content;a.set(e.key,e)}o=o.right}let s=0,l=!1;for(;t!==o;){if(r===t&&(l=!0),!t.deleted){const r=t.content;switch(r.constructor){case C_:{const{key:o,value:c}=r,u=n.get(o)||null;(a.get(o)!==r||u===c)&&(t.delete(e),s++,!l&&(i.get(o)||null)===c&&u!==c&&(null===u?i.delete(o):i.set(o,u))),!l&&!t.deleted&&Zb(i,r);break}}}t=t.right}return s},i_=e=>{let t=0;return Jy(e.doc,(r=>{let n=e._start,i=e._start,o=ig();const a=og(o);for(;i;){if(!1===i.deleted)if(i.content.constructor===C_)Zb(a,i.content);else t+=n_(r,n,i,o,a),o=og(a),n=i;i=i.right}})),t},o_=e=>{const t=new Set,r=e.doc;for(const[n,i]of e.afterState.entries()){const o=e.beforeState.get(n)||0;i!==o&&Uy(e,r.store.clients.get(n),o,i,(e=>{!e.deleted&&e.content.constructor===C_&&e.constructor!==m_&&t.add(e.parent)}))}Jy(r,(r=>{Nv(e,e.deleteSet,(e=>{if(e instanceof m_||!e.parent._hasFormatting||t.has(e.parent))return;const n=e.parent;e.content.constructor===C_?t.add(n):((e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const r=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===C_){const n=t.content.key;r.has(n)?t.delete(e):r.add(n)}t=t.left}})(r,e)}));for(const e of t)i_(e)}))},a_=(e,t,r)=>{const n=r,i=og(t.currentAttributes),o=t.right;for(;r>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case D_:case w_:case k_:r<t.right.length&&$y(e,yy(t.right.id.client,t.right.id.clock+r)),r-=t.right.length,t.right.delete(e)}t.forward()}o&&n_(e,o,t.right,i,t.currentAttributes);const a=(t.left||t.right).parent;return a._searchMarker&&Sb(a._searchMarker,t.index,-n+r),t};class s_ extends yb{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach((e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)}))}get changes(){if(null===this._changes){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){const e=this.target.doc,t=[];Jy(e,(e=>{const r=new Map,n=new Map;let i=this.target._start,o=null;const a={};let s="",l=0,c=0;const u=()=>{if(null!==o){let e=null;switch(o){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"==typeof s||s.length>0)&&(e={insert:s},r.size>0&&(e.attributes={},r.forEach(((t,r)=>{null!==t&&(e.attributes[r]=t)})))),s="";break;case"retain":l>0&&(e={retain:l},(e=>{for(const t in e)return!1;return!0})(a)||(e.attributes=Um({},a))),l=0}e&&t.push(e),o=null}};for(;null!==i;){switch(i.content.constructor){case D_:case w_:this.adds(i)?this.deletes(i)||(u(),o="insert",s=i.content.getContent()[0],u()):this.deletes(i)?("delete"!==o&&(u(),o="delete"),c+=1):i.deleted||("retain"!==o&&(u(),o="retain"),l+=1);break;case k_:this.adds(i)?this.deletes(i)||("insert"!==o&&(u(),o="insert"),s+=i.content.str):this.deletes(i)?("delete"!==o&&(u(),o="delete"),c+=i.length):i.deleted||("retain"!==o&&(u(),o="retain"),l+=i.length);break;case C_:{const{key:t,value:s}=i.content;if(this.adds(i)){if(!this.deletes(i)){const l=r.get(t)||null;Kb(l,s)?null!==s&&i.delete(e):("retain"===o&&u(),Kb(s,n.get(t)||null)?delete a[t]:a[t]=s)}}else if(this.deletes(i)){n.set(t,s);const e=r.get(t)||null;Kb(e,s)||("retain"===o&&u(),a[t]=e)}else if(!i.deleted){n.set(t,s);const r=a[t];void 0!==r&&(Kb(r,s)?null!==r&&i.delete(e):("retain"===o&&u(),null===s?delete a[t]:a[t]=s))}i.deleted||("insert"===o&&u(),Zb(r,i.content));break}}i=i.right}for(u();t.length>0;){const e=t[t.length-1];if(void 0===e.retain||void 0!==e.attributes)break;t.pop()}})),this._delta=t}return this._delta}}class l_ extends xb{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach((e=>e()))}catch(e){console.error(e)}this._pending=null}_copy(){return new l_}clone(){const e=new l_;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const r=new s_(this,e,t);kb(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===k_&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?Jy(this.doc,(r=>{const n=new qb(null,this._start,0,new Map);for(let i=0;i<e.length;i++){const o=e[i];if(void 0!==o.insert){const a=t||"string"!=typeof o.insert||i!==e.length-1||null!==n.right||"\n"!==o.insert.slice(-1)?o.insert:o.insert.slice(0,-1);("string"!=typeof a||a.length>0)&&t_(r,this,n,a,o.attributes||{})}else void 0!==o.retain?r_(r,this,n,o.retain,o.attributes||{}):void 0!==o.delete&&a_(r,n,o.delete)}})):this._pending.push((()=>this.applyDelta(e)))}toDelta(e,t,r){const n=[],i=new Map,o=this.doc;let a="",s=this._start;function l(){if(a.length>0){const e={};let t=!1;i.forEach(((r,n)=>{t=!0,e[n]=r}));const r={insert:a};t&&(r.attributes=e),n.push(r),a=""}}const c=()=>{for(;null!==s;){if(Ay(s,e)||void 0!==t&&Ay(s,t))switch(s.content.constructor){case k_:{const n=i.get("ychange");void 0===e||Ay(s,e)?void 0===t||Ay(s,t)?void 0!==n&&(l(),i.delete("ychange")):(void 0===n||n.user!==s.id.client||"added"!==n.type)&&(l(),i.set("ychange",r?r("added",s.id):{type:"added"})):(void 0===n||n.user!==s.id.client||"removed"!==n.type)&&(l(),i.set("ychange",r?r("removed",s.id):{type:"removed"})),a+=s.content.str;break}case D_:case w_:{l();const e={insert:s.content.getContent()[0]};if(i.size>0){const t={};e.attributes=t,i.forEach(((e,r)=>{t[r]=e}))}n.push(e);break}case C_:Ay(s,e)&&(l(),Zb(i,s.content))}s=s.right}l()};return e||t?Jy(o,(r=>{e&&My(r,e),t&&My(r,t),c()}),"cleanup"):c(),n}insert(e,t,r){if(t.length<=0)return;const n=this.doc;null!==n?Jy(n,(n=>{const i=Jb(n,this,e);r||(r={},i.currentAttributes.forEach(((e,t)=>{r[t]=e}))),t_(n,this,i,t,r)})):this._pending.push((()=>this.insert(e,t,r)))}insertEmbed(e,t,r={}){const n=this.doc;null!==n?Jy(n,(n=>{const i=Jb(n,this,e);t_(n,this,i,t,r)})):this._pending.push((()=>this.insertEmbed(e,t,r)))}delete(e,t){if(0===t)return;const r=this.doc;null!==r?Jy(r,(r=>{a_(r,Jb(r,this,e),t)})):this._pending.push((()=>this.delete(e,t)))}format(e,t,r){if(0===t)return;const n=this.doc;null!==n?Jy(n,(n=>{const i=Jb(n,this,e);null!==i.right&&r_(n,this,i,t,r)})):this._pending.push((()=>this.format(e,t,r)))}removeAttribute(e){null!==this.doc?Jy(this.doc,(t=>{Fb(t,this,e)})):this._pending.push((()=>this.removeAttribute(e)))}setAttribute(e,t){null!==this.doc?Jy(this.doc,(r=>{Vb(r,this,e,t)})):this._pending.push((()=>this.setAttribute(e,t)))}getAttribute(e){return Lb(this,e)}getAttributes(){return $b(this)}_write(e){e.writeTypeRef(R_)}}class c_{constructor(e,t=(()=>!0)){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==d_&&t.constructor!==u_||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class u_ extends xb{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new u_}clone(){const e=new u_;return e.insert(0,this.toArray().map((e=>e instanceof xb?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new c_(this,e)}querySelector(e){e=e.toUpperCase();const t=new c_(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),ug(new c_(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)))}_callObserver(e,t){kb(this,e,new f_(this,t,e))}toString(){return Tb(this,(e=>e.toString())).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){const n=e.createDocumentFragment();return void 0!==r&&r._createAssociation(n,this),Rb(this,(i=>{n.insertBefore(i.toDOM(e,t,r),null)})),n}insert(e,t){null!==this.doc?Jy(this.doc,(r=>{Pb(r,this,e,t)})):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)Jy(this.doc,(r=>{const n=e&&e instanceof xb?e._item:e;Nb(r,this,n,t)}));else{const r=this._prelimContent,n=null===e?0:r.findIndex((t=>t===e))+1;if(0===n&&null!==e)throw em("Reference item not found");r.splice(n,0,...t)}}delete(e,t=1){null!==this.doc?Jy(this.doc,(r=>{jb(r,this,e,t)})):this._prelimContent.splice(e,t)}toArray(){return Ib(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Mb(this,e)}slice(e=0,t=this.length){return Ob(this,e,t)}forEach(e){Rb(this,e)}_write(e){e.writeTypeRef(A_)}}class d_ extends u_{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach(((e,t)=>{this.setAttribute(t,e)})),this._prelimAttrs=null}_copy(){return new d_(this.nodeName)}clone(){const e=new d_(this.nodeName);return((e,t)=>{for(const r in e)t(e[r],r)})(this.getAttributes(),((t,r)=>{"string"==typeof t&&e.setAttribute(r,t)})),e.insert(0,this.toArray().map((e=>e instanceof xb?e.clone():e))),e}toString(){const e=this.getAttributes(),t=[],r=[];for(const t in e)r.push(t);r.sort();const n=r.length;for(let i=0;i<n;i++){const n=r[i];t.push(n+'="'+e[n]+'"')}const i=this.nodeName.toLocaleLowerCase();return`<${i}${t.length>0?" "+t.join(" "):""}>${super.toString()}</${i}>`}removeAttribute(e){null!==this.doc?Jy(this.doc,(t=>{Fb(t,this,e)})):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?Jy(this.doc,(r=>{Vb(r,this,e,t)})):this._prelimAttrs.set(e,t)}getAttribute(e){return Lb(this,e)}hasAttribute(e){return Bb(this,e)}getAttributes(){return $b(this)}toDOM(e=document,t={},r){const n=e.createElement(this.nodeName),i=this.getAttributes();for(const e in i){const t=i[e];"string"==typeof t&&n.setAttribute(e,t)}return Rb(this,(i=>{n.appendChild(i.toDOM(e,t,r))})),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(T_),e.writeKey(this.nodeName)}}class f_ extends yb{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach((e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)}))}}class h_ extends Gb{constructor(e){super(),this.hookName=e}_copy(){return new h_(this.hookName)}clone(){const e=new h_(this.hookName);return this.forEach(((t,r)=>{e.set(r,t)})),e}toDOM(e=document,t={},r){const n=t[this.hookName];let i;return i=void 0!==n?n.createDom(this):document.createElement(this.hookName),i.setAttribute("data-yjs-hook",this.hookName),void 0!==r&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(M_),e.writeKey(this.hookName)}}class p_ extends l_{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new p_}clone(){const e=new p_;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){const n=e.createTextNode(this.toString());return void 0!==r&&r._createAssociation(n,this),n}toString(){return this.toDelta().map((e=>{const t=[];for(const r in e.attributes){const n=[];for(const t in e.attributes[r])n.push({key:t,value:e.attributes[r][t]});n.sort(((e,t)=>e.key<t.key?-1:1)),t.push({nodeName:r,attrs:n})}t.sort(((e,t)=>e.nodeName<t.nodeName?-1:1));let r="";for(let e=0;e<t.length;e++){const n=t[e];r+=`<${n.nodeName}`;for(let e=0;e<n.attrs.length;e++){const t=n.attrs[e];r+=` ${t.key}="${t.value}"`}r+=">"}r+=e.insert;for(let e=t.length-1;e>=0;e--)r+=`</${t[e].nodeName}>`;return r})).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(N_)}}class g_{constructor(e,t){this.id=e,this.length=t}get deleted(){throw tm()}mergeWith(e){return!1}write(e,t,r){throw tm()}integrate(e,t){throw tm()}}class m_ extends g_{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),jy(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class v_{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new v_(this.content)}splice(e){throw tm()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class y_{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new y_(this.len)}splice(e){const t=new y_(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Fv(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const b_=(e,t)=>new Wv({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class __{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new __(b_(this.doc.guid,this.opts))}splice(e){throw tm()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class w_{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new w_(this.embed)}splice(e){throw tm()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class C_{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new C_(this.key,this.value)}splice(e){throw tm()}mergeWith(e){return!1}integrate(e,t){const r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class E_{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new E_(this.arr)}splice(e){const t=new E_(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){const t=this.arr[n];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}class S_{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new S_(this.arr)}splice(e){const t=new S_(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){const t=this.arr[n];e.writeAny(t)}}getRef(){return 8}}class k_{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new k_(this.str)}splice(e){const t=new k_(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"�",t.str="�"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}const x_=[e=>new Hb,e=>new Gb,e=>new l_,e=>new d_(e.readKey()),e=>new u_,e=>new h_(e.readKey()),e=>new p_],O_=0,I_=1,R_=2,T_=3,A_=4,M_=5,N_=6;class D_{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new D_(this.type._copy())}splice(e){throw tm()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach((t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)})),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach((t=>{for(;null!==t;)t.gc(e,!0),t=t.left})),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const P_=(e,t)=>{let r,n=t,i=0;do{i>0&&(n=yy(n.client,n.clock+i)),r=Vy(e,n),i=n.clock-r.id.clock,n=r.redone}while(null!==n&&r instanceof $_);return{item:r,diff:i}},j_=(e,t)=>{for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},F_=(e,t,r)=>{const{client:n,clock:i}=t.id,o=new $_(yy(n,i+r),t,yy(n,i+r-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(r));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),null!==t.redone&&(o.redone=yy(t.redone.client,t.redone.clock+r)),t.right=o,null!==o.right&&(o.right.left=o),e._mergeStructs.push(o),null!==o.parentSub&&null===o.right&&o.parent._map.set(o.parentSub,o),t.length=r,o},V_=(e,t)=>((e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r,e))return!0;return!1})(e,(e=>Dv(e.deletions,t))),L_=(e,t,r,n,i,o)=>{const a=e.doc,s=a.store,l=a.clientID,c=t.redone;if(null!==c)return $y(e,c);let u,d=t.parent._item,f=null;if(null!==d&&!0===d.deleted){if(null===d.redone&&(!r.has(d)||null===L_(e,d,r,n,i,o)))return null;for(;null!==d.redone;)d=$y(e,d.redone)}const h=null===d?t.parent:d.content.type;if(null===t.parentSub){for(f=t.left,u=t;null!==f;){let t=f;for(;null!==t&&t.parent._item!==d;)t=null===t.redone?null:$y(e,t.redone);if(null!==t&&t.parent._item===d){f=t;break}f=f.left}for(;null!==u;){let t=u;for(;null!==t&&t.parent._item!==d;)t=null===t.redone?null:$y(e,t.redone);if(null!==t&&t.parent._item===d){u=t;break}u=u.right}}else if(u=null,t.right&&!i){for(f=t;null!==f&&null!==f.right&&(f.right.redone||Dv(n,f.right.id)||V_(o.undoStack,f.right.id)||V_(o.redoStack,f.right.id));)for(f=f.right;f.redone;)f=$y(e,f.redone);if(f&&null!==f.right)return null}else f=h._map.get(t.parentSub)||null;const p=Py(s,l),g=yy(l,p),m=new $_(g,f,f&&f.lastId,u,u&&u.id,h,t.parentSub,t.content.copy());return t.redone=g,j_(m,!0),m.integrate(e,0),m};class $_ extends g_{constructor(e,t,r,n,i,o,a,s){super(e,s.getLength()),this.origin=r,this.left=t,this.right=n,this.rightOrigin=i,this.parent=o,this.parentSub=a,this.redone=null,this.content=s,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Py(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Py(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===my&&this.id.client!==this.parent.client&&this.parent.clock>=Py(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=By(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=$y(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===m_||this.right&&this.right.constructor===m_)this.parent=null;else if(this.parent){if(this.parent.constructor===my){const e=Vy(t,this.parent);e.constructor===m_?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===$_&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===$_&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=By(e,e.doc.store,yy(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,r=this.left;if(null!==r)t=r.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;const n=new Set,i=new Set;for(;null!==t&&t!==this.right;){if(i.add(t),n.add(t),vy(this.origin,t.origin)){if(t.id.client<this.id.client)r=t,n.clear();else if(vy(this.rightOrigin,t.rightOrigin))break}else{if(null===t.origin||!i.has(Vy(e.doc.store,t.origin)))break;n.has(Vy(e.doc.store,t.origin))||(r=t,n.clear())}t=t.right}this.left=r}if(null!==this.left){const e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),jy(e.doc.store,this),this.content.integrate(e,this),Wy(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new m_(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:yy(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&vy(e.origin,this.lastId)&&this.right===e&&vy(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach((t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))})),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),Fv(e.deleteSet,this.id.client,this.id.clock,this.length),Wy(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw rm();this.content.gc(e),t?((e,t,r)=>{const n=e.clients.get(t.id.client);n[Fy(n,t.id.clock)]=r})(e,this,new m_(this.id,this.length)):this.content=new y_(this.length)}write(e,t){const r=t>0?yy(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,i=this.parentSub,o=31&this.content.getRef()|(null===r?0:wg)|(null===n?0:_g)|(null===i?0:32);if(e.writeInfo(o),null!==r&&e.writeLeftID(r),null!==n&&e.writeRightID(n),null===r&&null===n){const t=this.parent;if(void 0!==t._item){const r=t._item;if(null===r){const r=wy(t);e.writeParentInfo(!0),e.writeString(r)}else e.writeParentInfo(!1),e.writeLeftID(r.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===my?(e.writeParentInfo(!1),e.writeLeftID(t)):rm();null!==i&&e.writeString(i)}this.content.write(e,t)}}const B_=(e,t)=>U_[31&t](e),U_=[()=>{rm()},e=>new y_(e.readLen()),e=>{const t=e.readLen(),r=[];for(let n=0;n<t;n++){const t=e.readString();"undefined"===t?r.push(void 0):r.push(JSON.parse(t))}return new E_(r)},e=>new v_(e.readBuf()),e=>new k_(e.readString()),e=>new w_(e.readJSON()),e=>new C_(e.readKey(),e.readJSON()),e=>new D_(x_[e.readTypeRef()](e)),e=>{const t=e.readLen(),r=[];for(let n=0;n<t;n++)r.push(e.readAny());return new S_(r)},e=>new __(b_(e.readString(),e.readAny())),()=>{rm()}];class z_ extends g_{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){rm()}write(e,t){e.writeInfo(10),Vg(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const H_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof hr<"u"?hr:{},W_="__ $YJS$ __";!0===H_[W_]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),H_[W_]=!0;const G_=Object.freeze(Object.defineProperty({__proto__:null,AbsolutePosition:Sy,AbstractConnector:class extends hg{constructor(e,t){super(),this.doc=e,this.awareness=t}},AbstractStruct:g_,AbstractType:xb,Array:Hb,ContentAny:S_,ContentBinary:v_,ContentDeleted:y_,ContentEmbed:w_,ContentFormat:C_,ContentJSON:E_,ContentString:k_,ContentType:D_,Doc:Wv,GC:m_,ID:my,Item:$_,Map:Gb,PermanentUserData:class{constructor(e,t=e.getMap("users")){const r=new Map;this.yusers=t,this.doc=e,this.clients=new Map,this.dss=r;const n=(e,t)=>{const r=e.get("ds"),n=e.get("ids"),i=e=>this.clients.set(e,t);r.observe((e=>{e.changes.added.forEach((e=>{e.content.getContent().forEach((e=>{e instanceof Uint8Array&&this.dss.set(t,jv([this.dss.get(t)||Vv(),Bv(new Gv(am(e)))]))}))}))})),this.dss.set(t,jv(r.map((e=>Bv(new Gv(am(e))))))),n.observe((e=>e.changes.added.forEach((e=>e.content.getContent().forEach(i))))),n.forEach(i)};t.observe((e=>{e.keysChanged.forEach((e=>n(t.get(e),e)))})),t.forEach(n)}setUserMapping(e,t,r,{filter:n=(()=>!0)}={}){const i=this.yusers;let o=i.get(r);o||(o=new Gb,o.set("ids",new Hb),o.set("ds",new Hb),i.set(r,o)),o.get("ids").push([t]),i.observe((e=>{setTimeout((()=>{const e=i.get(r);if(e!==o){o=e,this.clients.forEach(((e,t)=>{r===e&&o.get("ids").push([t])}));const t=new Jv,n=this.dss.get(r);n&&($v(t,n),o.get("ds").push([t.toUint8Array()]))}}),0)})),e.on("afterTransaction",(e=>{setTimeout((()=>{const t=o.get("ds"),r=e.deleteSet;if(e.local&&r.clients.size>0&&n(e,r)){const e=new Jv;$v(e,r),t.push([e.toUint8Array()])}}))}))}getUserByClientId(e){return this.clients.get(e)||null}getUserByDeletedId(e){for(const[t,r]of this.dss.entries())if(Dv(r,e))return t;return null}},RelativePosition:Ey,Snapshot:xy,Text:l_,Transaction:zy,UndoManager:eb,UpdateEncoderV1:Xv,XmlElement:d_,XmlFragment:u_,XmlHook:h_,XmlText:p_,YArrayEvent:zb,YEvent:yb,YMapEvent:Wb,YTextEvent:s_,YXmlEvent:f_,applyUpdate:ny,applyUpdateV2:ry,cleanupYTextFormatting:i_,compareIDs:vy,compareRelativePositions:(e,t)=>e===t||null!==e&&null!==t&&e.tname===t.tname&&vy(e.item,t.item)&&vy(e.type,t.type)&&e.assoc===t.assoc,convertUpdateFormatV1ToV2:e=>pb(e,qm,Kv,Qv),convertUpdateFormatV2ToV1:mb,createAbsolutePositionFromRelativePosition:(e,t)=>{const r=t.store,n=e.item,i=e.type,o=e.tname,a=e.assoc;let s=null,l=0;if(null!==n){if(Py(r,n.client)<=n.clock)return null;const e=P_(r,n),t=e.item;if(!(t instanceof $_))return null;if(s=t.parent,null===s._item||!s._item.deleted){l=t.deleted||!t.countable?0:e.diff+(a>=0?0:1);let r=t.left;for(;null!==r;)!r.deleted&&r.countable&&(l+=r.length),r=r.left}}else{if(null!==o)s=t.get(o);else{if(null===i)throw rm();{if(Py(r,i.client)<=i.clock)return null;const{item:e}=P_(r,i);if(!(e instanceof $_&&e.content instanceof D_))return null;s=e.content.type}}l=a>=0?s._length:0}return((e,t,r=0)=>new Sy(e,t,r))(s,l,e.assoc)},createDeleteSet:Vv,createDeleteSetFromStructStore:Lv,createDocFromSnapshot:(e,t,r=new Wv)=>{if(e.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:n,ds:i}=t,o=new Qv;return e.transact((t=>{let r=0;n.forEach((e=>{e>0&&r++})),Vg(o.restEncoder,r);for(const[r,i]of n){if(0===i)continue;i<Py(e.store,r)&&$y(t,yy(r,i));const n=e.store.clients.get(r)||[],a=Fy(n,i-1);Vg(o.restEncoder,a+1),o.writeClient(r),Vg(o.restEncoder,0);for(let e=0;e<=a;e++)n[e].write(o,0)}$v(o,i)})),ry(r,o.toUint8Array(),"snapshot"),r},createID:yy,createRelativePositionFromJSON:e=>new Ey(null==e.type?null:yy(e.type.client,e.type.clock),e.tname||null,null==e.item?null:yy(e.item.client,e.item.clock),null==e.assoc?0:e.assoc),createRelativePositionFromTypeIndex:(e,t,r=0)=>{let n=e._start;if(r<0){if(0===t)return ky(e,null,r);t--}for(;null!==n;){if(!n.deleted&&n.countable){if(n.length>t)return ky(e,yy(n.id.client,n.id.clock+t),r);t-=n.length}if(null===n.right&&r<0)return ky(e,n.lastId,r);n=n.right}return ky(e,null,r)},createSnapshot:Ry,decodeRelativePosition:e=>(e=>{let t=null,r=null,n=null;switch(um(e)){case 0:n=_y(e);break;case 1:r=fm(e);break;case 2:t=_y(e)}const i=sm(e)?dm(e):0;return new Ey(t,r,n,i)})(am(e)),decodeSnapshot:e=>Iy(e,new Gv(am(e))),decodeSnapshotV2:Iy,decodeStateVector:sy,decodeUpdate:e=>nb(e,Kv),decodeUpdateV2:nb,diffUpdate:(e,t)=>ub(e,t,Kv,Xv),diffUpdateV2:ub,emptySnapshot:Ty,encodeRelativePosition:e=>{const t=Dg();return((e,t)=>{const{type:r,tname:n,item:i,assoc:o}=t;if(null!==i)Vg(e,0),by(e,i);else if(null!==n)Fg(e,1),Ug(e,n);else{if(null===r)throw rm();Fg(e,2),by(e,r)}Lg(e,o)})(t,e),Pg(t)},encodeSnapshot:e=>Oy(e,new Jv),encodeSnapshotV2:Oy,encodeStateAsUpdate:oy,encodeStateAsUpdateV2:iy,encodeStateVector:uy,encodeStateVectorFromUpdate:e=>ab(e,Jv,Kv),encodeStateVectorFromUpdateV2:ab,equalDeleteSets:zv,equalSnapshots:(e,t)=>{const r=e.ds.clients,n=t.ds.clients,i=e.sv,o=t.sv;if(i.size!==o.size||r.size!==n.size)return!1;for(const[e,t]of i.entries())if(o.get(e)!==t)return!1;for(const[e,t]of r.entries()){const r=n.get(e)||[];if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++){const n=t[e],i=r[e];if(n.clock!==i.clock||n.len!==i.len)return!1}}return!0},findIndexSS:Fy,findRootTypeKey:wy,getItem:Vy,getState:Py,getTypeChildren:e=>{let t=e._start;const r=[];for(;t;)r.push(t),t=t.right;return r},isDeleted:Dv,isParentOf:Cy,iterateDeletedStructs:Nv,logType:e=>{const t=[];let r=e._start;for(;r;)t.push(r),r=r.right;console.log("Children: ",t),console.log("Children content: ",t.filter((e=>!e.deleted)).map((e=>e.content)))},logUpdate:e=>rb(e,Kv),logUpdateV2:rb,mergeUpdates:ob,mergeUpdatesV2:cb,obfuscateUpdate:(e,t)=>pb(e,gb(t),Kv,Xv),obfuscateUpdateV2:(e,t)=>pb(e,gb(t),Yv,Qv),parseUpdateMeta:e=>sb(e,Kv),parseUpdateMetaV2:sb,readUpdate:(e,t,r)=>ty(e,t,r,new Kv(e)),readUpdateV2:ty,relativePositionToJSON:e=>{const t={};return e.type&&(t.type=e.type),e.tname&&(t.tname=e.tname),e.item&&(t.item=e.item),null!=e.assoc&&(t.assoc=e.assoc),t},snapshot:e=>Ry(Lv(e.store),Dy(e.store)),snapshotContainsUpdate:(e,t)=>((e,t,r=Yv)=>{const n=new r(am(t)),i=new tb(n,!1);for(let t=i.curr;null!==t;t=i.next())if((e.sv.get(t.id.client)||0)<t.id.clock+t.length)return!1;const o=jv([e.ds,Bv(n)]);return zv(e.ds,o)})(e,t,Kv),transact:Jy,tryGc:(e,t,r)=>{Ky(e,t,r),qy(e,t)},typeListToArraySnapshot:(e,t)=>{const r=[];let n=e._start;for(;null!==n;){if(n.countable&&Ay(n,t)){const e=n.content.getContent();for(let t=0;t<e.length;t++)r.push(e[t])}n=n.right}return r},typeMapGetSnapshot:(e,t,r)=>{let n=e._map.get(t)||null;for(;null!==n&&(!r.sv.has(n.id.client)||n.id.clock>=(r.sv.get(n.id.client)||0));)n=n.left;return null!==n&&Ay(n,r)?n.content.getContent()[n.length-1]:void 0}},Symbol.toStringTag,{value:"Module"}));class K_{constructor(){this.ydoc=new Wv,this.ydata=this.ydoc.getMap()}get data(){return this.ydata}newMap(e,t){const r=new Gb;e&&Object.keys(e).forEach((t=>{r.set(t,e[t])}));const n=r.get;if(r.get=e=>{var t,i,o;const a=n.call(r,e);if(!a){const n=null==(t=r._map)?void 0:t.get(e);if(n)return null==(o=null==(i=n.content)?void 0:i.arr)?void 0:o[0]}return a},t)for(const e of t)Object.defineProperty(r,e.name,{get:function(){return console.warn(`please use .get('${e.name}').`),r.get(e.name)}});return r}newArray(e){const t=new Hb;return e&&t.push(e.map((e=>vc(e)?this.newMap(e):e))),t}transact(e){this.ydoc.transact(e,this)}destroy(){var e;null==(e=this.ydoc)||e.destroy(),this.ydoc=null,this.ydata=null,this._spellEventObj=null,this._storageEventObj=null}}class q_{constructor(e){this.canUndo=!1,this.canRedo=!1,this._yUndoManager=new eb(e.ydata,{captureTimeout:0,trackedOrigins:new Set([e])}),this._yUndoManager.on("stack-item-added",(()=>{this._setCanUndoRedo()})),this._yUndoManager.on("stack-item-popped",(()=>{this._setCanUndoRedo()}))}_setCanUndoRedo(){const{_yUndoManager:e}=this;this.canRedo=e.canRedo(),this.canUndo=e.canUndo()}stopCapturing(){this._yUndoManager.stopCapturing()}undo(){const{_yUndoManager:e}=this;e.undo()}redo(){const{_yUndoManager:e}=this;e.redo()}destroy(){this._yUndoManager.destroy()}}var Y_=Object.defineProperty,J_=Object.getOwnPropertyDescriptor,X_=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?J_(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Y_(t,r,o),o};let Z_=class{init(){this._ystruct=new K_,this._yhistory=new q_(this._ystruct)}get ystruct(){return this._ystruct}get doc(){return this._ystruct.ydoc}get data(){return this._ystruct.data}newMap(e,t){return null!=e&&e._map?e:this._ystruct.newMap(e,t)}newArray(e){return this._ystruct.newArray(e)}transact(e){this._ystruct.transact(e)}canUndo(){return this._yhistory.canUndo}canRedo(){return this._yhistory.canRedo}undo(){this._yhistory.undo()}redo(){this._yhistory.redo()}destroy(){this._ystruct.destroy(),this._yhistory.destroy()}};X_([Oi()],Z_.prototype,"init",1),X_([Ii()],Z_.prototype,"destroy",1),Z_=X_([io({token:Pp})],Z_);var Q_=Object.defineProperty,ew=Object.getOwnPropertyDescriptor,tw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ew(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Q_(t,r,o),o};let rw=class extends fp{constructor(){super(...arguments),this._onChange=this._register(new _p),this.onChange=this._onChange.event,this.emitChange=e=>{Oo((()=>{this._onChange.emit(e)}))},this._onChangeWithSlient=this._register(new _p),this.onChangeWithSlient=this._onChange.event,this.emitChangeWithSilent=e=>{Oo((()=>{this._onChangeWithSlient.emit(e)}))},this._onChangeAllways=this._register(new _p),this.onChangeAllways=this._onChange.event,this.emitChangeAllways=e=>{Oo((()=>{this._onChangeAllways.emit(e)}))}}destroy(){super.destroy()}};tw([Ii()],rw.prototype,"destroy",1),rw=tw([io({token:Lh})],rw);const nw=null;var iw=Object.defineProperty,ow=Object.getOwnPropertyDescriptor,aw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ow(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iw(t,r,o),o};let sw=class{constructor(){this._modelMap=new Map}init(e=[]){const t=this._modelProvider.getContributions();for(const r of t)try{r.registerModel&&e.push(r.registerModel()),r.registerModels&&(e=e.concat(r.registerModels()))}catch(e){console.error(e)}for(const t of e)this._initTable(t),this._modelMap.set(t.table,t)}getModel(e){return this._modelMap.get(e)}_initTable(e){if(!e.table)throw new Error("Model must have a name");const t=e.columns||{};return t.uuid={name:"uuid"},t.created_at={name:"created_at"},t.updated_at={name:"updated_at"},this._driver.initTable({name:e.table,indexes:e.indexes,columns:t?Object.keys(t).map((e=>t[e])):[]}),this}};aw([wh(eg)],sw.prototype,"_modelProvider",2),aw([ao(jh)],sw.prototype,"_driver",2),sw=aw([io()],sw);var lw=Object.defineProperty,cw=Object.getOwnPropertyDescriptor,uw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lw(t,r,o),o};let dw=class{init(e){this._configuration.registerConfiguration({id:"model",type:"object",title:"数据模型",properties:{frozenTable:{type:"array",description:"固化表，普通刷新不清空内容"}}}),this._modelRegistry.init(null==e?void 0:e.models)}};function fw(e,t){const{Model:r}=e,n={};for(const e in t){const i=r.columns[e],o=t[e];!i||(i.type?n[e]=i.type.toValue(o):n[e]=o)}return n}function hw(e,t){let r;if(Array.isArray(t)){r=[];for(const n of t)r.push(fw(e,n))}else r=fw(e,t);return r}uw([ao(lp)],dw.prototype,"_configuration",2),uw([ao(sw)],dw.prototype,"_modelRegistry",2),dw=uw([io({token:$h})],dw);class pw{constructor(e,t,r){this.sets=[],this.groups=[],this.orders=[],this.offset=0,this.Model=e,this.table=e.table,this.command=Bh.SELECT,this._driver=t,this._executeOpts=r}execute(){if(!this._driver)return;let e=this._driver.execute(this.toObject(),this._executeOpts);return e={...e,spell:this},e}$insert(e){return this.command=Bh.INSERT,this.sets=hw(this,e),this}$update(e){return this.command=Bh.UPDATE,this.sets=hw(this,e),this}$upsert(e){return this.command=Bh.UPSERT,this.sets=hw(this,e),this}$delete(){return this.command=Bh.DELETE,this}$bulkInsert(e){return this.command=Bh.BULK_INSERT,this.sets=hw(this,e),this}$insertAfter(e){return this.command=Bh.INSERT_AFTER,this.sets=hw(this,e),this}$insertBefore(e){return this.command=Bh.INSERT_BEFORE,this.sets=hw(this,e),this}$moveAfter(e){return this.command=Bh.MOVE_AFTER,this.sets=hw(this,e),this}$moveBefore(e){return this.command=Bh.MOVE_BEFORE,this.sets=hw(this,e),this}$where(e){return this.where=e,this}$offset(e){if(Number.isNaN(e))throw new Error(`invalid offset ${e}`);return this.offset=e,this}$limit(e){if(Number.isNaN(e))throw new Error(`invalid limit ${e}`);return this.limit=e,this}toObject(){return{table:this.table,command:this.command,where:this.where,sets:this.sets,offset:this.offset,limit:this.limit}}}function gw(e,t){if(null!=e&&null!=t){for(const r in t){const n=e[r],{defaultValue:i}=t[r];void 0===n&&null!=i&&(e[r]=i)}return e}}class mw{constructor(e,t){this.timestamps={updatedAt:"updated_at",createdAt:"created_at"},this.Model=e,this.driver=t}count(...e){return this.find(...e).length}find(e={},t){const r=new pw(this.Model,this.driver);if(r.$where(e),t)for(const e of["order","limit","offset","select"]){const n=t[e];null!=n&&r[`$${e}`](n)}const n=r.execute();return null!=n&&n.rows&&0!==n.rows.length?n.rows:new Yh}findOne(e){const t=this.find(e);return t&&t.get(0)?t.get(0):null}findById(e){const t={uuid:e},r=this.find(t);return r&&r.get(0)?r.get(0):null}remove(e){return new pw(this.Model,this.driver).$where(e).$delete().execute().affectedRows}update(e,t={},r={}){var n;const{updatedAt:i}=this.timestamps,o=Object.assign({},t);return(null==(n=this.Model.columns)?void 0:n[i])&&!o[i]&&!r.silent&&(o[i]=+new Date),new pw(this.Model,this.driver,r).$where(e).$update(o).execute().rows}upsert(e,t,r){var n;const{updatedAt:i}=this.timestamps,o=Object.assign({},t);(null==(n=this.Model.columns)?void 0:n[i])&&!o[i]&&(o[i]=+new Date);const a=new pw(this.Model,this.driver,r).$where(e).$upsert(o).execute();return null==a?void 0:a.rows}bulkCreate(e,t={}){if(!e||!e.length)return e;const{columns:r}=this,{createdAt:n,updatedAt:i}=this.timestamps,o=new Date;for(const t of e)n&&(t[n]=+o),i&&(t[i]=+o),gw(t,r);return t={...t,columns:r},new pw(this.Model,this.driver).$bulkInsert(e).execute(),e}moveAfter(e,t){return t=Object.assign({},t),new pw(this.Model,this.driver).$where(e).$moveAfter(t).execute().rows}moveBefore(e,t){return t=Object.assign({},t),new pw(this.Model,this.driver).$where(e).$moveBefore(t).execute().rows}create(e){const t=new pw(this.Model,this.driver).$insert(this._getCreateValue(e)).execute();return this.findOne({uuid:t.rows.uuid}).toJSON()}createAfter(e,t={}){const r=Object.assign({},t),n=new pw(this.Model,this.driver).$where(e).$insertAfter(this._getCreateValue(r)).execute();return this.findOne({uuid:n.rows.uuid}).toJSON()}createBefore(e,t={}){const r=Object.assign({},t),n=new pw(this.Model,this.driver).$where(e).$insertBefore(this._getCreateValue(r)).execute();return this.findOne({uuid:n.rows.uuid}).toJSON()}_getCreateValue(e){const{columns:t}=this.Model,{createdAt:r,updatedAt:n}=this.timestamps,i={},o=new Date;null!=t&&t[r]&&(this[r]=+o),null!=t&&t[n]&&(this[n]=+o);for(const r in t){const n=e[r],{defaultValue:o}=t[r];null!=n?i[r]=n:void 0===n&&null!=o&&(i[r]=o)}return i}}var vw=Object.defineProperty,yw=Object.getOwnPropertyDescriptor,bw=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vw(t,r,o),o};let _w=class{getModel(e){const t=this._modelRegistry.getModel(e);return new mw(t,this._driver)}};bw([ao(sw)],_w.prototype,"_modelRegistry",2),bw([ao(jh)],_w.prototype,"_driver",2),_w=bw([io()],_w);var ww=Object.defineProperty,Cw=Object.getOwnPropertyDescriptor,Ew=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cw(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ww(t,r,o),o};let Sw=class{transact(e){this._struct.transact(e)}canUndo(){return this._struct.canUndo()}canRedo(){return this._struct.canRedo()}undo(){this._struct.undo()}redo(){this._struct.redo()}};Ew([ao(Pp)],Sw.prototype,"_struct",2),Sw=Ew([io()],Sw);const kw=xo().contribution(eg).register(ap).register(qh).register(rp).register(Zh).register(Zp).register(Z_).register(History).register(rw).register(dw).register(_w).register(sw).register(Sw);function xw(e={}){return function(t,r){const n=t.constructor;n.columns||(n.columns={}),n.columns[r]={...e,name:r}}}class Ow{}var Iw={};Iw.deprecate=(e,t)=>{let r=!0;return function(){return r&&(console.warn("DeprecationWarning: "+t),r=!1),e.apply(this,arguments)}};const Rw=Iw.deprecate((()=>{}),"Hook.context is deprecated and will be removed"),Tw=function(...e){return this.call=this._createCall("sync"),this.call(...e)},Aw=function(...e){return this.callAsync=this._createCall("async"),this.callAsync(...e)},Mw=function(...e){return this.promise=this._createCall("promise"),this.promise(...e)};class Nw{constructor(e=[],t=void 0){this._args=e,this.name=t,this.taps=[],this.interceptors=[],this._call=Tw,this.call=Tw,this._callAsync=Aw,this.callAsync=Aw,this._promise=Mw,this.promise=Mw,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}compile(e){throw new Error("Abstract: should be overridden")}_createCall(e){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:e})}_tap(e,t,r){if("string"==typeof t)t={name:t.trim()};else if("object"!=typeof t||null===t)throw new Error("Invalid tap options");if("string"!=typeof t.name||""===t.name)throw new Error("Missing name for tap");typeof t.context<"u"&&Rw(),t=Object.assign({type:e,fn:r},t),t=this._runRegisterInterceptors(t),this._insert(t)}tap(e,t){this._tap("sync",e,t)}tapAsync(e,t){this._tap("async",e,t)}tapPromise(e,t){this._tap("promise",e,t)}_runRegisterInterceptors(e){for(const t of this.interceptors)if(t.register){const r=t.register(e);void 0!==r&&(e=r)}return e}withOptions(e){const t=t=>Object.assign({},e,"string"==typeof t?{name:t}:t);return{name:this.name,tap:(e,r)=>this.tap(t(e),r),tapAsync:(e,r)=>this.tapAsync(t(e),r),tapPromise:(e,r)=>this.tapPromise(t(e),r),intercept:e=>this.intercept(e),isUsed:()=>this.isUsed(),withOptions:e=>this.withOptions(t(e))}}isUsed(){return this.taps.length>0||this.interceptors.length>0}intercept(e){if(this._resetCompilation(),this.interceptors.push(Object.assign({},e)),e.register)for(let t=0;t<this.taps.length;t++)this.taps[t]=e.register(this.taps[t])}_resetCompilation(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}_insert(e){let t;this._resetCompilation(),"string"==typeof e.before?t=new Set([e.before]):Array.isArray(e.before)&&(t=new Set(e.before));let r=0;"number"==typeof e.stage&&(r=e.stage);let n=this.taps.length;for(;n>0;){n--;const e=this.taps[n];this.taps[n+1]=e;const i=e.stage||0;if(t){if(t.has(e.name)){t.delete(e.name);continue}if(t.size>0)continue}if(!(i>r)){n++;break}}this.taps[n]=e}}Object.setPrototypeOf(Nw.prototype,null);var Dw=Nw;var Pw=class{constructor(e){this.config=e,this.options=void 0,this._args=void 0}create(e){let t;switch(this.init(e),this.options.type){case"sync":t=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:e=>`throw ${e};\n`,onResult:e=>`return ${e};\n`,resultReturns:!0,onDone:()=>"",rethrowIfPossible:!0}));break;case"async":t=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:e=>`_callback(${e});\n`,onResult:e=>`_callback(null, ${e});\n`,onDone:()=>"_callback();\n"}));break;case"promise":let e=!1;const r=this.contentWithInterceptors({onError:t=>(e=!0,`_error(${t});\n`),onResult:e=>`_resolve(${e});\n`,onDone:()=>"_resolve();\n"});let n="";n+='"use strict";\n',n+=this.header(),n+="return new Promise((function(_resolve, _reject) {\n",e&&(n+="var _sync = true;\n",n+="function _error(_err) {\n",n+="if(_sync)\n",n+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",n+="else\n",n+="_reject(_err);\n",n+="};\n"),n+=r,e&&(n+="_sync = false;\n"),n+="}));\n",t=new Function(this.args(),n)}return this.deinit(),t}setup(e,t){e._x=t.taps.map((e=>e.fn))}init(e){this.options=e,this._args=e.args.slice()}deinit(){this.options=void 0,this._args=void 0}contentWithInterceptors(e){if(this.options.interceptors.length>0){const t=e.onError,r=e.onResult,n=e.onDone;let i="";for(let e=0;e<this.options.interceptors.length;e++){const t=this.options.interceptors[e];t.call&&(i+=`${this.getInterceptor(e)}.call(${this.args({before:t.context?"_context":void 0})});\n`)}return i+=this.content(Object.assign(e,{onError:t&&(e=>{let r="";for(let t=0;t<this.options.interceptors.length;t++)this.options.interceptors[t].error&&(r+=`${this.getInterceptor(t)}.error(${e});\n`);return r+=t(e),r}),onResult:r&&(e=>{let t="";for(let r=0;r<this.options.interceptors.length;r++)this.options.interceptors[r].result&&(t+=`${this.getInterceptor(r)}.result(${e});\n`);return t+=r(e),t}),onDone:n&&(()=>{let e="";for(let t=0;t<this.options.interceptors.length;t++)this.options.interceptors[t].done&&(e+=`${this.getInterceptor(t)}.done();\n`);return e+=n(),e})})),i}return this.content(e)}header(){let e="";return this.needContext()?e+="var _context = {};\n":e+="var _context;\n",e+="var _x = this._x;\n",this.options.interceptors.length>0&&(e+="var _taps = this.taps;\n",e+="var _interceptors = this.interceptors;\n"),e}needContext(){for(const e of this.options.taps)if(e.context)return!0;return!1}callTap(e,{onError:t,onResult:r,onDone:n,rethrowIfPossible:i}){let o="",a=!1;for(let t=0;t<this.options.interceptors.length;t++){const r=this.options.interceptors[t];r.tap&&(a||(o+=`var _tap${e} = ${this.getTap(e)};\n`,a=!0),o+=`${this.getInterceptor(t)}.tap(${r.context?"_context, ":""}_tap${e});\n`)}o+=`var _fn${e} = ${this.getTapFn(e)};\n`;const s=this.options.taps[e];switch(s.type){case"sync":i||(o+=`var _hasError${e} = false;\n`,o+="try {\n"),o+=r?`var _result${e} = _fn${e}(${this.args({before:s.context?"_context":void 0})});\n`:`_fn${e}(${this.args({before:s.context?"_context":void 0})});\n`,i||(o+="} catch(_err) {\n",o+=`_hasError${e} = true;\n`,o+=t("_err"),o+="}\n",o+=`if(!_hasError${e}) {\n`),r&&(o+=r(`_result${e}`)),n&&(o+=n()),i||(o+="}\n");break;case"async":let a="";a+=r?`(function(_err${e}, _result${e}) {\n`:`(function(_err${e}) {\n`,a+=`if(_err${e}) {\n`,a+=t(`_err${e}`),a+="} else {\n",r&&(a+=r(`_result${e}`)),n&&(a+=n()),a+="}\n",a+="})",o+=`_fn${e}(${this.args({before:s.context?"_context":void 0,after:a})});\n`;break;case"promise":o+=`var _hasResult${e} = false;\n`,o+=`var _promise${e} = _fn${e}(${this.args({before:s.context?"_context":void 0})});\n`,o+=`if (!_promise${e} || !_promise${e}.then)\n`,o+=`  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise${e} + ')');\n`,o+=`_promise${e}.then((function(_result${e}) {\n`,o+=`_hasResult${e} = true;\n`,r&&(o+=r(`_result${e}`)),n&&(o+=n()),o+=`}), function(_err${e}) {\n`,o+=`if(_hasResult${e}) throw _err${e};\n`,o+=t(`_err${e}`),o+="});\n"}return o}callTapsSeries({onError:e,onResult:t,resultReturns:r,onDone:n,doneReturns:i,rethrowIfPossible:o}){if(0===this.options.taps.length)return n();const a=this.options.taps.findIndex((e=>"sync"!==e.type)),s=r||i;let l="",c=n,u=0;for(let r=this.options.taps.length-1;r>=0;r--){const i=r;c!==n&&("sync"!==this.options.taps[i].type||u++>20)&&(u=0,l+=`function _next${i}() {\n`,l+=c(),l+="}\n",c=()=>`${s?"return ":""}_next${i}();\n`);const d=c,f=e=>e?"":n(),h=this.callTap(i,{onError:t=>e(i,t,d,f),onResult:t&&(e=>t(i,e,d,f)),onDone:!t&&d,rethrowIfPossible:o&&(a<0||i<a)});c=()=>h}return l+=c(),l}callTapsLooping({onError:e,onDone:t,rethrowIfPossible:r}){if(0===this.options.taps.length)return t();const n=this.options.taps.every((e=>"sync"===e.type));let i="";n||(i+="var _looper = (function() {\n",i+="var _loopAsync = false;\n"),i+="var _loop;\n",i+="do {\n",i+="_loop = false;\n";for(let e=0;e<this.options.interceptors.length;e++){const t=this.options.interceptors[e];t.loop&&(i+=`${this.getInterceptor(e)}.loop(${this.args({before:t.context?"_context":void 0})});\n`)}return i+=this.callTapsSeries({onError:e,onResult:(e,t,r,i)=>{let o="";return o+=`if(${t} !== undefined) {\n`,o+="_loop = true;\n",n||(o+="if(_loopAsync) _looper();\n"),o+=i(!0),o+="} else {\n",o+=r(),o+="}\n",o},onDone:t&&(()=>{let e="";return e+="if(!_loop) {\n",e+=t(),e+="}\n",e}),rethrowIfPossible:r&&n}),i+="} while(_loop);\n",n||(i+="_loopAsync = true;\n",i+="});\n",i+="_looper();\n"),i}callTapsParallel({onError:e,onResult:t,onDone:r,rethrowIfPossible:n,onTap:i=((e,t)=>t())}){if(this.options.taps.length<=1)return this.callTapsSeries({onError:e,onResult:t,onDone:r,rethrowIfPossible:n});let o="";o+="do {\n",o+=`var _counter = ${this.options.taps.length};\n`,r&&(o+="var _done = (function() {\n",o+=r(),o+="});\n");for(let a=0;a<this.options.taps.length;a++){const s=()=>r?"if(--_counter === 0) _done();\n":"--_counter;",l=e=>e||!r?"_counter = 0;\n":"_counter = 0;\n_done();\n";o+="if(_counter <= 0) break;\n",o+=i(a,(()=>this.callTap(a,{onError:t=>{let r="";return r+="if(_counter > 0) {\n",r+=e(a,t,s,l),r+="}\n",r},onResult:t&&(e=>{let r="";return r+="if(_counter > 0) {\n",r+=t(a,e,s,l),r+="}\n",r}),onDone:!t&&(()=>s()),rethrowIfPossible:n})),s,l)}return o+="} while(false);\n",o}args({before:e,after:t}={}){let r=this._args;return e&&(r=[e].concat(r)),t&&(r=r.concat(t)),0===r.length?"":r.join(", ")}getTapFn(e){return`_x[${e}]`}getTap(e){return`_taps[${e}]`}getInterceptor(e){return`_interceptors[${e}]`}};const jw=Dw,Fw=Pw;const Vw=new class extends Fw{content({onError:e,onDone:t,rethrowIfPossible:r}){return this.callTapsSeries({onError:(t,r)=>e(r),onDone:t,rethrowIfPossible:r})}},Lw=()=>{throw new Error("tapAsync is not supported on a SyncHook")},$w=()=>{throw new Error("tapPromise is not supported on a SyncHook")},Bw=function(e){return Vw.setup(this,e),Vw.create(e)};function Uw(e=[],t=void 0){const r=new jw(e,t);return r.constructor=Uw,r.tapAsync=Lw,r.tapPromise=$w,r.compile=Bw,r}Uw.prototype=null;var zw=Uw;const Hw=Dw,Ww=Pw;const Gw=new class extends Ww{content({onError:e,onResult:t,resultReturns:r,onDone:n,rethrowIfPossible:i}){return this.callTapsSeries({onError:(t,r)=>e(r),onResult:(e,r,n)=>`if(${r} !== undefined) {\n${t(r)};\n} else {\n${n()}}\n`,resultReturns:r,onDone:n,rethrowIfPossible:i})}},Kw=()=>{throw new Error("tapAsync is not supported on a SyncBailHook")},qw=()=>{throw new Error("tapPromise is not supported on a SyncBailHook")},Yw=function(e){return Gw.setup(this,e),Gw.create(e)};function Jw(e=[],t=void 0){const r=new Hw(e,t);return r.constructor=Jw,r.tapAsync=Kw,r.tapPromise=qw,r.compile=Yw,r}Jw.prototype=null;var Xw=Jw;const Zw=Dw,Qw=Pw;const eC=new class extends Qw{content({onError:e,onResult:t,resultReturns:r,rethrowIfPossible:n}){return this.callTapsSeries({onError:(t,r)=>e(r),onResult:(e,t,r)=>{let n="";return n+=`if(${t} !== undefined) {\n`,n+=`${this._args[0]} = ${t};\n`,n+="}\n",n+=r(),n},onDone:()=>t(this._args[0]),doneReturns:r,rethrowIfPossible:n})}},tC=()=>{throw new Error("tapAsync is not supported on a SyncWaterfallHook")},rC=()=>{throw new Error("tapPromise is not supported on a SyncWaterfallHook")},nC=function(e){return eC.setup(this,e),eC.create(e)};function iC(e=[],t=void 0){if(e.length<1)throw new Error("Waterfall hooks must have at least one argument");const r=new Zw(e,t);return r.constructor=iC,r.tapAsync=tC,r.tapPromise=rC,r.compile=nC,r}iC.prototype=null;var oC=iC;const aC=Dw,sC=Pw;const lC=new class extends sC{content({onError:e,onDone:t,rethrowIfPossible:r}){return this.callTapsLooping({onError:(t,r)=>e(r),onDone:t,rethrowIfPossible:r})}},cC=()=>{throw new Error("tapAsync is not supported on a SyncLoopHook")},uC=()=>{throw new Error("tapPromise is not supported on a SyncLoopHook")},dC=function(e){return lC.setup(this,e),lC.create(e)};function fC(e=[],t=void 0){const r=new aC(e,t);return r.constructor=fC,r.tapAsync=cC,r.tapPromise=uC,r.compile=dC,r}fC.prototype=null;var hC=fC;const pC=Dw,gC=Pw;const mC=new class extends gC{content({onError:e,onDone:t}){return this.callTapsParallel({onError:(t,r,n,i)=>e(r)+i(!0),onDone:t})}},vC=function(e){return mC.setup(this,e),mC.create(e)};function yC(e=[],t=void 0){const r=new pC(e,t);return r.constructor=yC,r.compile=vC,r._call=void 0,r.call=void 0,r}yC.prototype=null;var bC=yC;const _C=Dw,wC=Pw;const CC=new class extends wC{content({onError:e,onResult:t,onDone:r}){let n="";return n+=`var _results = new Array(${this.options.taps.length});\n`,n+="var _checkDone = function() {\n",n+="for(var i = 0; i < _results.length; i++) {\n",n+="var item = _results[i];\n",n+="if(item === undefined) return false;\n",n+="if(item.result !== undefined) {\n",n+=t("item.result"),n+="return true;\n",n+="}\n",n+="if(item.error) {\n",n+=e("item.error"),n+="return true;\n",n+="}\n",n+="}\n",n+="return false;\n",n+="}\n",n+=this.callTapsParallel({onError:(e,t,r,n)=>{let i="";return i+=`if(${e} < _results.length && ((_results.length = ${e+1}), (_results[${e}] = { error: ${t} }), _checkDone())) {\n`,i+=n(!0),i+="} else {\n",i+=r(),i+="}\n",i},onResult:(e,t,r,n)=>{let i="";return i+=`if(${e} < _results.length && (${t} !== undefined && (_results.length = ${e+1}), (_results[${e}] = { result: ${t} }), _checkDone())) {\n`,i+=n(!0),i+="} else {\n",i+=r(),i+="}\n",i},onTap:(e,t,r,n)=>{let i="";return e>0&&(i+=`if(${e} >= _results.length) {\n`,i+=r(),i+="} else {\n"),i+=t(),e>0&&(i+="}\n"),i},onDone:r}),n}},EC=function(e){return CC.setup(this,e),CC.create(e)};function SC(e=[],t=void 0){const r=new _C(e,t);return r.constructor=SC,r.compile=EC,r._call=void 0,r.call=void 0,r}SC.prototype=null;var kC=SC;const xC=Dw,OC=Pw;const IC=new class extends OC{content({onError:e,onDone:t}){return this.callTapsSeries({onError:(t,r,n,i)=>e(r)+i(!0),onDone:t})}},RC=function(e){return IC.setup(this,e),IC.create(e)};function TC(e=[],t=void 0){const r=new xC(e,t);return r.constructor=TC,r.compile=RC,r._call=void 0,r.call=void 0,r}TC.prototype=null;var AC=TC;const MC=Dw,NC=Pw;const DC=new class extends NC{content({onError:e,onResult:t,resultReturns:r,onDone:n}){return this.callTapsSeries({onError:(t,r,n,i)=>e(r)+i(!0),onResult:(e,r,n)=>`if(${r} !== undefined) {\n${t(r)}\n} else {\n${n()}}\n`,resultReturns:r,onDone:n})}},PC=function(e){return DC.setup(this,e),DC.create(e)};function jC(e=[],t=void 0){const r=new MC(e,t);return r.constructor=jC,r.compile=PC,r._call=void 0,r.call=void 0,r}jC.prototype=null;var FC=jC;const VC=Dw,LC=Pw;const $C=new class extends LC{content({onError:e,onDone:t}){return this.callTapsLooping({onError:(t,r,n,i)=>e(r)+i(!0),onDone:t})}},BC=function(e){return $C.setup(this,e),$C.create(e)};function UC(e=[],t=void 0){const r=new VC(e,t);return r.constructor=UC,r.compile=BC,r._call=void 0,r.call=void 0,r}UC.prototype=null;var zC=UC;const HC=Dw,WC=Pw;const GC=new class extends WC{content({onError:e,onResult:t,onDone:r}){return this.callTapsSeries({onError:(t,r,n,i)=>e(r)+i(!0),onResult:(e,t,r)=>{let n="";return n+=`if(${t} !== undefined) {\n`,n+=`${this._args[0]} = ${t};\n`,n+="}\n",n+=r(),n},onDone:()=>t(this._args[0])})}},KC=function(e){return GC.setup(this,e),GC.create(e)};function qC(e=[],t=void 0){if(e.length<1)throw new Error("Waterfall hooks must have at least one argument");const r=new HC(e,t);return r.constructor=qC,r.compile=KC,r._call=void 0,r.call=void 0,r}qC.prototype=null;var YC=qC;const JC=Iw,XC=(e,t)=>t;class ZC{constructor(e,t=void 0){this._map=new Map,this.name=t,this._factory=e,this._interceptors=[]}get(e){return this._map.get(e)}for(e){const t=this.get(e);if(void 0!==t)return t;let r=this._factory(e);const n=this._interceptors;for(let t=0;t<n.length;t++)r=n[t].factory(e,r);return this._map.set(e,r),r}intercept(e){this._interceptors.push(Object.assign({factory:XC},e))}}ZC.prototype.tap=JC.deprecate((function(e,t,r){return this.for(e).tap(t,r)}),"HookMap#tap(key,…) is deprecated. Use HookMap#for(key).tap(…) instead."),ZC.prototype.tapAsync=JC.deprecate((function(e,t,r){return this.for(e).tapAsync(t,r)}),"HookMap#tapAsync(key,…) is deprecated. Use HookMap#for(key).tapAsync(…) instead."),ZC.prototype.tapPromise=JC.deprecate((function(e,t,r){return this.for(e).tapPromise(t,r)}),"HookMap#tapPromise(key,…) is deprecated. Use HookMap#for(key).tapPromise(…) instead.");var QC=ZC;class eE{constructor(e,t=void 0){this.hooks=e,this.name=t}tap(e,t){for(const r of this.hooks)r.tap(e,t)}tapAsync(e,t){for(const r of this.hooks)r.tapAsync(e,t)}tapPromise(e,t){for(const r of this.hooks)r.tapPromise(e,t)}isUsed(){for(const e of this.hooks)if(e.isUsed())return!0;return!1}intercept(e){for(const t of this.hooks)t.intercept(e)}withOptions(e){return new eE(this.hooks.map((t=>t.withOptions(e))),this.name)}}const tE=kC,rE=bC,nE=FC,iE=AC,oE=zC,aE=YC,sE=QC,lE=eE,cE=Xw,uE=zw,dE=hC,fE=oC;class hE extends fp{constructor(){super(...arguments),this._Plugin=new Map,this._unregisterToDestroy=new gp}registerPlugins(e,t){!Array.isArray(e)||e.forEach((e=>{const r=e.pluginName;if(!r)throw new Error('static property "pluginName" in Plugin is required!'+e);if(this._Plugin.get(r))throw Error(`Plugin "${r}" has been registered`);if(!e.pluginModule)throw Error('static property "pluginModule" in Plugin is required!'+e);const n=e.pluginModule(),i=t.container.load(n);this._unregisterToDestroy.push({destroy:i.dispose}),this._Plugin.set(r,e)}))}unregisterPlugins(e){!this._Plugin.size||(this._unregisterToDestroy.destroy(),this._Plugin.clear())}}var pE=(e=>(e.TEXT="text",e.NUMBER="number",e.SELECT="select",e.MULTI_SELECT="multiSelect",e.DATE="date",e.MENTION="mention",e.IMAGE="image",e.FILE="file",e.CHECKBOX="checkbox",e.LINK="link",e.EMAIL="email",e.PHONE="phone",e.CREATED_AT="createdAt",e.UPDATED_AT="updatedAt",e.USER_ID="userId",e.MODIFIER_ID="modifierId",e.TITLE="title",e.TEXTAREA="textarea",e.INPUT="input",e))(pE||{}),gE=(e=>(e.STRING="string",e.NUMBER="number",e.SELECT="select",e.URI="uri",e.BOOLEAN="boolean",e.DATE="date",e.SYSTEM="system",e))(gE||{});const mE={text:"string",email:"string",phone:"string",title:"string",select:"select",multiSelect:"select",number:"number",date:"date",mention:"uri",image:"uri",file:"uri",link:"uri",checkbox:"boolean",createdAt:"system",updatedAt:"system",userId:"system",modifierId:"system"},vE=null,yE=Object.values(pE),bE=[{name:"文本",type:pE.TEXT},{name:"单选",type:pE.SELECT,color:!0,options:[{name:"待开始",color:"#FBD3D0"},{name:"进行中",color:"#E4F7D2"},{name:"已完成",color:"#F7E9BC"}]},{name:"日期",type:pE.DATE}],_E=[{type:pE.TITLE,name:Ph("标题")},{type:pE.TEXT,name:Ph("文本")},{type:pE.NUMBER,name:Ph("数字")},{type:pE.SELECT,name:Ph("单选")},{type:pE.MULTI_SELECT,name:Ph("多选")},{type:pE.DATE,name:Ph("日期")},{type:pE.MENTION,name:Ph("人员")},{type:pE.IMAGE,name:Ph("图片"),disableGroup:!0,disableSort:!0},{type:pE.FILE,name:Ph("附件"),disableGroup:!0,disableSort:!0},{type:pE.CHECKBOX,name:Ph("复选框")},{type:pE.LINK,name:Ph("链接")},{type:pE.EMAIL,name:Ph("邮箱")},{type:pE.PHONE,name:Ph("手机号码")},{type:pE.USER_ID,name:Ph("创建人"),isAdvanced:!0,disableForm:!0},{type:pE.CREATED_AT,name:Ph("创建时间"),isAdvanced:!0,disableGroup:!0,disableForm:!0},{type:pE.MODIFIER_ID,name:Ph("修改人"),isAdvanced:!0,disableForm:!0},{type:pE.UPDATED_AT,name:Ph("修改时间"),isAdvanced:!0,disableGroup:!0,disableForm:!0}];function wE(e,t){const r={};_E.forEach((e=>{r[e.type]=e.name}));const n=r[e],i=t.map((e=>e.name));let o=1,a=n;for(;i.includes(a);)a=`${n} ${o}`,o+=1;return a}function CE(e){const t=_E.find((t=>t.type===e));return(null==t?void 0:t.name)||""}const EE=$i.defineToken("KernelModelToken");var SE=(e=>(e[e.Boolean=0]="Boolean",e[e.String=1]="String",e[e.Date=2]="Date",e[e.Uri=3]="Uri",e[e.Select=4]="Select",e[e.Number=5]="Number",e[e.User=6]="User",e[e.Record=7]="Record",e))(SE||{}),kE=(e=>(e[e.ACTIVE=0]="ACTIVE",e[e.INACTIVE=1]="INACTIVE",e))(kE||{});const xE=null;var OE=(e=>(e.equalTo="equalTo",e.notEqualTo="notEqualTo",e.greaterThan="greaterThan",e.greaterThanOrEqualTo="greaterThanOrEqualTo",e.lessThan="lessThan",e.lessThanOrEqualTo="lessThanOrEqualTo",e.isEmpty="isEmpty",e.isNotEmpty="isNotEmpty",e.startsWith="startsWith",e.notStartsWith="notStartsWith",e.endsWith="endsWith",e.notEndsWith="notEndsWith",e.contains="contains",e.notContains="notContains",e.yesterday="yesterday",e.today="today",e.tomorrow="tomorrow",e.last7days="last7days",e.lastWeek="lastWeek",e.thisWeek="thisWeek",e.nextWeek="nextWeek",e.lastMonth="lastMonth",e.thisMonth="thisMonth",e.nextMonth="nextMonth",e.is="is",e.isNot="isNot",e.isEmptySelect="isEmptySelect",e.isNotEmptySelect="isNotEmptySelect",e.isExactly="isExactly",e.hasAnyOf="hasAnyOf",e.hasAllOf="hasAllOf",e.hasNoneOf="hasNoneOf",e))(OE||{}),IE=(e=>(e.And="and",e.Or="or",e))(IE||{}),RE=(e=>(e.forward="forward",e.reverse="reverse",e))(RE||{});const TE=null;var AE=(e=>(e.Clip="clip",e.Fit="fit",e))(AE||{}),ME=(e=>(e.LOW="low",e.MIDDLE="middle",e.HIGH="high",e))(ME||{}),NE=(e=>(e.ASC="asc",e.DESC="desc",e))(NE||{});const DE=[{type:"number",func:OE.equalTo,text:Ph("等于")},{type:"number",func:OE.notEqualTo,text:Ph("不等于")},{type:"number",func:OE.greaterThan,text:Ph("大于")},{type:"number",func:OE.greaterThanOrEqualTo,text:Ph("大于等于")},{type:"number",func:OE.lessThan,text:Ph("小于")},{type:"number",func:OE.lessThanOrEqualTo,text:Ph("小于等于")},{type:"number",func:OE.isEmpty,text:Ph("为空")},{type:"number",func:OE.isNotEmpty,text:Ph("非空")},{type:"text",func:OE.startsWith,text:Ph("开头是")},{type:"text",func:OE.notStartsWith,text:Ph("开头不是")},{type:"text",func:OE.endsWith,text:Ph("结尾是")},{type:"text",func:OE.notEndsWith,text:Ph("结尾不是")},{type:"text",func:OE.contains,text:Ph("包含")},{type:"text",func:OE.notContains,text:Ph("不包含")},{type:"text",func:OE.isEmpty,text:Ph("为空")},{type:"text",func:OE.isNotEmpty,text:Ph("非空")},{type:"timePeriod",func:OE.yesterday,text:Ph("昨天")},{type:"timePeriod",func:OE.today,text:Ph("今天")},{type:"timePeriod",func:OE.tomorrow,text:Ph("明天")},{type:"timePeriod",func:OE.last7days,text:Ph("过去7天")},{type:"timePeriod",func:OE.lastWeek,text:Ph("上周")},{type:"timePeriod",func:OE.thisWeek,text:Ph("本周")},{type:"timePeriod",func:OE.nextWeek,text:Ph("下周")},{type:"timePeriod",func:OE.lastMonth,text:Ph("上月")},{type:"timePeriod",func:OE.thisMonth,text:Ph("本月")},{type:"timePeriod",func:OE.nextMonth,text:Ph("下月")},{type:"timePeriod",func:OE.isEmpty,text:Ph("为空")},{type:"timePeriod",func:OE.isNotEmpty,text:Ph("非空")},{type:"select",func:OE.is,text:Ph("是")},{type:"select",func:OE.isNot,text:Ph("不是")},{type:"select",func:OE.isEmptySelect,text:Ph("为空")},{type:"select",func:OE.isNotEmptySelect,text:Ph("非空")},{type:"multiSelect",func:OE.isExactly,text:Ph("是")},{type:"multiSelect",func:OE.isNot,text:Ph("不是")},{type:"multiSelect",func:OE.hasAnyOf,text:Ph("包含一个")},{type:"multiSelect",func:OE.hasAllOf,text:Ph("包含所有")},{type:"multiSelect",func:OE.hasNoneOf,text:Ph("不包含")},{type:"multiSelect",func:OE.isEmptySelect,text:Ph("为空")},{type:"multiSelect",func:OE.isNotEmptySelect,text:Ph("非空")},{type:"checkbox",func:OE.equalTo,text:Ph("等于")},{type:"file",func:OE.isEmpty,text:Ph("为空")},{type:"file",func:OE.isNotEmpty,text:Ph("非空")}],PE={[pE.TITLE]:"text",[pE.TEXT]:"text",[pE.LINK]:"text",[pE.EMAIL]:"text",[pE.PHONE]:"text",[pE.DATE]:"timePeriod",[pE.CREATED_AT]:"timePeriod",[pE.UPDATED_AT]:"timePeriod",[pE.NUMBER]:"number",[pE.SELECT]:"select",[pE.MULTI_SELECT]:"multiSelect",[pE.MENTION]:"multiSelect",[pE.USER_ID]:"select",[pE.MODIFIER_ID]:"select",[pE.CHECKBOX]:"checkbox",[pE.IMAGE]:"file",[pE.FILE]:"file"},jE=["isEmpty","isNotEmpty","yesterday","today","tomorrow","last7days","lastWeek","thisWeek","nextWeek","lastMonth","thisMonth","nextMonth","duplicate","unique","isEmptySelect","isNotEmptySelect"],FE=3,VE="2.0.0";var LE=(e=>(e.GRID="GRID",e.CARD="CARD",e.KANBAN="KANBAN",e.FORM="FORM",e))(LE||{});const $E=Object.values(LE),BE={GRID:{type:"GRID",name:Ph("表格视图")},CARD:{type:"CARD",name:Ph("画册视图"),showFiledName:!1,cover:!0,coverDisplay:AE.Clip},KANBAN:{type:"KANBAN",name:Ph("看板视图"),showFiledName:!1},FORM:{type:"FORM",name:Ph("表单")}},UE={Clip:AE.Clip,Fit:AE.Fit};class zE{static isBoolean(e){return e===pE.CHECKBOX}static isDate(e){return e===pE.DATE}static isSystemDate(e){return e===pE.CREATED_AT||e===pE.UPDATED_AT}static isNumber(e){return e===pE.NUMBER}static isSelectLike(e){return e===pE.SELECT||e===pE.MULTI_SELECT}static isSelect(e){return e===pE.SELECT}static isMultiSelect(e){return e===pE.MULTI_SELECT}static isSystemType(e){return e===pE.CREATED_AT||e===pE.UPDATED_AT||e===pE.USER_ID||e===pE.MODIFIER_ID}static isCreateDisable(e){return e===pE.TITLE}static isTransformDisable(e){return e===pE.TITLE}static isDeleteDisable(e){return e===pE.TITLE}static isSystemUser(e){return e===pE.USER_ID||e===pE.MODIFIER_ID}static isString(e){return e===pE.TITLE||e===pE.TEXT||e===pE.EMAIL||e===pE.PHONE}static isUri(e){return e===pE.IMAGE||e===pE.FILE||e===pE.MENTION||e===pE.LINK}static isLink(e){return e===pE.LINK}static isMultiple(e){return e===pE.MULTI_SELECT||e===pE.IMAGE||e===pE.FILE||e===pE.MENTION}static isMention(e){return e===pE.MENTION}static isMentionLike(e){return e===pE.MENTION||e===pE.USER_ID||e===pE.MODIFIER_ID}static isImage(e){return e===pE.IMAGE}static isCheckbox(e){return e===pE.CHECKBOX}static isGroup(e){return e===pE.TITLE||e===pE.TEXT||e===pE.NUMBER||e===pE.SELECT||e===pE.MULTI_SELECT||e===pE.DATE||e===pE.MENTION||e===pE.CHECKBOX||e===pE.LINK||e===pE.EMAIL||e===pE.PHONE||e===pE.USER_ID||e===pE.MODIFIER_ID}static isSort(e){return e===pE.TITLE||e===pE.TEXT||e===pE.NUMBER||e===pE.SELECT||e===pE.MULTI_SELECT||e===pE.DATE||e===pE.MENTION||e===pE.CHECKBOX||e===pE.LINK||e===pE.EMAIL||e===pE.PHONE||e===pE.USER_ID||e===pE.CREATED_AT||e===pE.MODIFIER_ID||e===pE.UPDATED_AT}static isFilter(e){return e===pE.TITLE||e===pE.TEXT||e===pE.NUMBER||e===pE.SELECT||e===pE.MULTI_SELECT||e===pE.DATE||e===pE.MENTION||e===pE.IMAGE||e===pE.FILE||e===pE.CHECKBOX||e===pE.LINK||e===pE.EMAIL||e===pE.PHONE||e===pE.USER_ID||e===pE.CREATED_AT||e===pE.MODIFIER_ID||e===pE.UPDATED_AT}static getBaseType(e){return mE[e]}}var HE=Object.defineProperty,WE=Object.getOwnPropertyDescriptor,GE=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?WE(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&HE(t,r,o),o};class KE extends Ow{}KE.table="field_boolean",KE.indexes=["field_uuid","record_uuid"],KE.ignoreColumns=["uuid"],GE([xw()],KE.prototype,"field_uuid",2),GE([xw()],KE.prototype,"record_uuid",2),GE([xw()],KE.prototype,"value",2);var qE=Object.defineProperty,YE=Object.getOwnPropertyDescriptor,JE=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?YE(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qE(t,r,o),o};class XE extends Ow{}XE.table="field_date",XE.indexes=["field_uuid","record_uuid"],XE.ignoreColumns=["uuid"],JE([xw()],XE.prototype,"field_uuid",2),JE([xw()],XE.prototype,"record_uuid",2),JE([xw()],XE.prototype,"value",2);var ZE=Object.defineProperty,QE=Object.getOwnPropertyDescriptor,eS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?QE(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ZE(t,r,o),o};class tS extends Ow{}tS.table="field",eS([xw()],tS.prototype,"name",2),eS([xw()],tS.prototype,"type",2),eS([xw()],tS.prototype,"sub_type",2),eS([xw()],tS.prototype,"format",2),eS([xw()],tS.prototype,"color",2),eS([xw()],tS.prototype,"multiple",2);var rS=Object.defineProperty,nS=Object.getOwnPropertyDescriptor,iS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?nS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&rS(t,r,o),o};class oS extends Ow{}oS.table="field_number",oS.indexes=["field_uuid","record_uuid"],oS.ignoreColumns=["uuid"],iS([xw()],oS.prototype,"field_uuid",2),iS([xw()],oS.prototype,"record_uuid",2),iS([xw()],oS.prototype,"value",2),iS([xw()],oS.prototype,"format",2);var aS=Object.defineProperty,sS=Object.getOwnPropertyDescriptor,lS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&aS(t,r,o),o};class cS extends Ow{}cS.table="field_option",cS.indexes=["field_uuid"],cS.MAX_LENGTH=128,lS([xw()],cS.prototype,"field_uuid",2),lS([xw()],cS.prototype,"name",2),lS([xw()],cS.prototype,"color",2),lS([xw()],cS.prototype,"temp",2);var uS=Object.defineProperty,dS=Object.getOwnPropertyDescriptor,fS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uS(t,r,o),o};class hS extends Ow{}hS.table="field_select",hS.indexes=["field_uuid","record_uuid"],hS.ignoreColumns=["uuid"],fS([xw()],hS.prototype,"field_uuid",2),fS([xw()],hS.prototype,"record_uuid",2),fS([xw()],hS.prototype,"value",2);var pS=Object.defineProperty,gS=Object.getOwnPropertyDescriptor,mS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pS(t,r,o),o};class vS extends Ow{}vS.table="field_string",vS.indexes=["field_uuid","record_uuid"],vS.ignoreColumns=["uuid"],mS([xw()],vS.prototype,"field_uuid",2),mS([xw()],vS.prototype,"record_uuid",2),mS([xw()],vS.prototype,"value",2),mS([xw()],vS.prototype,"updated_at",2),mS([xw()],vS.prototype,"created_at",2);var yS=Object.defineProperty,bS=Object.getOwnPropertyDescriptor,_S=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yS(t,r,o),o};class wS extends Ow{}wS.table="field_uri",wS.indexes=["field_uuid","record_uuid"],wS.ignoreColumns=["uuid"],_S([xw()],wS.prototype,"field_uuid",2),_S([xw()],wS.prototype,"record_uuid",2),_S([xw()],wS.prototype,"uid",2),_S([xw()],wS.prototype,"name",2),_S([xw()],wS.prototype,"src",2),_S([xw()],wS.prototype,"size",2),_S([xw()],wS.prototype,"mime",2),_S([xw()],wS.prototype,"icon",2),_S([xw()],wS.prototype,"width",2),_S([xw()],wS.prototype,"height",2);var CS=Object.defineProperty,ES=Object.getOwnPropertyDescriptor,SS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ES(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&CS(t,r,o),o};class kS extends Ow{}kS.table="filter",kS.indexes=["view_uuid"],SS([xw()],kS.prototype,"view_uuid",2),SS([xw()],kS.prototype,"field_uuid",2),SS([xw()],kS.prototype,"operator",2),SS([xw()],kS.prototype,"func",2),SS([xw()],kS.prototype,"expected",2);var xS=Object.defineProperty,OS=Object.getOwnPropertyDescriptor,IS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?OS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xS(t,r,o),o};class RS extends Ow{}RS.table="group",RS.indexes=["view_uuid"],IS([xw()],RS.prototype,"view_uuid",2),IS([xw()],RS.prototype,"field_uuid",2),IS([xw()],RS.prototype,"type",2);var TS=Object.defineProperty,AS=Object.getOwnPropertyDescriptor,MS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?AS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&TS(t,r,o),o};class NS extends Ow{}NS.table="field_group",NS.indexes=["view_uuid"],MS([xw()],NS.prototype,"view_uuid",2),MS([xw()],NS.prototype,"name",2);var DS=Object.defineProperty,PS=Object.getOwnPropertyDescriptor,jS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?PS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&DS(t,r,o),o};class FS extends Ow{}FS.table="record",jS([xw()],FS.prototype,"id",2),jS([xw()],FS.prototype,"desc",2),jS([xw()],FS.prototype,"creator_id",2),jS([xw()],FS.prototype,"modifier_id",2);var VS=Object.defineProperty,LS=Object.getOwnPropertyDescriptor,$S=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?LS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&VS(t,r,o),o};class BS extends Ow{}BS.table="sort",BS.indexes=["view_uuid"],$S([xw()],BS.prototype,"view_uuid",2),$S([xw()],BS.prototype,"field_uuid",2),$S([xw()],BS.prototype,"type",2);var US=Object.defineProperty,zS=Object.getOwnPropertyDescriptor,HS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&US(t,r,o),o};class WS extends Ow{}WS.table="stat",WS.indexes=["view_uuid","field_uuid"],HS([xw()],WS.prototype,"view_uuid",2),HS([xw()],WS.prototype,"field_uuid",2),HS([xw()],WS.prototype,"type",2);var GS=Object.defineProperty,KS=Object.getOwnPropertyDescriptor,qS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?KS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&GS(t,r,o),o};class YS extends Ow{}YS.table="table",qS([xw()],YS.prototype,"version",2),qS([xw()],YS.prototype,"active_view_uuid",2);var JS=Object.defineProperty,XS=Object.getOwnPropertyDescriptor,ZS=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?XS(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JS(t,r,o),o};class QS extends Ow{}QS.table="user",QS.indexes=["uid"],ZS([xw()],QS.prototype,"uid",2),ZS([xw()],QS.prototype,"login",2),ZS([xw()],QS.prototype,"work_id",2),ZS([xw()],QS.prototype,"name",2),ZS([xw()],QS.prototype,"icon",2);var ek=Object.defineProperty,tk=Object.getOwnPropertyDescriptor,rk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ek(t,r,o),o};class nk extends Ow{}nk.table="view_config",nk.indexes=["view_uuid"],rk([xw()],nk.prototype,"view_uuid",2),rk([xw()],nk.prototype,"cover_field_uuid",2),rk([xw()],nk.prototype,"cover_display",2),rk([xw()],nk.prototype,"show_field_name",2),rk([xw()],nk.prototype,"keep_sort",2),rk([xw()],nk.prototype,"frozen_field",2),rk([xw()],nk.prototype,"record_height",2);var ik=Object.defineProperty,ok=Object.getOwnPropertyDescriptor,ak=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ok(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ik(t,r,o),o};class sk extends Ow{}sk.table="view_field",sk.indexes=["view_uuid"],ak([xw()],sk.prototype,"view_uuid",2),ak([xw()],sk.prototype,"field_uuid",2),ak([xw()],sk.prototype,"group_uuid",2),ak([xw()],sk.prototype,"name",2),ak([xw()],sk.prototype,"size",2),ak([xw()],sk.prototype,"display_type",2),ak([xw()],sk.prototype,"required",2),ak([xw()],sk.prototype,"hidden",2);var lk=Object.defineProperty,ck=Object.getOwnPropertyDescriptor,uk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ck(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lk(t,r,o),o};class dk extends Ow{}dk.table="view",uk([xw()],dk.prototype,"id",2),uk([xw()],dk.prototype,"type",2),uk([xw()],dk.prototype,"name",2),uk([xw()],dk.prototype,"desc",2);var fk=Object.defineProperty,hk=Object.getOwnPropertyDescriptor,pk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fk(t,r,o),o};class gk extends Ow{}gk.table="view_record",gk.indexes=["view_uuid"],pk([xw()],gk.prototype,"view_uuid",2),pk([xw()],gk.prototype,"record_uuid",2),pk([xw()],gk.prototype,"group_item_key",2),pk([xw()],gk.prototype,"hidden",2);var mk=Object.defineProperty,vk=Object.getOwnPropertyDescriptor,yk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mk(t,r,o),o};class bk extends Ow{}bk.table="view_share",bk.indexes=["view_uuid"],yk([xw()],bk.prototype,"view_uuid",2),yk([xw()],bk.prototype,"src",2),yk([xw()],bk.prototype,"status",2);var _k=Object.defineProperty,wk=Object.getOwnPropertyDescriptor,Ck=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_k(t,r,o),o};class Ek extends Ow{}Ek.table="cell",Ek.indexes=["field_uuid","record_uuid"],Ek.ignoreColumns=["uuid"],Ck([xw()],Ek.prototype,"field_uuid",2),Ck([xw()],Ek.prototype,"field_type",2),Ck([xw()],Ek.prototype,"record_uuid",2),Ck([xw()],Ek.prototype,"format_value",2),Ck([xw()],Ek.prototype,"verify",2),Ck([xw()],Ek.prototype,"verify_message",2);var Sk=Object.defineProperty,kk=Object.getOwnPropertyDescriptor,xk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sk(t,r,o),o};let Ok=class{get cellModel(){return this._modelService.getModel(Ek.table)}get fieldBooleanModel(){return this._modelService.getModel(KE.table)}get fieldDateModel(){return this._modelService.getModel(XE.table)}get fieldModel(){return this._modelService.getModel(tS.table)}get fieldNumberModel(){return this._modelService.getModel(oS.table)}get fieldOptionModel(){return this._modelService.getModel(cS.table)}get fieldSelectModel(){return this._modelService.getModel(hS.table)}get fieldStringModel(){return this._modelService.getModel(vS.table)}get fieldUriModel(){return this._modelService.getModel(wS.table)}get filterModel(){return this._modelService.getModel(kS.table)}get groupModel(){return this._modelService.getModel(RS.table)}get fieldGroupModel(){return this._modelService.getModel(NS.table)}get recordModel(){return this._modelService.getModel(FS.table)}get sortModel(){return this._modelService.getModel(BS.table)}get statModel(){return this._modelService.getModel(WS.table)}get tableModel(){return this._modelService.getModel(YS.table)}get userModel(){return this._modelService.getModel(QS.table)}get viewConfigModel(){return this._modelService.getModel(nk.table)}get viewFieldModel(){return this._modelService.getModel(sk.table)}get viewModel(){return this._modelService.getModel(dk.table)}get viewRecordModel(){return this._modelService.getModel(gk.table)}get viewShareModel(){return this._modelService.getModel(bk.table)}};xk([ao(_w)],Ok.prototype,"_modelService",2),Ok=xk([io()],Ok);var Ik=Object.defineProperty,Rk=Object.getOwnPropertyDescriptor;let Tk=class{get currentUser(){return this._user}setCurrentUser(e){e.uuid||(e.uuid=e.uid),this._user=e}};Tk=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Rk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ik(t,r,o),o})([io()],Tk);var Ak=Object.defineProperty,Mk=Object.getOwnPropertyDescriptor,Nk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Mk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ak(t,r,o),o};let Dk=class{getViewConfig(e){return this._model.viewConfigModel.findOne({view_uuid:e})}create(e){const t=this._model.viewModel.findById(e);if(!t)return;const r=BE[t.get("type")];if(t.get("type")===LE.CARD){const e=this._model.fieldModel.findOne({type:pE.IMAGE});return this._model.viewConfigModel.create({view_uuid:t.get("uuid"),show_field_name:r.showFiledName,cover_field_uuid:(null==e?void 0:e.get("uuid"))||null,cover_display:r.coverDisplay})}return t.get("type")===LE.KANBAN?this._model.viewConfigModel.create({view_uuid:t.get("uuid"),show_field_name:r.showFiledName}):this._model.viewConfigModel.create({view_uuid:t.get("uuid")})}update(e,t){if(e)return this._model.viewConfigModel.upsert({view_uuid:e},{view_uuid:e,...t})}copy(e,t){const r=this.getViewConfig(e);if(!r)return;const n=r.toJSON();delete n.uuid,n.view_uuid=t,this._model.viewConfigModel.create(n)}refresh(e){const t=this.getViewConfig(e);if(!t)return this.create(e);t.get("cover_field_uuid")&&(this._model.fieldModel.findOne({uuid:t.get("cover_field_uuid")})||this.update(e,{cover_field_uuid:null}))}};Nk([ao(Ok)],Dk.prototype,"_model",2),Dk=Nk([io()],Dk);var Pk=Object.defineProperty,jk=Object.getOwnPropertyDescriptor;let Fk=class{constructor(){this._fieldMap=new Map}registerField(e){this._fieldMap.set(e.type,e)}getValueModel(e){var t;return null==(t=this.getValueField(e))?void 0:t.model}getValueField(e){return this._fieldMap.get(e)}};Fk=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?jk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pk(t,r,o),o})([io()],Fk);var Vk=Object.defineProperty,Lk=Object.getOwnPropertyDescriptor,$k=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Lk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Vk(t,r,o),o};let Bk=class extends fp{constructor(){super(...arguments),this._onCellChange=this._register(new _p),this.onCellChange=this._onCellChange.event}destroy(){super.destroy()}};$k([Ii()],Bk.prototype,"destroy",1),Bk=$k([io()],Bk);var Uk=Object.defineProperty,zk=Object.getOwnPropertyDescriptor,Hk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?zk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Uk(t,r,o),o};let Wk=class{_notifyCellChange(e,t){this._eventService._onCellChange.emit({fieldId:e,recordId:t,cellValue:this.getCell(e,t)})}setCell(e,t,r){var n,i;let o=r.fieldType;if(!o){const t=this._model.fieldModel.findById(e);o=null==t?void 0:t.get("type")}null==(i=null==(n=this._fieldRegistry.getValueField(o))?void 0:n.setCell)||i.call(n,e,t,r),this.updateRecord(t),this._notifyCellChange(e,t)}bulkSetCell(e){var t,r;if(0===e.length)return;let n=e[0].fieldType;const i=e[0].fieldId;if(!n){const e=this._model.fieldModel.findById(i);n=null==e?void 0:e.get("type")}null==(r=null==(t=this._fieldRegistry.getValueField(n))?void 0:t.bulkSetCell)||r.call(t,e),e.forEach((e=>{this.updateRecord(e.recordId),this._notifyCellChange(e.fieldId,e.recordId)}))}updateRecord(e){const t=this._model.fieldModel.find({type:pE.UPDATED_AT});if(t.length>0)for(const r of t)this.updateRecordUpdatedAt(r.get("uuid"),e);const r=this._model.fieldModel.find({type:pE.MODIFIER_ID});if(r.length>0)for(const t of r)this.updateRecordModifierId(t.get("uuid"),e)}updateRecordUpdatedAt(e,t){this._model.recordModel.update({uuid:t},{updated_at:+new Date}),this._notifyCellChange(e,t)}updateRecordModifierId(e,t){var r;this._model.recordModel.update({uuid:t},{modifier_id:null==(r=this._contextService.currentUser)?void 0:r.uid}),this._notifyCellChange(e,t)}removeByRecordId(e,t){let r;if(r=t?this._model.fieldModel.find({uuid:t}):this._model.fieldModel.find(),0===r.length)return;let n=[];if(e)Array.isArray(e)?n=e:n.push(e);else{n=Bp(this._model.recordModel.find(),(e=>e.get("uuid")))}for(const e of r){const t=this._fieldRegistry.getValueModel(e.get("type"));if(!t)return;const r={field_uuid:e.get("uuid"),record_uuid:n};t.remove(r),this._model.cellModel.remove(r)}}getFieldCells(e){if(!this._model.fieldModel.findById(e))return[];const t=this._model.recordModel.find(),r=[];for(const n of t){const t=this.getCell(e,n.get("uuid"));t&&r.push(t)}return r}getViewRecordCells(e,t){if(null==t&&(t=e,e=null),!this._model.recordModel.findById(t))return new Yh;const r=new Yh;if(e){const n=this._model.viewFieldModel.find({view_uuid:e});for(const e of n){if(e.get("hidden"))continue;const n=this.getCell(e.get("field_uuid"),t);n&&r.push([n])}}else{const e=this._model.viewFieldModel.find();for(const n of e){const e=this.getCell(n.get("field_uuid"),t);e&&r.push([e])}}return r}getRecordCells(e){if(!this._model.recordModel.findById(e))return new Yh;const t=this._model.fieldModel.find(),r=new Yh;for(const n of t){const t=this.getCell(n.get("uuid"),e);t&&r.push([t])}return r}getCell(e,t){const r=this._model.fieldModel.findById(e),n=null==r?void 0:r.get("type");if(!n)return null;const i=this._fieldRegistry.getValueField(n);return null==i?void 0:i.getCell(e,t)}getCellFormattedValue(e,t){const r=this._model.fieldModel.findById(e);if(!r)return"";const n=this._fieldRegistry.getValueField(r.get("type"));return n?n.getCellFormattedValue(e,t):""}getCellKeyValue(e,t){const r=this._model.fieldModel.findById(e);if(!r)return null;const n=this._fieldRegistry.getValueField(r.get("type"));return n?n.getCellKeyValue(e,t):null}keyValue(e){if(!e||null==e||!e.value)return"";const t=this._model.fieldModel.findById(e.fieldId);if(!t)return"";const r=this._fieldRegistry.getValueField(t.get("type"));return null==r?void 0:r.keyValue(e.value)}copy(e,t,r,n){const i=this.getCell(e,t);!i||this.setCell(r,n,i)}updateOrder(e){const{fieldId:t,fieldType:r,recordId:n,sourceValueId:i,targetValueId:o}=e,a=this._fieldRegistry.getValueModel(r);if(!a)return;const s=a.find({field_uuid:t,record_uuid:n}),l=Lp(s,(e=>e.get("uuid")===i)),c=Lp(s,(e=>e.get("uuid")===o));let u={};const d=s.get(l),f=s.get(c);f&&(u={field_uuid:f.get("field_uuid"),record_uuid:f.get("record_uuid")}),l<c?a.moveAfter(u,{field_uuid:d.get("field_uuid"),record_uuid:d.get("record_uuid")}):a.moveBefore(u,{field_uuid:d.get("field_uuid"),record_uuid:d.get("record_uuid")}),this._notifyCellChange(t,n)}};Hk([ao(Ok)],Wk.prototype,"_model",2),Hk([ao(Fk)],Wk.prototype,"_fieldRegistry",2),Hk([ao(Bk)],Wk.prototype,"_eventService",2),Hk([ao(Tk)],Wk.prototype,"_contextService",2),Wk=Hk([io()],Wk);const Gk=$i.defineToken("CellEditContribution");var Kk=Object.defineProperty,qk=Object.getOwnPropertyDescriptor,Yk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?qk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Kk(t,r,o),o};let Jk=class{getProvider(){var e;const t=this.userProvider.getContributions(),r=t[t.length-1];return null==(e=null==r?void 0:r.registerCellEdit)?void 0:e.call(r)}};Yk([wh(Gk)],Jk.prototype,"userProvider",2),Jk=Yk([io()],Jk);var Xk=Object.defineProperty,Zk=Object.getOwnPropertyDescriptor,Qk=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zk(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xk(t,r,o),o};let ex=class{get provider(){return this._cellEditRegistry.getProvider()}setCell(e){var t;return null==(t=this.provider)?void 0:t.setCell(e)}};Qk([ao(Jk)],ex.prototype,"_cellEditRegistry",2),ex=Qk([io()],ex);const tx=xo().contribution(Gk).register(Jk).register(ex);var rx=Object.defineProperty,nx=Object.getOwnPropertyDescriptor,ix=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?nx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&rx(t,r,o),o};let ox=class{changeCellType(e,t,r,n,i){var o,a,s;const l=this._fieldRegistry.getValueField(t),c=this._fieldRegistry.getValueField(r);if(!l||!c)return;let u=null;if(l.baseType!==c.baseType||l.type===pE.TEXT){const t=l.formatted(e.value,n);u=zE.isSelectLike(c.type)&&!i?c.transform(t,n):c.transform(t,i)}else if(zE.isUri(c.type)){let t=e.value;zE.isMultiple(l.type)&&!zE.isMultiple(c.type)&&(t=(null==e?void 0:e.value)[0]),u=c.transform(t)}else if(zE.isSelectLike(c.type)){let t=e.value;if(zE.isMultiple(l.type)&&!zE.isMultiple(c.type)&&(t=null==(o=null==e?void 0:e.value)?void 0:o[0]),zE.isMultiple(l.type)&&zE.isMultiple(c.type)&&n&&i){const e=(null==c?void 0:c.getFieldOptionName(t,n))||[];u=c.transform(e,i)}else if(n&&i&&n!==i){const e=l.formatted(t,n);u=c.transform(e,i)}else{const e=Lo(n)?i:void 0;u=c.transform(t,e)}}else u=c.transform(null==e?void 0:e.value);if(null!==u){if(c.validate(u.value)){const t={...e,value:u.value};if(null!=(a=this._cellEditService)&&a.provider&&!this._cellEditService.setCell({cells:[t]}))return;e.fieldId&&e.recordId&&(null==(s=c.setCell)||s.call(c,e.fieldId,e.recordId,t),this._eventService._onCellChange.emit({fieldId:e.fieldId,recordId:e.recordId,cellValue:t}))}}else l.model&&l.model.remove({field_uuid:e.fieldId,record_uuid:e.recordId})}};ix([ao(Fk)],ox.prototype,"_fieldRegistry",2),ix([ao(ex)],ox.prototype,"_cellEditService",2),ix([ao(Bk)],ox.prototype,"_eventService",2),ox=ix([io()],ox);var ax=Object.defineProperty,sx=Object.getOwnPropertyDescriptor,lx=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ax(t,r,o),o};let cx=class{_notifyCellChange(e,t){this._eventService._onCellChange.emit({fieldId:e,recordId:t,cellValue:this._cellService.getCell(t,e)})}getFields(){const e=this._model.fieldModel.find(),t=new Yh;return e.forEach((e=>{const r=new Kp(e.toJSON()),n=r.get("type");if(zE.isSelectLike(n)){const t=this.getFieldOptions(e.get("uuid"));null==r||r.set("options",t)}t.push([r])})),t}getField(e){const t=this._model.fieldModel.findOne({uuid:e});if(!t)return;const r=new Kp(t.toJSON()),n=r.get("type");if(zE.isSelectLike(n)){const e=this.getFieldOptions(r.get("uuid"));null==r||r.set("options",e)}return r}getFieldDetail(e){const t=this._model.fieldModel.findOne({uuid:e});if(!t)return null;return{field:t,options:this.getFieldOptions(e)}}getFieldOption(e){return this._model.fieldOptionModel.findOne({uuid:e})}getFieldOptions(e){return this._model.fieldOptionModel.find({field_uuid:e})}getFieldOptionName(e){const t=e.split(",");if(Array.isArray(t)){const e=[];return t.forEach((t=>{const r=this._model.fieldOptionModel.findOne({uuid:t});r&&e.push(r.get("name"))})),e.join(",")}const r=this._model.fieldOptionModel.findOne({uuid:e});return r?r.get("name"):""}create(e){const t=this._model.fieldModel.create({name:e.name,type:e.type,color:e.color,uuid:e.uuid,multiple:!!e.multiple});if(e.options)for(const r of e.options)this._model.fieldOptionModel.create({uuid:r.uuid,field_uuid:t.uuid,name:r.name.slice(0,cS.MAX_LENGTH),color:r.color});return t}remove(e){const t=this._model.fieldModel.remove({uuid:e});return this._model.fieldOptionModel.remove({field_uuid:e}),t}removeAll(){const e=Bp(this._model.fieldModel.find(),(e=>e.get("uuid")));return this._model.fieldModel.remove({uuid:e}),this._model.fieldOptionModel.remove({field_uuid:e})}update(e){const t=e.uuid;return this._model.fieldModel.update({uuid:t},e)}createFieldOption(e,t,r){if(!this._model.fieldModel.findOne({uuid:e}))throw new Error(Ph("不存在对应字段"));if(!t.name)throw new Error(Ph("选项名不能为空"));if(t.name.length>cS.MAX_LENGTH)throw new Error(Ph("选项名不能超过最大长度限制"));if(zp(this._model.fieldOptionModel.find({field_uuid:e}),(e=>e.get("name")===t.name)))throw new Error(Ph("已存在该选项，不可重复创建！"));const n=this._model.fieldOptionModel.create({uuid:t.uuid,field_uuid:e,name:t.name,color:t.color});if(t.users)for(const e of t.users)this._model.userModel.upsert({uid:e.uid},{uid:e.uid,login:e.login,work_id:e.work_id,name:e.name,icon:e.icon});return r&&this._model.fieldOptionModel.moveAfter({uuid:r},{uuid:n.uuid}),this._model.fieldModel.update({uuid:e},{updated_at:(new Date).getTime()}),n}updateFieldOption(e,t){const r=this._model.fieldOptionModel.findOne({uuid:e});if(!r)throw new Error(Ph("不存在对应选项"));if(!t.name)throw new Error(Ph("选项名不能为空"));if(t.name.length>cS.MAX_LENGTH)throw new Error(Ph("选项名不能超过最大长度限制"));if(zp(this._model.fieldOptionModel.find({field_uuid:r.get("field_uuid"),uuid:{$not:e}}),(e=>e.get("name")===t.name)))throw new Error(Ph("已存在该选项，不可重复创建！"));const n={name:t.name,color:t.color};this._model.fieldOptionModel.update({uuid:r.get("uuid"),field_uuid:r.get("field_uuid")},n),this._model.fieldModel.update({uuid:r.get("field_uuid")},{updated_at:(new Date).getTime()})}updateMentionFieldOptionId(e,t){this._model.fieldOptionModel.update({uuid:e},{uuid:t})}updateFieldOptions(e,t,r=[]){if(r.length>0){const t=this._model.fieldSelectModel.find({value:r,field_uuid:e});t.forEach((e=>{this._model.fieldSelectModel.remove({uuid:e.get("uuid")})}));for(const r of t)this._notifyCellChange(e,r.get("record_uuid"));this._model.fieldOptionModel.remove({uuid:r,field_uuid:e})}t.map((t=>{var r;return{uuid:t.uuid,field_uuid:e,name:(null==(r=t.name)?void 0:r.slice(0,cS.MAX_LENGTH))||"",color:t.color}})).forEach(((t,r)=>{const n=this._model.fieldOptionModel.find({field_uuid:e}),i=Lp(n,(e=>e.get("uuid")===t.uuid));if(r===i){const e=n.get(i);(null!=t.name&&t.name!==e.get("name")||null!=t.color&&t.color!==e.get("color"))&&this._model.fieldOptionModel.update({uuid:t.uuid},t)}else if(-1===i)if(0===r)this._model.fieldOptionModel.createBefore(null,t);else{const e=n.get(r-1);this._model.fieldOptionModel.createAfter({uuid:e.get("uuid")},t)}else if(0===r)this._model.fieldOptionModel.moveBefore(null,t);else{const e=n.get(r-1);this._model.fieldOptionModel.moveAfter(null==e?void 0:e.toJSON(),t)}})),this._model.fieldModel.update({uuid:e},{updated_at:(new Date).getTime()})}updateFieldOptionOrder(e,t,r){const n=this._model.fieldOptionModel.find({field_uuid:e}),i=Lp(n,(e=>e.get("uuid")===t)),o=Lp(n,(e=>e.get("uuid")===r)),a=n.get(o);let s={};a&&(s={field_uuid:e,uuid:a.get("uuid")}),i<o?this._model.fieldOptionModel.moveAfter(s,{uuid:t,field_uuid:e}):this._model.fieldOptionModel.moveBefore(s,{uuid:t,field_uuid:e}),this._model.fieldModel.update({uuid:e},{updated_at:(new Date).getTime()})}removeFieldOption(e){const t=this._model.fieldOptionModel.findOne({uuid:e});if(!t)return;const r=t.get("field_uuid");this._model.fieldOptionModel.remove({uuid:e,field_uuid:r}),this._model.fieldSelectModel.remove({field_uuid:r,value:e}),this._model.fieldModel.update({uuid:r},{updated_at:(new Date).getTime()})}changeFieldType(e,t,r,n){if(this._model.fieldModel.update({uuid:e},{type:r}),(null==n?void 0:n[0].fieldType)===r)this._cellService.bulkSetCell(n);else for(const i of n)this._processService.changeCellType(i,t,r,e)}clone(e,t){const r=this._model.fieldModel.findOne({uuid:e});if(!r)return;const n=this._model.fieldOptionModel.find({field_uuid:r.get("uuid")}),i=this._model.fieldModel.create({uuid:t,name:this.getFieldName(r.get("type"),r.get("name")),type:r.get("type"),sub_type:r.get("sub_type"),format:r.get("format"),color:r.get("color"),multiple:r.get("multiple")});return n.length>0&&this._model.fieldOptionModel.bulkCreate(Bp(n,(e=>({field_uuid:i.uuid,name:e.get("name"),color:e.get("color")})))),i}getFieldName(e,t){const r=this._model.fieldModel.find({type:e}),n=r.length,i=n=>{var o;const a=(t||(null==(o=_E.find((t=>t.type===e)))?void 0:o.name))+" "+n;return Fp(r,(e=>e.get("name")===a))?i(n+1):a};return i(n)}};lx([ao(Wk)],cx.prototype,"_cellService",2),lx([ao(ox)],cx.prototype,"_processService",2),lx([ao(Bk)],cx.prototype,"_eventService",2),lx([ao(Ok)],cx.prototype,"_model",2),cx=lx([io()],cx);var ux=Object.defineProperty,dx=Object.getOwnPropertyDescriptor,fx=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ux(t,r,o),o};let hx=class{getViewField(e,t){return this._model.viewFieldModel.findOne({view_uuid:e,field_uuid:t})}getViewFields(e,t=!0){const r={view_uuid:e};t&&(r.hidden={$not:!0});const n=new Yh,i=this._model.viewFieldModel.find(r);for(const e of i){const t=new Kp(e.toJSON());t.set("field",this._fieldService.getField(e.get("field_uuid"))),n.push([t])}return n}getViewFieldsCount(e,t=!0){const r={view_uuid:e};return t&&(r.hidden={$not:!0}),this._model.viewFieldModel.find(r).length}getAllViewFields(e){return this.getViewFields(e,!1)}create({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i}){const o=this._model.viewModel.findOne({uuid:e});if(!o)return;const a=zE.isMultiple(t.type),s=this._fieldService.create({uuid:t.uuid,name:t.name,type:t.type,color:t.color,multiple:a,options:t.options});let l=this._model.viewFieldModel.find({view_uuid:e});const c=Lp(l,(e=>e.get("field_uuid")===n)),u={uuid:null==r?void 0:r.uuid,size:null==r?void 0:r.size,created_at:null==r?void 0:r.created_at,updated_at:null==r?void 0:r.updated_at,view_uuid:e,field_uuid:s.uuid};return o.get("type")===LE.FORM&&(u.required=!0),this._model.viewFieldModel.create(u),l=this._model.viewFieldModel.find({view_uuid:e}),"before"===i?this._model.viewFieldModel.moveBefore({view_uuid:e,field_uuid:n},{view_uuid:e,field_uuid:t.uuid}):c!==l.length-1&&this._model.viewFieldModel.moveAfter({view_uuid:e,field_uuid:n},{view_uuid:e,field_uuid:t.uuid}),s}copy(e,t,r){const n=this.getAllViewFields(e),i=[];for(const e of n)(!r||!r(e))&&i.push({field_uuid:e.get("field_uuid"),view_uuid:t,name:e.get("name"),size:e.get("size"),display_type:e.get("display_type"),required:e.get("required"),hidden:e.get("hidden")});this._model.viewFieldModel.bulkCreate(i)}insert(e,t){const r=this._model.viewModel.findOne({uuid:t}),n=this._model.fieldModel.findOne({uuid:e});if(r&&n)return this._model.viewFieldModel.upsert({view_uuid:r.get("uuid"),field_uuid:n.get("uuid")},{view_uuid:r.get("uuid"),field_uuid:n.get("uuid"),hidden:!1})}remove(e,t,r){const n={field_uuid:e,view_uuid:t};if(this._model.viewFieldModel.remove(n),!r)return this._fieldService.remove(e)}removeAll(e){return this._model.viewFieldModel.remove({view_uuid:e}),this._fieldService.removeAll()}update(e,t,r,n){return this._model.viewFieldModel.update({view_uuid:e,field_uuid:t},{[r]:n})}updateOrder(e,t,r){const n=this._model.viewFieldModel.find({view_uuid:e}),i=Lp(n,(e=>e.get("field_uuid")===t)),o=r?Lp(n,(e=>e.get("field_uuid")===r)):0,a=n.get(o);i<o?this._model.viewFieldModel.moveAfter({view_uuid:e,field_uuid:null==a?void 0:a.get("field_uuid")},{view_uuid:e,field_uuid:t}):this._model.viewFieldModel.moveBefore({view_uuid:e,field_uuid:null==a?void 0:a.get("field_uuid")},{view_uuid:e,field_uuid:t})}refresh(e){const t=this.getViewFields(e,!1),r=this._model.fieldModel.find(),n=$p(r,((e,t)=>(e[t.get("uuid")]=!0,e)),{}),i=this._viewConfigService.getViewConfig(e);if(i&&i.get("cover_field_uuid")&&!n[i.get("cover_field_uuid")]){const t=Fp(r,(e=>e.get("type")===pE.IMAGE));t&&this._viewConfigService.update(e,{cover_field_uuid:t.get("uuid")})}for(const e of t)n[e.get("field_uuid")]?delete n[e.get("field_uuid")]:this._model.viewFieldModel.remove({field_uuid:e.get("field_uuid"),view_uuid:e.get("view_uuid")});const o=Object.keys(n);if(o.length>0)for(const t of o)this._model.viewFieldModel.create({view_uuid:e,field_uuid:t})}clone(e,t,r){const n=this._model.viewFieldModel.findOne({view_uuid:e,field_uuid:t});if(!n)return;const i=this._model.fieldModel.findOne({uuid:n.get("field_uuid")}),o=this.getViewFieldName(n.get("view_uuid"),null==i?void 0:i.get("type"),null==n?void 0:n.get("name"));this._fieldService.clone(n.get("field_uuid"),r);const a=this._model.viewFieldModel.create({view_uuid:n.get("view_uuid"),field_uuid:r,size:null==n?void 0:n.get("size"),name:o,display_type:n.get("display_type"),required:n.get("required")});return this._model.viewFieldModel.moveAfter({view_uuid:e,field_uuid:t},{view_uuid:e,field_uuid:r}),a}getViewFieldName(e,t,r){const n=this._model.fieldModel.find({type:t}),i=this._model.viewFieldModel.find({view_uuid:e}),o=n.length,a=e=>{var n;const o=(r||(null==(n=_E.find((e=>e.type===t)))?void 0:n.name))+" "+e;return Fp(i,(e=>e.get("name")===o))?a(e+1):o};return a(o)}updateGroup(e,t,r){this._model.viewFieldModel.update({view_uuid:e,field_uuid:t},{group_uuid:r?r.uuid:""})}};fx([ao(Ok)],hx.prototype,"_model",2),fx([ao(cx)],hx.prototype,"_fieldService",2),fx([ao(Dk)],hx.prototype,"_viewConfigService",2),hx=fx([io()],hx);var px=Object.defineProperty,gx=Object.getOwnPropertyDescriptor,mx=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&px(t,r,o),o};let vx=class{getRecords(){return this._model.recordModel.find()}getRecordById(e){return this._model.recordModel.findById(e)}getRecordDesc(e){const t=this._model.recordModel.findById(e);if(t)return t.get("desc")}create(e){var t;const r=null==(t=this._contextService.currentUser)?void 0:t.uid,n={uuid:e.uuid,creator_id:(null==e?void 0:e.modifier_id)||r,modifier_id:(null==e?void 0:e.modifier_id)||r,updated_at:+new Date,created_at:+new Date};return Array.isArray(e.uuid)?this._model.recordModel.bulkCreate(e.uuid.map((t=>({uuid:t,creator_id:r,modifier_id:(null==e?void 0:e.modifier_id)||r})))):(this._model.recordModel.create(n),[n])}update(e,t){if(this._model.recordModel.findById(e))return this._model.recordModel.update({uuid:e},t)}bulkCreate(e){var t;const r=null==(t=this._contextService.currentUser)?void 0:t.uid;return this._model.recordModel.bulkCreate(e.map((e=>({uuid:e.uuid,creator_id:e.creator_id||r,modifier_id:e.modifier_id||r}))))}remove(e){return this._model.recordModel.remove({uuid:e})}removeAll(){const e=this._model.recordModel.find();return this._model.recordModel.remove({uuid:Bp(e,(e=>e.get("uuid")))})}};mx([ao(Tk)],vx.prototype,"_contextService",2),mx([ao(Ok)],vx.prototype,"_model",2),vx=mx([io()],vx);var yx=Object.defineProperty,bx=Object.getOwnPropertyDescriptor,_x=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yx(t,r,o),o};let wx=class{getViewGroup(e){const t=this._model.groupModel.findOne({view_uuid:e});if(!t)return;const r=this._model.fieldModel.findOne({uuid:t.get("field_uuid")});if(!r)return void this._model.groupModel.remove({uuid:t.get("uuid"),view_uuid:e});const n=this._model.fieldOptionModel.find({field_uuid:t.get("field_uuid")});return{group:t,field:r,options:n}}isGroup(e){return!!this.getViewGroup(e)}create(e,t){const r=this._model.groupModel.create({view_uuid:e,field_uuid:t.field_uuid,type:t.type});this.refreshViewRecordGroupKey(e,r)}remove(e){this._model.groupModel.remove({view_uuid:e})}update(e,t){const r=this._model.groupModel.update({view_uuid:e},{field_uuid:t.field_uuid,view_uuid:e,type:t.type});return this.refreshViewRecordGroupKey(e,t),r}refreshViewRecordGroupKey(e,t){const r=this._model.viewRecordModel.find({view_uuid:e}),n=this.refreshViewRecords(r,t),i=this._fieldService.getField(t.field_uuid);i&&i.get("type")===pE.MENTION&&this._removeMentionFieldOption(n,i)}refreshViewRecords(e,t){const r=[];for(const n of e){const e=this.refreshViewRecord(n,t);e&&r.push(e)}return r}refreshViewRecord(e,t,r={}){const n=this._cellService.getCellKeyValue(t.field_uuid,e.get("record_uuid"))||"";let i=this._model.viewRecordModel.findOne({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid")});null!=i&&i.get("group_item_key")||(this._model.viewRecordModel.update({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid")},{group_item_key:""}),i=this._model.viewRecordModel.findOne({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid")})),(null==i?void 0:i.get("group_item_key"))!=n&&this._model.viewRecordModel.update({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid")},{group_item_key:n},r);const o=this._fieldService.getField(t.field_uuid);return o&&o.get("type")===pE.MENTION&&this._refreshMentionFieldOption(e.get("view_uuid"),o,t,n),n}_refreshMentionFieldOption(e,t,r,n){if(!n)return;if(!zp(this._model.fieldOptionModel.find({field_uuid:t.get("uuid")}),(e=>e.get("uuid")===n))){const t=this._model.viewModel.findOne({uuid:e});this._model.fieldOptionModel.create({field_uuid:r.field_uuid,uuid:n,name:n,temp:(null==t?void 0:t.get("type"))!==LE.KANBAN})}}_removeMentionFieldOption(e,t){this._model.fieldOptionModel.find({field_uuid:t.get("uuid")}).forEach((t=>{e.indexOf(t.get("uuid"))<0&&this._model.fieldOptionModel.remove({uuid:t.get("uuid"),temp:!0})}))}copy(e,t){const r=this._model.groupModel.find({view_uuid:e});!r||0===r.length||this._model.groupModel.bulkCreate(Bp(r,(e=>({view_uuid:t,field_uuid:e.get("field_uuid"),type:e.get("type")}))))}createDefaultKanbanViewGroup(e){const t=this._fieldService.getFields();let r=Fp(t,(e=>pE.SELECT===e.get("type")));return r||(r=Fp(t,(e=>pE.MENTION===e.get("type")))),this.create(e,{field_uuid:null==r?void 0:r.get("uuid"),view_uuid:e}),this.getViewGroup(e)}};_x([ao(Ok)],wx.prototype,"_model",2),_x([ao(cx)],wx.prototype,"_fieldService",2),_x([ao(Wk)],wx.prototype,"_cellService",2),wx=_x([io()],wx);var Cx=Object.defineProperty,Ex=Object.getOwnPropertyDescriptor;let Sx=class{sort(e="asc",t,r,n){return t=zE.isSelectLike(r.get("type"))?"asc"===e?this.ascSortSelect(t,n):this.descSortSelect(t,n):[pE.NUMBER,pE.CHECKBOX].includes(r.get("type"))?"asc"===e?this.ascSortNumber(t):this.descSortNumber(t):zE.isDate(r.get("type"))||zE.isSystemDate(r.get("type"))?"asc"===e?this.ascSortDate(t):this.descSortDate(t):zE.isUri(r.get("type"))||zE.isMentionLike(r.get("type"))?"asc"===e?this.ascSortUri(t):this.descSortUri(t):"asc"===e?this.ascSortText(t):this.descSortText(t)}ascSortText(e){return e.sort(((e,t)=>{const r=e.option.value||"",n=t.option.value||"";return r.localeCompare(n)}))}descSortText(e){return e.sort(((e,t)=>{const r=e.option.value||"";return(t.option.value||"").localeCompare(r)}))}ascSortNumber(e){return e.sort(((e,t)=>Number(e.option.value)-Number(t.option.value)))}descSortNumber(e){return e.sort(((e,t)=>Number(t.option.value)-Number(e.option.value)))}ascSortDate(e){return e.sort(((e,t)=>bf(e.option.value).unix()-bf(t.option.value).unix()))}descSortDate(e){return e.sort(((e,t)=>bf(t.option.value).unix()-bf(e.option.value).unix()))}ascSortUri(e){return e.sort(((e,t)=>{var r,n;const i=null!=(r=e.option.value)&&r.toJSON?e.option.value.toJSON():e.option.value,o=null!=(n=t.option.value)&&n.toJSON?t.option.value.toJSON():t.option.value,a=(Array.isArray(i)?null==i?void 0:i[0].name:i.name)||"",s=(Array.isArray(o)?null==o?void 0:o[0].name:o.name)||"";return a.localeCompare(s)}))}descSortUri(e){return e.sort(((e,t)=>{var r,n;const i=null!=(r=e.option.value)&&r.toJSON?e.option.value.toJSON():e.option.value,o=null!=(n=t.option.value)&&n.toJSON?t.option.value.toJSON():t.option.value,a=(Array.isArray(i)?null==i?void 0:i[0].name:i.name)||"";return((Array.isArray(o)?null==o?void 0:o[0].name:o.name)||"").localeCompare(a)}))}ascSortSelect(e,t){const r=Bp(t,(e=>e.get("uuid")));return this._getlistOrderByOptions(e,r)}descSortSelect(e,t){const r=Bp(t,(e=>e.get("uuid"))).reverse();return this._getlistOrderByOptions(e,r)}_getlistOrderByOptions(e,t){const r=t.reduce(((e,t)=>(e[t]=[],e)),{}),n=[];for(const t of e){const e=t.option.value;if(e){const n=Array.isArray(e)?e[0]:e;r[n].push(t)}else n.push(t)}let i=[];return t.forEach((e=>{i=i.concat(r[e])})),i=i.concat(n),i}};Sx=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ex(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cx(t,r,o),o})([io()],Sx);var kx=Object.defineProperty,xx=Object.getOwnPropertyDescriptor,Ox=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kx(t,r,o),o};let Ix=class{groupViewRecords(e,t,r){var n;const i={},o=this._model.viewModel.findOne({uuid:t.get("view_uuid")});for(const t of e)t.get("group_item_key")?(i[t.get("group_item_key")]=i[t.get("group_item_key")]||[],i[t.get("group_item_key")].push(t)):(i[""]=i[""]||[],i[""].push(t));let a=[];const s=this._fieldService.getField(t.get("field_uuid"));if(a=zE.isSelect(s.get("type"))||zE.isMention(s.get("type"))?Bp(r,(e=>{if(!e||!e.get("uuid"))return null;const t={...e.toJSON(),fieldId:e.get("field_uuid"),value:e.get("uuid")};if(zE.isMention(s.get("type"))){const r=this._model.userModel.find({uid:e.get("uuid").split(",")});if(0===r.length)return null;t.value=r}return{option:t,field:s,viewRecords:i[e.get("uuid")]||[]}})).filter((e=>!!e)):Object.keys(i).map((e=>{if(""===e)return;const r=i[e][0].get("record_uuid");return{option:this._cellService.getCell(t.get("field_uuid"),r),field:s,viewRecords:i[e]||[]}})).filter((e=>!!e)),(null==s?void 0:s.get("type"))===pE.CHECKBOX&&a.push({field:s,option:{value:!1},viewRecords:i[""]}),(null==o?void 0:o.get("type"))!==LE.KANBAN&&(a=this._groupSortService.sort(t.get("type"),a,s,r)),(null==s?void 0:s.get("type"))!==pE.CHECKBOX&&a.push({field:s,option:null,viewRecords:i[""]}),(null==o?void 0:o.get("type"))===LE.KANBAN){const e=a.findIndex((e=>!e.option));if(e>-1){const t=a.splice(e,1)[0];t.viewRecords&&t.viewRecords.length>0&&a.unshift(t)}for(const e of a)null==(n=e.viewRecords)||n.reverse()}return a}};Ox([ao(Ok)],Ix.prototype,"_model",2),Ox([ao(cx)],Ix.prototype,"_fieldService",2),Ox([ao(Wk)],Ix.prototype,"_cellService",2),Ox([ao(Sx)],Ix.prototype,"_groupSortService",2),Ix=Ox([io()],Ix);var Rx=Object.defineProperty,Tx=Object.getOwnPropertyDescriptor,Ax=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rx(t,r,o),o};let Mx=class{getOriginViewRecords(e){return this._model.viewRecordModel.find({view_uuid:e})}getViewRecords(e,t=!0){const r={view_uuid:e};return t&&(r.hidden={$not:!0}),this._model.viewRecordModel.find(r)}getGroupViewRecords(e,t=!0){const r=this._groupService.getViewGroup(e),n=this.getViewRecords(e,t);return this._groupRecordService.groupViewRecords(n,r.group,r.options)}getViewRecordsDetail(e,t){Array.isArray(t)||(t=[t]);const r=this._model.viewRecordModel.find({view_uuid:e,record_uuid:t}),n=this._model.viewFieldModel.find({view_uuid:e,hidden:{$not:!0}}),i=[];for(const e of r){const t=this._model.recordModel.findOne({uuid:e.get("record_uuid")});if(!t)continue;const r=[],o={};o.cellMap=new Map,n.forEach(((e,n)=>{const i=this._fieldService.getField(e.get("field_uuid"));if(!i||!t)return;const a=this._cellService.getCell(i.get("uuid"),t.get("uuid"));r.push(a),o.cellMap.set(i.get("uuid"),n)})),o.record=t,o.cells=r,i.push(o)}return i}getViewRecordsCount(e,t=!0){const r={view_uuid:e};return t&&(r.hidden={$not:!0}),(this._model.viewRecordModel.find(r)||[]).length}getFlatViewRecords(e){return this._model.viewRecordModel.find({view_uuid:e,hidden:{$not:!0}})}getGroupFlatViewRecords(e){const t=this._groupService.getViewGroup(e),r=this._model.viewRecordModel.find({view_uuid:e,hidden:{$not:!0}}),n=new Yh,i=this._groupRecordService.groupViewRecords(r,t.group,t.options);for(const e of i)if(e.viewRecords)for(const t of e.viewRecords)n.push([t]);return n}getViewRecordByRecordId(e,t){return this._model.viewRecordModel.findOne({view_uuid:e,record_uuid:t})}getVisibleRecordIds(e){return Bp(this._model.viewRecordModel.find({view_uuid:e}),(e=>e.get("record_uuid")))||[]}getFieldRecords(e,t,r){const n={view_uuid:e,hidden:{$not:!0}};null!=r&&(n.group_item_key=r);const i=this._model.viewRecordModel.find(n),o=Gp(this._recordService.getRecords(),"uuid"),a=[];for(const e of i){if(!e.get("record_uuid"))continue;const r=o.get(e.get("record_uuid"));if(!r)continue;const n=this._cellService.getCell(t,r.get("uuid"));!n||a.push({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid"),cells:[n]})}return a}createEmpty({uuid:e,viewId:t,viewRecord:r,sourceRecordId:n,direction:i,groupOption:o,modifierId:a}){let s=this._recordService.create({uuid:e,modifier_id:a});Array.isArray(s)||(s=[s]);for(const e of s)if(null!=o){const t=o.value;this._cellService.setCell(o.fieldId,e.uuid,{fieldId:o.fieldId,recordId:e.uuid,value:null!=t&&t.toJSON?t.toJSON():t})}return s.forEach((e=>{const a={uuid:null==r?void 0:r.uuid,created_at:null==r?void 0:r.created_at,updated_at:null==r?void 0:r.updated_at,view_uuid:t,record_uuid:e.uuid};null!=o&&(a.group_item_key=this._cellService.keyValue(o)),n?"after"===i?this._model.viewRecordModel.createAfter({view_uuid:t,record_uuid:n},a):this._model.viewRecordModel.createBefore({view_uuid:t,record_uuid:n},a):this._model.viewRecordModel.create(a)})),s}createRecord(e,t,r){const n=this.createEmpty({uuid:r.uuid,viewId:e,direction:"after",sourceRecordId:t}),i=Object.keys(r);for(const e of i){const t=this._fieldService.getField(e);if(!t)continue;let i=r[e];Array.isArray(i)||(i=[i]);for(const e of i)this._cellService.setCell(t.get("uuid"),n[0].uuid,e)}return n}createRecords(e,t){this._recordService.bulkCreate(t),this._model.viewRecordModel.bulkCreate(t.map((t=>({view_uuid:e,record_uuid:t.uuid}))),{validate:!1})}copy(e,t){const r=this._model.viewRecordModel.find({view_uuid:e}),n=[];for(const e of r)!e||n.push({uuid:To(32),view_uuid:t,record_uuid:e.get("record_uuid"),hidden:e.get("hidden"),group_item_key:e.get("group_item_key")});this._model.viewRecordModel.bulkCreate(n)}copyRecord({uuid:e,viewId:t,sourceRecordId:r,modifierId:n}){const i=this._recordService.create({uuid:e,modifier_id:n})[0];let o=this._model.viewRecordModel.find({view_uuid:t});const a=Lp(o,(e=>e.get("record_uuid")===r)),s=o.get(a);if(!s)return;const l=this._model.viewFieldModel.find({view_uuid:t});for(const e of l)this._cellService.copy(e.get("field_uuid"),s.get("record_uuid"),e.get("field_uuid"),i.uuid);this._model.viewRecordModel.create({uuid:To(32),view_uuid:s.get("view_uuid"),record_uuid:i.uuid,hidden:s.get("hidden"),group_item_key:s.get("group_item_key")}),o=this._model.viewRecordModel.find({view_uuid:t}),a!==o.length-1&&this._model.viewRecordModel.moveAfter({view_uuid:t,record_uuid:r},{view_uuid:t,record_uuid:i.uuid})}remove(e,t){this._model.viewRecordModel.remove({view_uuid:e,record_uuid:t}),this._recordService.remove(t),this._cellService.removeByRecordId(t)}removeAll(e){return this._model.viewRecordModel.remove({view_uuid:e}),this._cellService.removeByRecordId(),this._recordService.removeAll()}updateOrder(e,t,r,n,i=RE.forward){const o=this.getOriginViewRecords(e);let a=o.toArray();if(null!=n){const r=this._model.viewRecordModel.findOne({view_uuid:e,record_uuid:t});this.updateGroupByViewRecord(r,n),a=Vp(o,(e=>{var t;return e.get("group_item_key")===(null==(t=n.option)?void 0:t.value)})).toArray()}const s=Lp(o,(e=>e.get("record_uuid")===t)),l=Lp(o,(e=>e.get("record_uuid")===r)),c=o.get(l);let u;if(c&&(u={view_uuid:e,record_uuid:c.get("record_uuid")}),i===RE.forward)if(s<l){if(u||(u={view_uuid:e,record_uuid:a[a.length-1].get("record_uuid")}),u.record_uuid===t)return;this._model.viewRecordModel.moveAfter(u,{view_uuid:e,record_uuid:t})}else{if(u||(u={view_uuid:e,record_uuid:a[0].get("record_uuid")}),u.record_uuid===t)return;this._model.viewRecordModel.moveBefore(u,{view_uuid:e,record_uuid:t})}else if(s<l){if(u||(u={view_uuid:e,record_uuid:a[0].get("record_uuid")}),u.record_uuid===t)return;this._model.viewRecordModel.moveAfter(u,{view_uuid:e,record_uuid:t})}else{if(u||(u={view_uuid:e,record_uuid:a[a.length-1].get("record_uuid")}),u.record_uuid===t)return;this._model.viewRecordModel.moveBefore(u,{view_uuid:e,record_uuid:t})}}updateGroupByViewRecord(e,t){var r,n;if(e.get("group_item_key")===(null==(r=null==t?void 0:t.option)?void 0:r.value))return;const i=t.field.get("type"),o=this._fieldRegistry.getValueField(i),a=t.field.get("uuid"),s=e.get("record_uuid");this._cellService.removeByRecordId(s,a);const l=null==(n=null==t?void 0:t.option)?void 0:n.value;if(o){const t=o.keyValue(l);this._model.viewRecordModel.update({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid")},{group_item_key:t}),this._cellService.setCell(a,s,{fieldId:a,recordId:s,value:(null!=l&&l.toJSON?l.toJSON():l)||""})}else this._model.viewRecordModel.update({view_uuid:e.get("view_uuid"),record_uuid:e.get("record_uuid")},{group_item_key:""})}};Ax([ao(Ok)],Mx.prototype,"_model",2),Ax([ao(vx)],Mx.prototype,"_recordService",2),Ax([ao(cx)],Mx.prototype,"_fieldService",2),Ax([ao(Wk)],Mx.prototype,"_cellService",2),Ax([ao(wx)],Mx.prototype,"_groupService",2),Ax([ao(Fk)],Mx.prototype,"_fieldRegistry",2),Ax([ao(Ix)],Mx.prototype,"_groupRecordService",2),Mx=Ax([io()],Mx);var Nx=1e6,Dx=1e6,Px="[big.js] ",jx=Px+"Invalid ",Fx=jx+"decimal places",Vx=jx+"rounding mode",Lx=Px+"Division by zero",$x={},Bx=void 0,Ux=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function zx(e,t,r,n){var i=e.c;if(r===Bx&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error(Vx);if(t<1)n=3===r&&(n||!!i[0])||0===t&&(1===r&&i[0]>=5||2===r&&(i[0]>5||5===i[0]&&(n||i[1]!==Bx))),i.length=1,n?(e.e=e.e-t+1,i[0]=1):i[0]=e.e=0;else if(t<i.length){if(n=1===r&&i[t]>=5||2===r&&(i[t]>5||5===i[t]&&(n||i[t+1]!==Bx||1&i[t-1]))||3===r&&(n||!!i[0]),i.length=t,n)for(;++i[--t]>9;)if(i[t]=0,0===t){++e.e,i.unshift(1);break}for(t=i.length;!i[--t];)i.pop()}return e}function Hx(e,t,r){var n=e.e,i=e.c.join(""),o=i.length;if(t)i=i.charAt(0)+(o>1?"."+i.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)i="0"+i;i="0."+i}else if(n>0)if(++n>o)for(n-=o;n--;)i+="0";else n<o&&(i=i.slice(0,n)+"."+i.slice(n));else o>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&r?"-"+i:i}$x.abs=function(){var e=new this.constructor(this);return e.s=1,e},$x.cmp=function(e){var t,r=this,n=r.c,i=(e=new r.constructor(e)).c,o=r.s,a=e.s,s=r.e,l=e.e;if(!n[0]||!i[0])return n[0]?o:i[0]?-a:0;if(o!=a)return o;if(t=o<0,s!=l)return s>l^t?1:-1;for(a=(s=n.length)<(l=i.length)?s:l,o=-1;++o<a;)if(n[o]!=i[o])return n[o]>i[o]^t?1:-1;return s==l?0:s>l^t?1:-1},$x.div=function(e){var t=this,r=t.constructor,n=t.c,i=(e=new r(e)).c,o=t.s==e.s?1:-1,a=r.DP;if(a!==~~a||a<0||a>Nx)throw Error(Fx);if(!i[0])throw Error(Lx);if(!n[0])return e.s=o,e.c=[e.e=0],e;var s,l,c,u,d,f=i.slice(),h=s=i.length,p=n.length,g=n.slice(0,s),m=g.length,v=e,y=v.c=[],b=0,_=a+(v.e=t.e-e.e)+1;for(v.s=o,o=_<0?0:_,f.unshift(0);m++<s;)g.push(0);do{for(c=0;c<10;c++){if(s!=(m=g.length))u=s>m?1:-1;else for(d=-1,u=0;++d<s;)if(i[d]!=g[d]){u=i[d]>g[d]?1:-1;break}if(!(u<0))break;for(l=m==s?i:f;m;){if(g[--m]<l[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=l[m]}for(;!g[0];)g.shift()}y[b++]=u?c:++c,g[0]&&u?g[m]=n[h]||0:g=[n[h]]}while((h++<p||g[0]!==Bx)&&o--);return!y[0]&&1!=b&&(y.shift(),v.e--,_--),b>_&&zx(v,_,r.RM,g[0]!==Bx),v},$x.eq=function(e){return 0===this.cmp(e)},$x.gt=function(e){return this.cmp(e)>0},$x.gte=function(e){return this.cmp(e)>-1},$x.lt=function(e){return this.cmp(e)<0},$x.lte=function(e){return this.cmp(e)<1},$x.minus=$x.sub=function(e){var t,r,n,i,o=this,a=o.constructor,s=o.s,l=(e=new a(e)).s;if(s!=l)return e.s=-l,o.plus(e);var c=o.c.slice(),u=o.e,d=e.c,f=e.e;if(!c[0]||!d[0])return d[0]?e.s=-l:c[0]?e=new a(o):e.s=1,e;if(s=u-f){for((i=s<0)?(s=-s,n=c):(f=u,n=d),n.reverse(),l=s;l--;)n.push(0);n.reverse()}else for(r=((i=c.length<d.length)?c:d).length,s=l=0;l<r;l++)if(c[l]!=d[l]){i=c[l]<d[l];break}if(i&&(n=c,c=d,d=n,e.s=-e.s),(l=(r=d.length)-(t=c.length))>0)for(;l--;)c[t++]=0;for(l=t;r>s;){if(c[--r]<d[r]){for(t=r;t&&!c[--t];)c[t]=9;--c[t],c[r]+=10}c[r]-=d[r]}for(;0===c[--l];)c.pop();for(;0===c[0];)c.shift(),--f;return c[0]||(e.s=1,c=[f=0]),e.c=c,e.e=f,e},$x.mod=function(e){var t,r=this,n=r.constructor,i=r.s,o=(e=new n(e)).s;if(!e.c[0])throw Error(Lx);return r.s=e.s=1,t=1==e.cmp(r),r.s=i,e.s=o,t?new n(r):(i=n.DP,o=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=i,n.RM=o,this.minus(r.times(e)))},$x.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},$x.plus=$x.add=function(e){var t,r,n,i=this,o=i.constructor;if(e=new o(e),i.s!=e.s)return e.s=-e.s,i.minus(e);var a=i.e,s=i.c,l=e.e,c=e.c;if(!s[0]||!c[0])return c[0]||(s[0]?e=new o(i):e.s=i.s),e;if(s=s.slice(),t=a-l){for(t>0?(l=a,n=c):(t=-t,n=s),n.reverse();t--;)n.push(0);n.reverse()}for(s.length-c.length<0&&(n=c,c=s,s=n),t=c.length,r=0;t;s[t]%=10)r=(s[--t]=s[t]+c[t]+r)/10|0;for(r&&(s.unshift(r),++l),t=s.length;0===s[--t];)s.pop();return e.c=s,e.e=l,e},$x.pow=function(e){var t=this,r=new t.constructor("1"),n=r,i=e<0;if(e!==~~e||e<-Dx||e>Dx)throw Error(jx+"exponent");for(i&&(e=-e);1&e&&(n=n.times(t)),e>>=1;)t=t.times(t);return i?r.div(n):n},$x.prec=function(e,t){if(e!==~~e||e<1||e>Nx)throw Error(jx+"precision");return zx(new this.constructor(this),e,t)},$x.round=function(e,t){if(e===Bx)e=0;else if(e!==~~e||e<-Nx||e>Nx)throw Error(Fx);return zx(new this.constructor(this),e+this.e+1,t)},$x.sqrt=function(){var e,t,r,n=this,i=n.constructor,o=n.s,a=n.e,s=new i("0.5");if(!n.c[0])return new i(n);if(o<0)throw Error(Px+"No square root");0===(o=Math.sqrt(n+""))||o===1/0?((t=n.c.join("")).length+a&1||(t+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new i(((o=Math.sqrt(t))==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):e=new i(o+""),a=e.e+(i.DP+=4);do{r=e,e=s.times(r.plus(n.div(r)))}while(r.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return zx(e,(i.DP-=4)+e.e+1,i.RM)},$x.times=$x.mul=function(e){var t,r=this,n=r.constructor,i=r.c,o=(e=new n(e)).c,a=i.length,s=o.length,l=r.e,c=e.e;if(e.s=r.s==e.s?1:-1,!i[0]||!o[0])return e.c=[e.e=0],e;for(e.e=l+c,a<s&&(t=i,i=o,o=t,c=a,a=s,s=c),t=new Array(c=a+s);c--;)t[c]=0;for(l=s;l--;){for(s=0,c=a+l;c>l;)s=t[c]+o[l]*i[c-l-1]+s,t[c--]=s%10,s=s/10|0;t[c]=s}for(s?++e.e:t.shift(),l=t.length;!t[--l];)t.pop();return e.c=t,e},$x.toExponential=function(e,t){var r=this,n=r.c[0];if(e!==Bx){if(e!==~~e||e<0||e>Nx)throw Error(Fx);for(r=zx(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return Hx(r,!0,!!n)},$x.toFixed=function(e,t){var r=this,n=r.c[0];if(e!==Bx){if(e!==~~e||e<0||e>Nx)throw Error(Fx);for(e=e+(r=zx(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return Hx(r,!1,!!n)},$x[Symbol.for("nodejs.util.inspect.custom")]=$x.toJSON=$x.toString=function(){var e=this,t=e.constructor;return Hx(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},$x.toNumber=function(){var e=Number(Hx(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(Px+"Imprecise conversion");return e},$x.toPrecision=function(e,t){var r=this,n=r.constructor,i=r.c[0];if(e!==Bx){if(e!==~~e||e<1||e>Nx)throw Error(jx+"precision");for(r=zx(new n(r),e,t);r.c.length<e;)r.c.push(0)}return Hx(r,e<=r.e||r.e<=n.NE||r.e>=n.PE,!!i)},$x.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(Px+"valueOf disallowed");return Hx(e,e.e<=t.NE||e.e>=t.PE,!0)};var Wx=function e(){function t(r){var n=this;if(!(n instanceof t))return r===Bx?e():new t(r);if(r instanceof t)n.s=r.s,n.e=r.e,n.c=r.c.slice();else{if("string"!=typeof r){if(!0===t.strict&&"bigint"!=typeof r)throw TypeError(jx+"value");r=0===r&&1/r<0?"-0":String(r)}!function(e,t){var r,n,i;if(!Ux.test(t))throw Error(jx+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),i=t.length,n=0;n<i&&"0"==t.charAt(n);)++n;if(n==i)e.c=[e.e=0];else{for(;i>0&&"0"==t.charAt(--i););for(e.e=r-n-1,e.c=[],r=0;n<=i;)e.c[r++]=+t.charAt(n++)}}(n,r)}n.constructor=t}return t.prototype=$x,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=false,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}();function Gx(e,t,r){let n;e=""===e||null===e?0:e,t=""===t||null===t?0:t;try{n=(e=new Wx(e))[r](t).valueOf()}catch{n=NaN}return n}const Kx=(e,t)=>Gx(e,t,"plus"),qx=(e,t)=>Gx(e,t,"times"),Yx=(e,t)=>isNaN(e)?NaN:""===t||0===parseFloat(t)?1/0:Gx(e,t,"div"),Jx=(e,t)=>Gx(e,t,"lt");var Xx=Object.defineProperty,Zx=Object.getOwnPropertyDescriptor;let Qx=class{sort(e,t,r,n){return t=this.ascSortCreatedAt(t),t=zE.isSelectLike(r.get("type"))?"asc"===e?this.ascSortSelect(t,r,n):this.descSortSelect(t,r,n):[pE.NUMBER,pE.CHECKBOX].includes(r.get("type"))?"asc"===e?this.ascSortNumber(t):this.descSortNumber(t):zE.isDate(r.get("type"))?"asc"===e?this.ascSortDate(t):this.descSortDate(t):"asc"===e?this.ascSortText(t):this.descSortText(t)}ascSortCreatedAt(e){return e.sort(((e,t)=>+new Date(e.created_at)-+new Date(t.created_at)))}ascSortText(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return r.localeCompare(n)}))}descSortText(e){return e.sort(((e,t)=>{const r=e.sortValue||"";return(t.sortValue||"").localeCompare(r)}))}ascSortNumber(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return r===n?0:Jx(r,n)?-1:1}))}descSortNumber(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return r===n?0:Jx(n,r)?-1:1}))}ascSortDate(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return bf(r).unix()-bf(n).unix()}))}descSortDate(e){return e.sort(((e,t)=>{const r=e.sortValue||"",n=t.sortValue||"";return bf(n).unix()-bf(r).unix()}))}ascSortSelect(e,t,r){const n=Bp(r,(e=>e.get("uuid")));return this._getViewRecordsOrderByOptions(e,n,t)}descSortSelect(e,t,r){const n=Bp(r,(e=>e.get("uuid"))).reverse();return this._getViewRecordsOrderByOptions(e,n,t)}_getViewRecordsOrderByOptions(e,t,r){const n=t.reduce(((e,t)=>(e[t]=[],e)),{}),i=[];for(const t of e)if(zE.isSelect(r.get("type"))&&null!=t.sortValue)n[t.sortValue].push(t);else if(zE.isMultiSelect(r.get("type"))&&0!==t.sortValue.length){const e=t.sortValue.split(",")[0];n[e].push(t)}else i.push(t);let o=[];return t.forEach((e=>{o=o.concat(n[e])})),o=o.concat(i),o}};Qx=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zx(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xx(t,r,o),o})([io()],Qx);var eO=Object.defineProperty,tO=Object.getOwnPropertyDescriptor,rO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eO(t,r,o),o};let nO=class{getViewSort(e){return this._model.sortModel.findOne({view_uuid:e})}isKeepSort(e){const t=this._model.viewConfigModel.findOne({view_uuid:e});return!(null==t||!t.get("keep_sort"))}create(e,t,r){if(!this._fieldService.getField(t.field_uuid))return;const n=this._model.sortModel.create({view_uuid:e,field_uuid:t.field_uuid,type:t.type});return this._model.viewConfigModel.update({view_uuid:e},{keep_sort:r}),this.refresh(e),r||this.remove(e),n}remove(e){const t=this._model.sortModel.remove({view_uuid:e});return this._model.viewConfigModel.update({view_uuid:e},{keep_sort:!1}),this.refresh(e),t}update(e,t,r){const n=this._model.sortModel.upsert({view_uuid:e},{view_uuid:e,field_uuid:t.field_uuid,type:t.type});return this._model.viewConfigModel.update({view_uuid:e},{keep_sort:r}),this.refresh(e),r||this.remove(e),n}copy(e,t){const r=this._model.sortModel.find({view_uuid:e});!r||0===r.length||this._model.sortModel.bulkCreate(Bp(r,(e=>({view_uuid:t,field_uuid:e.get("field_uuid"),type:e.get("type")}))))}refresh(e){const t=this._model.viewModel.findOne({uuid:e});let r=this.getViewSort(e);if(!r)return;const n=this._fieldService.getField(r.get("field_uuid"));if(n)if(this._groupService.getViewGroup(e)){(null==t?void 0:t.get("type"))===LE.KANBAN&&(null!=r&&r.get("type")&&"asc"!==r.get("type")?"desc"===r.get("type")&&(this._model.sortModel.update({view_uuid:e},{type:"asc"}),r=this.getViewSort(e)):(this._model.sortModel.update({view_uuid:e},{type:"desc"}),r=this.getViewSort(e)));const i=this._viewRecordService.getGroupViewRecords(e);for(const t of i){if(!t.viewRecords)continue;const i=this._sortViewRecords(t.viewRecords,r,n);this._model.viewRecordModel.remove({view_uuid:e,record_uuid:i.map((e=>e.record_uuid))}),this._model.viewRecordModel.bulkCreate(i.map((e=>({uuid:e.uuid,hidden:e.hidden,view_uuid:e.view_uuid,record_uuid:e.record_uuid,group_item_key:e.group_item_key}))))}}else{const t=this._model.viewRecordModel.find({view_uuid:e}),i=this._sortViewRecords(t,r,n);this._model.viewRecordModel.remove({view_uuid:e,record_uuid:i.map((e=>e.record_uuid))}),this._model.viewRecordModel.bulkCreate(i.map((e=>({uuid:e.uuid,view_uuid:e.view_uuid,hidden:e.hidden,record_uuid:e.record_uuid,group_item_key:e.group_item_key}))))}}_sortViewRecords(e,t,r){let n=[];const i=[];return e.forEach((e=>{const o={uuid:e.get("uuid"),hidden:e.get("hidden"),record_uuid:e.get("record_uuid"),view_uuid:e.get("view_uuid"),group_item_key:e.get("group_item_key")},a=this._model.recordModel.findOne({uuid:o.record_uuid});o.created_at=null==a?void 0:a.get("created_at"),zE.isSelectLike(null==r?void 0:r.get("type"))?o.sortValue=this._cellService.getCellKeyValue(r.get("uuid"),e.get("record_uuid")):zE.isCheckbox(null==r?void 0:r.get("type"))?"是"===o.sortValue||"true"===o.sortValue?o.sortValue=1:o.sortValue=0:o.sortValue=this._cellService.getCellFormattedValue(t.get("field_uuid"),o.record_uuid),""===o.sortValue||null==o.sortValue?i.push(o):n.push(o)})),n=this._sortFuncService.sort(t.get("type"),n,r,this._fieldService.getFieldOptions(r.get("uuid"))),n=[...n,...i],n}};rO([ao(Ok)],nO.prototype,"_model",2),rO([ao(Qx)],nO.prototype,"_sortFuncService",2),rO([ao(Mx)],nO.prototype,"_viewRecordService",2),rO([ao(cx)],nO.prototype,"_fieldService",2),rO([ao(Wk)],nO.prototype,"_cellService",2),rO([ao(wx)],nO.prototype,"_groupService",2),nO=rO([io()],nO);var iO=Object.defineProperty,oO=Object.getOwnPropertyDescriptor;let aO=class{equalTo(e,t){return null===t||e===t}notEqualTo(e,t){return null===t||e!==t}greaterThan(e,t){return null===t||e>t}greaterThanOrEqualTo(e,t){return null===t||e>=t}lessThan(e,t){return null===t||e<t}lessThanOrEqualTo(e,t){return null===t||e<=t}startsWith(e,t){return null===t||"string"==typeof e&&e.startsWith(t)}notStartsWith(e,t){return null===t||"string"==typeof e&&!e.startsWith(t)}endsWith(e,t){return null===t||"string"==typeof e&&e.endsWith(t)}notEndsWith(e,t){return null===t||"string"==typeof e&&!e.endsWith(t)}contains(e,t){return null===t||-1!==e.indexOf(t)}notContains(e,t){return null===t||-1===e.indexOf(t)}yesterday(e){if(!e)return!1;const t=bf().add(-1,"days").startOf("day");return 0===e.startOf("day").diff(t,"days")}today(e){if(!e)return!1;const t=bf().startOf("day");return 0===e.startOf("day").diff(t,"days")}tomorrow(e){if(!e)return!1;const t=bf().add(1,"days").startOf("day");return 0===e.startOf("day").diff(t,"days")}last7days(e){if(!e)return!1;const t=bf().add(-7,"days"),r=e.diff(t,"days",!0);return r>=0&&r<7}lastWeek(e){if(!e)return!1;const t=bf().startOf("week").add(-7,"days").valueOf(),r=e.diff(t,"days",!0);return r>=0&&r<7}thisWeek(e){if(!e)return!1;const t=bf().endOf("week").add(-7,"days").valueOf(),r=e.diff(t,"days",!0);return r>=0&&r<7}nextWeek(e){if(!e)return!1;const t=bf().endOf("week").valueOf(),r=e.diff(t,"days",!0);return r>=0&&r<7}lastMonth(e){if(!e)return!1;const t=bf().startOf("month"),r=t.valueOf(),n=t.add(-1,"months").valueOf();return e.valueOf()>=n&&e.valueOf()<r}thisMonth(e){if(!e)return!1;const t=bf().endOf("month").valueOf(),r=bf().startOf("month");return e.valueOf()>=r&&e.valueOf()<=t}nextMonth(e){if(!e)return!1;const t=bf().endOf("month"),r=t.valueOf(),n=t.add(1,"months").valueOf();return e.valueOf()>r&&e.valueOf()<=n}is(e,t){return null===t||(Array.isArray(e)?e[0]===t:e===t)}isNot(e,t){if(null===t)return!0;if(!Array.isArray(t))return!e||(Array.isArray(e)?e[0]!==t:e!==t);if(!e||Array.isArray(e)&&e.length!==t.length)return!0;for(let r=0;r<e.length;r++)if(!t.includes(e[r]))return!0;return!1}isEmpty(e){return null==e||""===e}isNotEmpty(e){return!this.isEmpty(e)}isEmptySelect(e){return!e||!!Array.isArray(e)&&0===e.length}isNotEmptySelect(e){return!!e&&(!Array.isArray(e)||e.length>0)}hasAnyOf(e,t){if(null===t)return!0;t=Array.isArray(t)?t:[t];for(let r=0;r<t.length;r++)if(Array.isArray(e)){if(e.includes(t[r]))return!0}else if(Vd(e,t[r]))return!0;return!1}hasAllOf(e,t){if(null===t)return!0;t=Array.isArray(t)?t:[t];for(let r=0;r<t.length;r++)if(Array.isArray(e)){if(!e.includes(t[r]))return!1}else if(!Vd(e,t[r]))return!1;return!0}isExactly(e,t){return null===t||Vd(e,t=Array.isArray(t)?t:[t])}hasNoneOf(e,t){if(null===t)return!0;t=Array.isArray(t)?t:[t];for(let r=0;r<t.length;r++)if(Array.isArray(e)){if(e.includes(t[r]))return!1}else if(Vd(e,t[r]))return!1;return!0}};aO=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?oO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iO(t,r,o),o})([io()],aO);var sO=Object.defineProperty,lO=Object.getOwnPropertyDescriptor,cO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?lO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&sO(t,r,o),o};let uO=class{getViewFilters(e){const t=this._model.filterModel.find({view_uuid:e}),r=new Yh;return t.forEach((e=>{const t=this._fieldService.getField(e.get("field_uuid"));if(!t)return;const n=new Kp(e.toJSON());n.set("field",t.toJSON()),r.push([n])})),r}refresh(e){const t=this.getViewFilters(e);if(0===t.length)this._model.viewRecordModel.update({view_uuid:e},{hidden:!1});else{if(Wp(t,(e=>(null==e.get("expected")||""===e.get("expected"))&&!jE.includes(e.get("func")))))return;if(this._groupService.isGroup(e)){const r=this._viewRecordService.getGroupViewRecords(e);for(const n of r)this.refreshViewRecord(e,n.viewRecords,t)}else{const r=this._viewRecordService.getViewRecords(e,!1);this.refreshViewRecord(e,r,t)}}}refreshViewRecord(e,t,r){t=t||this._model.viewRecordModel.find({view_uuid:e}),r=r||this.getViewFilters(e);const n={false:[],true:[]};for(const e of t){const t=this.checkIsFilterMatch(e.get("record_uuid"),r);!0===t&&!1===e.get("hidden")||!1===t&&e.get("hidden")||(t?n.false.push(e):n.true.push(e))}n.true.length>0&&this._model.viewRecordModel.update({view_uuid:e,record_uuid:n.true.map((e=>e.get("record_uuid")))},{hidden:!0}),n.false.length>0&&this._model.viewRecordModel.update({view_uuid:e,record_uuid:n.false.map((e=>e.get("record_uuid")))},{hidden:!1})}checkIsFilterMatch(e,t,r){let n=!1;return n="and"===(t.get(0).get("operator")||"and")?Wp(t,(t=>this._checkFilter(t,e,r))):zp(t,(t=>this._checkFilter(t,e,r))),n}_checkFilter(e,t,r){if((null==e.get("expected")||""===e.get("expected"))&&!jE.includes(e.get("func")))return!0;r||(r=this._cellService.getCellKeyValue(e.get("field_uuid"),t));const n=this._fieldService.getField(e.get("field_uuid"));if(!n)return!1;const i=PE[n.get("type")];let o=e.get("expected");return zE.isMultiple(n.get("type"))&&"string"==typeof o&&(o&&(o=o.split(",")),r&&(Array.isArray(r)?r=r.map((e=>e.value)):"string"==typeof r&&(r=r.split(",")))),this._matchCondition(r,i,e.get("func"),o)}_matchCondition(e,t,r,n){if("text"===t||"file"===t||"select"===t){const t=null==e?"":e+"";return this._filterFuncService[r](t,n)}return"number"===t?(null==e||!isNaN(e))&&this._filterFuncService[r](""===e||null==e?"":parseFloat(e),parseFloat(n)):"timePeriod"===t?""===e||null==e?this._filterFuncService[r](""):this._filterFuncService[r](bf(e)):("checkbox"===t&&(e=e?"true":"false",n=!0===n||"true"===n?"true":"false"),"multiSelect"===t&&(e?"string"==typeof e&&(e=e.split(",")):e=[]),("multiSelect"===t||"checkbox"===t)&&this._filterFuncService[r](e,n))}create(e,t){const r=this._model.filterModel.create({uuid:t.uuid,view_uuid:e,field_uuid:t.field_uuid,func:t.func,expected:t.expected,operator:t.operator});return this.refresh(e),r}remove(e){const t=this._model.filterModel.findOne({uuid:e});if(!t)return null;const r=t.get("view_uuid");return this._model.filterModel.remove({view_uuid:r,uuid:e}),this.refresh(r),t}removeByViewId(e){const t=this._model.filterModel.findOne({view_uuid:e});if(t)return this.remove(t.get("uuid"))}update(e,t){let r=[];for(t of(r=Array.isArray(t)?t:[t],r))this._model.filterModel.update({uuid:t.uuid},{field_uuid:t.field_uuid,view_uuid:e,func:t.func,expected:t.expected,operator:t.operator});this.refresh(e)}copy(e,t){const r=this._model.filterModel.find({view_uuid:e});!r||0===r.length||this._model.filterModel.bulkCreate(Bp(r,(e=>({view_uuid:t,field_uuid:e.get("field_uuid"),operator:e.get("operator"),func:e.get("func"),expected:e.get("expected")}))))}};cO([ao(Ok)],uO.prototype,"_model",2),cO([ao(cx)],uO.prototype,"_fieldService",2),cO([ao(Wk)],uO.prototype,"_cellService",2),cO([ao(aO)],uO.prototype,"_filterFuncService",2),cO([ao(wx)],uO.prototype,"_groupService",2),cO([ao(Mx)],uO.prototype,"_viewRecordService",2),uO=cO([io()],uO);var dO=Object.defineProperty,fO=Object.getOwnPropertyDescriptor;function hO(e,t){if(0===t)return"";const r=qx(Yx(e,t),100);return-1===r.indexOf(".")?r+"%":parseFloat(r).toFixed(2)+"%"}let pO=class{count(e){return e.length}sum(e){return e.reduce(((e,t)=>Kx(e,t)),0)}average(e){const t=this.sum(e),r=Yx(t,e.length);return isNaN(r)?0:parseFloat(r).toFixed(2)}max(e){return 0===(e=e.filter((e=>""!==e))).length?"":Math.max(...e)}min(e){return 0===(e=e.filter((e=>""!==e))).length?"":Math.min(...e)}filled(e){return e.filter((e=>""!==e)).length}empty(e){return e.filter((e=>""===e)).length}unique(e){const t={};return e.forEach((e=>{""!==e&&(t[e]=!0)})),Object.keys(t).length}percentFilled(e){return hO(this.filled(e),e.length)}percentEmpty(e){return hO(this.empty(e),e.length)}percentUnique(e){return hO(this.unique(e),e.length)}earliestDate(e){let t=e[0];for(let r=1;r<e.length;r++)""!==e[r]&&(e[r]<t||""===t)&&(t=e[r]);return t}latestDate(e){let t=e[0];for(let r=1;r<e.length;r++)""!==e[r]&&e[r]>t&&(t=e[r]);return t}dateRange(e){let t=e[0],r=e[0];for(let n=1;n<e.length;n++)""!==e[n]&&e[n]>r?r=e[n]:""!==e[n]&&(e[n]<t||""===t)&&(t=e[n]);return r===t||""===t?0:bf(r).diff(bf(t),"days")}monthRange(e){let t=e[0],r=e[0];for(let n=1;n<e.length;n++)""!==e[n]&&e[n]>r?r=e[n]:""!==e[n]&&(e[n]<t||""===t)&&(t=e[n]);return r===t||""===t?0:bf(r).diff(bf(t),"months")}checked(e){return e.reduce(((e,t)=>"是"===t||"true"===t||!0===t?e+1:e),0)}unchecked(e){return e.reduce(((e,t)=>"是"!==t&&"true"!==t&&!0!==t?e+1:e),0)}percentChecked(e){return hO(this.checked(e),e.length)}percentUnchecked(e){return hO(this.unchecked(e),e.length)}};pO=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?fO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dO(t,r,o),o})([io()],pO);var gO=Object.defineProperty,mO=Object.getOwnPropertyDescriptor,vO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gO(t,r,o),o};let yO=class{getViewStats(e){const t=this._model.statModel.find({view_uuid:e});if(0!==t.length)return t}getStatValue(e,t,r=[]){const n=this._model.statModel.findOne({view_uuid:e,field_uuid:t});if(r=r.filter((e=>!!e)),n&&0!==r.length)return{stat:n,value:this._calc(n,r)}}_calc(e,t){const r=[];for(const n of t){const t=this._cellService.getCellFormattedValue(e.get("field_uuid"),n);t?r.push(t):r.push("")}return this._statFuncService[e.get("type")]?this._statFuncService[e.get("type")](r):null}upsert(e,t,r){this._model.statModel.upsert({view_uuid:e,field_uuid:t},{view_uuid:e,field_uuid:t,type:r})}remove(e,t){this._model.statModel.remove({view_uuid:e,field_uuid:t})}copy(e,t){const r=this._model.statModel.find({view_uuid:e});!r||0===r.length||this._model.statModel.bulkCreate(Bp(r,(e=>({view_uuid:t,field_uuid:e.get("field_uuid"),type:e.get("type")}))))}};vO([ao(Ok)],yO.prototype,"_model",2),vO([ao(pO)],yO.prototype,"_statFuncService",2),vO([ao(Wk)],yO.prototype,"_cellService",2),yO=vO([io()],yO);var bO=Object.defineProperty,_O=Object.getOwnPropertyDescriptor,wO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_O(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bO(t,r,o),o};let CO=class{getView(e){return this._model.viewModel.findById(e)}getViews(e){const t={};return null!=e&&e.skipType&&(t.type={$not:e.skipType}),null!=e&&e.type&&(t.type=e.type),this._model.viewModel.find(t)}setActiveView(e){let t=this._model.viewModel.findById(e);if(!t&&(t=this._model.viewModel.find()[0],!t))return;this.refresh(t.get("uuid"));const r=this._model.tableModel.find().get(0).get("uuid");return this._activeViewId=t.get("uuid"),this._model.tableModel.update({uuid:r},{active_view_uuid:t.get("uuid")})}getActiveView(){var e;let t;if(this._activeViewId)t=this._model.viewModel.findOne({uuid:this._activeViewId});else{const r=null==(e=this._model.tableModel.find().get(0))?void 0:e.get("active_view_uuid");r&&(t=this.getView(r))}return t||(t=this._model.viewModel.find().get(0)),this._activeViewId=null==t?void 0:t.get("uuid"),t}create(e){var t;const r=null==(t=this.getActiveView())?void 0:t.get("uuid"),n=this._model.viewModel.create({uuid:e.uuid,name:e.name,type:e.type}),i=n.uuid;return this._viewConfigServivce.create(i),r&&(this._viewFieldService.copy(r,i,(e=>{const t=this._fieldService.getField(e.get("field_uuid"));return n.type===LE.FORM&&zE.isSystemType(t.get("type"))})),this._viewRecordService.copy(r,i)),e.type===LE.CARD?this._createCard(i):e.type===LE.KANBAN?this._createKanban(i):e.type===LE.FORM&&this._createForm(i),this.refresh(i),this._model.viewModel.findOne({uuid:i})}_createCard(e){const t=this._viewFieldService.getViewFields(e);let r;let n=0;for(const e of t){const t=this._fieldService.getField(e.get("field_uuid"));(null==t?void 0:t.get("type"))===pE.IMAGE&&(r||(r=t.get("uuid"))),this._model.viewFieldModel.update({view_uuid:e.get("view_uuid"),field_uuid:e.get("field_uuid")},{hidden:n>=3}),n++}r&&this._model.viewConfigModel.update({view_uuid:e},{cover_field_uuid:r})}_createKanban(e){const t=this._fieldService.getFields(),r=this._getKanbanGroupField(t);r&&this._groupService.create(e,{field_uuid:r.get("uuid")})}_createForm(e){const t=this._viewFieldService.getViewFields(e);for(const e of t){const t=this._fieldService.getField(e.get("field_uuid"));zE.isSystemType(null==t?void 0:t.get("type"))?this._model.viewFieldModel.remove({view_uuid:e.get("view_uuid"),field_uuid:e.get("field_uuid")}):this._model.viewFieldModel.update({view_uuid:e.get("view_uuid"),field_uuid:e.get("field_uuid")},{required:!0})}}_getKanbanGroupField(e){const t=[pE.SELECT,pE.MENTION],r=[];for(const n of t)for(const t of e)n===(null==t?void 0:t.get("type"))&&r.push(t);for(const e of r)if((null==e?void 0:e.get("type"))===pE.SELECT&&e.get("color"))return e;if(0===r.length){const e=bE.find((e=>e.type===pE.SELECT)),t=this._fieldService.create({name:e.name,type:e.type,color:e.color,multiple:!!e.multiple,options:e.options});return this._fieldService.getField(t.uuid)}return r[0]}createByType(e,t){const r=this._model.viewModel.find({type:t});let n=BE[t].name;return r.length>0&&(n+=r.length),this.create({uuid:e,name:n,type:t})}update(e,t){if(!this.getView(e))throw new Error(`视图 ${e} 没有找到`);return this._model.viewModel.update({uuid:e},{...t})}remove(e){if(!this.getView(e))throw new Error(`view not found. id: ${e}`);return this._model.viewRecordModel.remove({view_uuid:e}),this._groupService.remove(e),this._sortService.remove(e),this._filterService.removeByViewId(e),this._model.viewModel.remove({uuid:e})}copy(e,t){if(!e||!t)return;const r=this.getView(t);if(!r)throw new Error(`view not found. id: ${t}`);const n=r.get("name")+` (${Ph("副本")})`,i=r.get("type");return this._model.viewModel.create({uuid:e,name:n,type:i}),this._viewConfigServivce.copy(t,e),this._viewFieldService.copy(t,e),this._viewRecordService.copy(t,e),this._groupService.copy(t,e),this._sortService.copy(t,e),this._filterService.copy(t,e),this._statService.copy(t,e),this._model.viewModel.findOne({uuid:e})}updateOrder(e,t){const r=this._model.viewModel.find(),n=Lp(r,(t=>t.get("uuid")===e));let i=Lp(r,(e=>e.get("uuid")===t));n<i&&(i=Math.min(i,r.length-1));const o=r.get(i);let a={};o&&(a={uuid:o.get("uuid")}),n<i?this._model.viewModel.moveAfter(a,{uuid:e}):this._model.viewModel.moveBefore(a,{uuid:e})}refresh(e){const t=this.getView(e);if((null==t?void 0:t.get("type"))===LE.FORM)return;let r=this._groupService.getViewGroup(e);(null==t?void 0:t.get("type"))===LE.KANBAN&&(null!=r&&r.group||(r=this._groupService.createDefaultKanbanViewGroup(e))),this._viewConfigServivce.refresh(e),this._viewFieldService.refresh(e);const n={};this._model.recordModel.find().forEach((e=>{n[e.get("uuid")]=!0}));let i=this._model.viewRecordModel.find({view_uuid:e});const o=[];for(const e of i)if(n[e.get("record_uuid")]){if((null==r?void 0:r.group)&&null==e.get("group_item_key")){o.push(e.get("record_uuid"));continue}delete n[e.get("record_uuid")]}else o.push(e.get("record_uuid"));o.length>0&&this._model.viewRecordModel.remove({view_uuid:e,record_uuid:o});const a=this._filterService.getViewFilters(e),s=Object.keys(n);if(s.length>0){const t=s.map((t=>({uuid:To(32),view_uuid:e,record_uuid:t})));this._model.viewRecordModel.bulkCreate(t)}i=this._model.viewRecordModel.find({view_uuid:e}),null!=r&&r.group&&this._groupService.refreshViewRecordGroupKey(e,r.group.toJSON()),a.length>0&&this._filterService.refreshViewRecord(e,i),this._sortService.isKeepSort(e)&&this._sortService.refresh(e)}};wO([ao(Ok)],CO.prototype,"_model",2),wO([ao(cx)],CO.prototype,"_fieldService",2),wO([ao(Dk)],CO.prototype,"_viewConfigServivce",2),wO([ao(Mx)],CO.prototype,"_viewRecordService",2),wO([ao(hx)],CO.prototype,"_viewFieldService",2),wO([ao(wx)],CO.prototype,"_groupService",2),wO([ao(nO)],CO.prototype,"_sortService",2),wO([ao(uO)],CO.prototype,"_filterService",2),wO([ao(yO)],CO.prototype,"_statService",2),CO=wO([io()],CO);var EO=Object.defineProperty,SO=Object.getOwnPropertyDescriptor,kO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?SO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&EO(t,r,o),o};let xO=class{setProcessor(e){this._processor=e}setContent(e){this._storage.clear(),this._processor.toModel(e,this._storage)}setRecords(e){var t;this._storage.clear([KE.table,XE.table,oS.table,hS.table,vS.table,wS.table,FS.table]),this._processor.toRecordModel(e,this._storage);const r=null==(t=this._viewService.getActiveView())?void 0:t.get("uuid");r&&this._viewService.refresh(r)}setUsers(e){this._storage.clear([QS.table]),this._processor.toUserModel(e,this._storage)}getContent(){return this._processor.toData(this._storage)}};kO([ao(zh)],xO.prototype,"_storage",2),kO([ao(CO)],xO.prototype,"_viewService",2),xO=kO([io()],xO);var OO=Object.defineProperty,IO=Object.getOwnPropertyDescriptor,RO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?IO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OO(t,r,o),o};let TO=class{getViewFieldGroups(e){return this._model.fieldGroupModel.find({view_uuid:e})||new Yh}hasFieldGroup(e){return this.getViewFieldGroups(e).length>0}getFieldGroupById(e,t){return this._model.fieldGroupModel.findOne({view_uuid:e,uuid:t})}create(e,t){return this._model.fieldGroupModel.create({view_uuid:e,name:t.name})}remove(e,t){this._model.fieldGroupModel.remove({view_uuid:e,uuid:t}),this._model.viewFieldModel.update({view_uuid:e,group_uuid:t},{group_uuid:""})}update(e,t){return this._model.fieldGroupModel.update({view_uuid:e,uuid:t.uuid},{name:t.name})}};RO([ao(Ok)],TO.prototype,"_model",2),TO=RO([io()],TO);var AO=Object.defineProperty,MO=Object.getOwnPropertyDescriptor,NO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?MO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&AO(t,r,o),o};let DO=class{getTable(){return this._model.tableModel.find().get(0)}getVersion(){return this._model.tableModel.find().get(0).get("version")}getViewList(){return this._model.viewModel.find()}createTable(){this._model.tableModel.create({version:VE})}create(){this.createTable();for(const e of bE)this._fieldService.create(e);const e=BE.GRID,t=To(32);this._viewService.create({uuid:t,name:e.name,type:e.type});for(const e of new Array(FE)){const e=To(32);this._model.recordModel.create({uuid:e}),this._model.viewRecordModel.create({view_uuid:t,record_uuid:e})}}replaceTable(e){const t=e.sheet[0],r=Object.values(t.views);this._viewService.getViews().forEach((e=>{this._viewRecordService.removeAll(e.get("uuid")),this._viewFieldServcie.removeAll(e.get("uuid")),this._model.viewConfigModel.remove({view_uuid:e.get("uuid")}),this._model.statModel.remove({view_uuid:e.get("uuid")}),this._viewService.remove(e.get("uuid"))})),r.forEach((r=>{var n;this._viewService.create({id:r.id,uuid:r.id,type:r.type,name:r.name}),r.type!==LE.FORM&&(t.columns.forEach((e=>{var t;const n={uuid:e.id,name:e.name,type:e.type,color:e.color,options:null==(t=e.options)?void 0:t.map((e=>({uuid:e.id,name:e.value,color:e.color})))},i=zE.isMultiple(e.type),o=this._fieldService.create({...n,multiple:i}),a={view_uuid:r.id,field_uuid:o.uuid};r.type===LE.FORM&&(a.required=!0),this._model.viewFieldModel.create(a)})),null==(n=e.records)||n.forEach((e=>{const t=JSON.parse(e.data),n=e.id||e.uuid;t.uuid=n,this._viewRecordService.createRecord(r.id,n,t)})))})),this._viewService.setActiveView(t.activeView)}};NO([ao(Ok)],DO.prototype,"_model",2),NO([ao(cx)],DO.prototype,"_fieldService",2),NO([ao(CO)],DO.prototype,"_viewService",2),NO([ao(Mx)],DO.prototype,"_viewRecordService",2),NO([ao(hx)],DO.prototype,"_viewFieldServcie",2),DO=NO([io()],DO);var PO=Object.defineProperty,jO=Object.getOwnPropertyDescriptor,FO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&PO(t,r,o),o};let VO=class{getViewShare(e){return this._model.viewShareModel.findOne({view_uuid:e})}upsertViewShare(e,t){this._model.viewShareModel.upsert({view_uuid:e},{view_uuid:e,src:null==t?void 0:t.src,status:null==t?void 0:t.status})}};FO([ao(Ok)],VO.prototype,"_model",2),VO=FO([io()],VO);var LO=Object.defineProperty,$O=Object.getOwnPropertyDescriptor,BO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$O(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LO(t,r,o),o};let UO=class{init(e={}){const{processor:t}=e;this._modelInitial.init({models:[YS,dk,nk,sk,gk,bk,Ek,QS,WS,BS,FS,RS,NS,kS,tS,cS,wS,vS,hS,oS,XE,KE]}),t&&this._contentService.setProcessor(t)}start(){}initData(e){this._contentService.setContent(e);const t=this._contextService.currentUser;t&&this._modelService.getModel("user").upsert({uid:t.uid},{uid:String(t.uid),work_id:t.work_id,name:t.name,login:t.login,icon:t.icon})}initRecords(e){this._contentService.setRecords(e)}initUsers(e){this._contentService.setUsers(e)}};BO([ao($h)],UO.prototype,"_modelInitial",2),BO([ao(_w)],UO.prototype,"_modelService",2),BO([ao(xO)],UO.prototype,"_contentService",2),BO([ao(Tk)],UO.prototype,"_contextService",2),UO=BO([io()],UO);const zO=null;var HO=Object.defineProperty,WO=Object.getOwnPropertyDescriptor,GO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?WO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&HO(t,r,o),o};let KO=class{get currentUser(){return this._contextService.currentUser}get maxRecordCount(){return this._configuration.getValue("record.maxCount")}getTable(){return this._tableService.getTable()}getContent(){return this._contentService.getContent()}isEmptyTable(){var e,t,r;const n=this.getAllFields();if(3!==n.length||n.get(0).get("type")!==bE[0].type||n.get(1).get("type")!==bE[1].type||n.get(2).get("type")!==bE[2].type||this.getViews().length>1)return!1;const i=this.getFieldOptions(n.get(1).get("uuid"));if(3!==i.length||i.get(0).get("name")!==(null==(e=bE[1].options)?void 0:e[0].name)||i.get(1).get("name")!==(null==(t=bE[1].options)?void 0:t[1].name)||i.get(2).get("name")!==(null==(r=bE[1].options)?void 0:r[2].name))return!1;const o=this.getRecords();for(const e of o)for(const t of n)if(""!==this.getCellFormattedValue(t.get("uuid"),e.get("uuid")))return!1;return!0}getActiveView(){return this._viewService.getActiveView()}getView(e){return e=e||this.getActiveViewId(),this._viewService.getView(e)}getViews(e){return this._viewService.getViews(e)}getViewConfig(e){return e=e||this.getActiveViewId(),this._viewConfigService.getViewConfig(e)}getViewFilters(e){return e=e||this.getActiveViewId(),this._filterService.getViewFilters(e)}getViewGroup(e){return e=e||this.getActiveViewId(),this._groupService.getViewGroup(e)}getViewFieldGroups(e){return e=e||this.getActiveViewId(),this._fieldGroupService.getViewFieldGroups(e)}getViewSort(e){return e=e||this.getActiveViewId(),this._sortService.getViewSort(e)}getViewStats(e){return this._statService.getViewStats(e)}getViewShare(e){return this._viewShareService.getViewShare(e)}getStatValue(e,t,r){return this._statService.getStatValue(e,t,r)}getCell(e,t){return this._cellService.getCell(e,t)}getFieldCells(e){return this._cellService.getFieldCells(e)}getViewRecordCells(e,t){return null==t&&(t=e,e=this.getActiveViewId()),this._cellService.getViewRecordCells(e,t)}getRecordCells(e){return this._cellService.getRecordCells(e)}getOriginRecord(e){return this._recordService.getRecordById(e)}getViewRecordByRecordId(e){const t=this._viewService.getActiveView().get("uuid");return this._viewRecordService.getViewRecordByRecordId(t,e)}getRecordDesc(e){return this._recordService.getRecordDesc(e)}getViewRecordsDetail(e,t){return this._viewRecordService.getViewRecordsDetail(e,t)}getRecordByIndex(e){return this.getFlatViewRecords().get(e)}getFieldByIndex(e){const t=this.getViewFields().get(e);return t?this._fieldService.getField(t.get("field_uuid")):null}getCellByIndexes(e,t){const r=this.getFieldByIndex(t),n=this.getRecordByIndex(e);return r&&n?this.getCell(null==r?void 0:r.get("uuid"),n.get("record_uuid")):null}getVisibleRecordIdsInActiveView(){const e=this.getActiveViewId();return this._viewRecordService.getVisibleRecordIds(e)}getPrimaryCellInRecord(e){if(this._recordService.getRecordById(e)){const t=this.getViewFields(),r=Fp(t,(e=>{const t=this._fieldService.getField(e.get("field_uuid"));return(null==t?void 0:t.get("type"))===pE.TITLE}))||(null==t?void 0:t.get(0)),n=null==r?void 0:r.get("field_uuid");return n?{formattedValue:this._cellService.getCellFormattedValue(n,e),recordId:e,fieldId:n}:null}return null}getAllFields(){return this._fieldService.getFields()}getRecords(){return this._recordService.getRecords()}getViewRecords(e){return e=e||this.getActiveViewId(),this._viewRecordService.getViewRecords(e)}getGroupViewRecords(e){return e=e||this.getActiveViewId(),this._viewRecordService.getGroupViewRecords(e)}getOriginViewRecords(e){return e=e||this.getActiveViewId(),this._viewRecordService.getOriginViewRecords(e)}getFlatViewRecords(e){return e=e||this.getActiveViewId(),this.isGroup(e)?this._viewRecordService.getGroupFlatViewRecords(e):this._viewRecordService.getFlatViewRecords(e)}getViewRecordsCount(e){return e=e||this.getActiveViewId(),this._viewRecordService.getViewRecordsCount(e)}getFieldOptionCells(e,t){const r=this.getField(t.field_uuid);let n=[];if((null==r?void 0:r.get("type"))===pE.MENTION){const r=this.getUsers(t.uuid.split(",").map((e=>String(e))));n=(this.getFieldRecords(e,t.field_uuid,this.keyValue({fieldId:t.field_uuid,value:[...r]}))||[]).map((e=>e.cells)).reduce(((e,t)=>e.concat(t)),[])}else n=(this.getFieldRecords(e,t.field_uuid,t.uuid)||[]).map((e=>e.cells)).reduce(((e,t)=>e.concat(t)),[]);return n}getFieldRecords(e,t,r){return this._viewRecordService.getFieldRecords(e,t,r)}getField(e){return this._fieldService.getField(e)}getFieldOption(e){return this._fieldService.getFieldOption(e)}getFieldOptions(e){return this._fieldService.getFieldOptions(e)}getViewField(e,t){return this._viewFieldService.getViewField(e,t)}isGroup(e){return e=e||this.getActiveViewId(),this._groupService.isGroup(e)}getViewFields(e,t){return e=e||this.getActiveViewId(),this._viewFieldService.getViewFields(e,t)}getViewFieldsCount(e){return e=e||this.getActiveViewId(),this._viewFieldService.getViewFieldsCount(e)}getAllViewFields(e){return e=e||this.getActiveViewId(),this._viewFieldService.getViewFields(e,!1)}getCellFormattedValue(e,t){return this._cellService.getCellFormattedValue(e,t)||""}getActiveViewId(){return this._viewService.getActiveView().get("uuid")}getActiveViewType(){return this._viewService.getActiveView().get("type")}getUser(e){return this._model.userModel.findOne({uid:e})}getUsers(e){return this._model.userModel.find({uid:e})}getValueField(e){return this._fieldRegistry.getValueField(e)}keyValue(e){return this._cellService.keyValue(e)}};GO([ao(DO)],KO.prototype,"_tableService",2),GO([ao(cx)],KO.prototype,"_fieldService",2),GO([ao(vx)],KO.prototype,"_recordService",2),GO([ao(CO)],KO.prototype,"_viewService",2),GO([ao(Dk)],KO.prototype,"_viewConfigService",2),GO([ao(hx)],KO.prototype,"_viewFieldService",2),GO([ao(Mx)],KO.prototype,"_viewRecordService",2),GO([ao(VO)],KO.prototype,"_viewShareService",2),GO([ao(yO)],KO.prototype,"_statService",2),GO([ao(wx)],KO.prototype,"_groupService",2),GO([ao(TO)],KO.prototype,"_fieldGroupService",2),GO([ao(nO)],KO.prototype,"_sortService",2),GO([ao(uO)],KO.prototype,"_filterService",2),GO([ao(Wk)],KO.prototype,"_cellService",2),GO([ao(Fk)],KO.prototype,"_fieldRegistry",2),GO([ao(lp)],KO.prototype,"_configuration",2),GO([ao(Tk)],KO.prototype,"_contextService",2),GO([ao(xO)],KO.prototype,"_contentService",2),GO([ao(Ok)],KO.prototype,"_model",2),KO=GO([io()],KO);var qO=Object.defineProperty,YO=Object.getOwnPropertyDescriptor,JO=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?YO(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qO(t,r,o),o},XO=(e=>(e.GROUP="group",e.SORT="sort",e.FILTER="filter",e))(XO||{});let ZO=class extends fp{constructor(){super(...arguments),this._onBeforeRefresh=this._register(new _p),this.onBeforeRefresh=this._onBeforeRefresh.event,this._onAfterRefresh=this._register(new _p),this.onAfterRefresh=this._onAfterRefresh.event}isNeedRefreshGroup(e,t){var r;const n=this._groupService.getViewGroup(e);if(null==n||!n.group)return!1;let i=[];return i="string"==typeof t?[t]:t,i.includes(null==(r=n.group)?void 0:r.get("field_uuid"))}isNeedRefreshSort(e,t){const r=this._sortService.getViewSort(e);let n=[];return n="string"==typeof t?[t]:t,this._sortService.isKeepSort(e)&&!!r&&n.includes(r.get("field_uuid"))}isNeedRefreshFilter(e,t,r,n){const i=Bp(this._model.filterModel.find({view_uuid:e}),(e=>e.get("field_uuid")));let o=[],a=!1;o="string"==typeof t?[t]:t;for(const t of i)if(o.includes(t)){const t=this._filterService.getViewFilters(e);a=!this._filterService.checkIsFilterMatch(r,t,n);break}return a}getRefreshType(e,t,r,n){return this.isNeedRefreshGroup(e,t)?"group":this.isNeedRefreshSort(e,t)?"sort":r&&this.isNeedRefreshFilter(e,t,r,n)?"filter":""}emitBeforeRefresh(e,t,r,n){this._onBeforeRefresh.emit({type:e,commandName:t,params:r,action:n})}emitAfterRefresh(e){this._onAfterRefresh.emit({type:e})}destroy(){super.destroy()}};JO([ao(wx)],ZO.prototype,"_groupService",2),JO([ao(nO)],ZO.prototype,"_sortService",2),JO([ao(uO)],ZO.prototype,"_filterService",2),JO([ao(Ok)],ZO.prototype,"_model",2),JO([Ii()],ZO.prototype,"destroy",1),ZO=JO([io()],ZO);const QO=null;var eI=Object.defineProperty,tI=Object.getOwnPropertyDescriptor,rI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eI(t,r,o),o};let nI=class{setActiveView(e){return this._viewService.setActiveView(e)}createView(e){return this._viewService.create(e)}createViewByType(e,t){return this._viewService.createByType(e,t)}updateView(e,t){return this._viewService.update(e,t)}removeView(e){return this._viewService.remove(e)}copyView(e,t){return this._viewService.copy(e,t)}updateViewConfig(e,t){return this._viewConfigService.update(e,t)}updateViewOrder(e,t){this._viewService.updateOrder(e,t)}updateRecordOrder(e,t,r,n,i){this._viewRecordService.updateOrder(e,t,r,n,i),this._sortService.isKeepSort(e)&&this._sortService.refresh(e)}updateRecord(e,t){this._recordService.update(e,t)}updateFieldOrder(e,t,r){this._viewFieldService.updateOrder(e,t,r)}updateFieldOptionOrder(e,t,r){this._fieldService.updateFieldOptionOrder(e,t,r)}createFieldOption(e,t,r){return this._fieldService.createFieldOption(e,t,r)}updateFieldOption(e,t){if(t.users){const r=this._readService.getFieldOption(e);if(0===t.users.length)return void this.removeFieldOption(e);const n=this._viewService.getActiveView();if(!n)return;const i=this._readService.getFieldOptionCells(n.get("uuid"),null==r?void 0:r.toJSON()),o=null==i?void 0:i.map((e=>({recordId:e.recordId,fieldId:e.fieldId,value:t.users||[],fieldType:e.fieldType,uuid:e.uuid}))),a=this._cellService.keyValue({fieldId:t.field_uuid,value:[...t.users]});return this.updateMentionFieldOptionId(e,a),void this.bulkSetCell(o)}this._fieldService.updateFieldOption(e,t)}updateMentionFieldOptionId(e,t){this._fieldService.updateMentionFieldOptionId(e,t)}createSort(e,t,r){return this._sortService.create(e,t,r)}removeSort(e){return this._sortService.remove(e)}updateSort(e,t,r){return this._sortService.update(e,t,r)}createGroup(e,t){this._groupService.create(e,t)}removeGroup(e){this._groupService.remove(e)}updateGroup(e,t){return this._groupService.update(e,t)}createFilter(e,t){return this._filterService.create(e,t)}removeFilter(e){return this._filterService.remove(e)}updateFilter(e,t){this._filterService.update(e,t)}createField({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i}){const o=this._viewFieldService.create({viewId:e,field:t,viewField:r,sourceFieldId:n,direction:i});return this.refreshView(),o}changeFieldType(e,t,r,n){if(n=n||this._readService.getFieldCells(e),this._fieldService.changeFieldType(e,t,r,n),r!==pE.SELECT||r!==pE.MENTION){const t=this._readService.getViews(),r=Fp(this._readService.getAllFields(),(e=>e.get("type")===pE.SELECT||e.get("type")===pE.MENTION));t.forEach((t=>{const n=this._readService.getViewGroup(t.get("uuid"));(null==n?void 0:n.group)&&(null==n?void 0:n.group.get("field_uuid"))===e&&t.get("type")===LE.KANBAN&&(r?this.updateGroup(t.get("uuid"),{field_uuid:r.get("uuid"),type:NE.ASC}):this.removeGroup(t.get("uuid")))}))}}removeField(e){const t=this._viewService.getActiveView(),r=t&&this._readService.getAllViewFields(t.get("uuid"));if(!r)return;const n=Lp(r,(t=>t.get("field_uuid")===e));if(!r||-1===n)return;const i=this._readService.getViewFilters(t.get("uuid")),o=this._readService.getViewSort(t.get("uuid"));for(const t of i){t.get("field_uuid")===e&&this.removeFilter(t.get("uuid"));break}(null==o?void 0:o.get("field_uuid"))===e&&this.removeSort(t.get("uuid"));const a=this._readService.getFieldCells(e);this.removeCells(a);const s=this._viewFieldService.remove(e,t.get("uuid"));return this._viewService.refresh(t.get("uuid")),s}removeFieldOption(e){const t=this._readService.getFieldOption(e),r=this._readService.getActiveView();if(!r)return;const n=this._readService.getFieldOptionCells(r.get("uuid"),null==t?void 0:t.toJSON()),i=null==n?void 0:n.map((e=>({recordId:e.recordId,fieldId:e.fieldId,value:null,fieldType:e.fieldType,uuid:e.uuid})));this.bulkSetCell(i),this._fieldService.removeFieldOption(e)}createRecord(e,t,r){return this._viewRecordService.createRecord(e,t,r)}createEmptyRecord(e){var t,r;const{viewId:n,uuid:i,viewRecord:o,direction:a="after",groupItemKey:s,modifierId:l}=e;let{sourceRecordId:c,groupOption:u}=e;const d=this._viewService.getActiveView();if(!d)return[];if(!c){const e=this._readService.getOriginViewRecords();c=null==(t=e.get(e.length-1))?void 0:t.get("record_uuid")}if(s){const e=this._viewRecordService.getGroupViewRecords(d.get("uuid"));for(const t of e){const e=t.option;if(null!=(r=null==e?void 0:e.value)&&r.toJSON&&(e.value=e.value.toJSON()),this._cellService.keyValue(e)===s){u=e;break}}}return this._viewRecordService.createEmpty({uuid:i,viewId:n,viewRecord:o,sourceRecordId:c,direction:a,groupOption:u,modifierId:l})}createRecords(e,t){return this._viewRecordService.createRecords(e,t)}copyRecord({viewId:e,uuid:t,sourceRecordId:r,modifierId:n}){return this._viewRecordService.copyRecord({viewId:e,uuid:t,sourceRecordId:r,modifierId:n})}removeRecord(e){Array.isArray(e)||(e=[e]);const t=this._viewService.getActiveView();if(t)for(const r of e){const e=this._readService.getOriginRecord(r),n=Lp(this._readService.getOriginViewRecords(),(e=>e.get("record_uuid")===r));if(!e||n<0)continue;const i=this._readService.getViewRecordCells(r);this.removeCells(i.toJSON()),this._viewRecordService.remove(t.get("uuid"),r)}}removeCells(e){const t=e.map((e=>({...e,value:""}))),r=Id(t,"fieldId"),n=Object.values(r);for(const e of Object.values(n))this.bulkSetCell(e)}removeAllRecords(e){return this._viewRecordService.removeAll(e)}upsertStat(e,t,r){this._statService.upsert(e,t,r)}removeStat(e,t){this._statService.remove(e,t)}setCell(e){var t;const r=this._viewService.getActiveView(),n=this._groupService.getViewGroup(r.get("uuid"));null!=(t=this._cellEditService)&&t.provider&&!this._cellEditService.setCell({cells:[e]})||(this._cellService.setCell(e.fieldId,e.recordId,e),this._refreshEventService.isNeedRefreshSort(r.get("uuid"),e.fieldId)&&this._sortService.refresh(r.get("uuid")),this._refreshEventService.isNeedRefreshGroup(r.get("uuid"),e.fieldId)&&this._groupService.refreshViewRecordGroupKey(r.get("uuid"),null==n?void 0:n.group.toJSON()),this._refreshEventService.isNeedRefreshFilter(r.get("uuid"),e.fieldId,e.recordId,e.value)&&this._filterService.refresh(r.get("uuid")))}bulkSetCell(e){var t;const r=this._viewService.getActiveView(),n=this._groupService.getViewGroup(r.get("uuid")),i=e.map((e=>e.fieldId));null!=(t=this._cellEditService)&&t.provider&&!this._cellEditService.setCell({cells:e})||(this._cellService.bulkSetCell(e),this._refreshEventService.isNeedRefreshSort(r.get("uuid"),i)&&this._sortService.refresh(r.get("uuid")),this._refreshEventService.isNeedRefreshGroup(r.get("uuid"),i)&&this._groupService.refreshViewRecordGroupKey(r.get("uuid"),null==n?void 0:n.group.toJSON()))}safeSetCell(e,t,r,n,i){this._valueProcessService.changeCellType(e,t,r,n,i)}updateValueOrder(e){this._cellService.updateOrder(e)}updateFieldSize(e,t,r){this._viewFieldService.update(e,t,"size",r)}updateFieldName(e,t){this._fieldService.update({uuid:e,name:t})}updateFieldHidden(e,t,r){this._viewFieldService.update(e,t,"hidden",r)}updateFieldProperty(e){var t;const{uuid:r,color:n,options:i}=e;Lo(n)||this._fieldService.update({uuid:r,color:n});const o=this._viewService.getActiveView(),a=this._groupService.getViewGroup(o.get("uuid")),s=Bp(this._fieldService.getFieldOptions(r),(e=>e.get("uuid"))),l=(i||[]).map((e=>e.uuid)),c=Sd(s,l);this._fieldService.updateFieldOptions(r,i,c),(null==(t=null==a?void 0:a.group)?void 0:t.get("field_uuid"))===r&&c.length>0&&this._groupService.refreshViewRecordGroupKey(o.get("uuid"),null==a?void 0:a.group.toJSON())}refreshView(e){var t;!e&&!(e=null==(t=this._viewService.getActiveView())?void 0:t.get("uuid"))||this._viewService.refresh(e)}upsertViewShare(e,t){this._viewShareService.upsertViewShare(e,t)}removeViewField(e,t){this._viewFieldService.remove(t,e,!0),this.refreshView()}insertViewField(e,t){this._viewFieldService.insert(t,e),this.refreshView()}updateViewField(e,t,r){Object.keys(r).forEach((n=>{this._viewFieldService.update(e,t,n,r[n])})),this.refreshView()}cloneViewField(e,t,r){this._viewFieldService.clone(e,t,r),this.refreshView()}createFieldGroup(e,t){return this._fieldGroupService.create(e,{name:t})}removeFieldGroup(e,t){this._fieldGroupService.remove(e,t)}changeFieldGroupName(e,t){this._fieldGroupService.update(e,t)}importTable(e){this._tableService.replaceTable(e)}};rI([ao(KO)],nI.prototype,"_readService",2),rI([ao(DO)],nI.prototype,"_tableService",2),rI([ao(cx)],nI.prototype,"_fieldService",2),rI([ao(vx)],nI.prototype,"_recordService",2),rI([ao(CO)],nI.prototype,"_viewService",2),rI([ao(Dk)],nI.prototype,"_viewConfigService",2),rI([ao(Mx)],nI.prototype,"_viewRecordService",2),rI([ao(yO)],nI.prototype,"_statService",2),rI([ao(wx)],nI.prototype,"_groupService",2),rI([ao(TO)],nI.prototype,"_fieldGroupService",2),rI([ao(nO)],nI.prototype,"_sortService",2),rI([ao(uO)],nI.prototype,"_filterService",2),rI([ao(Wk)],nI.prototype,"_cellService",2),rI([ao(hx)],nI.prototype,"_viewFieldService",2),rI([ao(ox)],nI.prototype,"_valueProcessService",2),rI([ao(VO)],nI.prototype,"_viewShareService",2),rI([ao(ZO)],nI.prototype,"_refreshEventService",2),rI([ao(ex)],nI.prototype,"_cellEditService",2),nI=rI([io()],nI);const iI=xo().register(Ok).register(UO).register(DO).register(Bk).register(ZO).register(CO).register(Wk).register(ox).register(cx).register(Fk).register(vx).register(Dk).register(Mx).register(hx).register(VO).register(yO).register(wx).register(Ix).register(Sx).register(TO).register(nO).register(Qx).register(uO).register(aO).register(pO).register(xO).register(Tk).register(KO).register(nI);var oI=Object.defineProperty,aI=Object.getOwnPropertyDescriptor,sI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oI(t,r,o),o};let lI=class{get rules(){return[]}getModelCell(e,t){return this._model.cellModel.findOne({field_uuid:e,record_uuid:t})}updateModelCell(e,t,r,n,i){const o=this._model.fieldModel.findOne({uuid:e});!e||!t||this._model.cellModel.upsert({field_uuid:e,record_uuid:t},{field_uuid:e,record_uuid:t,format_value:r,field_type:null==o?void 0:o.get("type"),verify:n,verify_message:i})}getVerify(e){if(!e)return{};if(!this.rules||0===this.rules.length)return{};const t=this.rules.reduce(((t,r)=>{var n;return t+(null!=(n=r.validator)&&n.call(r,"",e)?"":r.errorMsg)}),"");return t?{verify:!1,errorMessage:t}:{verify:!0}}bulkSetCell(e){}};sI([ao(Ok)],lI.prototype,"_model",2),lI=sI([no()],lI);const cI=$i.defineToken("LoggerToken"),uI=null;var dI=Object.defineProperty,fI=Object.getOwnPropertyDescriptor,hI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?fI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dI(t,r,o),o};let pI=class{constructor(){this._logs=[]}_init(){this.configuration.registerConfiguration({id:"logger",type:"object",title:"日志",properties:{maxLen:{type:"number",description:"最大日志长度"}}}),this.configuration.registerDefaultValue({"logger.maxLen":1e3})}log(e){const t=this.configuration.getValue("logger.maxLen");this._logs.length>=t&&this._logs.shift(),this._logs.push(e)}getLogs(){return this._logs}};hI([ao(lp)],pI.prototype,"configuration",2),hI([Oi()],pI.prototype,"_init",1),pI=hI([io({token:cI})],pI);const gI=xo().register(pI);var mI=(e=>(e.PENDING="pending",e.RUNNING="running",e.SUCCESS="success",e.ERROR="error",e.ABORTED="aborted",e.TIMEOUT="timeout",e.WAITING="waiting",e))(mI||{});const vI=null;class yI extends fp{constructor(e={}){super(),this._retryCount=0,this._isRuning=!1,this._isStop=!1,this._onDidStatusChange=this._register(new _p),this.onDidStatusChange=this._onDidStatusChange.event,this.name=e.name,this._interval=e.interval||1e3,this._maxRetries=e.maxRetries||3}destroy(){super.destroy(),this._job=null,this._retryCount=null,this._isRuning=null,this._lastRunAt=null,this._isStop=null,clearTimeout(this._timer),this._timer=null}addJob(e){this._job=e}hasRuningJob(){return!this._isStop}async run(){if(this._isStop||!this._job||this._retryCount>=this._maxRetries||this._isRuning)return;const e=+new Date;if(!(this._lastRunAt&&e-this._lastRunAt<this._interval)){this._isRuning=!0,this._onDidStatusChange.emit(mI.RUNNING);try{await this._job()}catch(e){return console.error(e),this._retryCount++,void await this.run()}this._isRuning=!1,this._retryCount=0,this._lastRunAt=+new Date}}start(){this.run().then((()=>{this._timer=setTimeout((async()=>{this.start()}),this._interval)}))}stop(){this._isStop=!0,clearTimeout(this._timer),this._onDidStatusChange.emit(mI.ABORTED)}resume(){this._isStop=!1,this.start()}}class bI extends fp{constructor(e={}){super(),this._jobs=[],this._penddingJobs=[],this._runingJobs=[],this._successJobs=[],this._errorJobs=[],this._isRuning=!1,this._isStop=!1,this._onDidStatusChange=this._register(new _p),this.onDidStatusChange=this._onDidStatusChange.event,this.stop=()=>{this._isStop=!0,this._onDidStatusChange.emit({status:mI.ABORTED})},this.resume=()=>{!this._isStop||(this._isStop=!1,this.start())},this.name=e.name,this._parallel=e.parallel||5}destroy(){super.destroy(),this._jobs=[],this._penddingJobs=[],this._runingJobs=[],this._successJobs=[],this._errorJobs=[],this._isRuning=!1,this._isStop=!1}getJob(e){return this._jobs.find((t=>t.id===e))}getSuccessJobs(){return this._successJobs.map((e=>this._jobs.find((t=>t.id===e)))).filter((e=>!!e))}getRunningJobs(){return this._runingJobs.map((e=>this._jobs.find((t=>t.id===e)))).filter((e=>!!e))}hasRuningJob(){return!this._isStop&&!!this._runingJobs.length}hasPenddingJob(){return!!this._penddingJobs.length}runJob(e){const t=this._jobs.find((t=>t.id===e));if(!t||this._runingJobs.find((t=>t===e))||this._successJobs.find((t=>t===e)))return;this._errorJobs.find((t=>t===e))&&Jd(this._errorJobs,(t=>t===e)),Jd(this._penddingJobs,(t=>t===e)),this._runingJobs.push(e),t.runAt=new Date;const r=()=>{t.endAt=new Date,t.spend=Number(t.endAt)-Number(t.runAt),t.runCount=t.runCount?t.runCount+1:1,Jd(this._runingJobs,(t=>t===e)),this._run()};try{t.handler({jobId:e,onSuccess:()=>{t.status=mI.SUCCESS,this._onDidStatusChange.emit({status:mI.SUCCESS,jobId:t.id}),this._successJobs.push(t.id),r()},onError:()=>{t.status=mI.ERROR,this._errorJobs.push(t.id),r()},onProcess:e=>{t.percent=e,this._onDidStatusChange.emit({status:mI.RUNNING,jobId:t.id,percent:e})}})}catch(e){console.error(e)}}_run(){if(this._isStop)return;const e=this._runingJobs.length;if(e<this._parallel){const t=Zd(this._penddingJobs,0,this._parallel-e);if(0===t.length)return this._isRuning=!1,void this._onDidStatusChange.emit({status:mI.WAITING});for(const e of t)this._isRuning=!0,this.runJob(e)}else 0===e&&(this._isRuning=!1,this._onDidStatusChange.emit({status:mI.WAITING}))}start(){this._onDidStatusChange.emit({status:mI.PENDING}),this._run()}addJob(e,t){1===arguments.length?(t=e,e=To(16)):"string"==typeof e&&(Jd(this._jobs,(t=>t===e)),Jd(this._penddingJobs,(t=>t===e)));const r={id:e,status:mI.PENDING,handler:t};return this._jobs.push(r),this._penddingJobs.push(r.id),!this._isRuning&&!this._isStop&&this.start(),r}removeSuccessJob(e){Jd(this._successJobs,(t=>t===e))}}var _I=Object.defineProperty,wI=Object.getOwnPropertyDescriptor,CI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_I(t,r,o),o};let EI=class{constructor(){this._queueTasks=[]}init(){pa.onBeforeUnLoad((e=>{for(const t of this._queueTasks)if(t.hasRuningJob())return e.preventDefault(),e.returnValue="",Ph(`还有 ${t.name} 正在运行中，确认要离开页面吗.`)}))}createRepeatTask(e){return new yI(e)}createQueueTask(e){const t=new bI(e);return this._queueTasks.push(t),t}};CI([Oi()],EI.prototype,"init",1),EI=CI([io()],EI);const SI=xo().register(EI),kI=$i.defineToken("UserContribution");var xI=Object.defineProperty,OI=Object.getOwnPropertyDescriptor,II=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?OI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xI(t,r,o),o};let RI=class{getProvider(){const e=this.userProvider.getContributions(),t=e[e.length-1];return null==t?void 0:t.registerUser()}};II([wh(kI)],RI.prototype,"userProvider",2),RI=II([io()],RI);var TI=Object.defineProperty,AI=Object.getOwnPropertyDescriptor,MI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?AI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&TI(t,r,o),o};let NI=class{get provider(){return this._userRegistry.getProvider()}async searchUser(e){var t;return await(null==(t=this.provider)?void 0:t.searchUser(e))||[]}async contextUsers(){var e;return await(null==(e=this.provider)?void 0:e.contextUsers())||[]}getCurrentUser(){var e;return null==(e=this.provider)?void 0:e.getCurrentUser()}};MI([ao(RI)],NI.prototype,"_userRegistry",2),NI=MI([io()],NI);const DI=xo().contribution(kI).register(RI).register(NI);class PI{constructor(e,t,r,n,i){this.kernel=e,this.plugin=t,this.readService=r,this.writeService=n,this.modelService=i}init(){}destroy(){}}const jI=$i.defineToken("CommandRegistry"),FI=null,VI=$i.defineToken("CommandExecutor"),LI=null;var $I=Object.defineProperty,BI=Object.getOwnPropertyDescriptor,UI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?BI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$I(t,r,o),o};let zI=class extends fp{constructor(){super(...arguments),this._onDidUndoCommand=this._register(new _p),this.onDidUndoCommand=this._onDidUndoCommand.event,this._onDidRedoCommand=this._register(new _p),this.onDidRedoCommand=this._onDidRedoCommand.event}get onWillExecuteCommand(){return this._commandExecutor.onWillExecuteCommand}get onDidExecuteCommand(){return this._commandExecutor.onDidExecuteCommand}get onCancelExecuteCommand(){return this._commandExecutor.onCancelExecuteCommand}get onFinishExecuteCommand(){return this._commandExecutor.onFinishExecuteCommand}destroy(){this._commandRegistry.destroy(),this._commandExecutor.destroy()}seal(){this._commandRegistry.seal()}registerCommand(e,t,r){this._commandRegistry.register(e,t,r)}registerCommandHook(e,t){this._commandRegistry.registerCommandHook(e,t)}getCommand(e,t=!1,r=!1){return this._commandRegistry.getByName(e,t,r)}getCommandHook(e){return this._commandRegistry.getCommandHooks(e)}execCommand(e,t,r){var n;const i=this.getCommand(e,r);if(!i)return null;i.beforeExecute&&(t=i.beforeExecute.call(i,t));const o=this._commandRegistry.getCommandHooks(e);if(o.length>0)for(const e of o)e.beforeExecute&&(t=e.beforeExecute(t,this._readService));let a;if(this._stackService.transact((()=>{a=null==i?void 0:i.execute.call(i,t)})),o.length>0)for(const e of o)e.afterExecute&&e.afterExecute(null==a?void 0:a.result,t,this._readService);return i.afterExecute?t=i.afterExecute.call(i,t,null==a?void 0:a.result,this._refreshEventService):(null==(n=i.context)||n.destroy(),i.context=null),this._logger.log({type:"command",action:e,data:t}),a}execRemoteCommand(e,t,r,n){const i=this.getCommand(e,n,!0);return i?(r&&(r.modifierId=null==t?void 0:t.uid),this._contentService.setUsers([t]),null==i?void 0:i.execute.call(i,r)):null}execDeferCommand(e,t,r){var n;if(!this.getCommand(e))return null;null==(n=this._refreshEventService)||n.emitBeforeRefresh(r,e,t,(()=>{this.execCommand(e,t)}))}undo(){var e;if(null==(e=this._stackService)||!e.canUndo())return!1;this._stackService.undo(),this._onDidUndoCommand.emit()}redo(){var e;if(null==(e=this._stackService)||!e.canRedo())return!1;this._stackService.redo(),this._onDidRedoCommand.emit()}};UI([ao(KO)],zI.prototype,"_readService",2),UI([ao(xO)],zI.prototype,"_contentService",2),UI([ao(jI)],zI.prototype,"_commandRegistry",2),UI([ao(VI)],zI.prototype,"_commandExecutor",2),UI([ao(ZO)],zI.prototype,"_refreshEventService",2),UI([ao(Sw)],zI.prototype,"_stackService",2),UI([ao(cI)],zI.prototype,"_logger",2),UI([Ii()],zI.prototype,"destroy",1),zI=UI([io()],zI);var HI=Object.defineProperty,WI=Object.getOwnPropertyDescriptor,GI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?WI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&HI(t,r,o),o};let KI=class{constructor(){this._pool={},this._commands={},this._commandHooks={},this._isSealed=!1}destroy(){Object.keys(this._commands).forEach((e=>{this._commands[e].destroy()})),this._pool={},this._commands={},this._commandHooks={},this._isSealed=!1}seal(){this._isSealed||(this._isSealed=!0,this.initCommand())}getByName(e,t,r){let n=this._commands[e];return n?(n=this.trap(e,n,t,r),n):(console.warn(`This command "${e}" is not registered`),null)}getCommandHooks(e){return this._commands[e]?this._commandHooks[e]||[]:(console.warn(`This command "${e}" is not registered`),[])}register(e,t,r){if(this._pool[e])throw new Error("The command has been registered");if(this._isSealed)throw new Error("No command can be registered at this stage");this._pool[e]={clazz:t,plugin:r}}registerCommandHook(e,t){!this._pool[e]||(this._commandHooks[e]||(this._commandHooks[e]=[]),this._commandHooks[e].push(t))}trap(e,t,r,n){const i=t._rawExec||t.execute;return t._rawExec=i,t.execute=new Proxy(t.execute,{apply:(o,a,s)=>this._commandExecutor.exec(e,t,r,n,i,a,s)}),t}initCommand(){Object.keys(this._pool).forEach((e=>{const{clazz:t,plugin:r}=this._pool[e],n=this.trap(e,new t(this._kernel,r,this._readService,this._writeService,this._modelService),!1,!1);n.init(),this._commands[e]=n}))}};GI([ao(VI)],KI.prototype,"_commandExecutor",2),GI([ao(KO)],KI.prototype,"_readService",2),GI([ao(nI)],KI.prototype,"_writeService",2),GI([ao(_w)],KI.prototype,"_modelService",2),KI=GI([io({token:jI})],KI);class qI{constructor(e,t,r){this.commandExecutor=e,this.commandName=t,this.argArray=r}destroy(){delete this._remote,delete this._user}get isRemote(){return this._remote}get user(){return this._user}setRemote(e){this._remote=e}setUser(e){this._user=e}cancel(){}}class YI{constructor(e){this.notify=e}destroy(){const e=this;delete e.notify,delete e._operations,delete e.notify}execute(e){var t,r,n,i,o,a,s,l;let c;null==(r=null==(t=this.notify)?void 0:t.beforeExecute)||r.call(t,this);try{c=e(),null==(i=null==(n=this.notify)?void 0:n.afterExecute)||i.call(n,this)}catch(e){return console.error(e),this.rollback(),null==(a=null==(o=this.notify)?void 0:o.completed)||a.call(o,this,!1),{isSuccess:!1,error:e}}return null==(l=null==(s=this.notify)?void 0:s.completed)||l.call(s,this,!0),{isSuccess:!0,result:c}}rollback(){}}var JI=Object.defineProperty,XI=Object.getOwnPropertyDescriptor,ZI=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?XI(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JI(t,r,o),o};let QI=class extends fp{constructor(){super(...arguments),this._onWillExecuteCommand=this._register(new _p),this.onWillExecuteCommand=this._onWillExecuteCommand.event,this._onDidExecuteCommand=this._register(new _p),this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._onCancelExecuteCommand=this._register(new _p),this.onCancelExecuteCommand=this._onCancelExecuteCommand.event,this._onFinishExecuteCommand=this._register(new _p),this.onFinishExecuteCommand=this._onFinishExecuteCommand.event}destroy(){}_process(e,t){const r=new YI({beforeExecute:t=>{this._onWillExecuteCommand.emit({context:e})},afterExecute:t=>{this._onDidExecuteCommand.emit({context:e})},completed:(t,r)=>{if(!r)return this._onCancelExecuteCommand.emit({changed:!0});this._onFinishExecuteCommand.emit({context:e})}}),n=r.execute(t);return r.destroy(),n}execCommand(e,t){return this._process(e,t)}exec(e,t,r,n,i,o,a){const s=new qI(this,e,a);return this.execCommand(s,(()=>(s.setRemote(n),s.setUser(this.readService.currentUser),t.context=s,i.call(o,...a))))}};ZI([ao(KO)],QI.prototype,"readService",2),ZI([ao(nI)],QI.prototype,"writeService",2),ZI([ao(_w)],QI.prototype,"modelService",2),ZI([Ii()],QI.prototype,"destroy",1),QI=ZI([io({token:VI})],QI);const eR=xo().register(QI).register(KI).register(zI),tR=$i.defineToken("KernelService"),rR=null,nR=$i.defineToken("KernelPluginContribution"),iR=null;var oR=(e=>(e.CREATE="create",e.DELETE="delete",e.READ="read",e.UPDATE="update",e.EDIT="edit",e.TRANSFORM="transform",e))(oR||{}),aR=(e=>(e.TABLE="table",e.FIELD="field",e.RECORD="record",e))(aR||{});const sR=null;var lR=Object.defineProperty,cR=Object.getOwnPropertyDescriptor,uR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lR(t,r,o),o};let dR=class{constructor(){this._abilityMap=new Map}registerConfiguration(){this._configuration.registerConfiguration({id:"ability",type:"object",title:"权限"})}getAbilities(){return Array.from(this._abilityMap.values())}getAbility(e){return this._abilityMap.get(e)}registerAbility(e){this._abilityMap.set(e.id,e)}};uR([ao(lp)],dR.prototype,"_configuration",2),uR([Oi()],dR.prototype,"registerConfiguration",1),dR=uR([io()],dR);var fR=Object.defineProperty,hR=Object.getOwnPropertyDescriptor,pR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fR(t,r,o),o};let gR=class{init(){var e;const t=this._abilityRegistry.getAbilities();for(const r of t)null==(e=r.init)||e.call(r)}};pR([ao(dR)],gR.prototype,"_abilityRegistry",2),gR=pR([io()],gR);var mR=Object.defineProperty,vR=Object.getOwnPropertyDescriptor,yR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mR(t,r,o),o};let bR=class{isReadonly(e,...t){const r=this._abilityRegistry.getAbility(aR.TABLE);if(!r.read()||r.update())return!1;const n=this._abilityRegistry.getAbility(e);return!!n&&(!!n.read(...t)&&!n.update(...t))}can(e,t,...r){var n;if(e===oR.CREATE)return this.canCreate(t,...r);if(e===oR.DELETE)return this.canDelete(t,...r);if(e===oR.READ)return this.canRead(t,...r);if(e===oR.UPDATE)return this.canUpdate(t,...r);if(!t)return!1;const i=this._abilityRegistry.getAbility(t);return!!i&&!(null==(n=i[e])||!n.call(i,...r))}canCreate(e,...t){const r=this._abilityRegistry.getAbility(aR.TABLE);if(!r.create())return!1;if(!e||e===aR.TABLE)return r.create();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.create(...t)}canDelete(e,...t){const r=this._abilityRegistry.getAbility(aR.TABLE);if(!r.delete())return!1;if(!e||e===aR.TABLE)return r.delete();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.delete(...t)}canRead(e,...t){const r=this._abilityRegistry.getAbility(aR.TABLE);if(!r.read())return!1;if(!e||e===aR.TABLE)return r.read();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.read(...t)}canUpdate(e,...t){const r=this._abilityRegistry.getAbility(aR.TABLE);if(!r.update())return!1;if(!e||e===aR.TABLE)return r.update();const n=this._abilityRegistry.getAbility(e);return!!n&&!!n.update(...t)}};yR([ao(dR)],bR.prototype,"_abilityRegistry",2),bR=yR([io()],bR);var _R=Object.defineProperty,wR=Object.getOwnPropertyDescriptor,CR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_R(t,r,o),o};let ER=class{constructor(){this.id=aR.TABLE}registerConfiguration(){this._configuration.registerConfiguration({id:"ability.table",type:"object",title:"table表权限",properties:{create:{type:"boolean",description:"新增权限，控制能否新增字段或记录"},delete:{type:"boolean",description:"删除权限，控制能否删除字段或记录"},read:{type:"boolean",description:"可读权限，控制字段或记录是否可读"},update:{type:"boolean",description:"更新权限，控制能否更新字段或记录，能否新增、删除、复制、拖拽视图，能否拖拽记录、字段"}}}),this._configuration.registerDefaultValue({"ability.table.create":!0,"ability.table.delete":!0,"ability.table.read":!0,"ability.table.update":!0})}init(){}getAbilities(){return this._configuration.getValue("ability.table")}create(){return this._configuration.getValue("ability.table.create")}delete(){return this._configuration.getValue("ability.table.delete")}read(){return this._configuration.getValue("ability.table.read")}update(){return this._configuration.getValue("ability.table.update")}};CR([ao(lp)],ER.prototype,"_configuration",2),CR([Oi()],ER.prototype,"registerConfiguration",1),ER=CR([io()],ER);var SR=Object.defineProperty,kR=Object.getOwnPropertyDescriptor,xR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SR(t,r,o),o};let OR=class{constructor(){this.id=aR.FIELD}registerConfiguration(){this._configuration.registerConfiguration({id:"ability.field",type:"object",title:"field表权限",properties:{create:{type:"boolean",description:"字段新增权限"},delete:{type:"boolean",description:"字段删除权限"},deleteAllowList:{type:"array",items:{type:"string"},description:"可删除字段列表"},read:{type:"boolean",description:"字段可读权限"},readAllowList:{type:"array",items:{type:"string"},description:"可读字段列表"},update:{type:"boolean",description:"字段更新权限，控制能否修改字段名称、新增字段选项"},updateAllowList:{type:"array",items:{type:"string"},description:"可更新字段列表"},transform:{type:"boolean",description:"字段类型转换权限"},transformAllowList:{type:"array",items:{type:"string"},description:"可类型转换字段列表"},edit:{type:"boolean",description:"字段内容编辑权限"},editAllowList:{type:"boolean",description:"可编辑字段列表"}}}),this._configuration.registerDefaultValue({"ability.field.create":!0,"ability.field.delete":!0,"ability.field.read":!0,"ability.field.update":!0,"ability.field.transform":!0,"ability.field.edit":!0,"ability.field.readAllowList":["*"],"ability.field.editAllowList":["*"],"ability.field.updateAllowList":["*"],"ability.field.deleteAllowList":["*"],"ability.field.transformAllowList":["*"]})}isAllow(e,t=["*"]){return"*"===t[0]||t.indexOf(e)>=0}init(){}create(e){return(!e||!this._fieldRegistry.getValueField(e.get("type")).createDisable)&&this._configuration.getValue("ability.field.create")}delete(e){if(this._fieldRegistry.getValueField(e.get("type")).deleteDisable)return!1;const t=this._configuration.getValue("ability.field.delete"),r=this._configuration.getValue("ability.field.deleteAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}read(e){const t=this._configuration.getValue("ability.field.read"),r=this._configuration.getValue("ability.field.readAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}update(e){const t=this._configuration.getValue("ability.field.update"),r=this._configuration.getValue("ability.field.updateAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}transform(e){const t=this._fieldRegistry.getValueField(e.get("type"));if(null!=t&&t.transformDisable)return!1;const r=this._configuration.getValue("ability.field.transform"),n=this._configuration.getValue("ability.field.transformAllowList");return!0===r?this.isAllow(e.get("uuid"),n):r}edit(e){if(this._fieldRegistry.getValueField(e.get("type")).editDisable)return!1;const t=this._configuration.getValue("ability.field.edit"),r=this._configuration.getValue("ability.field.editAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}};xR([ao(Fk)],OR.prototype,"_fieldRegistry",2),xR([ao(lp)],OR.prototype,"_configuration",2),xR([Oi()],OR.prototype,"registerConfiguration",1),OR=xR([io()],OR);var IR=Object.defineProperty,RR=Object.getOwnPropertyDescriptor,TR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?RR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&IR(t,r,o),o};let AR=class{constructor(){this.id=aR.RECORD}registerConfiguration(){this._configuration.registerConfiguration({id:"ability.record",type:"object",title:"record表权限",properties:{create:{type:"boolean",description:"记录新增权限"},delete:{type:"boolean",description:"记录删除权限"},deleteAllowList:{type:"array",items:{type:"string"},description:"可删除记录列表"},read:{type:"boolean",description:"记录可读权限"},readAllowList:{type:"array",items:{type:"string"},description:"可读记录列表"},update:{type:"boolean",description:"记录更新权限，控制能否修改记录描述"},updateAllowList:{type:"array",items:{type:"string"},description:"可更新记录列表"},edit:{type:"boolean",description:"记录内容编辑权限"},editAllowList:{type:"array",items:{type:"string"},description:"可编辑记录列表"}}}),this._configuration.registerDefaultValue({"ability.record.create":!0,"ability.record.delete":!0,"ability.record.read":!0,"ability.record.update":!0,"ability.record.edit":!0,"ability.record.readAllowList":["*"],"ability.record.editAllowList":["*"],"ability.record.updateAllowList":["*"],"ability.record.deleteAllowList":["*"]})}isAllow(e,t=["*"]){return"*"===t[0]||t.indexOf(e)>=0}init(){}create(){return this._configuration.getValue("ability.record.create")}delete(e){const t=this._configuration.getValue("ability.record.delete"),r=this._configuration.getValue("ability.record.deleteAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}read(e){const t=this._configuration.getValue("ability.record.read"),r=this._configuration.getValue("ability.record.readAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}update(e){const t=this._configuration.getValue("ability.record.update"),r=this._configuration.getValue("ability.record.updateAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}edit(e){const t=this._configuration.getValue("ability.record.edit"),r=this._configuration.getValue("ability.record.editAllowList");return!0===t?this.isAllow(e.get("uuid"),r):t}};TR([ao(lp)],AR.prototype,"_configuration",2),TR([Oi()],AR.prototype,"registerConfiguration",1),AR=TR([io()],AR);const MR=xo().register(gR).register(ER).register(OR).register(AR).register(dR).register(bR);var NR=Object.defineProperty,DR=Object.getOwnPropertyDescriptor,PR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DR(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&NR(t,r,o),o};let jR=class extends fp{constructor(){super(...arguments),this._onDataLoaded=this._register(new _p),this.onDataLoaded=this._onDataLoaded.event,this._onDataChanged=this._register(new _p),this.onDataChanged=this._onDataChanged.event,this._onCollabUsersChange=this._register(new _p),this.onCollabUsersChange=this._onCollabUsersChange.event,this._isFirstLoad=!0,this._isRecordFirstLoad=!0,this.hooks={init:new rE,destroy:new uE}}async init({container:e}){this.registerAbility(this._tableAbility),this.registerAbility(this._fieldAbility),this.registerAbility(this._recordAbility),e.get(gR).init(),this._listenEvent(),this._initPlugins(),await this.hooks.init.promise()}initCommandHooks(e){for(const t of e)this._commandService.registerCommandHook(t.commandName,t)}_initPlugins(){this.kernelPluginProvider.getContributions({cache:!1}).forEach((e=>{e.init(this)})),this._commandService.seal()}_listenEvent(){this._commandService.onDidExecuteCommand((()=>{this._onDataChanged.emit("command-execute")})),this._commandService.onDidUndoCommand((()=>{this._onDataChanged.emit("command-undo")})),this._commandService.onDidRedoCommand((()=>{this._onDataChanged.emit("command-redo")})),this._refreshEventService.onAfterRefresh((()=>{this._onDataChanged.emit("refresh-event")}))}registerField(e){this._fieldRegistry.registerField(e)}registerAbility(e){this._abilityRegistry.registerAbility(e)}setContent(e){!e||(this._lifeService.status<kh.WorkbenchInited?this._lifeService.when(kh.WorkbenchInited,(()=>{this._loadData(e)})):this._loadData(e))}_loadData(e){this._isFirstLoad&&(this._lifeService.status=kh.Starting);const t=(e="string"==typeof e?JSON.parse(e):Object.assign({},e)).records;delete e.records,this._kernelModel.initData(e),this._isFirstLoad&&(this._lifeService.status=kh.Ready,this._logger.log({type:"kernel",action:"dataReady",data:e})),this._onDataLoaded.emit("loadedData"),t&&this.setRecords(t),this._isFirstLoad=!1}setRecords(e){!e||(this._lifeService.status<kh.Ready?this._lifeService.when(kh.Ready,(()=>{this._loadRecords(e)})):this._loadRecords(e))}_loadRecords(e){this._isRecordFirstLoad?(this._lifeService.status=kh.RecordInit,this._kernelModel.initRecords(e),this._lifeService.status=kh.RecordReady,this._isRecordFirstLoad=!1,this._logger.log({type:"kernel",action:"recordReady",data:e})):this._kernelModel.initRecords(e),this._onDataLoaded.emit("loadedRecords")}setUsers(e){!e||this._kernelModel.initUsers(e)}destroy(){super.destroy(),this.kernelPluginProvider.getContributions({cache:!1}).forEach((e=>{var t;null==(t=e.destroy)||t.call(e)})),this.hooks.destroy.call()}};PR([wh(nR)],jR.prototype,"kernelPluginProvider",2),PR([ao(zI)],jR.prototype,"_commandService",2),PR([ao(UO)],jR.prototype,"_kernelModel",2),PR([ao(ZO)],jR.prototype,"_refreshEventService",2),PR([ao(xh)],jR.prototype,"_lifeService",2),PR([ao(Fk)],jR.prototype,"_fieldRegistry",2),PR([ao(dR)],jR.prototype,"_abilityRegistry",2),PR([ao(ER)],jR.prototype,"_tableAbility",2),PR([ao(OR)],jR.prototype,"_fieldAbility",2),PR([ao(AR)],jR.prototype,"_recordAbility",2),PR([ao(cI)],jR.prototype,"_logger",2),PR([Ii()],jR.prototype,"destroy",1),jR=PR([io()],jR),yh.config({lifecycle:$i.Lifecycle.singleton});class FR extends hE{constructor(e){super(),this._onFinishExecuteCommand=this._register(new _p),this.onFinishExecuteCommand=this._onFinishExecuteCommand.event,this._options=e,this.container=e.container||new yh,this._loadCoreServices(),this.registerPlugins(e.plugins,{container:this.container}),this._registerContribs(e.contribs),this.init(),this._logger.log({type:"kernel",action:"kernelInited",data:e})}get onDataLoaded(){return this.kernelService.onDataLoaded}start(){this._options.data&&this.kernelService.setContent(this._options.data)}init(){this.container.get(UO).init();const e=this.container.get(NI).getCurrentUser();e&&this.container.get(Tk).setCurrentUser(e),this.kernelService.init({container:this.container}),this._options.commandHooks&&this.kernelService.initCommandHooks(this._options.commandHooks),this.container.get(zI).onFinishExecuteCommand((e=>{this._onFinishExecuteCommand.emit(e)})),this._lifeService.status=kh.Inited}destroy(){super.destroy(),this.kernelService.destroy(),this.unregisterPlugins(this.container)}get _logger(){return this.container.get(cI)}_loadCoreServices(){this._lifeService=this.container.get(xh),this.container.get(jh),this.container.get(CO),this.kernelService=this.container.get(jR)}getContent(){return this.container.get(xO).getContent()}setContent(e){this.kernelService.setContent(e)}setRecords(e){this.kernelService.setRecords(e)}setUsers(e){this.kernelService.setUsers(e)}_registerContribs(e){if(e)for(const t of e)this.container.register(t)}}const VR=xo().contribution(nR).register(jR);var LR=Object.defineProperty,$R=Object.getOwnPropertyDescriptor,BR=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$R(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LR(t,r,o),o};let UR=class{toValue(e){const t=this._readService.getField(e.fieldId);let r=e.value||"";if(Array.isArray(r))(null==t?void 0:t.get("type"))===pE.MENTION&&(r=null==r?void 0:r.map((e=>{const t=this._readService.getUser(e.uid);return{id:(null==t?void 0:t.get("uid"))||e.uid,name:(null==t?void 0:t.get("name"))||e.name,login:(null==t?void 0:t.get("login"))||e.login,avatar_url:(null==t?void 0:t.get("icon"))||e.icon,work_id:(null==t?void 0:t.get("work_id"))||e.work_id}})));else if((null==t?void 0:t.get("type"))===pE.LINK)return null!=r&&r.src?{value:{src:(null==r?void 0:r.src)||"",name:(null==r?void 0:r.name)||""}}:{value:null};return(null==t?void 0:t.get("type"))===pE.DATE?{value:{time:r}}:{value:r}}toColumn(e){const t={id:e.get("uuid"),name:e.get("name"),type:e.get("type"),color:e.get("color")},r=this._readService.getFieldOptions(e.get("uuid"));return r&&(t.options=Bp(r,(e=>({id:e.get("uuid"),color:e.get("color"),value:e.get("name")})))),t}toRecord(e,t){var r;const n={userId:e.get("creator_id"),modifierId:e.get("modifier_id")},i=this._readService.getRecordCells(e.get("uuid"));for(const e of i)!e||t&&e.fieldId!==t||null==e.value&&null===(null==(r=e.value)?void 0:r.name)||Array.isArray(e.value)&&0===e.value.length||(n[e.fieldId]=this.toValue(e));return n}toView({view:e,sort:t,stats:r,viewGroup:n,fieldGroups:i,filters:o,groupViewRecords:a,viewConfig:s}){const l=this._readService.getAllViewFields(e.get("uuid")),c=this._readService.getOriginViewRecords(e.get("uuid")),u={id:e.get("uuid"),type:e.get("type"),name:e.get("name"),colCount:(null==l?void 0:l.length)||0,columns:Bp(l,(e=>({id:e.get("field_uuid"),size:e.get("size"),hidden:e.get("hidden")}))),data:{},filter:this.toFilter(o),sort:this.toSort(t,s),stats:this.toStats(r),...null!=n&&n.group?this.toGroup(n.group,a):{},frozenCol:0,index:0,rowCount:c.length,rows:Bp(c,(e=>({id:e.get("record_uuid")}))),rowHeight:this.toRowHeight(s),scrollX:0,scrollY:0,selections:{},tableId:"",columnGroups:this.toColumnGroup(i,l)};return e.get("type")===LE.CARD&&s&&(u.cover={show:!!s.get("cover_field_uuid"),id:s.get("cover_field_uuid"),display:s.get("cover_display")}),(e.get("type")===LE.KANBAN||e.get("type")===LE.CARD)&&(u.showField=null==s?void 0:s.get("show_field_name")),e.get("type")===LE.FORM?{id:e.get("uuid"),type:e.get("type"),name:e.get("name"),desc:e.get("desc"),fields:Vp(l,(e=>!e.get("hidden")&&(!!e.get("field")&&!zE.isSystemType(e.get("field").get("type"))))).map((e=>{const t={columnId:e.get("field_uuid"),columnName:e.get("field").get("name")||"",type:e.get("field").get("type")||pE.TEXT,title:e.get("name")||e.get("field").get("name"),display:e.get("display_type")};if(zE.isSelectLike(e.get("field").get("type"))){const r=this.toColumn(e.get("field"));t.options=r.options}return e.get("required")?t.validations=[{required:!0}]:t.validations=[{required:!1}],t})),viewId:e.get("uuid"),createdAt:e.get("created_at")}:u}toFilter(e){const t={};return e&&e.length>0&&(t.operator=e.get(0).get("operator"),t.options=Bp(e,(e=>({id:e.get("field_uuid"),func:e.get("func"),expected:e.get("expected")}))),0===t.options.length)?null:t}toSort(e,t){if(!e)return null;const r={};return null!=t&&t.get("keep_sort")&&(r.auto=!0),r.options=[{id:e.get("field_uuid"),type:e.get("type")}],r}toStats(e){const t={};return e&&e.length>0&&e.forEach((e=>{t[e.get("field_uuid")]=e.get("type")})),t}toGroup(e,t){const r={};if(!e)return r;const n={id:e.get("field_uuid"),type:e.get("type")};return r.groupData=t.map((e=>{var t,r,i,o;const a={value:(null==(t=e.option)?void 0:t.name)||"",titleValue:null!=(r=e.option)&&r.value?[null==(i=e.option)?void 0:i.value]:""};return a.rows=(null==(o=e.viewRecords)?void 0:o.map((e=>e.get("record_uuid"))))||[],a.groupBy=n.id,a})),r.group=[n],r}toColumnGroup(e,t){const r={};return t.forEach((e=>{e.get("group_uuid")&&(r[e.get("group_uuid")]?r[e.get("group_uuid")].push({id:e.get("field_uuid")}):r[e.get("group_uuid")]=[{id:e.get("field_uuid")}])})),Bp(e,(e=>({name:e.get("name"),columns:r[e.get("uuid")]||[]})))}toRowHeight(e){return null!=e&&e.get("record_height")?{low:{type:ME.LOW,name:"低",value:36},middle:{type:ME.MIDDLE,name:"中",value:58},high:{type:ME.HIGH,name:"高",value:146}}[e.get("record_height")]:{type:ME.LOW,name:"低",value:36}}toTable(){var e;const t=this._readService.getTable(),r=this._readService.getOriginViewRecords(),n=this._readService.getAllFields(),i=this._readService.getViews(),o={format:"laketable",type:"Table"};o.version=t.get("version"),o.larkJson=!0;const a={};a.rowIds=Bp(r,(e=>e.get("record_uuid"))),a.rowCount=r.length,a.columns=Bp(n,(e=>{const t=this._readService.getFieldOptions(e.get("uuid")),r={id:e.get("uuid"),name:e.get("name"),type:e.get("type")};return e.get("color")&&(r.color=e.get("color")),t&&t.length>0&&(r.options=Bp(t,(e=>{const t={id:e.get("uuid"),value:e.get("name")};return e.get("color")&&(t.color=e.get("color")),t}))),r})),a.colCount=n.length,a.activeView=t.get("active_view_uuid"),a.id=t.get("uuid"),a.views={};for(const t of i){const r={};r.view=this._readService.getView(t.get("uuid")),r.sort=this._readService.getViewSort(t.get("uuid")),r.stats=this._readService.getViewStats(t.get("uuid")),r.viewGroup=this._readService.getViewGroup(t.get("uuid")),r.fieldGroups=this._readService.getViewFieldGroups(t.get("uuid")),r.filters=this._readService.getViewFilters(t.get("uuid")),r.groupViewRecords=null!=(e=r.viewGroup)&&e.group?this._readService.getGroupViewRecords(t.get("uuid")):null,r.viewConfig=this._readService.getViewConfig(t.get("uuid"));const n=this.toView(r);a.views[n.id]=n}return o.sheet=[a],o}};BR([ao(KO)],UR.prototype,"_readService",2),UR=BR([io()],UR);var zR={};!function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(zR);var HR={},WR={},GR={},KR=zR,qR=0,YR=1;function JR(e){for(var t=e.length;--t>=0;)e[t]=0}var XR=0,ZR=29,QR=256,eT=QR+1+ZR,tT=30,rT=19,nT=2*eT+1,iT=15,oT=16,aT=7,sT=256,lT=16,cT=17,uT=18,dT=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],fT=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],hT=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],pT=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],gT=new Array(2*(eT+2));JR(gT);var mT=new Array(2*tT);JR(mT);var vT=new Array(512);JR(vT);var yT=new Array(256);JR(yT);var bT=new Array(ZR);JR(bT);var _T,wT,CT,ET=new Array(tT);function ST(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function kT(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function xT(e){return e<256?vT[e]:vT[256+(e>>>7)]}function OT(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function IT(e,t,r){e.bi_valid>oT-r?(e.bi_buf|=t<<e.bi_valid&65535,OT(e,e.bi_buf),e.bi_buf=t>>oT-e.bi_valid,e.bi_valid+=r-oT):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function RT(e,t,r){IT(e,r[2*t],r[2*t+1])}function TT(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function AT(e,t,r){var n,i,o=new Array(iT+1),a=0;for(n=1;n<=iT;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=TT(o[s]++,s))}}function MT(e){var t;for(t=0;t<eT;t++)e.dyn_ltree[2*t]=0;for(t=0;t<tT;t++)e.dyn_dtree[2*t]=0;for(t=0;t<rT;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*sT]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function NT(e){e.bi_valid>8?OT(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function DT(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function PT(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&DT(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!DT(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function jT(e,t,r){var n,i,o,a,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?RT(e,i,t):(RT(e,(o=yT[i])+QR+1,t),0!==(a=dT[o])&&IT(e,i-=bT[o],a),RT(e,o=xT(--n),r),0!==(a=fT[o])&&IT(e,n-=ET[o],a))}while(s<e.last_lit);RT(e,sT,t)}function FT(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=nT,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)PT(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],PT(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,PT(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(o=0;o<=iT;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<nT;r++)(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(o=p,g++),l[2*n+1]=o,!(n>c)&&(e.bl_count[o]++,a=0,n>=h&&(a=f[n-h]),s=l[2*n],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(u[2*n+1]+a)));if(0!==g){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,g-=2}while(g>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)!((i=e.heap[--r])>c)&&(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),AT(o,c,e.bl_count)}function VT(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)&&(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*lT]++):s<=10?e.bl_tree[2*cT]++:e.bl_tree[2*uT]++,s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))}function LT(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)do{RT(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(RT(e,i,e.bl_tree),s--),RT(e,lT,e.bl_tree),IT(e,s-3,2)):s<=10?(RT(e,cT,e.bl_tree),IT(e,s-3,3)):(RT(e,uT,e.bl_tree),IT(e,s-11,7));s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}}JR(ET);var $T=!1;function BT(e,t,r,n){IT(e,(XR<<1)+(n?1:0),3),function(e,t,r,n){NT(e),n&&(OT(e,r),OT(e,~r)),KR.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}GR._tr_init=function(e){$T||(function(){var e,t,r,n,i,o=new Array(iT+1);for(r=0,n=0;n<ZR-1;n++)for(bT[n]=r,e=0;e<1<<dT[n];e++)yT[r++]=n;for(yT[r-1]=n,i=0,n=0;n<16;n++)for(ET[n]=i,e=0;e<1<<fT[n];e++)vT[i++]=n;for(i>>=7;n<tT;n++)for(ET[n]=i<<7,e=0;e<1<<fT[n]-7;e++)vT[256+i++]=n;for(t=0;t<=iT;t++)o[t]=0;for(e=0;e<=143;)gT[2*e+1]=8,e++,o[8]++;for(;e<=255;)gT[2*e+1]=9,e++,o[9]++;for(;e<=279;)gT[2*e+1]=7,e++,o[7]++;for(;e<=287;)gT[2*e+1]=8,e++,o[8]++;for(AT(gT,eT+1,o),e=0;e<tT;e++)mT[2*e+1]=5,mT[2*e]=TT(e,5);_T=new ST(gT,dT,QR+1,eT,iT),wT=new ST(mT,fT,0,tT,iT),CT=new ST(new Array(0),hT,0,rT,aT)}(),$T=!0),e.l_desc=new kT(e.dyn_ltree,_T),e.d_desc=new kT(e.dyn_dtree,wT),e.bl_desc=new kT(e.bl_tree,CT),e.bi_buf=0,e.bi_valid=0,MT(e)},GR._tr_stored_block=BT,GR._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return qR;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return YR;for(t=32;t<QR;t++)if(0!==e.dyn_ltree[2*t])return YR;return qR}(e)),FT(e,e.l_desc),FT(e,e.d_desc),a=function(e){var t;for(VT(e,e.dyn_ltree,e.l_desc.max_code),VT(e,e.dyn_dtree,e.d_desc.max_code),FT(e,e.bl_desc),t=rT-1;t>=3&&0===e.bl_tree[2*pT[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?BT(e,t,r,n):4===e.strategy||o===i?(IT(e,2+(n?1:0),3),jT(e,gT,mT)):(IT(e,4+(n?1:0),3),function(e,t,r,n){var i;for(IT(e,t-257,5),IT(e,r-1,5),IT(e,n-4,4),i=0;i<n;i++)IT(e,e.bl_tree[2*pT[i]+1],3);LT(e,e.dyn_ltree,t-1),LT(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),jT(e,e.dyn_ltree,e.dyn_dtree)),MT(e),n&&NT(e)},GR._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(yT[r]+QR+1)]++,e.dyn_dtree[2*xT(t)]++),e.last_lit===e.lit_bufsize-1},GR._tr_align=function(e){IT(e,2,3),RT(e,sT,gT),function(e){16===e.bi_valid?(OT(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)};var UT=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0};var zT=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var HT,WT=function(e,t,r,n){var i=zT,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e},GT={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},KT=zR,qT=GR,YT=UT,JT=WT,XT=GT,ZT=0,QT=4,eA=0,tA=-2,rA=-1,nA=4,iA=2,oA=8,aA=9,sA=286,lA=30,cA=19,uA=2*sA+1,dA=15,fA=3,hA=258,pA=hA+fA+1,gA=42,mA=103,vA=113,yA=666,bA=1,_A=2,wA=3,CA=4;function EA(e,t){return e.msg=XT[t],t}function SA(e){return(e<<1)-(e>4?9:0)}function kA(e){for(var t=e.length;--t>=0;)e[t]=0}function xA(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(KT.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function OA(e,t){qT._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,xA(e.strm)}function IA(e,t){e.pending_buf[e.pending++]=t}function RA(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function TA(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,KT.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=YT(e.adler,t,i,r):2===e.state.wrap&&(e.adler=JT(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function AA(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-pA?e.strstart-(e.w_size-pA):0,c=e.window,u=e.w_mask,d=e.prev,f=e.strstart+hA,h=c[o+a-1],p=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===p&&c[r+a-1]===h&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<f);if(n=hA-(f-o),o=f-hA,n>a){if(e.match_start=t,a=n,n>=s)break;h=c[o+a-1],p=c[o+a]}}}while((t=d[t&u])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function MA(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-pA)){KT.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);t=r=a;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=TA(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=fA)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+fA-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<fA)););}while(e.lookahead<pA&&0!==e.strm.avail_in)}function NA(e,t){for(var r,n;;){if(e.lookahead<pA){if(MA(e),e.lookahead<pA&&t===ZT)return bA;if(0===e.lookahead)break}if(r=0,e.lookahead>=fA&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+fA-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-pA&&(e.match_length=AA(e,r)),e.match_length>=fA)if(n=qT._tr_tally(e,e.strstart-e.match_start,e.match_length-fA),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=fA){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+fA-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=qT._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(OA(e,!1),0===e.strm.avail_out))return bA}return e.insert=e.strstart<fA-1?e.strstart:fA-1,t===QT?(OA(e,!0),0===e.strm.avail_out?wA:CA):e.last_lit&&(OA(e,!1),0===e.strm.avail_out)?bA:_A}function DA(e,t){for(var r,n,i;;){if(e.lookahead<pA){if(MA(e),e.lookahead<pA&&t===ZT)return bA;if(0===e.lookahead)break}if(r=0,e.lookahead>=fA&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+fA-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=fA-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-pA&&(e.match_length=AA(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===fA&&e.strstart-e.match_start>4096)&&(e.match_length=fA-1)),e.prev_length>=fA&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-fA,n=qT._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-fA),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+fA-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=fA-1,e.strstart++,n&&(OA(e,!1),0===e.strm.avail_out))return bA}else if(e.match_available){if((n=qT._tr_tally(e,0,e.window[e.strstart-1]))&&OA(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return bA}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=qT._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<fA-1?e.strstart:fA-1,t===QT?(OA(e,!0),0===e.strm.avail_out?wA:CA):e.last_lit&&(OA(e,!1),0===e.strm.avail_out)?bA:_A}function PA(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function jA(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=oA,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new KT.Buf16(2*uA),this.dyn_dtree=new KT.Buf16(2*(2*lA+1)),this.bl_tree=new KT.Buf16(2*(2*cA+1)),kA(this.dyn_ltree),kA(this.dyn_dtree),kA(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new KT.Buf16(dA+1),this.heap=new KT.Buf16(2*sA+1),kA(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new KT.Buf16(2*sA+1),kA(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function FA(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=iA,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?gA:vA,e.adler=2===t.wrap?0:1,t.last_flush=ZT,qT._tr_init(t),eA):EA(e,tA)}function VA(e){var t=FA(e);return t===eA&&function(e){e.window_size=2*e.w_size,kA(e.head),e.max_lazy_match=HT[e.level].max_lazy,e.good_match=HT[e.level].good_length,e.nice_match=HT[e.level].nice_length,e.max_chain_length=HT[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=fA-1,e.match_available=0,e.ins_h=0}(e.state),t}function LA(e,t,r,n,i,o){if(!e)return tA;var a=1;if(t===rA&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>aA||r!==oA||n<8||n>15||t<0||t>9||o<0||o>nA)return EA(e,tA);8===n&&(n=9);var s=new jA;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+fA-1)/fA),s.window=new KT.Buf8(2*s.w_size),s.head=new KT.Buf16(s.hash_size),s.prev=new KT.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new KT.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,VA(e)}HT=[new PA(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(MA(e),0===e.lookahead&&t===ZT)return bA;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,OA(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-pA&&(OA(e,!1),0===e.strm.avail_out))return bA}return e.insert=0,t===QT?(OA(e,!0),0===e.strm.avail_out?wA:CA):(e.strstart>e.block_start&&(OA(e,!1),e.strm.avail_out),bA)})),new PA(4,4,8,4,NA),new PA(4,5,16,8,NA),new PA(4,6,32,32,NA),new PA(4,4,16,16,DA),new PA(8,16,32,32,DA),new PA(8,16,128,128,DA),new PA(8,32,128,256,DA),new PA(32,128,258,1024,DA),new PA(32,258,258,4096,DA)],WR.deflateInit=function(e,t){return LA(e,t,oA,15,8,0)},WR.deflateInit2=LA,WR.deflateReset=VA,WR.deflateResetKeep=FA,WR.deflateSetHeader=function(e,t){return e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,eA):tA},WR.deflate=function(e,t){var r,n,i,o;if(!e||!e.state||t>5||t<0)return e?EA(e,tA):tA;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===yA&&t!==QT)return EA(e,0===e.avail_out?-5:tA);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===gA)if(2===n.wrap)e.adler=0,IA(n,31),IA(n,139),IA(n,8),n.gzhead?(IA(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),IA(n,255&n.gzhead.time),IA(n,n.gzhead.time>>8&255),IA(n,n.gzhead.time>>16&255),IA(n,n.gzhead.time>>24&255),IA(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),IA(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(IA(n,255&n.gzhead.extra.length),IA(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=JT(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(IA(n,0),IA(n,0),IA(n,0),IA(n,0),IA(n,0),IA(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),IA(n,3),n.status=vA);else{var a=oA+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=vA,RA(n,a),0!==n.strstart&&(RA(n,e.adler>>>16),RA(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=JT(e.adler,n.pending_buf,n.pending-i,i)),xA(e),i=n.pending,n.pending!==n.pending_buf_size));)IA(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=JT(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=JT(e.adler,n.pending_buf,n.pending-i,i)),xA(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,IA(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=JT(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=JT(e.adler,n.pending_buf,n.pending-i,i)),xA(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,IA(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=JT(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=mA)}else n.status=mA;if(n.status===mA&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&xA(e),n.pending+2<=n.pending_buf_size&&(IA(n,255&e.adler),IA(n,e.adler>>8&255),e.adler=0,n.status=vA)):n.status=vA),0!==n.pending){if(xA(e),0===e.avail_out)return n.last_flush=-1,eA}else if(0===e.avail_in&&SA(t)<=SA(r)&&t!==QT)return EA(e,-5);if(n.status===yA&&0!==e.avail_in)return EA(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==ZT&&n.status!==yA){var s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(MA(e),0===e.lookahead)){if(t===ZT)return bA;break}if(e.match_length=0,r=qT._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(OA(e,!1),0===e.strm.avail_out))return bA}return e.insert=0,t===QT?(OA(e,!0),0===e.strm.avail_out?wA:CA):e.last_lit&&(OA(e,!1),0===e.strm.avail_out)?bA:_A}(n,t):3===n.strategy?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=hA){if(MA(e),e.lookahead<=hA&&t===ZT)return bA;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=fA&&e.strstart>0&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=e.strstart+hA;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=hA-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=fA?(r=qT._tr_tally(e,1,e.match_length-fA),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=qT._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(OA(e,!1),0===e.strm.avail_out))return bA}return e.insert=0,t===QT?(OA(e,!0),0===e.strm.avail_out?wA:CA):e.last_lit&&(OA(e,!1),0===e.strm.avail_out)?bA:_A}(n,t):HT[n.level].func(n,t);if((s===wA||s===CA)&&(n.status=yA),s===bA||s===wA)return 0===e.avail_out&&(n.last_flush=-1),eA;if(s===_A&&(1===t?qT._tr_align(n):5!==t&&(qT._tr_stored_block(n,0,0,!1),3===t&&(kA(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),xA(e),0===e.avail_out))return n.last_flush=-1,eA}return t!==QT?eA:n.wrap<=0?1:(2===n.wrap?(IA(n,255&e.adler),IA(n,e.adler>>8&255),IA(n,e.adler>>16&255),IA(n,e.adler>>24&255),IA(n,255&e.total_in),IA(n,e.total_in>>8&255),IA(n,e.total_in>>16&255),IA(n,e.total_in>>24&255)):(RA(n,e.adler>>>16),RA(n,65535&e.adler)),xA(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?eA:1)},WR.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==gA&&69!==t&&73!==t&&91!==t&&t!==mA&&t!==vA&&t!==yA?EA(e,tA):(e.state=null,t===vA?EA(e,-3):eA):tA},WR.deflateSetDictionary=function(e,t){var r,n,i,o,a,s,l,c,u=t.length;if(!e||!e.state||(2===(o=(r=e.state).wrap)||1===o&&r.status!==gA||r.lookahead))return tA;for(1===o&&(e.adler=YT(e.adler,t,u,0)),r.wrap=0,u>=r.w_size&&(0===o&&(kA(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new KT.Buf8(r.w_size),KT.arraySet(c,t,u-r.w_size,r.w_size,0),t=c,u=r.w_size),a=e.avail_in,s=e.next_in,l=e.input,e.avail_in=u,e.next_in=0,e.input=t,MA(r);r.lookahead>=fA;){n=r.strstart,i=r.lookahead-(fA-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+fA-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=fA-1,MA(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=fA-1,r.match_available=0,e.next_in=s,e.input=l,e.avail_in=a,r.wrap=o,eA},WR.deflateInfo="pako deflate (from Nodeca project)";var $A={},BA=zR,UA=!0,zA=!0;try{String.fromCharCode.apply(null,[0])}catch{UA=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{zA=!1}for(var HA=new BA.Buf8(256),WA=0;WA<256;WA++)HA[WA]=WA>=252?6:WA>=248?5:WA>=240?4:WA>=224?3:WA>=192?2:1;function GA(e,t){if(t<65534&&(e.subarray&&zA||!e.subarray&&UA))return String.fromCharCode.apply(null,BA.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}HA[254]=HA[254]=1,$A.string2buf=function(e){var t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&(56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new BA.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&(56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},$A.buf2binstring=function(e){return GA(e,e.length)},$A.binstring2buf=function(e){for(var t=new BA.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},$A.buf2string=function(e,t){var r,n,i,o,a=t||e.length,s=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)s[n++]=i;else if((o=HA[i])>4)s[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<a;)i=i<<6|63&e[r++],o--;o>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return GA(s,n)},$A.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+HA[e[r]]>t?r:t};var KA=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},qA=WR,YA=zR,JA=$A,XA=GT,ZA=KA,QA=Object.prototype.toString,eM=0,tM=-1,rM=0,nM=8;function iM(e){if(!(this instanceof iM))return new iM(e);this.options=YA.assign({level:tM,method:nM,chunkSize:16384,windowBits:15,memLevel:8,strategy:rM,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZA,this.strm.avail_out=0;var r=qA.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==eM)throw new Error(XA[r]);if(t.header&&qA.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?JA.string2buf(t.dictionary):"[object ArrayBuffer]"===QA.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=qA.deflateSetDictionary(this.strm,n))!==eM)throw new Error(XA[r]);this._dict_set=!0}}function oM(e,t){var r=new iM(t);if(r.push(e,!0),r.err)throw r.msg||XA[r.err];return r.result}iM.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=JA.string2buf(e):"[object ArrayBuffer]"===QA.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new YA.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=qA.deflate(i,n))&&r!==eM)return this.onEnd(r),this.ended=!0,!1;(0===i.avail_out||0===i.avail_in&&(4===n||2===n))&&("string"===this.options.to?this.onData(JA.buf2binstring(YA.shrinkBuf(i.output,i.next_out))):this.onData(YA.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=qA.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===eM):(2===n&&(this.onEnd(eM),i.avail_out=0),!0)},iM.prototype.onData=function(e){this.chunks.push(e)},iM.prototype.onEnd=function(e){e===eM&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=YA.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},HR.Deflate=iM,HR.deflate=oM,HR.deflateRaw=function(e,t){return(t=t||{}).raw=!0,oM(e,t)},HR.gzip=function(e,t){return(t=t||{}).gzip=!0,oM(e,t)};var aM={},sM={},lM=zR,cM=15,uM=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],dM=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],fM=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],hM=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],pM=zR,gM=UT,mM=WT,vM=function(e,t){var r,n,i,o,a,s,l,c,u,d,f,h,p,g,m,v,y,b,_,w,C,E,S,k,x;r=e.state,n=e.next_in,k=e.input,i=n+(e.avail_in-5),o=e.next_out,x=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,d=r.wnext,f=r.window,h=r.hold,p=r.bits,g=r.lencode,m=r.distcode,v=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(h+=k[n++]<<p,p+=8,h+=k[n++]<<p,p+=8),b=g[h&v];t:for(;;){if(h>>>=_=b>>>24,p-=_,0===(_=b>>>16&255))x[o++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=g[(65535&b)+(h&(1<<_)-1)];continue t}if(32&_){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&b,(_&=15)&&(p<_&&(h+=k[n++]<<p,p+=8),w+=h&(1<<_)-1,h>>>=_,p-=_),p<15&&(h+=k[n++]<<p,p+=8,h+=k[n++]<<p,p+=8),b=m[h&y];r:for(;;){if(h>>>=_=b>>>24,p-=_,!(16&(_=b>>>16&255))){if(0==(64&_)){b=m[(65535&b)+(h&(1<<_)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(C=65535&b,p<(_&=15)&&(h+=k[n++]<<p,(p+=8)<_&&(h+=k[n++]<<p,p+=8)),(C+=h&(1<<_)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(h>>>=_,p-=_,C>(_=o-a)){if((_=C-_)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(E=0,S=f,0===d){if(E+=c-_,_<w){w-=_;do{x[o++]=f[E++]}while(--_);E=o-C,S=x}}else if(d<_){if(E+=c+d-_,(_-=d)<w){w-=_;do{x[o++]=f[E++]}while(--_);if(E=0,d<w){w-=_=d;do{x[o++]=f[E++]}while(--_);E=o-C,S=x}}}else if(E+=d-_,_<w){w-=_;do{x[o++]=f[E++]}while(--_);E=o-C,S=x}for(;w>2;)x[o++]=S[E++],x[o++]=S[E++],x[o++]=S[E++],w-=3;w&&(x[o++]=S[E++],w>1&&(x[o++]=S[E++]))}else{E=o-C;do{x[o++]=x[E++],x[o++]=x[E++],x[o++]=x[E++],w-=3}while(w>2);w&&(x[o++]=x[E++],w>1&&(x[o++]=x[E++]))}break}}break}}while(n<i&&o<s);n-=w=p>>3,h&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=h,r.bits=p},yM=function(e,t,r,n,i,o,a,s){var l,c,u,d,f,h,p,g,m,v=s.bits,y=0,b=0,_=0,w=0,C=0,E=0,S=0,k=0,x=0,O=0,I=null,R=0,T=new lM.Buf16(16),A=new lM.Buf16(16),M=null,N=0;for(y=0;y<=cM;y++)T[y]=0;for(b=0;b<n;b++)T[t[r+b]]++;for(C=v,w=cM;w>=1&&0===T[w];w--);if(C>w&&(C=w),0===w)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(_=1;_<w&&0===T[_];_++);for(C<_&&(C=_),k=1,y=1;y<=cM;y++)if(k<<=1,(k-=T[y])<0)return-1;if(k>0&&(0===e||1!==w))return-1;for(A[1]=0,y=1;y<cM;y++)A[y+1]=A[y]+T[y];for(b=0;b<n;b++)0!==t[r+b]&&(a[A[t[r+b]]++]=b);if(0===e?(I=M=a,h=19):1===e?(I=uM,R-=257,M=dM,N-=257,h=256):(I=fM,M=hM,h=-1),O=0,b=0,y=_,f=o,E=C,S=0,u=-1,d=(x=1<<C)-1,1===e&&x>852||2===e&&x>592)return 1;for(;;){p=y-S,a[b]<h?(g=0,m=a[b]):a[b]>h?(g=M[N+a[b]],m=I[R+a[b]]):(g=96,m=0),l=1<<y-S,_=c=1<<E;do{i[f+(O>>S)+(c-=l)]=p<<24|g<<16|m|0}while(0!==c);for(l=1<<y-1;O&l;)l>>=1;if(0!==l?(O&=l-1,O+=l):O=0,b++,0==--T[y]){if(y===w)break;y=t[r+a[b]]}if(y>C&&(O&d)!==u){for(0===S&&(S=C),f+=_,k=1<<(E=y-S);E+S<w&&!((k-=T[E+S])<=0);)E++,k<<=1;if(x+=1<<E,1===e&&x>852||2===e&&x>592)return 1;i[u=O&d]=C<<24|E<<16|f-o|0}}return 0!==O&&(i[f+O]=y-S<<24|64<<16|0),s.bits=C,0},bM=1,_M=2,wM=0,CM=-2,EM=1,SM=12,kM=30,xM=852,OM=592;function IM(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function RM(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new pM.Buf16(320),this.work=new pM.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function TM(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=EM,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new pM.Buf32(xM),t.distcode=t.distdyn=new pM.Buf32(OM),t.sane=1,t.back=-1,wM):CM}function AM(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,TM(e)):CM}function MM(e,t){var r,n;return!e||!e.state||(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15))?CM:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,AM(e))}function NM(e,t){var r,n;return e?(n=new RM,e.state=n,n.window=null,(r=MM(e,t))!==wM&&(e.state=null),r):CM}var DM,PM,jM=!0;function FM(e){if(jM){var t;for(DM=new pM.Buf32(512),PM=new pM.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(yM(bM,e.lens,0,288,DM,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;yM(_M,e.lens,0,32,PM,0,e.work,{bits:5}),jM=!1}e.lencode=DM,e.lenbits=9,e.distcode=PM,e.distbits=5}function VM(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new pM.Buf8(o.wsize)),n>=o.wsize?(pM.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),pM.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(pM.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}sM.inflateReset=AM,sM.inflateReset2=MM,sM.inflateResetKeep=TM,sM.inflateInit=function(e){return NM(e,15)},sM.inflateInit2=NM,sM.inflate=function(e,t){var r,n,i,o,a,s,l,c,u,d,f,h,p,g,m,v,y,b,_,w,C,E,S,k,x=0,O=new pM.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return CM;(r=e.state).mode===SM&&(r.mode=13),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,d=s,f=l,E=wM;e:for(;;)switch(r.mode){case EM:if(0===r.wrap){r.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===c){r.check=0,O[0]=255&c,O[1]=c>>>8&255,r.check=mM(r.check,O,2,0),c=0,u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=kM;break}if(8!=(15&c)){e.msg="unknown compression method",r.mode=kM;break}if(u-=4,C=8+(15&(c>>>=4)),0===r.wbits)r.wbits=C;else if(C>r.wbits){e.msg="invalid window size",r.mode=kM;break}r.dmax=1<<C,e.adler=r.check=1,r.mode=512&c?10:SM,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=kM;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=kM;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,r.check=mM(r.check,O,2,0)),c=0,u=0,r.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,O[2]=c>>>16&255,O[3]=c>>>24&255,r.check=mM(r.check,O,4,0)),c=0,u=0,r.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,r.check=mM(r.check,O,2,0)),c=0,u=0,r.mode=5;case 5:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(O[0]=255&c,O[1]=c>>>8&255,r.check=mM(r.check,O,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((h=r.length)>s&&(h=s),h&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),pM.arraySet(r.head.extra,n,o,h,C)),512&r.flags&&(r.check=mM(r.check,n,h,o)),s-=h,o+=h,r.length-=h),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;h=0;do{C=n[o+h++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C))}while(C&&h<s);if(512&r.flags&&(r.check=mM(r.check,n,h,o)),s-=h,o+=h,C)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;h=0;do{C=n[o+h++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C))}while(C&&h<s);if(512&r.flags&&(r.check=mM(r.check,n,h,o)),s-=h,o+=h,C)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=kM;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=SM;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=IM(c),c=0,u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,2;e.adler=r.check=1,r.mode=SM;case SM:if(5===t||6===t)break e;case 13:if(r.last){c>>>=7&u,u-=7&u,r.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=1&c,u-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(FM(r),r.mode=20,6===t){c>>>=2,u-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=kM}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=kM;break}if(r.length=65535&c,c=0,u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(h=r.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break e;pM.arraySet(i,n,o,h,a),s-=h,o+=h,l-=h,a+=h,r.length-=h;break}r.mode=SM;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=kM;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.lens[I[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},E=yM(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,E){e.msg="invalid code lengths set",r.mode=kM;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;v=(x=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,y=65535&x,!((m=x>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(y<16)c>>>=m,u-=m,r.lens[r.have++]=y;else{if(16===y){for(k=m+2;u<k;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=m,u-=m,0===r.have){e.msg="invalid bit length repeat",r.mode=kM;break}C=r.lens[r.have-1],h=3+(3&c),c>>>=2,u-=2}else if(17===y){for(k=m+3;u<k;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=m,C=0,h=3+(7&(c>>>=m)),c>>>=3,u-=3}else{for(k=m+7;u<k;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=m,C=0,h=11+(127&(c>>>=m)),c>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=kM;break}for(;h--;)r.lens[r.have++]=C}}if(r.mode===kM)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=kM;break}if(r.lenbits=9,S={bits:r.lenbits},E=yM(bM,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,E){e.msg="invalid literal/lengths set",r.mode=kM;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},E=yM(_M,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,E){e.msg="invalid distances set",r.mode=kM;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,vM(e,f),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===SM&&(r.back=-1);break}for(r.back=0;v=(x=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,y=65535&x,!((m=x>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(v&&0==(240&v)){for(b=m,_=v,w=y;v=(x=r.lencode[w+((c&(1<<b+_)-1)>>b)])>>>16&255,y=65535&x,!(b+(m=x>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=m,u-=m,r.back+=m,r.length=y,0===v){r.mode=26;break}if(32&v){r.back=-1,r.mode=SM;break}if(64&v){e.msg="invalid literal/length code",r.mode=kM;break}r.extra=15&v,r.mode=22;case 22:if(r.extra){for(k=r.extra;u<k;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;v=(x=r.distcode[c&(1<<r.distbits)-1])>>>16&255,y=65535&x,!((m=x>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(0==(240&v)){for(b=m,_=v,w=y;v=(x=r.distcode[w+((c&(1<<b+_)-1)>>b)])>>>16&255,y=65535&x,!(b+(m=x>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=m,u-=m,r.back+=m,64&v){e.msg="invalid distance code",r.mode=kM;break}r.offset=y,r.extra=15&v,r.mode=24;case 24:if(r.extra){for(k=r.extra;u<k;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=kM;break}r.mode=25;case 25:if(0===l)break e;if(h=f-l,r.offset>h){if((h=r.offset-h)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=kM;break}h>r.wnext?(h-=r.wnext,p=r.wsize-h):p=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=i,p=a-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do{i[a++]=g[p++]}while(--h);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;i[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[o++]<<u,u+=8}if(f-=l,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=r.flags?mM(r.check,i,f,a-f):gM(r.check,i,f,a-f)),f=l,(r.flags?c:IM(c))!==r.check){e.msg="incorrect data check",r.mode=kM;break}c=0,u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=kM;break}c=0,u=0}r.mode=29;case 29:E=1;break e;case kM:E=-3;break e;case 31:return-4;default:return CM}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||f!==e.avail_out&&r.mode<kM&&(r.mode<27||4!==t))&&VM(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=r.flags?mM(r.check,i,f,e.next_out-f):gM(r.check,i,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===SM?128:0)+(20===r.mode||15===r.mode?256:0),(0===d&&0===f||4===t)&&E===wM&&(E=-5),E},sM.inflateEnd=function(e){if(!e||!e.state)return CM;var t=e.state;return t.window&&(t.window=null),e.state=null,wM},sM.inflateGetHeader=function(e,t){var r;return e&&e.state&&0!=(2&(r=e.state).wrap)?(r.head=t,t.done=!1,wM):CM},sM.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state&&(0===(r=e.state).wrap||11===r.mode)?11===r.mode&&gM(1,t,n,0)!==r.check?-3:VM(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,wM):CM},sM.inflateInfo="pako inflate (from Nodeca project)";var LM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var $M=sM,BM=zR,UM=$A,zM=LM,HM=GT,WM=KA,GM=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},KM=Object.prototype.toString;function qM(e){if(!(this instanceof qM))return new qM(e);this.options=BM.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WM,this.strm.avail_out=0;var r=$M.inflateInit2(this.strm,t.windowBits);if(r!==zM.Z_OK)throw new Error(HM[r]);if(this.header=new GM,$M.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=UM.string2buf(t.dictionary):"[object ArrayBuffer]"===KM.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=$M.inflateSetDictionary(this.strm,t.dictionary))!==zM.Z_OK))throw new Error(HM[r])}function YM(e,t){var r=new qM(t);if(r.push(e,!0),r.err)throw r.msg||HM[r.err];return r.result}qM.prototype.push=function(e,t){var r,n,i,o,a,s=this.strm,l=this.options.chunkSize,c=this.options.dictionary,u=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?zM.Z_FINISH:zM.Z_NO_FLUSH,"string"==typeof e?s.input=UM.binstring2buf(e):"[object ArrayBuffer]"===KM.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new BM.Buf8(l),s.next_out=0,s.avail_out=l),(r=$M.inflate(s,zM.Z_NO_FLUSH))===zM.Z_NEED_DICT&&c&&(r=$M.inflateSetDictionary(this.strm,c)),r===zM.Z_BUF_ERROR&&!0===u&&(r=zM.Z_OK,u=!1),r!==zM.Z_STREAM_END&&r!==zM.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0===s.avail_out||r===zM.Z_STREAM_END||0===s.avail_in&&(n===zM.Z_FINISH||n===zM.Z_SYNC_FLUSH))&&("string"===this.options.to?(i=UM.utf8border(s.output,s.next_out),o=s.next_out-i,a=UM.buf2string(s.output,i),s.next_out=o,s.avail_out=l-o,o&&BM.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(BM.shrinkBuf(s.output,s.next_out))),0===s.avail_in&&0===s.avail_out&&(u=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==zM.Z_STREAM_END);return r===zM.Z_STREAM_END&&(n=zM.Z_FINISH),n===zM.Z_FINISH?(r=$M.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===zM.Z_OK):(n===zM.Z_SYNC_FLUSH&&(this.onEnd(zM.Z_OK),s.avail_out=0),!0)},qM.prototype.onData=function(e){this.chunks.push(e)},qM.prototype.onEnd=function(e){e===zM.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=BM.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},aM.Inflate=qM,aM.inflate=YM,aM.inflateRaw=function(e,t){return(t=t||{}).raw=!0,YM(e,t)},aM.ungzip=YM;var JM={};(0,zR.assign)(JM,HR,aM,LM);var XM=JM;const ZM=$i.defineToken("ProcessKernelPluginContribution"),QM=null;var eN=Object.defineProperty,tN=Object.getOwnPropertyDescriptor,rN=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tN(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eN(t,r,o),o};let nN=class{getProvider(){var e;const t=this.processProvider.getContributions()||[],r=t[t.length-1];return null==(e=null==r?void 0:r.registerProcess)?void 0:e.call(r)}getTableMiddlewares(){return(this.processProvider.getContributions()||[]).map((e=>{var t;return null==(t=e.registerProcessTableMiddleware)?void 0:t.call(e)})).filter((e=>!!e))}getUsersMiddlewares(){return(this.processProvider.getContributions()||[]).map((e=>{var t;return null==(t=e.registerProcessUsersMiddleware)?void 0:t.call(e)})).filter((e=>!!e))}getRecordsMiddlewares(){return(this.processProvider.getContributions()||[]).map((e=>{var t;return null==(t=e.registerProcessRecordsMiddleware)?void 0:t.call(e)})).filter((e=>!!e))}};rN([wh(ZM)],nN.prototype,"processProvider",2),nN=rN([io()],nN);var iN=Object.defineProperty,oN=Object.getOwnPropertyDescriptor,aN=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?oN(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iN(t,r,o),o};const sN=Jo.Plugin("process");let lN=class{toModel(e,t){var r,n;let i;if(i="string"==typeof e?JSON.parse(e):e,sN("服务端数据",i),i.version){if("string"==typeof i.sheet?i.sheet=JSON.parse(XM.inflate(i.sheet,{to:"string"}))[0]:i.sheet=null==(r=i.sheet)?void 0:r[0],!i.sheet)return;try{const e=this._processRegistry.getTableMiddlewares();if(e&&e.length>0)for(const r of e)i=r?r(i,t):i}catch(e){sN("process table error:",e)}const e=i.sheet;sN("处理前数据",e);let o=e.activeView||e.defaultView;const a=e.views[o];(!a||!(null!=(n=this._configuration.getValue("viewerManage.viewTypes"))&&n.includes(a.type)))&&(o=Object.keys(e.views)[0]),t.setData("table",[{uuid:e.id,version:"1.4",active_view_uuid:o}]),this._columnToModel(t,e.columns),i.records&&("string"==typeof i.records&&(i.records=JSON.parse(XM.inflate(i.records,{to:"string"}))),this._recordToModel(t,i.records)),i.users&&("string"==typeof i.users&&(i.users=JSON.parse(XM.inflate(i.users,{to:"string"}))),this._userToModel(t,i.users)),this._viewsToModel(t,e.views,e.columns),sN("处理后数据",t.getAll())}}toRecordModel(e,t){"string"==typeof e.records&&(e=JSON.parse(XM.inflate(e,{to:"string"})));try{const r=this._processRegistry.getRecordsMiddlewares();if(r&&r.length>0)for(const n of r)e=n?n({records:e},t).records:e}catch(e){sN("process records error:",e)}this._recordToModel(t,e)}toUserModel(e,t){try{const r=this._processRegistry.getUsersMiddlewares();if(r&&r.length>0)for(const n of r)e=n?n({users:e},t).users:e}catch(e){sN("process users error:",e)}this._userToModel(t,e)}_columnToModel(e,t){for(const e of t){if(("input"===e.type||"textarea"===e.type)&&(e.type="text"),e.uuid=e.uuid||e.id,e.options)for(const t of e.options)t.name=t.name||t.value,t.uuid=t.uuid||t.id;zE.isMultiple(e.type)&&(e.multiple=!0)}t=e.setData("field",t);const r=[];for(const e of t)if(e.options)for(const t of e.options)r.push({uuid:t.uuid,field_uuid:e.uuid,name:t.name,color:t.color});e.setData("field_option",r)}_getField(e,t){const r=e.getData("field").toJSON().find((e=>e.uuid===t));if(r){if("select"===r.type||"multiSelect"===r.type){const t=e.getData("field_option").toJSON();r.options=t.filter((e=>e.field_uuid===r.uuid))}return r}}_userToModel(e,t){const r=e.getData("user").toJSON()||[];for(const e of t){if(!e)continue;const t=String(e.id||e.uid);r.some((e=>e.uid===t))||r.push({uuid:To(32),uid:t,login:e.login,name:e.name,icon:e.avatar_url||e.icon,work_id:e.work_id,created_at:+new Date,updated_at:+new Date})}e.setData("user",r)}_recordToModel(e,t){var r,n;const i=(null==(r=e.getData("record"))?void 0:r.toJSON())||[],o=[];for(const r of t){if(i.push({id:r.id,uuid:r.uuid,creator_id:r.user_id,modifier_id:r.modifier_id,created_at:+new Date(r.created_at),updated_at:+new Date(r.updated_at)}),!r.data)continue;const t=JSON.parse(r.data);for(const i of Object.keys(t)){const a=this._getField(e,i);if(!a)continue;const s=a.type,l=t[i],c=null==(n=this._processRegistry.getProvider())?void 0:n.processFieldModel;let u;if(u=c?c(a,l.value):null==l?void 0:l.value,null!=u){if(zE.isUri(s)){if(!u)continue;u&&"string"==typeof u&&(u={src:u,name:u})}if(Array.isArray(u)){for(const e of u)zE.isMention(s)&&(e.uid=e.id,e.icon=e.avatar_url),o.push({fieldType:s,field_uuid:i,record_uuid:r.uuid,value:e});continue}zE.isDate(s)&&(null!=u.time?u=u.time:null!=u.seconds&&(u=Ef(u.seconds))),o.push({fieldType:s,field_uuid:i,record_uuid:r.uuid,value:u})}}}e.setData("record",i),this._createValues(e,o)}_createValues(e,t){const r={field_boolean:[],field_date:[],field_number:[],field_select:[],field_string:[],field_uri:[],user:{}};t.forEach((e=>{var t,n,i,o,a,s,l;const c=e.fieldType;if(delete e.fieldType,zE.isBoolean(c))r.field_boolean.push(e);else if(zE.isDate(c))r.field_date.push(e);else if(zE.isNumber(c))r.field_number.push(e);else if(zE.isSelectLike(c))r.field_select.push(e);else if(zE.isString(c))r.field_string.push(e);else if(zE.isUri(c)){if(r.field_uri.push({field_uuid:e.field_uuid,record_uuid:e.record_uuid,uid:null==(t=e.value)?void 0:t.uid,src:null==(n=e.value)?void 0:n.src,icon:null==(i=e.value)?void 0:i.icon,name:null==(o=e.value)?void 0:o.name,size:null==(a=e.value)?void 0:a.size,width:null==(s=e.value)?void 0:s.width,height:null==(l=e.value)?void 0:l.height}),zE.isMention(c)){if(!e.value)return;r.user[e.value.uid]={uid:String(e.value.uid),name:e.value.name,icon:e.value.icon,login:e.value.login,work_id:e.value.work_id}}}else if(zE.isSystemUser(c)){if(!e.value)return;r.user[e.value.id]={uid:String(e.value.id),name:e.value.name,icon:e.value.avatar_url,login:e.value.login,work_id:e.value.work_id}}})),r.user=Object.values(r.user);const n=Object.keys(r);for(const t of n){if("user"===t){const n=af([...e.getData("user").toJSON(),...Object.values(r[t])],"uid");return void e.setData("user",n)}e.setData(t,r[t])}}_viewsToModel(e,t,r){const n=Object.values(t),i=[];for(const t of n)i.push({id:t.iid,uuid:t.id,name:t.name,type:t.type,desc:t.desc}),this._viewToModel(e,t,r);e.setData("view",i)}_viewToModel(e,t,r){var n,i,o,a,s,l,c;const u=e.getData("view_config").toJSON()||[],d=e.getData("view_field").toJSON()||[],f=e.getData("view_record").toJSON()||[],h=e.getData("group").toJSON()||[],p=e.getData("field_group").toJSON()||[],g=e.getData("filter").toJSON()||[],m=e.getData("sort").toJSON()||[],v=e.getData("stat").toJSON()||[],y=r.reduce(((e,t)=>(e[t.id]=t,e)),{}),b={};if(u.push({view_uuid:t.id,cover_field_uuid:null!=(n=t.cover)&&n.show?null==(i=t.cover)?void 0:i.id:"",cover_display:null==(o=t.cover)?void 0:o.display,show_field_name:t.showField,keep_sort:null==(a=t.sort)?void 0:a.auto,frozen_field:t.frozenCol,record_height:null==(s=t.rowHeight)?void 0:s.type}),t.columnGroups&&t.columnGroups.length>0)for(const e of t.columnGroups){const r=To(32);e.columns.forEach((e=>{b[e.id]=r})),p.push({uuid:r,view_uuid:t.id,name:e.name})}if(t.type===LE.FORM){if(t.fields)for(const e of t.fields)y[e.columnId]&&d.push({view_uuid:t.id,field_uuid:e.columnId,group_uuid:b[e.id],name:e.title||e.columnName,display_type:e.display,required:(null==(c=null==(l=e.validations)?void 0:l[0])?void 0:c.required)||!1})}else for(const e of t.columns)y[e.id]&&d.push({view_uuid:t.id,field_uuid:e.id,group_uuid:b[e.id],size:e.size,hidden:e.hidden});if(t.rows){const e={};t.group&&t.groupData&&t.groupData.forEach((t=>{t.rows.forEach((r=>{Array.isArray(t.titleValue)?"string"==typeof t.titleValue[0]?e[r]=t.titleValue[0]:e[r]=t.titleValue.map((e=>e.uid)).join(","):e[r]=t.titleValue}))}));for(const r of t.rows){const n={view_uuid:t.id,record_uuid:r.id};if(t.group){const t=e[r.id];n.group_item_key=null!=t&&t.id?String(null==t?void 0:t.id):t}f.push(n)}}if(t.filter&&t.filter.options)for(const e of t.filter.options)!d.some((t=>t.field_uuid===e.id))||g.push({view_uuid:t.id,field_uuid:e.id,operator:t.filter.operator||IE.And,func:e.func,expected:Array.isArray(e.expected)?e.expected.join(","):e.expected});if(t.group&&t.group.length>0){const e=t.group[0],n=r.find((t=>t.id===e.id));n&&d.some((e=>e.field_uuid===n.id))&&h.push({view_uuid:t.id,field_uuid:n.id,type:e.type})}if(t.sort&&t.sort.options)for(const e of t.sort.options)!d.some((t=>t.field_uuid===e.id))||m.push({view_uuid:t.id,field_uuid:e.id,type:e.type});if(t.stats){const e=Object.keys(t.stats);for(const r of e)v.push({view_uuid:t.id,field_uuid:r,type:t.stats[r]})}e.setData("view_config",u),e.setData("view_field",d),e.setData("view_record",f),e.setData("group",h),e.setData("field_group",p),e.setData("filter",g),e.setData("sort",m),e.setData("stat",v)}toData(e){var t;const r=null==(t=e.getData("record"))?void 0:t.toJSON(),n=this._toProcess.toTable();return n.records=r.map((e=>{const t=this._readService.getOriginRecord(e.uuid);return{id:e.id,uuid:e.uuid,user_id:e.creator_id,modifier_id:e.modifier_id,sheet_id:n.sheet[0].id,data:JSON.stringify(this._toProcess.toRecord(t)),updated_at:+new Date(e.updated_at),created_at:+new Date(e.created_at)}})).filter((e=>!!e)),n}};function cN(){return wi(new nn(vr,!0))}function uN(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:yc(e,t,r)}function dN(e){return function(t){var r=_c(t=Ql(t))?Nc(t):void 0,n=r?r[0]:t.charAt(0),i=r?uN(r,1).join(""):t.slice(1);return n[e]()+i}}aN([ao(UR)],lN.prototype,"_toProcess",2),aN([ao(nN)],lN.prototype,"_processRegistry",2),aN([ao(lp)],lN.prototype,"_configuration",2),aN([ao(KO)],lN.prototype,"_readService",2),lN=aN([io()],lN);const fN=dN("toUpperCase");const hN=function(){return Ca.Date.now()};var pN="Expected a function",gN=Math.max,mN=Math.min;function vN(e,t,r){var n,i,o,a,s,l,c=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(pN);function h(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function p(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=o}function g(){var e=hN();if(p(e))return m(e);s=setTimeout(g,function(e){var r=t-(e-l);return d?mN(r,o-(e-c)):r}(e))}function m(e){return s=void 0,f&&n?h(e):(n=i=void 0,a)}function v(){var e=hN(),r=p(e);if(n=arguments,i=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),u?h(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),h(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=Za(t)||0,Ga(r)&&(u=!!r.leading,o=(d="maxWait"in r)?gN(Za(r.maxWait)||0,t):o,f="trailing"in r?!!r.trailing:f),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=i=s=void 0},v.flush=function(){return void 0===s?a:m(hN())},v}function yN(e){return Na(e)&&1===e.nodeType&&!vc(e)}var bN="[object Number]";function _N(e){return"number"==typeof e||Na(e)&&Ma(e)==bN}function wN(e){return _N(e)&&e!=+e}function CN(e){return void 0===e}function EN(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Ga(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),vN(e,t,{leading:n,maxWait:t,trailing:i})}const SN={ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,TAB:9,BACKSPACE:8,DELETE:46,DEL:46,END:35,SPACE:32};var kN=(e=>(e[e.BackSpace=8]="BackSpace",e[e.Tab=9]="Tab",e[e.Clear=12]="Clear",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Caps=20]="Caps",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Delete=46]="Delete",e[e.Digit0=48]="Digit0",e[e.Digit1=49]="Digit1",e[e.Digit2=50]="Digit2",e[e.Digit3=51]="Digit3",e[e.Digit4=52]="Digit4",e[e.Digit5=53]="Digit5",e[e.Digit6=54]="Digit6",e[e.Digit9=57]="Digit9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Meta=91]="Meta",e[e.RightMeta=92]="RightMeta",e[e.Caret=94]="Caret",e[e.Numpad0=96]="Numpad0",e[e.Numpad9=105]="Numpad9",e[e.NumpadPlus=107]="NumpadPlus",e[e.NumpadMinus=109]="NumpadMinus",e[e.NumpadDot=110]="NumpadDot",e[e.F11=122]="F11",e[e.Semicolon=186]="Semicolon",e[e.Plus=187]="Plus",e[e.Comma=188]="Comma",e[e.Minus=189]="Minus",e[e.Dot=190]="Dot",e[e.Grave=192]="Grave",e[e.Bracket=219]="Bracket",e[e.Quot=222]="Quot",e[e.Asterisk=106]="Asterisk",e[e.Slash=111]="Slash",e[e.FirefoxMinus=173]="FirefoxMinus",e[e["/"]=191]="/",e[e["\\"]=220]="\\",e[e.Ime=229]="Ime",e))(kN||{}),xN=(e=>(e.ESC="Escape",e.LEFT="ArrowLeft",e.UP="ArrowUp",e.RIGHT="ArrowRight",e.DOWN="ArrowDown",e.ENTER="Enter",e.TAB="Tab",e.SPACE=" ",e.DEL="Backspace",e.BACKSPACE="Backspace",e))(xN||{});function ON(e){const{metaKey:t,ctrlKey:r}=e,{keyCode:n}=e;return!t&&!r&&32!==n&&(n>=65&&n<=90||n>=48&&n<=57||n>=96&&n<=105||n>=186&&n<=192||n>=219&&n<=222||n>=106&&n<=111||32===n||61===n||173===n||(229===n||0===n)&&"Shift"!==e.key)}function IN(e,t,r){let n=0;const i=t>0?1:-1;for(;Math.abs(n)<Math.abs(t)&&!1!==r(e+n);)n+=i}const RN=globalThis;const TN=function(e,t,r){return()=>null!=e?e.performance.now():null!=t?t.hrtime()[1]/1e6:(new r).getTime()}(RN.window,RN.process,Date),AN=(e,t)=>{const r=(t-e).toFixed(2);return Number(r)},MN={request:{bindings:{activated:!1,cache:!1,constraint:!1,dynamicValue:!1,factory:!1,implementationType:!0,onActivation:!1,provider:!1,scope:!0,serviceIdentifier:!1,type:!0},serviceIdentifier:!0,target:{metadata:!0,name:!0,serviceIdentifier:!0}},time:!0};function NN(e,t,r){const n={},i=t,o=TN();if(!0===i.serviceIdentifier&&(n.serviceIdentifier=e.serviceIdentifier),void 0!==i.bindings){const r=e.bindings.map((e=>function(e,t){const r={},n=t,i=e;return["type","serviceIdentifier","implementationType","activated","cache","constraint","dynamicValue","factory","onActivation","provider","scope"].forEach((e=>{n[e]&&(r[e]=i[e])})),r}(e,t.bindings)));n.bindings=r}void 0!==i.target&&null!==e.target&&(n.target=function(e,t){const r={},n=t,i=e;if(n.name&&(r.name=i.name),n.serviceIdentifier&&(r.serviceIdentifier=i.serviceIdentifier),n.metadata&&Array.isArray(e.metadata)){const t=e.metadata.map(((e,t)=>({key:e.key,value:e.value})));r.metadata=t}return r}(e.target,t.target));const a=e.childRequests.map((e=>NN(e,t,r)));return n.childRequests=a,n.time=AN(o,TN()),null!=r&&r(n)&&Sh(n),n}function DN(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function PN(e){let{settings:t,renderer:r}=e||{};return function(n){return null==t&&(t=MN),null==r&&(r=Sh),r=>{let i=null;const o={error:!1,exception:null,guid:DN(),multiInject:r.isMultiInject,results:[],rootRequest:null,serviceIdentifier:r.serviceIdentifier,time:null},a=r.contextInterceptor;r.contextInterceptor=r=>(null!=t&&t.request&&(o.rootRequest=NN(r.plan.rootRequest,t.request,null==e?void 0:e.filter)),a(r));try{const e=TN();i=n(r);const a=TN();o.results=i,o.time=null!=t&&t.time?AN(e,a):null}catch(e){o.error=!0,o.exception=e,o.time=null}if(i)return i;throw new Error(o.exception.message)}}}var jN=(e=>(e.ASC="asc",e.DESC="desc",e))(jN||{});const FN=$i.defineToken("CollaborationKernelPluginContribution");var VN=(e=>(e.SPELL="spell",e.YJS="yjs",e))(VN||{});function LN(e){return(LN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var $N=/^\s+/,BN=/\s+$/;function UN(e,t){if(t=t||{},(e=e||"")instanceof UN)return e;if(!(this instanceof UN))return new UN(e,t);var r=function(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,o=null,a=!1,s=!1;return"string"==typeof e&&(e=function(e){e=e.replace($N,"").replace(BN,"").toLowerCase();var t,r=!1;if(oD[e])e=oD[e],r=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=yD.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=yD.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=yD.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=yD.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=yD.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=yD.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=yD.hex8.exec(e))?{r:uD(t[1]),g:uD(t[2]),b:uD(t[3]),a:pD(t[4]),format:r?"name":"hex8"}:(t=yD.hex6.exec(e))?{r:uD(t[1]),g:uD(t[2]),b:uD(t[3]),format:r?"name":"hex"}:(t=yD.hex4.exec(e))?{r:uD(t[1]+""+t[1]),g:uD(t[2]+""+t[2]),b:uD(t[3]+""+t[3]),a:pD(t[4]+""+t[4]),format:r?"name":"hex8"}:!!(t=yD.hex3.exec(e))&&{r:uD(t[1]+""+t[1]),g:uD(t[2]+""+t[2]),b:uD(t[3]+""+t[3]),format:r?"name":"hex"}}(e)),"object"==LN(e)&&(bD(e.r)&&bD(e.g)&&bD(e.b)?(t=function(e,t,r){return{r:255*lD(e,255),g:255*lD(t,255),b:255*lD(r,255)}}(e.r,e.g,e.b),a=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):bD(e.h)&&bD(e.s)&&bD(e.v)?(n=fD(e.s),i=fD(e.v),t=function(e,t,r){e=6*lD(e,360),t=lD(t,100),r=lD(r,100);var n=Math.floor(e),i=e-n,o=r*(1-t),a=r*(1-i*t),s=r*(1-(1-i)*t),l=n%6,c=[r,a,o,o,s,r][l],u=[s,r,r,a,o,o][l],d=[o,o,s,r,r,a][l];return{r:255*c,g:255*u,b:255*d}}(e.h,n,i),a=!0,s="hsv"):bD(e.h)&&bD(e.s)&&bD(e.l)&&(n=fD(e.s),o=fD(e.l),t=function(e,t,r){var n,i,o;function a(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}if(e=lD(e,360),t=lD(t,100),r=lD(r,100),0===t)n=i=o=r;else{var s=r<.5?r*(1+t):r+t-r*t,l=2*r-s;n=a(l,s,e+1/3),i=a(l,s,e),o=a(l,s,e-1/3)}return{r:255*n,g:255*i,b:255*o}}(e.h,n,o),a=!0,s="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=sD(r),{ok:a,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}function zN(e,t,r){e=lD(e,255),t=lD(t,255),r=lD(r,255);var n,i,o=Math.max(e,t,r),a=Math.min(e,t,r),s=(o+a)/2;if(o==a)n=i=0;else{var l=o-a;switch(i=s>.5?l/(2-o-a):l/(o+a),o){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,l:s}}function HN(e,t,r){e=lD(e,255),t=lD(t,255),r=lD(r,255);var n,i,o=Math.max(e,t,r),a=Math.min(e,t,r),s=o,l=o-a;if(i=0===o?0:l/o,o==a)n=0;else{switch(o){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,v:s}}function WN(e,t,r,n){var i=[dD(Math.round(e).toString(16)),dD(Math.round(t).toString(16)),dD(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function GN(e,t,r,n){return[dD(hD(n)),dD(Math.round(e).toString(16)),dD(Math.round(t).toString(16)),dD(Math.round(r).toString(16))].join("")}function KN(e,t){t=0===t?0:t||10;var r=UN(e).toHsl();return r.s-=t/100,r.s=cD(r.s),UN(r)}function qN(e,t){t=0===t?0:t||10;var r=UN(e).toHsl();return r.s+=t/100,r.s=cD(r.s),UN(r)}function YN(e){return UN(e).desaturate(100)}function JN(e,t){t=0===t?0:t||10;var r=UN(e).toHsl();return r.l+=t/100,r.l=cD(r.l),UN(r)}function XN(e,t){t=0===t?0:t||10;var r=UN(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-t/100*255))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-t/100*255))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-t/100*255))),UN(r)}function ZN(e,t){t=0===t?0:t||10;var r=UN(e).toHsl();return r.l-=t/100,r.l=cD(r.l),UN(r)}function QN(e,t){var r=UN(e).toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,UN(r)}function eD(e){var t=UN(e).toHsl();return t.h=(t.h+180)%360,UN(t)}function tD(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var r=UN(e).toHsl(),n=[UN(e)],i=360/t,o=1;o<t;o++)n.push(UN({h:(r.h+o*i)%360,s:r.s,l:r.l}));return n}function rD(e){var t=UN(e).toHsl(),r=t.h;return[UN(e),UN({h:(r+72)%360,s:t.s,l:t.l}),UN({h:(r+216)%360,s:t.s,l:t.l})]}function nD(e,t,r){t=t||6,r=r||30;var n=UN(e).toHsl(),i=360/r,o=[UN(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,o.push(UN(n));return o}function iD(e,t){t=t||6;for(var r=UN(e).toHsv(),n=r.h,i=r.s,o=r.v,a=[],s=1/t;t--;)a.push(UN({h:n,s:i,v:o})),o=(o+s)%1;return a}UN.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,r,n=this.toRgb();return e=n.r/255,t=n.g/255,r=n.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},setAlpha:function(e){return this._a=sD(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=HN(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=HN(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=zN(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=zN(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return WN(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,r,n,i){var o=[dD(Math.round(e).toString(16)),dD(Math.round(t).toString(16)),dD(Math.round(r).toString(16)),dD(hD(n))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*lD(this._r,255))+"%",g:Math.round(100*lD(this._g,255))+"%",b:Math.round(100*lD(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*lD(this._r,255))+"%, "+Math.round(100*lD(this._g,255))+"%, "+Math.round(100*lD(this._b,255))+"%)":"rgba("+Math.round(100*lD(this._r,255))+"%, "+Math.round(100*lD(this._g,255))+"%, "+Math.round(100*lD(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(aD[WN(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+GN(this._r,this._g,this._b,this._a),r=t,n=this._gradientType?"GradientType = 1, ":"";if(e){var i=UN(e);r="#"+GN(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,n=this._a<1&&this._a>=0;return!t&&n&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e)?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return UN(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(JN,arguments)},brighten:function(){return this._applyModification(XN,arguments)},darken:function(){return this._applyModification(ZN,arguments)},desaturate:function(){return this._applyModification(KN,arguments)},saturate:function(){return this._applyModification(qN,arguments)},greyscale:function(){return this._applyModification(YN,arguments)},spin:function(){return this._applyModification(QN,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(nD,arguments)},complement:function(){return this._applyCombination(eD,arguments)},monochromatic:function(){return this._applyCombination(iD,arguments)},splitcomplement:function(){return this._applyCombination(rD,arguments)},triad:function(){return this._applyCombination(tD,[3])},tetrad:function(){return this._applyCombination(tD,[4])}},UN.fromRatio=function(e,t){if("object"==LN(e)){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]="a"===n?e[n]:fD(e[n]));e=r}return UN(e,t)},UN.equals=function(e,t){return!(!e||!t)&&UN(e).toRgbString()==UN(t).toRgbString()},UN.random=function(){return UN.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},UN.mix=function(e,t,r){r=0===r?0:r||50;var n=UN(e).toRgb(),i=UN(t).toRgb(),o=r/100;return UN({r:(i.r-n.r)*o+n.r,g:(i.g-n.g)*o+n.g,b:(i.b-n.b)*o+n.b,a:(i.a-n.a)*o+n.a})},UN.readability=function(e,t){var r=UN(e),n=UN(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)},UN.isReadable=function(e,t,r){var n,i,o=UN.readability(e,t);switch(i=!1,n=function(e){var t,r;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA"),"small"!==r&&"large"!==r&&(r="small"),{level:t,size:r}}(r),n.level+n.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},UN.mostReadable=function(e,t,r){var n,i,o,a,s=null,l=0;i=(r=r||{}).includeFallbackColors,o=r.level,a=r.size;for(var c=0;c<t.length;c++)(n=UN.readability(e,t[c]))>l&&(l=n,s=UN(t[c]));return UN.isReadable(e,s,{level:o,size:a})||!i?s:(r.includeFallbackColors=!1,UN.mostReadable(e,["#fff","#000"],r))};var oD=UN.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},aD=UN.hexNames=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}(oD);function sD(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function lD(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function cD(e){return Math.min(1,Math.max(0,e))}function uD(e){return parseInt(e,16)}function dD(e){return 1==e.length?"0"+e:""+e}function fD(e){return e<=1&&(e=100*e+"%"),e}function hD(e){return Math.round(255*parseFloat(e)).toString(16)}function pD(e){return uD(e)/255}var gD,mD,vD,yD=(mD="[\\s|\\(]+("+(gD="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+gD+")[,|\\s]+("+gD+")\\s*\\)?",vD="[\\s|\\(]+("+gD+")[,|\\s]+("+gD+")[,|\\s]+("+gD+")[,|\\s]+("+gD+")\\s*\\)?",{CSS_UNIT:new RegExp(gD),rgb:new RegExp("rgb"+mD),rgba:new RegExp("rgba"+vD),hsl:new RegExp("hsl"+mD),hsla:new RegExp("hsla"+vD),hsv:new RegExp("hsv"+mD),hsva:new RegExp("hsva"+vD),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function bD(e){return!!yD.CSS_UNIT.exec(e)}const _D={...R.themeToken,"@yuque-color-table-bg":"#FAFAFA","@yuque-color-table-darg":"#D8DAD9","@yuque-color-table-temp":"#F9EFCD","@yuque-color-table-header-border":"#E7E9E8"},wD={...R.themeDarkToken,"@yuque-color-table-bg":"#141414","@yuque-color-table-darg":"#404040","@yuque-color-table-header-border":"#373838"};var CD=(e=>(e.default="default",e.dark="dark",e))(CD||{});const ED=$i.defineToken("ThemeContribution");var SD=Object.defineProperty,kD=Object.getOwnPropertyDescriptor,xD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SD(t,r,o),o};let OD=class{getProvider(){const e=this.themeProvider.getContributions(),t=e[e.length-1];return null==t?void 0:t.registerTheme()}getThemeManager(){var e;return this._themeManager?this._themeManager:(this._themeManager=null==(e=this.getProvider())?void 0:e.getThemeManager(),this._themeManager||new T.DefaultThemeManager)}};xD([wh(ED)],OD.prototype,"themeProvider",2),OD=xD([io()],OD);var ID=Object.defineProperty,RD=Object.getOwnPropertyDescriptor,TD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?RD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ID(t,r,o),o};let AD=class{isCurrentInDarkTheme(){const e=this._themeRegistry.getThemeManager();return(null==e?void 0:e.current)===M.Theme.dark}getCurrentTheme(){const e=this._themeRegistry.getThemeManager();return null==e?void 0:e.current}toThemeColor(e){const t=this._themeRegistry.getThemeManager();if(!e)return e;if(e.toLowerCase().startsWith("@"))return"dark"===(null==t?void 0:t.current)?wD[e]:_D[e];if(e.toLowerCase().startsWith("fade")){const[,t,r]=e.match(/^fade\((.*),(.*)\)$/);return Object(A.fade)(this.toThemeColor(t.trim()),function(e){return e.endsWith("%")?parseFloat(e.replace("%",""))/100:parseFloat(e)}(r.trim()))}return(null==t?void 0:t.transformColor(CD.default,null==t?void 0:t.current,e))||e}transToThemeColor(e){const t=this._themeRegistry.getThemeManager();return e&&t&&t?this.isCurrentInDarkTheme()?t.transformColor(M.Theme.default,M.Theme.dark,e):t.getColor(e,CD.default):e}toNormalColor(e){const t=this._themeRegistry.getThemeManager();return e&&((null==t?void 0:t.transformColor(null==t?void 0:t.current,CD.default,e))||e)}addThemeChangeListener(e){const t=this._themeRegistry.getThemeManager();return null==t?void 0:t.onChange(e)}};TD([ao(OD)],AD.prototype,"_themeRegistry",2),AD=TD([io()],AD);var MD=Object.defineProperty,ND=Object.getOwnPropertyDescriptor,DD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ND(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&MD(t,r,o),o};const PD={};let jD=class{constructor(){this._themeCache={},this._isColor=e=>e.toLowerCase().startsWith("@")||e.toLowerCase().startsWith("#")||e.toLowerCase().startsWith("rgb(")||e.toLowerCase().startsWith("rgba(")||e.toLowerCase().startsWith("fade(")}_getThemeValue(e){if(this._isColor(e))return this._themeHelper.toThemeColor(e);const t=e.split(".").reduce(((e,t)=>e?e[t]:null),PD);if(null==t)return null;const r=e=>null==e?e:"string"==typeof e&&this._isColor(e)?this._themeHelper.toThemeColor(e):("object"==typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((t=>{e[t]=r(e[t])})),e);return r(t)}getThemeValue(e){let t=e;const r=this._themeRegistry.getThemeManager();if(!t)return null;const n=(null==r?void 0:r.current)||"light";n&&(t=n+"$"+t);const i=this._themeCache[t];if(i)return i;const o=this._getThemeValue(e);return this._themeCache[t]=o,o}getCurrent(){return this._themeHelper.getCurrentTheme()}onChange(e){this._themeRegistry.getThemeManager().onChange(e)}};DD([ao(OD)],jD.prototype,"_themeRegistry",2),DD([ao(AD)],jD.prototype,"_themeHelper",2),jD=DD([io()],jD);const FD=xo().contribution(ED).register(jD).register(OD).register(AD),VD={"#FFA39E":"#FBD3D0","#FFEC3D":"#F7E9BC","#91D5FF":"#C4E4F5","#FFADD2":"#E4F7D2","#FFD591":"#E8D5CB","#87E8DE":"#C0EBE5","#D3ADF7":"#DBCEF5","#FFBB96":"#E8E8E8","#B7EB8F":"#E5EDCA","#ADC6FF":"#C2CDF0"},LD=["#F1A2AB","#F5D480","#C1E77E","#82EDC0","#81DFE4","#81BBF8","#96A7FD","#BA9BF2","#DBC39A","#BEC0BF"],$D=[["$label-back-color:0-0","$label-back-color:0-1","$label-back-color:0-2","$label-back-color:0-3","$label-back-color:0-4"],["$label-back-color:1-0","$label-back-color:1-1","$label-back-color:1-2","$label-back-color:1-3","$label-back-color:1-4"],["$label-back-color:2-0","$label-back-color:2-1","$label-back-color:2-2","$label-back-color:2-3","$label-back-color:2-4"],["$label-back-color:3-0","$label-back-color:3-1","$label-back-color:3-2","$label-back-color:3-3","$label-back-color:3-4"]],BD={labelColor:[["@yuque-green-1","@yellow-1","@blue-1","@yuque-grey-3","@red-1"],["@brown-1","@cyan-1","@purple-1","@pea-green-1","@sea-blue-1"],["@red-3","@yellow-3","@pea-green-3","@yuque-green-3","@cyan-3"],["@blue-3","@sea-blue-3","@purple-3","@brown-3","@yuque-grey-6"]],labelTextColor:[["@yuque-green-9","@yellow-9","@blue-9","@yuque-grey-9","@red-9"],["@brown-9","@cyan-9","@purple-9","@pea-green-9","@sea-blue-9"],["@red-9","@yellow-9","@pea-green-9","@yuque-green-9","@cyan-9"],["@blue-9","@sea-blue-9","@purple-9","@brown-9","@yuque-grey-9"]]},UD="$label-back-color:";var zD=Object.defineProperty,HD=Object.getOwnPropertyDescriptor,WD=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zD(t,r,o),o};const GD=new Map;let KD=class{static isLabelColorId(e){return jo(e)&&e.startsWith(UD)}static getColor(e){return jo(e)?KD.isLabelColorId(e)?e:VD[e.toUpperCase()]||e:""}static getNextColor(e=""){const t=KD.getColor(e),r=cc($D),n=r.indexOf(t);return n>=0?r[(n+1)%r.length]:r[0]}static getIndexesByBackColorId(e){if(e.startsWith(UD)){const[t,r]=e.split(UD),[n,i]=r.split("-"),[o,a]=[Number(n),Number(i)];return[o,a]}return[0,0]}getColorByBackColorId(e){const t="@yuque-color-bg-primary";if(!e.startsWith(UD))return this._themeHelper.transToThemeColor(t);const[r,n]=KD.getIndexesByBackColorId(e),i=BD.labelColor[r][n]||t;return this._themeHelper.transToThemeColor(i)}getTextColorByBackColorId(e){const t="@yuque-color-text-primary";if(!e.startsWith(UD))return this._themeHelper.transToThemeColor(t);const[r,n]=KD.getIndexesByBackColorId(e),i=BD.labelTextColor[r][n]||t;return this._themeHelper.transToThemeColor(i)}getByIndex(e){const t=cc($D);return t[e%t.length]}getRenderColor(e){const t=`labelColor:${this._themeHelper.getCurrentTheme()}:${e}`,r=GD.get(t);if(r)return r;const n=KD.getColor(e);let i="";return i=KD.isLabelColorId(n)?this.getColorByBackColorId(n):this._themeHelper.transToThemeColor(n),GD.set(t,i),i}getRenderTextColor(e){const t=`labelTextColor:${this._themeHelper.getCurrentTheme()}:${e}`,r=GD.get(t);if(r)return r;let n="";return n=e?KD.isLabelColorId(e)?this.getTextColorByBackColorId(e):this._themeHelper.isCurrentInDarkTheme()||(e=>UN(e).getBrightness()<200)(e)&&!LD.includes(e)?"#fff":"rgba(0,0,0,0.65)":this._themeHelper.transToThemeColor("@yuque-color-text-primary"),GD.set(t,n),n}};WD([ao(AD)],KD.prototype,"_themeHelper",2),KD=WD([io()],KD);const qD=xo().register(KD),YD=xo().register(Ah);var JD=Object.defineProperty,XD=Object.getOwnPropertyDescriptor;let ZD=class extends lI{get model(){return this._model.fieldSelectModel}get type(){return ZD.type}get baseType(){return ZD.baseType}_getNewOptionColor(e){return e?e.color?KD.getNextColor(e.color):"":KD.getNextColor()}validate(e){return!!e}transform(e,t){if(t){const r=this._model.fieldOptionModel.find({field_uuid:t});for(const t of r)if(t.get("name")===e||t.get("uuid")===e)return{value:t.get("uuid")};const n=To(6),i=r.get(r.length-1),o={uuid:n,field_uuid:t,name:e.slice(0,cS.MAX_LENGTH),color:i&&this._getNewOptionColor(i.toJSON())};return this._model.fieldOptionModel.create(o),{value:n}}return{value:e}}formatted(e,t){if(!e)return"";if(!t)return Nd(e)?e:"";const r=this._getOptionValue(t,e);return(null==r?void 0:r.get("name"))||""}_getOptionValue(e,t){const r=this._model.fieldOptionModel.find({field_uuid:e});for(const e of r)if(e.get("uuid")===t)return e}keyValue(e){return e||null}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value,e)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t});let n=null;r&&(n=r.get("value"));const i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),updated_at:i.get("updated_at"),value:n}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r,e))}setCell(e,t,r){if(r){if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value}),this._upsertModelCell(e,t,r.value)}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>(this._upsertModelCell(t,e.recordId,e.value),{uuid:e.uuid,field_uuid:t,record_uuid:e.recordId,value:e.value}))))}};ZD.type=pE.SELECT,ZD.baseType=gE.SELECT,ZD=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?XD(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JD(t,r,o),o})([io()],ZD);var QD=Object.defineProperty,eP=Object.getOwnPropertyDescriptor,tP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?eP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&QD(t,r,o),o};let rP=class{static pluginModule(){return xo().register(ZD).register(this)}init(e){e.registerField(this._selectField)}};rP.pluginName="kernel-field-select",tP([ao(ZD)],rP.prototype,"_selectField",2),rP=tP([io({contrib:nR})],rP);var nP=Object.defineProperty,iP=Object.getOwnPropertyDescriptor;let oP=class extends lI{get model(){return this._model.fieldSelectModel}get type(){return oP.type}get baseType(){return oP.baseType}_getNewOptionColor(e){return e?e.color?KD.getNextColor(e.color):"":KD.getNextColor()}validate(e){return!0}transform(e,t){if(t){const r=this._model.fieldOptionModel.find({field_uuid:t});if(Array.isArray(e)){const n=[];for(const i of e){const e=Lp(r,(e=>e.get("name")===i));if(e>=0)n.push({value:r.get(e).get("uuid")});else{const e=To(6),o=r.get(r.length-1),a={uuid:e,field_uuid:t,name:(null==i?void 0:i.slice(0,cS.MAX_LENGTH))||"",color:this._getNewOptionColor(null==o?void 0:o.toJSON())};this._model.fieldOptionModel.create(a),n.push({value:a.uuid})}}return{value:n}}for(const t of r)if(t.get("name")===e||t.get("uuid")===e)return{value:[t.get("uuid")]};const n=To(6),i=r.get(r.length-1),o={uuid:n,field_uuid:t,name:(null==e?void 0:e.slice(0,cS.MAX_LENGTH))||"",color:this._getNewOptionColor(null==i?void 0:i.toJSON())};return this._model.fieldOptionModel.create(o),{value:[n]}}return{value:[e]}}formatted(e,t){if(null==e)return"";if(t){return Bp(this._model.fieldOptionModel.find({field_uuid:t,uuid:e}),(e=>e.get("name"))).join(",")}return Array.isArray(e)?e.join(","):""}getFieldOptionName(e,t){if(null==e)return[];if(t){return Bp(this._model.fieldOptionModel.find({field_uuid:t,uuid:e}),(e=>e.get("name")))}return[]}keyValue(e){return Array.isArray(e)?e.join(","):e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value,e)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.find({field_uuid:e,record_uuid:t});let n=null;if(r.length>0){n=[];for(const e of r)e.get("value")&&n.push(e.get("value"))}const i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),updated_at:i.get("updated_at"),formatValue:i.get("format_value"),value:n}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r,e))}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n)return void this._upsertModelCell(e,t,r.value);const i=n.map((r=>{const n=Lo(r)?null:"string"==typeof r?r:r.value;return{field_uuid:e,record_uuid:t,value:n}}));this.model.bulkCreate(i),this._upsertModelCell(e,t,i.map((e=>e.value)))}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{const r=(e.value||[]).map((r=>{const n=Lo(r)?null:"string"==typeof r?r:r.value;return{field_uuid:t,record_uuid:e.recordId,value:n}}));n=n.concat(r),this._upsertModelCell(t,e.recordId,r.map((e=>e.value)))})),this.model.bulkCreate(n)}};oP.type=pE.MULTI_SELECT,oP.baseType=gE.SELECT,oP=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?iP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nP(t,r,o),o})([io()],oP);var aP=Object.defineProperty,sP=Object.getOwnPropertyDescriptor,lP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&aP(t,r,o),o};let cP=class{static pluginModule(){return xo().register(oP).register(this)}init(e){e.registerField(this._multiSelectField)}};cP.pluginName="kernel-field-multi-select",lP([ao(oP)],cP.prototype,"_multiSelectField",2),cP=lP([io({contrib:nR})],cP);var uP=Object.defineProperty,dP=Object.getOwnPropertyDescriptor;let fP=class extends lI{constructor(){super(...arguments),this.strict=!0}get model(){return this._model.fieldNumberModel}get type(){return fP.type}get baseType(){return fP.baseType}get rules(){return[{validator:(e,t)=>""===t||null==t||Pf(t),errorMsg:Ph("数字类型只能输入数字")}]}validate(e){return null==e||mh(String(e),{precision:fP.DECIMAL_PRECISION,scale:fP.DECIMAL_SCALE})}transform(e){return mh(e,{precision:fP.DECIMAL_PRECISION,scale:fP.DECIMAL_SCALE})?{value:e}:null}formatted(e){return null==e?"":String(e)}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=null==r?void 0:r.get("value"),i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),value:null==r?void 0:r.get("value"),verify:i.get("verify"),errorMessage:i.get("verify_message"),updated_at:i.get("updated_at")}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){const n=this.getVerify(r);this.updateModelCell(e,t,this.formatted(r),n.verify,n.errorMessage)}setCell(e,t,r){if(r){if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);this.strict&&!this.getVerify(r.value).verify||(this.model.upsert({field_uuid:e,record_uuid:r.recordId},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value}),this._upsertModelCell(e,t,r.value))}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>(this._upsertModelCell(t,e.recordId,e.value),{uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};fP.type=pE.NUMBER,fP.baseType=gE.NUMBER,fP.DECIMAL_PRECISION=27,fP.DECIMAL_SCALE=9,fP=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uP(t,r,o),o})([io()],fP);var hP=Object.defineProperty,pP=Object.getOwnPropertyDescriptor,gP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hP(t,r,o),o};let mP=class{static pluginModule(){return xo().register(fP).register(this)}init(e){e.registerField(this._numberField)}};mP.pluginName="kernel-field-number",gP([ao(fP)],mP.prototype,"_numberField",2),mP=gP([io({contrib:nR})],mP);var vP=Object.defineProperty,yP=Object.getOwnPropertyDescriptor;let bP=class extends lI{get model(){return this._model.fieldUriModel}get type(){return bP.type}get baseType(){return bP.baseType}validate(e){return!(!e||null!=e&&e.some((e=>null==(null==e?void 0:e.uid)||null==(null==e?void 0:e.name)||null==(null==e?void 0:e.login))))}transform(e){if("string"==typeof e)return null;const t=[];if(Array.isArray(e))for(const r of e)r.uid&&r.name&&r.login&&r.icon&&t.push({uid:r.uid,name:r.name,icon:r.icon,login:r.login});return 0===t.length?null:{value:t}}formatted(e){return null==e?"":null==e?void 0:e.map((e=>e.name)).join(",")}keyValue(e){return e?e.map((e=>`${e.uid}`)).join(","):null}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=Bp(this.model.find({field_uuid:e,record_uuid:t}),(e=>{const t=this._model.userModel.findOne({uid:String(e.get("uid"))});if(t)return{uuid:e.get("uuid"),uid:e.get("uid"),name:t.get("name")||e.get("name"),login:t.get("login"),icon:t.get("icon")||e.get("icon")}})).filter((e=>!!e)),n=this._safeGetCell(e,t,r);return{uuid:n.get("uuid"),fieldId:n.get("field_uuid"),recordId:n.get("record_uuid"),fieldType:n.get("field_type"),formatValue:n.get("format_value"),updated_at:n.get("updated_at"),value:r}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r))}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n||0===n.length)return void this._upsertModelCell(e,t,r.value);let i=n.map((r=>(this._model.userModel.findOne({uid:String(r.uid)})||this._model.userModel.create({uid:r.uid,name:r.name,icon:r.icon,login:r.login}),{uuid:r.uuid,field_uuid:e,record_uuid:t,uid:r.uid,name:r.name,icon:r.icon,login:r.login})));i=af(i,(e=>`${null==e?void 0:e.uid}-${null==e?void 0:e.field_uuid}-${e.record_uuid}`)),this.model.bulkCreate(i),this._upsertModelCell(e,t,i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{const r=e.value?e.value.map((r=>(this._model.userModel.findOne({uid:String(r.uid)})||this._model.userModel.create({uid:r.uid,name:r.name,icon:r.icon,login:r.login}),{uuid:r.uuid,field_uuid:t,record_uuid:e.recordId,uid:r.uid,name:r.name,icon:r.icon,login:r.login}))):[];n=n.concat(r),this._upsertModelCell(t,e.recordId,r)})),n=af(n,(e=>`${null==e?void 0:e.uid}-${null==e?void 0:e.field_uuid}-${e.record_uuid}`)),this.model.bulkCreate(n)}};bP.type=pE.MENTION,bP.baseType=gE.URI,bP.MAX_LENGTH=128,bP=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?yP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vP(t,r,o),o})([io()],bP);var _P=Object.defineProperty,wP=Object.getOwnPropertyDescriptor,CP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_P(t,r,o),o};let EP=class{static pluginModule(){return xo().register(bP).register(this)}init(e){e.registerField(this._mentionField)}};EP.pluginName="kernel-field-mention",CP([ao(bP)],EP.prototype,"_mentionField",2),EP=CP([io({contrib:nR})],EP);var SP=Object.defineProperty,kP=Object.getOwnPropertyDescriptor;let xP=class extends lI{get model(){return this._model.fieldDateModel}get type(){return xP.type}get baseType(){return xP.baseType}validate(e){return!!e&&!!dh(e)}transform(e){try{return{value:bf(e).toString()}}catch{return null}}formatted(e){return null==e||""===e?"":Pf(e)?13===String(e).length?bf(Number(e)).format(xP.format):bf.unix(Number(e)).format(xP.format):bf(e).format(xP.format)}keyValue(e){if(!e)return;const t=this.formatted(e);return bf(t).toDate().getTime()}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=null==r?void 0:r.get("value"),i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),value:null==r?void 0:r.get("value"),formatValue:i.get("format_value"),updated_at:i.get("updated_at")}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r))}setCell(e,t,r){if(!r)return;if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);if(!this.validate(r.value)||!r)return;const n=Vo(r.value)?r.value.getTime():r.value;this.model.upsert({field_uuid:e,record_uuid:r.recordId},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:n}),this._upsertModelCell(e,t,n)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>{if(!this.validate(e.value||""))return null;const r=Vo(e.value)?e.value.getTime():e.value;return this._upsertModelCell(t,e.recordId,r),{uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:r}})).filter((e=>!!e)))}};xP.type=pE.DATE,xP.baseType=gE.DATE,xP.format="YYYY-MM-DD",xP=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?kP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SP(t,r,o),o})([io()],xP);var OP=Object.defineProperty,IP=Object.getOwnPropertyDescriptor,RP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?IP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&OP(t,r,o),o};let TP=class{static pluginModule(){return xo().register(xP).register(this)}init(e){e.registerField(this._dateField)}};TP.pluginName="kernel-field-date",RP([ao(xP)],TP.prototype,"_dateField",2),TP=RP([io({contrib:nR})],TP);var AP=Object.defineProperty,MP=Object.getOwnPropertyDescriptor;let NP=class extends lI{get model(){return this._model.fieldBooleanModel}get type(){return NP.type}get baseType(){return NP.baseType}validate(e){return Fd(e)}transform(e){return!e||"1"!==e&&"是"!==e&&"true"!==e&&"yes"!==e.toLowerCase()&&"✅"!==e?null:{value:!0}}formatted(e){return null==e?"false":e?"true":"false"}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=(null==r?void 0:r.get("value"))||!1,i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),value:(null==r?void 0:r.get("value"))||!1,updated_at:i.get("updated_at")}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r))}setCell(e,t,r){!r||(this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value}),this._upsertModelCell(e,t,r.value))}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>(this._upsertModelCell(t,e.recordId,e.value),{field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};NP.type=pE.CHECKBOX,NP.baseType=gE.BOOLEAN,NP=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?MP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&AP(t,r,o),o})([io()],NP);var DP=Object.defineProperty,PP=Object.getOwnPropertyDescriptor,jP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?PP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&DP(t,r,o),o};let FP=class{static pluginModule(){return xo().register(NP).register(this)}init(e){e.registerField(this._checkboxField)}};FP.pluginName="kernel-field-checkbox",jP([ao(NP)],FP.prototype,"_checkboxField",2),FP=jP([io({contrib:nR})],FP);var VP=Object.defineProperty,LP=Object.getOwnPropertyDescriptor;let $P=class extends lI{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return $P.type}get baseType(){return $P.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":e.name||""}keyValue(e){return null==e?void 0:e.uid}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t}),n=this._model.userModel.findOne({uid:String(null==r?void 0:r.get("creator_id"))}),i=n?{name:n.get("name"),icon:n.get("icon"),uuid:n.get("uuid"),uid:n.get("uid"),login:n.get("login")}:null;return{uuid:null==r?void 0:r.get("uuid"),fieldId:e,recordId:t,fieldType:this.type,updated_at:null==r?void 0:r.get("updated_at"),value:i,formatValue:i?this.formatted(i):""}}};$P.type=pE.USER_ID,$P.baseType=gE.SYSTEM,$P=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?LP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&VP(t,r,o),o})([io()],$P);var BP=Object.defineProperty,UP=Object.getOwnPropertyDescriptor,zP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?UP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BP(t,r,o),o};let HP=class{static pluginModule(){return xo().register($P).register(this)}init(e){e.registerField(this._userIdField)}};HP.pluginName="kernel-field-user-id",zP([ao($P)],HP.prototype,"_userIdField",2),HP=zP([io({contrib:nR})],HP);var WP=Object.defineProperty,GP=Object.getOwnPropertyDescriptor;let KP=class extends lI{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return KP.type}get baseType(){return KP.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":(Pf(e)&&(e=new Date(Number(e))),bf(e).format(KP.format))}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t});return{uuid:null==r?void 0:r.get("uuid"),fieldId:e,recordId:t,fieldType:this.type,value:null==r?void 0:r.get("created_at"),formatValue:this.formatted(null==r?void 0:r.get("created_at")),updated_at:null==r?void 0:r.get("updated_at")}}};KP.type=pE.CREATED_AT,KP.baseType=gE.SYSTEM,KP.format="YYYY-MM-DD HH:mm:ss",KP=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?GP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WP(t,r,o),o})([io()],KP);var qP=Object.defineProperty,YP=Object.getOwnPropertyDescriptor,JP=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?YP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qP(t,r,o),o};let XP=class{static pluginModule(){return xo().register(KP).register(this)}init(e){e.registerField(this._createdAtField)}};XP.pluginName="kernel-field-created-at",JP([ao(KP)],XP.prototype,"_createdAtField",2),XP=JP([io({contrib:nR})],XP);var ZP=Object.defineProperty,QP=Object.getOwnPropertyDescriptor;let ej=class extends lI{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return ej.type}get baseType(){return ej.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":e.name||""}keyValue(e){return null==e?void 0:e.uid}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t}),n=this._model.userModel.findOne({uid:String(null==r?void 0:r.get("modifier_id"))}),i=n?{name:n.get("name"),icon:n.get("icon"),uuid:n.get("uuid"),login:n.get("login"),uid:n.get("uid")}:null;return{uuid:r.get("uuid"),fieldId:e,recordId:t,fieldType:this.type,value:i,formatValue:i?this.formatted(i):"",updated_at:r.get("updated_at")}}};ej.type=pE.MODIFIER_ID,ej.baseType=gE.SYSTEM,ej=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?QP(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ZP(t,r,o),o})([io()],ej);var tj=Object.defineProperty,rj=Object.getOwnPropertyDescriptor,nj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tj(t,r,o),o};let ij=class{static pluginModule(){return xo().register(ej).register(this)}init(e){e.registerField(this._modifierIdField)}};ij.pluginName="kernel-field-modifier-id",nj([ao(ej)],ij.prototype,"_modifierIdField",2),ij=nj([io({contrib:nR})],ij);var oj=Object.defineProperty,aj=Object.getOwnPropertyDescriptor;let sj=class extends lI{constructor(){super(...arguments),this.editDisable=!0}get model(){return null}get type(){return sj.type}get baseType(){return sj.baseType}validate(){return!0}transform(){return null}formatted(e){return null==e?"":(Pf(e)&&(e=new Date(Number(e))),bf(e).format(sj.format))}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this._model.recordModel.findOne({uuid:t}),n=r.get("updated_at");return{uuid:null==r?void 0:r.get("uuid"),fieldId:e,recordId:t,fieldType:this.type,updated_at:n,value:n,formatValue:this.formatted(n)}}};sj.type=pE.UPDATED_AT,sj.baseType=gE.SYSTEM,sj.format="YYYY-MM-DD HH:mm:ss",sj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?aj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oj(t,r,o),o})([io()],sj);var lj=Object.defineProperty,cj=Object.getOwnPropertyDescriptor,uj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lj(t,r,o),o};let dj=class{static pluginModule(){return xo().register(sj).register(this)}init(e){e.registerField(this._updatedAtField)}};dj.pluginName="kernel-field-updated-at",uj([ao(sj)],dj.prototype,"_updatedAtField",2),dj=uj([io({contrib:nR})],dj);var fj=Object.defineProperty,hj=Object.getOwnPropertyDescriptor;let pj=class extends lI{get model(){return this._model.fieldStringModel}get type(){return pj.type}get baseType(){return pj.baseType}validate(e){return null==e||(!((null==e?void 0:e.length)>pj.MAX_LENGTH)||(e=e.substring(0,pj.MAX_LENGTH),!1))}transform(e){return{value:e}}formatted(e){return null==e?"":e.replace(/[\n\t\r]/gi,"").trim()}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=null==r?void 0:r.get("value"),i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),updated_at:i.get("updated_at"),value:null==r?void 0:r.get("value")}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r))}setCell(e,t,r){if(r){if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value}),this._upsertModelCell(e,t,r.value)}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>(this._upsertModelCell(t,e.recordId,e.value),{uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};pj.type=pE.TEXT,pj.baseType=gE.STRING,pj.MAX_LENGTH=5e3,pj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?hj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fj(t,r,o),o})([io()],pj);var gj=Object.defineProperty,mj=Object.getOwnPropertyDescriptor,vj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gj(t,r,o),o};let yj=class{static pluginModule(){return xo().register(pj).register(this)}init(e){e.registerField(this._textField)}};yj.pluginName="kernel-field-text",vj([ao(pj)],yj.prototype,"_textField",2),yj=vj([io({contrib:nR})],yj);var bj=Object.defineProperty,_j=Object.getOwnPropertyDescriptor;let wj=class extends lI{get model(){return this._model.fieldUriModel}get type(){return wj.type}get baseType(){return wj.baseType}validate(e){if(null==e)return!0;if(!Array.isArray(e))return!1;for(const t of e){if(null==t.name||null==t.src||null==t.size||null==t.width||null==t.height)return!1;const e=t.name;if(e.length>wj.MAX_LENGTH&&(t.name=e.substring(0,wj.MAX_LENGTH)),!uh(t.src))return!1}return!0}transform(e){if(!e||"string"==typeof e)return null;let t=[];if(Array.isArray(e)){if(t=e.map((e=>this._transformItem(e))),!Array.isArray(t))return null}else if(Fo(e)){if(t=this._transformItem(e),!t)return null;t=[t]}return t=t.filter(Boolean),0===t.length?null:{value:t}}_transformItem(e){return e&&"string"!=typeof e&&null!=e.name&&null!=e.src&&null!=e.size&&null!=e.width&&null!=e.height?{name:e.name,src:e.src,mime:e.mime,size:e.size,width:e.width,height:e.height}:null}formatted(e){return null==e?"":null==e?void 0:e.map((e=>e.name)).join(",")}keyValue(e){return null==e?null:e.map((e=>`${e.name}|${e.src}`)).join(",")}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=Bp(this.model.find({field_uuid:e,record_uuid:t}),(e=>({name:e.get("name"),uid:e.get("uid"),src:e.get("src"),mime:e.get("mime"),size:e.get("size"),icon:e.get("icon"),width:e.get("width"),height:e.get("height")}))),n=this._safeGetCell(e,t,r);return{uuid:n.get("uuid"),fieldId:n.get("field_uuid"),recordId:n.get("record_uuid"),fieldType:n.get("field_type"),formatValue:n.get("format_value"),updated_at:n.get("updated_at"),value:r}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r))}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n)return void this._upsertModelCell(e,t,r.value);const i=n.map((r=>({uuid:r.uuid,field_uuid:e,record_uuid:t,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height})));this.model.bulkCreate(i),this._upsertModelCell(e,t,i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{const r=e.value?e.value.map((r=>({uuid:r.uuid,field_uuid:t,record_uuid:e.recordId,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height}))):[];n=n.concat(r),this._upsertModelCell(t,e.recordId,r)})),this.model.bulkCreate(n)}};wj.type=pE.IMAGE,wj.baseType=gE.URI,wj.MAX_LENGTH=128,wj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?_j(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bj(t,r,o),o})([io()],wj);var Cj=Object.defineProperty,Ej=Object.getOwnPropertyDescriptor,Sj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ej(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cj(t,r,o),o};let kj=class{static pluginModule(){return xo().register(wj).register(this)}init(e){e.registerField(this._imageField)}};kj.pluginName="kernel-field-image",Sj([ao(wj)],kj.prototype,"_imageField",2),kj=Sj([io({contrib:nR})],kj);var xj=Object.defineProperty,Oj=Object.getOwnPropertyDescriptor;let Ij=class extends lI{get model(){return this._model.fieldUriModel}get type(){return Ij.type}get baseType(){return Ij.baseType}validate(e){if(null==e)return!0;if(!Array.isArray(e))return!1;for(const t of e){if(null==t.name||null==t.src||null==t.size)return!1;const e=t.name;if(e.length>Ij.MAX_LENGTH&&(t.name=e.substring(0,Ij.MAX_LENGTH)),!uh(t.src))return!1}return!0}transform(e){if(!e||"string"==typeof e)return null;let t=[];if(Array.isArray(e)){if(t=e.map((e=>this._transformItem(e))),!Array.isArray(t)||0===t.length)return null}else if(Fo(e)){if(t=this._transformItem(e),!t)return null;t=[t]}return t=t.filter(Boolean),0===t.length?null:{value:t}}_transformItem(e){return"string"==typeof e||null==e.name||null==e.src||null==e.size?null:{name:e.name,src:e.src,mime:e.mime,size:e.size,width:e.width,height:e.height}}formatted(e){return null==e?"":null==e?void 0:e.map((e=>e.name)).join(",")}keyValue(e){return e?e.map((e=>`${e.name}|${e.src}`)).join(","):null}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=Bp(this.model.find({field_uuid:e,record_uuid:t}),(e=>({name:e.get("name"),uid:e.get("uid"),src:e.get("src"),mime:e.get("mime"),size:e.get("size"),icon:e.get("icon")}))),n=this._safeGetCell(e,t,r);return{uuid:n.get("uuid"),fieldId:n.get("field_uuid"),recordId:n.get("record_uuid"),fieldType:n.get("field_type"),formatValue:n.get("format_value"),updated_at:n.get("updated_at"),value:r}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){this.updateModelCell(e,t,this.formatted(r))}setCell(e,t,r){if(!r)return;const n=r.value;if(this.model.remove({field_uuid:e,record_uuid:t}),!n)return void this._upsertModelCell(e,t,r.value);const i=n.map((r=>({uuid:r.uuid,field_uuid:e,record_uuid:t,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height})));this.model.bulkCreate(i),this._upsertModelCell(e,t,i)}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r});let n=[];e.forEach((e=>{const r=e.value?e.value.map((r=>({uuid:r.uuid,field_uuid:t,record_uuid:e.recordId,uid:r.uid,name:r.name,src:r.src,size:r.size,mime:r.mime,width:r.width,height:r.height}))):[];n=n.concat(r),this._upsertModelCell(t,e.recordId,r)})),this.model.bulkCreate(n)}};Ij.type=pE.FILE,Ij.baseType=gE.URI,Ij.MAX_LENGTH=128,Ij=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Oj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xj(t,r,o),o})([io()],Ij);var Rj=Object.defineProperty,Tj=Object.getOwnPropertyDescriptor,Aj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rj(t,r,o),o};let Mj=class{static pluginModule(){return xo().register(Ij).register(this)}init(e){e.registerField(this._fileField)}};Mj.pluginName="kernel-field-file",Aj([ao(Ij)],Mj.prototype,"_fileField",2),Mj=Aj([io({contrib:nR})],Mj);var Nj=Object.defineProperty,Dj=Object.getOwnPropertyDescriptor;let Pj=class extends lI{get model(){return this._model.fieldUriModel}get type(){return Pj.type}get baseType(){return Pj.baseType}get rules(){return[{validator:(e,t)=>!(!Lo(t)&&null!=t)||Af(t.src||t),errorMsg:Ph("输入格式有误")}]}validate(e){if(!e)return!0;const t=e.name,r=e.src;return!(!t||!r)&&((null==t?void 0:t.length)>Pj.MAX_LENGTH&&(e.name=t.substring(0,Pj.MAX_LENGTH)),!!uh(r))}transform(e){var t;if(!e)return null;let r=null;if("string"==typeof e){if(uh(e))return r={name:e,src:e},{value:r};let n;try{n=new URL(e)}catch{try{n=new URL("http://"+e)}catch{return{value:{name:e,src:(null==(t=globalThis.location)?void 0:t.href)||"https://www.yuque.com"}}}}const i=n.host.split(".");return 1===i.length&&(n.host=i[0]+".com"),r={name:e,src:n.toString().replace(/\/$/gi,"")},{value:r}}return r={name:e.name||"",src:e.src||""},{value:r}}formatted(e){return null==e?"":e.name||""}keyValue(e){return e&&e.name&&e.src?`${e.name}|${e.src}`:""}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n={name:(null==r?void 0:r.get("name"))||"",src:(null==r?void 0:r.get("src"))||""},i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),verify:i.get("verify"),errorMessage:i.get("verify_message"),updated_at:i.get("updated_at"),value:n}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){const n=this.getVerify(r);this.updateModelCell(e,t,this.formatted(r),n.verify,n.errorMessage)}setCell(e,t,r){if(r){if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,name:r.value.name,src:r.value.src}),this._upsertModelCell(e,t,r.value)}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>{var r,n;return this._upsertModelCell(t,e.recordId,e.value),{uuid:e.uuid,field_uuid:t,record_uuid:e.recordId,name:null==(r=e.value)?void 0:r.name,src:null==(n=e.value)?void 0:n.src}})))}};Pj.type=pE.LINK,Pj.baseType=gE.URI,Pj.MAX_LENGTH=128,Pj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Dj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Nj(t,r,o),o})([io()],Pj);var jj=Object.defineProperty,Fj=Object.getOwnPropertyDescriptor,Vj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Fj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jj(t,r,o),o};let Lj=class{static pluginModule(){return xo().register(Pj).register(this)}init(e){e.registerField(this._linkField)}};Lj.pluginName="kernel-field-link",Vj([ao(Pj)],Lj.prototype,"_linkField",2),Lj=Vj([io({contrib:nR})],Lj);var $j=Object.defineProperty,Bj=Object.getOwnPropertyDescriptor;let Uj=class extends lI{get model(){return this._model.fieldStringModel}get type(){return Uj.type}get baseType(){return Uj.baseType}get rules(){return[{validator:(e,t)=>""===t||null==t||pf(t),errorMsg:Ph("请输入有效邮箱")}]}validate(e){if(null!=e)return!((null==e?void 0:e.length)>Uj.MAX_LENGTH||"string"==typeof e&&!nh(e))}transform(e){return{value:e}}formatted(e){return null==e?"":e}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=null==r?void 0:r.get("value"),i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),updated_at:i.get("updated_at"),value:null==r?void 0:r.get("value"),verify:i.get("verify"),errorMessage:i.get("verify_message")}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){const n=this.getVerify(r);this.updateModelCell(e,t,this.formatted(r),n.verify,n.errorMessage)}setCell(e,t,r){if(r){if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value}),this._upsertModelCell(e,t,r.value)}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>(this._upsertModelCell(t,e.recordId,e.value),{uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};Uj.type=pE.EMAIL,Uj.baseType=gE.STRING,Uj.MAX_LENGTH=128,Uj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$j(t,r,o),o})([io()],Uj);var zj=Object.defineProperty,Hj=Object.getOwnPropertyDescriptor,Wj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Hj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zj(t,r,o),o};let Gj=class{static pluginModule(){return xo().register(Uj).register(this)}init(e){e.registerField(this._emailField)}};Gj.pluginName="kernel-field-email",Wj([ao(Uj)],Gj.prototype,"_emailField",2),Gj=Wj([io({contrib:nR})],Gj);var Kj=Object.defineProperty,qj=Object.getOwnPropertyDescriptor;let Yj=class extends lI{get model(){return this._model.fieldStringModel}get type(){return Yj.type}get baseType(){return Yj.baseType}get rules(){return[{validator:(e,t)=>""===t||null==t||hf(t),errorMsg:Ph("请输入有效手机号")}]}validate(e){return null==e||!(e.length>Yj.MAX_LENGTH)}transform(e){return{value:e}}formatted(e){return null==e?"":e}keyValue(e){return e}getCellFormattedValue(e,t){const r=this.getCell(e,t);return this.formatted(null==r?void 0:r.value)}getCellKeyValue(e,t){const r=this.getCell(e,t);return this.keyValue(null==r?void 0:r.value)}getCell(e,t){const r=this.model.findOne({field_uuid:e,record_uuid:t}),n=null==r?void 0:r.get("value"),i=this._safeGetCell(e,t,n);return{uuid:i.get("uuid"),fieldId:i.get("field_uuid"),recordId:i.get("record_uuid"),fieldType:i.get("field_type"),formatValue:i.get("format_value"),value:n,verify:i.get("verify"),errorMessage:i.get("verify_message"),updated_at:i.get("updated_at")}}_safeGetCell(e,t,r){let n=this.getModelCell(e,t);return n||(this._upsertModelCell(e,t,r),n=this._model.cellModel.findOne({field_uuid:e,record_uuid:t})),n||new Kp}_upsertModelCell(e,t,r){const n=this.getVerify(r);this.updateModelCell(e,t,this.formatted(r),n.verify,n.errorMessage)}setCell(e,t,r){if(r){if(!r.value)return this.model.remove({field_uuid:e,record_uuid:t}),void this._upsertModelCell(e,t,r.value);this.model.upsert({field_uuid:e,record_uuid:t},{uuid:r.uuid,field_uuid:e,record_uuid:t,value:r.value}),this._upsertModelCell(e,t,r.value)}}bulkSetCell(e){const t=e[0].fieldId,r=e.map((e=>e.recordId));this.model.remove({field_uuid:t,record_uuid:r}),this.model.bulkCreate(e.map((e=>(this._upsertModelCell(t,e.recordId,e.value),{uuid:e.uuid,field_uuid:e.fieldId,record_uuid:e.recordId,value:e.value}))))}};Yj.type=pE.PHONE,Yj.baseType=gE.STRING,Yj.MAX_LENGTH=128,Yj=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?qj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Kj(t,r,o),o})([io()],Yj);var Jj=Object.defineProperty,Xj=Object.getOwnPropertyDescriptor,Zj=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xj(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jj(t,r,o),o};let Qj=class{static pluginModule(){return xo().register(Yj).register(this)}init(e){e.registerField(this._phoneField)}};Qj.pluginName="kernel-field-phone",Zj([ao(Yj)],Qj.prototype,"_phoneField",2),Qj=Zj([io({contrib:nR})],Qj);class eF extends PI{destroy(){}execute(e){return this.writeService.createFilter(e.viewId,e.filter),!0}}eF.commandName="createFilter";class tF extends PI{destroy(){}beforeExecute(e){return e.viewId||(e.viewId=this.readService.getActiveView().get("uuid")),e}execute(e){return this.writeService.removeFilter(e.filterId),!0}}tF.commandName="removeFilter";class rF extends PI{destroy(){}execute(e){return this.writeService.updateFilter(e.viewId,e.filter),!0}}rF.commandName="updateFilter";var nF=Object.defineProperty,iF=Object.getOwnPropertyDescriptor,oF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nF(t,r,o),o};let aF=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(eF.commandName,eF),this.commandService.registerCommand(tF.commandName,tF),this.commandService.registerCommand(rF.commandName,rF)}};aF.pluginName="kernel-filter",oF([ao(zI)],aF.prototype,"commandService",2),aF=oF([io({contrib:nR})],aF);class sF extends PI{destroy(){}beforeExecute(e){const t=e.optionId,r=this.readService.getFieldOption(t);return e.fieldId=r.get("field_uuid"),e}execute(e){return this.writeService.removeFieldOption(e.optionId),!0}}sF.commandName="removeFieldOption";class lF extends PI{destroy(){}execute(e){var t;const r=this.readService.getFieldOptions(e.fieldId)||[],n=null==(t=r.get(r.length-1))?void 0:t.get("uuid");return this.writeService.createFieldOption(e.fieldId,e.fieldOption,n),!0}}lF.commandName="createFieldOption";class cF extends PI{destroy(){}beforeExecute(e){const t=e.optionId,r=this.readService.getFieldOption(t);return e.fieldId=r.get("field_uuid"),e}execute(e){return this.writeService.updateFieldOption(e.optionId,e.fieldOption),!0}}cF.commandName="updateFieldOption";var uF=Object.defineProperty,dF=Object.getOwnPropertyDescriptor,fF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uF(t,r,o),o};let hF=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(lF.commandName,lF),this.commandService.registerCommand(cF.commandName,cF),this.commandService.registerCommand(sF.commandName,sF)}};hF.pluginName="kernel-group",fF([ao(zI)],hF.prototype,"commandService",2),hF=fF([io({contrib:nR})],hF);class pF extends PI{destroy(){}execute(e){return this.writeService.createSort(e.viewId,e.sort,!1),!0}}pF.commandName="createSort";class gF extends PI{destroy(){}execute(e){return this.writeService.removeSort(e.viewId),!0}}gF.commandName="removeSort";class mF extends PI{destroy(){}execute(e){return this.writeService.updateSort(e.viewId,e.sort,e.auto),!0}}mF.commandName="updateSort";var vF=Object.defineProperty,yF=Object.getOwnPropertyDescriptor,bF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vF(t,r,o),o};let _F=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(pF.commandName,pF),this.commandService.registerCommand(gF.commandName,gF),this.commandService.registerCommand(mF.commandName,mF)}};_F.pluginName="kernel-sort",bF([ao(zI)],_F.prototype,"commandService",2),_F=bF([io({contrib:nR})],_F);var wF=Object.defineProperty,CF=Object.getOwnPropertyDescriptor,EF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wF(t,r,o),o};let SF=class{static pluginModule(){return xo().contribution(ZM).register(nN).register(UR).register(lN).register(this)}init(){this._contentService.setProcessor(this._processor)}};SF.pluginName="kernel-process",EF([ao(xO)],SF.prototype,"_contentService",2),EF([ao(lN)],SF.prototype,"_processor",2),SF=EF([io({contrib:nR})],SF);class kF extends PI{constructor(){super(...arguments),this._bulkSetCellMap=new Map,this._targetRecordIndexCache=new Map,this._targetFieldIndexCache=new Map}destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.get("uuid")),e}execute(e){var t;const{pasteData:r,selection:n,colCount:i}=e,{cells:o}=r,{startRowIndex:a,startColIndex:s,rowCount:l,colCount:c}=n,u=l*c,d=o.length,f=o[0].length,h=d*f,p=1===h,g=p&&u>1,m=g?l:d,v=g?c:f,y=[],b=[];try{if(p&&!g){const e=o[0][0],t=this.readService.getCellByIndexes(a,s);if(b.push(null==t?void 0:t.recordId),!e||!t)return{code:-1,message:"fromCell, targetCell不存在 never"};if(zE.isSystemType(t.fieldType))return{code:1,message:Ph("系统字段不支持粘贴修改")};const r=this._getPasteCellDataToUpdate(e,t.fieldType,t.fieldId,t.recordId,a);this._setCell(t.recordId,t.fieldId,r,!1)}else{let r=0;for(let e=0;e<m;e++){const t=e+a,n=this._getRecordByIndex(t),i=null==n?void 0:n.get("record_uuid");i?b.push(i):r+=1}if(r>0){for(let e=0;e<r;e++)y.push(To(32));this.writeService.createEmptyRecord({uuid:y,viewId:e.viewId})}let n=0;for(let e=0;e<m;e++){const r=e+a,l=this._getRecordByIndex(r);if(!l)continue;const c=l.get("record_uuid");for(let a=0;a<v;a++){const l=a+s;if(l>=i)continue;const u=g?o[0][0]:null==(t=null==o?void 0:o[e])?void 0:t[a];if(!u)continue;const d=this._getFieldByIndex(l);if(!d)throw new Error("targetField不存在 never");if(zE.isSystemType(d.get("type"))){n++;continue}const f=d.get("uuid"),h=this._getPasteCellDataToUpdate(u,d.get("type"),f,c,r);this._setCell(c,f,h,!0)}}const l=[...this._bulkSetCellMap.keys()];if(l.length>0)for(const e of l){const t=this._bulkSetCellMap.get(e);t&&this.writeService.bulkSetCell(t)}if(n===h)return{code:1,message:Ph("系统字段不支持粘贴修改")}}}catch(e){let t="";return e instanceof Error?(t=e.message,console.error(e.stack)):t="string"==typeof e?e:"Unknown error",{code:-1,message:t}}finally{this._bulkSetCellMap.clear(),this._targetRecordIndexCache.clear(),this._targetFieldIndexCache.clear()}return{code:0,message:Ph("粘贴成功"),data:{createRecordIds:y,updateRecordIds:b}}}_setCell(e,t,r,n){const i=this.readService.getCell(t,e);if(!i)throw new Error("oldCell 不存在 never");const o={...i,value:r.cellValue};if(r.fromFieldId===r.toFieldId)if(n){let e=this._bulkSetCellMap.get(r.toFieldId)||[];e=e.concat(o),this._bulkSetCellMap.set(r.toFieldId,e)}else this.writeService.setCell(o);else r.fromFieldType&&this.writeService.safeSetCell(o,r.fromFieldType,r.toFieldType,r.fromFieldId,r.toFieldId)}_getPasteCellDataToUpdate(e,t,r,n,i){return{cellValue:e.value,toFieldType:t,toFieldId:r,toRecordId:n,toRecordIndex:i,fromFieldType:e.fieldType,fromFieldId:e.fieldId}}_getRecordByIndex(e){const t=this._targetRecordIndexCache.get(e);if(t)return t;const r=this.readService.getRecordByIndex(e);return r?(this._targetRecordIndexCache.set(e,r),r):null}_getFieldByIndex(e){const t=this._targetFieldIndexCache.get(e);if(t)return t;const r=this.readService.getFieldByIndex(e);return r?(this._targetFieldIndexCache.set(e,r),r):null}}kF.commandName="pasteUpdateRecords";var xF=Object.defineProperty,OF=Object.getOwnPropertyDescriptor,IF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?OF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xF(t,r,o),o};let RF=class{static pluginModule(){return xo().register(this)}init(e){this._commandService.registerCommand(kF.commandName,kF)}};RF.pluginName="kernel-clipboard",IF([ao(zI)],RF.prototype,"_commandService",2),RF=IF([io({contrib:nR})],RF);const TF=$i.defineToken("SelectionKernelPluginContribution");var AF=(e=>(e.NONE="none",e.CARET="caret",e.RANGE="range",e))(AF||{});class MF{constructor(e,t,r,n){this._row=e,this._column=t,this._rowCount=r,this._columnCount=n}static equal(e,t){return e===t||e._row===t._row&&e._column===t._column}get row(){return this._row}get column(){return this._column}get rowCount(){return this._rowCount}get columnCount(){return this._columnCount}get isAtRowStart(){return 0===this._row}get isAtRowEnd(){return this._row===this._rowCount-1}get isAtColumnStart(){return 0===this._column}get isAtColumnEnd(){return this._column===this._columnCount-1}get isAtStart(){return this.isAtRowStart&&this.isAtColumnStart}get isAtEnd(){return this.isAtRowEnd&&this.isAtColumnEnd}clone(){return new MF(this._row,this._column,this._rowCount,this._columnCount)}}var NF=Object.defineProperty,DF=Object.getOwnPropertyDescriptor,PF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&NF(t,r,o),o};let jF=class{static pluginModule(){return xo().contribution(TF).register(this).register(MF)}init(e){}};jF.pluginName="kernel-selection",PF([ao(zI)],jF.prototype,"commandService",2),jF=PF([io({contrib:nR})],jF);var FF=Object.defineProperty,VF=Object.getOwnPropertyDescriptor,LF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&FF(t,r,o),o};let $F=class{static pluginModule(){return xo().register(this)}init(){}};$F.pluginName="kernel-expand-record",LF([ao(zI)],$F.prototype,"commandService",2),$F=LF([io({contrib:nR})],$F);class BF extends PI{destroy(){}execute(e){return this.writeService.upsertStat(e.viewId,e.fieldId,e.type),!0}}BF.commandName="updateStat";class UF extends PI{destroy(){}execute(e){return this.writeService.removeStat(e.viewId,e.fieldId),!0}}UF.commandName="removeStat";var zF=Object.defineProperty,HF=Object.getOwnPropertyDescriptor,WF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?HF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zF(t,r,o),o};let GF=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(BF.commandName,BF),this.commandService.registerCommand(UF.commandName,UF)}};GF.pluginName="kernel-statistics",WF([ao(zI)],GF.prototype,"commandService",2),GF=WF([io({contrib:nR})],GF);class KF extends PI{destroy(){}beforeExecute(e){var t;return e||(e={direction:"after"}),e.uuid||(e.uuid=To(32)),e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.get("uuid")),e}execute(e){return this.writeService.createEmptyRecord(e)}afterExecute(e,t,r){const n=e.viewId;this.readService.getViewFilters(n).length>0&&setTimeout((()=>{null==r||r.emitBeforeRefresh(XO.FILTER,"addEmptyRecord",{uuid:e.uuid},(async()=>{var e;this.writeService.refreshView(n),r.emitAfterRefresh(XO.FILTER),null==(e=this.context)||e.destroy()}))}),300)}}KF.commandName="addEmptyRecord";class qF extends PI{destroy(){}beforeExecute(e){return e.uuid||(e.uuid=To(32)),e}execute(e){const{uuid:t,sourceRecordId:r,modifierId:n}=e,i=this.readService.getActiveView();return i&&this.writeService.copyRecord({uuid:t,viewId:null==i?void 0:i.get("uuid"),sourceRecordId:r,modifierId:n}),!0}}qF.commandName="copyRecord";class YF extends PI{destroy(){}execute(e){const t=this.readService.getActiveView();if(!t)return!0;const r=e.recordIds||[];return e.all?this.writeService.removeAllRecords(t.get("uuid")):this.writeService.removeRecord(r),!0}}YF.commandName="removeRecords";var JF=Object.defineProperty,XF=Object.getOwnPropertyDescriptor,ZF=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?XF(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JF(t,r,o),o};const QF=100;let eV=class{static pluginModule(){return xo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"record",type:"object",title:"记录",properties:{maxCount:{type:"number",description:"最大记录数量"}}}),e.registerDefaultValue({"record.maxCount":QF})}init(){this.commandService.registerCommand(KF.commandName,KF),this.commandService.registerCommand(qF.commandName,qF),this.commandService.registerCommand(YF.commandName,YF)}};eV.pluginName="kernel-add-record",ZF([ao(zI)],eV.prototype,"commandService",2),eV=ZF([io({contrib:nR})],eV);class tV extends PI{destroy(){}execute(e){const{viewId:t,sourceRecordId:r,targetRecordId:n,targetGroupItem:i,direction:o}=e;return this.writeService.updateRecordOrder(t,r,n,i,o),!0}}tV.commandName="changeRecordOrder";class rV extends PI{destroy(){}execute(e){const{viewId:t,sourceFieldId:r,targetFieldId:n}=e;return this.writeService.updateFieldOrder(t,r,n),!0}}rV.commandName="changeFieldOrder";class nV extends PI{destroy(){}execute(e){const{fieldId:t,sourceFieldOptionId:r,targetFieldOptionId:n}=e;return this.writeService.updateFieldOptionOrder(t,r,n),!0}}nV.commandName="changeFieldOptionOrder";class iV extends PI{destroy(){}execute(e){const{sourceViewId:t,targetViewId:r}=e;return this.writeService.updateViewOrder(t,r),!0}}iV.commandName="changeViewOrder";class oV extends PI{destroy(){}execute(e){return this.writeService.updateValueOrder({fieldId:e.fieldId,fieldType:e.fieldType,recordId:e.recordId,sourceValueId:e.sourceValueId,targetValueId:e.targetValueId}),!0}}oV.commandName="updateValueOrder";var aV=Object.defineProperty,sV=Object.getOwnPropertyDescriptor,lV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&aV(t,r,o),o};let cV=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(tV.commandName,tV),this.commandService.registerCommand(rV.commandName,rV),this.commandService.registerCommand(nV.commandName,nV),this.commandService.registerCommand(iV.commandName,iV),this.commandService.registerCommand(oV.commandName,oV)}};cV.pluginName="kernel-order",lV([ao(zI)],cV.prototype,"commandService",2),cV=lV([io({contrib:nR})],cV);class uV extends PI{destroy(){}execute(e){const t=this.writeService.createViewByType(e.uuid,e.type||LE.GRID);return t&&!e.noSwitchView&&!this.context.isRemote&&this.writeService.setActiveView(t.get("uuid")),!0}}uV.commandName="addView";class dV extends PI{destroy(){}execute(e){return this.writeService.setActiveView(e.viewId),!0}}dV.commandName="switchView";class fV extends PI{destroy(){}execute(e){return this.writeService.removeView(e.viewId),!0}}fV.commandName="removeView";class hV extends PI{destroy(){}beforeExecute(e){return e.targetViewId=To(32),e}execute(e){const t=this.writeService.copyView(e.targetViewId,e.viewId);return t&&this.writeService.setActiveView(t.get("uuid")),!0}}hV.commandName="copyView";class pV extends PI{destroy(){}execute(e){return this.writeService.updateView(e.viewId,{name:e.name}),!0}}pV.commandName="updateViewName";var gV=Object.defineProperty,mV=Object.getOwnPropertyDescriptor,vV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gV(t,r,o),o};let yV=class{static pluginModule(){return xo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"view",type:"object",title:"视图",properties:{maxCount:{type:"number",description:"最大视图数量"}}})}init(){this.commandService.registerCommand(uV.commandName,uV),this.commandService.registerCommand(dV.commandName,dV),this.commandService.registerCommand(fV.commandName,fV),this.commandService.registerCommand(hV.commandName,hV),this.commandService.registerCommand(pV.commandName,pV)}};yV.pluginName="kernel-viewer-manage",vV([ao(zI)],yV.prototype,"commandService",2),yV=vV([io({contrib:nR})],yV);class bV extends PI{destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.get("uuid")),e}execute(e){const{sourceFieldId:t,direction:r="after"}=e;return this.writeService.createField({viewId:e.viewId,field:e.field,sourceFieldId:t,direction:r}),!0}}bV.commandName="addField";class _V extends PI{destroy(){}execute(e){return this.writeService.changeFieldType(e.fieldId,e.fromType,e.toType),!0}}_V.commandName="changeFieldType";class wV extends PI{destroy(){}execute(e){return this.writeService.updateFieldProperty(e),!0}}wV.commandName="updateFieldProperty";class CV extends PI{destroy(){}execute(e){return this.writeService.updateFieldName(e.uuid,e.name),!0}}CV.commandName="updateFieldName";class EV extends PI{destroy(){}execute({field:e,newFieldProperty:t}){const r=null==e?void 0:e.get("type"),n=null==e?void 0:e.get("name"),i=e.get("uuid"),o=!Lo(t.type)&&r!==t.type,a=!Lo(t.name)&&n!==t.name;if(o&&this.writeService.changeFieldType(i,r,t.type),a&&this.writeService.updateFieldName(i,t.name),!o&&zE.isSelectLike(r)||zE.isSelectLike(t.type)){const r=!Lo(t.color)&&t.color!==(null==e?void 0:e.get("color")),n=this.readService.getFieldOptions(e.get("uuid")).toJSON(),a=!Lo(t.options)&&t.options!==n,s={uuid:i};if(r&&(s.color=!!t.color),a){const e=of(t.options,"name");s.options=e}if(r||a){const e=o?this.readService.getFieldCells(i).filter((e=>!!e.value)):[];if(this.writeService.updateFieldProperty(s),o){const t=e.map((e=>{var t,r;const n=e.fieldType,i=null==(r=null==(t=s.options)?void 0:t.find((t=>{var r;return(null==(r=null==t?void 0:t.name)?void 0:r.slice(0,cS.MAX_LENGTH))===e.formatValue})))?void 0:r.uuid,o=Lo(i)?null:n===pE.MULTI_SELECT?[i]:i;return{recordId:e.recordId,fieldId:e.fieldId,value:o,cellId:e.uuid,fieldType:n,uuid:e.uuid}}));this.writeService.bulkSetCell(t)}}}return!0}}EV.commandName="updateField";class SV extends PI{destroy(){}execute(e){return this.writeService.removeField(e.fieldId),!0}}SV.commandName="removeField";var kV=Object.defineProperty,xV=Object.getOwnPropertyDescriptor,OV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kV(t,r,o),o};let IV=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(bV.commandName,bV),this.commandService.registerCommand(_V.commandName,_V),this.commandService.registerCommand(wV.commandName,wV),this.commandService.registerCommand(CV.commandName,CV),this.commandService.registerCommand(EV.commandName,EV),this.commandService.registerCommand(SV.commandName,SV)}};IV.pluginName="kernel-add-field",OV([ao(zI)],IV.prototype,"commandService",2),IV=OV([io({contrib:nR})],IV);class RV extends PI{destroy(){}execute(e){return this.writeService.updateViewConfig(e.viewId,{cover_display:e.coverDisplay}),!0}}class TV extends PI{destroy(){}execute(e){return this.writeService.updateViewConfig(e.viewId,{show_field_name:e.showFieldName}),!0}}class AV extends PI{destroy(){}execute(e){return this.writeService.updateViewConfig(e.viewId,{cover_field_uuid:e.coverFieldId}),!0}}class MV extends PI{destroy(){}execute(e){return this.writeService.updateFieldHidden(e.viewId,e.fieldId,e.hidden),!0}}var NV=Object.defineProperty,DV=Object.getOwnPropertyDescriptor,PV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&NV(t,r,o),o};let jV=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand("updateCoverDisplay",RV),this.commandService.registerCommand("updateShowFieldName",TV),this.commandService.registerCommand("updateCoverSource",AV),this.commandService.registerCommand("updateFieldHidden",MV)}};jV.pluginName="kernel-viewer-field-setting",PV([ao(zI)],jV.prototype,"commandService",2),jV=PV([io({contrib:nR})],jV);class FV extends PI{destroy(){}beforeExecute(e){var t;return e.name||(e.name="分组"),e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.get("uuid")),e}execute(e){const t=this.writeService.createFieldGroup(e.viewId,e.name);if(!t)return!1;for(const r of e.fieldIds)this.writeService.updateViewField(e.viewId,r,{group_uuid:t.uuid});return!0}}FV.commandName="addFieldGroup";class VV extends PI{destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.get("uuid")),e}execute(e){return this.writeService.removeFieldGroup(e.viewId,e.fieldGroupId),!0}}VV.commandName="removeFieldGroup";class LV extends PI{destroy(){}beforeExecute(e){var t;return e.viewId||(e.viewId=null==(t=this.readService.getActiveView())?void 0:t.get("uuid")),e}execute(e){return this.writeService.changeFieldGroupName(e.viewId,{uuid:e.fieldGroupId,name:e.name}),!0}}LV.commandName="changeFieldGroupName";var $V=Object.defineProperty,BV=Object.getOwnPropertyDescriptor,UV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?BV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$V(t,r,o),o};let zV=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(FV.commandName,FV),this.commandService.registerCommand(VV.commandName,VV),this.commandService.registerCommand(LV.commandName,LV)}};zV.pluginName="kernel-field-group",UV([ao(zI)],zV.prototype,"commandService",2),zV=UV([io({contrib:nR})],zV);class HV extends PI{destroy(){}execute(e){const{viewId:t,fieldId:r,size:n}=e;return this.writeService.updateFieldSize(t,r,n),!0}}HV.commandName="changeColWidth";var WV=Object.defineProperty,GV=Object.getOwnPropertyDescriptor,KV=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?GV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WV(t,r,o),o};let qV=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(HV.commandName,HV)}};qV.pluginName="kernel-viewer-grid",KV([ao(zI)],qV.prototype,"commandService",2),qV=KV([io({contrib:nR})],qV);class YV extends PI{destroy(){}execute(e){return this.writeService.createGroup(e.viewId,e.group),!0}}YV.commandName="createGridGroup";class JV extends PI{destroy(){}execute(e){return this.writeService.removeGroup(e.viewId),!0}}JV.commandName="removeGridGroup";class XV extends PI{destroy(){}execute(e){return this.writeService.updateGroup(e.viewId,e.group),!0}}XV.commandName="updateGridGroup";var ZV=Object.defineProperty,QV=Object.getOwnPropertyDescriptor,eL=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?QV(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ZV(t,r,o),o};let tL=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(YV.commandName,YV),this.commandService.registerCommand(JV.commandName,JV),this.commandService.registerCommand(XV.commandName,XV)}};tL.pluginName="kernel-viewer-grid-group",eL([ao(zI)],tL.prototype,"commandService",2),tL=eL([io({contrib:nR})],tL);class rL extends PI{destroy(){}execute(e){return this.writeService.updateViewConfig(e.viewId,{record_height:e.recordHeight}),!0}}var nL=Object.defineProperty,iL=Object.getOwnPropertyDescriptor,oL=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iL(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nL(t,r,o),o};let aL=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand("updateGridRecordHeight",rL)}};aL.pluginName="kernel-viewer-grid-record-height",oL([ao(zI)],aL.prototype,"commandService",2),aL=oL([io({contrib:nR})],aL);class sL extends PI{destroy(){}execute(e){return this.writeService.removeCells(e.cells),!0}}sL.commandName="removeCells";class lL extends PI{destroy(){}execute(e){return this.writeService.setCell(e),!0}}lL.commandName="setCell";var cL=Object.defineProperty,uL=Object.getOwnPropertyDescriptor,dL=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uL(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cL(t,r,o),o};let fL=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(sL.commandName,sL),this.commandService.registerCommand(lL.commandName,lL)}};fL.pluginName="kernel-viewer-grid-cell-editor",dL([ao(zI)],fL.prototype,"commandService",2),fL=dL([io({contrib:nR})],fL);var hL=Object.defineProperty,pL=Object.getOwnPropertyDescriptor,gL=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pL(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hL(t,r,o),o};let mL=class{constructor(){this.viewType=LE.CARD}static pluginModule(){return xo().register(this)}init(){}};mL.pluginName="kernel-viewer-card",gL([ao(zI)],mL.prototype,"commandService",2),mL=gL([io({contrib:nR})],mL);class vL extends PI{destroy(){}execute(e){return this.writeService.updateGroup(e.viewId,e.group),!0}}var yL=Object.defineProperty,bL=Object.getOwnPropertyDescriptor,_L=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bL(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yL(t,r,o),o};let wL=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand("updateKanbanGroup",vL)}};wL.pluginName="kernel-viewer-kanban",_L([ao(zI)],wL.prototype,"commandService",2),wL=_L([io({contrib:nR})],wL);class CL{constructor(e,t,r,n){this._node=e,this._type=t,this._handler=r,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}destroy(){!this._handler||(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function EL(e,t,r,n){return new CL(e,t,r,n)}let SL=!1,kL=!1;function xL(e,t,r){if((null==e?void 0:e.nodeType)===Node.TEXT_NODE&&(e=e.parentNode),null==e||!e.closest)return null;const n=e.closest(t);return!n||r&&!r.contains(n)?null:n}function OL(e){var t,r;e.stopPropagation(),null==(r=null==(t=e.nativeEvent)?void 0:t.stopImmediatePropagation)||r.call(t)}function IL(e){e.preventDefault()}const RL=["input","textarea","select"];class TL{constructor(){this._dataStore=[],this._top=0,this._dataStore=[],this._top=0}push(e){this._dataStore[this._top++]=e}pop(){const e=this._dataStore[this._top-1];return this._top--,e}peek(){return this._dataStore[this._top-1]}clear(){this._dataStore=[],this._top=0}length(){return this._top}isEmpty(){return 0===this._top}toString(){return this._dataStore.toString()}}const AL=["+","-","/","*","(",")"],ML={"+":100,"-":100,"*":200,"/":200,"(":1e3,")":0},NL=(e,t)=>t.includes(e);function DL(e){const t=e.split(" "),r=new TL,n=[];for(;0!==t.length;)if(""!==t[0]){if(NL(t[0],AL))if("("===t[0])r.push(t[0]);else if(")"===t[0]){for(;"("!==r.peek();)n.push(r.pop());r.pop()}else if(r.isEmpty())r.push(t[0]);else if(ML[t[0]]>ML[r.peek()])r.push(t[0]);else{for(;!r.isEmpty()&&ML[r.peek()]>=ML[t[0]]&&"("!==r.peek();)n.push(r.pop());r.push(t[0])}else n.push(t[0]);t.shift()}else t.shift();for(;!r.isEmpty();)n.push(r.pop());return function(e){const t=new TL;for(;0!==e.length;){if(NL(e[0],AL)){const r=t.pop(),n=t.peek();let i=0;switch(e[0]){case"+":i=Number(n)+Number(r);break;case"-":i=Number(n)-Number(r);break;case"*":i=Number(n)*Number(r);break;case"/":i=Number(n)/Number(r)}t.pop(),t.push(i)}else t.push(e[0]);e.shift()}const r=t.pop();if(isNaN(r))throw new Error("Oops, result is not a number");if(r===1/0)throw new Error("Oops, result is Infinity");return r}(n)}class PL{static get isTraceReact(){return!(!globalThis.process||!globalThis.process.env)&&"true"===er.exports.env.TRACE_REACT}static get isTraceDi(){if(!globalThis.process||!globalThis.process.env)return!1;const e="true"===er.exports.env.TRACE_DI;return e&&Jo.enable("infra","di"),e}static get isTrace(){return!(!globalThis.process||!globalThis.process.env)&&"true"===er.exports.env.TRACE}static get isDev(){return!(!globalThis.process||!globalThis.process.env)&&"development"===er.exports.env.NODE_ENV}static get isMobile(){return fa.isMobile}}$i.defineToken("WorkbenchContextToken");const jL=$i.defineToken("WorkbenchPluginContribution");var FL=Object.defineProperty,VL=Object.getOwnPropertyDescriptor,LL=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VL(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&FL(t,r,o),o};let $L=class{constructor(){this._plugins=[]}init(){this._plugins=this._workbenchPluginProvider.getContributions(),this._initPlugins()}destroy(){this._plugins.forEach((e=>{var t;return null==(t=e.destroy)?void 0:t.call(e)}))}_initPlugins(){this._plugins.forEach((e=>{e.init()}))}};LL([wh(jL)],$L.prototype,"_workbenchPluginProvider",2),$L=LL([io()],$L);const BL=$i.defineToken("WorkbenchContextService",{multiple:!1}),UL=s.a.createContext({container:null});UL.displayName="TableDiContext";const zL=UL.Provider;function HL(e,t){var r;const n=s.a.useContext(UL),i=n.container;if(!i)throw new Error('"useContainer" is being used outside of the TableDiContext');try{return i.get(e)}catch(e){return null!=t&&t.optional||(console.warn(e),null==(r=n.onError)||r.call(n,e)),null}}UL.Consumer;const WL=({activeColor:e,onSelect:t,colorSource:r})=>{const n=HL(KD),i=HL(jD);return s.a.createElement("div",{className:"lakex-table-colorpicker"},r.map(((r,o)=>s.a.createElement("div",{className:"lakex-table-colorpicker-group",key:o},r.map(((r,o)=>{const a=(null==r?void 0:r.toLowerCase())===(null==e?void 0:e.toLowerCase());return s.a.createElement("span",{key:o,className:"lakex-table-colorpicker-item",onClick:t.bind(void 0,r)},s.a.createElement("span",{style:{backgroundColor:null==n?void 0:n.getRenderColor(r)}},a&&s.a.createElement("svg",{style:{fill:null==i?void 0:i.getThemeValue("@yuque-color-icon-primary")},viewBox:"0 0 18 18"},s.a.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))))}))))))},GL=({onChange:e,...t})=>{const r=Object(a.useRef)();return s.a.createElement(u.a,{...t,autoComplete:"off",onChange:t=>{r.current||e(t)},onCompositionStart:()=>{r.current=!0},onCompositionEnd:t=>{r.current=!1,e(t)}})};var KL={exports:{}};!function(e){!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i)){if(i.length){var a=r.apply(null,i);a&&e.push(a)}}else if("object"===o){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var s in i)t.call(i,s)&&i[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()}(KL);const qL=KL.exports,{TextArea:YL}=u.a,JL="lakex-editor-for-keyboard-input",XL=s.a.forwardRef(((e,t)=>{const{allowEnter:r=!1,onSave:n,maxRows:i,rows:o=1,...l}=e,c=Object(a.useRef)(null),[d,f]=Object(a.useState)(e.value||"");Object(a.useLayoutEffect)((()=>{Lo(e.value)||f(e.value)}),[e.value]),Object(a.useImperativeHandle)(t,(()=>({focus:e=>{var t;null==(t=c.current)||t.focus(e)},blur:()=>{var e;null==(e=c.current)||e.blur()},setCursorToEnd:()=>{h()},setValue:e=>{f(e)},getValue:()=>d,clearValue:()=>{f("")}})));const h=Object(a.useCallback)((()=>{setTimeout((()=>{const e=document.activeElement;!e||!e.classList.contains(JL)||(r?e.scrollTop=e.scrollHeight:e.scrollLeft=e.scrollWidth)}),100)}),[r]),p=Object(a.useMemo)((()=>i?{minRows:o,maxRows:i}:{minRows:o}),[]),g=Object(a.useCallback)((t=>{var r;const n=t.target.value;f(n),null==(r=e.onChange)||r.call(e,t)}),[e.onChange]);return r?s.a.createElement(YL,{autoSize:p,ref:c,...l,value:d,onChange:g,className:qL(JL,e.className),autoComplete:"off",onMouseDown:OL,onMouseMove:OL,onMouseUp:OL,onFocus:e.onFocus,onBlur:e.onBlur}):s.a.createElement(u.a,{ref:c,...l,value:d,onChange:g,className:qL(JL,e.className),autoComplete:"off",onMouseDown:OL,onMouseMove:OL,onMouseUp:OL,onFocus:e.onFocus,onBlur:e.onBlur})}));const ZL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function QL(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function e$(e){return"nodeType"in e}function t$(e){var t,r;return e?QL(e)?e:e$(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function r$(e){const{Document:t}=t$(e);return e instanceof t}function n$(e){return!QL(e)&&e instanceof t$(e).HTMLElement}function i$(e){return e?QL(e)?e.document:e$(e)?r$(e)?e:n$(e)?e.ownerDocument:document:document:document}const o$=ZL?a.useLayoutEffect:a.useEffect;function a$(e){const t=Object(a.useRef)(e);return o$((()=>{t.current=e})),Object(a.useCallback)((function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)}),[])}function s$(e,t){void 0===t&&(t=[e]);const r=Object(a.useRef)(e);return o$((()=>{r.current!==e&&(r.current=e)}),t),r}function l$(e,t){const r=Object(a.useRef)();return Object(a.useMemo)((()=>{const t=e(r.current);return r.current=t,t}),[...t])}function c$(e){const t=a$(e),r=Object(a.useRef)(null),n=Object(a.useCallback)((e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e}),[]);return[r,n]}function u$(e){const t=Object(a.useRef)();return Object(a.useEffect)((()=>{t.current=e}),[e]),t.current}let d$={};function f$(e,t){return Object(a.useMemo)((()=>{if(t)return t;const r=null==d$[e]?0:d$[e]+1;return d$[e]=r,e+"-"+r}),[e,t])}function h$(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce(((t,r)=>{const n=Object.entries(r);for(const[r,i]of n){const n=t[r];null!=n&&(t[r]=n+e*i)}return t}),{...t})}}const p$=h$(1),g$=h$(-1);function m$(e){if(!e)return!1;const{KeyboardEvent:t}=t$(e.target);return t&&e instanceof t}function v$(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=t$(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const y$=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[y$.Translate.toString(e),y$.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),b$="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function _$(e){return e.matches(b$)?e:e.querySelector(b$)}const w$={display:"none"};function C$(e){let{id:t,value:r}=e;return s.a.createElement("div",{id:t,style:w$},r)}const E$={position:"fixed",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};function S$(e){let{id:t,announcement:r}=e;return s.a.createElement("div",{id:t,style:E$,role:"status","aria-live":"assertive","aria-atomic":!0},r)}const k$=Object(a.createContext)(null);const x$={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},O$={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function I$(e){let{announcements:t=O$,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=x$}=e;const{announce:o,announcement:c}=function(){const[e,t]=Object(a.useState)("");return{announce:Object(a.useCallback)((e=>{null!=e&&t(e)}),[]),announcement:e}}(),u=f$("DndLiveRegion"),[d,f]=Object(a.useState)(!1);if(Object(a.useEffect)((()=>{f(!0)}),[]),function(e){const t=Object(a.useContext)(k$);Object(a.useEffect)((()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)}),[e,t])}(Object(a.useMemo)((()=>({onDragStart(e){let{active:r}=e;o(t.onDragStart({active:r}))},onDragMove(e){let{active:r,over:n}=e;t.onDragMove&&o(t.onDragMove({active:r,over:n}))},onDragOver(e){let{active:r,over:n}=e;o(t.onDragOver({active:r,over:n}))},onDragEnd(e){let{active:r,over:n}=e;o(t.onDragEnd({active:r,over:n}))},onDragCancel(e){let{active:r,over:n}=e;o(t.onDragCancel({active:r,over:n}))}})),[o,t])),!d)return null;const h=s.a.createElement(s.a.Fragment,null,s.a.createElement(C$,{id:n,value:i.draggable}),s.a.createElement(S$,{id:u,announcement:c}));return r?Object(l.createPortal)(h,r):h}var R$;function T$(){}function A$(e,t){return Object(a.useMemo)((()=>({sensor:e,options:null!=t?t:{}})),[e,t])}function M$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(a.useMemo)((()=>[...t].filter((e=>null!=e))),[...t])}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(R$||(R$={}));const N$=Object.freeze({x:0,y:0});function D$(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function P$(e,t){const r=v$(e);if(!r)return"0 0";return(r.x-t.left)/t.width*100+"% "+(r.y-t.top)/t.height*100+"%"}function j$(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function F$(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function V$(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function L$(e,t){if(!e||0===e.length)return null;const[r]=e;return t?r[t]:r}function $$(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}const B$=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=$$(t,t.left,t.top),o=[];for(const e of n){const{id:t}=e,n=r.get(t);if(n){const r=D$($$(n),i);o.push({id:t,data:{droppableContainer:e,value:r}})}}return o.sort(j$)};function U$(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=i-n,s=o-r;if(n<i&&r<o){const r=t.width*t.height,n=e.width*e.height,i=a*s;return Number((i/(r+n-i)).toFixed(4))}return 0}const z$=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const e of n){const{id:n}=e,o=r.get(n);if(o){const r=U$(o,t);r>0&&i.push({id:n,data:{droppableContainer:e,value:r}})}}return i.sort(F$)};function H$(e,t){const{top:r,left:n,bottom:i,right:o}=t;return r<=e.y&&e.y<=i&&n<=e.x&&e.x<=o}function W$(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:N$}function G$(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce(((t,r)=>({...t,top:t.top+e*r.y,bottom:t.bottom+e*r.y,left:t.left+e*r.x,right:t.right+e*r.x})),{...t})}}const K$=G$(1);function q$(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const Y$={ignoreTransform:!1};function J$(e,t){void 0===t&&(t=Y$);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:n}=t$(e).getComputedStyle(e);t&&(r=function(e,t,r){const n=q$(t);if(!n)return e;const{scaleX:i,scaleY:o,x:a,y:s}=n,l=e.left-a-(1-i)*parseFloat(r),c=e.top-s-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),u=i?e.width/i:e.width,d=o?e.height/o:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(r,t,n))}const{top:n,left:i,width:o,height:a,bottom:s,right:l}=r;return{top:n,left:i,width:o,height:a,bottom:s,right:l}}function X$(e){return J$(e,{ignoreTransform:!0})}function Z$(e,t){const r=[];return e?function n(i){if(null!=t&&r.length>=t||!i)return r;if(r$(i)&&null!=i.scrollingElement&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!n$(i)||function(e){return e instanceof t$(e).SVGElement}(i)||r.includes(i))return r;const o=t$(e).getComputedStyle(i);return i!==e&&function(e,t){void 0===t&&(t=t$(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some((e=>{const n=t[e];return"string"==typeof n&&r.test(n)}))}(i,o)&&r.push(i),function(e,t){return void 0===t&&(t=t$(e).getComputedStyle(e)),"fixed"===t.position}(i,o)?r:n(i.parentNode)}(e):r}function Q$(e){const[t]=Z$(e,1);return null!=t?t:null}function eB(e){return ZL&&e?QL(e)?e:e$(e)?r$(e)||e===i$(e).scrollingElement?window:n$(e)?e:null:null:null}function tB(e){return QL(e)?e.scrollX:e.scrollLeft}function rB(e){return QL(e)?e.scrollY:e.scrollTop}function nB(e){return{x:tB(e),y:rB(e)}}var iB;function oB(e){return!(!ZL||!e)&&e===document.scrollingElement}function aB(e){const t={x:0,y:0},r=oB(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(iB||(iB={}));const sB={x:.2,y:.2};function lB(e,t,r,n,i){let{top:o,left:a,right:s,bottom:l}=r;void 0===n&&(n=10),void 0===i&&(i=sB);const{isTop:c,isBottom:u,isLeft:d,isRight:f}=aB(e),h={x:0,y:0},p={x:0,y:0},g=t.height*i.y,m=t.width*i.x;return!c&&o<=t.top+g?(h.y=iB.Backward,p.y=n*Math.abs((t.top+g-o)/g)):!u&&l>=t.bottom-g&&(h.y=iB.Forward,p.y=n*Math.abs((t.bottom-g-l)/g)),!f&&s>=t.right-m?(h.x=iB.Forward,p.x=n*Math.abs((t.right-m-s)/m)):!d&&a<=t.left+m&&(h.x=iB.Backward,p.x=n*Math.abs((t.left+m-a)/m)),{direction:h,speed:p}}function cB(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function uB(e){return e.reduce(((e,t)=>p$(e,nB(t))),N$)}function dB(e,t){if(void 0===t&&(t=J$),!e)return;const{top:r,left:n,bottom:i,right:o}=t(e);!Q$(e)||(i<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const fB=[["x",["left","right"],function(e){return e.reduce(((e,t)=>e+tB(t)),0)}],["y",["top","bottom"],function(e){return e.reduce(((e,t)=>e+rB(t)),0)}]];class hB{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Z$(t),n=uB(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[e,t,i]of fB)for(const o of t)Object.defineProperty(this,o,{get:()=>{const t=i(r),a=n[e]-t;return this.rect[o]+a},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class pB{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach((e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)}))},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function gB(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}var mB,vB;function yB(e){e.preventDefault()}function bB(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(mB||(mB={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter"}(vB||(vB={}));const _B={start:[vB.Space,vB.Enter],cancel:[vB.Esc],end:[vB.Space,vB.Enter]},wB=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case vB.Right:return{...r,x:r.x+25};case vB.Left:return{...r,x:r.x-25};case vB.Down:return{...r,y:r.y+25};case vB.Up:return{...r,y:r.y-25}}};class CB{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new pB(i$(t)),this.windowListeners=new pB(t$(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(mB.Resize,this.handleCancel),this.windowListeners.add(mB.VisibilityChange,this.handleCancel),setTimeout((()=>this.listeners.add(mB.Keydown,this.handleKeyDown)))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&dB(r),t(N$)}handleKeyDown(e){if(m$(e)){const{active:t,context:r,options:n}=this.props,{keyboardCodes:i=_B,coordinateGetter:o=wB,scrollBehavior:a="smooth"}=n,{code:s}=e;if(i.end.includes(s))return void this.handleEnd(e);if(i.cancel.includes(s))return void this.handleCancel(e);const{collisionRect:l}=r.current,c=l?{x:l.left,y:l.top}:N$;this.referenceCoordinates||(this.referenceCoordinates=c);const u=o(e,{active:t,context:r.current,currentCoordinates:c});if(u){const t=g$(u,c),n={x:0,y:0},{scrollableAncestors:i}=r.current;for(const r of i){const i=e.code,{isTop:o,isRight:s,isLeft:l,isBottom:c,maxScroll:d,minScroll:f}=aB(r),h=cB(r),p={x:Math.min(i===vB.Right?h.right-h.width/2:h.right,Math.max(i===vB.Right?h.left:h.left+h.width/2,u.x)),y:Math.min(i===vB.Down?h.bottom-h.height/2:h.bottom,Math.max(i===vB.Down?h.top:h.top+h.height/2,u.y))},g=i===vB.Right&&!s||i===vB.Left&&!l,m=i===vB.Down&&!c||i===vB.Up&&!o;if(g&&p.x!==u.x){const e=r.scrollLeft+t.x,o=i===vB.Right&&e<=d.x||i===vB.Left&&e>=f.x;if(o&&!t.y)return void r.scrollTo({left:e,behavior:a});n.x=o?r.scrollLeft-e:i===vB.Right?r.scrollLeft-d.x:r.scrollLeft-f.x,n.x&&r.scrollBy({left:-n.x,behavior:a});break}if(m&&p.y!==u.y){const e=r.scrollTop+t.y,o=i===vB.Down&&e<=d.y||i===vB.Up&&e>=f.y;if(o&&!t.x)return void r.scrollTo({top:e,behavior:a});n.y=o?r.scrollTop-e:i===vB.Down?r.scrollTop-d.y:r.scrollTop-f.y,n.y&&r.scrollBy({top:-n.y,behavior:a});break}}this.handleMove(e,p$(g$(u,this.referenceCoordinates),n))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function EB(e){return Boolean(e&&"distance"in e)}function SB(e){return Boolean(e&&"delay"in e)}CB.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=_B,onActivation:i}=t,{active:o}=r;const{code:a}=e.nativeEvent;if(n.start.includes(a)){const t=o.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==i||i({event:e.nativeEvent}),!0)}return!1}}];class kB{constructor(e,t,r){var n;void 0===r&&(r=function(e){const{EventTarget:t}=t$(e);return e instanceof t?e:i$(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:o}=i;this.props=e,this.events=t,this.document=i$(o),this.documentListeners=new pB(this.document),this.listeners=new pB(r),this.windowListeners=new pB(t$(o)),this.initialCoordinates=null!=(n=v$(i))?n:N$,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),this.windowListeners.add(mB.Resize,this.handleCancel),this.windowListeners.add(mB.DragStart,yB),this.windowListeners.add(mB.VisibilityChange,this.handleCancel),this.windowListeners.add(mB.ContextMenu,yB),this.documentListeners.add(mB.Keydown,this.handleKeydown),t){if(EB(t))return;if(SB(t))return void(this.timeoutId=setTimeout(this.handleStart,t.delay))}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(mB.Click,bB,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(mB.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:n,props:i}=this,{onMove:o,options:{activationConstraint:a}}=i;if(!n)return;const s=null!=(t=v$(e))?t:N$,l=g$(n,s);if(!r&&a){if(SB(a))return gB(l,a.tolerance)?this.handleCancel():void 0;if(EB(a))return null!=a.tolerance&&gB(l,a.tolerance)?this.handleCancel():gB(l,a.distance)?this.handleStart():void 0}e.cancelable&&e.preventDefault(),o(s)}handleEnd(){const{onEnd:e}=this.props;this.detach(),e()}handleCancel(){const{onCancel:e}=this.props;this.detach(),e()}handleKeydown(e){e.code===vB.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const xB={move:{name:"pointermove"},end:{name:"pointerup"}};class OB extends kB{constructor(e){const{event:t}=e,r=i$(t.target);super(e,xB,r)}}OB.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!(!r.isPrimary||0!==r.button)&&(null==n||n({event:r}),!0)}}];const IB={move:{name:"mousemove"},end:{name:"mouseup"}};var RB;!function(e){e[e.RightClick=2]="RightClick"}(RB||(RB={}));class TB extends kB{constructor(e){super(e,IB,i$(e.event.target))}}TB.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button!==RB.RightClick&&(null==n||n({event:r}),!0)}}];const AB={move:{name:"touchmove"},end:{name:"touchend"}};var MB,NB;function DB(e){let{acceleration:t,activator:r=MB.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:s=5,order:l=NB.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:h}=e;const p=function(e){let{delta:t,disabled:r}=e;const n=u$(t);return l$((e=>{if(r||!n||!e)return PB;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[iB.Backward]:e.x[iB.Backward]||-1===i.x,[iB.Forward]:e.x[iB.Forward]||1===i.x},y:{[iB.Backward]:e.y[iB.Backward]||-1===i.y,[iB.Forward]:e.y[iB.Forward]||1===i.y}}}),[r,t,n])}({delta:f,disabled:!o}),[g,m]=function(){const e=Object(a.useRef)(null),t=Object(a.useCallback)(((t,r)=>{e.current=setInterval(t,r)}),[]);return[t,Object(a.useCallback)((()=>{null!==e.current&&(clearInterval(e.current),e.current=null)}),[])]}(),v=Object(a.useRef)({x:0,y:0}),y=Object(a.useRef)({x:0,y:0}),b=Object(a.useMemo)((()=>{switch(r){case MB.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case MB.DraggableRect:return i}}),[r,i,c]),_=Object(a.useRef)(null),w=Object(a.useCallback)((()=>{const e=_.current;if(!e)return;const t=v.current.x*y.current.x,r=v.current.y*y.current.y;e.scrollBy(t,r)}),[]),C=Object(a.useMemo)((()=>l===NB.TreeOrder?[...u].reverse():u),[l,u]);Object(a.useEffect)((()=>{if(o&&u.length&&b){for(const e of C){if(!1===(null==n?void 0:n(e)))continue;const r=u.indexOf(e),i=d[r];if(!i)continue;const{direction:o,speed:a}=lB(e,i,b,t,h);for(const e of["x","y"])p[e][o[e]]||(a[e]=0,o[e]=0);if(a.x>0||a.y>0)return m(),_.current=e,g(w,s),v.current=a,void(y.current=o)}v.current={x:0,y:0},y.current={x:0,y:0},m()}else m()}),[t,w,n,m,o,s,JSON.stringify(b),JSON.stringify(p),g,u,C,d,JSON.stringify(h)])}(class extends kB{constructor(e){super(e,AB)}static setup(){return window.addEventListener(AB.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(AB.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return!(i.length>1)&&(null==n||n({event:r}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(MB||(MB={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(NB||(NB={}));const PB={x:{[iB.Backward]:!1,[iB.Forward]:!1},y:{[iB.Backward]:!1,[iB.Forward]:!1}};var jB,FB;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(jB||(jB={})),function(e){e.Optimized="optimized"}(FB||(FB={}));const VB=new Map;function LB(e,t){return l$((r=>e?r||("function"==typeof t?t(e):e):null),[t,e])}function $B(e){let{callback:t,disabled:r}=e;const n=a$(t),i=Object(a.useMemo)((()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:e}=window;return new e(n)}),[r]);return Object(a.useEffect)((()=>()=>null==i?void 0:i.disconnect()),[i]),i}function BB(e){return new hB(J$(e),e)}function UB(e,t,r){void 0===t&&(t=BB);const[n,i]=Object(a.useReducer)((function(n){if(!e)return null;var i;if(!1===e.isConnected)return null!=(i=null!=n?n:r)?i:null;const o=t(e);return JSON.stringify(n)===JSON.stringify(o)?n:o}),null),o=function(e){let{callback:t,disabled:r}=e;const n=a$(t),i=Object(a.useMemo)((()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:e}=window;return new e(n)}),[n,r]);return Object(a.useEffect)((()=>()=>null==i?void 0:i.disconnect()),[i]),i}({callback(t){if(e)for(const r of t){const{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){i();break}}}}),s=$B({callback:i});return o$((()=>{i(),e?(null==s||s.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==o||o.disconnect())}),[e]),n}const zB=[];function HB(e,t){void 0===t&&(t=[]);const r=Object(a.useRef)(null);return Object(a.useEffect)((()=>{r.current=null}),t),Object(a.useEffect)((()=>{const t=e!==N$;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)}),[e]),r.current?g$(e,r.current):N$}function WB(e){return Object(a.useMemo)((()=>e?function(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}(e):null),[e])}const GB=[];function KB(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return n$(t)?t:e}const qB=[{sensor:OB,options:{}},{sensor:CB,options:{}}],YB={current:{}},JB={draggable:{measure:X$},droppable:{measure:X$,strategy:jB.WhileDragging,frequency:FB.Optimized},dragOverlay:{measure:J$}};class XB extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter((e=>{let{disabled:t}=e;return!t}))}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}const ZB={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new XB,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:T$},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:JB,measureDroppableContainers:T$,windowRect:null,measuringScheduled:!1},QB={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:T$,draggableNodes:new Map,over:null,measureDroppableContainers:T$},eU=Object(a.createContext)(QB),tU=Object(a.createContext)(ZB);function rU(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new XB}}}function nU(e,t){switch(t.type){case R$.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case R$.DragMove:return e.draggable.active?{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}}:e;case R$.DragEnd:case R$.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case R$.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new XB(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case R$.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const a=new XB(e.droppable.containers);return a.set(r,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:a}}}case R$.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new XB(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function iU(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=Object(a.useContext)(eU),o=u$(n),s=u$(null==r?void 0:r.id);return Object(a.useEffect)((()=>{if(!t&&!n&&o&&null!=s){if(!m$(o)||document.activeElement===o.target)return;const e=i.get(s);if(!e)return;const{activatorNode:t,node:r}=e;if(!t.current&&!r.current)return;requestAnimationFrame((()=>{for(const e of[t.current,r.current]){if(!e)continue;const t=_$(e);if(t){t.focus();break}}}))}}),[n,t,i,s,o]),null}function oU(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce(((e,t)=>t({transform:e,...n})),r):r}const aU=Object(a.createContext)({...N$,scaleX:1,scaleY:1});var sU;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(sU||(sU={}));const lU=Object(a.memo)((function(e){var t,r,n,i;let{id:o,accessibility:c,autoScroll:u=!0,children:d,sensors:f=qB,collisionDetection:h=z$,measuring:p,modifiers:g,...m}=e;const v=Object(a.useReducer)(nU,void 0,rU),[y,b]=v,[_,w]=function(){const[e]=Object(a.useState)((()=>new Set)),t=Object(a.useCallback)((t=>(e.add(t),()=>e.delete(t))),[e]);return[Object(a.useCallback)((t=>{let{type:r,event:n}=t;e.forEach((e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)}))}),[e]),t]}(),[C,E]=Object(a.useState)(sU.Uninitialized),S=C===sU.Initialized,{draggable:{active:k,nodes:x,translate:O},droppable:{containers:I}}=y,R=k?x.get(k):null,T=Object(a.useRef)({initial:null,translated:null}),A=Object(a.useMemo)((()=>{var e;return null!=k?{id:k,data:null!=(e=null==R?void 0:R.data)?e:YB,rect:T}:null}),[k,R]),M=Object(a.useRef)(null),[N,D]=Object(a.useState)(null),[P,j]=Object(a.useState)(null),F=s$(m,Object.values(m)),V=f$("DndDescribedBy",o),L=Object(a.useMemo)((()=>I.getEnabled()),[I]),$=function(e){return Object(a.useMemo)((()=>({draggable:{...JB.draggable,...null==e?void 0:e.draggable},droppable:{...JB.droppable,...null==e?void 0:e.droppable},dragOverlay:{...JB.dragOverlay,...null==e?void 0:e.dragOverlay}})),[null==e?void 0:e.draggable,null==e?void 0:e.droppable,null==e?void 0:e.dragOverlay])}(p),{droppableRects:B,measureDroppableContainers:U,measuringScheduled:z}=function(e,t){let{dragging:r,dependencies:n,config:i}=t;const[o,s]=Object(a.useState)(null),{frequency:l,measure:c,strategy:u}=i,d=Object(a.useRef)(e),f=function(){switch(u){case jB.Always:return!1;case jB.BeforeDragging:return r;default:return!r}}(),h=s$(f),p=Object(a.useCallback)((function(e){void 0===e&&(e=[]),!h.current&&s((t=>null===t?e:t.concat(e.filter((e=>!t.includes(e))))))}),[h]),g=Object(a.useRef)(null),m=l$((t=>{if(f&&!r)return VB;if(!t||t===VB||d.current!==e||null!=o){const t=new Map;for(let r of e){if(!r)continue;if(o&&o.length>0&&!o.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}const e=r.node.current,n=e?new hB(c(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t}),[e,o,r,f,c]);return Object(a.useEffect)((()=>{d.current=e}),[e]),Object(a.useEffect)((()=>{f||p()}),[r,f]),Object(a.useEffect)((()=>{o&&o.length>0&&s(null)}),[JSON.stringify(o)]),Object(a.useEffect)((()=>{f||"number"!=typeof l||null!==g.current||(g.current=setTimeout((()=>{p(),g.current=null}),l))}),[l,f,p,...n]),{droppableRects:m,measureDroppableContainers:p,measuringScheduled:null!=o}}(L,{dragging:S,dependencies:[O.x,O.y],config:$.droppable}),H=function(e,t){const r=null!==t?e.get(t):void 0,n=r?r.node.current:null;return l$((e=>{var r;return null===t?null:null!=(r=null!=n?n:e)?r:null}),[n,t])}(x,k),W=Object(a.useMemo)((()=>P?v$(P):null),[P]),G=function(){const e=!1===(null==N?void 0:N.autoScrollEnabled),t="object"==typeof u?!1===u.enabled:!1===u,r=S&&!e&&!t;return"object"==typeof u?{...u,enabled:r}:{enabled:r}}(),K=function(e,t){return LB(e,t)}(H,$.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const o=Object(a.useRef)(!1),{x:s,y:l}="boolean"==typeof i?{x:i,y:i}:i;o$((()=>{if(!s&&!l||!t)return void(o.current=!1);if(o.current||!n)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const i=W$(r(e),n);if(s||(i.x=0),l||(i.y=0),o.current=!0,Math.abs(i.x)>0||Math.abs(i.y)>0){const t=Q$(e);t&&t.scrollBy({top:i.y,left:i.x})}}),[t,s,l,n,r])}({activeNode:k?x.get(k):null,config:G.layoutShiftCompensation,initialRect:K,measure:$.draggable.measure});const q=UB(H,$.draggable.measure,K),Y=UB(H?H.parentElement:null),J=Object(a.useRef)({activatorEvent:null,active:null,activeNode:H,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:x,draggingNode:null,draggingNodeRect:null,droppableContainers:I,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),X=I.getNodeFor(null==(t=J.current.over)?void 0:t.id),Z=function(e){let{measure:t}=e;const[r,n]=Object(a.useState)(null),i=$B({callback:Object(a.useCallback)((e=>{for(const{target:r}of e)if(n$(r)){n((e=>{const n=t(r);return e?{...e,width:n.width,height:n.height}:n}));break}}),[t])}),o=Object(a.useCallback)((e=>{const r=KB(e);null==i||i.disconnect(),r&&(null==i||i.observe(r)),n(r?t(r):null)}),[t,i]),[s,l]=c$(o);return Object(a.useMemo)((()=>({nodeRef:s,rect:r,setRef:l})),[r,s,l])}({measure:$.dragOverlay.measure}),Q=null!=(r=Z.nodeRef.current)?r:H,ee=S?null!=(n=Z.rect)?n:q:null,te=Boolean(Z.nodeRef.current&&Z.rect),re=function(e){return W$(e,LB(e))}(te?null:q),ne=WB(Q?t$(Q):null),ie=function(e){const t=Object(a.useRef)(e),r=l$((r=>e?r&&r!==zB&&e&&t.current&&e.parentNode===t.current.parentNode?r:Z$(e):zB),[e]);return Object(a.useEffect)((()=>{t.current=e}),[e]),r}(S?null!=X?X:H:null),oe=function(e,t){void 0===t&&(t=J$);const[r]=e,n=WB(r?t$(r):null),[i,o]=Object(a.useReducer)((function(){return e.length?e.map((e=>oB(e)?n:new hB(t(e),e))):GB}),GB),s=$B({callback:o});return e.length>0&&i===GB&&o(),o$((()=>{e.length?e.forEach((e=>null==s?void 0:s.observe(e))):(null==s||s.disconnect(),o())}),[e]),i}(ie),ae=oU(g,{transform:{x:O.x-re.x,y:O.y-re.y,scaleX:1,scaleY:1},activatorEvent:P,active:A,activeNodeRect:q,containerNodeRect:Y,draggingNodeRect:ee,over:J.current.over,overlayNodeRect:Z.rect,scrollableAncestors:ie,scrollableAncestorRects:oe,windowRect:ne}),se=W?p$(W,O):null,le=function(e){const[t,r]=Object(a.useState)(null),n=Object(a.useRef)(e),i=Object(a.useCallback)((e=>{const t=eB(e.target);!t||r((e=>e?(e.set(t,nB(t)),new Map(e)):null))}),[]);return Object(a.useEffect)((()=>{const t=n.current;if(e!==t){o(t);const a=e.map((e=>{const t=eB(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,nB(t)]):null})).filter((e=>null!=e));r(a.length?new Map(a):null),n.current=e}return()=>{o(e),o(t)};function o(e){e.forEach((e=>{const t=eB(e);null==t||t.removeEventListener("scroll",i)}))}}),[i,e]),Object(a.useMemo)((()=>e.length?t?Array.from(t.values()).reduce(((e,t)=>p$(e,t)),N$):uB(e):N$),[e,t])}(ie),ce=HB(le),ue=HB(le,[q]),de=p$(ae,ce),fe=ee?K$(ee,ae):null,he=A&&fe?h({active:A,collisionRect:fe,droppableRects:B,droppableContainers:L,pointerCoordinates:se}):null,pe=L$(he,"id"),[ge,me]=Object(a.useState)(null),ve=function(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}(te?ae:p$(ae,ue),null!=(i=null==ge?void 0:ge.rect)?i:null,q),ye=Object(a.useCallback)(((e,t)=>{let{sensor:r,options:n}=t;if(null==M.current)return;const i=x.get(M.current);if(!i)return;const o=e.nativeEvent,a=new r({active:M.current,activeNode:i,event:o,options:n,context:J,onStart(e){const t=M.current;if(null==t)return;const r=x.get(t);if(!r)return;const{onDragStart:n}=F.current,i={active:{id:t,data:r.data,rect:T}};Object(l.unstable_batchedUpdates)((()=>{null==n||n(i),E(sU.Initializing),b({type:R$.DragStart,initialCoordinates:e,active:t}),_({type:"onDragStart",event:i})}))},onMove(e){b({type:R$.DragMove,coordinates:e})},onEnd:s(R$.DragEnd),onCancel:s(R$.DragCancel)});function s(e){return async function(){const{active:t,collisions:r,over:n,scrollAdjustedTranslate:i}=J.current;let a=null;if(t&&i){const{cancelDrop:s}=F.current;a={activatorEvent:o,active:t,collisions:r,delta:i,over:n},e===R$.DragEnd&&"function"==typeof s&&await Promise.resolve(s(a))&&(e=R$.DragCancel)}M.current=null,Object(l.unstable_batchedUpdates)((()=>{b({type:e}),E(sU.Uninitialized),me(null),D(null),j(null);const t=e===R$.DragEnd?"onDragEnd":"onDragCancel";if(a){const e=F.current[t];null==e||e(a),_({type:t,event:a})}}))}}Object(l.unstable_batchedUpdates)((()=>{D(a),j(e.nativeEvent)}))}),[x]),be=function(e,t){return Object(a.useMemo)((()=>e.reduce(((e,r)=>{const{sensor:n}=r;return[...e,...n.activators.map((e=>({eventName:e.eventName,handler:t(e.handler,r)})))]}),[])),[e,t])}(f,Object(a.useCallback)(((e,t)=>(r,n)=>{const i=r.nativeEvent,o=x.get(n);if(null!==M.current||!o||i.dndKit||i.defaultPrevented)return;const a={active:o};!0===e(r,t.options,a)&&(i.dndKit={capturedBy:t.sensor},M.current=n,ye(r,t))}),[x,ye]));(function(e){Object(a.useEffect)((()=>{if(!ZL)return;const t=e.map((e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()}));return()=>{for(const e of t)null==e||e()}}),e.map((e=>{let{sensor:t}=e;return t})))})(f),o$((()=>{q&&C===sU.Initializing&&E(sU.Initialized)}),[q,C]),Object(a.useEffect)((()=>{const{onDragMove:e}=F.current,{active:t,activatorEvent:r,collisions:n,over:i}=J.current;if(!t||!r)return;const o={active:t,activatorEvent:r,collisions:n,delta:{x:de.x,y:de.y},over:i};Object(l.unstable_batchedUpdates)((()=>{null==e||e(o),_({type:"onDragMove",event:o})}))}),[de.x,de.y]),Object(a.useEffect)((()=>{const{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:i}=J.current;if(!e||null==M.current||!t||!i)return;const{onDragOver:o}=F.current,a=n.get(pe),s=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,c={active:e,activatorEvent:t,collisions:r,delta:{x:i.x,y:i.y},over:s};Object(l.unstable_batchedUpdates)((()=>{me(s),null==o||o(c),_({type:"onDragOver",event:c})}))}),[pe]),o$((()=>{J.current={activatorEvent:P,active:A,activeNode:H,collisionRect:fe,collisions:he,droppableRects:B,draggableNodes:x,draggingNode:Q,draggingNodeRect:ee,droppableContainers:I,over:ge,scrollableAncestors:ie,scrollAdjustedTranslate:de},T.current={initial:ee,translated:fe}}),[A,H,he,fe,x,Q,ee,B,I,ge,ie,de]),DB({...G,delta:O,draggingRect:fe,pointerCoordinates:se,scrollableAncestors:ie,scrollableAncestorRects:oe});const _e=Object(a.useMemo)((()=>({active:A,activeNode:H,activeNodeRect:q,activatorEvent:P,collisions:he,containerNodeRect:Y,dragOverlay:Z,draggableNodes:x,droppableContainers:I,droppableRects:B,over:ge,measureDroppableContainers:U,scrollableAncestors:ie,scrollableAncestorRects:oe,measuringConfiguration:$,measuringScheduled:z,windowRect:ne})),[A,H,q,P,he,Y,Z,x,I,B,ge,U,ie,oe,$,z,ne]),we=Object(a.useMemo)((()=>({activatorEvent:P,activators:be,active:A,activeNodeRect:q,ariaDescribedById:{draggable:V},dispatch:b,draggableNodes:x,over:ge,measureDroppableContainers:U})),[P,be,A,q,b,V,x,ge,U]);return s.a.createElement(k$.Provider,{value:w},s.a.createElement(eU.Provider,{value:we},s.a.createElement(tU.Provider,{value:_e},s.a.createElement(aU.Provider,{value:ve},d)),s.a.createElement(iU,{disabled:!1===(null==c?void 0:c.restoreFocus)})),s.a.createElement(I$,{...c,hiddenTextDescribedById:V}))})),cU=Object(a.createContext)(null),uU="button",dU="Droppable";function fU(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const o=f$(dU),{activators:s,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:h}=Object(a.useContext)(eU),{role:p=uU,roleDescription:g="draggable",tabIndex:m=0}=null!=i?i:{},v=(null==c?void 0:c.id)===t,y=Object(a.useContext)(v?aU:cU),[b,_]=c$(),[w,C]=c$(),E=function(e,t){return Object(a.useMemo)((()=>e.reduce(((e,r)=>{let{eventName:n,handler:i}=r;return e[n]=e=>{i(e,t)},e}),{})),[e,t])}(s,t),S=s$(r);o$((()=>(f.set(t,{id:t,key:o,node:b,activatorNode:w,data:S}),()=>{const e=f.get(t);e&&e.key===o&&f.delete(t)})),[f,t]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:Object(a.useMemo)((()=>({role:p,tabIndex:m,"aria-disabled":n,"aria-pressed":!(!v||p!==uU)||void 0,"aria-roledescription":g,"aria-describedby":d.draggable})),[n,p,m,v,g,d.draggable]),isDragging:v,listeners:n?void 0:E,node:b,over:h,setNodeRef:_,setActivatorNodeRef:C,transform:y}}function hU(){return Object(a.useContext)(tU)}const pU="Droppable",gU={timeout:25};function mU(e){let{animation:t,children:r}=e;const[n,i]=Object(a.useState)(null),[o,l]=Object(a.useState)(null),c=u$(r);return!r&&!n&&c&&i(c),o$((()=>{if(!o)return;const e=null==n?void 0:n.key,r=null==n?void 0:n.props.id;null!=e&&null!=r?Promise.resolve(t(r,o)).then((()=>{i(null)})):i(null)}),[t,n,o]),s.a.createElement(s.a.Fragment,null,r,n?Object(a.cloneElement)(n,{ref:l}):null)}const vU={x:0,y:0,scaleX:1,scaleY:1};function yU(e){let{children:t}=e;return s.a.createElement(eU.Provider,{value:QB},s.a.createElement(aU.Provider,{value:vU},t))}const bU={position:"fixed",touchAction:"none"},_U=e=>m$(e)?"transform 250ms ease":void 0,wU=Object(a.forwardRef)(((e,t)=>{let{as:r,activatorEvent:n,adjustScale:i,children:o,className:a,rect:l,style:c,transform:u,transition:d=_U}=e;if(!l)return null;const f=i?u:{...u,scaleX:1,scaleY:1},h={...bU,width:l.width,height:l.height,top:l.top,left:l.left,transform:y$.Transform.toString(f),transformOrigin:i&&n?P$(n,l):void 0,transition:"function"==typeof d?d(n):d,...c};return s.a.createElement(r,{className:a,style:h,ref:t},o)})),CU=e=>t=>{let{active:r,dragOverlay:n}=t;const i={},{styles:o,className:a}=e;if(null!=o&&o.active)for(const[e,t]of Object.entries(o.active))void 0!==t&&(i[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=o&&o.dragOverlay)for(const[e,t]of Object.entries(o.dragOverlay))void 0!==t&&n.node.style.setProperty(e,t);return null!=a&&a.active&&r.node.classList.add(a.active),null!=a&&a.dragOverlay&&n.node.classList.add(a.dragOverlay),function(){for(const[e,t]of Object.entries(i))r.node.style.setProperty(e,t);null!=a&&a.active&&r.node.classList.remove(a.active)}},EU={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:y$.Transform.toString(t)},{transform:y$.Transform.toString(r)}]},sideEffects:CU({styles:{active:{opacity:"0"}}})};function SU(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:i}=e;return a$(((e,o)=>{if(null===t)return;const a=r.get(e);if(!a)return;const s=a.node.current;if(!s)return;const l=KB(o);if(!l)return;const{transform:c}=t$(o).getComputedStyle(o),u=q$(c);if(!u)return;const d="function"==typeof t?t:function(e){const{duration:t,easing:r,sideEffects:n,keyframes:i}={...EU,...e};return e=>{let{active:o,dragOverlay:a,transform:s,...l}=e;if(!t)return;const c={x:a.rect.left-o.rect.left,y:a.rect.top-o.rect.top},u={scaleX:1!==s.scaleX?o.rect.width*s.scaleX/a.rect.width:1,scaleY:1!==s.scaleY?o.rect.height*s.scaleY/a.rect.height:1},d={x:s.x-c.x,y:s.y-c.y,...u},f=i({...l,active:o,dragOverlay:a,transform:{initial:s,final:d}}),[h]=f,p=f[f.length-1];if(JSON.stringify(h)===JSON.stringify(p))return;const g=null==n?void 0:n({active:o,dragOverlay:a,...l}),m=a.node.animate(f,{duration:t,easing:r,fill:"forwards"});return new Promise((e=>{m.onfinish=()=>{null==g||g(),e()}}))}}(t);return dB(s,i.draggable.measure),d({active:{id:e,data:a.data,node:s,rect:i.draggable.measure(s)},draggableNodes:r,dragOverlay:{node:o,rect:i.dragOverlay.measure(l)},droppableContainers:n,measuringConfiguration:i,transform:u})}))}let kU=0;const xU=s.a.memo((e=>{let{adjustScale:t=!1,children:r,dropAnimation:n,style:i,transition:o,modifiers:l,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:f,active:h,activeNodeRect:p,containerNodeRect:g,draggableNodes:m,droppableContainers:v,dragOverlay:y,over:b,measuringConfiguration:_,scrollableAncestors:w,scrollableAncestorRects:C,windowRect:E}=hU(),S=Object(a.useContext)(aU),k=function(e){return Object(a.useMemo)((()=>{if(null!=e)return kU++,kU}),[e])}(null==h?void 0:h.id),x=oU(l,{activatorEvent:f,active:h,activeNodeRect:p,containerNodeRect:g,draggingNodeRect:y.rect,over:b,overlayNodeRect:y.rect,scrollableAncestors:w,scrollableAncestorRects:C,transform:S,windowRect:E}),O=LB(p),I=SU({config:n,draggableNodes:m,droppableContainers:v,measuringConfiguration:_}),R=O?y.setRef:void 0;return s.a.createElement(yU,null,s.a.createElement(mU,{animation:I},h&&k?s.a.createElement(wU,{key:k,id:h.id,ref:R,as:c,activatorEvent:f,adjustScale:t,className:u,transition:o,rect:O,style:{zIndex:d,...i},transform:x},r):null))}));function OU(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function IU(e,t){return e.reduce(((e,r,n)=>{const i=t.get(r);return i&&(e[n]=i),e}),Array(e.length))}function RU(e){return null!==e&&e>=0}const TU={scaleX:1,scaleY:1},AU=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:i,overIndex:o,index:a}=e;const s=null!=(t=r[i])?t:n;if(!s)return null;const l=function(e,t,r){const n=e[t],i=e[t-1],o=e[t+1];return n&&(i||o)?r<t?i?n.left-(i.left+i.width):o.left-(n.left+n.width):o?o.left-(n.left+n.width):n.left-(i.left+i.width):0}(r,a,i);if(a===i){const e=r[o];return e?{x:i<o?e.left+e.width-(s.left+s.width):e.left-s.left,y:0,...TU}:null}return a>i&&a<=o?{x:-s.width-l,y:0,...TU}:a<i&&a>=o?{x:s.width+l,y:0,...TU}:{x:0,y:0,...TU}};const MU=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const o=OU(t,n,r),a=t[i],s=o[i];return s&&a?{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}:null},NU={scaleX:1,scaleY:1},DU=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:o,overIndex:a}=e;const s=null!=(t=o[r])?t:n;if(!s)return null;if(i===r){const e=o[a];return e?{x:0,y:r<a?e.top+e.height-(s.top+s.height):e.top-s.top,...NU}:null}const l=function(e,t,r){const n=e[t],i=e[t-1],o=e[t+1];return n?r<t?i?n.top-(i.top+i.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}(o,i,r);return i>r&&i<=a?{x:0,y:-s.height-l,...NU}:i<r&&i>=a?{x:0,y:s.height+l,...NU}:{x:0,y:0,...NU}};const PU="Sortable",jU=s.a.createContext({activeIndex:-1,containerId:PU,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:MU,disabled:{draggable:!1,droppable:!1}});function FU(e){let{children:t,id:r,items:n,strategy:i=MU,disabled:o=!1}=e;const{active:l,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:f}=hU(),h=f$(PU,r),p=Boolean(null!==c.rect),g=Object(a.useMemo)((()=>n.map((e=>"object"==typeof e&&"id"in e?e.id:e))),[n]),m=null!=l,v=l?g.indexOf(l.id):-1,y=d?g.indexOf(d.id):-1,b=Object(a.useRef)(g),_=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(g,b.current),w=-1!==y&&-1===v||_,C=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(o);o$((()=>{_&&m&&f(g)}),[_,g,m,f]),Object(a.useEffect)((()=>{b.current=g}),[g]);const E=Object(a.useMemo)((()=>({activeIndex:v,containerId:h,disabled:C,disableTransforms:w,items:g,overIndex:y,useDragOverlay:p,sortedRects:IU(g,u),strategy:i})),[v,h,C.draggable,C.droppable,w,g,y,u,p,i]);return s.a.createElement(jU.Provider,{value:E},t)}const VU=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return OU(r,n,i).indexOf(t)},LU=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:o,newIndex:a,previousItems:s,previousContainerId:l,transition:c}=e;return!(!c||!n||s!==o&&i===a)&&(!!r||a!==i&&t===l)},$U={duration:200,easing:"ease"},BU="transform",UU=y$.Transition.toString({property:BU,duration:0,easing:"linear"}),zU={roleDescription:"sortable"};function HU(e){let{animateLayoutChanges:t=LU,attributes:r,disabled:n,data:i,getNewIndex:o=VU,id:s,strategy:l,resizeObserverConfig:c,transition:u=$U}=e;const{items:d,containerId:f,activeIndex:h,disabled:p,disableTransforms:g,sortedRects:m,overIndex:v,useDragOverlay:y,strategy:b}=Object(a.useContext)(jU),_=function(e,t){var r,n;return"boolean"==typeof e?{draggable:e,droppable:!1}:{draggable:null!=(r=null==e?void 0:e.draggable)?r:t.draggable,droppable:null!=(n=null==e?void 0:e.droppable)?n:t.droppable}}(n,p),w=d.indexOf(s),C=Object(a.useMemo)((()=>({sortable:{containerId:f,index:w,items:d},...i})),[f,i,w,d]),E=Object(a.useMemo)((()=>d.slice(d.indexOf(s))),[d,s]),{rect:S,node:k,isOver:x,setNodeRef:O}=function(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const o=f$(pU),{active:s,dispatch:l,over:c,measureDroppableContainers:u}=Object(a.useContext)(eU),d=Object(a.useRef)({disabled:r}),f=Object(a.useRef)(!1),h=Object(a.useRef)(null),p=Object(a.useRef)(null),{disabled:g,updateMeasurementsFor:m,timeout:v}={...gU,...i},y=s$(null!=m?m:n),b=$B({callback:Object(a.useCallback)((()=>{f.current?(null!=p.current&&clearTimeout(p.current),p.current=setTimeout((()=>{u(Array.isArray(y.current)?y.current:[y.current]),p.current=null}),v)):f.current=!0}),[v]),disabled:g||!s}),_=Object(a.useCallback)(((e,t)=>{!b||(t&&(b.unobserve(t),f.current=!1),e&&b.observe(e))}),[b]),[w,C]=c$(_),E=s$(t);return Object(a.useEffect)((()=>{!b||!w.current||(b.disconnect(),f.current=!1,b.observe(w.current))}),[w,b]),o$((()=>(l({type:R$.RegisterDroppable,element:{id:n,key:o,disabled:r,node:w,rect:h,data:E}}),()=>l({type:R$.UnregisterDroppable,key:o,id:n}))),[n]),Object(a.useEffect)((()=>{r!==d.current.disabled&&(l({type:R$.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)}),[n,o,r,l]),{active:s,rect:h,isOver:(null==c?void 0:c.id)===n,node:w,over:c,setNodeRef:C}}({id:s,data:C,disabled:_.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:I,activatorEvent:R,activeNodeRect:T,attributes:A,setNodeRef:M,listeners:N,isDragging:D,over:P,setActivatorNodeRef:j,transform:F}=fU({id:s,data:C,attributes:{...zU,...r},disabled:_.draggable}),V=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(a.useMemo)((()=>e=>{t.forEach((t=>t(e)))}),t)}(O,M),L=Boolean(I),$=L&&!g&&RU(h)&&RU(v),B=!y&&D,U=B&&$?F:null,z=$?null!=U?U:(null!=l?l:b)({rects:m,activeNodeRect:T,activeIndex:h,overIndex:v,index:w}):null,H=RU(h)&&RU(v)?o({id:s,items:d,activeIndex:h,overIndex:v}):w,W=null==I?void 0:I.id,G=Object(a.useRef)({activeId:W,items:d,newIndex:H,containerId:f}),K=d!==G.current.items,q=t({active:I,containerId:f,isDragging:D,isSorting:L,id:s,index:w,items:d,newIndex:G.current.newIndex,previousItems:G.current.items,previousContainerId:G.current.containerId,transition:u,wasDragging:null!=G.current.activeId}),Y=function(e){let{disabled:t,index:r,node:n,rect:i}=e;const[o,s]=Object(a.useState)(null),l=Object(a.useRef)(r);return o$((()=>{if(!t&&r!==l.current&&n.current){const e=i.current;if(e){const t=J$(n.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&s(r)}}r!==l.current&&(l.current=r)}),[t,r,n,i]),Object(a.useEffect)((()=>{o&&s(null)}),[o]),o}({disabled:!q,index:w,node:k,rect:S});return Object(a.useEffect)((()=>{L&&G.current.newIndex!==H&&(G.current.newIndex=H),f!==G.current.containerId&&(G.current.containerId=f),d!==G.current.items&&(G.current.items=d)}),[L,H,f,d]),Object(a.useEffect)((()=>{if(W===G.current.activeId)return;if(W&&!G.current.activeId)return void(G.current.activeId=W);const e=setTimeout((()=>{G.current.activeId=W}),50);return()=>clearTimeout(e)}),[W]),{active:I,activeIndex:h,attributes:A,data:C,rect:S,index:w,newIndex:H,items:d,isOver:x,isSorting:L,isDragging:D,listeners:N,node:k,overIndex:v,over:P,setNodeRef:V,setActivatorNodeRef:j,setDroppableNodeRef:O,setDraggableNodeRef:M,transform:null!=Y?Y:z,transition:function(){if(Y||K&&G.current.newIndex===w)return UU;if((!B||m$(R))&&u&&(L||q))return y$.Transition.toString({...u,property:BU})}()}}vB.Down,vB.Right,vB.Up,vB.Left;const WU=e=>{let{transform:t}=e;return{...t,y:0}};function GU(e,t,r){const n={...e};return t.top+e.y<=r.top?n.y=r.top-t.top:t.bottom+e.y>=r.top+r.height&&(n.y=r.top+r.height-t.bottom),t.left+e.x<=r.left?n.x=r.left-t.left:t.right+e.x>=r.left+r.width&&(n.x=r.left+r.width-t.right),n}const KU=e=>{let{containerNodeRect:t,draggingNodeRect:r,transform:n}=e;return r&&t?GU(n,r,t):n},qU=e=>{let{draggingNodeRect:t,transform:r,scrollableAncestorRects:n}=e;const i=n[0];return t&&i?GU(r,t,i):r},YU=e=>{let{transform:t}=e;return{...t,x:0}},JU={CommentBubble:N.default,Edit:D.default,Delete:P.default,ReviewArrowRight:j.default,MoreHorizontal:F.default,ArrowDown:V.default,ArrowUp:L.default,ArrowRight:$.default,ArrowLeft:B.default,Addlink:U.default,Add:z.default,Check:H.default,Question:W.default,Close:G.default,Drag:K.default,Preview:q.default,Download:Y.default,EditorPaste:J.default,FieldText:X.default,FieldSelect:Z.default,FieldMultiSelect:Q.default,FieldEmail:ee.default,FieldInput:te.default,FieldFile:re.default,FieldImage:ne.default,FieldLink:ie.default,FieldCreator:oe.default,FieldModifier:ae.default,FieldNumber:se.default,FieldMention:le.default,FieldPhone:ce.default,FieldCheckbox:ue.default,FieldDate:de.default,FieldCreatedAt:fe.default,FieldUpdatedAt:he.default,RowExpand:pe.default,RowCollpse:ge.default,Search:me.default,UpArrow:ve.default,DownArrow:ye.default,RightArrow:be.default,LeftArrow:_e.default,IconHide:we.default,RowHeightLow:Ce.default,RowHeightMiddle:Ee.default,RowHeightHigh:Se.default,GridView:ke.default,CardView:xe.default,KanbanView:Oe.default,Clear:Ie.default,ViewerFilter:Re.default,ViewerSort:Te.default,ViewerGroup:Ae.default,Setting:Me.default,ReviewArrowDown:Ne.default,Fullscreen:De.default,FullWidth:Pe.default,NormalWidth:je.default,FormView:Fe.default,Copy:Ve.default,FileDefault:Le.default,FileDefaultDark:$e.default,FileAi:Be.default,FileAiDark:Ue.default,FileExcel:ze.default,FileExcelDark:He.default,FileAudio:We.default,FileAudioDark:Ge.default,FileAxure:Ke.default,FileAxureDark:qe.default,FileDoc:Ye.default,FileDocDark:Je.default,FileGraffle:Xe.default,FileGraffleDark:Ze.default,FileImage:Qe.default,FileImageDark:et.default,FileKeynote:tt.default,FileKeynoteDark:rt.default,FileMindmap:nt.default,FileMindmapDark:it.default,FileMindnode:ot.default,FileMindnodeDark:at.default,FileXmind:st.default,FileXmindDark:lt.default,FileTxt:ct.default,FileTxtDark:ut.default,FileNumbers:dt.default,FileNumbersDark:ft.default,FileFolder:ht.default,FileFolderDark:pt.default,FilePdf:gt.default,FilePdfDark:mt.default,FilePpt:vt.default,FilePptDark:yt.default,FilePsd:bt.default,FilePsdDark:_t.default,FileRar:wt.default,FileRarDark:Ct.default,FileSheet:Et.default,FileSheetDark:St.default,FileSketch:kt.default,FileSketchDark:xt.default,FileVideo:Ot.default,FileVideoDark:It.default,FileWord:Rt.default,FileWordDark:Tt.default,Loading:At.default,Upload:Mt.default,NavBuildarea:Nt.default,NavDay:Dt.default,NavNight:Pt.default,Change:jt.default};const XU=e=>{let{type:t,size:r,className:n,...i}=e;if(!t)return null;const o=JU[t];if(!o)return null;r=function(e,t){return"FormView"===e&&t&&(t+=1),t}(t,r);const a={type:t,...i};return r&&(a.width=+r,a.height=+r),s.a.createElement("span",{className:`larkui-icon-wrap larkui-icon-wrap-${t} ${n||""}`},s.a.createElement(o,{...a}))},ZU=e=>{const{ext:t,...r}=e,n=HL(jD),i="dark"===(null==n?void 0:n.getCurrent()),o="File"+fN(e.ext);let a=o;return i&&(a=o+"Dark"),s.a.createElement(XU,{type:a,...r})},QU=({menu:e,readonly:t,defaultSelectedKeys:r=[],editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:h})=>s.a.createElement(d.a.Item,{key:e.key,eventKey:e.key,icon:e.icon,onDoubleClick:t=>{t.key=e.key,a(t)},onClick:()=>{l(e)},className:qL({"lakex-table-menu-item-selected":r.includes(e.key),"lakex-table-menu-item-multi-line":e.desc})},e.key===n?s.a.createElement(u.a,{className:"lakex-table-menu-configs-input",defaultValue:e.title,autoFocus:!0,onKeyDown:t=>{var r;t.stopPropagation();const n=t.keyCode;27!==n?13===n&&(null==(r=e.onTitleChange)||r.call(e,t,e)):c&&c()},onClick:e=>e.stopPropagation(),onBlur:t=>{var r;return null==(r=e.onTitleChange)?void 0:r.call(e,t,e)}}):s.a.createElement("div",null,e.title,e.desc&&s.a.createElement("div",{className:"lakex-table-menu-configs-desc"},e.desc)),e.settings&&!t&&s.a.createElement(f.a,{overlayClassName:"lakex-table-menu-container lakex-table-menu-configs-settings",content:s.a.createElement(d.a,{onClick:(...t)=>{e.onSettingClick&&e.onSettingClick(e,...t),h(!1,e)}},e.settings.map(((e,r)=>s.a.createElement(QU,{key:r,readonly:t,menu:e,editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:h})))),trigger:"click",placement:"rightTop",visible:i===e.key&&o,onClick:e=>e.stopPropagation(),onVisibleChange:t=>h(t,e)},s.a.createElement(XU,{type:"MoreHorizontal",size:14})),e.showActiveIcon&&s.a.createElement(XU,{type:"Check",size:14})),ez=({menu:e,index:t,readonly:r,defaultSelectedKeys:n=[],editingKey:i,visibleKey:o,settingVisible:a,onDoubleClick:l,onClick:c,onInputBlur:u,handleVisibleChange:f})=>{const h=e.key?e.key+t:t;let p=e.children;if(e.groupBy){const t=e.children.reduce(((t,r)=>{const n=r[e.groupBy];return t[n]||(t[n]=[]),t[n].push(r),t}),{});Object.values(t).length>1&&(p=t)}return s.a.createElement(d.a.SubMenu,{key:h,eventKey:h,icon:e.icon,title:s.a.createElement("span",{className:"lakex-table-menu-item-title"},s.a.createElement("span",null,e.title),s.a.createElement($.default,{width:16,height:16})),popupClassName:`lakex-table-menu-container lakex-table-menu-configs-submenu ${e.className}`},Array.isArray(p)?p.map(((e,t)=>s.a.createElement(QU,{key:t,readonly:r,menu:e,defaultSelectedKeys:n,editingKey:i,visibleKey:o,settingVisible:a,onDoubleClick:l,onClick:c,onInputBlur:u,handleVisibleChange:f}))):Object.keys(p).map((e=>s.a.createElement(d.a.ItemGroup,{key:e,title:e},p[e].map(((e,t)=>s.a.createElement(QU,{key:t,readonly:r,menu:e,defaultSelectedKeys:n,editingKey:i,visibleKey:o,settingVisible:a,onDoubleClick:l,onClick:c,onInputBlur:u,handleVisibleChange:f})))))))},tz=({menu:e,readonly:t,defaultSelectedKeys:r=[],editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:u})=>{const{attributes:d,listeners:f,setNodeRef:h,transform:p,transition:g,isDragging:m}=HU({id:e.key}),v={transform:y$.Transform.toString(p),transition:g,zIndex:m?"100":"auto",opacity:m?.3:1};return s.a.createElement("div",{key:e.key,ref:h,style:{...v},...f,...d},s.a.createElement(QU,{key:e.key,readonly:t,menu:e,defaultSelectedKeys:r,editingKey:n,visibleKey:i,settingVisible:o,onDoubleClick:a,onClick:l,onInputBlur:c,handleVisibleChange:u}))},rz=({readonly:e,configs:t,defaultSelectedKeys:r,draggable:n=!1,editingKey:i,visibleKey:o,settingVisible:l,onClick:c,onDoubleClick:u,onDragEnd:d,onInputBlur:f,handleVisibleChange:h})=>{const p=M$(A$(OB,{activationConstraint:{distance:8}})),g=t.map(((t,a)=>{const d=t.key?t.key+a:a;return t.children?s.a.createElement(ez,{key:d,index:a,readonly:e,menu:t,defaultSelectedKeys:r,editingKey:i,visibleKey:o,settingVisible:l,onDoubleClick:u,onClick:c,onInputBlur:f,handleVisibleChange:h}):n?s.a.createElement(tz,{key:d,readonly:e,menu:t,defaultSelectedKeys:r,editingKey:i,visibleKey:o,settingVisible:l,onDoubleClick:u,onClick:c,onInputBlur:f,handleVisibleChange:h}):s.a.createElement(QU,{key:d,readonly:e,menu:t,defaultSelectedKeys:r,editingKey:i,visibleKey:o,settingVisible:l,onDoubleClick:u,onClick:c,onInputBlur:f,handleVisibleChange:h})})),m=Object(a.useMemo)((()=>t.map((e=>({...e,id:e.key})))),[t]);return n?s.a.createElement(lU,{sensors:p,modifiers:[YU,KU],collisionDetection:B$,onDragEnd:d},s.a.createElement(FU,{items:m,strategy:DU},g)):g},nz=e=>{const{readonly:t=!1,draggable:r,className:n,defaultSelectedKeys:i,menuKey:o,onDragEnd:l,onInputBlur:c}=e,{state:u,onClick:f,onDoubleClick:h,handleVisibleChange:p}=(e=>{const t=Object(a.useRef)(null),r=Object(a.useRef)(!1),[n,i]=Object(a.useState)(e.configs),[o,s]=Object(a.useState)(!1),[l,c]=Object(a.useState)(""),[u,d]=Object(a.useState)(e.editingKey||"");return Object(a.useEffect)((()=>{d(e.editingKey)}),[e.editingKey]),Object(a.useEffect)((()=>{i(e.configs)}),[e.configs]),{state:{configs:n,settingVisible:o,visibleKey:l,editingKey:u},timer:t,prevent:r,delay:200,handleVisibleChange:(e,t)=>{s(e),c(e?t.key:"")},onClick:n=>{e.onDoubleClick?t.current=setTimeout((()=>{r.current||null==e||e.onClick(n)}),200):null==e||e.onClick(n)},onDoubleClick:n=>{clearTimeout(t.current),r.current=!0,null==e||e.onDoubleClick(n),setTimeout((()=>{r.current=!1}),200)}}})(e),{configs:g,editingKey:m,visibleKey:v,settingVisible:y}=u;return s.a.createElement(d.a,{className:`lakex-table-menu-configs ${n}`,mode:"vertical",defaultSelectedKeys:i,key:o},s.a.createElement(rz,{readonly:t,configs:g,draggable:r,defaultSelectedKeys:i,editingKey:m,visibleKey:v,settingVisible:y,onClick:f,onDoubleClick:h,onDragEnd:l,onInputBlur:c,handleVisibleChange:p}))};class iz extends s.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var r,n;null==(n=(r=this.props).onError)||n.call(r,e,t)}render(){return this.props.children}}const oz=({src:e,darkSrc:t,width:r,height:n,theme:i,style:o,darkAlpha:l,className:c,children:u,...d})=>{r=r||(null==o?void 0:o.width),n=n||(null==o?void 0:o.height);const f=HL(jD),[h,p]=s.a.useState(i||(null==f?void 0:f.getCurrent())),[g,m]=s.a.useState(h===M.Theme.dark?t:e);if(Object(a.useEffect)((()=>{null==f||f.onChange((r=>{p(r),m(r===M.Theme.dark?t:e)}))}),[]),!g)return null;const v={width:r,height:n,...o};return v.backgroundImage=`url(${g})`,h===M.Theme.dark&&l&&(v.opacity=l),u?s.a.createElement("div",{className:qL("lakex-table-image",c),style:v,...d},u):(delete v.backgroundImage,s.a.createElement("img",{src:g,className:qL("lakex-table-image",c),style:v,...d}))};oz.displayName="Image";var az=(e=>(e.Unauthorized="401",e.Forbidden="403",e.Notfound="404",e))(az||{});const sz=e=>s.a.createElement("div",{className:"lakex-table-view-permission-401"},s.a.createElement("img",{className:"lakex-table-view-permission-img",src:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*hPb5R6QBhj4AAAAAAAAAAAAADvuFAQ/original"}),s.a.createElement("h2",{className:"lakex-table-view-permission-title"},Ph("无权访问当前视图")),s.a.createElement("div",{className:"lakex-table-view-permission-desc"},e.desc||Ph("查看视图需要编辑权限"))),lz=e=>{let t;return"401"===e.type&&(t=s.a.createElement(sz,{desc:e.desc})),s.a.createElement("div",{className:"lakex-table-view-permission"},t)};var cz=(e=>(e.Checkbox="checkbox",e.Radio="radio",e))(cz||{});const uz=e=>s.a.createElement("div",{className:"lakex-table-form-checkbox-readonly"},s.a.createElement(h.a,{checked:e.value,onChange:t=>{const r=t.target.checked;e.onChange(r)}}));function dz(){const[e,t]=Object(a.useState)(0);return()=>t((e=>e+1))}const fz=$i.defineToken("HotKeyServiceToken"),hz=$i.defineToken("HotkeyContribution"),pz={preventDefault:!1,enableOnInput:!1,isEnable:()=>!0},gz=fa.isMac,mz={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},vz={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:gz?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},yz={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(let e=1;e<20;e++)yz["f"+e]=111+e;function bz(e){return e=e.toLowerCase(),e=vz[e]||e}function _z(e){return e=bz(e),yz[e]||e.toUpperCase().charCodeAt(0)}function wz(e,t,r){t&&!("byKey"in t)&&(r=t,t=null),Array.isArray(e)||(e=[e]);const n=e.map((e=>function(e,t){const r=t&&t.byKey,n={},i=(e=e.replace("++","+add")).split("+"),{length:o}=i;for(const e in mz)n[mz[e]]=!1;for(let e of i){const t=e.endsWith("?");t&&(e=e.slice(0,-1));const i=bz(e),a=mz[i];(1===o||!a)&&(r?n.key=i:n.which=_z(e)),a&&(n[a]=!t||null),1===o&&!a&&r&&(n.shiftKey=null)}return n}(e,t))),i=e=>n.some((t=>function(e,t){for(const r in e){const n=e[r];let i;if(null!=n&&(i="key"===r?t.key.toLowerCase():"which"===r?91===n&&93===t.which?91:t.which:t[r],(null!=i||!1!==n)&&i!==n))return!1}return!0}(t,e)));return null==r?i:i(r)}const Cz={esc:xN.ESC,left:xN.LEFT,up:xN.UP,right:xN.RIGHT,down:xN.DOWN,enter:xN.ENTER,tab:xN.TAB,space:xN.SPACE,del:xN.DEL,backspace:xN.BACKSPACE},Ez=Object.keys(Cz).reduce(((e,t)=>(e[Cz[t]]=t,e)),{});function Sz(e=""){return Ez[e]||e.toUpperCase()}function kz(e){return jo(e)?fa.isWin?e.replace(/⌘/g,"ctrl").replace(/option/g,"alt"):e:(console.error("hotKey needs to be string!"),"")}const xz=e=>{const{altKey:t,ctrlKey:r,metaKey:n,shiftKey:i,key:o}=e,a={"⌘":n,shift:i,alt:t,ctrl:r,[o]:Sz(o)};return Object.keys(a).reduce(((e,t)=>{const r=a[t];return r&&e.push(jo(r)?r:t),e}),[]).sort(((e,t)=>Number(e)-Number(t))).join("+")},Oz=e=>jo(e)?e.split(/[,]\s+/):[],Iz=(e,t)=>{const r=xz(e),n=kz(t);return(Oz(n)||[]).some((e=>e===r))};var Rz;(e=>{e.adapterHotKey=kz,e.isKeyboardEventMatchingHotkey=Iz,e.getFormatHotkey=Sz,e.keyEventToHotKey=xz})(Rz||(Rz={}));var Tz=Object.defineProperty,Az=Object.getOwnPropertyDescriptor,Mz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Az(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Tz(t,r,o),o};let Nz=class{constructor(){this._hotkeys=new Map,this._hotkeyToCommandId=new Map,this._init=!1}init(){if(this._init)return;this._init=!0;const e=this._hotkeyPluginProvider.getContributions();for(const t of e)try{t.registerHotkey(this)}catch(e){console.error(e)}}registerItem(e){const{id:t,hotkey:r}=e;if(this._hotkeys.has(t))throw new Error(`A hotkey is already registered with the id '${t}'`);this._hotkeys.set(t,{...e,preventDefault:Lo(e.preventDefault)?pz.preventDefault:e.preventDefault,enableOnInput:Lo(e.enableOnInput)?pz.enableOnInput:e.enableOnInput,isEnable:Lo(e.isEnable)?pz.isEnable:e.isEnable}),Oz(r).forEach((e=>{const r=Rz.adapterHotKey(e),n=this._hotkeyToCommandId.get(r)||[];n.push(t),this._hotkeyToCommandId.set(r,n)}))}getRegisterHotkeyIdsByPressedKey(e){return this._hotkeyToCommandId.get(e)}getHotkeyItem(e){return this._hotkeys.get(e)}getHotkeyItems(){return this._hotkeys.values()}unRegister(){this._hotkeys.clear(),this._hotkeyToCommandId.clear()}};Mz([wh(hz)],Nz.prototype,"_hotkeyPluginProvider",2),Nz=Mz([io()],Nz);const Dz=$i.defineToken("RenderPluginContribution"),Pz=$i.defineToken("RenderPluginFieldContribution");var jz=(e=>(e.NORMAL="normal",e.MOBILE="mobile",e))(jz||{});const Fz=null;var Vz=(e=>(e.NORMAL="normal",e.LITE="lite",e))(Vz||{});const Lz=$i.defineToken("ViewerContribution");var $z=(e=>(e.ACTIVE="active",e.INACTIVE="inactive",e))($z||{});const Bz=$i.defineToken("ActiveTableServiceToken"),Uz=null;var zz=Object.defineProperty,Hz=Object.getOwnPropertyDescriptor;let Wz=class{getRenderBoundingClientRect(){const e=this.$workbenchRoot.querySelector(".lakex-table-workbench-toolbar-container");if(e){const t=this.$workbenchRoot.getBoundingClientRect(),r=this.$root.getBoundingClientRect();return new DOMRect(r.x,r.y,r.width,t.height-e.getBoundingClientRect().height)}return this.$root.getBoundingClientRect()}};Wz=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Hz(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zz(t,r,o),o})([io()],Wz);var Gz=Object.defineProperty,Kz=Object.getOwnPropertyDescriptor,qz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Kz(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gz(t,r,o),o};let Yz=class{constructor(){this._viewport=null,this._resizeListener=null}get viewport(){return this._viewport||this._updateViewport(),this._viewport}init(){this._resizeListener=EL(this._renderContextService.$root,"resize",(()=>{this._updateViewport()}))}destroy(){var e;null==(e=this._resizeListener)||e.destroy()}_updateViewport(){const e=this._renderContextService.$root;this._viewport=e.getBoundingClientRect()}isDotInViewPort(e,t){if(!this._viewport)return!1;const r=e>this._viewport.left&&e<this._viewport.right,n=t>this._viewport.top&&t<this._viewport.bottom;return r&&n}};qz([ao(Wz)],Yz.prototype,"_renderContextService",2),Yz=qz([io()],Yz);var Jz=Object.defineProperty,Xz=Object.getOwnPropertyDescriptor,Zz=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xz(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jz(t,r,o),o};let Qz=class extends fp{constructor(){super(...arguments),this._viewNodes=new Map,this._viewProxy=null,this._isFirstRender=!0,this._onDoubleClickCell=this._register(new _p),this.onDoubleClickCell=this._onDoubleClickCell.event,this._onClickCellIcon=this._register(new _p),this.onClickCellIcon=this._onClickCellIcon.event,this._onClickRecord=this._register(new _p),this.onClickRecord=this._onClickRecord.event,this._onClickEvent=this._register(new _p),this.onClickEvent=this._onClickEvent.event,this._onClickIcon=this._register(new _p),this.onClickIcon=this._onClickIcon.event,this._onScroll=this._register(new _p),this.onScroll=this._onScroll.event,this.hooks={beforeRender:new uE,afterRender:new uE,destroy:new uE},this._handleScroll=()=>{this.emitOnScroll(1)}}emitDoubleClickCell(e){this._onDoubleClickCell.emit(e)}emitClickCellIcon(e){this._onClickCellIcon.emit(e)}emitClickRecord(e){this._onClickRecord.emit(e)}emitClickEvent(e){this._onClickEvent.emit(e)}emitClickIcon(e){this._onClickIcon.emit(e)}emitOnScroll(e){this._onScroll.emit(e)}async init({onError:e}){this.configuration.getValue("render.autoActive")&&this.activeTableService.active(),this.onError=e,this._initPlugins(),this._initViewers()}initDom(e,t){this.renderContextService.$root=e,this.renderContextService.$workbenchRoot=t,this._renderViewPort.init(),this.renderContextService.$root.addEventListener("wheel",this._handleScroll,{passive:!0})}_initPlugins(){this.renderPluginProvider.getContributions({cache:!1}).forEach((e=>{e.init(this)}))}_initViewers(){this.viewerProvider.getContributions({cache:!1}).forEach((e=>{e.registerViewer(this)}))}render(e,t){this.hooks.beforeRender.call(),this._renderViewer(e.get("uuid"),e.get("type"),t),this.hooks.afterRender.call()}destroy(){var e,t;super.destroy(),this.renderPluginProvider.getContributions({cache:!1}).forEach((e=>{var t;null==(t=e.destroy)||t.call(e)})),this._renderViewPort.destroy(),this.hooks.destroy.call(),this._viewNodes.clear(),null==(e=this._viewProxy)||e.destroy(),this._viewProxy=null,this.renderContextService.$root.removeEventListener("wheel",this._handleScroll),null==(t=this.renderContextService.$root.parentNode)||t.removeChild(this.renderContextService.$root)}_renderViewer(e,t,r){var n;const i=this.renderContextService.$root,o=this._viewNodes.get(t);null==(n=this._viewProxy)||n.destroy(),this._viewProxy=o?o.render(i,{viewId:e},r):null,this._viewProxy||(i.innerHTML="",i.appendChild(this._defaultViewer())),this._isFirstRender&&(this._lifeService.status=kh.Rendered,this._isFirstRender=!1)}_defaultViewer(){const e=document.createElement("h3");return e.innerHTML="没有注册 Viewer 这里是骨架屏",e}registerItem(e){if(this._viewNodes.get(e.viewType))throw Error(`${e.viewType} view has been registered`);this._viewNodes.set(e.viewType,e)}getViewNodes(){return this._viewNodes}};Zz([wh(Dz)],Qz.prototype,"renderPluginProvider",2),Zz([wh(Lz)],Qz.prototype,"viewerProvider",2),Zz([ao(Wz)],Qz.prototype,"renderContextService",2),Zz([ao(lp)],Qz.prototype,"configuration",2),Zz([ao(Bz)],Qz.prototype,"activeTableService",2),Zz([ao(Yz)],Qz.prototype,"_renderViewPort",2),Zz([ao(xh)],Qz.prototype,"_lifeService",2),Zz([Ii()],Qz.prototype,"destroy",1),Qz=Zz([io()],Qz);var eH=Object.defineProperty,tH=Object.getOwnPropertyDescriptor,rH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eH(t,r,o),o};let nH=class{constructor(){this.getFieldComponent=e=>{var t,r;return null==(r=null==(t=this.getFieldTargetPlugin(e))?void 0:t.getFieldComponent)?void 0:r.call(t)},this.getFieldEditComponent=e=>{var t,r;return null==(r=null==(t=this.plugins.find((t=>t.fieldType===e)))?void 0:t.getFieldEditComponent)?void 0:r.call(t)},this.getFieldFormComponent=e=>{var t,r;return null==(r=null==(t=this.plugins.find((t=>t.fieldType===e)))?void 0:t.getFieldFormComponent)?void 0:r.call(t)},this.getFieldIcon=e=>{var t,r;return null==(r=null==(t=this.getFieldTargetPlugin(e))?void 0:t.getFieldIcon)?void 0:r.call(t)},this.getFieldTagComponent=e=>{var t,r;return null==(r=null==(t=this.getFieldTargetPlugin(e))?void 0:t.getFieldTagComponent)?void 0:r.call(t)}}get plugins(){return this.renderPluginFieldProvider.getContributions({cache:!1})}getFieldTargetPlugin(e){return this.plugins.find((t=>t.fieldType===e))}getCellIsShowValidTip(e){var t;return null==(t=this.getFieldTargetPlugin(e))?void 0:t.isShowValidTipInGrid}getFieldIsStrictValidatedValue(e){var t;return!(null==(t=this.getFieldTargetPlugin(e))||!t.isStrictValidatedValue)}getFieldRules(e){var t,r;return null==(r=null==(t=this.plugins.find((t=>t.fieldType===e)))?void 0:t.getFieldRules)?void 0:r.call(t)}cellValueChecker(e,t){var r,n,i,o;const a=null==(o=null==(i=null==(n=null==(r=this._readService)?void 0:r.getValueField)?void 0:n.call(r,e))?void 0:i.getVerify)?void 0:o.call(i,t);return null==a?void 0:a.errorMessage}};rH([wh(Pz)],nH.prototype,"renderPluginFieldProvider",2),rH([ao(KO)],nH.prototype,"_readService",2),nH=rH([io()],nH);var iH=Object.defineProperty,oH=Object.getOwnPropertyDescriptor,aH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?oH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&iH(t,r,o),o};let sH=class{_init(){this.zIndex={render:0,gridCell:0,gridCellPreviewer:1,gridStickyContent:2,gridCellFrozen:3,gridCellFrozenPreviewer:4,gridHeader:5,gridFooter:5}}};aH([Oi()],sH.prototype,"_init",1),sH=aH([io()],sH);const lH=$i.defineToken("OpenerContribution");var cH=Object.defineProperty,uH=Object.getOwnPropertyDescriptor;let dH=class{constructor(){this.openerName="href-opener",this.apps=["phone"]}open(e){window.location.href=e}};dH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?uH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cH(t,r,o),o})([io()],dH);var fH=Object.defineProperty,hH=Object.getOwnPropertyDescriptor;let pH=class{constructor(){this.openerName="safe-redirect-opener",this.apps=["link:external"]}open(e){const{protocol:t,host:r}=document.location;window.open(`${t}//${r}/r/goto?url=${encodeURIComponent(e)}`,"_blank")}};pH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?hH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fH(t,r,o),o})([io()],pH);var gH=Object.defineProperty,mH=Object.getOwnPropertyDescriptor;let vH=class{constructor(){this.openerName="window-new-opener",this.apps=["link"]}open(e){window.open(e,"_blank")}};vH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?mH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gH(t,r,o),o})([io()],vH);var yH=Object.defineProperty,bH=Object.getOwnPropertyDescriptor;let _H=class{constructor(){this.openerName="window-opener",this.apps=["email"]}open(e){window.open(e,"_self")}};_H=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?bH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yH(t,r,o),o})([io()],_H);var wH=Object.defineProperty,CH=Object.getOwnPropertyDescriptor,EH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wH(t,r,o),o};let SH=class{constructor(){this.openers=[],this.apps=[]}init(){const e=this._openerProvider.getContributions();for(const t of e){if(t.registerOpener){const e=t.registerOpener();e&&e.length>0&&this.registerOpeners(e)}if(t.registerOpenerApp){const e=t.registerOpenerApp();if(e&&e.length>0)for(const t of e)this.registerApp(t)}}}registerOpeners(e){if(e)for(const t of e)this.registerOpener(t)}registerOpener(e){const t=this.openers.findIndex((t=>t.openerName===e.openerName));if(t>-1){const r=this.openers[t];e.apps||(e.apps=r.apps),this.openers.splice(t,1)}e.apps?this.openers.push(e):console.warn("missing opener apps",e)}registerApp(e){const t=this.apps.findIndex((t=>t.name===e.name&&(!e.sub_name||t.sub_name===e.sub_name)));t>-1&&this.apps.splice(t,1),this.apps.push(e)}getApps(){return this.apps}getOpener(e){const t=this.openers;for(const r of t)if(r.apps.includes(e.name+(e.sub_name?":"+e.sub_name:"")))return r}};EH([wh(lH)],SH.prototype,"_openerProvider",2),SH=EH([io()],SH);var kH=Object.defineProperty,xH=Object.getOwnPropertyDescriptor,OH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kH(t,r,o),o};let IH=class{getOpenerApp(e,t){const r=this.registry.getApps().filter((t=>t.name===e));let n;for(const e of r){let r=!0;e.pattern&&(new RegExp(e.pattern).test(t)||(r=!1));let i=e.include;i&&(jo(i)&&i.startsWith("{")&&(i=JSON.parse(i)),Do(i)&&!i.test(t)&&(r=!1));let o=e.exclude;if(o&&(jo(o)&&o.startsWith("{")&&(o=JSON.parse(o)),Do(o)&&o.test(t)&&(r=!1)),r){n=e;break}}return n}};OH([ao(SH)],IH.prototype,"registry",2),IH=OH([io()],IH);var RH=Object.defineProperty,TH=Object.getOwnPropertyDescriptor;let AH=class{getHashes(){const e=window.location.hash;if(e){const t=e.replace("#","").split(";");if(t.length>0){const e=[];for(const r of t){let[t,n]=r.split(":");t&&!n&&32===t.length&&(n=t,t="view"),n&&e.push({name:t,url:n})}return e}}}setHash(e,t){const r=this.buildHash(e,t);r&&(window.location.hash=r)}removeHash(e){let t=this.getHashes();if(t)if(t=t.filter((t=>t.name!==e)),t.length>0){const e=this._buildHashStr(t);window.location.hash=e}else window.location.hash=""}buildHash(e,t){const r=this.getHashes()||[],n=r.findIndex((t=>t.name===e));return n>-1&&r.splice(n,1),r.push({name:e,url:t}),this._buildHashStr(r)}_buildHashStr(e){return e.map((e=>e.name+":"+e.url)).join(";")}};AH=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?TH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RH(t,r,o),o})([io()],AH);var MH=Object.defineProperty,NH=Object.getOwnPropertyDescriptor,DH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?NH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&MH(t,r,o),o};let PH=class{open(e,t,...r){const n=this._appService.getOpenerApp(e,t);if(!n)throw new Error(`Not match app by url: ${t}`);const i=this.registry.getOpener(n);if(!i)throw new Error(`Not define link app opener: ${n.name}`);i.open(t,...r),i.autoClear?this._openerHash.removeHash(e):i.hash&&this.setHash(e,t)}getOpenLink(e,t){const r=this._openerHash.buildHash(e,t);return window.location.origin+window.location.pathname+window.location.search+"#"+r}setHash(e,t){this._configurationService.getValue("opener").useHash&&this._openerHash.setHash(e,t)}};DH([ao(SH)],PH.prototype,"registry",2),DH([ao(AH)],PH.prototype,"_openerHash",2),DH([ao(IH)],PH.prototype,"_appService",2),DH([ao(lp)],PH.prototype,"_configurationService",2),PH=DH([io()],PH);const jH={name:"email",display_name:"Email",description:"邮件",include:/mailto\:\S+@\S+\.\S+$/},FH={name:"file",display_name:"File",description:"附件"},VH={name:"image",display_name:"Image",description:"图片"},LH=/^https?:\/\/(.*(antfin|yuque|alibaba|antfin-inc|alibaba-inc).com|lark.alipay.net)/i,$H={name:"link",display_name:"Yuque Link",description:"链接",include:LH},BH={name:"link",sub_name:"external",display_name:"External Link",description:"外部链接",exclude:LH},UH={name:"phone",display_name:"Phone",description:"手机号码",include:/tel\:\d+$/},zH={name:"user",display_name:"用户",description:"用户首页"},HH=$i.defineToken("FileContribution");var WH=Object.defineProperty,GH=Object.getOwnPropertyDescriptor,KH=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?GH(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WH(t,r,o),o};let qH=class{getProvider(){const e=this.fileProvider.getContributions()||[],t=e[e.length-1];return null==t?void 0:t.registerFile()}};KH([wh(HH)],qH.prototype,"fileProvider",2),qH=KH([io()],qH);const YH={FILE_EXT:[".dwg",".vsd",".vsdm",".vsdx",".vss",".vssm",".vst",".vstm",".vstx",".msi",".chm",".sub",".idx",".sst",".son",".srt",".ssa",".ass",".smi",".psb",".pjs",".stl",".tts",".vsf",".zeg",".ipynb",".msg",".caj",".jar",".tar",".gz",".cnf",".ini",".rpm",".conf"],IMAGE_EXT:[".svg",".png",".bmp",".jpg",".jpeg",".gif",".tif",".tiff",".emf",".webp",".heic",".heif"],TEXT_FILE_EXT:[".txt",".abap",".ada",".adp",".ahk",".as",".as3",".asc",".ascx",".asm",".asp",".awk",".bash",".bash_login",".bash_logout",".bash_profile",".bashrc",".bat",".bib",".bsh",".build",".builder",".c",".c++",".capfile",".cc",".cfc",".cfm",".cfml",".cl",".clj",".cls",".cmake",".cmd",".coffee",".config",".cpp",".cpt",".cpy",".cs",".cshtml",".cson",".csproj",".css",".ctp",".cxx",".dart",".d",".ddl",".di",".diff",".disco",".dml",".dtd",".dtml",".el",".emakefile",".erb",".erl",".f",".f90",".f95",".fs",".fsi",".fsscript",".fsx",".gemfile",".gemspec",".gitconfig",".go",".groovy",".gvy",".Hcp",".h",".h++",".haml",".handlebars",".hbs",".hh",".hpp",".hrl",".hs",".htc",".hxx",".html",".htm",".idl",".iim",".inc",".inf",".ini",".inl",".ipp",".irbrc",".pug",".jade",".jav",".java",".js",".json",".jsp",".jsx",".l",".less",".lhs",".lisp",".log",".lst",".ltx",".lua",".m",".mak",".make",".manifest",".master",".md",".mkd",".markdn",".markdown",".mdown",".mkdn",".ml",".mli",".mll",".mly",".mud",".makefile",".nfo",".opml",".osascript",".p",".pas",".patch",".php",".php2",".php3",".php4",".php5",".phtml",".pl",".plx",".perl",".pm",".pod",".pp",".profile",".ps1",".ps1xml",".psd1",".psm1",".pss",".pt",".py",".pyw",".proto",".r",".rake",".rb",".rbx",".rc",".rdf",".re",".reg",".rest",".resw",".resx",".rhtml",".rjs",".rprofile",".rpy",".rs",".rss",".rst",".ruby",".rxml",".s",".sass",".scala",".scm",".sconscript",".sconstruct",".script",".scss",".sgml",".sh",".shtml",".sml",".svn-base",".swift",".sql",".sty",".tcl",".tex",".textile",".tld",".tli",".tmpl",".tpl",".ts",".tsx",".vb",".vi",".vim",".vmg",".webpart",".wsp",".wsdl",".xhtml",".xml",".jmx",".xoml",".xsd",".xslt",".yaml",".yaws",".yml",".zsh",".arxml"],VIDEO_EXT:[".mp4",".mov",".avi",".wmv",".m4a",".m4v",".webm",".flv",".mkv",".mpg",".ts",".mts",".swf",".3gp",".ogg",".aac",".dv",".f4v",".flac",".rmvb",".vob",".asf",".dat",".m2t",".m3u8",".mj2",".mjpeg",".mpe",".mpeg",".qt",".rm",".rmvb",".wmv"],OFFICE_EXT:[".docx",".doc",".dotx",".dot",".rtf",".txt",".html",".htm",".lake",".lakebook",".lakesheet",".lakemind",".lakeshow",".pdf",".xls",".xlsx",".xltx",".xlsm",".xlt",".csv",".pptx",".ppt",".potx",".pot",".ppsx",".pps",".pages",".numbers",".nmbtemplate",".template",".key",".keynote",".kth",".et",".ett",".dps",".dpt",".wps",".wpt",".txt",".md",".mark",".markdown",".xmind",".graffle",".gtemplate",".gstencil",".mindnode",".vpp",".mmap",".mm",".mpp"],MAC_OFFICE_EXT:[".key",".keynote",".pages",".numbers"],AUDIO_EXT:[".mp3",".mpga",".wav",".m4a",".flac"],PRESENTATION_EXT:[".ppt",".pptx",".ppsx",".potx",".pot",".key"],SHEET_EXT:[".xls",".xlsx",".xlsm",".xltx",".xlt",".csv",".numbers"],MMAP_EXT:[".mindnode",".mindnode.zip",".xmind",".xmind.zip",".mmap",".mmap.zip",".mm"],COMPRESS_EXT:[".zip",".rar",".gz",".tgz",".gzip",".7z",".tar",".jar",".dmg",".pkg"]},JH={"image/jpeg":["jpeg","jpg","jpe"],"image/png":["png"],"image/gif":["gif"],"image/vnd.wap.wbmp":["wbmp"],"image/tiff":["tiff","tiff"],"image/vnd.adobe.photoshop":["psd"],"image/svg+xml":["svg","svgz"],"text/jsx":["jsx"],"text/less":["less"],"text/css":["css"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/csv":["csv"],"text/xml":["xml"],"text/x-vcard":["vcf"],"text/x-vcalendar":["vcs"],"text/markdown":["md"],"text/plain":["txt"],"text/richtext":["rtx"],"text/rtf":["rtf"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js"],"text/yaml":["yaml","yml"],"audio/mp3":["mp3"],"audio/mp4":["mp4","mp4a"],"video/mp4":["mp4"],"audio/mpeg":["mpeg","mp2","mp3"],"audio/ogg":["oga"],"audio/wav":["wav"],"audio/wave":["wav"],"audio/webm":["weba"],"video/x-msvideo":["avi"],"video/quicktime":["mov","qt"],"video/ogg":["ogv"],"video/x-sgi-movie":["movie"],"application/rss+xml":["rss"],"application/json":["json"],"application/zip":["zip"],"application/gzip":["gzip"],"application/pdf":["pdf"],"application/postscript":["ai","eps","ps"],"application/msword":["doc","dot"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.ms-fontobject":["eot"],"application/vnd.android.package-archive":["apk"],"application/x-apple-diskimage":["dmg"],"application/x-iwork-keynote-sffkey":["key"],"application/x-iwork-pages-sffpages":["pages"],"application/x-iwork-keynote-sffnumbers":["numbers"],"application/x-iwork-numbers-sffnumbers":["numbers"]};function XH(e){if(!e)return"";let t;if(t="string"==typeof e?e:e.name,t){if(t=t.toLowerCase(),t.endsWith(".mindnode.zip"))return"mindnode.zip";if(t.endsWith(".xmind.zip"))return"xmind.zip";if(t.endsWith(".mmap.zip"))return"mmap.zip";if(t.endsWith(".mpp.zip"))return"mpp.zip"}const r=t&&t.split(".").pop()||"",n=e.type&&JH[e.type];return n?n.includes(r)?r:n[0]:r}function ZH(e){const t=XH(e);return YH.IMAGE_EXT.includes(t)}function QH(e){const t=XH(e);return ZH(e)?"image":function(e){const t=XH(e);return YH.VIDEO_EXT.includes(t)}(e)?"video":function(e){const t=XH(e);return YH.AUDIO_EXT.includes(t)}(e)?"audio":["doc","docx","dot","dotx"].includes(t)?"word":function(e){const t=XH(e);return["pdf"].includes(t)}(e)?"pdf":"txt"===t?"txt":["pages","md","markdown","rtf"].includes(t)?"doc":"numbers"===t?"numbers":["xls","xlsx","xlsm","xltx","xlt"].includes(t)?"excel":function(e){const t=XH(e);return YH.SHEET_EXT.includes(t)}(e)?"sheet":"key"===e?"keynote":function(e){const t=XH(e);return YH.PRESENTATION_EXT.includes(t)}(e)?"ppt":["xmind","xmind.zip"].includes(t)?"xmind":["mindnode","mindnode.zip"].includes(t)?"mindnote":function(e){const t=XH(e);return YH.MMAP_EXT.includes(t)}(e)?"minimap":"sketch"===t?"sketch":["rp","rplib"].includes(t)?"axure":"psd"===t?"psd":"ai"===t?"ai":"graffle"===t?"graffle":"zip"===t?"rar":"lake"===t?"lake":"lakesheet"===t?"lakesheet":"default"}var eW=Object.defineProperty,tW=Object.getOwnPropertyDescriptor,rW=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tW(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eW(t,r,o),o};let nW=class{get _provider(){return this._fileRegistry.getProvider()}getExts(){var e;return null!=(e=this._provider)&&e.getExts?this._provider.getExts():function(){let e=[];return Object.keys(YH).forEach((t=>{e=e.concat(YH[t])})),e}().join(",")}getFileKey(e){var t;return null!=(t=this._provider)&&t.getFileKey?this._provider.getFileKey(e):QH(e)}getPreviewUrl(e){var t,r;return null!=(t=this._provider)&&t.getPreviewUrl?null==(r=this._provider)?void 0:r.getPreviewUrl(e):e}getPreviewOrDownloadUrl(e,t){var r,n;return null!=(r=this._provider)&&r.getPreviewOrDownloadUrl?null==(n=this._provider)?void 0:n.getPreviewOrDownloadUrl(e,t):e}};rW([ao(qH)],nW.prototype,"_fileRegistry",2),nW=rW([io()],nW);const iW=xo().contribution(HH).register(qH).register(nW);var oW=Object.defineProperty,aW=Object.getOwnPropertyDescriptor,sW=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aW(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oW(t,r,o),o};let lW=class{constructor(){this.openerName="file-previewer-opener",this.apps=["file"]}open(e,t){const r=this._fileService.getPreviewOrDownloadUrl(e,t.size);!r||window.open(r,"_blank","noopener,noreferrer")}};sW([ao(nW)],lW.prototype,"_fileService",2),lW=sW([io()],lW);var cW={exports:{}};!function(e,t){e.exports=function(){var e=function(e,t,r,n){var i={features:null,bind:function(e,t,r,n){var i=(n?"remove":"add")+"EventListener";t=t.split(" ");for(var o=0;o<t.length;o++)t[o]&&e[i](t[o],r,!1)},isArray:function(e){return e instanceof Array},createEl:function(e,t){var r=document.createElement(t||"div");return e&&(r.className=e),r},getScrollY:function(){var e=window.pageYOffset;return void 0!==e?e:document.documentElement.scrollTop},unbind:function(e,t,r){i.bind(e,t,r,!0)},removeClass:function(e,t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(e,t){i.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},hasClass:function(e,t){return e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},getChildByClass:function(e,t){for(var r=e.firstChild;r;){if(i.hasClass(r,t))return r;r=r.nextSibling}},arraySearch:function(e,t,r){for(var n=e.length;n--;)if(e[n][r]===t)return n;return-1},extend:function(e,t,r){for(var n in t)if(t.hasOwnProperty(n)){if(r&&e.hasOwnProperty(n))continue;e[n]=t[n]}},easing:{sine:{out:function(e){return Math.sin(e*(Math.PI/2))},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{out:function(e){return--e*e*e+1}}},detectFeatures:function(){if(i.features)return i.features;var e=i.createEl().style,t="",r={};if(r.oldIE=document.all&&!document.addEventListener,r.touch="ontouchstart"in window,window.requestAnimationFrame&&(r.raf=window.requestAnimationFrame,r.caf=window.cancelAnimationFrame),r.pointerEvent=!!window.PointerEvent||navigator.msPointerEnabled,!r.pointerEvent){var n=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var o=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);o&&o.length>0&&(o=parseInt(o[1],10))>=1&&o<8&&(r.isOldIOSPhone=!0)}var a=n.match(/Android\s([0-9\.]*)/),s=a?a[1]:0;(s=parseFloat(s))>=1&&(s<4.4&&(r.isOldAndroid=!0),r.androidVersion=s),r.isMobileOpera=/opera mini|opera mobi/i.test(n)}for(var l,c,u=["transform","perspective","animationName"],d=["","webkit","Moz","ms","O"],f=0;f<4;f++){t=d[f];for(var h=0;h<3;h++)l=u[h],c=t+(t?l.charAt(0).toUpperCase()+l.slice(1):l),!r[l]&&c in e&&(r[l]=c);t&&!r.raf&&(t=t.toLowerCase(),r.raf=window[t+"RequestAnimationFrame"],r.raf&&(r.caf=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"]))}if(!r.raf){var p=0;r.raf=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-p)),n=window.setTimeout((function(){e(t+r)}),r);return p=t+r,n},r.caf=function(e){clearTimeout(e)}}return r.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,i.features=r,r}};i.detectFeatures(),i.features.oldIE&&(i.bind=function(e,t,r,n){t=t.split(" ");for(var i,o=(n?"detach":"attach")+"Event",a=function(){r.handleEvent.call(r)},s=0;s<t.length;s++)if(i=t[s])if("object"==typeof r&&r.handleEvent){if(n){if(!r["oldIE"+i])return!1}else r["oldIE"+i]=a;e[o]("on"+i,r["oldIE"+i])}else e[o]("on"+i,r)});var o=this,a=25,s=3,l={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(e){return"A"===e.tagName},getDoubleTapZoom:function(e,t){return e||t.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit"};i.extend(l,n);var c,u,d,f,h,p,g,m,v,y,b,_,w,C,E,S,k,x,O,I,R,T,A,M,N,D,P,j,F,V,L,$,B,U,z,H,W,G,K,q,Y,J,X,Z,Q,ee,te,re,ne,ie,oe,ae,se,le,ce,ue,de=function(){return{x:0,y:0}},fe=de(),he=de(),pe=de(),ge={},me=0,ve={},ye=de(),be=0,_e=!0,we=[],Ce={},Ee=!1,Se=function(e,t){i.extend(o,t.publicMethods),we.push(e)},ke=function(e){var t=Qt();return e>t-1?e-t:e<0?t+e:e},xe={},Oe=function(e,t){return xe[e]||(xe[e]=[]),xe[e].push(t)},Ie=function(e){var t=xe[e];if(t){var r=Array.prototype.slice.call(arguments);r.shift();for(var n=0;n<t.length;n++)t[n].apply(o,r)}},Re=function(){return(new Date).getTime()},Te=function(e){le=e,o.bg.style.opacity=e*l.bgOpacity},Ae=function(e,t,r,n,i){(!Ee||i&&i!==o.currItem)&&(n/=i?i.fitRatio:o.currItem.fitRatio),e[T]=_+t+"px, "+r+"px"+w+" scale("+n+")"},Me=function(e){ne&&(e&&(y>o.currItem.fitRatio?Ee||(ur(o.currItem,!1,!0),Ee=!0):Ee&&(ur(o.currItem),Ee=!1)),Ae(ne,pe.x,pe.y,y))},Ne=function(e){e.container&&Ae(e.container.style,e.initialPosition.x,e.initialPosition.y,e.initialZoomLevel,e)},De=function(e,t){t[T]=_+e+"px, 0px"+w},Pe=function(e,t){if(!l.loop&&t){var r=f+(ye.x*me-e)/ye.x,n=Math.round(e-yt.x);(r<0&&n>0||r>=Qt()-1&&n<0)&&(e=yt.x+n*l.mainScrollEndFriction)}yt.x=e,De(e,h)},je=function(e,t){var r=bt[e]-ve[e];return he[e]+fe[e]+r-r*(t/b)},Fe=function(e,t){e.x=t.x,e.y=t.y,t.id&&(e.id=t.id)},Ve=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y)},Le=null,$e=function(){Le&&(i.unbind(document,"mousemove",$e),i.addClass(e,"pswp--has_mouse"),l.mouseUsed=!0,Ie("mouseUsed")),Le=setTimeout((function(){Le=null}),100)},Be=function(){i.bind(document,"keydown",o),L.transform&&i.bind(o.scrollWrap,"click",o),l.mouseUsed||i.bind(document,"mousemove",$e),i.bind(window,"resize scroll orientationchange",o),Ie("bindEvents")},Ue=function(){i.unbind(window,"resize scroll orientationchange",o),i.unbind(window,"scroll",v.scroll),i.unbind(document,"keydown",o),i.unbind(document,"mousemove",$e),L.transform&&i.unbind(o.scrollWrap,"click",o),K&&i.unbind(window,g,o),clearTimeout($),Ie("unbindEvents")},ze=function(e,t){var r=ar(o.currItem,ge,e);return t&&(re=r),r},He=function(e){return e||(e=o.currItem),e.initialZoomLevel},We=function(e){return e||(e=o.currItem),e.w>0?l.maxSpreadZoom:1},Ge=function(e,t,r,n){return n===o.currItem.initialZoomLevel?(r[e]=o.currItem.initialPosition[e],!0):(r[e]=je(e,n),r[e]>t.min[e]?(r[e]=t.min[e],!0):r[e]<t.max[e]&&(r[e]=t.max[e],!0))},Ke=function(){if(T){var t=L.perspective&&!M;return _="translate"+(t?"3d(":"("),void(w=L.perspective?", 0px)":")")}T="left",i.addClass(e,"pswp--ie"),De=function(e,t){t.left=e+"px"},Ne=function(e){var t=e.fitRatio>1?1:e.fitRatio,r=e.container.style,n=t*e.w,i=t*e.h;r.width=n+"px",r.height=i+"px",r.left=e.initialPosition.x+"px",r.top=e.initialPosition.y+"px"},Me=function(){if(ne){var e=ne,t=o.currItem,r=t.fitRatio>1?1:t.fitRatio,n=r*t.w,i=r*t.h;e.width=n+"px",e.height=i+"px",e.left=pe.x+"px",e.top=pe.y+"px"}}},qe=function(e){var t="";l.escKey&&27===e.keyCode?t="close":l.arrowKeys&&(37===e.keyCode?t="prev":39===e.keyCode&&(t="next")),t&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey&&(e.preventDefault?e.preventDefault():e.returnValue=!1,o[t]())},Ye=function(e){!e||(J||Y||ie||W)&&(e.preventDefault(),e.stopPropagation())},Je=function(){o.setScrollOffset(0,i.getScrollY())},Xe={},Ze=0,Qe=function(e){Xe[e]&&(Xe[e].raf&&D(Xe[e].raf),Ze--,delete Xe[e])},et=function(e){Xe[e]&&Qe(e),Xe[e]||(Ze++,Xe[e]={})},tt=function(){for(var e in Xe)Xe.hasOwnProperty(e)&&Qe(e)},rt=function(e,t,r,n,i,o,a){var s,l=Re();et(e);var c=function(){if(Xe[e]){if((s=Re()-l)>=n)return Qe(e),o(r),void(a&&a());o((r-t)*i(s/n)+t),Xe[e].raf=N(c)}};c()},nt={shout:Ie,listen:Oe,viewportSize:ge,options:l,isMainScrollAnimating:function(){return ie},getZoomLevel:function(){return y},getCurrentIndex:function(){return f},isDragging:function(){return K},isZooming:function(){return ee},setScrollOffset:function(e,t){ve.x=e,V=ve.y=t,Ie("updateScrollOffset",ve)},applyZoomPan:function(e,t,r,n){pe.x=t,pe.y=r,y=e,Me(n)},init:function(){if(!c&&!u){var r;o.framework=i,o.template=e,o.bg=i.getChildByClass(e,"pswp__bg"),P=e.className,c=!0,L=i.detectFeatures(),N=L.raf,D=L.caf,T=L.transform,F=L.oldIE,o.scrollWrap=i.getChildByClass(e,"pswp__scroll-wrap"),o.container=i.getChildByClass(o.scrollWrap,"pswp__container"),h=o.container.style,o.itemHolders=S=[{el:o.container.children[0],wrap:0,index:-1},{el:o.container.children[1],wrap:0,index:-1},{el:o.container.children[2],wrap:0,index:-1}],S[0].el.style.display=S[2].el.style.display="none",Ke(),v={resize:o.updateSize,orientationchange:function(){clearTimeout($),$=setTimeout((function(){ge.x!==o.scrollWrap.clientWidth&&o.updateSize()}),500)},scroll:Je,keydown:qe,click:Ye};var n=L.isOldIOSPhone||L.isOldAndroid||L.isMobileOpera;for((!L.animationName||!L.transform||n)&&(l.showAnimationDuration=l.hideAnimationDuration=0),r=0;r<we.length;r++)o["init"+we[r]]();t&&(o.ui=new t(o,i)).init(),Ie("firstUpdate"),f=f||l.index||0,(isNaN(f)||f<0||f>=Qt())&&(f=0),o.currItem=Zt(f),(L.isOldIOSPhone||L.isOldAndroid)&&(_e=!1),e.setAttribute("aria-hidden","false"),l.modal&&(_e?e.style.position="fixed":(e.style.position="absolute",e.style.top=i.getScrollY()+"px")),void 0===V&&(Ie("initialLayout"),V=j=i.getScrollY());var a="pswp--open ";for(l.mainClass&&(a+=l.mainClass+" "),l.showHideOpacity&&(a+="pswp--animate_opacity "),a+=M?"pswp--touch":"pswp--notouch",a+=L.animationName?" pswp--css_animation":"",a+=L.svg?" pswp--svg":"",i.addClass(e,a),o.updateSize(),p=-1,be=null,r=0;r<s;r++)De((r+p)*ye.x,S[r].el.style);F||i.bind(o.scrollWrap,m,o),Oe("initialZoomInEnd",(function(){o.setContent(S[0],f-1),o.setContent(S[2],f+1),S[0].el.style.display=S[2].el.style.display="block",l.focus&&e.focus(),Be()})),o.setContent(S[1],f),o.updateCurrItem(),Ie("afterInit"),_e||(C=setInterval((function(){!Ze&&!K&&!ee&&y===o.currItem.initialZoomLevel&&o.updateSize()}),1e3)),i.addClass(e,"pswp--visible")}},close:function(){!c||(c=!1,u=!0,Ie("close"),Ue(),er(o.currItem,null,!0,o.destroy))},destroy:function(){Ie("destroy"),qt&&clearTimeout(qt),e.setAttribute("aria-hidden","true"),e.className=P,C&&clearInterval(C),i.unbind(o.scrollWrap,m,o),i.unbind(window,"scroll",o),St(),tt(),xe=null},panTo:function(e,t,r){r||(e>re.min.x?e=re.min.x:e<re.max.x&&(e=re.max.x),t>re.min.y?t=re.min.y:t<re.max.y&&(t=re.max.y)),pe.x=e,pe.y=t,Me()},handleEvent:function(e){e=e||window.event,v[e.type]&&v[e.type](e)},goTo:function(e){var t=(e=ke(e))-f;be=t,f=e,o.currItem=Zt(f),me-=t,Pe(ye.x*me),tt(),ie=!1,o.updateCurrItem()},next:function(){o.goTo(f+1)},prev:function(){o.goTo(f-1)},updateCurrZoomItem:function(e){if(e&&Ie("beforeChange",0),S[1].el.children.length){var t=S[1].el.children[0];ne=i.hasClass(t,"pswp__zoom-wrap")?t.style:null}else ne=null;re=o.currItem.bounds,b=y=o.currItem.initialZoomLevel,pe.x=re.center.x,pe.y=re.center.y,e&&Ie("afterChange")},invalidateCurrItems:function(){E=!0;for(var e=0;e<s;e++)S[e].item&&(S[e].item.needsUpdate=!0)},updateCurrItem:function(e){if(0!==be){var t,r=Math.abs(be);if(!(e&&r<2)){o.currItem=Zt(f),Ee=!1,Ie("beforeChange",be),r>=s&&(p+=be+(be>0?-s:s),r=s);for(var n=0;n<r;n++)be>0?(t=S.shift(),S[s-1]=t,p++,De((p+2)*ye.x,t.el.style),o.setContent(t,f-r+n+1+1)):(t=S.pop(),S.unshift(t),p--,De(p*ye.x,t.el.style),o.setContent(t,f+r-n-1-1));if(ne&&1===Math.abs(be)){var i=Zt(k);i.initialZoomLevel!==y&&(ar(i,ge),ur(i),Ne(i))}be=0,o.updateCurrZoomItem(),k=f,Ie("afterChange")}}},updateSize:function(t){if(!_e&&l.modal){var r=i.getScrollY();if(V!==r&&(e.style.top=r+"px",V=r),!t&&Ce.x===window.innerWidth&&Ce.y===window.innerHeight)return;Ce.x=window.innerWidth,Ce.y=window.innerHeight,e.style.height=Ce.y+"px"}if(ge.x=o.scrollWrap.clientWidth,ge.y=o.scrollWrap.clientHeight,Je(),ye.x=ge.x+Math.round(ge.x*l.spacing),ye.y=ge.y,Pe(ye.x*me),Ie("beforeResize"),void 0!==p){for(var n,a,c,u=0;u<s;u++)n=S[u],De((u+p)*ye.x,n.el.style),c=f+u-1,l.loop&&Qt()>2&&(c=ke(c)),(a=Zt(c))&&(E||a.needsUpdate||!a.bounds)?(o.cleanSlide(a),o.setContent(n,c),1===u&&(o.currItem=a,o.updateCurrZoomItem(!0)),a.needsUpdate=!1):-1===n.index&&c>=0&&o.setContent(n,c),a&&a.container&&(ar(a,ge),ur(a),Ne(a));E=!1}b=y=o.currItem.initialZoomLevel,(re=o.currItem.bounds)&&(pe.x=re.center.x,pe.y=re.center.y,Me(!0)),Ie("resize")},zoomTo:function(e,t,r,n,o){t&&(b=y,bt.x=Math.abs(t.x)-pe.x,bt.y=Math.abs(t.y)-pe.y,Fe(he,pe));var a=ze(e,!1),s={};Ge("x",a,s,e),Ge("y",a,s,e);var l=y,c={x:pe.x,y:pe.y};Ve(s);var u=function(t){1===t?(y=e,pe.x=s.x,pe.y=s.y):(y=(e-l)*t+l,pe.x=(s.x-c.x)*t+c.x,pe.y=(s.y-c.y)*t+c.y),o&&o(t),Me(1===t)};r?rt("customZoomTo",0,1,r,n||i.easing.sine.inOut,u):u(1)}},it=30,ot=10,at={},st={},lt={},ct={},ut={},dt=[],ft={},ht=[],pt={},gt=0,mt=de(),vt=0,yt=de(),bt=de(),_t=de(),wt=function(e,t){return e.x===t.x&&e.y===t.y},Ct=function(e,t){return Math.abs(e.x-t.x)<a&&Math.abs(e.y-t.y)<a},Et=function(e,t){return pt.x=Math.abs(e.x-t.x),pt.y=Math.abs(e.y-t.y),Math.sqrt(pt.x*pt.x+pt.y*pt.y)},St=function(){X&&(D(X),X=null)},kt=function(){K&&(X=N(kt),Bt())},xt=function(){return!("fit"===l.scaleMode&&y===o.currItem.initialZoomLevel)},Ot=function(e,t){return!(!e||e===document||e.getAttribute("class")&&e.getAttribute("class").indexOf("pswp__scroll-wrap")>-1)&&(t(e)?e:Ot(e.parentNode,t))},It={},Rt=function(e,t){return It.prevent=!Ot(e.target,l.isClickableElement),Ie("preventDragEvent",e,t,It),It.prevent},Tt=function(e,t){return t.x=e.pageX,t.y=e.pageY,t.id=e.identifier,t},At=function(e,t,r){r.x=.5*(e.x+t.x),r.y=.5*(e.y+t.y)},Mt=function(e,t,r){if(e-U>50){var n=ht.length>2?ht.shift():{};n.x=t,n.y=r,ht.push(n),U=e}},Nt=function(){var e=pe.y-o.currItem.initialPosition.y;return 1-Math.abs(e/(ge.y/2))},Dt={},Pt={},jt=[],Ft=function(e){for(;jt.length>0;)jt.pop();return A?(ue=0,dt.forEach((function(e){0===ue?jt[0]=e:1===ue&&(jt[1]=e),ue++}))):e.type.indexOf("touch")>-1?e.touches&&e.touches.length>0&&(jt[0]=Tt(e.touches[0],Dt),e.touches.length>1&&(jt[1]=Tt(e.touches[1],Pt))):(Dt.x=e.pageX,Dt.y=e.pageY,Dt.id="",jt[0]=Dt),jt},Vt=function(e,t){var r,n,i,a,s=pe[e]+t[e],c=t[e]>0,u=yt.x+t.x,d=yt.x-ft.x;if(r=s>re.min[e]||s<re.max[e]?l.panEndFriction:1,s=pe[e]+t[e]*r,(l.allowPanToNext||y===o.currItem.initialZoomLevel)&&(ne?"h"===oe&&"x"===e&&!Y&&(c?(s>re.min[e]&&(r=l.panEndFriction,re.min[e],n=re.min[e]-he[e]),(n<=0||d<0)&&Qt()>1?(a=u,d<0&&u>ft.x&&(a=ft.x)):re.min.x!==re.max.x&&(i=s)):(s<re.max[e]&&(r=l.panEndFriction,re.max[e],n=he[e]-re.max[e]),(n<=0||d>0)&&Qt()>1?(a=u,d>0&&u<ft.x&&(a=ft.x)):re.min.x!==re.max.x&&(i=s))):a=u,"x"===e))return void 0!==a&&(Pe(a,!0),Z=a!==ft.x),re.min.x!==re.max.x&&(void 0!==i?pe.x=i:Z||(pe.x+=t.x*r)),void 0!==a;ie||Z||y>o.currItem.fitRatio&&(pe[e]+=t[e]*r)},Lt=function(e){if(!("mousedown"===e.type&&e.button>0)){if(Xt)return void e.preventDefault();if(!G||"mousedown"!==e.type){if(Rt(e,!0)&&e.preventDefault(),Ie("pointerDown"),A){var t=i.arraySearch(dt,e.pointerId,"id");t<0&&(t=dt.length),dt[t]={x:e.pageX,y:e.pageY,id:e.pointerId}}var r=Ft(e),n=r.length;Q=null,tt(),(!K||1===n)&&(K=ae=!0,i.bind(window,g,o),H=ce=se=W=Z=J=q=Y=!1,oe=null,Ie("firstTouchStart",r),Fe(he,pe),fe.x=fe.y=0,Fe(ct,r[0]),Fe(ut,ct),ft.x=ye.x*me,ht=[{x:ct.x,y:ct.y}],U=B=Re(),ze(y,!0),St(),kt()),!ee&&n>1&&!ie&&!Z&&(b=y,Y=!1,ee=q=!0,fe.y=fe.x=0,Fe(he,pe),Fe(at,r[0]),Fe(st,r[1]),At(at,st,_t),bt.x=Math.abs(_t.x)-pe.x,bt.y=Math.abs(_t.y)-pe.y,te=Et(at,st))}}},$t=function(e){if(e.preventDefault(),A){var t=i.arraySearch(dt,e.pointerId,"id");if(t>-1){var r=dt[t];r.x=e.pageX,r.y=e.pageY}}if(K){var n=Ft(e);if(oe||J||ee)Q=n;else if(yt.x!==ye.x*me)oe="h";else{var o=Math.abs(n[0].x-ct.x)-Math.abs(n[0].y-ct.y);Math.abs(o)>=ot&&(oe=o>0?"h":"v",Q=n)}}},Bt=function(){if(Q){var e=Q.length;if(0!==e)if(Fe(at,Q[0]),lt.x=at.x-ct.x,lt.y=at.y-ct.y,ee&&e>1){if(ct.x=at.x,ct.y=at.y,!lt.x&&!lt.y&&wt(Q[1],st))return;Fe(st,Q[1]),Y||(Y=!0,Ie("zoomGestureStarted"));var t=Et(at,st),r=Gt(t);r>o.currItem.initialZoomLevel+o.currItem.initialZoomLevel/15&&(ce=!0);var n=1,i=He(),a=We();if(r<i)if(l.pinchToClose&&!ce&&b<=o.currItem.initialZoomLevel){var s=1-(i-r)/(i/1.2);Te(s),Ie("onPinchClose",s),se=!0}else(n=(i-r)/i)>1&&(n=1),r=i-n*(i/3);else r>a&&((n=(r-a)/(6*i))>1&&(n=1),r=a+n*i);n<0&&(n=0),At(at,st,mt),fe.x+=mt.x-_t.x,fe.y+=mt.y-_t.y,Fe(_t,mt),pe.x=je("x",r),pe.y=je("y",r),H=r>y,y=r,Me()}else{if(!oe||(ae&&(ae=!1,Math.abs(lt.x)>=ot&&(lt.x-=Q[0].x-ut.x),Math.abs(lt.y)>=ot&&(lt.y-=Q[0].y-ut.y)),ct.x=at.x,ct.y=at.y,0===lt.x&&0===lt.y))return;if("v"===oe&&l.closeOnVerticalDrag&&!xt()){fe.y+=lt.y,pe.y+=lt.y;var c=Nt();return W=!0,Ie("onVerticalDrag",c),Te(c),void Me()}Mt(Re(),at.x,at.y),J=!0,re=o.currItem.bounds,Vt("x",lt)||(Vt("y",lt),Ve(pe),Me())}}},Ut=function(e){if(L.isOldAndroid){if(G&&"mouseup"===e.type)return;e.type.indexOf("touch")>-1&&(clearTimeout(G),G=setTimeout((function(){G=0}),600))}var t;if(Ie("pointerUp"),Rt(e,!1)&&e.preventDefault(),A){var r=i.arraySearch(dt,e.pointerId,"id");if(r>-1)if(t=dt.splice(r,1)[0],navigator.msPointerEnabled){var n={4:"mouse",2:"touch",3:"pen"};t.type=n[e.pointerType],t.type||(t.type=e.pointerType||"mouse")}else t.type=e.pointerType||"mouse"}var a,s=Ft(e),c=s.length;if("mouseup"===e.type&&(c=0),2===c)return Q=null,!0;1===c&&Fe(ut,s[0]),0===c&&!oe&&!ie&&(t||("mouseup"===e.type?t={x:e.pageX,y:e.pageY,type:"mouse"}:e.changedTouches&&e.changedTouches[0]&&(t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"})),Ie("touchRelease",e,t));var u=-1;if(0===c&&(K=!1,i.unbind(window,g,o),St(),ee?u=0:-1!==vt&&(u=Re()-vt)),vt=1===c?Re():-1,a=-1!==u&&u<150?"zoom":"swipe",ee&&c<2&&(ee=!1,1===c&&(a="zoomPointerUp"),Ie("zoomGestureEnded")),Q=null,J||Y||ie||W){if(tt(),z||(z=zt()),z.calculateSwipeSpeed("x"),W){if(Nt()<l.verticalDragRange)o.close();else{var d=pe.y,f=le;rt("verticalDrag",0,1,300,i.easing.cubic.out,(function(e){pe.y=(o.currItem.initialPosition.y-d)*e+d,Te((1-f)*e+f),Me()})),Ie("onVerticalDrag",1)}return}if((Z||ie)&&0===c){if(Wt(a,z))return;a="zoomPointerUp"}if(!ie){if("swipe"!==a)return void Kt();!Z&&y>o.currItem.fitRatio&&Ht(z)}}},zt=function(){var e,t,r={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(n){ht.length>1?(e=Re()-U+50,t=ht[ht.length-2][n]):(e=Re()-B,t=ut[n]),r.lastFlickOffset[n]=ct[n]-t,r.lastFlickDist[n]=Math.abs(r.lastFlickOffset[n]),r.lastFlickDist[n]>20?r.lastFlickSpeed[n]=r.lastFlickOffset[n]/e:r.lastFlickSpeed[n]=0,Math.abs(r.lastFlickSpeed[n])<.1&&(r.lastFlickSpeed[n]=0),r.slowDownRatio[n]=.95,r.slowDownRatioReverse[n]=1-r.slowDownRatio[n],r.speedDecelerationRatio[n]=1},calculateOverBoundsAnimOffset:function(e,t){r.backAnimStarted[e]||(pe[e]>re.min[e]?r.backAnimDestination[e]=re.min[e]:pe[e]<re.max[e]&&(r.backAnimDestination[e]=re.max[e]),void 0!==r.backAnimDestination[e]&&(r.slowDownRatio[e]=.7,r.slowDownRatioReverse[e]=1-r.slowDownRatio[e],r.speedDecelerationRatioAbs[e]<.05&&(r.lastFlickSpeed[e]=0,r.backAnimStarted[e]=!0,rt("bounceZoomPan"+e,pe[e],r.backAnimDestination[e],t||300,i.easing.sine.out,(function(t){pe[e]=t,Me()})))))},calculateAnimOffset:function(e){r.backAnimStarted[e]||(r.speedDecelerationRatio[e]=r.speedDecelerationRatio[e]*(r.slowDownRatio[e]+r.slowDownRatioReverse[e]-r.slowDownRatioReverse[e]*r.timeDiff/10),r.speedDecelerationRatioAbs[e]=Math.abs(r.lastFlickSpeed[e]*r.speedDecelerationRatio[e]),r.distanceOffset[e]=r.lastFlickSpeed[e]*r.speedDecelerationRatio[e]*r.timeDiff,pe[e]+=r.distanceOffset[e])},panAnimLoop:function(){if(Xe.zoomPan&&(Xe.zoomPan.raf=N(r.panAnimLoop),r.now=Re(),r.timeDiff=r.now-r.lastNow,r.lastNow=r.now,r.calculateAnimOffset("x"),r.calculateAnimOffset("y"),Me(),r.calculateOverBoundsAnimOffset("x"),r.calculateOverBoundsAnimOffset("y"),r.speedDecelerationRatioAbs.x<.05&&r.speedDecelerationRatioAbs.y<.05))return pe.x=Math.round(pe.x),pe.y=Math.round(pe.y),Me(),void Qe("zoomPan")}};return r},Ht=function(e){if(e.calculateSwipeSpeed("y"),re=o.currItem.bounds,e.backAnimDestination={},e.backAnimStarted={},Math.abs(e.lastFlickSpeed.x)<=.05&&Math.abs(e.lastFlickSpeed.y)<=.05)return e.speedDecelerationRatioAbs.x=e.speedDecelerationRatioAbs.y=0,e.calculateOverBoundsAnimOffset("x"),e.calculateOverBoundsAnimOffset("y"),!0;et("zoomPan"),e.lastNow=Re(),e.panAnimLoop()},Wt=function(e,t){var r,n,a;if(ie||(gt=f),"swipe"===e){var s=ct.x-ut.x,c=t.lastFlickDist.x<10;s>it&&(c||t.lastFlickOffset.x>20)?n=-1:s<-it&&(c||t.lastFlickOffset.x<-20)&&(n=1)}n&&((f+=n)<0?(f=l.loop?Qt()-1:0,a=!0):f>=Qt()&&(f=l.loop?0:Qt()-1,a=!0),(!a||l.loop)&&(be+=n,me-=n,r=!0));var u,d=ye.x*me,h=Math.abs(d-yt.x);return r||d>yt.x==t.lastFlickSpeed.x>0?(u=Math.abs(t.lastFlickSpeed.x)>0?h/Math.abs(t.lastFlickSpeed.x):333,u=Math.min(u,400),u=Math.max(u,250)):u=333,gt===f&&(r=!1),ie=!0,Ie("mainScrollAnimStart"),rt("mainScroll",yt.x,d,u,i.easing.cubic.out,Pe,(function(){tt(),ie=!1,gt=-1,(r||gt!==f)&&o.updateCurrItem(),Ie("mainScrollAnimComplete")})),r&&o.updateCurrItem(!0),r},Gt=function(e){return 1/te*e*b},Kt=function(){var e=y,t=He(),r=We();y<t?e=t:y>r&&(e=r);var n,a=1,s=le;return se&&!H&&!ce&&y<t?(o.close(),!0):(se&&(n=function(e){Te((a-s)*e+s)}),o.zoomTo(e,0,200,i.easing.cubic.out,n),!0)};Se("Gestures",{publicMethods:{initGestures:function(){var e=function(e,t,r,n,i){x=e+t,O=e+r,I=e+n,R=i?e+i:""};(A=L.pointerEvent)&&L.touch&&(L.touch=!1),A?navigator.msPointerEnabled?e("MSPointer","Down","Move","Up","Cancel"):e("pointer","down","move","up","cancel"):L.touch?(e("touch","start","move","end","cancel"),M=!0):e("mouse","down","move","up"),g=O+" "+I+" "+R,m=x,A&&!M&&(M=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),o.likelyTouchDevice=M,v[x]=Lt,v[O]=$t,v[I]=Ut,R&&(v[R]=v[I]),L.touch&&(m+=" mousedown",g+=" mousemove mouseup",v.mousedown=v[x],v.mousemove=v[O],v.mouseup=v[I]),M||(l.allowPanToNext=!1)}}});var qt,Yt,Jt,Xt,Zt,Qt,er=function(t,r,n,a){var s;qt&&clearTimeout(qt),Xt=!0,Jt=!0,t.initialLayout?(s=t.initialLayout,t.initialLayout=null):s=l.getThumbBoundsFn&&l.getThumbBoundsFn(f);var c,u,h=n?l.hideAnimationDuration:l.showAnimationDuration,p=function(){Qe("initialZoom"),n?(o.template.removeAttribute("style"),o.bg.removeAttribute("style")):(Te(1),r&&(r.style.display="block"),i.addClass(e,"pswp--animated-in"),Ie("initialZoom"+(n?"OutEnd":"InEnd"))),a&&a(),Xt=!1};if(!h||!s||void 0===s.x)return Ie("initialZoom"+(n?"Out":"In")),y=t.initialZoomLevel,Fe(pe,t.initialPosition),Me(),e.style.opacity=n?0:1,Te(1),void(h?setTimeout((function(){p()}),h):p());c=d,u=!o.currItem.src||o.currItem.loadError||l.showHideOpacity,t.miniImg&&(t.miniImg.style.webkitBackfaceVisibility="hidden"),n||(y=s.w/t.w,pe.x=s.x,pe.y=s.y-j,o[u?"template":"bg"].style.opacity=.001,Me()),et("initialZoom"),n&&!c&&i.removeClass(e,"pswp--animated-in"),u&&(n?i[(c?"remove":"add")+"Class"](e,"pswp--animate_opacity"):setTimeout((function(){i.addClass(e,"pswp--animate_opacity")}),30)),qt=setTimeout((function(){if(Ie("initialZoom"+(n?"Out":"In")),n){var r=s.w/t.w,o={x:pe.x,y:pe.y},a=y,l=le,d=function(t){1===t?(y=r,pe.x=s.x,pe.y=s.y-V):(y=(r-a)*t+a,pe.x=(s.x-o.x)*t+o.x,pe.y=(s.y-V-o.y)*t+o.y),Me(),u?e.style.opacity=1-t:Te(l-t*l)};c?rt("initialZoom",0,1,h,i.easing.cubic.out,d,p):(d(1),qt=setTimeout(p,h+20))}else y=t.initialZoomLevel,Fe(pe,t.initialPosition),Me(),Te(1),u?e.style.opacity=1:Te(1),qt=setTimeout(p,h+20)}),n?25:90)},tr={},rr=[],nr={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Yt.length}},ir=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},or=function(e,t,r){var n=e.bounds;n.center.x=Math.round((tr.x-t)/2),n.center.y=Math.round((tr.y-r)/2)+e.vGap.top,n.max.x=t>tr.x?Math.round(tr.x-t):n.center.x,n.max.y=r>tr.y?Math.round(tr.y-r)+e.vGap.top:n.center.y,n.min.x=t>tr.x?0:n.center.x,n.min.y=r>tr.y?e.vGap.top:n.center.y},ar=function(e,t,r){if(e.src&&!e.loadError){var n=!r;if(n&&(e.vGap||(e.vGap={top:0,bottom:0}),Ie("parseVerticalMargin",e)),tr.x=t.x,tr.y=t.y-e.vGap.top-e.vGap.bottom,n){var i=tr.x/e.w,o=tr.y/e.h;e.fitRatio=i<o?i:o;var a=l.scaleMode;"orig"===a?r=1:"fit"===a&&(r=e.fitRatio),r>1&&(r=1),e.initialZoomLevel=r,e.bounds||(e.bounds=ir())}return r?(or(e,e.w*r,e.h*r),n&&r===e.initialZoomLevel&&(e.initialPosition=e.bounds.center),e.bounds):void 0}return e.w=e.h=0,e.initialZoomLevel=e.fitRatio=1,e.bounds=ir(),e.initialPosition=e.bounds.center,e.bounds},sr=function(e,t,r,n,i,a){t.loadError||n&&(t.imageAppended=!0,ur(t,n,t===o.currItem&&Ee),r.appendChild(n),a&&setTimeout((function(){t&&t.loaded&&t.placeholder&&(t.placeholder.style.display="none",t.placeholder=null)}),500))},lr=function(e){e.loading=!0,e.loaded=!1;var t=e.img=i.createEl("pswp__img","img"),r=function(){e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,t.onload=t.onerror=null,t=null};return t.onload=r,t.onerror=function(){e.loadError=!0,r()},t.src=e.src,t},cr=function(e,t){if(e.src&&e.loadError&&e.container)return t&&(e.container.innerHTML=""),e.container.innerHTML=l.errorMsg.replace("%url%",e.src),!0},ur=function(e,t,r){if(e.src){t||(t=e.container.lastChild);var n=r?e.w:Math.round(e.w*e.fitRatio),i=r?e.h:Math.round(e.h*e.fitRatio);e.placeholder&&!e.loaded&&(e.placeholder.style.width=n+"px",e.placeholder.style.height=i+"px"),t.style.width=n+"px",t.style.height=i+"px"}},dr=function(){if(rr.length){for(var e,t=0;t<rr.length;t++)(e=rr[t]).holder.index===e.index&&sr(e.index,e.item,e.baseDiv,e.img,!1,e.clearPlaceholder);rr=[]}};Se("Controller",{publicMethods:{lazyLoadItem:function(e){e=ke(e);var t=Zt(e);!t||(t.loaded||t.loading)&&!E||(Ie("gettingData",e,t),t.src&&lr(t))},initController:function(){i.extend(l,nr,!0),o.items=Yt=r,Zt=o.getItemAt,Qt=l.getNumItemsFn,l.loop,Qt()<3&&(l.loop=!1),Oe("beforeChange",(function(e){var t,r=l.preload,n=null===e||e>=0,i=Math.min(r[0],Qt()),a=Math.min(r[1],Qt());for(t=1;t<=(n?a:i);t++)o.lazyLoadItem(f+t);for(t=1;t<=(n?i:a);t++)o.lazyLoadItem(f-t)})),Oe("initialLayout",(function(){o.currItem.initialLayout=l.getThumbBoundsFn&&l.getThumbBoundsFn(f)})),Oe("mainScrollAnimComplete",dr),Oe("initialZoomInEnd",dr),Oe("destroy",(function(){for(var e,t=0;t<Yt.length;t++)(e=Yt[t]).container&&(e.container=null),e.placeholder&&(e.placeholder=null),e.img&&(e.img=null),e.preloader&&(e.preloader=null),e.loadError&&(e.loaded=e.loadError=!1);rr=null}))},getItemAt:function(e){return e>=0&&void 0!==Yt[e]&&Yt[e]},allowProgressiveImg:function(){return l.forceProgressiveLoading||!M||l.mouseUsed||screen.width>1200},setContent:function(e,t){l.loop&&(t=ke(t));var r=o.getItemAt(e.index);r&&(r.container=null);var n,a=o.getItemAt(t);if(a){Ie("gettingData",t,a),e.index=t,e.item=a;var s=a.container=i.createEl("pswp__zoom-wrap");if(!a.src&&a.html&&(a.html.tagName?s.appendChild(a.html):s.innerHTML=a.html),cr(a),ar(a,ge),!a.src||a.loadError||a.loaded)a.src&&!a.loadError&&((n=i.createEl("pswp__img","img")).style.opacity=1,n.src=a.src,ur(a,n),sr(t,a,s,n));else{if(a.loadComplete=function(r){if(c){if(e&&e.index===t){if(cr(r,!0))return r.loadComplete=r.img=null,ar(r,ge),Ne(r),void(e.index===f&&o.updateCurrZoomItem());r.imageAppended?!Xt&&r.placeholder&&(r.placeholder.style.display="none",r.placeholder=null):L.transform&&(ie||Xt)?rr.push({item:r,baseDiv:s,img:r.img,index:t,holder:e,clearPlaceholder:!0}):sr(t,r,s,r.img,ie||Xt,!0)}r.loadComplete=null,r.img=null,Ie("imageLoadComplete",t,r)}},i.features.transform){var u="pswp__img pswp__img--placeholder";u+=a.msrc?"":" pswp__img--placeholder--blank";var d=i.createEl(u,a.msrc?"img":"");a.msrc&&(d.src=a.msrc),ur(a,d),s.appendChild(d),a.placeholder=d}a.loading||lr(a),o.allowProgressiveImg()&&(!Jt&&L.transform?rr.push({item:a,baseDiv:s,img:a.img,index:t,holder:e}):sr(t,a,s,a.img,!0,!0))}Jt||t!==f?Ne(a):(ne=s.style,er(a,n||a.img)),e.el.innerHTML="",e.el.appendChild(s)}else e.el.innerHTML=""},cleanSlide:function(e){e.img&&(e.img.onload=e.img.onerror=null),e.loaded=e.loading=e.img=e.imageAppended=!1}}});var fr,hr,pr={},gr=function(e,t,r){var n=document.createEvent("CustomEvent"),i={origEvent:e,target:e.target,releasePoint:t,pointerType:r||"touch"};n.initCustomEvent("pswpTap",!0,!0,i),e.target.dispatchEvent(n)};Se("Tap",{publicMethods:{initTap:function(){Oe("firstTouchStart",o.onTapStart),Oe("touchRelease",o.onTapRelease),Oe("destroy",(function(){pr={},fr=null}))},onTapStart:function(e){e.length>1&&(clearTimeout(fr),fr=null)},onTapRelease:function(e,t){if(t&&!J&&!q&&!Ze){var r=t;if(fr&&(clearTimeout(fr),fr=null,Ct(r,pr)))return void Ie("doubleTap",r);if("mouse"===t.type)return void gr(e,t,"mouse");if("BUTTON"===e.target.tagName.toUpperCase()||i.hasClass(e.target,"pswp__single-tap"))return void gr(e,t);Fe(pr,r),fr=setTimeout((function(){gr(e,t),fr=null}),300)}}}}),Se("DesktopZoom",{publicMethods:{initDesktopZoom:function(){F||(M?Oe("mouseUsed",(function(){o.setupDesktopZoom()})):o.setupDesktopZoom(!0))},setupDesktopZoom:function(t){hr={};var r="wheel mousewheel DOMMouseScroll";Oe("bindEvents",(function(){i.bind(e,r,o.handleMouseWheel)})),Oe("unbindEvents",(function(){hr&&i.unbind(e,r,o.handleMouseWheel)})),o.mouseZoomedIn=!1;var n,a=function(){o.mouseZoomedIn&&(i.removeClass(e,"pswp--zoomed-in"),o.mouseZoomedIn=!1),y<1?i.addClass(e,"pswp--zoom-allowed"):i.removeClass(e,"pswp--zoom-allowed"),s()},s=function(){n&&(i.removeClass(e,"pswp--dragging"),n=!1)};Oe("resize",a),Oe("afterChange",a),Oe("pointerDown",(function(){o.mouseZoomedIn&&(n=!0,i.addClass(e,"pswp--dragging"))})),Oe("pointerUp",s),t||a()},handleMouseWheel:function(e){if(y<=o.currItem.fitRatio)return l.modal&&(!l.closeOnScroll||Ze||K?e.preventDefault():T&&Math.abs(e.deltaY)>2&&(d=!0,o.close())),!0;if(e.stopPropagation(),hr.x=0,"deltaX"in e)1===e.deltaMode?(hr.x=18*e.deltaX,hr.y=18*e.deltaY):(hr.x=e.deltaX,hr.y=e.deltaY);else if("wheelDelta"in e)e.wheelDeltaX&&(hr.x=-.16*e.wheelDeltaX),e.wheelDeltaY?hr.y=-.16*e.wheelDeltaY:hr.y=-.16*e.wheelDelta;else{if(!("detail"in e))return;hr.y=e.detail}ze(y,!0);var t=pe.x-hr.x,r=pe.y-hr.y;(l.modal||t<=re.min.x&&t>=re.max.x&&r<=re.min.y&&r>=re.max.y)&&e.preventDefault(),o.panTo(t,r)},toggleDesktopZoom:function(t){t=t||{x:ge.x/2+ve.x,y:ge.y/2+ve.y};var r=l.getDoubleTapZoom(!0,o.currItem),n=y===r;o.mouseZoomedIn=!n,o.zoomTo(n?o.currItem.initialZoomLevel:r,t,333),i[(n?"remove":"add")+"Class"](e,"pswp--zoomed-in")}}});var mr,vr,yr,br,_r,wr,Cr,Er,Sr,kr,xr,Or,Ir={history:!0,galleryUID:1},Rr=function(){return xr.hash.substring(1)},Tr=function(){mr&&clearTimeout(mr),yr&&clearTimeout(yr)},Ar=function(){var e=Rr(),t={};if(e.length<5)return t;var r,n=e.split("&");for(r=0;r<n.length;r++)if(n[r]){var i=n[r].split("=");i.length<2||(t[i[0]]=i[1])}if(l.galleryPIDs){var o=t.pid;for(t.pid=0,r=0;r<Yt.length;r++)if(Yt[r].pid===o){t.pid=r;break}}else t.pid=parseInt(t.pid,10)-1;return t.pid<0&&(t.pid=0),t},Mr=function(){if(yr&&clearTimeout(yr),Ze||K)yr=setTimeout(Mr,500);else{br?clearTimeout(vr):br=!0;var e=f+1,t=Zt(f);t.hasOwnProperty("pid")&&(e=t.pid);var r=Cr+"&gid="+l.galleryUID+"&pid="+e;Er||-1===xr.hash.indexOf(r)&&(kr=!0);var n=xr.href.split("#")[0]+"#"+r;Or?"#"+r!==window.location.hash&&history[Er?"replaceState":"pushState"]("",document.title,n):Er?xr.replace(n):xr.hash=r,Er=!0,vr=setTimeout((function(){br=!1}),60)}};Se("History",{publicMethods:{initHistory:function(){if(i.extend(l,Ir,!0),l.history){xr=window.location,kr=!1,Sr=!1,Er=!1,Cr=Rr(),Or="pushState"in history,Cr.indexOf("gid=")>-1&&(Cr=(Cr=Cr.split("&gid=")[0]).split("?gid=")[0]),Oe("afterChange",o.updateURL),Oe("unbindEvents",(function(){i.unbind(window,"hashchange",o.onHashChange)}));var e=function(){wr=!0,Sr||(kr?history.back():Cr?xr.hash=Cr:Or?history.pushState("",document.title,xr.pathname+xr.search):xr.hash=""),Tr()};Oe("unbindEvents",(function(){d&&e()})),Oe("destroy",(function(){wr||e()})),Oe("firstUpdate",(function(){f=Ar().pid}));var t=Cr.indexOf("pid=");t>-1&&"&"===(Cr=Cr.substring(0,t)).slice(-1)&&(Cr=Cr.slice(0,-1)),setTimeout((function(){c&&i.bind(window,"hashchange",o.onHashChange)}),40)}},onHashChange:function(){if(Rr()===Cr)return Sr=!0,void o.close();br||(_r=!0,o.goTo(Ar().pid),_r=!1)},updateURL:function(){Tr(),!_r&&(Er?mr=setTimeout(Mr,800):Mr())}}}),i.extend(o,nt)};return e}()}(cW);const uW=cW.exports;var dW={exports:{}};!function(e,t){e.exports=function(){var e=function(e,t){var r,n,i,o,a,s,l,c,u,d,f,h,p,g,m,v,y,b,_=this,w=!1,C=!0,E=!0,S={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){return e.title?(t.children[0].innerHTML=e.title,!0):(t.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return e.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return e.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},k=function(e){if(v)return!0;e=e||window.event,m.timeToIdle&&m.mouseUsed&&!u&&P();for(var r,n,i=(e.target||e.srcElement).getAttribute("class")||"",o=0;o<z.length;o++)(r=z[o]).onTap&&i.indexOf("pswp__"+r.name)>-1&&(r.onTap(),n=!0);if(n){e.stopPropagation&&e.stopPropagation(),v=!0;var a=t.features.isOldAndroid?600:30;setTimeout((function(){v=!1}),a)}},x=function(){return!e.likelyTouchDevice||m.mouseUsed||screen.width>m.fitControlsWidth},O=function(e,r,n){t[(n?"add":"remove")+"Class"](e,"pswp__"+r)},I=function(){var e=1===m.getNumItemsFn();e!==g&&(O(n,"ui--one-slide",e),g=e)},R=function(){O(l,"share-modal--hidden",E)},T=function(){return(E=!E)?(t.removeClass(l,"pswp__share-modal--fade-in"),setTimeout((function(){E&&R()}),300)):(R(),setTimeout((function(){E||t.addClass(l,"pswp__share-modal--fade-in")}),30)),E||M(),!1},A=function(t){var r=(t=t||window.event).target||t.srcElement;return e.shout("shareLinkClick",t,r),!(!r.href||!r.hasAttribute("download")&&(window.open(r.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),E||T(),1))},M=function(){for(var e,t,r,n,i="",o=0;o<m.shareButtons.length;o++)e=m.shareButtons[o],t=m.getImageURLForShare(e),r=m.getPageURLForShare(e),n=m.getTextForShare(e),i+='<a href="'+e.url.replace("{{url}}",encodeURIComponent(r)).replace("{{image_url}}",encodeURIComponent(t)).replace("{{raw_image_url}}",t).replace("{{text}}",encodeURIComponent(n))+'" target="_blank" class="pswp__share--'+e.id+'"'+(e.download?"download":"")+">"+e.label+"</a>",m.parseShareButtonOut&&(i=m.parseShareButtonOut(e,i));l.children[0].innerHTML=i,l.children[0].onclick=A},N=function(e){for(var r=0;r<m.closeElClasses.length;r++)if(t.hasClass(e,"pswp__"+m.closeElClasses[r]))return!0},D=0,P=function(){clearTimeout(b),D=0,u&&_.setIdle(!1)},j=function(e){var t=(e=e||window.event).relatedTarget||e.toElement;(!t||"HTML"===t.nodeName)&&(clearTimeout(b),b=setTimeout((function(){_.setIdle(!0)}),m.timeToIdleOutside))},F=function(){m.fullscreenEl&&!t.features.isOldAndroid&&(r||(r=_.getFullscreenAPI()),r?(t.bind(document,r.eventK,_.updateFullscreen),_.updateFullscreen(),t.addClass(e.template,"pswp--supports-fs")):t.removeClass(e.template,"pswp--supports-fs"))},V=function(){m.preloaderEl&&(L(!0),d("beforeChange",(function(){clearTimeout(p),p=setTimeout((function(){e.currItem&&e.currItem.loading?(!e.allowProgressiveImg()||e.currItem.img&&!e.currItem.img.naturalWidth)&&L(!1):L(!0)}),m.loadingIndicatorDelay)})),d("imageLoadComplete",(function(t,r){e.currItem===r&&L(!0)})))},L=function(e){h!==e&&(O(f,"preloader--active",!e),h=e)},$=function(e){var r=e.vGap;if(x()){var a=m.barsSize;if(m.captionEl&&"auto"===a.bottom)if(o||((o=t.createEl("pswp__caption pswp__caption--fake")).appendChild(t.createEl("pswp__caption__center")),n.insertBefore(o,i),t.addClass(n,"pswp__ui--fit")),m.addCaptionHTMLFn(e,o,!0)){var s=o.clientHeight;r.bottom=parseInt(s,10)||44}else r.bottom=a.top;else r.bottom="auto"===a.bottom?0:a.bottom;r.top=a.top}else r.top=r.bottom=0},B=function(){m.timeToIdle&&d("mouseUsed",(function(){t.bind(document,"mousemove",P),t.bind(document,"mouseout",j),y=setInterval((function(){2==++D&&_.setIdle(!0)}),m.timeToIdle/2)}))},U=function(){var e;d("onVerticalDrag",(function(e){C&&e<.95?_.hideControls():!C&&e>=.95&&_.showControls()})),d("onPinchClose",(function(t){C&&t<.9?(_.hideControls(),e=!0):e&&!C&&t>.9&&_.showControls()})),d("zoomGestureEnded",(function(){(e=!1)&&!C&&_.showControls()}))},z=[{name:"caption",option:"captionEl",onInit:function(e){i=e}},{name:"share-modal",option:"shareEl",onInit:function(e){l=e},onTap:function(){T()}},{name:"button--share",option:"shareEl",onInit:function(e){s=e},onTap:function(){T()}},{name:"button--zoom",option:"zoomEl",onTap:e.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(e){a=e}},{name:"button--close",option:"closeEl",onTap:e.close},{name:"button--arrow--left",option:"arrowEl",onTap:e.prev},{name:"button--arrow--right",option:"arrowEl",onTap:e.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){r.isFullscreen()?r.exit():r.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(e){f=e}}],H=function(){var e,r,i,o=function(n){if(n)for(var o=n.length,a=0;a<o;a++){e=n[a],r=e.className;for(var s=0;s<z.length;s++)i=z[s],r.indexOf("pswp__"+i.name)>-1&&(m[i.option]?(t.removeClass(e,"pswp__element--disabled"),i.onInit&&i.onInit(e)):t.addClass(e,"pswp__element--disabled"))}};o(n.children);var a=t.getChildByClass(n,"pswp__top-bar");a&&o(a.children)};_.init=function(){t.extend(e.options,S,!0),m=e.options,n=t.getChildByClass(e.scrollWrap,"pswp__ui"),d=e.listen,U(),d("beforeChange",_.update),d("doubleTap",(function(t){var r=e.currItem.initialZoomLevel;e.getZoomLevel()!==r?e.zoomTo(r,t,333):e.zoomTo(m.getDoubleTapZoom(!1,e.currItem),t,333)})),d("preventDragEvent",(function(e,t,r){var n=e.target||e.srcElement;n&&n.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(n.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(n.tagName))&&(r.prevent=!1)})),d("bindEvents",(function(){t.bind(n,"pswpTap click",k),t.bind(e.scrollWrap,"pswpTap",_.onGlobalTap),e.likelyTouchDevice||t.bind(e.scrollWrap,"mouseover",_.onMouseOver)})),d("unbindEvents",(function(){E||T(),y&&clearInterval(y),t.unbind(document,"mouseout",j),t.unbind(document,"mousemove",P),t.unbind(n,"pswpTap click",k),t.unbind(e.scrollWrap,"pswpTap",_.onGlobalTap),t.unbind(e.scrollWrap,"mouseover",_.onMouseOver),r&&(t.unbind(document,r.eventK,_.updateFullscreen),r.isFullscreen()&&(m.hideAnimationDuration=0,r.exit()),r=null)})),d("destroy",(function(){m.captionEl&&(o&&n.removeChild(o),t.removeClass(i,"pswp__caption--empty")),l&&(l.children[0].onclick=null),t.removeClass(n,"pswp__ui--over-close"),t.addClass(n,"pswp__ui--hidden"),_.setIdle(!1)})),m.showAnimationDuration||t.removeClass(n,"pswp__ui--hidden"),d("initialZoomIn",(function(){m.showAnimationDuration&&t.removeClass(n,"pswp__ui--hidden")})),d("initialZoomOut",(function(){t.addClass(n,"pswp__ui--hidden")})),d("parseVerticalMargin",$),H(),m.shareEl&&s&&l&&(E=!0),I(),B(),F(),V()},_.setIdle=function(e){u=e,O(n,"ui--idle",e)},_.update=function(){C&&e.currItem?(_.updateIndexIndicator(),m.captionEl&&(m.addCaptionHTMLFn(e.currItem,i),O(i,"caption--empty",!e.currItem.title)),w=!0):w=!1,E||T(),I()},_.updateFullscreen=function(n){n&&setTimeout((function(){e.setScrollOffset(0,t.getScrollY())}),50),t[(r.isFullscreen()?"add":"remove")+"Class"](e.template,"pswp--fs")},_.updateIndexIndicator=function(){m.counterEl&&(a.innerHTML=e.getCurrentIndex()+1+m.indexIndicatorSep+m.getNumItemsFn())},_.onGlobalTap=function(r){var n=(r=r||window.event).target||r.srcElement;if(!v)if(r.detail&&"mouse"===r.detail.pointerType){if(N(n))return void e.close();t.hasClass(n,"pswp__img")&&(1===e.getZoomLevel()&&e.getZoomLevel()<=e.currItem.fitRatio?m.clickToCloseNonZoomable&&e.close():e.toggleDesktopZoom(r.detail.releasePoint))}else if(m.tapToToggleControls&&(C?_.hideControls():_.showControls()),m.tapToClose&&(t.hasClass(n,"pswp__img")||N(n)))return void e.close()},_.onMouseOver=function(e){var t=(e=e||window.event).target||e.srcElement;O(n,"ui--over-close",N(t))},_.hideControls=function(){t.addClass(n,"pswp__ui--hidden"),C=!1},_.showControls=function(){C=!0,w||_.update(),t.removeClass(n,"pswp__ui--hidden")},_.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},_.getFullscreenAPI=function(){var t,r=document.documentElement,n="fullscreenchange";return r.requestFullscreen?t={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}:r.mozRequestFullScreen?t={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}:r.webkitRequestFullscreen?t={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}:r.msRequestFullscreen&&(t={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),t&&(t.enter=function(){if(c=m.closeOnScroll,m.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return e.template[this.enterK]();e.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},t.exit=function(){return m.closeOnScroll=c,document[this.exitK]()},t.isFullscreen=function(){return document[this.elementK]}),t}};return e}()}(dW);const fW=dW.exports;var hW,pW={exports:{}},gW={exports:{}},mW={};var vW,yW,bW,_W,wW,CW,EW,SW,kW,xW,OW,IW,RW,TW,AW={};function MW(){return yW||(yW=1,function(e){"production"===Ni.exports.env.NODE_ENV?e.exports=function(){if(hW)return mW;hW=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,m=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var f=e.$$typeof;switch(f){case t:switch(e=e.type){case l:case c:case n:case o:case i:case d:return e;default:switch(e=e&&e.$$typeof){case s:case u:case p:case h:case a:return e;default:return f}}case r:return f}}}function _(e){return b(e)===c}return mW.AsyncMode=l,mW.ConcurrentMode=c,mW.ContextConsumer=s,mW.ContextProvider=a,mW.Element=t,mW.ForwardRef=u,mW.Fragment=n,mW.Lazy=p,mW.Memo=h,mW.Portal=r,mW.Profiler=o,mW.StrictMode=i,mW.Suspense=d,mW.isAsyncMode=function(e){return _(e)||b(e)===l},mW.isConcurrentMode=_,mW.isContextConsumer=function(e){return b(e)===s},mW.isContextProvider=function(e){return b(e)===a},mW.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},mW.isForwardRef=function(e){return b(e)===u},mW.isFragment=function(e){return b(e)===n},mW.isLazy=function(e){return b(e)===p},mW.isMemo=function(e){return b(e)===h},mW.isPortal=function(e){return b(e)===r},mW.isProfiler=function(e){return b(e)===o},mW.isStrictMode=function(e){return b(e)===i},mW.isSuspense=function(e){return b(e)===d},mW.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===c||e===o||e===i||e===d||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===h||e.$$typeof===a||e.$$typeof===s||e.$$typeof===u||e.$$typeof===m||e.$$typeof===v||e.$$typeof===y||e.$$typeof===g)},mW.typeOf=b,mW}():e.exports=(vW||(vW=1,"production"!==Ni.exports.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,m=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var f=e.$$typeof;switch(f){case t:var g=e.type;switch(g){case l:case c:case n:case o:case i:case d:return g;default:var m=g&&g.$$typeof;switch(m){case s:case u:case p:case h:case a:return m;default:return f}}case r:return f}}}var _=l,w=c,C=s,E=a,S=t,k=u,x=n,O=p,I=h,R=r,T=o,A=i,M=d,N=!1;function D(e){return b(e)===c}AW.AsyncMode=_,AW.ConcurrentMode=w,AW.ContextConsumer=C,AW.ContextProvider=E,AW.Element=S,AW.ForwardRef=k,AW.Fragment=x,AW.Lazy=O,AW.Memo=I,AW.Portal=R,AW.Profiler=T,AW.StrictMode=A,AW.Suspense=M,AW.isAsyncMode=function(e){return N||(N=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),D(e)||b(e)===l},AW.isConcurrentMode=D,AW.isContextConsumer=function(e){return b(e)===s},AW.isContextProvider=function(e){return b(e)===a},AW.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},AW.isForwardRef=function(e){return b(e)===u},AW.isFragment=function(e){return b(e)===n},AW.isLazy=function(e){return b(e)===p},AW.isMemo=function(e){return b(e)===h},AW.isPortal=function(e){return b(e)===r},AW.isProfiler=function(e){return b(e)===o},AW.isStrictMode=function(e){return b(e)===i},AW.isSuspense=function(e){return b(e)===d},AW.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===c||e===o||e===i||e===d||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===h||e.$$typeof===a||e.$$typeof===s||e.$$typeof===u||e.$$typeof===m||e.$$typeof===v||e.$$typeof===y||e.$$typeof===g)},AW.typeOf=b}()),AW)}(gW)),gW.exports}function NW(){if(_W)return bW;_W=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;return bW=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch{return!1}}()?Object.assign:function(n,i){for(var o,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(n),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))t.call(o,c)&&(s[c]=o[c]);if(e){a=e(o);for(var u=0;u<a.length;u++)r.call(o,a[u])&&(s[a[u]]=o[a[u]])}}return s},bW}function DW(){if(CW)return wW;CW=1;return wW="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function PW(){return SW||(SW=1,EW=Function.call.bind(Object.prototype.hasOwnProperty)),EW}if("production"!==Ni.exports.env.NODE_ENV){var jW=MW();pW.exports=function(){if(IW)return OW;IW=1;var e=MW(),t=NW(),r=DW(),n=PW(),i=function(){if(xW)return kW;xW=1;var e=function(){};if("production"!==Ni.exports.env.NODE_ENV){var t=DW(),r={},n=PW();e=function(e){var t="Warning: "+e;typeof console<"u"&&console.error(t);try{throw new Error(t)}catch{}}}function i(i,o,a,s,l){if("production"!==Ni.exports.env.NODE_ENV)for(var c in i)if(n(i,c)){var u;try{if("function"!=typeof i[c]){var d=Error((s||"React class")+": "+a+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[c]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw d.name="Invariant Violation",d}u=i[c](o,c,s,a,null,t)}catch(e){u=e}if(u&&!(u instanceof Error)&&e((s||"React class")+": type specification of "+a+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof u+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),u instanceof Error&&!(u.message in r)){r[u.message]=!0;var f=l?l():"";e("Failed "+a+" type: "+u.message+(null!=f?f:""))}}}return i.resetWarningCache=function(){"production"!==Ni.exports.env.NODE_ENV&&(r={})},kW=i}(),o=function(){};function a(){return null}return"production"!==Ni.exports.env.NODE_ENV&&(o=function(e){var t="Warning: "+e;typeof console<"u"&&console.error(t);try{throw new Error(t)}catch{}}),OW=function(s,l){var c="function"==typeof Symbol&&Symbol.iterator,u="@@iterator",d="<<anonymous>>",f={array:m("array"),bigint:m("bigint"),bool:m("boolean"),func:m("function"),number:m("number"),object:m("object"),string:m("string"),symbol:m("symbol"),any:g(a),arrayOf:function(e){return g((function(t,n,i,o,a){if("function"!=typeof e)return new p("Property `"+a+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var s=t[n];if(!Array.isArray(s))return new p("Invalid "+o+" `"+a+"` of type `"+b(s)+"` supplied to `"+i+"`, expected an array.");for(var l=0;l<s.length;l++){var c=e(s,l,i,o,a+"["+l+"]",r);if(c instanceof Error)return c}return null}))},element:g((function(e,t,r,n,i){var o=e[t];return s(o)?null:new p("Invalid "+n+" `"+i+"` of type `"+b(o)+"` supplied to `"+r+"`, expected a single ReactElement.")})),elementType:g((function(t,r,n,i,o){var a=t[r];return e.isValidElementType(a)?null:new p("Invalid "+i+" `"+o+"` of type `"+b(a)+"` supplied to `"+n+"`, expected a single ReactElement type.")})),instanceOf:function(e){return g((function(t,r,n,i,o){if(!(t[r]instanceof e)){var a=e.name||d,s=function(e){return e.constructor&&e.constructor.name?e.constructor.name:d}(t[r]);return new p("Invalid "+i+" `"+o+"` of type `"+s+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}return null}))},node:g((function(e,t,r,n,i){return y(e[t])?null:new p("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return g((function(t,i,o,a,s){if("function"!=typeof e)return new p("Property `"+s+"` of component `"+o+"` has invalid PropType notation inside objectOf.");var l=t[i],c=b(l);if("object"!==c)return new p("Invalid "+a+" `"+s+"` of type `"+c+"` supplied to `"+o+"`, expected an object.");for(var u in l)if(n(l,u)){var d=e(l,u,o,a,s+"."+u,r);if(d instanceof Error)return d}return null}))},oneOf:function(e){return Array.isArray(e)?g((function(t,r,n,i,o){for(var a=t[r],s=0;s<e.length;s++)if(h(a,e[s]))return null;var l=JSON.stringify(e,(function(e,t){return"symbol"===_(t)?String(t):t}));return new p("Invalid "+i+" `"+o+"` of value `"+String(a)+"` supplied to `"+n+"`, expected one of "+l+".")})):("production"!==Ni.exports.env.NODE_ENV&&o(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),a)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==Ni.exports.env.NODE_ENV&&o("Invalid argument supplied to oneOfType, expected an instance of array."),a;for(var t=0;t<e.length;t++){var i=e[t];if("function"!=typeof i)return o("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+w(i)+" at index "+t+"."),a}return g((function(t,i,o,a,s){for(var l=[],c=0;c<e.length;c++){var u=(0,e[c])(t,i,o,a,s,r);if(null==u)return null;u.data&&n(u.data,"expectedType")&&l.push(u.data.expectedType)}return new p("Invalid "+a+" `"+s+"` supplied to `"+o+"`"+(l.length>0?", expected one of type ["+l.join(", ")+"]":"")+".")}))},shape:function(e){return g((function(t,n,i,o,a){var s=t[n],l=b(s);if("object"!==l)return new p("Invalid "+o+" `"+a+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");for(var c in e){var u=e[c];if("function"!=typeof u)return v(i,o,a,c,_(u));var d=u(s,c,i,o,a+"."+c,r);if(d)return d}return null}))},exact:function(e){return g((function(i,o,a,s,l){var c=i[o],u=b(c);if("object"!==u)return new p("Invalid "+s+" `"+l+"` of type `"+u+"` supplied to `"+a+"`, expected `object`.");var d=t({},i[o],e);for(var f in d){var h=e[f];if(n(e,f)&&"function"!=typeof h)return v(a,s,l,f,_(h));if(!h)return new p("Invalid "+s+" `"+l+"` key `"+f+"` supplied to `"+a+"`.\nBad object: "+JSON.stringify(i[o],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var g=h(c,f,a,s,l+"."+f,r);if(g)return g}return null}))}};function h(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function p(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function g(e){if("production"!==Ni.exports.env.NODE_ENV)var t={},n=0;function i(i,a,s,c,u,f,h){if(c=c||d,f=f||s,h!==r){if(l){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}if("production"!==Ni.exports.env.NODE_ENV&&typeof console<"u"){var m=c+":"+s;!t[m]&&n<3&&(o("You are manually calling a React.PropTypes validation function for the `"+f+"` prop on `"+c+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),t[m]=!0,n++)}}return null==a[s]?i?null===a[s]?new p("The "+u+" `"+f+"` is marked as required in `"+c+"`, but its value is `null`."):new p("The "+u+" `"+f+"` is marked as required in `"+c+"`, but its value is `undefined`."):null:e(a,s,c,u,f)}var a=i.bind(null,!1);return a.isRequired=i.bind(null,!0),a}function m(e){return g((function(t,r,n,i,o,a){var s=t[r];return b(s)!==e?new p("Invalid "+i+" `"+o+"` of type `"+_(s)+"` supplied to `"+n+"`, expected `"+e+"`.",{expectedType:e}):null}))}function v(e,t,r,n,i){return new p((e||"React class")+": "+t+" type `"+r+"."+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+i+"`.")}function y(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(y);if(null===e||s(e))return!0;var t=function(e){var t=e&&(c&&e[c]||e[u]);if("function"==typeof t)return t}(e);if(!t)return!1;var r,n=t.call(e);if(t!==e.entries){for(;!(r=n.next()).done;)if(!y(r.value))return!1}else for(;!(r=n.next()).done;){var i=r.value;if(i&&!y(i[1]))return!1}return!0;default:return!1}}function b(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function _(e){if(typeof e>"u"||null===e)return""+e;var t=b(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function w(e){var t=_(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return p.prototype=Error.prototype,f.checkPropTypes=i,f.resetWarningCache=i.resetWarningCache,f.PropTypes=f,f},OW}()(jW.isElement,!0)}else pW.exports=function(){if(TW)return RW;TW=1;var e=DW();function t(){}function r(){}return r.resetWarningCache=t,RW=function(){function n(t,r,n,i,o,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function i(){return n}n.isRequired=n;var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:t};return o.PropTypes=o,o},RW}()();const FW=.05;class VW extends s.a.Component{constructor(e){super(e),this.state={prevStatus:"default",nextStatus:"default",zoomInStatus:"default",zoomOutStatus:"default",originSizeStatus:"default",bestSizeStatus:"default"}}afterZoom(){const{imageBrowser:e}=this.props,t=e.getCurrentZoomLevel(),r=e.getInitialZoomLevel();let n;t===r&&(n="activated"),1===r&&(n="disable"),this.setState({zoomOutStatus:t===FW?"disable":"default",zoomInStatus:5===t?"disable":"default",originSizeStatus:1===t?"activated":"default",bestSizeStatus:n})}afterChange(){const{imageBrowser:e}=this.props,t=e.getCount();this.setState({nextStatus:1===t?"disable":"default",prevStatus:1===t?"disable":"default"})}componentDidMount(){const{imageBrowser:e}=this.props;e.on("afterzoom",(()=>{this.afterZoom()})),e.on("afterchange",(()=>{this.afterChange()})),e.on("resize",(()=>{setTimeout((()=>{this.afterChange(),this.afterZoom()}),333)})),this.setState({tooltipContainer:this.tooltipContainer})}renderBtn(e,t,r,n){const{tooltipContainer:i}=this.state;return i?s.a.createElement(p.a,{title:t,getPopupContainer:()=>i,mouseEnterDelay:1},s.a.createElement("span",{className:`lake-pswp-${e} btn ${r}`,onClick:n})):""}render(){const{imageBrowser:e,shouldShowNavigation:t,shouldShowDownload:r,shouldShowRemove:n}=this.props,{prevStatus:i,nextStatus:o,zoomInStatus:a,zoomOutStatus:l,originSizeStatus:c,bestSizeStatus:u}=this.state;return s.a.createElement("div",{className:"lake-pswp-tool-bar"},s.a.createElement("div",{ref:e=>{this.tooltipContainer=e}}),s.a.createElement("div",{className:"pswp-toolbar-content"},t&&s.a.createElement(s.a.Fragment,null,this.renderBtn("arrow-left",Ph("上一张"),i,(()=>{"disable"!==i&&e.prev()})),s.a.createElement("span",{className:"lake-pswp-counter"}),this.renderBtn("arrow-right",Ph("下一张"),o,(()=>{"disable"!==o&&e.next()})),s.a.createElement("span",{className:"separation"})),this.renderBtn("zoom-out",Ph("缩小"),l,(()=>{"disable"!==l&&e.zoomOut()})),this.renderBtn("zoom-in",Ph("放大"),a,(()=>{"disable"!==a&&e.zoomIn()})),this.renderBtn("origin-size",Ph("实际尺寸"),c,(()=>{"disable"!==c&&e.zoomToOriginSize()})),this.renderBtn("best-size",Ph("适应屏幕"),u,(()=>{"disable"!==u&&e.zoomToBestSize()})),r&&this.renderBtn("download",Ph("下载图片"),null,(()=>{e.download()})),n&&this.renderBtn("remove",Ph("删除图片"),null,(()=>{e.remove()}))))}}VW.propTypes={imageBrowser:pW.exports.object,shouldShowNavigation:pW.exports.bool,shouldShowDownload:pW.exports.bool,shouldShowRemove:pW.exports.bool};var LW={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var f,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn===t&&(!i||s.once)&&(!n||s.context===n)&&a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(LW);const $W=LW.exports;function BW(e){return["http:","https:","data:","blob:","/"].some((t=>e.startsWith(t)))?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""}class UW extends $W{constructor(e={}){super();const t=e.pswpOptions||{};this.options={shouldToggleOnHover:!1,shouldShowNavigation:!0,shouldShowDownload:!1,shouldShowRemove:!1,closable:!0,container:document.body,...globalThis.__LakeTableImageBrowser_options||{},...e,pswpOptions:{shareEl:!1,fullscreenEl:!1,zoomEl:!1,history:!1,dragging:fa.isMobile,closeOnScroll:!1,preloaderEl:!1,captionEl:!1,counterEl:!1,clickToCloseNonZoomable:!0,bgOpacity:.8,showAnimationDuration:0,hideAnimationDuration:0,closeOnVerticalDrag:fa.isMobile,tapToClose:!0,barsSize:{top:44,bottom:80},...t}},this.options.closable||(this.options.pswpOptions.escKey=!1,this.options.pswpOptions.closeElClasses=[]),this.images=[],this.pswpDestroy=!0,this.timeouts={},this._initRoot()}static loadImageSize(e,t,r,n=null){if(t.cleanSlide(e),e.loading=!0,n)e.img=n(),e.img.className="pswp__img",setTimeout((()=>{var t;e.loading=!1,e.loaded=!0,null==(t=e.loadComplete)||t.call(e,e)}));else{let n=document.createElement("img");n.className="pswp__img",e.img=n;const i=()=>{if(r.pswpDestroy)return n=null,void(e.img=null);(0===e.w||0===e.h)&&(e.w=n.width,e.h=n.height),e.needUpdate=!0,t.updateSize(),e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,n.onload=n.onerror=null,n=null};n.onload=i,n.onerror=function(){e.loadError=!0,i()},n.src=e.src}}_initRoot(){const e=this.options.closable?'<button type="button" class="pswp__button lake-pswp-button-close" title="Close (Esc)"></button>':"",t=document.createElement("div");t.innerHTML=`\n    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">\n        <div class="pswp__bg"></div>\n        <div class="pswp__scroll-wrap">\n            <div class="pswp__container">\n                <div class="pswp__item"></div>\n                <div class="pswp__item"></div>\n                <div class="pswp__item"></div>\n            </div>\n            <div class="pswp__ui pswp__ui--hidden">\n                ${e}\n                <div class="lake-pswp-custom-top-bar"></div>\n            </div>\n        </div>\n    </div>\n    `,this.options.container?this.options.container.appendChild(t):document.body.appendChild(t),this.root=t.children[0],fa.isMobile?this.root.classList.add("lake-pswp-mobile"):this.root.classList.add("lake-pswp-pc");const r=this.root.querySelector(".lake-pswp-custom-top-bar"),n=this.root.querySelector(".lake-pswp-button-close");this.toolbarContainer=r,this.closeBtnContainer=n,c.a.render(s.a.createElement(VW,{imageBrowser:this,shouldShowNavigation:this.options.shouldShowNavigation,shouldShowDownload:this.options.shouldShowDownload,shouldShowRemove:this.options.shouldShowRemove}),r,(()=>{fa.isMobile||(this.bindKeyboardEvnet(),this.bindClickEvent(),this.options.shouldToggleOnHover&&this.hoverControllerFadeInAndOut())}))}hoverControllerFadeInAndOut(){const{toolbarContainer:e,closeBtnContainer:t}=this;e.addEventListener("mouseenter",(()=>{this.removeFadeOut(e,"toolbarFadeInAndOut"),this.removeFadeOut(t,"closeFadeInAndOut")})),e.addEventListener("mouseleave",(()=>{this.fadeOut(e,"toolbarFadeInAndOut"),this.fadeOut(t,"closeFadeInAndOut")})),t.addEventListener("mouseenter",(()=>{this.removeFadeOut(e,"toolbarFadeInAndOut"),this.removeFadeOut(t,"closeFadeInAndOut")})),t.addEventListener("mouseleave",(()=>{this.fadeOut(e,"toolbarFadeInAndOut"),this.fadeOut(t,"closeFadeInAndOut")}))}removeFadeOut(e,t){const{timeouts:r}=this;r[t]&&clearTimeout(r[t]),e.removeClass("pswp-fade-out")}fadeOut(e,t){const{timeouts:r}=this;r[t]&&clearTimeout(r[t]),r[t]=setTimeout((()=>{e.addClass("pswp-fade-out")}),3e3)}bindClickEvent(){const{root:e,closeBtnContainer:t}=this;e.addEventListener("click",(e=>{const t=e.target;t.classList.contains("pswp__img")&&setTimeout((()=>{this.currentZoom=null,this.afterZoom()}),366),(t.classList.contains("pswp__bg")||t.classList.contains("lake-pswp-tool-bar"))&&this.close()})),t.addEventListener("click",(()=>{this.close()}))}prev(){this.pswp.prev()}next(){this.pswp.next()}renderCounter(){const{toolbarContainer:e,pswp:t}=this;!e||(e.querySelector(".lake-pswp-counter").innerHTML=`${t.getCurrentIndex()+1} / ${t.items.length}`)}getCurrentZoomLevel(){return this.currentZoom&&Number(this.currentZoom.toFixed(2))||this.pswp&&Number(this.pswp.getZoomLevel().toFixed(2))}zoomTo(e){const t=this.pswp;t.zoomTo(e,{x:t.viewportSize.x/2,y:t.viewportSize.y/2},100),this.currentZoom=e,this.afterZoom()}zoomIn(){const e=this.getCurrentZoomLevel();let t=1.2*e;5!==e&&(t>5&&(t=5),this.zoomTo(t))}zoomOut(){const e=this.getCurrentZoomLevel();if(e!==FW){let t=e/1.2;t<FW&&(t=FW),this.zoomTo(t)}}bindKeyboardEvnet(){this.root.addEventListener("keydown",(e=>{(e.metaKey||e.ctrlKey)&&187===e.keyCode&&(e.preventDefault(),this.zoomIn()),wz("mod+-",e)&&(e.preventDefault(),this.zoomOut())}))}zoomToOriginSize(){this.zoomTo(1)}zoomToBestSize(){const e=this.getInitialZoomLevel();this.zoomTo(e)}getInitialZoomLevel(){return Number(this.pswp.currItem.initialZoomLevel.toFixed(2))}afterZoom(){this.emit("afterzoom")}getCount(){return this.pswp.items.length}afterChange(){if(!fa.isMobile){const e=this.getInitialZoomLevel();this.renderCounter(),this.currentZoom=e,setTimeout((()=>{this.afterZoom()}),100),this.emit("afterchange"),this.currentZoom=this.getInitialZoomLevel()}this.setWhiteBackground()}bindPswpEvent(){const{pswp:e}=this;e.listen("afterChange",(()=>{this.afterChange()})),e.listen("destroy",(()=>{this.pswpDestroy=!0})),e.listen("resize",(()=>{this.emit("resize")})),e.listen("imageLoadComplete",(()=>{this.setWhiteBackground()}))}setWhiteBackground(){const{root:e}=this,t=0===this.options.pswpOptions.bgOpacity?"0 2px 14px rgba(0, 0, 0, 0.25)":"0 0 10px rgba(0, 0, 0, 0.5)";e.querySelectorAll(".pswp__img").forEach((e=>{e.complete?(e.style.background="white",e.style["box-shadow"]=t):e.onload=()=>{e.style.background="white",e.style["box-shadow"]=t}}))}open(e,t){if(!0!==this.pswpDestroy)return;e.forEach((e=>(e.src=BW(e.src),e.msrc=BW(e.msrc),e)));const{root:r}=this,{pswpOptions:n}=this.options,i=new uW(r,fW,e.map((e=>({...e}))),{index:t,...n}),o=i.lazyLoadItem;i.lazyLoadItem=function(t){if(!e[(e.length+t)%e.length].layoutSelf)return o.call(i,t)},i.listen("gettingData",((t,r)=>{isNaN(r.w)||isNaN(r.h)?(r.w=0,r.h=0,UW.loadImageSize(r,i,this)):e[t].layoutSelf&&UW.loadImageSize(r,i,this,e[t].layoutSelf)})),i.items=e.map((e=>(e.src=BW(e.src),e.msrc=BW(e.msrc),e))),i.init(),this.pswp=i,this.pswpDestroy=!1,this.options.shouldToggleOnHover&&(fa.isMobile||(this.toolbarContainer.removeClass("pswp-fade-out"),this.fadeOut(this.toolbarContainer,"toolbarFadeInAndOut"),this.closeBtnContainer.removeClass("pswp-fade-out"),this.fadeOut(this.closeBtnContainer,"closeFadeInAndOut")),r.removeClass("pswp-fade-in"),r.addClass("pswp-fade-in")),this.afterChange(),this.bindPswpEvent()}download(){window.open(this.pswp.currItem.src,"_blank")}remove(){this.emit("remove"),this.destroy()}close(){!this.options.closable||this.pswp&&this.pswp.close()}destroy(){!this.root||(this.close(),this.root.remove(),this.options=null)}}var zW=Object.defineProperty,HW=Object.getOwnPropertyDescriptor;const WW=e=>({src:e.src,msrc:e.src,w:null==e?void 0:e.width,h:null==e?void 0:e.height});function GW(e,t){const r=(globalThis.__LakeTableImageBrowser||(globalThis.__LakeTableImageBrowser=new UW),globalThis.__LakeTableImageBrowser),n=Array.isArray(e)?e.map((e=>WW(e))):[e].map((e=>WW(e)));r.open(n,t||0)}let KW=class{constructor(){this.openerName="image-viewer-opener",this.apps=["image"]}open(e,t={}){let r=t.list,n=t.index||0;r||(n=0,r=[{src:e,width:t.width,height:t.height}]),GW(r,n)}};KW=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?HW(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zW(t,r,o),o})([io()],KW);var qW=Object.defineProperty,YW=Object.getOwnPropertyDescriptor;let JW=class{constructor(){this.openerName="user-opener",this.apps=["user"]}open(e){!e.login||window.open("/"+e.login,"_blank")}};JW=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?YW(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qW(t,r,o),o})([io()],JW);var XW=Object.defineProperty,ZW=Object.getOwnPropertyDescriptor,QW=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ZW(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&XW(t,r,o),o};let eG=class{init(){this.registry.registerApp(jH),this.registry.registerApp(FH),this.registry.registerApp(jH),this.registry.registerApp(VH),this.registry.registerApp($H),this.registry.registerApp(BH),this.registry.registerApp(UH),this.registry.registerApp(zH),this.registry.registerOpener(this.filePreviewOpener),this.registry.registerOpener(this.imageViewerOpener),this.registry.registerOpener(this.hrefOpener),this.registry.registerOpener(this.safeRedirectOpener),this.registry.registerOpener(this.userOpener),this.registry.registerOpener(this.windowOpener),this.registry.registerOpener(this.windowNewOpener),this.registry.init();const e=this.openerHash.getHashes();if(e)for(const t of e)!t.name||!t.url||this.openerService.open(t.name,t.url)}initConfiguration(){this._configurationService.registerConfiguration({id:"opener",type:"object",title:"打开器",properties:{useHash:{type:"boolean",description:"opener 是否同步更新 url hash"}}}),this._configurationService.registerDefaultValue({"opener.useHash":!0})}};QW([ao(SH)],eG.prototype,"registry",2),QW([ao(AH)],eG.prototype,"openerHash",2),QW([ao(PH)],eG.prototype,"openerService",2),QW([ao(lp)],eG.prototype,"_configurationService",2),QW([ao(lW)],eG.prototype,"filePreviewOpener",2),QW([ao(KW)],eG.prototype,"imageViewerOpener",2),QW([ao(dH)],eG.prototype,"hrefOpener",2),QW([ao(pH)],eG.prototype,"safeRedirectOpener",2),QW([ao(JW)],eG.prototype,"userOpener",2),QW([ao(_H)],eG.prototype,"windowOpener",2),QW([ao(vH)],eG.prototype,"windowNewOpener",2),eG=QW([io()],eG);const tG=xo().contribution(lH).register(IH).register(SH).register(PH).register(AH).register(eG).register(lW).register(KW).register(_H).register(vH).register(dH).register(pH).register(JW);class rG extends hE{constructor(e){super(),this._activeViewId="",this._options=e,this.container=e.container,this._kernelService=e.kernelService,this._loadCoreServices(),this.registerPlugins(e.plugins,{container:this.container}),this._registerContribs(e.contribs),this.init(),this._logger.log({type:"render",action:"renderInited",data:e})}get renderService(){return this._renderService}init(){this._listenEvent(),this._renderService.init({onError:this._options.onError})}destroy(){this._renderService.destroy(),this.unregisterPlugins(this.container)}render(e){if(!e)throw Error("Can't get active view data.");this._renderService.render(e,this.container)}get _logger(){return this.container.get(cI)}_listenEvent(){this._kernelService.onDataLoaded((e=>{const t=this.container.get(lp).getValue("render.noRecord");if("loadedRecords"!==e&&!t)return;const r=this._readService.getActiveView();r&&(this._activeViewId=r.get("uuid"),this.render(r))})),this._kernelService.onDataChanged((()=>{if(!this.container.get(lp).getValue("render.noRecord")&&this._lifeService.status<kh.RecordReady)return;const e=this._readService.getActiveView();e&&this._activeViewId!==e.get("uuid")&&(this._activeViewId=e.get("uuid"),this.render(e))})),this._lifeService.when(kh.Rendered,(()=>{this.container.get(eG).init()}))}_loadCoreServices(){this._renderService=this.container.get(Qz),this._lifeService=this.container.get(xh),this._readService=this.container.get(KO)}_registerContribs(e){if(e)for(const t of e)this.container.register(t)}}class nG extends a.Component{constructor(e){super(e),this.state={key:+new Date},this._props=e.props,this._ref=s.a.createRef()}componentDidMount(){}getRef(){return this._ref.current}update(e){this._props={...this._props,...e},this.forceUpdate()}render(){const{component:e,container:t}=this.props;return e instanceof s.a.Component?s.a.createElement(iz,{onError:this.props.onError},s.a.createElement(zL,{value:{container:t,onError:this.props.onError},key:this.state.key},s.a.createElement(e.type,{...this._props,ref:this._ref},e.props.children))):s.a.createElement(iz,{onError:this.props.onError},s.a.createElement(zL,{value:{container:t,onError:this.props.onError},key:this.state.key},s.a.createElement(e,{...this._props,ref:this._ref})," "))}}nG.propTypes={props:pW.exports.object.isRequired,component:pW.exports.any.isRequired,container:pW.exports.object.isRequired,onError:pW.exports.func};class iG{constructor({onError:e}){this._onError=e}render(e,t,r){let n=null;if(!this.Component)throw Error("This view didn't provide view component.");return c.a.render(s.a.createElement(nG,{props:t,component:this.Component,container:r,ref:e=>{n=e},onError:this._onError}),e),{getReactRef:()=>null==n?void 0:n.getRef(),rerender(e){n&&n.update({...e})},destroy(){c.a.unmountComponentAtNode(e),n=null}}}unmount(e){}}var oG=Object.defineProperty,aG=Object.getOwnPropertyDescriptor,sG=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aG(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oG(t,r,o),o};let lG=class extends fp{constructor(){super(...arguments),this._onStatusChange=this._register(new _p),this.onStatusChange=this._onStatusChange.event,this.isActive=!1}get isAutoActive(){return this._configurationService.getValue("render.autoActive")}active(){this.isActive||(this.isActive=!0,this._onStatusChange.emit({status:$z.ACTIVE,isActive:this.isActive}))}inactive(){!this.isActive||(this.isActive=!1,this._onStatusChange.emit({status:$z.INACTIVE,isActive:this.isActive}))}destroy(){super.destroy()}};sG([ao(lp)],lG.prototype,"_configurationService",2),sG([Ii()],lG.prototype,"destroy",1),lG=sG([io({token:Bz})],lG);const cG=xo().contribution(Pz).contribution(Dz).contribution(Lz).register(Qz).register(nH).register(Yz).register(sH).register(Wz).register(lG);var uG=Object.defineProperty,dG=Object.getOwnPropertyDescriptor,fG=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dG(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uG(t,r,o),o};const hG=["copy","paste","cut"];let pG=class{constructor(){this._toDestroyStore=new gp,this._ignoreEnableOnInputVerify=!1}init(){this._hotkeyRegister.init(),this._$container=document,this._hotkeyListenerBindEvents()}_getTargetHotkeyByEvent(e){const t=this._getPotentialHotkeyIdsByEvent(e);return this._getEnableHotkey(e,t)}fireEventByEditable(e,t){this._ignoreEnableOnInputVerify=!0,this._dispatchEvent(e,t),this._ignoreEnableOnInputVerify=!1}_dispatchEvent(e,t){let r=null;Nd(t)&&hG.includes(t)&&(r=this._hotkeyRegister.getHotkeyItem(t)),t||(r=this._getTargetHotkeyByEvent(e),r&&e.preventDefault()),r&&(!this._isValidEventInThisHotKey(e,r)||this._runHotkeyCallBack(e,r))}registerItem(e){this._hotkeyRegister.registerItem(e)}getRegisterHotKeys(){return this._hotkeyRegister.getHotkeyItems()}_hotkeyListenerBindEvents(){this._toDestroyStore.push(EL(this._$container,"keydown",(e=>{this._dispatchEvent(e)}))),hG.forEach((e=>{this._toDestroyStore.push(EL(document,e,(t=>{this._dispatchEvent(t,e)})))}))}_getPotentialHotkeyIdsByEvent(e){const t=Rz.keyEventToHotKey(e);return this._hotkeyRegister.getRegisterHotkeyIdsByPressedKey(t)}_getEnableHotkey(e,t){if(t)for(const r of t){const t=this._hotkeyRegister.getHotkeyItem(r);if(this._isValidEventInThisHotKey(e,t))return t}}_isValidEventInThisHotKey(e,t){var r;return!(!e||!t||!this._ignoreEnableOnInputVerify&&function(e){const t=e.target,r=t&&t.tagName,n=Boolean(r&&RL.some((e=>e.toLocaleLowerCase()===r.toLocaleLowerCase()))),i=!(null==t||!t.isContentEditable);return n||i}(e)&&!t.enableOnInput||!this._activeTableService.isActive)&&(!(null==(r=t.isEnable)||!r.call(t))||(OL(e),IL(e),!1))}_runHotkeyCallBack(e,t){!t||(t.preventDefault&&e.preventDefault(),t.onHotKey(e))}destroy(){this._toDestroyStore.destroy(),this._hotkeyRegister.unRegister()}};fG([ao(Nz)],pG.prototype,"_hotkeyRegister",2),fG([ao(Bz)],pG.prototype,"_activeTableService",2),pG=fG([io({token:fz})],pG);const gG=xo().contribution(hz).register(pG).register(Nz);function mG(){throw new Error("INVALID_USEEVENT_INVOCATION: the callback from useEvent cannot be invoked before the component has mounted.")}function vG(e){const t=Object(a.useRef)(mG);Object(a.useLayoutEffect)((()=>{t.current=e}),[e]);const r=Object(a.useRef)(null);return r.current||(r.current=function(){return t.current.apply(this,arguments)}),r.current}function yG(e,t,r){const n=Object(a.useRef)(null),i=(null==r?void 0:r.isEnable)||pz.isEnable,o=vG(t);return Object(a.useLayoutEffect)((()=>{const t=t=>{if(null!==n.current&&document.activeElement!==n.current&&!n.current.contains(document.activeElement))return OL(t),void IL(t);Oz(e).forEach((e=>{if(Rz.isKeyboardEventMatchingHotkey(t,e)){if(!i())return OL(t),void IL(t);null!=r&&r.preventDefault&&t.preventDefault(),o(t)}}))};return(n.current||document).addEventListener("keydown",t),()=>{(n.current||document).removeEventListener("keydown",t)}}),[e,o]),n}function bG(e,t,r){const n=Object(a.useRef)(null),i=Object(a.useRef)(0),o=Object(a.useRef)(),s=Object(a.useRef)([]),l=Object(a.useRef)(),c=Object(a.useRef)(),u=Object(a.useRef)(e),d=Object(a.useRef)(!0);Object(a.useEffect)((()=>{u.current=e}),[e]);const f=!t&&0!==t&&typeof window<"u";if("function"!=typeof e)throw new TypeError("Expected a function");t=t||0;const h=!!(r=r||{}).leading,p=!("trailing"in r)||!!r.trailing,g="maxWait"in r,m=g?Math.max(r.maxWait||0,t):null;return Object(a.useEffect)((()=>(d.current=!0,()=>{d.current=!1})),[]),Object(a.useMemo)((()=>{const e=e=>{const t=s.current,r=l.current;return s.current=l.current=[],i.current=e,c.current=u.current.apply(r,t)},r=(e,t)=>{f&&o.current&&cancelAnimationFrame(o.current),o.current=f?requestAnimationFrame(e):setTimeout(e,t)},a=e=>{if(!d.current)return!1;const r=e-(n.current||0),o=e-i.current;return!n.current||r>=(t||0)||r<0||g&&o>=(m||0)},v=t=>(o.current=null,p&&s.current?e(t):(s.current=l.current=null,c.current)),y=()=>{const e=Date.now();if(a(e))return v(e);if(!d.current)return;const o=e-(n.current||0),s=e-i.current,l=(t||0)-o,c=g?Math.min(l,(m||0)-s):l;r(y,c)},b=(...u)=>{const f=Date.now(),p=a(f);if(s.current=u,l.current=this,n.current=f,p){if(!o.current&&d.current)return i.current=n.current,r(y,t||0),h?e(n.current):c.current;if(g)return r(y,t||0),e(n.current)}return o.current||r(y,t||0),c.current};return b.cancel=()=>{o.current&&(f?cancelAnimationFrame(o.current):clearTimeout(o.current)),i.current=0,s.current=n.current=l.current=o.current=null},b.isPending=()=>!!o.current,b.flush=()=>o.current?v(Date.now()):c.current,b}),[h,g,t,m,p,f])}function _G(e){const[t,r]=Object(a.useState)({bottom:0,height:0,left:0,right:0,top:0,width:0,x:0,y:0}),n=Object(a.useRef)(),i=Object(a.useRef)(),o=Object(a.useCallback)((e=>e.width!==(null==t?void 0:t.width)||e.height!==(null==t?void 0:t.height)||e.left!==(null==t?void 0:t.left)||e.right!==(null==t?void 0:t.right)||e.top!==(null==t?void 0:t.top)||e.bottom!==(null==t?void 0:t.bottom)||e.x!==(null==t?void 0:t.x)||e.y!==(null==t?void 0:t.y)),[t]),s=bG((e=>{r(e)}),(null==e?void 0:e.debounce)||300),l=Object(a.useCallback)((e=>{var t,r;null==(t=i.current)||t.disconnect(),null!=n.current&&cancelAnimationFrame(n.current),e&&(null==(r=i.current)||r.unobserve(e))}),[i.current]),c=Object(a.useCallback)((e=>{r(e)}),[]);return[t,t=>{null!==t&&(i.current=new ResizeObserver((i=>{l(t),n.current=requestAnimationFrame((()=>{const t=i[0].contentRect.toJSON();if(null!=e&&e.debounce)s(t);else{if(!o(t))return;r(t)}}))})),i.current.observe(t))},l,c]}function wG(e){const{value:t,defaultValue:r,onChange:n}=e,i=dz(),o=Object(a.useRef)(void 0!==t?t:r),s=(e,t=!1)=>{const r="function"==typeof e?e(o.current):e;!t&&r===o.current||(o.current=r,i(),null==n||n(r))};return Object(a.useEffect)((()=>{void 0!==t&&!Vd(t,o.current)&&s(t)}),[t]),[o.current,s]}const CG=e=>{const t=Object(a.useRef)(e);t.current=e,Object(a.useEffect)((()=>()=>t.current()),[])},EG=[{value:!0,name:Ph("是")},{value:!1,name:Ph("否")}],SG=({id:e,type:t=cz.Checkbox,defaultValue:r,value:n,onChange:i,focus:o})=>{const[a,l]=wG({value:n,defaultValue:r,onChange:i});let c;return t===cz.Checkbox?c=s.a.createElement(h.a,{checked:a,onChange:e=>{const t=e.target.checked;null==i||i(t),l(t)}}):t===cz.Radio&&(c=s.a.createElement(g.a.Group,{defaultValue:a,autoFocus:o},EG.map(((e,t)=>s.a.createElement(g.a,{value:e.value,key:t,onChange:t=>{const r=e.value;null==i||i(r),l(r)}},s.a.createElement("span",{className:"lakex-table-form-type-checkbox-value"},e.name)))))),s.a.createElement("div",{className:"lakex-table-form-checkbox",id:e},c)};function kG(){return s.a.createElement("div",{className:"lakex-table-form-empty"},`(${Ph("空")})`)}const xG=({value:e,format:t="YYYY-MM-DD",showEmpty:r})=>e?s.a.createElement("div",{className:"lakex-table-form-date-readonly"},e?bf(e).format(t):""):r?s.a.createElement(kG,null):null;var OG={},IG={exports:{}};!function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}(IG);var RG,TG={};var AG,MG={exports:{}};function NG(){return AG||(AG=1,function(e,t){e.exports=function(e,t){t.prototype.weekday=function(e){var t=this.$locale().weekStart||0,r=this.$W,n=(r<t?r+7:r)-t;return this.$utils().u(e)?n:this.subtract(n,"day").add(e,"day")}}}(MG)),MG.exports}var DG,PG={exports:{}};function jG(){return DG||(DG=1,function(e,t){e.exports=function(e,t,r){var n=t.prototype,i=function(e){return e&&(e.indexOf?e:e.s)},o=function(e,t,r,n,o){var a=e.name?e:e.$locale(),s=i(a[t]),l=i(a[r]),c=s||l.map((function(e){return e.slice(0,n)}));if(!o)return c;var u=a.weekStart;return c.map((function(e,t){return c[(t+(u||0))%7]}))},a=function(){return r.Ls[r.locale()]},s=function(e,t){return e.formats[t]||e.formats[t.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):o(e,"months")},monthsShort:function(t){return t?t.format("MMM"):o(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):o(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):o(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):o(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return s(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};n.localeData=function(){return l.bind(this)()},r.localeData=function(){var e=a();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return r.weekdays()},weekdaysShort:function(){return r.weekdaysShort()},weekdaysMin:function(){return r.weekdaysMin()},months:function(){return r.months()},monthsShort:function(){return r.monthsShort()},longDateFormat:function(t){return s(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},r.months=function(){return o(a(),"months")},r.monthsShort=function(){return o(a(),"monthsShort","months",3)},r.weekdays=function(e){return o(a(),"weekdays",null,null,e)},r.weekdaysShort=function(e){return o(a(),"weekdaysShort","weekdays",3,e)},r.weekdaysMin=function(e){return o(a(),"weekdaysMin","weekdays",2,e)}}}(PG)),PG.exports}var FG,VG={exports:{}};var LG,$G={exports:{}};var BG,UG={exports:{}};var zG,HG={exports:{}};var WG=IG.exports;Object.defineProperty(OG,"__esModule",{value:!0});var GG=OG.default=void 0,KG=WG(yf.exports),qG=function(){if(RG)return TG;RG=1,Object.defineProperty(TG,"__esModule",{value:!0}),TG.call=a,TG.default=void 0,TG.note=i,TG.noteOnce=l,TG.preMessage=void 0,TG.resetWarned=o,TG.warning=n,TG.warningOnce=s;var e={},t=[],r=function(e){t.push(e)};function n(e,r){if("production"!==Ni.exports.env.NODE_ENV&&!e&&void 0!==console){var n=t.reduce((function(e,t){return t(null!=e?e:"","warning")}),r);n&&console.error("Warning: ".concat(n))}}function i(e,r){if("production"!==Ni.exports.env.NODE_ENV&&!e&&void 0!==console){var n=t.reduce((function(e,t){return t(null!=e?e:"","note")}),r);n&&console.warn("Note: ".concat(n))}}function o(){e={}}function a(t,r,n){!r&&!e[n]&&(t(!1,n),e[n]=!0)}function s(e,t){a(n,e,t)}function l(e,t){a(i,e,t)}TG.preMessage=r,s.preMessage=r,s.resetWarned=o,s.noteOnce=l;var c=s;return TG.default=c,TG}(),YG=WG(NG()),JG=WG(jG()),XG=WG((FG||(FG=1,function(e,t){e.exports=function(){var e="week",t="year";return function(r,n,i){var o=n.prototype;o.week=function(r){if(void 0===r&&(r=null),null!==r)return this.add(7*(r-this.week()),"day");var n=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var o=i(this).startOf(t).add(1,t).date(n),a=i(this).endOf(e);if(o.isBefore(a))return 1}var s=i(this).startOf(t).date(n).startOf(e).subtract(1,"millisecond"),l=this.diff(s,e,!0);return l<0?i(this).startOf("week").week():Math.ceil(l)},o.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()}(VG)),VG.exports)),ZG=WG((LG||(LG=1,function(e,t){e.exports=function(e,t){t.prototype.weekYear=function(){var e=this.month(),t=this.week(),r=this.year();return 1===t&&11===e?r+1:0===e&&t>=52?r-1:r}}}($G)),$G.exports)),QG=WG((BG||(BG=1,function(e,t){e.exports=function(e,t){var r=t.prototype,n=r.format;r.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return n.bind(this)(e);var i=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return r.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return r.ordinal(t.week(),"W");case"w":case"ww":return i.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return i.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return i.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return n.bind(this)(o)}}}(UG)),UG.exports)),eK=WG((zG||(zG=1,function(e,t){e.exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,o={},a=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||"Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],c=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var r,n=o.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[i,function(e){this.afternoon=u(e,!1)}],a:[i,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,s("seconds")],ss:[n,s("seconds")],m:[n,s("minutes")],mm:[n,s("minutes")],H:[n,s("hours")],h:[n,s("hours")],HH:[n,s("hours")],hh:[n,s("hours")],D:[n,s("day")],DD:[r,s("day")],Do:[i,function(e){var t=o.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,s("month")],MM:[r,s("month")],MMM:[i,function(e){var t=c("months"),r=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[r,function(e){this.year=a(e)}],YYYY:[/\d{4}/,s("year")],Z:l,ZZ:l};function f(r){var n,i;n=r,i=o&&o.formats;for(var a=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var o=n&&n.toUpperCase();return r||i[n]||e[n]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),s=a.length,l=0;l<s;l+=1){var c=a[l],u=d[c],f=u&&u[0],h=u&&u[1];a[l]=h?{regex:f,parser:h}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<s;r+=1){var i=a[r];if("string"==typeof i)n+=i.length;else{var o=i.regex,l=i.parser,c=e.slice(n),u=o.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(a=e.parseTwoDigitYear);var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,a=e.args;this.$u=n;var s=a[1];if("string"==typeof s){var l=!0===a[2],c=!0===a[3],u=l||c,d=a[2];c&&(d=a[2]),o=this.$locale(),!l&&d&&(o=r.Ls[d]),this.$d=function(e,t,r){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var n=f(t)(e),i=n.year,o=n.month,a=n.day,s=n.hours,l=n.minutes,c=n.seconds,u=n.milliseconds,d=n.zone,h=new Date,p=a||(i||o?1:h.getDate()),g=i||h.getFullYear(),m=0;i&&!o||(m=o>0?o-1:h.getMonth());var v=s||0,y=l||0,b=c||0,_=u||0;return d?new Date(Date.UTC(g,m,p,v,y,b,_+60*d.offset*1e3)):r?new Date(Date.UTC(g,m,p,v,y,b,_)):new Date(g,m,p,v,y,b,_)}catch{return new Date("")}}(t,s,n),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),u&&t!=this.format(s)&&(this.$d=new Date("")),o={}}else if(s instanceof Array)for(var h=s.length,p=1;p<=h;p+=1){a[1]=s[p-1];var g=r.apply(this,a);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}p===h&&(this.$d=new Date(""))}else i.call(this,e)}}}()}(HG)),HG.exports));KG.default.extend(eK.default),KG.default.extend(QG.default),KG.default.extend(YG.default),KG.default.extend(JG.default),KG.default.extend(XG.default),KG.default.extend(ZG.default),KG.default.extend((function(e,t){var r=t.prototype,n=r.format;r.format=function(e){var t=(e||"").replace("Wo","wo");return n.bind(this)(t)}}));var tK={en_GB:"en-gb",en_US:"en",zh_CN:"zh-cn",zh_TW:"zh-tw"},rK=function(e){return tK[e]||e.split("_")[0]},nK=function(){(0,qG.noteOnce)(!1,"Not match any format. Please help to fire a issue about this.")},iK={getNow:function(){return(0,KG.default)()},getFixedDate:function(e){return(0,KG.default)(e,"YYYY-MM-DD")},getEndDate:function(e){return e.endOf("month")},getWeekDay:function(e){var t=e.locale("en");return t.weekday()+t.localeData().firstDayOfWeek()},getYear:function(e){return e.year()},getMonth:function(e){return e.month()},getDate:function(e){return e.date()},getHour:function(e){return e.hour()},getMinute:function(e){return e.minute()},getSecond:function(e){return e.second()},addYear:function(e,t){return e.add(t,"year")},addMonth:function(e,t){return e.add(t,"month")},addDate:function(e,t){return e.add(t,"day")},setYear:function(e,t){return e.year(t)},setMonth:function(e,t){return e.month(t)},setDate:function(e,t){return e.date(t)},setHour:function(e,t){return e.hour(t)},setMinute:function(e,t){return e.minute(t)},setSecond:function(e,t){return e.second(t)},isAfter:function(e,t){return e.isAfter(t)},isValidate:function(e){return e.isValid()},locale:{getWeekFirstDay:function(e){return(0,KG.default)().locale(rK(e)).localeData().firstDayOfWeek()},getWeekFirstDate:function(e,t){return t.locale(rK(e)).weekday(0)},getWeek:function(e,t){return t.locale(rK(e)).week()},getShortWeekDays:function(e){return(0,KG.default)().locale(rK(e)).localeData().weekdaysMin()},getShortMonths:function(e){return(0,KG.default)().locale(rK(e)).localeData().monthsShort()},format:function(e,t,r){return t.locale(rK(e)).format(r)},parse:function(e,t,r){for(var n=rK(e),i=0;i<r.length;i+=1){var o=r[i],a=t;if(o.includes("wo")||o.includes("Wo")){for(var s=a.split("-")[0],l=a.split("-")[1],c=(0,KG.default)(s,"YYYY").startOf("year").locale(n),u=0;u<=52;u+=1){var d=c.add(u,"week");if(d.format("Wo")===l)return d}return nK(),null}var f=(0,KG.default)(a,o).locale(n);if(f.isValid())return f}return t&&nK(),null}}},oK=iK;function aK(){return aK=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aK.apply(this,arguments)}function sK(e){return(sK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lK(e){var t=function(e,t){if("object"!==sK(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==sK(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===sK(t)?t:String(t)}function cK(e,t,r){return(t=lK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uK(e){if(Array.isArray(e))return e}function dK(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fK(e,t){if(e){if("string"==typeof e)return dK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dK(e,t)}}function hK(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pK(e,t){return uK(e)||function(e,t){var r=null==e?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||fK(e,t)||hK()}function gK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function mK(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gK(Object(r),!0).forEach((function(t){cK(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gK(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vK(e,t){var r=mK({},e);return Array.isArray(t)&&t.forEach((function(e){delete r[e]})),r}GG=OG.default=oK;const yK=Object(a.createContext)({});function bK(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function _K(e){if(typeof Symbol<"u"&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function wK(e){return function(e){if(Array.isArray(e))return dK(e)}(e)||_K(e)||fK(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lK(n.key),n)}}function SK(e,t,r){return t&&EK(e.prototype,t),r&&EK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xK(e,t){return xK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xK(e,t)}function OK(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xK(e,t)}function IK(e){return(IK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RK(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}();return function(){var r,n=IK(e);if(t){var i=IK(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===sK(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return kK(e)}(this,r)}}var TK,AK={exports:{}},MK={};var NK,DK={};function PK(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return s.a.Children.forEach(e,(function(e){null==e&&!t.keepEmpty||(Array.isArray(e)?r=r.concat(PK(e)):AK.exports.isFragment(e)&&e.props?r=r.concat(PK(e.props.children,t)):r.push(e))})),r}!function(e){"production"===Ni.exports.env.NODE_ENV?e.exports=function(){if(TK)return MK;TK=1;var e,t=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen");function g(e){if("object"==typeof e&&null!==e){var p=e.$$typeof;switch(p){case t:switch(e=e.type){case n:case o:case i:case u:case d:return e;default:switch(e=e&&e.$$typeof){case l:case s:case c:case h:case f:case a:return e;default:return p}}case r:return p}}}return e=Symbol.for("react.module.reference"),MK.ContextConsumer=s,MK.ContextProvider=a,MK.Element=t,MK.ForwardRef=c,MK.Fragment=n,MK.Lazy=h,MK.Memo=f,MK.Portal=r,MK.Profiler=o,MK.StrictMode=i,MK.Suspense=u,MK.SuspenseList=d,MK.isAsyncMode=function(){return!1},MK.isConcurrentMode=function(){return!1},MK.isContextConsumer=function(e){return g(e)===s},MK.isContextProvider=function(e){return g(e)===a},MK.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},MK.isForwardRef=function(e){return g(e)===c},MK.isFragment=function(e){return g(e)===n},MK.isLazy=function(e){return g(e)===h},MK.isMemo=function(e){return g(e)===f},MK.isPortal=function(e){return g(e)===r},MK.isProfiler=function(e){return g(e)===o},MK.isStrictMode=function(e){return g(e)===i},MK.isSuspense=function(e){return g(e)===u},MK.isSuspenseList=function(e){return g(e)===d},MK.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===n||t===o||t===i||t===u||t===d||t===p||"object"==typeof t&&null!==t&&(t.$$typeof===h||t.$$typeof===f||t.$$typeof===a||t.$$typeof===s||t.$$typeof===c||t.$$typeof===e||void 0!==t.getModuleId)},MK.typeOf=g,MK}():e.exports=(NK||(NK=1,"production"!==Ni.exports.env.NODE_ENV&&function(){var e,t=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen");function g(e){if("object"==typeof e&&null!==e){var p=e.$$typeof;switch(p){case t:var g=e.type;switch(g){case n:case o:case i:case u:case d:return g;default:var m=g&&g.$$typeof;switch(m){case l:case s:case c:case h:case f:case a:return m;default:return p}}case r:return p}}}e=Symbol.for("react.module.reference");var m=s,v=a,y=t,b=c,_=n,w=h,C=f,E=r,S=o,k=i,x=u,O=d,I=!1,R=!1;DK.ContextConsumer=m,DK.ContextProvider=v,DK.Element=y,DK.ForwardRef=b,DK.Fragment=_,DK.Lazy=w,DK.Memo=C,DK.Portal=E,DK.Profiler=S,DK.StrictMode=k,DK.Suspense=x,DK.SuspenseList=O,DK.isAsyncMode=function(e){return I||(I=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 18+.")),!1},DK.isConcurrentMode=function(e){return R||(R=!0,console.warn("The ReactIs.isConcurrentMode() alias has been deprecated, and will be removed in React 18+.")),!1},DK.isContextConsumer=function(e){return g(e)===s},DK.isContextProvider=function(e){return g(e)===a},DK.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},DK.isForwardRef=function(e){return g(e)===c},DK.isFragment=function(e){return g(e)===n},DK.isLazy=function(e){return g(e)===h},DK.isMemo=function(e){return g(e)===f},DK.isPortal=function(e){return g(e)===r},DK.isProfiler=function(e){return g(e)===o},DK.isStrictMode=function(e){return g(e)===i},DK.isSuspense=function(e){return g(e)===u},DK.isSuspenseList=function(e){return g(e)===d},DK.isValidElementType=function(t){return!("string"!=typeof t&&"function"!=typeof t&&t!==n&&t!==o&&t!==i&&t!==u&&t!==d&&t!==p&&("object"!=typeof t||null===t||t.$$typeof!==h&&t.$$typeof!==f&&t.$$typeof!==a&&t.$$typeof!==s&&t.$$typeof!==c&&t.$$typeof!==e&&void 0===t.getModuleId))},DK.typeOf=g}()),DK)}(AK);var jK={},FK=[];function VK(e,t){if("production"!==Ni.exports.env.NODE_ENV&&!e&&void 0!==console){var r=FK.reduce((function(e,t){return t(null!=e?e:"","warning")}),t);r&&console.error("Warning: ".concat(r))}}function LK(e,t){if("production"!==Ni.exports.env.NODE_ENV&&!e&&void 0!==console){var r=FK.reduce((function(e,t){return t(null!=e?e:"","note")}),t);r&&console.warn("Note: ".concat(r))}}function $K(e,t,r){!t&&!jK[r]&&(e(!1,r),jK[r]=!0)}function BK(e,t){$K(VK,e,t)}BK.preMessage=function(e){FK.push(e)},BK.resetWarned=function(){jK={}},BK.noteOnce=function(e,t){$K(LK,e,t)};var UK="RC_FORM_INTERNAL_HOOKS",zK=function(){BK(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},HK=a.createContext({getFieldValue:zK,getFieldsValue:zK,getFieldError:zK,getFieldsError:zK,isFieldsTouched:zK,isFieldTouched:zK,isFieldValidating:zK,isFieldsValidating:zK,resetFields:zK,setFields:zK,setFieldsValue:zK,validateFields:zK,submit:zK,getInternalHooks:function(){return zK(),{dispatch:zK,initEntityValue:zK,registerField:zK,useSubscribe:zK,setInitialValues:zK,setCallbacks:zK,getFields:zK,setValidateMessages:zK,setPreserve:zK}}});function WK(e){return null==e?[]:Array.isArray(e)?e:[e]}var GK={exports:{}},KK={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(KK),function(e){var t=KK.exports.default;function r(){e.exports=r=function(){return i},e.exports.__esModule=!0,e.exports.default=e.exports;var n,i={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch{f=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var i=t&&t.prototype instanceof _?t:_,o=Object.create(i.prototype),a=new N(n||[]);return s(o,"_invoke",{value:R(e,r,a)}),o}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=h;var g="suspendedStart",m="suspendedYield",v="executing",y="completed",b={};function _(){}function w(){}function C(){}var E={};f(E,c,(function(){return this}));var S=Object.getPrototypeOf,k=S&&S(S(D([])));k&&k!==o&&a.call(k,c)&&(E=k);var x=C.prototype=_.prototype=Object.create(E);function O(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,r){function n(i,o,s,l){var c=p(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==t(d)&&a.call(d,"__await")?r.resolve(d.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):r.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,l)}))}l(c.arg)}var i;s(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function R(e,t,r){var i=g;return function(o,a){if(i===v)throw new Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:n,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=T(s,r);if(l){if(l===b)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===g)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=p(e,t,r);if("normal"===c.type){if(i=r.done?y:m,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function T(e,t){var r=t.method,i=e.iterator[r];if(i===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var o=p(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,b;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,b):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,b)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(a.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=C,s(x,"constructor",{value:C,configurable:!0}),s(C,"constructor",{value:w,configurable:!0}),w.displayName=f(C,d,"GeneratorFunction"),i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,f(e,d,"GeneratorFunction")),e.prototype=Object.create(x),e},i.awrap=function(e){return{__await:e}},O(I.prototype),f(I.prototype,u,(function(){return this})),i.AsyncIterator=I,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new I(h(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(x),f(x,d,"Generator"),f(x,c,(function(){return this})),f(x,"toString",(function(){return"[object Generator]"})),i.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},i.values=D,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(M),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),b}},i}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(GK);var qK=GK.exports(),YK=qK;try{regeneratorRuntime=qK}catch{"object"==typeof globalThis?globalThis.regeneratorRuntime=qK:Function("r","regeneratorRuntime = r")(qK)}function JK(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function XK(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){JK(o,n,i,a,s,"next",e)}function s(e){JK(o,n,i,a,s,"throw",e)}a(void 0)}))}}function ZK(){return ZK=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZK.apply(this,arguments)}function QK(e){return(QK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eq(e,t){return eq=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},eq(e,t)}function tq(e,t,r){return tq=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&eq(i,r.prototype),i},tq.apply(null,arguments)}function rq(e){var t="function"==typeof Map?new Map:void 0;return rq=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return tq(e,arguments,QK(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),eq(r,e)},rq(e)}var nq=/%[sdj%]/g,iq=function(){};function oq(e){if(!e||!e.length)return null;var t={};return e.forEach((function(e){var r=e.field;t[r]=t[r]||[],t[r].push(e)})),t}function aq(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=1,i=t[0],o=t.length;return"function"==typeof i?i.apply(null,t.slice(1)):"string"==typeof i?String(i).replace(nq,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(t[n++]);case"%d":return Number(t[n++]);case"%j":try{return JSON.stringify(t[n++])}catch{return"[Circular]"}break;default:return e}})):i}function sq(e,t){return!!(null==e||"array"===t&&Array.isArray(e)&&!e.length||function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(t)&&"string"==typeof e&&!e)}function lq(e,t,r){var n=0,i=e.length;!function o(a){if(a&&a.length)r(a);else{var s=n;n+=1,s<i?t(e[s],o):r([])}}([])}typeof Ni.exports<"u"&&Ni.exports.env&&"production"!==Ni.exports.env.NODE_ENV&&typeof window<"u"&&typeof document<"u"&&(iq=function(e,t){typeof console<"u"&&console.warn&&t.every((function(e){return"string"==typeof e}))&&console.warn(e,t)});var cq=function(e){function t(t,r){var n;return(n=e.call(this,"Async Validation Error")||this).errors=t,n.fields=r,n}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,eq(e,t)}(t,e),t}(rq(Error));function uq(e,t,r,n){if(t.first){var i=new Promise((function(t,i){var o=function(e){var t=[];return Object.keys(e).forEach((function(r){t.push.apply(t,e[r])})),t}(e);lq(o,r,(function(e){return n(e),e.length?i(new cq(e,oq(e))):t()}))}));return i.catch((function(e){return e})),i}var o=t.firstFields||[];!0===o&&(o=Object.keys(e));var a=Object.keys(e),s=a.length,l=0,c=[],u=new Promise((function(t,i){var u=function(e){if(c.push.apply(c,e),++l===s)return n(c),c.length?i(new cq(c,oq(c))):t()};a.length||(n(c),t()),a.forEach((function(t){var n=e[t];-1!==o.indexOf(t)?lq(n,r,u):function(e,t,r){var n=[],i=0,o=e.length;function a(e){n.push.apply(n,e),++i===o&&r(n)}e.forEach((function(e){t(e,a)}))}(n,r,u)}))}));return u.catch((function(e){return e})),u}function dq(e){return function(t){return t&&t.message?(t.field=t.field||e.fullField,t):{message:"function"==typeof t?t():t,field:t.field||e.fullField}}}function fq(e,t){if(t)for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];"object"==typeof n&&"object"==typeof e[r]?e[r]=ZK({},e[r],n):e[r]=n}return e}function hq(e,t,r,n,i,o){e.required&&(!r.hasOwnProperty(e.field)||sq(t,o||e.type))&&n.push(aq(i.messages.required,e.fullField))}var pq={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},gq={integer:function(e){return gq.number(e)&&parseInt(e,10)===e},float:function(e){return gq.number(e)&&!gq.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"==typeof e},object:function(e){return"object"==typeof e&&!gq.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&!!e.match(pq.email)&&e.length<255},url:function(e){return"string"==typeof e&&!!e.match(pq.url)},hex:function(e){return"string"==typeof e&&!!e.match(pq.hex)}};var mq="enum";var vq={required:hq,whitespace:function(e,t,r,n,i){(/^\s+$/.test(t)||""===t)&&n.push(aq(i.messages.whitespace,e.fullField))},type:function(e,t,r,n,i){if(e.required&&void 0===t)hq(e,t,r,n,i);else{var o=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(o)>-1?gq[o](t)||n.push(aq(i.messages.types[o],e.fullField,e.type)):o&&typeof t!==e.type&&n.push(aq(i.messages.types[o],e.fullField,e.type))}},range:function(e,t,r,n,i){var o="number"==typeof e.len,a="number"==typeof e.min,s="number"==typeof e.max,l=t,c=null,u="number"==typeof t,d="string"==typeof t,f=Array.isArray(t);if(u?c="number":d?c="string":f&&(c="array"),!c)return!1;f&&(l=t.length),d&&(l=t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),o?l!==e.len&&n.push(aq(i.messages[c].len,e.fullField,e.len)):a&&!s&&l<e.min?n.push(aq(i.messages[c].min,e.fullField,e.min)):s&&!a&&l>e.max?n.push(aq(i.messages[c].max,e.fullField,e.max)):a&&s&&(l<e.min||l>e.max)&&n.push(aq(i.messages[c].range,e.fullField,e.min,e.max))},enum:function(e,t,r,n,i){e[mq]=Array.isArray(e[mq])?e[mq]:[],-1===e[mq].indexOf(t)&&n.push(aq(i.messages[mq],e.fullField,e[mq].join(", ")))},pattern:function(e,t,r,n,i){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||n.push(aq(i.messages.pattern.mismatch,e.fullField,t,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(t)||n.push(aq(i.messages.pattern.mismatch,e.fullField,t,e.pattern))}}};function yq(e,t,r,n,i){var o=e.type,a=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t,o)&&!e.required)return r();vq.required(e,t,n,a,i,o),sq(t,o)||vq.type(e,t,n,a,i)}r(a)}var bq={string:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t,"string")&&!e.required)return r();vq.required(e,t,n,o,i,"string"),sq(t,"string")||(vq.type(e,t,n,o,i),vq.range(e,t,n,o,i),vq.pattern(e,t,n,o,i),!0===e.whitespace&&vq.whitespace(e,t,n,o,i))}r(o)},method:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&vq.type(e,t,n,o,i)}r(o)},number:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(""===t&&(t=void 0),sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&(vq.type(e,t,n,o,i),vq.range(e,t,n,o,i))}r(o)},boolean:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&vq.type(e,t,n,o,i)}r(o)},regexp:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),sq(t)||vq.type(e,t,n,o,i)}r(o)},integer:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&(vq.type(e,t,n,o,i),vq.range(e,t,n,o,i))}r(o)},float:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&(vq.type(e,t,n,o,i),vq.range(e,t,n,o,i))}r(o)},array:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(null==t&&!e.required)return r();vq.required(e,t,n,o,i,"array"),null!=t&&(vq.type(e,t,n,o,i),vq.range(e,t,n,o,i))}r(o)},object:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&vq.type(e,t,n,o,i)}r(o)},enum:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i),void 0!==t&&vq.enum(e,t,n,o,i)}r(o)},pattern:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t,"string")&&!e.required)return r();vq.required(e,t,n,o,i),sq(t,"string")||vq.pattern(e,t,n,o,i)}r(o)},date:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t,"date")&&!e.required)return r();var a;if(vq.required(e,t,n,o,i),!sq(t,"date"))a=t instanceof Date?t:new Date(t),vq.type(e,a,n,o,i),a&&vq.range(e,a.getTime(),n,o,i)}r(o)},url:yq,hex:yq,email:yq,required:function(e,t,r,n,i){var o=[],a=Array.isArray(t)?"array":typeof t;vq.required(e,t,n,o,i,a),r(o)},any:function(e,t,r,n,i){var o=[];if(e.required||!e.required&&n.hasOwnProperty(e.field)){if(sq(t)&&!e.required)return r();vq.required(e,t,n,o,i)}r(o)}};function _q(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var wq=_q();function Cq(e){this.rules=null,this._messages=wq,this.define(e)}function Eq(e,t){for(var r=e,n=0;n<t.length;n+=1){if(null==r)return;r=r[t[n]]}return r}function Sq(e,t,r,n){if(!t.length)return r;var i,o=function(e){return uK(e)||_K(e)||fK(e)||hK()}(t),a=o[0],s=o.slice(1);return i=e||"number"!=typeof a?Array.isArray(e)?wK(e):mK({},e):[],n&&void 0===r&&1===s.length?delete i[a][s[0]]:i[a]=Sq(i[a],s,r,n),i}function kq(e){return WK(e)}function xq(e,t){return Eq(e,t)}function Oq(e,t,r){var n=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.length&&n&&void 0===r&&!Eq(e,t.slice(0,-1))?e:Sq(e,t,r,n)}(e,t,r,arguments.length>3&&void 0!==arguments[3]&&arguments[3]);return n}function Iq(e,t){var r={};return t.forEach((function(t){var n=xq(e,t);r=Oq(r,t,n)})),r}function Rq(e,t){return e&&e.some((function(e){return Nq(e,t)}))}function Tq(e){return"object"===sK(e)&&null!==e&&Object.getPrototypeOf(e)===Object.prototype}function Aq(e,t){var r=Array.isArray(e)?wK(e):mK({},e);return t&&Object.keys(t).forEach((function(e){var n=r[e],i=t[e],o=Tq(n)&&Tq(i);r[e]=o?Aq(n,i||{}):i})),r}function Mq(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((function(e,t){return Aq(e,t)}),e)}function Nq(e,t){return!(!e||!t||e.length!==t.length)&&e.every((function(e,r){return t[r]===e}))}function Dq(e){var t=arguments.length<=1?void 0:arguments[1];return t&&t.target&&e in t.target?t.target[e]:t}function Pq(e,t,r){var n=e.length;if(t<0||t>=n||r<0||r>=n)return e;var i=e[t],o=t-r;return o>0?[].concat(wK(e.slice(0,r)),[i],wK(e.slice(r,t)),wK(e.slice(t+1,n))):o<0?[].concat(wK(e.slice(0,t)),wK(e.slice(t+1,r+1)),[i],wK(e.slice(r+1,n))):e}Cq.prototype={messages:function(e){return e&&(this._messages=fq(_q(),e)),this._messages},define:function(e){if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");var t,r;for(t in this.rules={},e)e.hasOwnProperty(t)&&(r=e[t],this.rules[t]=Array.isArray(r)?r:[r])},validate:function(e,t,r){var n=this;void 0===t&&(t={}),void 0===r&&(r=function(){});var i=e,o=t,a=r;if("function"==typeof o&&(a=o,o={}),!this.rules||0===Object.keys(this.rules).length)return a&&a(),Promise.resolve();if(o.messages){var s=this.messages();s===wq&&(s=_q()),fq(s,o.messages),o.messages=s}else o.messages=this.messages();var l,c,u={};(o.keys||Object.keys(this.rules)).forEach((function(t){l=n.rules[t],c=i[t],l.forEach((function(r){var o=r;"function"==typeof o.transform&&(i===e&&(i=ZK({},i)),c=i[t]=o.transform(c)),(o="function"==typeof o?{validator:o}:ZK({},o)).validator=n.getValidationMethod(o),o.field=t,o.fullField=o.fullField||t,o.type=n.getType(o),o.validator&&(u[t]=u[t]||[],u[t].push({rule:o,value:c,source:i,field:t}))}))}));var d={};return uq(u,o,(function(e,t){var r,n=e.rule,i=!("object"!==n.type&&"array"!==n.type||"object"!=typeof n.fields&&"object"!=typeof n.defaultField);function a(e,t){return ZK({},t,{fullField:n.fullField+"."+e})}function s(r){void 0===r&&(r=[]);var s=r;if(Array.isArray(s)||(s=[s]),!o.suppressWarning&&s.length&&Cq.warning("async-validator:",s),s.length&&void 0!==n.message&&(s=[].concat(n.message)),s=s.map(dq(n)),o.first&&s.length)return d[n.field]=1,t(s);if(i){if(n.required&&!e.value)return void 0!==n.message?s=[].concat(n.message).map(dq(n)):o.error&&(s=[o.error(n,aq(o.messages.required,n.field))]),t(s);var l={};if(n.defaultField)for(var c in e.value)e.value.hasOwnProperty(c)&&(l[c]=n.defaultField);for(var u in l=ZK({},l,e.rule.fields))if(l.hasOwnProperty(u)){var f=Array.isArray(l[u])?l[u]:[l[u]];l[u]=f.map(a.bind(null,u))}var h=new Cq(l);h.messages(o.messages),e.rule.options&&(e.rule.options.messages=o.messages,e.rule.options.error=o.error),h.validate(e.value,e.rule.options||o,(function(e){var r=[];s&&s.length&&r.push.apply(r,s),e&&e.length&&r.push.apply(r,e),t(r.length?r:null)}))}else t(s)}i=i&&(n.required||!n.required&&e.value),n.field=e.field,n.asyncValidator?r=n.asyncValidator(n,e.value,s,e.source,o):n.validator&&(!0===(r=n.validator(n,e.value,s,e.source,o))?s():!1===r?s(n.message||n.field+" fails"):r instanceof Array?s(r):r instanceof Error&&s(r.message)),r&&r.then&&r.then((function(){return s()}),(function(e){return s(e)}))}),(function(e){!function(e){var t,r,n,i=[],o={};for(t=0;t<e.length;t++)r=e[t],n=void 0,Array.isArray(r)?i=(n=i).concat.apply(n,r):i.push(r);i.length?o=oq(i):(i=null,o=null),a(i,o)}(e)}))},getType:function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!bq.hasOwnProperty(e.type))throw new Error(aq("Unknown rule type %s",e.type));return e.type||"string"},getValidationMethod:function(e){if("function"==typeof e.validator)return e.validator;var t=Object.keys(e),r=t.indexOf("message");return-1!==r&&t.splice(r,1),1===t.length&&"required"===t[0]?bq.required:bq[this.getType(e)]||!1}},Cq.register=function(e,t){if("function"!=typeof t)throw new Error("Cannot register a validator by type, validator is not a function");bq[e]=t},Cq.warning=iq,Cq.messages=wq,Cq.validators=bq;var jq="'${name}' is not a valid ${type}",Fq={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:jq,method:jq,array:jq,object:jq,number:jq,date:jq,boolean:jq,integer:jq,float:jq,regexp:jq,email:jq,url:jq,hex:jq},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},Vq=Cq;function Lq(e,t,r,n){var i=mK(mK({},r),{},{name:t,enum:(r.enum||[]).join(", ")});return function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(o){var a=t[o];"string"==typeof a?r[o]=function(e,t){return function(){return function(e,t){return e.replace(/\$\{\w+\}/g,(function(e){var r=e.slice(2,-1);return t[r]}))}(e,mK(mK({},i),t))}}(a,n):a&&"object"===sK(a)?(r[o]={},e(a,r[o])):r[o]=a})),r}(Mq({},Fq,e))}function $q(e,t,r,n,i){return Bq.apply(this,arguments)}function Bq(){return Bq=XK(YK.mark((function e(t,r,n,i,o){var s,l,c,u,d,f;return YK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=mK({},n),l=null,s&&"array"===s.type&&s.defaultField&&(l=s.defaultField,delete s.defaultField),c=new Vq(cK({},t,[s])),u=Lq(i.validateMessages,t,s,o),c.messages(u),d=[],e.prev=7,e.next=10,Promise.resolve(c.validate(cK({},t,r),mK({},i)));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),e.t0.errors?d=e.t0.errors.map((function(e,t){var r=e.message;return a.isValidElement(r)?a.cloneElement(r,{key:"error_".concat(t)}):r})):(console.error(e.t0),d=[u.default()]);case 15:if(d.length||!l){e.next=20;break}return e.next=18,Promise.all(r.map((function(e,r){return $q("".concat(t,".").concat(r),e,l,i,o)})));case 18:return f=e.sent,e.abrupt("return",f.reduce((function(e,t){return[].concat(wK(e),wK(t))}),[]));case 20:return e.abrupt("return",d);case 21:case"end":return e.stop()}}),e,null,[[7,12]])}))),Bq.apply(this,arguments)}function Uq(e,t,r,n,i,o){var a,s=e.join("."),l=r.map((function(e){var t=e.validator;return t?mK(mK({},e),{},{validator:function(e,r,n){var i=!1,o=t(e,r,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Promise.resolve().then((function(){BK(!i,"Your validator function has already return a promise. `callback` will be ignored."),i||n.apply(void 0,t)}))}));BK(i=o&&"function"==typeof o.then&&"function"==typeof o.catch,"`callback` is deprecated. Please return a promise instead."),i&&o.then((function(){n()})).catch((function(e){n(e||" ")}))}}):e}));if(!0===i)a=new Promise(function(){var e=XK(YK.mark((function e(r,i){var a,c;return YK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0;case 1:if(!(a<l.length)){e.next=11;break}return e.next=4,$q(s,t,l[a],n,o);case 4:if(!(c=e.sent).length){e.next=8;break}return i(c),e.abrupt("return");case 8:a+=1,e.next=1;break;case 11:r([]);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());else{var c=l.map((function(e){return $q(s,t,e,n,o)}));a=(i?function(e){return Hq.apply(this,arguments)}(c):function(e){return zq.apply(this,arguments)}(c)).then((function(e){return e.length?Promise.reject(e):[]}))}return a.catch((function(e){return e})),a}function zq(){return zq=XK(YK.mark((function e(t){return YK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t).then((function(e){var t;return(t=[]).concat.apply(t,wK(e))})));case 1:case"end":return e.stop()}}),e)}))),zq.apply(this,arguments)}function Hq(){return Hq=XK(YK.mark((function e(t){var r;return YK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,e.abrupt("return",new Promise((function(e){t.forEach((function(n){n.then((function(n){n.length&&e(n),(r+=1)===t.length&&e([])}))}))})));case 2:case"end":return e.stop()}}),e)}))),Hq.apply(this,arguments)}function Wq(e,t,r,n,i,o){return"function"==typeof e?e(t,r,"source"in o?{source:o.source}:{}):n!==i}var Gq=function(e){OK(r,e);var t=RK(r);function r(e){var n;(CK(this,r),(n=t.call(this,e)).state={resetCount:0},n.cancelRegisterFunc=null,n.mounted=!1,n.touched=!1,n.dirty=!1,n.validatePromise=null,n.errors=[],n.cancelRegister=function(){var e=n.props,t=e.preserve,r=e.isListField,i=e.name;n.cancelRegisterFunc&&n.cancelRegisterFunc(r,t,kq(i)),n.cancelRegisterFunc=null},n.getNamePath=function(){var e=n.props,t=e.name,r=e.fieldContext.prefixName;return void 0!==t?[].concat(wK(void 0===r?[]:r),wK(t)):[]},n.getRules=function(){var e=n.props,t=e.rules,r=void 0===t?[]:t,i=e.fieldContext;return r.map((function(e){return"function"==typeof e?e(i):e}))},n.refresh=function(){!n.mounted||n.setState((function(e){return{resetCount:e.resetCount+1}}))},n.onStoreChange=function(e,t,r){var i=n.props,o=i.shouldUpdate,a=i.dependencies,s=void 0===a?[]:a,l=i.onReset,c=r.store,u=n.getNamePath(),d=n.getValue(e),f=n.getValue(c),h=t&&Rq(t,u);switch("valueUpdate"===r.type&&"external"===r.source&&d!==f&&(n.touched=!0,n.dirty=!0,n.validatePromise=null,n.errors=[]),r.type){case"reset":if(!t||h)return n.touched=!1,n.dirty=!1,n.validatePromise=null,n.errors=[],l&&l(),void n.refresh();break;case"setField":if(h){var p=r.data;return"touched"in p&&(n.touched=p.touched),"validating"in p&&!("originRCField"in p)&&(n.validatePromise=p.validating?Promise.resolve([]):null),"errors"in p&&(n.errors=p.errors||[]),n.dirty=!0,void n.reRender()}if(o&&!u.length&&Wq(o,e,c,d,f,r))return void n.reRender();break;case"dependenciesUpdate":if(s.map(kq).some((function(e){return Rq(r.relatedFields,e)})))return void n.reRender();break;default:if(h||(!s.length||u.length||o)&&Wq(o,e,c,d,f,r))return void n.reRender()}!0===o&&n.reRender()},n.validateRules=function(e){var t=n.getNamePath(),r=n.getValue(),i=Promise.resolve().then((function(){if(!n.mounted)return[];var o=n.props,a=o.validateFirst,s=void 0!==a&&a,l=o.messageVariables,c=(e||{}).triggerName,u=n.getRules();c&&(u=u.filter((function(e){var t=e.validateTrigger;return!t||WK(t).includes(c)})));var d=Uq(t,r,u,e,s,l);return d.catch((function(e){return e})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.validatePromise===i&&(n.validatePromise=null,n.errors=e,n.reRender())})),d}));return n.validatePromise=i,n.dirty=!0,n.errors=[],n.reRender(),i},n.isFieldValidating=function(){return!!n.validatePromise},n.isFieldTouched=function(){return n.touched},n.isFieldDirty=function(){return n.dirty},n.getErrors=function(){return n.errors},n.isListField=function(){return n.props.isListField},n.isList=function(){return n.props.isList},n.isPreserve=function(){return n.props.preserve},n.getMeta=function(){return n.prevValidating=n.isFieldValidating(),{touched:n.isFieldTouched(),validating:n.prevValidating,errors:n.errors,name:n.getNamePath()}},n.getOnlyChild=function(e){if("function"==typeof e){var t=n.getMeta();return mK(mK({},n.getOnlyChild(e(n.getControlled(),t,n.props.fieldContext))),{},{isFunction:!0})}var r=PK(e);return 1===r.length&&a.isValidElement(r[0])?{child:r[0],isFunction:!1}:{child:r,isFunction:!1}},n.getValue=function(e){var t=n.props.fieldContext.getFieldsValue,r=n.getNamePath();return xq(e||t(!0),r)},n.getControlled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.props,r=t.trigger,i=t.validateTrigger,o=t.getValueFromEvent,a=t.normalize,s=t.valuePropName,l=t.getValueProps,c=t.fieldContext,u=void 0!==i?i:c.validateTrigger,d=n.getNamePath(),f=c.getInternalHooks,h=c.getFieldsValue,p=f(UK).dispatch,g=n.getValue(),m=l||function(e){return cK({},s,e)},v=e[r],y=mK(mK({},e),m(g));return y[r]=function(){n.touched=!0,n.dirty=!0;for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e=o?o.apply(void 0,r):Dq.apply(void 0,[s].concat(r)),a&&(e=a(e,g,h(!0))),p({type:"updateValue",namePath:d,value:e}),v&&v.apply(void 0,r)},WK(u||[]).forEach((function(e){var t=y[e];y[e]=function(){t&&t.apply(void 0,arguments);var r=n.props.rules;r&&r.length&&p({type:"validateField",namePath:d,triggerName:e})}})),y},e.fieldContext)&&(0,(0,e.fieldContext.getInternalHooks)(UK).initEntityValue)(kK(n));return n}return SK(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.shouldUpdate,r=e.fieldContext;if(this.mounted=!0,r){var n=(0,r.getInternalHooks)(UK).registerField;this.cancelRegisterFunc=n(this)}!0===t&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.mounted=!1}},{key:"reRender",value:function(){!this.mounted||this.forceUpdate()}},{key:"render",value:function(){var e,t=this.state.resetCount,r=this.props.children,n=this.getOnlyChild(r),i=n.child;return n.isFunction?e=i:a.isValidElement(i)?e=a.cloneElement(i,this.getControlled(i.props)):(BK(!i,"`children` of Field is not validate ReactElement."),e=i),a.createElement(a.Fragment,{key:t},e)}}]),r}(a.Component);function Kq(e){var t=e.name,r=bK(e,["name"]),n=a.useContext(HK),i=void 0!==t?kq(t):void 0,o="keep";return r.isListField||(o="_".concat((i||[]).join("_"))),"production"!==Ni.exports.env.NODE_ENV&&!1===r.preserve&&r.isListField&&i.length<=1&&BK(!1,"`preserve` should not apply on Form.List fields."),a.createElement(Gq,aK({key:o,name:i},r,{fieldContext:n}))}Gq.contextType=HK,Gq.defaultProps={trigger:"onChange",valuePropName:"value"};var qq="__@field_split__";function Yq(e){return e.map((function(e){return"".concat(sK(e),":").concat(e)})).join(qq)}var Jq=function(){function e(){CK(this,e),this.kvs=new Map}return SK(e,[{key:"set",value:function(e,t){this.kvs.set(Yq(e),t)}},{key:"get",value:function(e){return this.kvs.get(Yq(e))}},{key:"update",value:function(e,t){var r=t(this.get(e));r?this.set(e,r):this.delete(e)}},{key:"delete",value:function(e){this.kvs.delete(Yq(e))}},{key:"map",value:function(e){return wK(this.kvs.entries()).map((function(t){var r=pK(t,2),n=r[0],i=r[1],o=n.split(qq);return e({key:o.map((function(e){var t=pK(e.match(/^([^:]*):(.*)$/),3),r=t[1],n=t[2];return"number"===r?Number(n):n})),value:i})}))}},{key:"toJSON",value:function(){var e={};return this.map((function(t){var r=t.key,n=t.value;return e[r.join(".")]=n,null})),e}}]),e}(),Xq=function e(t){var r=this;CK(this,e),this.formHooked=!1,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:r.getFieldValue,getFieldsValue:r.getFieldsValue,getFieldError:r.getFieldError,getFieldsError:r.getFieldsError,isFieldsTouched:r.isFieldsTouched,isFieldTouched:r.isFieldTouched,isFieldValidating:r.isFieldValidating,isFieldsValidating:r.isFieldsValidating,resetFields:r.resetFields,setFields:r.setFields,setFieldsValue:r.setFieldsValue,validateFields:r.validateFields,submit:r.submit,getInternalHooks:r.getInternalHooks}},this.getInternalHooks=function(e){return e===UK?(r.formHooked=!0,{dispatch:r.dispatch,initEntityValue:r.initEntityValue,registerField:r.registerField,useSubscribe:r.useSubscribe,setInitialValues:r.setInitialValues,setCallbacks:r.setCallbacks,setValidateMessages:r.setValidateMessages,getFields:r.getFields,setPreserve:r.setPreserve}):(BK(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(e){r.subscribable=e},this.setInitialValues=function(e,t){r.initialValues=e||{},t&&(r.store=Mq({},e,r.store))},this.getInitialValue=function(e){return xq(r.initialValues,e)},this.setCallbacks=function(e){r.callbacks=e},this.setValidateMessages=function(e){r.validateMessages=e},this.setPreserve=function(e){r.preserve=e},this.timeoutId=null,this.warningUnhooked=function(){"production"!==Ni.exports.env.NODE_ENV&&!r.timeoutId&&typeof window<"u"&&(r.timeoutId=setTimeout((function(){r.timeoutId=null,r.formHooked||BK(!1,"Instance created by `useForm` is not connected to any Form element. Forget to pass `form` prop?")})))},this.getFieldEntities=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?r.fieldEntities.filter((function(e){return e.getNamePath().length})):r.fieldEntities},this.getFieldsMap=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Jq;return r.getFieldEntities(e).forEach((function(e){var r=e.getNamePath();t.set(r,e)})),t},this.getFieldEntitiesForNamePathList=function(e){if(!e)return r.getFieldEntities(!0);var t=r.getFieldsMap(!0);return e.map((function(e){var r=kq(e);return t.get(r)||{INVALIDATE_NAME_PATH:kq(e)}}))},this.getFieldsValue=function(e,t){if(r.warningUnhooked(),!0===e&&!t)return r.store;var n=r.getFieldEntitiesForNamePathList(Array.isArray(e)?e:null),i=[];return n.forEach((function(r){var n,o="INVALIDATE_NAME_PATH"in r?r.INVALIDATE_NAME_PATH:r.getNamePath();if(e||!(null===(n=r.isListField)||void 0===n?void 0:n.call(r)))if(t){var a="getMeta"in r?r.getMeta():null;t(a)&&i.push(o)}else i.push(o)})),Iq(r.store,i.map(kq))},this.getFieldValue=function(e){r.warningUnhooked();var t=kq(e);return xq(r.store,t)},this.getFieldsError=function(e){return r.warningUnhooked(),r.getFieldEntitiesForNamePathList(e).map((function(t,r){return t&&!("INVALIDATE_NAME_PATH"in t)?{name:t.getNamePath(),errors:t.getErrors()}:{name:kq(e[r]),errors:[]}}))},this.getFieldError=function(e){r.warningUnhooked();var t=kq(e);return r.getFieldsError([t])[0].errors},this.isFieldsTouched=function(){r.warningUnhooked();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,o=t[0],a=t[1],s=!1;0===t.length?i=null:1===t.length?Array.isArray(o)?(i=o.map(kq),s=!1):(i=null,s=o):(i=o.map(kq),s=a);var l=r.getFieldEntities(!0),c=function(e){return e.isFieldTouched()};if(!i)return s?l.every(c):l.some(c);var u=new Jq;i.forEach((function(e){u.set(e,[])})),l.forEach((function(e){var t=e.getNamePath();i.forEach((function(r){r.every((function(e,r){return t[r]===e}))&&u.update(r,(function(t){return[].concat(wK(t),[e])}))}))}));var d=function(e){return e.some(c)},f=u.map((function(e){return e.value}));return s?f.every(d):f.some(d)},this.isFieldTouched=function(e){return r.warningUnhooked(),r.isFieldsTouched([e])},this.isFieldsValidating=function(e){r.warningUnhooked();var t=r.getFieldEntities();if(!e)return t.some((function(e){return e.isFieldValidating()}));var n=e.map(kq);return t.some((function(e){var t=e.getNamePath();return Rq(n,t)&&e.isFieldValidating()}))},this.isFieldValidating=function(e){return r.warningUnhooked(),r.isFieldsValidating([e])},this.resetWithFieldInitialValue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Jq,n=r.getFieldEntities(!0);n.forEach((function(e){var r=e.props.initialValue,n=e.getNamePath();if(void 0!==r){var i=t.get(n)||new Set;i.add({entity:e,value:r}),t.set(n,i)}}));var i;e.entities?i=e.entities:e.namePathList?(i=[],e.namePathList.forEach((function(e){var r,n=t.get(e);n&&(r=i).push.apply(r,wK(wK(n).map((function(e){return e.entity}))))}))):i=n,i.forEach((function(n){if(void 0!==n.props.initialValue){var i=n.getNamePath();if(void 0!==r.getInitialValue(i))BK(!1,"Form already set 'initialValues' with path '".concat(i.join("."),"'. Field can not overwrite it."));else{var o=t.get(i);if(o&&o.size>1)BK(!1,"Multiple Field with path '".concat(i.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(o){var a=r.getFieldValue(i);(!e.skipExist||void 0===a)&&(r.store=Oq(r.store,i,wK(o)[0].value))}}}}))},this.resetFields=function(e){r.warningUnhooked();var t=r.store;if(!e)return r.store=Mq({},r.initialValues),r.resetWithFieldInitialValue(),void r.notifyObservers(t,null,{type:"reset"});var n=e.map(kq);n.forEach((function(e){var t=r.getInitialValue(e);r.store=Oq(r.store,e,t)})),r.resetWithFieldInitialValue({namePathList:n}),r.notifyObservers(t,n,{type:"reset"})},this.setFields=function(e){r.warningUnhooked();var t=r.store;e.forEach((function(e){var n=e.name;e.errors;var i=bK(e,["name","errors"]),o=kq(n);"value"in i&&(r.store=Oq(r.store,o,i.value)),r.notifyObservers(t,[o],{type:"setField",data:e})}))},this.getFields=function(){return r.getFieldEntities(!0).map((function(e){var t=e.getNamePath(),n=mK(mK({},e.getMeta()),{},{name:t,value:r.getFieldValue(t)});return Object.defineProperty(n,"originRCField",{value:!0}),n}))},this.initEntityValue=function(e){var t=e.props.initialValue;if(void 0!==t){var n=e.getNamePath();void 0===xq(r.store,n)&&(r.store=Oq(r.store,n,t))}},this.registerField=function(e){if(r.fieldEntities.push(e),void 0!==e.props.initialValue){var t=r.store;r.resetWithFieldInitialValue({entities:[e],skipExist:!0}),r.notifyObservers(t,[e.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(r.fieldEntities=r.fieldEntities.filter((function(t){return t!==e})),!1===(void 0!==n?n:r.preserve)&&(!t||i.length>1)){var o=e.getNamePath(),a=t?void 0:xq(r.initialValues,o);o.length&&r.getFieldValue(o)!==a&&r.fieldEntities.every((function(e){return!Nq(e.getNamePath(),o)}))&&(r.store=Oq(r.store,o,a,!0))}}},this.dispatch=function(e){switch(e.type){case"updateValue":var t=e.namePath,n=e.value;r.updateValue(t,n);break;case"validateField":var i=e.namePath,o=e.triggerName;r.validateFields([i],{triggerName:o})}},this.notifyObservers=function(e,t,n){if(r.subscribable){var i=mK(mK({},n),{},{store:r.getFieldsValue(!0)});r.getFieldEntities().forEach((function(r){(0,r.onStoreChange)(e,t,i)}))}else r.forceRootUpdate()},this.updateValue=function(e,t){var n=kq(e),i=r.store;r.store=Oq(r.store,n,t),r.notifyObservers(i,[n],{type:"valueUpdate",source:"internal"});var o=r.getDependencyChildrenFields(n);o.length&&r.validateFields(o),r.notifyObservers(i,o,{type:"dependenciesUpdate",relatedFields:[n].concat(wK(o))});var a=r.callbacks.onValuesChange;a&&a(Iq(r.store,[n]),r.getFieldsValue());r.triggerOnFieldsChange([n].concat(wK(o)))},this.setFieldsValue=function(e){r.warningUnhooked();var t=r.store;e&&(r.store=Mq(r.store,e)),r.notifyObservers(t,null,{type:"valueUpdate",source:"external"})},this.getDependencyChildrenFields=function(e){var t=new Set,n=[],i=new Jq;r.getFieldEntities().forEach((function(e){(e.props.dependencies||[]).forEach((function(t){var r=kq(t);i.update(r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Set;return t.add(e),t}))}))}));return function e(r){(i.get(r)||new Set).forEach((function(r){if(!t.has(r)){t.add(r);var i=r.getNamePath();r.isFieldDirty()&&i.length&&(n.push(i),e(i))}}))}(e),n},this.triggerOnFieldsChange=function(e,t){var n=r.callbacks.onFieldsChange;if(n){var i=r.getFields();if(t){var o=new Jq;t.forEach((function(e){var t=e.name,r=e.errors;o.set(t,r)})),i.forEach((function(e){e.errors=o.get(e.name)||e.errors}))}n(i.filter((function(t){var r=t.name;return Rq(e,r)})),i)}},this.validateFields=function(e,t){r.warningUnhooked();var n=!!e,i=n?e.map(kq):[],o=[];r.getFieldEntities(!0).forEach((function(a){if(n||i.push(a.getNamePath()),(null==t?void 0:t.recursive)&&n){var s=a.getNamePath();s.every((function(t,r){return e[r]===t||void 0===e[r]}))&&i.push(s)}if(a.props.rules&&a.props.rules.length){var l=a.getNamePath();if(!n||Rq(i,l)){var c=a.validateRules(mK({validateMessages:mK(mK({},Fq),r.validateMessages)},t));o.push(c.then((function(){return{name:l,errors:[]}})).catch((function(e){return Promise.reject({name:l,errors:e})})))}}}));var a=function(e){var t=!1,r=e.length,n=[];return e.length?new Promise((function(i,o){e.forEach((function(e,a){e.catch((function(e){return t=!0,e})).then((function(e){r-=1,n[a]=e,!(r>0)&&(t&&o(n),i(n))}))}))})):Promise.resolve([])}(o);r.lastValidatePromise=a,a.catch((function(e){return e})).then((function(e){var t=e.map((function(e){return e.name}));r.notifyObservers(r.store,t,{type:"validateFinish"}),r.triggerOnFieldsChange(t,e)}));var s=a.then((function(){return r.lastValidatePromise===a?Promise.resolve(r.getFieldsValue(i)):Promise.reject([])})).catch((function(e){var t=e.filter((function(e){return e&&e.errors.length}));return Promise.reject({values:r.getFieldsValue(i),errorFields:t,outOfDate:r.lastValidatePromise!==a})}));return s.catch((function(e){return e})),s},this.submit=function(){r.warningUnhooked(),r.validateFields().then((function(e){var t=r.callbacks.onFinish;if(t)try{t(e)}catch(e){console.error(e)}})).catch((function(e){var t=r.callbacks.onFinishFailed;t&&t(e)}))},this.forceRootUpdate=t};function Zq(e){var t=a.useRef(),r=pK(a.useState({}),2)[1];if(!t.current)if(e)t.current=e;else{var n=new Xq((function(){r({})}));t.current=n.getForm()}return[t.current]}var Qq=a.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),eY=function(e,t){var r=e.name,n=e.initialValues,i=e.fields,o=e.form,s=e.preserve,l=e.children,c=e.component,u=void 0===c?"form":c,d=e.validateMessages,f=e.validateTrigger,h=void 0===f?"onChange":f,p=e.onValuesChange,g=e.onFieldsChange,m=e.onFinish,v=e.onFinishFailed,y=bK(e,["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"]),b=a.useContext(Qq),_=pK(Zq(o),1)[0],w=_.getInternalHooks(UK),C=w.useSubscribe,E=w.setInitialValues,S=w.setCallbacks,k=w.setValidateMessages,x=w.setPreserve;a.useImperativeHandle(t,(function(){return _})),a.useEffect((function(){return b.registerForm(r,_),function(){b.unregisterForm(r)}}),[b,_,r]),k(mK(mK({},b.validateMessages),d)),S({onValuesChange:p,onFieldsChange:function(e){if(b.triggerFormChange(r,e),g){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];g.apply(void 0,[e].concat(n))}},onFinish:function(e){b.triggerFormFinish(r,e),m&&m(e)},onFinishFailed:v}),x(s);var O=a.useRef(null);E(n,!O.current),O.current||(O.current=!0);var I=l,R="function"==typeof l;R&&(I=l(_.getFieldsValue(!0),_));C(!R);var T=a.useRef();a.useEffect((function(){(function(e,t){if(e===t)return!0;if(!e&&t||e&&!t||!e||!t||"object"!==sK(e)||"object"!==sK(t))return!1;var r=Object.keys(e),n=Object.keys(t),i=new Set([].concat(wK(r),wK(n)));return wK(i).every((function(r){var n=e[r],i=t[r];return"function"==typeof n&&"function"==typeof i||n===i}))})(T.current||[],i||[])||_.setFields(i||[]),T.current=i}),[i,_]);var A=a.useMemo((function(){return mK(mK({},_),{},{validateTrigger:h})}),[_,h]),M=a.createElement(HK.Provider,{value:A},I);return!1===u?M:a.createElement(u,aK({},y,{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),_.submit()},onReset:function(e){var t;e.preventDefault(),_.resetFields(),null===(t=y.onReset)||void 0===t||t.call(y,e)}}),M)},tY=a.forwardRef(eY);function rY(e,t,r){var n=a.useRef({});return(!("value"in n.current)||r(n.current.condition,t))&&(n.current.value=e(),n.current.condition=t),n.current.value}tY.FormProvider=function(e){var t=e.validateMessages,r=e.onFormChange,n=e.onFormFinish,i=e.children,o=a.useContext(Qq),s=a.useRef({});return a.createElement(Qq.Provider,{value:mK(mK({},o),{},{validateMessages:mK(mK({},o.validateMessages),t),triggerFormChange:function(e,t){r&&r(e,{changedFields:t,forms:s.current}),o.triggerFormChange(e,t)},triggerFormFinish:function(e,t){n&&n(e,{values:t,forms:s.current}),o.triggerFormFinish(e,t)},registerForm:function(e,t){e&&(s.current=mK(mK({},s.current),{},cK({},e,t))),o.registerForm(e,t)},unregisterForm:function(e){var t=mK({},s.current);delete t[e],s.current=t,o.unregisterForm(e)}})},i)},tY.Field=Kq,tY.List=function(e){var t=e.name,r=e.initialValue,n=e.children,i=e.rules,o=e.validateTrigger,s=a.useContext(HK),l=a.useRef({keys:[],id:0}).current;if("function"!=typeof n)return BK(!1,"Form.List only accepts function as children."),null;var c=kq(s.prefixName)||[],u=[].concat(wK(c),wK(kq(t)));return a.createElement(HK.Provider,{value:mK(mK({},s),{},{prefixName:u})},a.createElement(Kq,{name:[],shouldUpdate:function(e,t,r){return"internal"!==r.source&&e!==t},rules:i,validateTrigger:o,initialValue:r,isList:!0},(function(e,t){var r=e.value,i=void 0===r?[]:r,o=e.onChange,a=s.getFieldValue,c=function(){return a(u||[])||[]},d={add:function(e,t){var r=c();t>=0&&t<=r.length?(l.keys=[].concat(wK(l.keys.slice(0,t)),[l.id],wK(l.keys.slice(t))),o([].concat(wK(r.slice(0,t)),[e],wK(r.slice(t))))):("production"!==Ni.exports.env.NODE_ENV&&(t<0||t>r.length)&&BK(!1,"The second parameter of the add function should be a valid positive number."),l.keys=[].concat(wK(l.keys),[l.id]),o([].concat(wK(r),[e]))),l.id+=1},remove:function(e){var t=c(),r=new Set(Array.isArray(e)?e:[e]);r.size<=0||(l.keys=l.keys.filter((function(e,t){return!r.has(t)})),o(t.filter((function(e,t){return!r.has(t)}))))},move:function(e,t){if(e!==t){var r=c();e<0||e>=r.length||t<0||t>=r.length||(l.keys=Pq(l.keys,e,t),o(Pq(r,e,t)))}}},f=i||[];return Array.isArray(f)||(f=[],"production"!==Ni.exports.env.NODE_ENV&&BK(!1,"Current value of '".concat(u.join(" > "),"' is not an array type."))),n(f.map((function(e,t){var r=l.keys[t];return void 0===r&&(l.keys[t]=l.id,r=l.keys[t],l.id+=1),{name:t,key:r,isListField:!0}})),d,t)})))},tY.useForm=Zq;const nY=function(e,t,r){BK(e,"[antd: ".concat(t,"] ").concat(r))};const iY={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};const oY={lang:aK({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"}),timePickerLocale:aK({},iY)};var aY="${label} is not a valid ${type}";const sY={locale:"en",Pagination:{items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},DatePicker:oY,TimePicker:iY,Calendar:oY,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:aY,method:aY,array:aY,object:aY,number:aY,date:aY,boolean:aY,integer:aY,float:aY,regexp:aY,email:aY,url:aY,hex:aY},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"}};const lY=Object(a.createContext)(void 0);var cY=function(e){OK(r,e);var t=RK(r);function r(){return CK(this,r),t.apply(this,arguments)}return SK(r,[{key:"getLocale",value:function(){var e=this.props,t=e.componentName,r=e.defaultLocale||sY[t||"global"],n=this.context,i=t&&n?n[t]:{};return aK(aK({},"function"==typeof r?r():r),i||{})}},{key:"getLocaleCode",value:function(){var e=this.context,t=e&&e.locale;return e&&e.exist&&!t?sY.locale:t}},{key:"render",value:function(){return this.props.children(this.getLocale(),this.getLocaleCode(),this.context)}}]),r}(a.Component);cY.defaultProps={componentName:"global"},cY.contextType=lY;const uY=function(){var e=(0,a.useContext(yY).getPrefixCls)("empty-img-default");return a.createElement("svg",{className:e,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{fill:"none",fillRule:"evenodd"},a.createElement("g",{transform:"translate(24 31.67)"},a.createElement("ellipse",{className:"".concat(e,"-ellipse"),cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),a.createElement("path",{className:"".concat(e,"-path-1"),d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"}),a.createElement("path",{className:"".concat(e,"-path-2"),d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",transform:"translate(13.56)"}),a.createElement("path",{className:"".concat(e,"-path-3"),d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"}),a.createElement("path",{className:"".concat(e,"-path-4"),d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"})),a.createElement("path",{className:"".concat(e,"-path-5"),d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"}),a.createElement("g",{className:"".concat(e,"-g"),transform:"translate(149.65 15.383)"},a.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),a.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))};const dY=function(){var e=(0,a.useContext(yY).getPrefixCls)("empty-img-simple");return a.createElement("svg",{className:e,width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},a.createElement("ellipse",{className:"".concat(e,"-ellipse"),cx:"32",cy:"33",rx:"32",ry:"7"}),a.createElement("g",{className:"".concat(e,"-g"),fillRule:"nonzero"},a.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),a.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",className:"".concat(e,"-path")}))))};var fY=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},hY=a.createElement(uY,null),pY=a.createElement(dY,null),gY=function(e){var t=e.className,r=e.prefixCls,n=e.image,i=void 0===n?hY:n,o=e.description,s=e.children,l=e.imageStyle,c=fY(e,["className","prefixCls","image","description","children","imageStyle"]),u=a.useContext(yY),d=u.getPrefixCls,f=u.direction;return a.createElement(cY,{componentName:"Empty"},(function(e){var n,u=d("empty",r),h=typeof o<"u"?o:e.description,p="string"==typeof h?h:"empty",g=null;return g="string"==typeof i?a.createElement("img",{alt:p,src:i}):i,a.createElement("div",aK({className:qL(u,(n={},cK(n,"".concat(u,"-normal"),i===pY),cK(n,"".concat(u,"-rtl"),"rtl"===f),n),t)},c),a.createElement("div",{className:"".concat(u,"-image"),style:l},g),h&&a.createElement("div",{className:"".concat(u,"-description")},h),s&&a.createElement("div",{className:"".concat(u,"-footer")},s))}))};gY.PRESENTED_IMAGE_DEFAULT=hY,gY.PRESENTED_IMAGE_SIMPLE=pY;const mY=gY;const vY=function(e){return a.createElement(bY,null,(function(t){var r=(0,t.getPrefixCls)("empty");switch(e){case"Table":case"List":return a.createElement(mY,{image:mY.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return a.createElement(mY,{image:mY.PRESENTED_IMAGE_SIMPLE,className:"".concat(r,"-small")});default:return a.createElement(mY,null)}}))};var yY=a.createContext({getPrefixCls:function(e,t){return t||(e?"ant-".concat(e):"ant")},renderEmpty:vY}),bY=yY.Consumer;const _Y=a.createContext(void 0);function wY(e){return e instanceof HTMLElement||e instanceof SVGElement}function CY(e){return wY(e)?e:e instanceof s.a.Component?c.a.findDOMNode(e):null}function EY(e,t){"function"==typeof e?e(t):"object"===sK(e)&&e&&"current"in e&&(e.current=t)}function SY(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.filter((function(e){return e}));return n.length<=1?n[0]:function(e){t.forEach((function(t){EY(t,e)}))}}function kY(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return rY((function(){return SY.apply(void 0,t)}),t,(function(e,t){return e.length!==t.length||e.every((function(e,r){return e!==t[r]}))}))}function xY(e){var t,r,n=AK.exports.isMemo(e)?e.type.type:e.type;return!("function"==typeof n&&(null===(t=n.prototype)||void 0===t||!t.render)||"function"==typeof e&&(null===(r=e.prototype)||void 0===r||!r.render))}var OY=a.createContext({}),IY=function(e){OK(r,e);var t=RK(r);function r(){return CK(this,r),t.apply(this,arguments)}return SK(r,[{key:"render",value:function(){return this.props.children}}]),r}(a.Component);function RY(e){var t=a.useRef(!1),r=pK(a.useState(e),2),n=r[0],i=r[1];return a.useEffect((function(){return t.current=!1,function(){t.current=!0}}),[]),[n,function(e,r){r&&t.current||i(e)}]}var TY="none",AY="appear",MY="enter",NY="leave",DY="none",PY="prepare",jY="start",FY="active",VY="end",LY="prepared";function $Y(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function BY(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit".concat(e)]="webkit".concat(t),r["Moz".concat(e)]="moz".concat(t),r["ms".concat(e)]="MS".concat(t),r["O".concat(e)]="o".concat(t.toLowerCase()),r}var UY=function(e,t){var r={animationend:BY("Animation","AnimationEnd"),transitionend:BY("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete r.animationend.animation,"TransitionEvent"in t||delete r.transitionend.transition),r}($Y(),typeof window<"u"?window:{}),zY={};if($Y()){var HY=document.createElement("div");zY=HY.style}var WY={};function GY(e){if(WY[e])return WY[e];var t=UY[e];if(t)for(var r=Object.keys(t),n=r.length,i=0;i<n;i+=1){var o=r[i];if(Object.prototype.hasOwnProperty.call(t,o)&&o in zY)return WY[e]=t[o],WY[e]}return""}var KY=GY("animationend"),qY=GY("transitionend"),YY=!(!KY||!qY),JY=KY||"animationend",XY=qY||"transitionend";function ZY(e,t){if(!e)return null;if("object"===sK(e)){var r=t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}));return e[r]}return"".concat(e,"-").concat(t)}const QY=function(e){var t=Object(a.useRef)(),r=Object(a.useRef)(e);r.current=e;var n=a.useCallback((function(e){r.current(e)}),[]);function i(e){e&&(e.removeEventListener(XY,n),e.removeEventListener(JY,n))}return a.useEffect((function(){return function(){i(t.current)}}),[]),[function(e){t.current&&t.current!==e&&i(t.current),e&&e!==t.current&&(e.addEventListener(XY,n),e.addEventListener(JY,n),t.current=e)},i]};var eJ=$Y()?a.useLayoutEffect:a.useEffect,tJ=function(e){return+setTimeout(e,16)},rJ=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(tJ=function(e){return window.requestAnimationFrame(e)},rJ=function(e){return window.cancelAnimationFrame(e)});var nJ=0,iJ=new Map;function oJ(e){iJ.delete(e)}var aJ=function(e){var t=nJ+=1;return function r(n){if(0===n)oJ(t),e();else{var i=tJ((function(){r(n-1)}));iJ.set(t,i)}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),t};aJ.cancel=function(e){var t=iJ.get(e);return oJ(t),rJ(t)};var sJ=[PY,jY,FY,VY],lJ=[PY,LY],cJ=!1,uJ=!0;function dJ(e){return e===FY||e===VY}const fJ=function(e,t,r){var n=pK(RY(DY),2),i=n[0],o=n[1],s=function(){var e=a.useRef(null);function t(){aJ.cancel(e.current)}return a.useEffect((function(){return function(){t()}}),[]),[function r(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t();var o=aJ((function(){i<=1?n({isCanceled:function(){return o!==e.current}}):r(n,i-1)}));e.current=o},t]}(),l=pK(s,2),c=l[0],u=l[1];var d=t?lJ:sJ;return eJ((function(){if(i!==DY&&i!==VY){var e=d.indexOf(i),t=d[e+1],n=r(i);n===cJ?o(t,!0):t&&c((function(e){function r(){e.isCanceled()||o(t,!0)}!0===n?r():Promise.resolve(n).then(r)}))}}),[e,i]),a.useEffect((function(){return function(){u()}}),[]),[function(){o(PY,!0)},i]};const hJ=function(e){var t=e;"object"===sK(e)&&(t=e.transitionSupport);var r=a.forwardRef((function(e,r){var n=e.visible,i=void 0===n||n,o=e.removeOnLeave,s=void 0===o||o,l=e.forceRender,c=e.children,u=e.motionName,d=e.leavedClassName,f=e.eventProps,h=function(e,r){return!(!e.motionName||!t||!1===r)}(e,a.useContext(OY).motion),p=Object(a.useRef)(),g=Object(a.useRef)();var m=function(e,t,r,n){var i=n.motionEnter,o=void 0===i||i,s=n.motionAppear,l=void 0===s||s,c=n.motionLeave,u=void 0===c||c,d=n.motionDeadline,f=n.motionLeaveImmediately,h=n.onAppearPrepare,p=n.onEnterPrepare,g=n.onLeavePrepare,m=n.onAppearStart,v=n.onEnterStart,y=n.onLeaveStart,b=n.onAppearActive,_=n.onEnterActive,w=n.onLeaveActive,C=n.onAppearEnd,E=n.onEnterEnd,S=n.onLeaveEnd,k=n.onVisibleChanged,x=pK(RY(),2),O=x[0],I=x[1],R=pK(RY(TY),2),T=R[0],A=R[1],M=pK(RY(null),2),N=M[0],D=M[1],P=Object(a.useRef)(!1),j=Object(a.useRef)(null);function F(){return r()}var V=Object(a.useRef)(!1);function L(){A(TY,!0),D(null,!0)}function $(e){var t=F();if(!e||e.deadline||e.target===t){var r,n=V.current;T===AY&&n?r=null==C?void 0:C(t,e):T===MY&&n?r=null==E?void 0:E(t,e):T===NY&&n&&(r=null==S?void 0:S(t,e)),T!==TY&&n&&!1!==r&&L()}}var B=pK(QY($),1)[0],U=function(e){var t,r,n;switch(e){case AY:return cK(t={},PY,h),cK(t,jY,m),cK(t,FY,b),t;case MY:return cK(r={},PY,p),cK(r,jY,v),cK(r,FY,_),r;case NY:return cK(n={},PY,g),cK(n,jY,y),cK(n,FY,w),n;default:return{}}},z=a.useMemo((function(){return U(T)}),[T]),H=pK(fJ(T,!e,(function(e){if(e===PY){var t=z[PY];return t?t(F()):cJ}var r;return G in z&&D((null===(r=z[G])||void 0===r?void 0:r.call(z,F(),null))||null),G===FY&&(B(F()),d>0&&(clearTimeout(j.current),j.current=setTimeout((function(){$({deadline:!0})}),d))),G===LY&&L(),uJ})),2),W=H[0],G=H[1],K=dJ(G);V.current=K,eJ((function(){I(t);var r,n=P.current;P.current=!0,!n&&t&&l&&(r=AY),n&&t&&o&&(r=MY),(n&&!t&&u||!n&&f&&!t&&u)&&(r=NY);var i=U(r);r&&(e||i[PY])?(A(r),W()):A(TY)}),[t]),Object(a.useEffect)((function(){(T===AY&&!l||T===MY&&!o||T===NY&&!u)&&A(TY)}),[l,o,u]),Object(a.useEffect)((function(){return function(){P.current=!1,clearTimeout(j.current)}}),[]);var q=a.useRef(!1);Object(a.useEffect)((function(){O&&(q.current=!0),void 0!==O&&T===TY&&((q.current||O)&&(null==k||k(O)),q.current=!0)}),[O,T]);var Y=N;return z[PY]&&G===jY&&(Y=mK({transition:"none"},Y)),[T,G,Y,null!=O?O:t]}(h,i,(function(){try{return p.current instanceof HTMLElement?p.current:CY(g.current)}catch{return null}}),e),v=pK(m,4),y=v[0],b=v[1],_=v[2],w=v[3],C=a.useRef(w);w&&(C.current=!0);var E,S=a.useCallback((function(e){p.current=e,EY(r,e)}),[r]),k=mK(mK({},f),{},{visible:i});if(c)if(y===TY)E=w?c(mK({},k),S):!s&&C.current&&d?c(mK(mK({},k),{},{className:d}),S):l||!s&&!d?c(mK(mK({},k),{},{style:{display:"none"}}),S):null;else{var x,O;b===PY?O="prepare":dJ(b)?O="active":b===jY&&(O="start");var I=ZY(u,"".concat(y,"-").concat(O));E=c(mK(mK({},k),{},{className:qL(ZY(u,y),(x={},cK(x,I,I&&O),cK(x,u,"string"==typeof u),x)),style:_}),S)}else E=null;a.isValidElement(E)&&xY(E)&&(E.ref||(E=a.cloneElement(E,{ref:S})));return a.createElement(IY,{ref:g},E)}));return r.displayName="CSSMotion",r}(YY);var pJ="add",gJ="keep",mJ="remove",vJ="removed";function yJ(e){var t;return mK(mK({},t=e&&"object"===sK(e)&&"key"in e?e:{key:e}),{},{key:String(t.key)})}function bJ(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(yJ)}var _J=["component","children","onVisibleChanged","onAllRemoved"],wJ=["status"],CJ=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hJ,r=function(e){OK(n,e);var r=RK(n);function n(){var e;CK(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return cK(kK(e=r.call.apply(r,[this].concat(i))),"state",{keyEntities:[]}),cK(kK(e),"removeKey",(function(t){var r=e.state.keyEntities.map((function(e){return e.key!==t?e:mK(mK({},e),{},{status:vJ})}));return e.setState({keyEntities:r}),r.filter((function(e){return e.status!==vJ})).length})),e}return SK(n,[{key:"render",value:function(){var e=this,r=this.state.keyEntities,n=this.props,i=n.component,o=n.children,s=n.onVisibleChanged,l=n.onAllRemoved,c=bK(n,_J),u=i||a.Fragment,d={};return CJ.forEach((function(e){d[e]=c[e],delete c[e]})),delete c.keys,a.createElement(u,c,r.map((function(r,n){var i=r.status,c=bK(r,wJ),u=i===pJ||i===gJ;return a.createElement(t,aK({},d,{key:c.key,visible:u,eventProps:c,onVisibleChanged:function(t){(null==s||s(t,{key:c.key}),t)||0===e.removeKey(c.key)&&l&&l()}}),(function(e,t){return o(mK(mK({},e),{},{index:n}),t)}))})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.keys,n=t.keyEntities,i=bJ(r),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[],n=0,i=t.length,o=bJ(e),a=bJ(t);o.forEach((function(e){for(var t=!1,o=n;o<i;o+=1){var s=a[o];if(s.key===e.key){n<o&&(r=r.concat(a.slice(n,o).map((function(e){return mK(mK({},e),{},{status:pJ})}))),n=o),r.push(mK(mK({},s),{},{status:gJ})),n+=1,t=!0;break}}t||r.push(mK(mK({},e),{},{status:mJ}))})),n<i&&(r=r.concat(a.slice(n).map((function(e){return mK(mK({},e),{},{status:pJ})}))));var s={};return r.forEach((function(e){var t=e.key;s[t]=(s[t]||0)+1})),Object.keys(s).filter((function(e){return s[e]>1})).forEach((function(e){(r=r.filter((function(t){var r=t.key,n=t.status;return r!==e||n!==mJ}))).forEach((function(t){t.key===e&&(t.status=gJ)}))})),r}(n,i);return{keyEntities:o.filter((function(e){var t=n.find((function(t){var r=t.key;return e.key===r}));return!(t&&t.status===vJ&&e.status===mJ)}))}}}]),n}(a.Component);cK(r,"defaultProps",{component:"div"})}(YY);const EJ={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};function SJ(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function kJ(e){return e<=1?"".concat(100*Number(e),"%"):e}function xJ(e){return 1===e.length?"0"+e:String(e)}function OJ(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*r*(t-e):r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function IJ(e){return RJ(e)/255}function RJ(e){return parseInt(e,16)}var TJ={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function AJ(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,o=null,a=!1,s=!1;return"string"==typeof e&&(e=function(e){if(e=e.trim().toLowerCase(),0===e.length)return!1;var t=!1;if(TJ[e])e=TJ[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var r=PJ.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=PJ.rgba.exec(e),r?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=PJ.hsl.exec(e),r?{h:r[1],s:r[2],l:r[3]}:(r=PJ.hsla.exec(e),r?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=PJ.hsv.exec(e),r?{h:r[1],s:r[2],v:r[3]}:(r=PJ.hsva.exec(e),r?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=PJ.hex8.exec(e),r?{r:RJ(r[1]),g:RJ(r[2]),b:RJ(r[3]),a:IJ(r[4]),format:t?"name":"hex8"}:(r=PJ.hex6.exec(e),r?{r:RJ(r[1]),g:RJ(r[2]),b:RJ(r[3]),format:t?"name":"hex"}:(r=PJ.hex4.exec(e),r?{r:RJ(r[1]+r[1]),g:RJ(r[2]+r[2]),b:RJ(r[3]+r[3]),a:IJ(r[4]+r[4]),format:t?"name":"hex8"}:(r=PJ.hex3.exec(e),!!r&&{r:RJ(r[1]+r[1]),g:RJ(r[2]+r[2]),b:RJ(r[3]+r[3]),format:t?"name":"hex"})))))))))}(e)),"object"==typeof e&&(jJ(e.r)&&jJ(e.g)&&jJ(e.b)?(t=function(e,t,r){return{r:255*SJ(e,255),g:255*SJ(t,255),b:255*SJ(r,255)}}(e.r,e.g,e.b),a=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):jJ(e.h)&&jJ(e.s)&&jJ(e.v)?(n=kJ(e.s),i=kJ(e.v),t=function(e,t,r){e=6*SJ(e,360),t=SJ(t,100),r=SJ(r,100);var n=Math.floor(e),i=e-n,o=r*(1-t),a=r*(1-i*t),s=r*(1-(1-i)*t),l=n%6;return{r:255*[r,a,o,o,s,r][l],g:255*[s,r,r,a,o,o][l],b:255*[o,o,s,r,r,a][l]}}(e.h,n,i),a=!0,s="hsv"):jJ(e.h)&&jJ(e.s)&&jJ(e.l)&&(n=kJ(e.s),o=kJ(e.l),t=function(e,t,r){var n,i,o;if(e=SJ(e,360),t=SJ(t,100),r=SJ(r,100),0===t)i=r,o=r,n=r;else{var a=r<.5?r*(1+t):r+t-r*t,s=2*r-a;n=OJ(s,a,e+1/3),i=OJ(s,a,e),o=OJ(s,a,e-1/3)}return{r:255*n,g:255*i,b:255*o}}(e.h,n,o),a=!0,s="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(r),{ok:a,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}var MJ="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),NJ="[\\s|\\(]+(".concat(MJ,")[,|\\s]+(").concat(MJ,")[,|\\s]+(").concat(MJ,")\\s*\\)?"),DJ="[\\s|\\(]+(".concat(MJ,")[,|\\s]+(").concat(MJ,")[,|\\s]+(").concat(MJ,")[,|\\s]+(").concat(MJ,")\\s*\\)?"),PJ={CSS_UNIT:new RegExp(MJ),rgb:new RegExp("rgb"+NJ),rgba:new RegExp("rgba"+DJ),hsl:new RegExp("hsl"+NJ),hsla:new RegExp("hsla"+DJ),hsv:new RegExp("hsv"+NJ),hsva:new RegExp("hsva"+DJ),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function jJ(e){return Boolean(PJ.CSS_UNIT.exec(String(e)))}var FJ=2,VJ=.16,LJ=.05,$J=.05,BJ=.15,UJ=5,zJ=4,HJ=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function WJ(e){var t=function(e,t,r){e=SJ(e,255),t=SJ(t,255),r=SJ(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),o=0,a=n,s=n-i,l=0===n?0:s/n;if(n===i)o=0;else{switch(n){case e:o=(t-r)/s+(t<r?6:0);break;case t:o=(r-e)/s+2;break;case r:o=(e-t)/s+4}o/=6}return{h:o,s:l,v:a}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function GJ(e){var t=e.r,r=e.g,n=e.b;return"#".concat(function(e,t,r,n){var i=[xJ(Math.round(e).toString(16)),xJ(Math.round(t).toString(16)),xJ(Math.round(r).toString(16))];return n&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}(t,r,n,!1))}function KJ(e,t,r){var n;return(n=Math.round(e.h)>=60&&Math.round(e.h)<=240?r?Math.round(e.h)-FJ*t:Math.round(e.h)+FJ*t:r?Math.round(e.h)+FJ*t:Math.round(e.h)-FJ*t)<0?n+=360:n>=360&&(n-=360),n}function qJ(e,t,r){return 0===e.h&&0===e.s?e.s:((n=r?e.s-VJ*t:t===zJ?e.s+VJ:e.s+LJ*t)>1&&(n=1),r&&t===UJ&&n>.1&&(n=.1),n<.06&&(n=.06),Number(n.toFixed(2)));var n}function YJ(e,t,r){var n;return(n=r?e.v+$J*t:e.v-BJ*t)>1&&(n=1),Number(n.toFixed(2))}function JJ(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],n=AJ(e),i=UJ;i>0;i-=1){var o=WJ(n),a=GJ(AJ({h:KJ(o,i,!0),s:qJ(o,i,!0),v:YJ(o,i,!0)}));r.push(a)}r.push(GJ(n));for(var s=1;s<=zJ;s+=1){var l=WJ(n),c=GJ(AJ({h:KJ(l,s),s:qJ(l,s),v:YJ(l,s)}));r.push(c)}return"dark"===t.theme?HJ.map((function(e){var n=e.index,i=e.opacity,o=GJ(function(e,t,r){var n=r/100;return{r:(t.r-e.r)*n+e.r,g:(t.g-e.g)*n+e.g,b:(t.b-e.b)*n+e.b}}(AJ(t.backgroundColor||"#141414"),AJ(r[n]),100*i));return o})):r}var XJ={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},ZJ={},QJ={};function eX(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var r=t;r;){if(r===e)return!0;r=r.parentNode}return!1}Object.keys(XJ).forEach((function(e){ZJ[e]=JJ(XJ[e]),ZJ[e].primary=ZJ[e][5],QJ[e]=JJ(XJ[e],{theme:"dark",backgroundColor:"#141414"}),QJ[e].primary=QJ[e][5]}));var tX="data-rc-order",rX="data-rc-priority",nX="rc-util-key",iX=new Map;function oX(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):nX}function aX(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function sX(e){return Array.from((iX.get(e)||e).children).filter((function(e){return"STYLE"===e.tagName}))}function lX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!$Y())return null;var r=t.csp,n=t.prepend,i=t.priority,o=void 0===i?0:i,a=function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(n),s="prependQueue"===a,l=document.createElement("style");l.setAttribute(tX,a),s&&o&&l.setAttribute(rX,"".concat(o)),null!=r&&r.nonce&&(l.nonce=null==r?void 0:r.nonce),l.innerHTML=e;var c=aX(t),u=c.firstChild;if(n){if(s){var d=sX(c).filter((function(e){if(!["prepend","prependQueue"].includes(e.getAttribute(tX)))return!1;var t=Number(e.getAttribute(rX)||0);return o>=t}));if(d.length)return c.insertBefore(l,d[d.length-1].nextSibling),l}c.insertBefore(l,u)}else c.appendChild(l);return l}function cX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sX(aX(t)).find((function(r){return r.getAttribute(oX(t))===e}))}function uX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=cX(e,t);r&&aX(t).removeChild(r)}function dX(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){var r=iX.get(e);if(!r||!eX(document,r)){var n=lX("",t),i=n.parentNode;iX.set(e,i),e.removeChild(n)}}(aX(r),r);var n=cX(t,r);if(n){var i,o,a;if(null!==(i=r.csp)&&void 0!==i&&i.nonce&&n.nonce!==(null===(o=r.csp)||void 0===o?void 0:o.nonce))n.nonce=null===(a=r.csp)||void 0===a?void 0:a.nonce;return n.innerHTML!==e&&(n.innerHTML=e),n}var s=lX(e,r);return s.setAttribute(oX(r),t),s}var fX="object"==typeof Ri&&Ri&&Ri.Object===Object&&Ri,hX=fX,pX="object"==typeof self&&self&&self.Object===Object&&self,gX=hX||pX||Function("return this")(),mX=gX.Symbol;var vX=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},yX=Array.isArray,bX=mX,_X=Object.prototype,wX=_X.hasOwnProperty,CX=_X.toString,EX=bX?bX.toStringTag:void 0;var SX=function(e){var t=wX.call(e,EX),r=e[EX];try{e[EX]=void 0;var n=!0}catch{}var i=CX.call(e);return n&&(t?e[EX]=r:delete e[EX]),i},kX=Object.prototype.toString;var xX=function(e){return kX.call(e)},OX=SX,IX=xX,RX=mX?mX.toStringTag:void 0;var TX=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":RX&&RX in Object(e)?OX(e):IX(e)};var AX=function(e){return null!=e&&"object"==typeof e},MX=TX,NX=AX;var DX=function(e){return"symbol"==typeof e||NX(e)&&"[object Symbol]"==MX(e)},PX=vX,jX=yX,FX=DX,VX=mX?mX.prototype:void 0,LX=VX?VX.toString:void 0;var $X=function e(t){if("string"==typeof t)return t;if(jX(t))return PX(t,e)+"";if(FX(t))return LX?LX.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r},BX=$X;var UX=function(e){return null==e?"":BX(e)};var zX=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o},HX=zX;var WX=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:HX(e,t,r)},GX=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var KX=function(e){return GX.test(e)};var qX=function(e){return e.split("")},YX="\\ud800-\\udfff",JX="["+YX+"]",XX="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ZX="\\ud83c[\\udffb-\\udfff]",QX="[^"+YX+"]",eZ="(?:\\ud83c[\\udde6-\\uddff]){2}",tZ="[\\ud800-\\udbff][\\udc00-\\udfff]",rZ="(?:"+XX+"|"+ZX+")"+"?",nZ="[\\ufe0e\\ufe0f]?",iZ=nZ+rZ+("(?:\\u200d(?:"+[QX,eZ,tZ].join("|")+")"+nZ+rZ+")*"),oZ="(?:"+[QX+XX+"?",XX,eZ,tZ,JX].join("|")+")",aZ=RegExp(ZX+"(?="+ZX+")|"+oZ+iZ,"g");var sZ=function(e){return e.match(aZ)||[]},lZ=qX,cZ=KX,uZ=sZ;var dZ=function(e){return cZ(e)?uZ(e):lZ(e)},fZ=WX,hZ=KX,pZ=dZ,gZ=UX;var mZ=function(e){return function(t){t=gZ(t);var r=hZ(t)?pZ(t):void 0,n=r?r[0]:t.charAt(0),i=r?fZ(r,1).join(""):t.slice(1);return n[e]()+i}},vZ=mZ("toUpperCase"),yZ=UX,bZ=vZ;var _Z=function(e){return bZ(yZ(e).toLowerCase())};var wZ=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r};var CZ=function(e){return function(t){return null==e?void 0:e[t]}},EZ=CZ({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),SZ=UX,kZ=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xZ=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var OZ=function(e){return(e=SZ(e))&&e.replace(kZ,EZ).replace(xZ,"")},IZ=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var RZ=function(e){return e.match(IZ)||[]},TZ=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var AZ=function(e){return TZ.test(e)},MZ="\\ud800-\\udfff",NZ="\\u2700-\\u27bf",DZ="a-z\\xdf-\\xf6\\xf8-\\xff",PZ="A-Z\\xc0-\\xd6\\xd8-\\xde",jZ="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",FZ="["+jZ+"]",VZ="\\d+",LZ="["+NZ+"]",$Z="["+DZ+"]",BZ="[^"+MZ+jZ+VZ+NZ+DZ+PZ+"]",UZ="(?:\\ud83c[\\udde6-\\uddff]){2}",zZ="[\\ud800-\\udbff][\\udc00-\\udfff]",HZ="["+PZ+"]",WZ="(?:"+$Z+"|"+BZ+")",GZ="(?:"+HZ+"|"+BZ+")",KZ="(?:['’](?:d|ll|m|re|s|t|ve))?",qZ="(?:['’](?:D|LL|M|RE|S|T|VE))?",YZ="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",JZ="[\\ufe0e\\ufe0f]?",XZ=JZ+YZ+("(?:\\u200d(?:"+["[^"+MZ+"]",UZ,zZ].join("|")+")"+JZ+YZ+")*"),ZZ="(?:"+[LZ,UZ,zZ].join("|")+")"+XZ,QZ=RegExp([HZ+"?"+$Z+"+"+KZ+"(?="+[FZ,HZ,"$"].join("|")+")",GZ+"+"+qZ+"(?="+[FZ,HZ+WZ,"$"].join("|")+")",HZ+"?"+WZ+"+"+KZ,HZ+"+"+qZ,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",VZ,ZZ].join("|"),"g");var eQ=function(e){return e.match(QZ)||[]},tQ=RZ,rQ=AZ,nQ=UX,iQ=eQ;var oQ=function(e,t,r){return e=nQ(e),void 0===(t=r?void 0:t)?rQ(e)?iQ(e):tQ(e):e.match(t)||[]},aQ=wZ,sQ=OZ,lQ=oQ,cQ=RegExp("['’]","g");var uQ=function(e){return function(t){return aQ(lQ(sQ(t).replace(cQ,"")),e,"")}},dQ=_Z,fQ=uQ((function(e,t,r){return t=t.toLowerCase(),e+(r?dQ(t):t)})),hQ=fQ;function pQ(e){return"object"===sK(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===sK(e.icon)||"function"==typeof e.icon)}function gQ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,r){var n=e[r];if("class"===r)t.className=n,delete t.class;else delete t[r],t[hQ(r)]=n;return t}),{})}function mQ(e,t,r){return r?s.a.createElement(e.tag,mK(mK({key:t},gQ(e.attrs)),r),(e.children||[]).map((function(r,n){return mQ(r,"".concat(t,"-").concat(e.tag,"-").concat(n))}))):s.a.createElement(e.tag,mK({key:t},gQ(e.attrs)),(e.children||[]).map((function(r,n){return mQ(r,"".concat(t,"-").concat(e.tag,"-").concat(n))})))}function vQ(e){return JJ(e)[0]}function yQ(e){return e?Array.isArray(e)?e:[e]:[]}var bQ=["icon","className","onClick","style","primaryColor","secondaryColor"],_Q={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var wQ=function(e){var t=e.icon,r=e.className,n=e.onClick,i=e.style,o=e.primaryColor,s=e.secondaryColor,l=bK(e,bQ),c=_Q;if(o&&(c={primaryColor:o,secondaryColor:s||vQ(o)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",t=Object(a.useContext)(yK).csp;Object(a.useEffect)((function(){dX(e,"@ant-design-icons",{prepend:!0,csp:t})}),[])}(),function(e,t){BK(e,"[@ant-design/icons] ".concat(t))}(pQ(t),"icon should be icon definiton, but got ".concat(t)),!pQ(t))return null;var u=t;return u&&"function"==typeof u.icon&&(u=mK(mK({},u),{},{icon:u.icon(c.primaryColor,c.secondaryColor)})),mQ(u.icon,"svg-".concat(u.name),mK({className:r,onClick:n,style:i,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},l))};wQ.displayName="IconReact",wQ.getTwoToneColors=function(){return mK({},_Q)},wQ.setTwoToneColors=function(e){var t=e.primaryColor,r=e.secondaryColor;_Q.primaryColor=t,_Q.secondaryColor=r||vQ(t),_Q.calculated=!!r};const CQ=wQ;function EQ(e){var t=pK(yQ(e),2),r=t[0],n=t[1];return CQ.setTwoToneColors({primaryColor:r,secondaryColor:n})}var SQ=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];EQ("#1890ff");var kQ=a.forwardRef((function(e,t){var r,n=e.className,i=e.icon,o=e.spin,s=e.rotate,l=e.tabIndex,c=e.onClick,u=e.twoToneColor,d=bK(e,SQ),f=a.useContext(yK),h=f.prefixCls,p=void 0===h?"anticon":h,g=f.rootClassName,m=qL(g,p,(cK(r={},"".concat(p,"-").concat(i.name),!!i.name),cK(r,"".concat(p,"-spin"),!!o||"loading"===i.name),r),n),v=l;void 0===v&&c&&(v=-1);var y=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,b=pK(yQ(u),2),_=b[0],w=b[1];return a.createElement("span",mK(mK({role:"img","aria-label":i.name},d),{},{ref:t,tabIndex:v,onClick:c,className:m}),a.createElement(CQ,{icon:i,primaryColor:_,secondaryColor:w,style:y}))}));kQ.displayName="AntdIcon",kQ.getTwoToneColor=function(){var e=CQ.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},kQ.setTwoToneColor=EQ;const xQ=kQ;var OQ=function(e,t){return a.createElement(xQ,mK(mK({},e),{},{ref:t,icon:EJ}))};OQ.displayName="LoadingOutlined";const IQ=a.forwardRef(OQ);const RQ={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};var TQ=function(e,t){return a.createElement(xQ,mK(mK({},e),{},{ref:t,icon:RQ}))};TQ.displayName="CloseCircleFilled";const AQ=a.forwardRef(TQ);const MQ={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"};var NQ=function(e,t){return a.createElement(xQ,mK(mK({},e),{},{ref:t,icon:MQ}))};NQ.displayName="CloseOutlined";const DQ=a.forwardRef(NQ);var PQ=function e(t){return CK(this,e),new Error("unreachable case: ".concat(JSON.stringify(t)))},jQ=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const FQ=function(e){return a.createElement(bY,null,(function(t){var r,n=t.getPrefixCls,i=t.direction,o=e.prefixCls,s=e.size,l=e.className,c=jQ(e,["prefixCls","size","className"]),u=n("btn-group",o),d="";switch(s){case"large":d="lg";break;case"small":d="sm";break;case"middle":case void 0:break;default:console.warn(new PQ(s))}var f=qL(u,(cK(r={},"".concat(u,"-").concat(d),d),cK(r,"".concat(u,"-rtl"),"rtl"===i),r),l);return a.createElement("div",aK({},c,{className:f}))}))};var VQ=0,LQ={};function $Q(e){var t=VQ++,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return LQ[t]=aJ((function n(){(r-=1)<=0?(e(),delete LQ[t]):LQ[t]=aJ(n)})),t}$Q.cancel=function(e){void 0!==e&&(aJ.cancel(LQ[e]),delete LQ[e])},$Q.ids=LQ;var BQ,UQ=a.isValidElement;function zQ(e,t){return function(e,t,r){return UQ(e)?a.cloneElement(e,"function"==typeof r?r(e.props||{}):r):t}(e,e,t)}function HQ(e){return"test"!==Ni.exports.env.NODE_ENV&&(!e||null===e.offsetParent||e.hidden)}var WQ=function(e){OK(r,e);var t=RK(r);function r(){var e;return CK(this,r),(e=t.apply(this,arguments)).containerRef=a.createRef(),e.animationStart=!1,e.destroyed=!1,e.onClick=function(t,r){var n,i;if(!(!t||HQ(t)||t.className.indexOf("-leave")>=0)){var o=e.props.insertExtraNode;e.extraNode=document.createElement("div");var a=kK(e).extraNode,s=e.context.getPrefixCls;a.className="".concat(s(""),"-click-animating-node");var l=e.getAttributeName();if(t.setAttribute(l,"true"),r&&"#ffffff"!==r&&"rgb(255, 255, 255)"!==r&&function(e){var t=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}(r)&&!/rgba\((?:\d*, ){3}0\)/.test(r)&&"transparent"!==r){a.style.borderColor=r;var c=(null===(n=t.getRootNode)||void 0===n?void 0:n.call(t))||t.ownerDocument,u=c instanceof Document?c.body:null!==(i=c.firstChild)&&void 0!==i?i:c;BQ=dX("\n      [".concat(s(""),"-click-animating-without-extra-node='true']::after, .").concat(s(""),"-click-animating-node {\n        --antd-wave-shadow-color: ").concat(r,";\n      }"),"antd-wave",{csp:e.csp,attachTo:u})}o&&t.appendChild(a),["transition","animation"].forEach((function(r){t.addEventListener("".concat(r,"start"),e.onTransitionStart),t.addEventListener("".concat(r,"end"),e.onTransitionEnd)}))}},e.onTransitionStart=function(t){if(!e.destroyed){var r=e.containerRef.current;!t||t.target!==r||e.animationStart||e.resetEffect(r)}},e.onTransitionEnd=function(t){!t||"fadeEffect"!==t.animationName||e.resetEffect(t.target)},e.bindAnimationEvent=function(t){if(t&&t.getAttribute&&!t.getAttribute("disabled")&&!(t.className.indexOf("disabled")>=0)){var r=function(r){if("INPUT"!==r.target.tagName&&!HQ(r.target)){e.resetEffect(t);var n=getComputedStyle(t).getPropertyValue("border-top-color")||getComputedStyle(t).getPropertyValue("border-color")||getComputedStyle(t).getPropertyValue("background-color");e.clickWaveTimeoutId=window.setTimeout((function(){return e.onClick(t,n)}),0),$Q.cancel(e.animationStartId),e.animationStart=!0,e.animationStartId=$Q((function(){e.animationStart=!1}),10)}};return t.addEventListener("click",r,!0),{cancel:function(){t.removeEventListener("click",r,!0)}}}},e.renderWave=function(t){var r=t.csp,n=e.props.children;if(e.csp=r,!a.isValidElement(n))return n;var i=e.containerRef;return xY(n)&&(i=SY(n.ref,e.containerRef)),zQ(n,{ref:i})},e}return SK(r,[{key:"componentDidMount",value:function(){var e=this.containerRef.current;!e||1!==e.nodeType||(this.instance=this.bindAnimationEvent(e))}},{key:"componentWillUnmount",value:function(){this.instance&&this.instance.cancel(),this.clickWaveTimeoutId&&clearTimeout(this.clickWaveTimeoutId),this.destroyed=!0}},{key:"getAttributeName",value:function(){var e=this.context.getPrefixCls,t=this.props.insertExtraNode;return"".concat(e(""),t?"-click-animating":"-click-animating-without-extra-node")}},{key:"resetEffect",value:function(e){var t=this;if(e&&e!==this.extraNode&&e instanceof Element){var r=this.props.insertExtraNode,n=this.getAttributeName();e.setAttribute(n,"false"),BQ&&(BQ.innerHTML=""),r&&this.extraNode&&e.contains(this.extraNode)&&e.removeChild(this.extraNode),["transition","animation"].forEach((function(r){e.removeEventListener("".concat(r,"start"),t.onTransitionStart),e.removeEventListener("".concat(r,"end"),t.onTransitionEnd)}))}}},{key:"render",value:function(){return a.createElement(bY,null,this.renderWave)}}]),r}(a.Component);WQ.contextType=yY;var GQ=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t},KQ=function(){return{width:0,opacity:0,transform:"scale(0)"}},qQ=function(e){return{width:e.scrollWidth,opacity:1,transform:"scale(1)"}};const YQ=function(e){var t=e.prefixCls,r=!!e.loading;return e.existIcon?s.a.createElement("span",{className:"".concat(t,"-loading-icon")},s.a.createElement(IQ,null)):s.a.createElement(hJ,{visible:r,motionName:"".concat(t,"-loading-icon-motion"),removeOnLeave:!0,onAppearStart:KQ,onAppearActive:qQ,onEnterStart:KQ,onEnterActive:qQ,onLeaveStart:qQ,onLeaveActive:KQ},(function(e,r){var n=e.className,i=e.style;return s.a.createElement("span",{className:"".concat(t,"-loading-icon"),style:i,ref:r},s.a.createElement(IQ,{className:n}))}))};var JQ=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},XQ=/^[\u4e00-\u9fa5]{2}$/,ZQ=XQ.test.bind(XQ);function QQ(e){return"text"===e||"link"===e}function e0(e,t){var r=!1,n=[];return a.Children.forEach(e,(function(e){var t=sK(e),i="string"===t||"number"===t;if(r&&i){var o=n.length-1,a=n[o];n[o]="".concat(a).concat(e)}else n.push(e);r=i})),a.Children.map(n,(function(e){return function(e,t){if(null!=e){var r=t?" ":"";return"string"!=typeof e&&"number"!=typeof e&&function(e){return"string"==typeof e}(e.type)&&ZQ(e.props.children)?zQ(e,{children:e.props.children.split("").join(r)}):"string"==typeof e?(ZQ(e)&&(e=e.split("").join(r)),a.createElement("span",null,e)):e}}(e,t)}))}GQ("default","primary","ghost","dashed","link","text"),GQ("circle","round"),GQ("submit","button","reset");var t0=function(e,t){var r,n,i=e.loading,o=void 0!==i&&i,s=e.prefixCls,l=e.type,c=e.danger,u=e.shape,d=e.size,f=e.className,h=e.children,p=e.icon,g=e.ghost,m=void 0!==g&&g,v=e.block,y=void 0!==v&&v,b=e.htmlType,_=void 0===b?"button":b,w=JQ(e,["loading","prefixCls","type","danger","shape","size","className","children","icon","ghost","block","htmlType"]),C=a.useContext(_Y),E=pK(a.useState(!!o),2),S=E[0],k=E[1],x=pK(a.useState(!1),2),O=x[0],I=x[1],R=a.useContext(yY),T=R.getPrefixCls,A=R.autoInsertSpaceInButton,M=R.direction,N=t||a.createRef(),D=a.useRef(),P=function(){return 1===a.Children.count(h)&&!p&&!QQ(l)};n="object"===sK(o)&&o.delay?o.delay||!0:!!o,a.useEffect((function(){clearTimeout(D.current),"number"==typeof n?D.current=window.setTimeout((function(){k(n)}),n):k(n)}),[n]),a.useEffect((function(){if(N&&N.current&&!1!==A){var e=N.current.textContent;P()&&ZQ(e)?O||I(!0):O&&I(!1)}}),[N]);var j=function(t){var r,n=e.onClick,i=e.disabled;S||i?t.preventDefault():null===(r=n)||void 0===r||r(t)};nY(!("string"==typeof p&&p.length>2),"Button","`icon` is using ReactNode instead of string naming in v4. Please check `".concat(p,"` at https://ant.design/components/icon")),nY(!(m&&QQ(l)),"Button","`link` or `text` button can't be a `ghost` button.");var F=T("btn",s),V=!1!==A,L="";switch(d||C){case"large":L="lg";break;case"small":L="sm"}var $=S?"loading":p,B=qL(F,(cK(r={},"".concat(F,"-").concat(l),l),cK(r,"".concat(F,"-").concat(u),u),cK(r,"".concat(F,"-").concat(L),L),cK(r,"".concat(F,"-icon-only"),!h&&0!==h&&!!$),cK(r,"".concat(F,"-background-ghost"),m&&!QQ(l)),cK(r,"".concat(F,"-loading"),S),cK(r,"".concat(F,"-two-chinese-chars"),O&&V),cK(r,"".concat(F,"-block"),y),cK(r,"".concat(F,"-dangerous"),!!c),cK(r,"".concat(F,"-rtl"),"rtl"===M),r),f),U=p&&!S?p:a.createElement(YQ,{existIcon:!!p,prefixCls:F,loading:!!S}),z=h||0===h?e0(h,P()&&V):null,H=vK(w,["navigate"]);if(void 0!==H.href)return a.createElement("a",aK({},H,{className:B,onClick:j,ref:N}),U,z);var W=a.createElement("button",aK({},w,{type:_,className:B,onClick:j,ref:N}),U,z);return QQ(l)?W:a.createElement(WQ,null,W)},r0=a.forwardRef(t0);r0.displayName="Button",r0.Group=FQ,r0.__ANT_BUTTON=!0;const n0=r0;var i0=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const o0=function(e){var t,r=e.prefixCls,n=e.className,i=e.checked,o=e.onChange,s=e.onClick,l=i0(e,["prefixCls","className","checked","onChange","onClick"]),c=(0,a.useContext(yY).getPrefixCls)("tag",r),u=qL(c,(cK(t={},"".concat(c,"-checkable"),!0),cK(t,"".concat(c,"-checkable-checked"),i),t),n);return a.createElement("span",aK({},l,{className:u,onClick:function(e){null==o||o(!i),null==s||s(e)}}))};var a0=GQ("success","processing","error","default","warning"),s0=GQ("pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime"),l0=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},c0=new RegExp("^(".concat(s0.join("|"),")(-inverse)?$")),u0=new RegExp("^(".concat(a0.join("|"),")$")),d0=function(e,t){var r,n=e.prefixCls,i=e.className,o=e.style,s=e.children,l=e.icon,c=e.color,u=e.onClose,d=e.closeIcon,f=e.closable,h=void 0!==f&&f,p=l0(e,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),g=a.useContext(yY),m=g.getPrefixCls,v=g.direction,y=pK(a.useState(!0),2),b=y[0],_=y[1];a.useEffect((function(){"visible"in p&&_(p.visible)}),[p.visible]);var w=function(){return!!c&&(c0.test(c)||u0.test(c))},C=aK({backgroundColor:c&&!w()?c:void 0},o),E=w(),S=m("tag",n),k=qL(S,(cK(r={},"".concat(S,"-").concat(c),E),cK(r,"".concat(S,"-has-color"),c&&!E),cK(r,"".concat(S,"-hidden"),!b),cK(r,"".concat(S,"-rtl"),"rtl"===v),r),i),x=function(e){e.stopPropagation(),null==u||u(e),!e.defaultPrevented&&("visible"in p||_(!1))},O="onClick"in p||s&&"a"===s.type,I=vK(p,["visible"]),R=l||null,T=R?a.createElement(a.Fragment,null,R,a.createElement("span",null,s)):s,A=a.createElement("span",aK({},I,{ref:t,className:k,style:C}),T,h?d?a.createElement("span",{className:"".concat(S,"-close-icon"),onClick:x},d):a.createElement(DQ,{className:"".concat(S,"-close-icon"),onClick:x}):null);return O?a.createElement(WQ,null,A):A},f0=a.forwardRef(d0);f0.displayName="Tag",f0.CheckableTag=o0;const h0=f0;const p0={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"};var g0=function(e,t){return a.createElement(xQ,mK(mK({},e),{},{ref:t,icon:p0}))};g0.displayName="CalendarOutlined";const m0=a.forwardRef(g0);const v0={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"};var y0=function(e,t){return a.createElement(xQ,mK(mK({},e),{},{ref:t,icon:v0}))};y0.displayName="ClockCircleOutlined";const b0=a.forwardRef(y0);function _0(e){var t=a.useRef();t.current=e;var r=a.useCallback((function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(n))}),[]);return r}var w0="test"!==Ni.exports.env.NODE_ENV&&$Y()?a.useLayoutEffect:a.useEffect,C0=function(e,t){var r=a.useRef(!0);w0((function(){return e(r.current)}),t),w0((function(){return r.current=!1,function(){r.current=!0}}),[])},E0=function(e,t){C0((function(t){if(!t)return e()}),t)};function S0(e){return void 0!==e}function k0(e,t){var r=t||{},n=r.defaultValue,i=r.value,o=r.onChange,a=r.postState,s=pK(RY((function(){return S0(i)?i:S0(n)?"function"==typeof n?n():n:"function"==typeof e?e():e})),2),l=s[0],c=s[1],u=void 0!==i?i:l,d=a?a(u):u,f=_0(o),h=pK(RY([u]),2),p=h[0],g=h[1];return E0((function(){var e=p[0];l!==e&&f(l,e)}),[p]),E0((function(){S0(i)||c(i)}),[i]),[d,_0((function(e,t){c(e,t),g([u],t)}))]}var x0={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=x0.F1&&t<=x0.F12)return!1;switch(t){case x0.ALT:case x0.CAPS_LOCK:case x0.CONTEXT_MENU:case x0.CTRL:case x0.DOWN:case x0.END:case x0.ESC:case x0.HOME:case x0.INSERT:case x0.LEFT:case x0.MAC_FF_META:case x0.META:case x0.NUMLOCK:case x0.NUM_CENTER:case x0.PAGE_DOWN:case x0.PAGE_UP:case x0.PAUSE:case x0.PRINT_SCREEN:case x0.RIGHT:case x0.SHIFT:case x0.UP:case x0.WIN_KEY:case x0.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=x0.ZERO&&e<=x0.NINE||e>=x0.NUM_ZERO&&e<=x0.NUM_MULTIPLY||e>=x0.A&&e<=x0.Z||-1!==window.navigator.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case x0.SPACE:case x0.QUESTION_MARK:case x0.NUM_PLUS:case x0.NUM_MINUS:case x0.NUM_PERIOD:case x0.NUM_DIVISION:case x0.SEMICOLON:case x0.DASH:case x0.EQUALS:case x0.COMMA:case x0.PERIOD:case x0.SLASH:case x0.APOSTROPHE:case x0.SINGLE_QUOTE:case x0.OPEN_SQUARE_BRACKET:case x0.BACKSLASH:case x0.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},O0=a.createContext({}),I0={visibility:"hidden"};function R0(e){var t=e.prefixCls,r=e.prevIcon,n=void 0===r?"‹":r,i=e.nextIcon,o=void 0===i?"›":i,s=e.superPrevIcon,l=void 0===s?"«":s,c=e.superNextIcon,u=void 0===c?"»":c,d=e.onSuperPrev,f=e.onSuperNext,h=e.onPrev,p=e.onNext,g=e.children,m=a.useContext(O0),v=m.hideNextBtn,y=m.hidePrevBtn;return a.createElement("div",{className:t},d&&a.createElement("button",{type:"button",onClick:d,tabIndex:-1,className:"".concat(t,"-super-prev-btn"),style:y?I0:{}},l),h&&a.createElement("button",{type:"button",onClick:h,tabIndex:-1,className:"".concat(t,"-prev-btn"),style:y?I0:{}},n),a.createElement("div",{className:"".concat(t,"-view")},g),p&&a.createElement("button",{type:"button",onClick:p,tabIndex:-1,className:"".concat(t,"-next-btn"),style:v?I0:{}},o),f&&a.createElement("button",{type:"button",onClick:f,tabIndex:-1,className:"".concat(t,"-super-next-btn"),style:v?I0:{}},u))}function T0(e){var t=e.prefixCls,r=e.generateConfig,n=e.viewDate,i=e.onPrevDecades,o=e.onNextDecades;if(a.useContext(O0).hideHeader)return null;var s="".concat(t,"-header"),l=r.getYear(n),c=Math.floor(l/Y0)*Y0,u=c+Y0-1;return a.createElement(R0,aK({},e,{prefixCls:s,onSuperPrev:i,onSuperNext:o}),c,"-",u)}function A0(e,t,r,n,i){var o=e.setHour(t,r);return o=e.setMinute(o,n),o=e.setSecond(o,i)}function M0(e,t,r){if(!r)return t;var n=t;return n=e.setHour(n,e.getHour(r)),n=e.setMinute(n,e.getMinute(r)),n=e.setSecond(n,e.getSecond(r))}function N0(e,t){var r=e.getYear(t),n=e.getMonth(t)+1,i=e.getEndDate(e.getFixedDate("".concat(r,"-").concat(n,"-01"))),o=e.getDate(i),a=n<10?"0".concat(n):"".concat(n);return"".concat(r,"-").concat(a,"-").concat(o)}function D0(e){for(var t=e.prefixCls,r=e.disabledDate,n=e.onSelect,i=e.picker,o=e.rowNum,s=e.colNum,l=e.prefixColumn,c=e.rowClassName,u=e.baseDate,d=e.getCellClassName,f=e.getCellText,h=e.getCellNode,p=e.getCellDate,g=e.generateConfig,m=e.titleCell,v=e.headerCells,y=a.useContext(O0),b=y.onDateMouseEnter,_=y.onDateMouseLeave,w=y.mode,C="".concat(t,"-cell"),E=[],S=0;S<o;S+=1){for(var k=[],x=void 0,O=function(e){var t,o=p(u,S*s+e),c=u1({cellDate:o,mode:w,disabledDate:r,generateConfig:g});0===e&&(x=o,l&&k.push(l(x)));var v=m&&m(o);k.push(a.createElement("td",{key:e,title:v,className:qL(C,mK((t={},cK(t,"".concat(C,"-disabled"),c),cK(t,"".concat(C,"-start"),1===f(o)||"year"===i&&Number(v)%10==0),cK(t,"".concat(C,"-end"),v===N0(g,o)||"year"===i&&Number(v)%10==9),t),d(o))),onClick:function(){c||n(o)},onMouseEnter:function(){!c&&b&&b(o)},onMouseLeave:function(){!c&&_&&_(o)}},h?h(o):a.createElement("div",{className:"".concat(C,"-inner")},f(o))))},I=0;I<s;I+=1)O(I);E.push(a.createElement("tr",{key:S,className:c&&c(x)},k))}return a.createElement("div",{className:"".concat(t,"-body")},a.createElement("table",{className:"".concat(t,"-content")},v&&a.createElement("thead",null,a.createElement("tr",null,v)),a.createElement("tbody",null,E)))}var P0=3,j0=4;function F0(e){var t=q0-1,r=e.prefixCls,n=e.viewDate,i=e.generateConfig,o="".concat(r,"-cell"),s=i.getYear(n),l=Math.floor(s/q0)*q0,c=Math.floor(s/Y0)*Y0,u=c+Y0-1,d=i.setYear(n,c-Math.ceil((P0*j0*q0-Y0)/2));return a.createElement(D0,aK({},e,{rowNum:j0,colNum:P0,baseDate:d,getCellText:function(e){var r=i.getYear(e);return"".concat(r,"-").concat(r+t)},getCellClassName:function(e){var r,n=i.getYear(e),a=n+t;return cK(r={},"".concat(o,"-in-view"),c<=n&&a<=u),cK(r,"".concat(o,"-selected"),n===l),r},getCellDate:function(e,t){return i.addYear(e,t*q0)}}))}const V0=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),r=t.width,n=t.height;if(r||n)return!0}if(e.getBoundingClientRect){var i=e.getBoundingClientRect(),o=i.width,a=i.height;if(o||a)return!0}}return!1};var L0=new Map;function $0(e,t,r){if(L0.get(e)&&cancelAnimationFrame(L0.get(e)),r<=0)L0.set(e,requestAnimationFrame((function(){e.scrollTop=t})));else{var n=(t-e.scrollTop)/r*10;L0.set(e,requestAnimationFrame((function(){e.scrollTop+=n,e.scrollTop!==t&&$0(e,t,r-10)})))}}function B0(e,t){var r=t.onLeftRight,n=t.onCtrlLeftRight,i=t.onUpDown,o=t.onPageUpDown,a=t.onEnter,s=e.which,l=e.ctrlKey,c=e.metaKey;switch(s){case x0.LEFT:if(l||c){if(n)return n(-1),!0}else if(r)return r(-1),!0;break;case x0.RIGHT:if(l||c){if(n)return n(1),!0}else if(r)return r(1),!0;break;case x0.UP:if(i)return i(-1),!0;break;case x0.DOWN:if(i)return i(1),!0;break;case x0.PAGE_UP:if(o)return o(-1),!0;break;case x0.PAGE_DOWN:if(o)return o(1),!0;break;case x0.ENTER:if(a)return a(),!0}return!1}function U0(e,t,r,n){var i=e;if(!i)switch(t){case"time":i=n?"hh:mm:ss a":"HH:mm:ss";break;case"week":i="gggg-wo";break;case"month":i="YYYY-MM";break;case"quarter":i="YYYY-[Q]Q";break;case"year":i="YYYY";break;default:i=r?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"}return i}function z0(e,t,r){var n="time"===e?8:10,i="function"==typeof t?t(r.getNow()).length:t.length;return Math.max(n,i)+2}var H0=null,W0=new Set;var G0={year:function(e){return"month"===e||"date"===e?"year":e},month:function(e){return"date"===e?"month":e},quarter:function(e){return"month"===e||"date"===e?"quarter":e},week:function(e){return"date"===e?"week":e},time:null,date:null};function K0(e,t){return e.some((function(e){return e&&e.contains(t)}))}var q0=10,Y0=10*q0;function J0(e){var t=e.prefixCls,r=e.onViewDateChange,n=e.generateConfig,i=e.viewDate,o=e.operationRef,s=e.onSelect,l=e.onPanelChange,c="".concat(t,"-decade-panel");o.current={onKeyDown:function(e){return B0(e,{onLeftRight:function(e){s(n.addYear(i,e*q0),"key")},onCtrlLeftRight:function(e){s(n.addYear(i,e*Y0),"key")},onUpDown:function(e){s(n.addYear(i,e*q0*P0),"key")},onEnter:function(){l("year",i)}})}};var u=function(e){var t=n.addYear(i,e*Y0);r(t),l(null,t)};return a.createElement("div",{className:c},a.createElement(T0,aK({},e,{prefixCls:t,onPrevDecades:function(){u(-1)},onNextDecades:function(){u(1)}})),a.createElement(F0,aK({},e,{prefixCls:t,onSelect:function(e){s(e,"mouse"),l("year",e)}})))}var X0=7;function Z0(e,t){return!e&&!t||!(!e||!t)&&void 0}function Q0(e,t,r){var n=Z0(t,r);return"boolean"==typeof n?n:e.getYear(t)===e.getYear(r)}function e1(e,t){return Math.floor(e.getMonth(t)/3)+1}function t1(e,t,r){var n=Z0(t,r);return"boolean"==typeof n?n:Q0(e,t,r)&&e1(e,t)===e1(e,r)}function r1(e,t,r){var n=Z0(t,r);return"boolean"==typeof n?n:Q0(e,t,r)&&e.getMonth(t)===e.getMonth(r)}function n1(e,t,r){var n=Z0(t,r);return"boolean"==typeof n?n:e.getYear(t)===e.getYear(r)&&e.getMonth(t)===e.getMonth(r)&&e.getDate(t)===e.getDate(r)}function i1(e,t,r,n){var i=Z0(r,n);return"boolean"==typeof i?i:e.locale.getWeek(t,r)===e.locale.getWeek(t,n)}function o1(e,t,r){return n1(e,t,r)&&function(e,t,r){var n=Z0(t,r);return"boolean"==typeof n?n:e.getHour(t)===e.getHour(r)&&e.getMinute(t)===e.getMinute(r)&&e.getSecond(t)===e.getSecond(r)}(e,t,r)}function a1(e,t,r,n){return!!(t&&r&&n)&&(!n1(e,t,n)&&!n1(e,r,n)&&e.isAfter(n,t)&&e.isAfter(r,n))}function s1(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;switch(t){case"year":return r.addYear(e,10*n);case"quarter":case"month":return r.addYear(e,n);default:return r.addMonth(e,n)}}function l1(e,t){var r=t.generateConfig,n=t.locale,i=t.format;return"function"==typeof i?i(e):r.locale.format(n.locale,e,i)}function c1(e,t){var r=t.generateConfig,n=t.locale,i=t.formatList;return e&&"function"!=typeof i[0]?r.locale.parse(n.locale,e,i):null}function u1(e){var t=e.cellDate,r=e.mode,n=e.disabledDate,i=e.generateConfig;if(!n)return!1;var o=function(e,r,o){for(var a=r;a<=o;){var s=void 0;switch(e){case"date":if(s=i.setDate(t,a),!n(s))return!1;break;case"month":if(!u1({cellDate:s=i.setMonth(t,a),mode:"month",generateConfig:i,disabledDate:n}))return!1;break;case"year":if(!u1({cellDate:s=i.setYear(t,a),mode:"year",generateConfig:i,disabledDate:n}))return!1}a+=1}return!0};switch(r){case"date":case"week":return n(t);case"month":return o("date",1,i.getDate(i.getEndDate(t)));case"quarter":var a=3*Math.floor(i.getMonth(t)/3);return o("month",a,a+2);case"year":return o("month",0,11);case"decade":var s=i.getYear(t),l=Math.floor(s/q0)*q0;return o("year",l,l+q0-1)}}function d1(e){if(a.useContext(O0).hideHeader)return null;var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.value,o=e.format,s="".concat(t,"-header");return a.createElement(R0,{prefixCls:s},i?l1(i,{locale:n,format:o,generateConfig:r}):" ")}function f1(e){var t=e.prefixCls,r=e.units,n=e.onSelect,i=e.value,o=e.active,s=e.hideDisabledOptions,l="".concat(t,"-cell"),c=a.useContext(O0).open,u=Object(a.useRef)(null),d=Object(a.useRef)(new Map),f=Object(a.useRef)();return Object(a.useLayoutEffect)((function(){var e=d.current.get(i);e&&!1!==c&&$0(u.current,e.offsetTop,120)}),[i]),Object(a.useLayoutEffect)((function(){if(c){var e=d.current.get(i);e&&(f.current=function(e,t){var r;return function n(){V0(e)?t():r=aJ((function(){n()}))}(),function(){aJ.cancel(r)}}(e,(function(){$0(u.current,e.offsetTop,0)})))}return function(){var e;null===(e=f.current)||void 0===e||e.call(f)}}),[c]),a.createElement("ul",{className:qL("".concat(t,"-column"),cK({},"".concat(t,"-column-active"),o)),ref:u,style:{position:"relative"}},r.map((function(e){var t;return s&&e.disabled?null:a.createElement("li",{key:e.value,ref:function(t){d.current.set(e.value,t)},className:qL(l,(t={},cK(t,"".concat(l,"-disabled"),e.disabled),cK(t,"".concat(l,"-selected"),i===e.value),t)),onClick:function(){e.disabled||n(e.value)}},a.createElement("div",{className:"".concat(l,"-inner")},e.label))})))}function h1(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",n=String(e);n.length<t;)n="".concat(r).concat(e);return n}function p1(e){return null==e?[]:Array.isArray(e)?e:[e]}function g1(e){var t={};return Object.keys(e).forEach((function(r){("data-"===r.substr(0,5)||"aria-"===r.substr(0,5)||"role"===r||"name"===r)&&"data-__"!==r.substr(0,7)&&(t[r]=e[r])})),t}function m1(e,t){return e?e[t]:null}function v1(e,t,r){var n=[m1(e,0),m1(e,1)];return n[r]="function"==typeof t?t(n[r]):t,n[0]||n[1]?n:null}function y1(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r+=1)if(e[r].disabled!==t[r].disabled)return!0;return!1}function b1(e,t,r,n){for(var i=[],o=e;o<=t;o+=r)i.push({label:h1(o,2),value:o,disabled:(n||[]).includes(o)});return i}function _1(e){var t,r=e.generateConfig,n=e.prefixCls,i=e.operationRef,o=e.activeColumnIndex,s=e.value,l=e.showHour,c=e.showMinute,u=e.showSecond,d=e.use12Hours,f=e.hourStep,h=void 0===f?1:f,p=e.minuteStep,g=void 0===p?1:p,m=e.secondStep,v=void 0===m?1:m,y=e.disabledHours,b=e.disabledMinutes,_=e.disabledSeconds,w=e.hideDisabledOptions,C=e.onSelect,E=[],S="".concat(n,"-content"),k="".concat(n,"-time-panel"),x=s?r.getHour(s):-1,O=x,I=s?r.getMinute(s):-1,R=s?r.getSecond(s):-1,T=function(e,t,n,i){var o=s||r.getNow(),a=Math.max(0,t),l=Math.max(0,n),c=Math.max(0,i);return o=A0(r,o,d&&e?a+12:a,l,c)},A=b1(0,23,h,y&&y()),M=rY((function(){return A}),A,y1);d&&(t=O>=12,O%=12);var N=pK(a.useMemo((function(){if(!d)return[!1,!1];var e=[!0,!0];return M.forEach((function(t){var r=t.disabled,n=t.value;r||(n>=12?e[1]=!1:e[0]=!1)})),e}),[d,M]),2),D=N[0],P=N[1],j=a.useMemo((function(){return d?M.filter(t?function(e){return e.value>=12}:function(e){return e.value<12}).map((function(e){var t=e.value%12,r=0===t?"12":h1(t,2);return mK(mK({},e),{},{label:r,value:t})})):M}),[d,t,M]),F=b1(0,59,g,b&&b(x)),V=b1(0,59,v,_&&_(x,I));function L(e,t,r,n,i){!1!==e&&E.push({node:a.cloneElement(t,{prefixCls:k,value:r,active:o===E.length,onSelect:i,units:n,hideDisabledOptions:w}),onSelect:i,value:r,units:n})}i.current={onUpDown:function(e){var t=E[o];if(t)for(var r=t.units.findIndex((function(e){return e.value===t.value})),n=t.units.length,i=1;i<n;i+=1){var a=t.units[(r+e*i+n)%n];if(!0!==a.disabled){t.onSelect(a.value);break}}}},L(l,a.createElement(f1,{key:"hour"}),O,j,(function(e){C(T(t,e,I,R),"mouse")})),L(c,a.createElement(f1,{key:"minute"}),I,F,(function(e){C(T(t,O,e,R),"mouse")})),L(u,a.createElement(f1,{key:"second"}),R,V,(function(e){C(T(t,O,I,e),"mouse")}));var $=-1;return"boolean"==typeof t&&($=t?1:0),L(!0===d,a.createElement(f1,{key:"12hours"}),$,[{label:"AM",value:0,disabled:D},{label:"PM",value:1,disabled:P}],(function(e){C(T(!!e,O,I,R),"mouse")})),a.createElement("div",{className:S},E.map((function(e){return e.node})))}var w1=function(e){return e.filter((function(e){return!1!==e})).length};function C1(e){var t=e.generateConfig,r=e.format,n=void 0===r?"HH:mm:ss":r,i=e.prefixCls,o=e.active,s=e.operationRef,l=e.showHour,c=e.showMinute,u=e.showSecond,d=e.use12Hours,f=void 0!==d&&d,h=e.onSelect,p=e.value,g="".concat(i,"-time-panel"),m=a.useRef(),v=pK(a.useState(-1),2),y=v[0],b=v[1],_=w1([l,c,u,f]);return s.current={onKeyDown:function(e){return B0(e,{onLeftRight:function(e){b((y+e+_)%_)},onUpDown:function(e){-1===y?b(0):m.current&&m.current.onUpDown(e)},onEnter:function(){h(p||t.getNow(),"key"),b(-1)}})},onBlur:function(){b(-1)}},a.createElement("div",{className:qL(g,cK({},"".concat(g,"-active"),o))},a.createElement(d1,aK({},e,{format:n,prefixCls:i})),a.createElement(_1,aK({},e,{prefixCls:i,activeColumnIndex:y,operationRef:m})))}var E1=a.createContext({});function S1(e){var t=e.cellPrefixCls,r=e.generateConfig,n=e.rangedValue,i=e.hoverRangedValue,o=e.isInView,a=e.isSameCell,s=e.offsetCell,l=e.today,c=e.value;return function(e){var u,d=s(e,-1),f=s(e,1),h=m1(n,0),p=m1(n,1),g=m1(i,0),m=m1(i,1),v=a1(r,g,m,e);function y(e){return a(h,e)}function b(e){return a(p,e)}var _=a(g,e),w=a(m,e),C=(v||w)&&(!o(d)||b(d)),E=(v||_)&&(!o(f)||y(f));return cK(u={},"".concat(t,"-in-view"),o(e)),cK(u,"".concat(t,"-in-range"),a1(r,h,p,e)),cK(u,"".concat(t,"-range-start"),y(e)),cK(u,"".concat(t,"-range-end"),b(e)),cK(u,"".concat(t,"-range-start-single"),y(e)&&!p),cK(u,"".concat(t,"-range-end-single"),b(e)&&!h),cK(u,"".concat(t,"-range-start-near-hover"),y(e)&&(a(d,g)||a1(r,g,m,d))),cK(u,"".concat(t,"-range-end-near-hover"),b(e)&&(a(f,m)||a1(r,g,m,f))),cK(u,"".concat(t,"-range-hover"),v),cK(u,"".concat(t,"-range-hover-start"),_),cK(u,"".concat(t,"-range-hover-end"),w),cK(u,"".concat(t,"-range-hover-edge-start"),C),cK(u,"".concat(t,"-range-hover-edge-end"),E),cK(u,"".concat(t,"-range-hover-edge-start-near-range"),C&&a(d,p)),cK(u,"".concat(t,"-range-hover-edge-end-near-range"),E&&a(f,h)),cK(u,"".concat(t,"-today"),a(l,e)),cK(u,"".concat(t,"-selected"),a(c,e)),u}}function k1(e){var t=e.prefixCls,r=e.generateConfig,n=e.prefixColumn,i=e.locale,o=e.rowCount,s=e.viewDate,l=e.value,c=e.dateRender,u=a.useContext(E1),d=u.rangedValue,f=u.hoverRangedValue,h=function(e,t,r){var n=t.locale.getWeekFirstDay(e),i=t.setDate(r,1),o=t.getWeekDay(i),a=t.addDate(i,n-o);return t.getMonth(a)===t.getMonth(r)&&t.getDate(a)>1&&(a=t.addDate(a,-7)),a}(i.locale,r,s),p="".concat(t,"-cell"),g=r.locale.getWeekFirstDay(i.locale),m=r.getNow(),v=[],y=i.shortWeekDays||(r.locale.getShortWeekDays?r.locale.getShortWeekDays(i.locale):[]);n&&v.push(a.createElement("th",{key:"empty","aria-label":"empty cell"}));for(var b=0;b<X0;b+=1)v.push(a.createElement("th",{key:b},y[(b+g)%X0]));var _=S1({cellPrefixCls:p,today:m,value:l,generateConfig:r,rangedValue:n?null:d,hoverRangedValue:n?null:f,isSameCell:function(e,t){return n1(r,e,t)},isInView:function(e){return r1(r,e,s)},offsetCell:function(e,t){return r.addDate(e,t)}}),w=c?function(e){return c(e,m)}:void 0;return a.createElement(D0,aK({},e,{rowNum:o,colNum:X0,baseDate:h,getCellNode:w,getCellText:r.getDate,getCellClassName:_,getCellDate:r.addDate,titleCell:function(e){return l1(e,{locale:i,format:"YYYY-MM-DD",generateConfig:r})},headerCells:v}))}function x1(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.viewDate,o=e.onNextMonth,s=e.onPrevMonth,l=e.onNextYear,c=e.onPrevYear,u=e.onYearClick,d=e.onMonthClick;if(a.useContext(O0).hideHeader)return null;var f="".concat(t,"-header"),h=n.shortMonths||(r.locale.getShortMonths?r.locale.getShortMonths(n.locale):[]),p=r.getMonth(i),g=a.createElement("button",{type:"button",key:"year",onClick:u,tabIndex:-1,className:"".concat(t,"-year-btn")},l1(i,{locale:n,format:n.yearFormat,generateConfig:r})),m=a.createElement("button",{type:"button",key:"month",onClick:d,tabIndex:-1,className:"".concat(t,"-month-btn")},n.monthFormat?l1(i,{locale:n,format:n.monthFormat,generateConfig:r}):h[p]),v=n.monthBeforeYear?[m,g]:[g,m];return a.createElement(R0,aK({},e,{prefixCls:f,onSuperPrev:c,onPrev:s,onNext:o,onSuperNext:l}),v)}var O1=6;function I1(e){var t=e.prefixCls,r=e.panelName,n=void 0===r?"date":r,i=e.keyboardConfig,o=e.active,s=e.operationRef,l=e.generateConfig,c=e.value,u=e.viewDate,d=e.onViewDateChange,f=e.onPanelChange,h=e.onSelect,p="".concat(t,"-").concat(n,"-panel");s.current={onKeyDown:function(e){return B0(e,mK({onLeftRight:function(e){h(l.addDate(c||u,e),"key")},onCtrlLeftRight:function(e){h(l.addYear(c||u,e),"key")},onUpDown:function(e){h(l.addDate(c||u,e*X0),"key")},onPageUpDown:function(e){h(l.addMonth(c||u,e),"key")}},i))}};var g=function(e){var t=l.addYear(u,e);d(t),f(null,t)},m=function(e){var t=l.addMonth(u,e);d(t),f(null,t)};return a.createElement("div",{className:qL(p,cK({},"".concat(p,"-active"),o))},a.createElement(x1,aK({},e,{prefixCls:t,value:c,viewDate:u,onPrevYear:function(){g(-1)},onNextYear:function(){g(1)},onPrevMonth:function(){m(-1)},onNextMonth:function(){m(1)},onMonthClick:function(){f("month",u)},onYearClick:function(){f("year",u)}})),a.createElement(k1,aK({},e,{onSelect:function(e){return h(e,"mouse")},prefixCls:t,value:c,viewDate:u,rowCount:O1})))}var R1=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t}("date","time");function T1(e){var t=e.prefixCls,r=e.operationRef,n=e.generateConfig,i=e.value,o=e.defaultValue,s=e.disabledTime,l=e.showTime,c=e.onSelect,u="".concat(t,"-datetime-panel"),d=pK(a.useState(null),2),f=d[0],h=d[1],p=a.useRef({}),g=a.useRef({}),m="object"===sK(l)?mK({},l):{};var v=function(e){g.current.onBlur&&g.current.onBlur(e),h(null)};r.current={onKeyDown:function(e){if(e.which===x0.TAB){var t=function(e){var t=R1.indexOf(f)+e;return R1[t]||null}(e.shiftKey?-1:1);return h(t),t&&e.preventDefault(),!0}if(f){var r="date"===f?p:g;return r.current&&r.current.onKeyDown&&r.current.onKeyDown(e),!0}return!![x0.LEFT,x0.RIGHT,x0.UP,x0.DOWN].includes(e.which)&&(h("date"),!0)},onBlur:v,onClose:v};var y=function(e,t){var r=e;"date"===t&&!i&&m.defaultValue?(r=n.setHour(r,n.getHour(m.defaultValue)),r=n.setMinute(r,n.getMinute(m.defaultValue)),r=n.setSecond(r,n.getSecond(m.defaultValue))):"time"===t&&!i&&o&&(r=n.setYear(r,n.getYear(o)),r=n.setMonth(r,n.getMonth(o)),r=n.setDate(r,n.getDate(o))),c&&c(r,"mouse")},b=s?s(i||null):{};return a.createElement("div",{className:qL(u,cK({},"".concat(u,"-active"),f))},a.createElement(I1,aK({},e,{operationRef:p,active:"date"===f,onSelect:function(e){y(M0(n,e,l&&"object"===sK(l)?l.defaultValue:null),"date")}})),a.createElement(C1,aK({},e,{format:void 0},m,b,{defaultValue:void 0,operationRef:g,active:"time"===f,onSelect:function(e){y(e,"time")}})))}function A1(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.value,o="".concat(t,"-cell"),s="".concat(t,"-week-panel-row");return a.createElement(I1,aK({},e,{panelName:"week",prefixColumn:function(e){return a.createElement("td",{key:"week",className:qL(o,"".concat(o,"-week"))},r.locale.getWeek(n.locale,e))},rowClassName:function(e){return qL(s,cK({},"".concat(s,"-selected"),i1(r,n.locale,i,e)))},keyboardConfig:{onLeftRight:null}}))}function M1(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.viewDate,o=e.onNextYear,s=e.onPrevYear,l=e.onYearClick;if(a.useContext(O0).hideHeader)return null;var c="".concat(t,"-header");return a.createElement(R0,aK({},e,{prefixCls:c,onSuperPrev:s,onSuperNext:o}),a.createElement("button",{type:"button",onClick:l,className:"".concat(t,"-year-btn")},l1(i,{locale:n,format:n.yearFormat,generateConfig:r})))}var N1=3,D1=4;function P1(e){var t=e.prefixCls,r=e.locale,n=e.value,i=e.viewDate,o=e.generateConfig,s=e.monthCellRender,l=a.useContext(E1),c=l.rangedValue,u=l.hoverRangedValue,d=S1({cellPrefixCls:"".concat(t,"-cell"),value:n,generateConfig:o,rangedValue:c,hoverRangedValue:u,isSameCell:function(e,t){return r1(o,e,t)},isInView:function(){return!0},offsetCell:function(e,t){return o.addMonth(e,t)}}),f=r.shortMonths||(o.locale.getShortMonths?o.locale.getShortMonths(r.locale):[]),h=o.setMonth(i,0),p=s?function(e){return s(e,r)}:void 0;return a.createElement(D0,aK({},e,{rowNum:D1,colNum:N1,baseDate:h,getCellNode:p,getCellText:function(e){return r.monthFormat?l1(e,{locale:r,format:r.monthFormat,generateConfig:o}):f[o.getMonth(e)]},getCellClassName:d,getCellDate:o.addMonth,titleCell:function(e){return l1(e,{locale:r,format:"YYYY-MM",generateConfig:o})}}))}function j1(e){var t=e.prefixCls,r=e.operationRef,n=e.onViewDateChange,i=e.generateConfig,o=e.value,s=e.viewDate,l=e.onPanelChange,c=e.onSelect,u="".concat(t,"-month-panel");r.current={onKeyDown:function(e){return B0(e,{onLeftRight:function(e){c(i.addMonth(o||s,e),"key")},onCtrlLeftRight:function(e){c(i.addYear(o||s,e),"key")},onUpDown:function(e){c(i.addMonth(o||s,e*N1),"key")},onEnter:function(){l("date",o||s)}})}};var d=function(e){var t=i.addYear(s,e);n(t),l(null,t)};return a.createElement("div",{className:u},a.createElement(M1,aK({},e,{prefixCls:t,onPrevYear:function(){d(-1)},onNextYear:function(){d(1)},onYearClick:function(){l("year",s)}})),a.createElement(P1,aK({},e,{prefixCls:t,onSelect:function(e){c(e,"mouse"),l("date",e)}})))}function F1(e){var t=e.prefixCls,r=e.generateConfig,n=e.locale,i=e.viewDate,o=e.onNextYear,s=e.onPrevYear,l=e.onYearClick;if(a.useContext(O0).hideHeader)return null;var c="".concat(t,"-header");return a.createElement(R0,aK({},e,{prefixCls:c,onSuperPrev:s,onSuperNext:o}),a.createElement("button",{type:"button",onClick:l,className:"".concat(t,"-year-btn")},l1(i,{locale:n,format:n.yearFormat,generateConfig:r})))}var V1=4,L1=1;function $1(e){var t=e.prefixCls,r=e.locale,n=e.value,i=e.viewDate,o=e.generateConfig,s=a.useContext(E1),l=s.rangedValue,c=s.hoverRangedValue,u=S1({cellPrefixCls:"".concat(t,"-cell"),value:n,generateConfig:o,rangedValue:l,hoverRangedValue:c,isSameCell:function(e,t){return t1(o,e,t)},isInView:function(){return!0},offsetCell:function(e,t){return o.addMonth(e,3*t)}}),d=o.setDate(o.setMonth(i,0),1);return a.createElement(D0,aK({},e,{rowNum:L1,colNum:V1,baseDate:d,getCellText:function(e){return l1(e,{locale:r,format:r.quarterFormat||"[Q]Q",generateConfig:o})},getCellClassName:u,getCellDate:function(e,t){return o.addMonth(e,3*t)},titleCell:function(e){return l1(e,{locale:r,format:"YYYY-[Q]Q",generateConfig:o})}}))}function B1(e){var t=e.prefixCls,r=e.operationRef,n=e.onViewDateChange,i=e.generateConfig,o=e.value,s=e.viewDate,l=e.onPanelChange,c=e.onSelect,u="".concat(t,"-quarter-panel");r.current={onKeyDown:function(e){return B0(e,{onLeftRight:function(e){c(i.addMonth(o||s,3*e),"key")},onCtrlLeftRight:function(e){c(i.addYear(o||s,e),"key")},onUpDown:function(e){c(i.addYear(o||s,e),"key")}})}};var d=function(e){var t=i.addYear(s,e);n(t),l(null,t)};return a.createElement("div",{className:u},a.createElement(F1,aK({},e,{prefixCls:t,onPrevYear:function(){d(-1)},onNextYear:function(){d(1)},onYearClick:function(){l("year",s)}})),a.createElement($1,aK({},e,{prefixCls:t,onSelect:function(e){c(e,"mouse")}})))}function U1(e){var t=e.prefixCls,r=e.generateConfig,n=e.viewDate,i=e.onPrevDecade,o=e.onNextDecade,s=e.onDecadeClick;if(a.useContext(O0).hideHeader)return null;var l="".concat(t,"-header"),c=r.getYear(n),u=Math.floor(c/G1)*G1,d=u+G1-1;return a.createElement(R0,aK({},e,{prefixCls:l,onSuperPrev:i,onSuperNext:o}),a.createElement("button",{type:"button",onClick:s,className:"".concat(t,"-decade-btn")},u,"-",d))}var z1=3,H1=4;function W1(e){var t=e.prefixCls,r=e.value,n=e.viewDate,i=e.locale,o=e.generateConfig,s=a.useContext(E1),l=s.rangedValue,c=s.hoverRangedValue,u="".concat(t,"-cell"),d=o.getYear(n),f=Math.floor(d/G1)*G1,h=f+G1-1,p=o.setYear(n,f-Math.ceil((z1*H1-G1)/2)),g=S1({cellPrefixCls:u,value:r,generateConfig:o,rangedValue:l,hoverRangedValue:c,isSameCell:function(e,t){return Q0(o,e,t)},isInView:function(e){var t=o.getYear(e);return f<=t&&t<=h},offsetCell:function(e,t){return o.addYear(e,t)}});return a.createElement(D0,aK({},e,{rowNum:H1,colNum:z1,baseDate:p,getCellText:o.getYear,getCellClassName:g,getCellDate:o.addYear,titleCell:function(e){return l1(e,{locale:i,format:"YYYY",generateConfig:o})}}))}var G1=10;function K1(e){var t=e.prefixCls,r=e.operationRef,n=e.onViewDateChange,i=e.generateConfig,o=e.value,s=e.viewDate,l=e.sourceMode,c=e.onSelect,u=e.onPanelChange,d="".concat(t,"-year-panel");r.current={onKeyDown:function(e){return B0(e,{onLeftRight:function(e){c(i.addYear(o||s,e),"key")},onCtrlLeftRight:function(e){c(i.addYear(o||s,e*G1),"key")},onUpDown:function(e){c(i.addYear(o||s,e*z1),"key")},onEnter:function(){u("date"===l?"date":"month",o||s)}})}};var f=function(e){var t=i.addYear(s,10*e);n(t),u(null,t)};return a.createElement("div",{className:d},a.createElement(U1,aK({},e,{prefixCls:t,onPrevDecade:function(){f(-1)},onNextDecade:function(){f(1)},onDecadeClick:function(){u("decade",s)}})),a.createElement(W1,aK({},e,{prefixCls:t,onSelect:function(e){u("date"===l?"date":"month",e),c(e,"mouse")}})))}function q1(e,t,r){return r?a.createElement("div",{className:"".concat(e,"-footer-extra")},r(t)):null}function Y1(e){var t,r,n=e.prefixCls,i=e.rangeList,o=void 0===i?[]:i,s=e.components,l=void 0===s?{}:s,c=e.needConfirmButton,u=e.onNow,d=e.onOk,f=e.okDisabled,h=e.showNow,p=e.locale;if(o.length){var g=l.rangeItem||"span";t=a.createElement(a.Fragment,null,o.map((function(e){var t=e.label,r=e.onClick,i=e.onMouseEnter,o=e.onMouseLeave;return a.createElement("li",{key:t,className:"".concat(n,"-preset")},a.createElement(g,{onClick:r,onMouseEnter:i,onMouseLeave:o},t))})))}if(c){var m=l.button||"button";u&&!t&&!1!==h&&(t=a.createElement("li",{className:"".concat(n,"-now")},a.createElement("a",{className:"".concat(n,"-now-btn"),onClick:u},p.now))),r=c&&a.createElement("li",{className:"".concat(n,"-ok")},a.createElement(m,{disabled:f,onClick:d},p.ok))}return t||r?a.createElement("ul",{className:"".concat(n,"-ranges")},t,r):null}function J1(e){var t,r=e.prefixCls,n=void 0===r?"rc-picker":r,i=e.className,o=e.style,s=e.locale,l=e.generateConfig,c=e.value,u=e.defaultValue,d=e.pickerValue,f=e.defaultPickerValue,h=e.disabledDate,p=e.mode,g=e.picker,m=void 0===g?"date":g,v=e.tabIndex,y=void 0===v?0:v,b=e.showNow,_=e.showTime,w=e.showToday,C=e.renderExtraFooter,E=e.hideHeader,S=e.onSelect,k=e.onChange,x=e.onPanelChange,O=e.onMouseDown,I=e.onPickerValueChange,R=e.onOk,T=e.components,A=e.direction,M=e.hourStep,N=void 0===M?1:M,D=e.minuteStep,P=void 0===D?1:D,j=e.secondStep,F=void 0===j?1:j,V="date"===m&&!!_||"time"===m,L=24%N==0,$=60%P==0,B=60%F==0;"production"!==Ni.exports.env.NODE_ENV&&(BK(!c||l.isValidate(c),"Invalidate date pass to `value`."),BK(!c||l.isValidate(c),"Invalidate date pass to `defaultValue`."),BK(L,"`hourStep` ".concat(N," is invalid. It should be a factor of 24.")),BK($,"`minuteStep` ".concat(P," is invalid. It should be a factor of 60.")),BK(B,"`secondStep` ".concat(F," is invalid. It should be a factor of 60.")));var U=a.useContext(O0),z=U.operationRef,H=U.panelRef,W=U.onSelect,G=U.hideRanges,K=U.defaultOpenValue,q=a.useContext(E1),Y=q.inRange,J=q.panelPosition,X=q.rangedValue,Z=q.hoverRangedValue,Q=a.useRef({}),ee=a.useRef(!0),te=pK(k0(null,{value:c,defaultValue:u,postState:function(e){return!e&&K&&"time"===m?K:e}}),2),re=te[0],ne=te[1],ie=pK(k0(null,{value:d,defaultValue:f||re,postState:function(e){var t=l.getNow();return e?!re&&_?"object"===sK(_)?M0(l,Array.isArray(e)?e[0]:e,_.defaultValue||t):M0(l,Array.isArray(e)?e[0]:e,u||t):e:t}}),2),oe=ie[0],ae=ie[1],se=function(e){ae(e),I&&I(e)},le=function(e){var t=G0[m];return t?t(e):e},ce=pK(k0((function(){return"time"===m?"time":le("date")}),{value:p}),2),ue=ce[0],de=ce[1];a.useEffect((function(){de(m)}),[m]);var fe=pK(a.useState((function(){return ue})),2),he=fe[0],pe=fe[1],ge=function(e,t){(ue===m||arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&(ne(e),S&&S(e),W&&W(e,t),k&&!o1(l,e,re)&&(null==h||!h(e))&&k(e))},me=function(e){return Q.current&&Q.current.onKeyDown?([x0.LEFT,x0.RIGHT,x0.UP,x0.DOWN,x0.PAGE_UP,x0.PAGE_DOWN,x0.ENTER].includes(e.which)&&e.preventDefault(),Q.current.onKeyDown(e)):(BK(!1,"Panel not correct handle keyDown event. Please help to fire issue about this."),!1)};z&&"right"!==J&&(z.current={onKeyDown:me,onClose:function(){Q.current&&Q.current.onClose&&Q.current.onClose()}}),a.useEffect((function(){c&&!ee.current&&ae(c)}),[c]),a.useEffect((function(){ee.current=!1}),[]);var ve,ye=mK(mK({},e),{},{operationRef:Q,prefixCls:n,viewDate:oe,value:re,onViewDateChange:se,sourceMode:he,onPanelChange:function(e,t){var r=le(e||ue);pe(ue),de(r),x&&(ue!==r||o1(l,oe,oe))&&x(t,r)},disabledDate:h});switch(delete ye.onChange,delete ye.onSelect,ue){case"decade":ve=a.createElement(J0,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}}));break;case"year":ve=a.createElement(K1,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}}));break;case"month":ve=a.createElement(j1,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}}));break;case"quarter":ve=a.createElement(B1,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}}));break;case"week":ve=a.createElement(A1,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}}));break;case"time":delete ye.showTime,ve=a.createElement(C1,aK({},ye,"object"===sK(_)?_:null,{onSelect:function(e,t){se(e),ge(e,t)}}));break;default:ve=_?a.createElement(T1,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}})):a.createElement(I1,aK({},ye,{onSelect:function(e,t){se(e),ge(e,t)}}))}var be,_e,we;if(G||(be=q1(n,ue,C),_e=Y1({prefixCls:n,components:T,needConfirmButton:V,okDisabled:!re||h&&h(re),locale:s,showNow:b,onNow:V&&function(){var e=l.getNow(),t=function(e,t,r,n,i,o){var a=Math.floor(e/n)*n;if(a<e)return[a,60-i,60-o];var s=Math.floor(t/i)*i;return s<t?[a,s,60-o]:[a,s,Math.floor(r/o)*o]}(l.getHour(e),l.getMinute(e),l.getSecond(e),L?N:1,$?P:1,B?F:1),r=A0(l,e,t[0],t[1],t[2]);ge(r,"submit")},onOk:function(){re&&(ge(re,"submit",!0),R&&R(re))}})),w&&"date"===ue&&"date"===m&&!_){var Ce=l.getNow(),Ee="".concat(n,"-today-btn"),Se=h&&h(Ce);we=a.createElement("a",{className:qL(Ee,Se&&"".concat(Ee,"-disabled")),"aria-disabled":Se,onClick:function(){Se||ge(Ce,"mouse",!0)}},s.today)}return a.createElement(O0.Provider,{value:mK(mK({},U),{},{mode:ue,hideHeader:"hideHeader"in e?E:U.hideHeader,hidePrevBtn:Y&&"right"===J,hideNextBtn:Y&&"left"===J})},a.createElement("div",{tabIndex:y,className:qL("".concat(n,"-panel"),i,(t={},cK(t,"".concat(n,"-panel-has-range"),X&&X[0]&&X[1]),cK(t,"".concat(n,"-panel-has-range-hover"),Z&&Z[0]&&Z[1]),cK(t,"".concat(n,"-panel-rtl"),"rtl"===A),t)),style:o,onKeyDown:me,onBlur:function(e){Q.current&&Q.current.onBlur&&Q.current.onBlur(e)},onMouseDown:O,ref:H},ve,be||_e||we?a.createElement("div",{className:"".concat(n,"-footer")},be,_e,we):null))}function X1(e,t,r,n){var i=c.a.unstable_batchedUpdates?function(e){c.a.unstable_batchedUpdates(r,e)}:r;return null!=e&&e.addEventListener&&e.addEventListener(t,i,n),{remove:function(){null!=e&&e.removeEventListener&&e.removeEventListener(t,i,n)}}}var Z1=Object(a.forwardRef)((function(e,t){var r=e.didUpdate,n=e.getContainer,i=e.children,o=Object(a.useRef)(),s=Object(a.useRef)();Object(a.useImperativeHandle)(t,(function(){return{}}));var l=Object(a.useRef)(!1);return!l.current&&$Y()&&(s.current=n(),o.current=s.current.parentNode,l.current=!0),Object(a.useEffect)((function(){null==r||r(e)})),Object(a.useEffect)((function(){return null===s.current.parentNode&&null!==o.current&&o.current.appendChild(s.current),function(){var e,t;null===(e=s.current)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(s.current)}}),[]),s.current?c.a.createPortal(i,s.current):null}));function Q1(e,t,r){return r?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}const e2=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(null==e?void 0:e.substr(0,4))};function t2(e){var t=e.prefixCls,r=e.motion,n=e.animation,i=e.transitionName;return r||(n?{motionName:"".concat(t,"-").concat(n)}:i?{motionName:i}:null)}function r2(e){var t=e.prefixCls,r=e.visible,n=e.zIndex,i=e.mask,o=e.maskMotion,s=e.maskAnimation,l=e.maskTransitionName;if(!i)return null;var c={};return(o||l||s)&&(c=mK({motionAppear:!0},t2({motion:o,prefixCls:t,transitionName:l,animation:s}))),a.createElement(hJ,aK({},c,{visible:r,removeOnLeave:!0}),(function(e){var r=e.className;return a.createElement("div",{style:{zIndex:n},className:qL("".concat(t,"-mask"),r)})}))}function n2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n2(Object(r),!0).forEach((function(t){a2(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n2(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o2(e){return(o2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a2(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s2,l2={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function c2(){if(void 0!==s2)return s2;s2="";var e=document.createElement("p").style;for(var t in l2)t+"Transform"in e&&(s2=t);return s2}function u2(){return c2()?"".concat(c2(),"TransitionProperty"):"transitionProperty"}function d2(){return c2()?"".concat(c2(),"Transform"):"transform"}function f2(e,t){var r=u2();r&&(e.style[r]=t,"transitionProperty"!==r&&(e.style.transitionProperty=t))}function h2(e,t){var r=d2();r&&(e.style[r]=t,"transform"!==r&&(e.style.transform=t))}var p2,g2=/matrix\((.*)\)/,m2=/matrix3d\((.*)\)/;function v2(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function y2(e,t,r){var n=r;if("object"!==o2(t))return typeof n<"u"?("number"==typeof n&&(n="".concat(n,"px")),void(e.style[t]=n)):p2(e,t);for(var i in t)t.hasOwnProperty(i)&&y2(e,i,t[i])}function b2(e,t){var r=e["page".concat(t?"Y":"X","Offset")],n="scroll".concat(t?"Top":"Left");if("number"!=typeof r){var i=e.document;"number"!=typeof(r=i.documentElement[n])&&(r=i.body[n])}return r}function _2(e){return b2(e)}function w2(e){return b2(e,!0)}function C2(e){var t=function(e){var t,r,n,i=e.ownerDocument,o=i.body,a=i&&i.documentElement;return t=e.getBoundingClientRect(),r=Math.floor(t.left),n=Math.floor(t.top),{left:r-=a.clientLeft||o.clientLeft||0,top:n-=a.clientTop||o.clientTop||0}}(e),r=e.ownerDocument,n=r.defaultView||r.parentWindow;return t.left+=_2(n),t.top+=w2(n),t}function E2(e){return null!=e&&e==e.window}function S2(e){return E2(e)?e.document:9===e.nodeType?e:e.ownerDocument}var k2=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),x2=/^(top|right|bottom|left)$/,O2="currentStyle",I2="runtimeStyle",R2="left";function T2(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function A2(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function M2(e,t,r){"static"===y2(e,"position")&&(e.style.position="relative");var n=-999,i=-999,o=T2("left",r),a=T2("top",r),s=A2(o),l=A2(a);"left"!==o&&(n=999),"top"!==a&&(i=999);var c="",u=C2(e);("left"in t||"top"in t)&&(c=function(e){return e.style.transitionProperty||e.style[u2()]}(e)||"",f2(e,"none")),"left"in t&&(e.style[s]="",e.style[o]="".concat(n,"px")),"top"in t&&(e.style[l]="",e.style[a]="".concat(i,"px")),v2(e);var d=C2(e),f={};for(var h in t)if(t.hasOwnProperty(h)){var p=T2(h,r),g="left"===h?n:i,m=u[h]-d[h];f[p]=p===h?g+m:g-m}y2(e,f),v2(e),("left"in t||"top"in t)&&f2(e,c);var v={};for(var y in t)if(t.hasOwnProperty(y)){var b=T2(y,r),_=t[y]-u[y];v[b]=y===b?f[b]+_:f[b]-_}y2(e,v)}function N2(e,t){var r=C2(e),n=function(e){var t=window.getComputedStyle(e,null),r=t.getPropertyValue("transform")||t.getPropertyValue(d2());if(r&&"none"!==r){var n=r.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(n[12]||n[4],0),y:parseFloat(n[13]||n[5],0)}}return{x:0,y:0}}(e),i={x:n.x,y:n.y};"left"in t&&(i.x=n.x+t.left-r.left),"top"in t&&(i.y=n.y+t.top-r.top),function(e,t){var r=window.getComputedStyle(e,null),n=r.getPropertyValue("transform")||r.getPropertyValue(d2());if(n&&"none"!==n){var i,o=n.match(g2);o?((i=(o=o[1]).split(",").map((function(e){return parseFloat(e,10)})))[4]=t.x,i[5]=t.y,h2(e,"matrix(".concat(i.join(","),")"))):((i=n.match(m2)[1].split(",").map((function(e){return parseFloat(e,10)})))[12]=t.x,i[13]=t.y,h2(e,"matrix3d(".concat(i.join(","),")")))}else h2(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,i)}function D2(e,t){for(var r=0;r<e.length;r++)t(e[r])}function P2(e){return"border-box"===p2(e,"boxSizing")}typeof window<"u"&&(p2=window.getComputedStyle?function(e,t,r){var n=r,i="",o=S2(e);return(n=n||o.defaultView.getComputedStyle(e,null))&&(i=n.getPropertyValue(t)||n[t]),i}:function(e,t){var r=e[O2]&&e[O2][t];if(k2.test(r)&&!x2.test(t)){var n=e.style,i=n[R2],o=e[I2][R2];e[I2][R2]=e[O2][R2],n[R2]="fontSize"===t?"1em":r||0,r=n.pixelLeft+"px",n[R2]=i,e[I2][R2]=o}return""===r?"auto":r});var j2=["margin","border","padding"],F2=-1,V2=2,L2=1;function $2(e,t,r){var n,i,o,a=0;for(i=0;i<t.length;i++)if(n=t[i])for(o=0;o<r.length;o++){var s=void 0;s="border"===n?"".concat(n).concat(r[o],"Width"):n+r[o],a+=parseFloat(p2(e,s))||0}return a}var B2={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function U2(e,t,r){var n=r;if(E2(e))return"width"===t?B2.viewportWidth(e):B2.viewportHeight(e);if(9===e.nodeType)return"width"===t?B2.docWidth(e):B2.docHeight(e);var i="width"===t?["Left","Right"]:["Top","Bottom"],o=Math.floor("width"===t?e.getBoundingClientRect().width:e.getBoundingClientRect().height),a=P2(e),s=0;(null==o||o<=0)&&(o=void 0,(null==(s=p2(e,t))||Number(s)<0)&&(s=e.style[t]||0),s=Math.floor(parseFloat(s))||0),void 0===n&&(n=a?L2:F2);var l=void 0!==o||a,c=o||s;return n===F2?l?c-$2(e,["border","padding"],i):s:l?n===L2?c:c+(n===V2?-$2(e,["border"],i):$2(e,["margin"],i)):s+$2(e,j2.slice(n),i)}D2(["Width","Height"],(function(e){B2["doc".concat(e)]=function(t){var r=t.document;return Math.max(r.documentElement["scroll".concat(e)],r.body["scroll".concat(e)],B2["viewport".concat(e)](r))},B2["viewport".concat(e)]=function(t){var r="client".concat(e),n=t.document,i=n.body,o=n.documentElement[r];return"CSS1Compat"===n.compatMode&&o||i&&i[r]||o}}));var z2={position:"absolute",visibility:"hidden",display:"block"};function H2(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=t[0];return 0!==i.offsetWidth?n=U2.apply(void 0,t):function(e,t,r){var n,i={},o=e.style;for(n in t)t.hasOwnProperty(n)&&(i[n]=o[n],o[n]=t[n]);for(n in r.call(e),t)t.hasOwnProperty(n)&&(o[n]=i[n])}(i,z2,(function(){n=U2.apply(void 0,t)})),n}function W2(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}D2(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);B2["outer".concat(t)]=function(t,r){return t&&H2(t,e,r?0:L2)};var r="width"===e?["Left","Right"]:["Top","Bottom"];B2[e]=function(t,n){var i=n;return void 0!==i?t?(P2(t)&&(i+=$2(t,["padding","border"],r)),y2(t,e,i)):void 0:t&&H2(t,e,F2)}}));var G2={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:S2,offset:function(e,t,r){if(!(typeof t<"u"))return C2(e);!function(e,t,r){if(r.ignoreShake){var n=C2(e),i=n.left.toFixed(0),o=n.top.toFixed(0),a=t.left.toFixed(0),s=t.top.toFixed(0);if(i===a&&o===s)return}r.useCssRight||r.useCssBottom?M2(e,t,r):r.useCssTransform&&d2()in document.body.style?N2(e,t):M2(e,t,r)}(e,t,r||{})},isWindow:E2,each:D2,css:y2,clone:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(r.overflow[t]=e.overflow[t]);return r},mix:W2,getWindowScrollLeft:function(e){return _2(e)},getWindowScrollTop:function(e){return w2(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)G2.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};W2(G2,B2);var K2=G2.getParent;function q2(e){if(G2.isWindow(e)||9===e.nodeType)return null;var t,r=G2.getDocument(e).body,n=G2.css(e,"position");if(!("fixed"===n||"absolute"===n))return"html"===e.nodeName.toLowerCase()?null:K2(e);for(t=K2(e);t&&t!==r&&9!==t.nodeType;t=K2(t))if("static"!==(n=G2.css(t,"position")))return t;return null}var Y2=G2.getParent;function J2(e,t){for(var r={left:0,right:1/0,top:0,bottom:1/0},n=q2(e),i=G2.getDocument(e),o=i.defaultView||i.parentWindow,a=i.body,s=i.documentElement;n;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===n.clientWidth||n===a||n===s||"visible"===G2.css(n,"overflow")){if(n===a||n===s)break}else{var l=G2.offset(n);l.left+=n.clientLeft,l.top+=n.clientTop,r.top=Math.max(r.top,l.top),r.right=Math.min(r.right,l.left+n.clientWidth),r.bottom=Math.min(r.bottom,l.top+n.clientHeight),r.left=Math.max(r.left,l.left)}n=q2(n)}var c=null;G2.isWindow(e)||9===e.nodeType||(c=e.style.position,"absolute"===G2.css(e,"position")&&(e.style.position="fixed"));var u=G2.getWindowScrollLeft(o),d=G2.getWindowScrollTop(o),f=G2.viewportWidth(o),h=G2.viewportHeight(o),p=s.scrollWidth,g=s.scrollHeight,m=window.getComputedStyle(a);if("hidden"===m.overflowX&&(p=o.innerWidth),"hidden"===m.overflowY&&(g=o.innerHeight),e.style&&(e.style.position=c),t||function(e){if(G2.isWindow(e)||9===e.nodeType)return!1;var t=G2.getDocument(e),r=t.body,n=null;for(n=Y2(e);n&&n!==r&&n!==t;n=Y2(n))if("fixed"===G2.css(n,"position"))return!0;return!1}(e))r.left=Math.max(r.left,u),r.top=Math.max(r.top,d),r.right=Math.min(r.right,u+f),r.bottom=Math.min(r.bottom,d+h);else{var v=Math.max(p,u+f);r.right=Math.min(r.right,v);var y=Math.max(g,d+h);r.bottom=Math.min(r.bottom,y)}return r.top>=0&&r.left>=0&&r.bottom>r.top&&r.right>r.left?r:null}function X2(e){var t,r,n;if(G2.isWindow(e)||9===e.nodeType){var i=G2.getWindow(e);t={left:G2.getWindowScrollLeft(i),top:G2.getWindowScrollTop(i)},r=G2.viewportWidth(i),n=G2.viewportHeight(i)}else t=G2.offset(e),r=G2.outerWidth(e),n=G2.outerHeight(e);return t.width=r,t.height=n,t}function Z2(e,t){var r=t.charAt(0),n=t.charAt(1),i=e.width,o=e.height,a=e.left,s=e.top;return"c"===r?s+=o/2:"b"===r&&(s+=o),"c"===n?a+=i/2:"r"===n&&(a+=i),{left:a,top:s}}function Q2(e,t,r,n,i){var o=Z2(t,r[1]),a=Z2(e,r[0]),s=[a.left-o.left,a.top-o.top];return{left:Math.round(e.left-s[0]+n[0]-i[0]),top:Math.round(e.top-s[1]+n[1]-i[1])}}function e3(e,t,r){return e.left<r.left||e.left+t.width>r.right}function t3(e,t,r){return e.top<r.top||e.top+t.height>r.bottom}function r3(e,t,r){var n=[];return G2.each(e,(function(e){n.push(e.replace(t,(function(e){return r[e]})))})),n}function n3(e,t){return e[t]=-e[t],e}function i3(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function o3(e,t){e[0]=i3(e[0],t.width),e[1]=i3(e[1],t.height)}function a3(e,t,r,n){var i=r.points,o=r.offset||[0,0],a=r.targetOffset||[0,0],s=r.overflow,l=r.source||e;o=[].concat(o),a=[].concat(a);var c={},u=0,d=J2(l,!(!(s=s||{})||!s.alwaysByViewport)),f=X2(l);o3(o,f),o3(a,t);var h=Q2(f,t,i,o,a),p=G2.merge(f,h);if(d&&(s.adjustX||s.adjustY)&&n){if(s.adjustX&&e3(h,f,d)){var g=r3(i,/[lr]/gi,{l:"r",r:"l"}),m=n3(o,0),v=n3(a,0);(function(e,t,r){return e.left>r.right||e.left+t.width<r.left})(Q2(f,t,g,m,v),f,d)||(u=1,i=g,o=m,a=v)}if(s.adjustY&&t3(h,f,d)){var y=r3(i,/[tb]/gi,{t:"b",b:"t"}),b=n3(o,1),_=n3(a,1);(function(e,t,r){return e.top>r.bottom||e.top+t.height<r.top})(Q2(f,t,y,b,_),f,d)||(u=1,i=y,o=b,a=_)}u&&(h=Q2(f,t,i,o,a),G2.mix(p,h));var w=e3(h,f,d),C=t3(h,f,d);if(w||C){var E=i;w&&(E=r3(i,/[lr]/gi,{l:"r",r:"l"})),C&&(E=r3(i,/[tb]/gi,{t:"b",b:"t"})),i=E,o=r.offset||[0,0],a=r.targetOffset||[0,0]}c.adjustX=s.adjustX&&w,c.adjustY=s.adjustY&&C,(c.adjustX||c.adjustY)&&(p=function(e,t,r,n){var i=G2.clone(e),o={width:t.width,height:t.height};return n.adjustX&&i.left<r.left&&(i.left=r.left),n.resizeWidth&&i.left>=r.left&&i.left+o.width>r.right&&(o.width-=i.left+o.width-r.right),n.adjustX&&i.left+o.width>r.right&&(i.left=Math.max(r.right-o.width,r.left)),n.adjustY&&i.top<r.top&&(i.top=r.top),n.resizeHeight&&i.top>=r.top&&i.top+o.height>r.bottom&&(o.height-=i.top+o.height-r.bottom),n.adjustY&&i.top+o.height>r.bottom&&(i.top=Math.max(r.bottom-o.height,r.top)),G2.mix(i,o)}(h,f,d,c))}return p.width!==f.width&&G2.css(l,"width",G2.width(l)+p.width-f.width),p.height!==f.height&&G2.css(l,"height",G2.height(l)+p.height-f.height),G2.offset(l,{left:p.left,top:p.top},{useCssRight:r.useCssRight,useCssBottom:r.useCssBottom,useCssTransform:r.useCssTransform,ignoreShake:r.ignoreShake}),{points:i,offset:o,targetOffset:a,overflow:c}}function s3(e,t,r){var n=r.target||t,i=X2(n),o=!function(e,t){var r=J2(e,t),n=X2(e);return!r||n.left+n.width<=r.left||n.top+n.height<=r.top||n.left>=r.right||n.top>=r.bottom}(n,r.overflow&&r.overflow.alwaysByViewport);return a3(e,i,r,o)}function l3(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Set;return function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=n.has(t);if(BK(!a,"Warning: There may be circular references"),a)return!1;if(t===i)return!0;if(r&&o>1)return!1;n.add(t);var s=o+1;if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l],s))return!1;return!0}if(t&&i&&"object"===sK(t)&&"object"===sK(i)){var c=Object.keys(t);return c.length===Object.keys(i).length&&c.every((function(r){return e(t[r],i[r],s)}))}return!1}(e,t)}s3.__getOffsetParent=q2,s3.__getVisibleRectForElement=J2;var c3=function(){if(typeof Map<"u")return Map;function e(e,t){var r=-1;return e.some((function(e,n){return e[0]===t&&(r=n,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},t.prototype.set=function(t,r){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,n=e(r,t);~n&&r.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,n=this.__entries__;r<n.length;r++){var i=n[r];e.call(t,i[1],i[0])}},t}()}(),u3=typeof window<"u"&&typeof document<"u"&&window.document===document,d3=typeof ba<"u"&&ba.Math===Math?ba:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),f3="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(d3):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var h3=["top","right","bottom","left","width","height","size","weight"],p3=typeof MutationObserver<"u",g3=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,n=!1,i=0;function o(){r&&(r=!1,e()),n&&s()}function a(){f3(o)}function s(){var e=Date.now();if(r){if(e-i<2)return;n=!0}else r=!0,n=!1,setTimeout(a,t);i=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){!u3||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),p3?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!u3||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;h3.some((function(e){return!!~r.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),m3=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},v3=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||d3},y3=S3(0,0,0,0);function b3(e){return parseFloat(e)||0}function _3(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){return t+b3(e["border-"+r+"-width"])}),0)}function w3(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return y3;var n=v3(e).getComputedStyle(e),i=function(e){for(var t={},r=0,n=["top","right","bottom","left"];r<n.length;r++){var i=n[r],o=e["padding-"+i];t[i]=b3(o)}return t}(n),o=i.left+i.right,a=i.top+i.bottom,s=b3(n.width),l=b3(n.height);if("border-box"===n.boxSizing&&(Math.round(s+o)!==t&&(s-=_3(n,"left","right")+o),Math.round(l+a)!==r&&(l-=_3(n,"top","bottom")+a)),!function(e){return e===v3(e).document.documentElement}(e)){var c=Math.round(s+o)-t,u=Math.round(l+a)-r;1!==Math.abs(c)&&(s-=c),1!==Math.abs(u)&&(l-=u)}return S3(i.left,i.top,s,l)}var C3=typeof SVGGraphicsElement<"u"?function(e){return e instanceof v3(e).SVGGraphicsElement}:function(e){return e instanceof v3(e).SVGElement&&"function"==typeof e.getBBox};function E3(e){return u3?C3(e)?function(e){var t=e.getBBox();return S3(0,0,t.width,t.height)}(e):w3(e):y3}function S3(e,t,r,n){return{x:e,y:t,width:r,height:n}}var k3=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S3(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=E3(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),x3=function(e,t){var r=function(e){var t=e.x,r=e.y,n=e.width,i=e.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return m3(a,{x:t,y:r,width:n,height:i,top:r,right:t+n,bottom:i+r,left:t}),a}(t);m3(this,{target:e,contentRect:r})},O3=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new c3,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(e instanceof v3(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new k3(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(e instanceof v3(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;!t.has(e)||(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new x3(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),I3=typeof WeakMap<"u"?new WeakMap:new c3,R3=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=g3.getInstance(),n=new O3(t,r,this);I3.set(this,n)};["observe","unobserve","disconnect"].forEach((function(e){R3.prototype[e]=function(){var t;return(t=I3.get(this))[e].apply(t,arguments)}}));var T3=typeof d3.ResizeObserver<"u"?d3.ResizeObserver:R3;function A3(e,t){var r=null,n=null;var i=new T3((function(e){var i=pK(e,1)[0].target;if(document.documentElement.contains(i)){var o=i.getBoundingClientRect(),a=o.width,s=o.height,l=Math.floor(a),c=Math.floor(s);(r!==l||n!==c)&&Promise.resolve().then((function(){t({width:l,height:c})})),r=l,n=c}}));return e&&i.observe(e),function(){i.disconnect()}}function M3(e){return"function"!=typeof e?null:e()}function N3(e){return"object"===sK(e)&&e?e:null}var D3=function(e,t){var r=e.children,n=e.disabled,i=e.target,o=e.align,a=e.onAlign,l=e.monitorWindowResize,c=e.monitorBufferTime,u=void 0===c?0:c,d=s.a.useRef({}),f=s.a.useRef(),h=s.a.Children.only(r),p=s.a.useRef({});p.current.disabled=n,p.current.target=i,p.current.align=o,p.current.onAlign=a;var g=function(e,t){var r=s.a.useRef(!1),n=s.a.useRef(null);function i(){window.clearTimeout(n.current)}return[function o(a){if(i(),r.current&&!0!==a)n.current=window.setTimeout((function(){r.current=!1,o()}),t);else{if(!1===e(a))return;r.current=!0,n.current=window.setTimeout((function(){r.current=!1}),t)}},function(){r.current=!1,i()}]}((function(){var e=p.current,t=e.disabled,r=e.target,n=e.align,i=e.onAlign,o=f.current;if(!t&&r&&o){var a,s=M3(r),l=N3(r);d.current.element=s,d.current.point=l,d.current.align=n;var c=document.activeElement;return s&&V0(s)?a=s3(o,s,n):l&&(a=function(e,t,r){var n,i,o=G2.getDocument(e),a=o.defaultView||o.parentWindow,s=G2.getWindowScrollLeft(a),l=G2.getWindowScrollTop(a),c=G2.viewportWidth(a),u=G2.viewportHeight(a),d={left:n="pageX"in t?t.pageX:s+t.clientX,top:i="pageY"in t?t.pageY:l+t.clientY,width:0,height:0},f=n>=0&&n<=s+c&&i>=0&&i<=l+u,h=[r.points[0],"cc"];return a3(e,d,i2(i2({},r),{},{points:h}),f)}(o,l,n)),function(e,t){e!==document.activeElement&&eX(t,e)&&"function"==typeof e.focus&&e.focus()}(c,o),i&&a&&i(o,a),!0}return!1}),u),m=pK(g,2),v=m[0],y=m[1],b=pK(s.a.useState(),2),_=b[0],w=b[1],C=pK(s.a.useState(),2),E=C[0],S=C[1];return C0((function(){w(M3(i)),S(N3(i))})),s.a.useEffect((function(){(d.current.element!==_||!function(e,t){return e===t||!(!e||!t)&&("pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t&&e.clientX===t.clientX&&e.clientY===t.clientY)}(d.current.point,E)||!l3(d.current.align,o))&&v()})),s.a.useEffect((function(){return A3(f.current,v)}),[f.current]),s.a.useEffect((function(){return A3(_,v)}),[_]),s.a.useEffect((function(){n?y():v()}),[n]),s.a.useEffect((function(){if(l)return X1(window,"resize",v).remove}),[l]),s.a.useEffect((function(){return function(){y()}}),[]),s.a.useImperativeHandle(t,(function(){return{forceAlign:function(){return v(!0)}}})),s.a.isValidElement(h)&&(h=s.a.cloneElement(h,{ref:SY(h.ref,f)})),h},P3=s.a.forwardRef(D3);function j3(){j3=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch{c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,a=Object.create(o.prototype),s=new T(n||[]);return i(a,"_invoke",{value:x(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function b(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(A([])));C&&C!==r&&n.call(C,a)&&(_=C);var E=b.prototype=v.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(i,o,a,s){var l=d(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==sK(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function x(t,r,n){var i=f;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=O(s,n);if(l){if(l===m)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var c=d(t,r,n);if("normal"===c.type){if(i=n.done?g:h,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=g,n.method="throw",n.arg=c.arg)}}}function O(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,O(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=d(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(sK(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},S(k.prototype),c(k.prototype,s,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new k(u(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(E),c(E,l,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}P3.displayName="Align";var F3=["measure","alignPre","align",null,"motion"];var V3=a.forwardRef((function(e,t){var r=e.visible,n=e.prefixCls,i=e.className,o=e.style,s=e.children,l=e.zIndex,c=e.stretch,u=e.destroyPopupOnHide,d=e.forceRender,f=e.align,h=e.point,p=e.getRootDomNode,g=e.getClassNameFromAlign,m=e.onAlign,v=e.onMouseEnter,y=e.onMouseLeave,b=e.onMouseDown,_=e.onTouchStart,w=e.onClick,C=Object(a.useRef)(),E=Object(a.useRef)(),S=pK(Object(a.useState)(),2),k=S[0],x=S[1],O=function(e){var t=pK(a.useState({width:0,height:0}),2),r=t[0],n=t[1];return[a.useMemo((function(){var t={};if(e){var n=r.width,i=r.height;-1!==e.indexOf("height")&&i?t.height=i:-1!==e.indexOf("minHeight")&&i&&(t.minHeight=i),-1!==e.indexOf("width")&&n?t.width=n:-1!==e.indexOf("minWidth")&&n&&(t.minWidth=n)}return t}),[e,r]),function(e){var t=e.offsetWidth,r=e.offsetHeight,i=e.getBoundingClientRect(),o=i.width,a=i.height;Math.abs(t-o)<1&&Math.abs(r-a)<1&&(t=o,r=a),n({width:t,height:r})}]}(c),I=pK(O,2),R=I[0],T=I[1];var A=function(e,t){var r=pK(RY(null),2),n=r[0],i=r[1],o=Object(a.useRef)();function s(e){i(e,!0)}function l(){aJ.cancel(o.current)}return Object(a.useEffect)((function(){s("measure")}),[e]),Object(a.useEffect)((function(){"measure"===n&&t(),n&&(o.current=aJ(XK(j3().mark((function e(){var t,r;return j3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=F3.indexOf(n),(r=F3[t+1])&&-1!==t&&s(r);case 3:case"end":return e.stop()}}),e)})))))}),[n]),Object(a.useEffect)((function(){return function(){l()}}),[]),[n,function(e){l(),o.current=aJ((function(){s((function(e){switch(n){case"align":return"motion";case"motion":return"stable"}return e})),null==e||e()}))}]}(r,(function(){c&&T(p())})),M=pK(A,2),N=M[0],D=M[1],P=pK(Object(a.useState)(0),2),j=P[0],F=P[1],V=Object(a.useRef)();function L(){var e;null===(e=C.current)||void 0===e||e.forceAlign()}function $(e,t){var r=g(t);k!==r&&x(r),F((function(e){return e+1})),"align"===N&&(null==m||m(e,t))}C0((function(){"alignPre"===N&&F(0)}),[N]),C0((function(){"align"===N&&(j<3?L():D((function(){var e;null===(e=V.current)||void 0===e||e.call(V)})))}),[j]);var B=mK({},t2(e));function U(){return new Promise((function(e){V.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var t=B[e];B[e]=function(e,r){return D(),null==t?void 0:t(e,r)}})),a.useEffect((function(){!B.motionName&&"motion"===N&&D()}),[B.motionName,N]),a.useImperativeHandle(t,(function(){return{forceAlign:L,getElement:function(){return E.current}}}));var z=mK(mK({},R),{},{zIndex:l,opacity:"motion"!==N&&"stable"!==N&&r?0:void 0,pointerEvents:r||"stable"===N?void 0:"none"},o),H=!0;null!=f&&f.points&&("align"===N||"stable"===N)&&(H=!1);var W=s;return a.Children.count(s)>1&&(W=a.createElement("div",{className:"".concat(n,"-content")},s)),a.createElement(hJ,aK({visible:r,ref:E,leavedClassName:"".concat(n,"-hidden")},B,{onAppearPrepare:U,onEnterPrepare:U,removeOnLeave:u,forceRender:d}),(function(e,t){var r=e.className,o=e.style,s=qL(n,i,k,r);return a.createElement(P3,{target:h||p,key:"popup",ref:C,monitorWindowResize:!0,disabled:H,align:f,onAlign:$},a.createElement("div",{ref:t,className:s,onMouseEnter:v,onMouseLeave:y,onMouseDownCapture:b,onTouchStartCapture:_,onClick:w,style:mK(mK({},o),z)},W))}))}));V3.displayName="PopupInner";var L3=a.forwardRef((function(e,t){var r=e.prefixCls,n=e.visible,i=e.zIndex,o=e.children,s=e.mobile,l=(s=void 0===s?{}:s).popupClassName,c=s.popupStyle,u=s.popupMotion,d=void 0===u?{}:u,f=s.popupRender,h=e.onClick,p=a.useRef();a.useImperativeHandle(t,(function(){return{forceAlign:function(){},getElement:function(){return p.current}}}));var g=mK({zIndex:i},c),m=o;return a.Children.count(o)>1&&(m=a.createElement("div",{className:"".concat(r,"-content")},o)),f&&(m=f(m)),a.createElement(hJ,aK({visible:n,ref:p,removeOnLeave:!0},d),(function(e,t){var n=e.className,i=e.style,o=qL(r,l,n);return a.createElement("div",{ref:t,className:o,onClick:h,style:mK(mK({},i),g)},m)}))}));L3.displayName="MobilePopupInner";var $3=["visible","mobile"],B3=a.forwardRef((function(e,t){var r=e.visible,n=e.mobile,i=bK(e,$3),o=pK(Object(a.useState)(r),2),s=o[0],l=o[1],c=pK(Object(a.useState)(!1),2),u=c[0],d=c[1],f=mK(mK({},i),{},{visible:s});Object(a.useEffect)((function(){l(r),r&&n&&d(e2())}),[r,n]);var h=u?a.createElement(L3,aK({},f,{mobile:n,ref:t})):a.createElement(V3,aK({},f,{ref:t}));return a.createElement("div",null,a.createElement(r2,f),h)}));B3.displayName="Popup";var U3=a.createContext(null);function z3(){}function H3(){return""}function W3(e){return e?e.ownerDocument:window.document}var G3=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];const K3=function(e){var t=function(t){OK(n,t);var r=RK(n);function n(e){var t,i;return CK(this,n),cK(kK(t=r.call(this,e)),"popupRef",a.createRef()),cK(kK(t),"triggerRef",a.createRef()),cK(kK(t),"portalContainer",void 0),cK(kK(t),"attachId",void 0),cK(kK(t),"clickOutsideHandler",void 0),cK(kK(t),"touchOutsideHandler",void 0),cK(kK(t),"contextMenuOutsideHandler1",void 0),cK(kK(t),"contextMenuOutsideHandler2",void 0),cK(kK(t),"mouseDownTimeout",void 0),cK(kK(t),"focusTime",void 0),cK(kK(t),"preClickTime",void 0),cK(kK(t),"preTouchTime",void 0),cK(kK(t),"delayTimer",void 0),cK(kK(t),"hasPopupMouseDown",void 0),cK(kK(t),"onMouseEnter",(function(e){var r=t.props.mouseEnterDelay;t.fireEvents("onMouseEnter",e),t.delaySetPopupVisible(!0,r,r?null:e)})),cK(kK(t),"onMouseMove",(function(e){t.fireEvents("onMouseMove",e),t.setPoint(e)})),cK(kK(t),"onMouseLeave",(function(e){t.fireEvents("onMouseLeave",e),t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)})),cK(kK(t),"onPopupMouseEnter",(function(){t.clearDelayTimer()})),cK(kK(t),"onPopupMouseLeave",(function(e){var r;e.relatedTarget&&!e.relatedTarget.setTimeout&&eX(null===(r=t.popupRef.current)||void 0===r?void 0:r.getElement(),e.relatedTarget)||t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)})),cK(kK(t),"onFocus",(function(e){t.fireEvents("onFocus",e),t.clearDelayTimer(),t.isFocusToShow()&&(t.focusTime=Date.now(),t.delaySetPopupVisible(!0,t.props.focusDelay))})),cK(kK(t),"onMouseDown",(function(e){t.fireEvents("onMouseDown",e),t.preClickTime=Date.now()})),cK(kK(t),"onTouchStart",(function(e){t.fireEvents("onTouchStart",e),t.preTouchTime=Date.now()})),cK(kK(t),"onBlur",(function(e){t.fireEvents("onBlur",e),t.clearDelayTimer(),t.isBlurToHide()&&t.delaySetPopupVisible(!1,t.props.blurDelay)})),cK(kK(t),"onContextMenu",(function(e){e.preventDefault(),t.fireEvents("onContextMenu",e),t.setPopupVisible(!0,e)})),cK(kK(t),"onContextMenuClose",(function(){t.isContextMenuToShow()&&t.close()})),cK(kK(t),"onClick",(function(e){if(t.fireEvents("onClick",e),t.focusTime){var r;if(t.preClickTime&&t.preTouchTime?r=Math.min(t.preClickTime,t.preTouchTime):t.preClickTime?r=t.preClickTime:t.preTouchTime&&(r=t.preTouchTime),Math.abs(r-t.focusTime)<20)return;t.focusTime=0}t.preClickTime=0,t.preTouchTime=0,t.isClickToShow()&&(t.isClickToHide()||t.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var n=!t.state.popupVisible;(t.isClickToHide()&&!n||n&&t.isClickToShow())&&t.setPopupVisible(!t.state.popupVisible,e)})),cK(kK(t),"onPopupMouseDown",(function(){var e;(t.hasPopupMouseDown=!0,clearTimeout(t.mouseDownTimeout),t.mouseDownTimeout=window.setTimeout((function(){t.hasPopupMouseDown=!1}),0),t.context)&&(e=t.context).onPopupMouseDown.apply(e,arguments)})),cK(kK(t),"onDocumentClick",(function(e){if(!t.props.mask||t.props.maskClosable){var r=e.target,n=t.getRootDomNode(),i=t.getPopupDomNode();(!eX(n,r)||t.isContextMenuOnly())&&!eX(i,r)&&!t.hasPopupMouseDown&&t.close()}})),cK(kK(t),"getRootDomNode",(function(){var e=t.props.getTriggerDOMNode;if(e)return e(t.triggerRef.current);try{var r=CY(t.triggerRef.current);if(r)return r}catch{}return c.a.findDOMNode(kK(t))})),cK(kK(t),"getPopupClassNameFromAlign",(function(e){var r=[],n=t.props,i=n.popupPlacement,o=n.builtinPlacements,a=n.prefixCls,s=n.alignPoint,l=n.getPopupClassNameFromAlign;return i&&o&&r.push(function(e,t,r,n){for(var i=r.points,o=Object.keys(e),a=0;a<o.length;a+=1){var s=o[a];if(Q1(e[s].points,i,n))return"".concat(t,"-placement-").concat(s)}return""}(o,a,e,s)),l&&r.push(l(e)),r.join(" ")})),cK(kK(t),"getComponent",(function(){var e=t.props,r=e.prefixCls,n=e.destroyPopupOnHide,i=e.popupClassName,o=e.onPopupAlign,s=e.popupMotion,l=e.popupAnimation,c=e.popupTransitionName,u=e.popupStyle,d=e.mask,f=e.maskAnimation,h=e.maskTransitionName,p=e.maskMotion,g=e.zIndex,m=e.popup,v=e.stretch,y=e.alignPoint,b=e.mobile,_=e.forceRender,w=e.onPopupClick,C=t.state,E=C.popupVisible,S=C.point,k=t.getPopupAlign(),x={};return t.isMouseEnterToShow()&&(x.onMouseEnter=t.onPopupMouseEnter),t.isMouseLeaveToHide()&&(x.onMouseLeave=t.onPopupMouseLeave),x.onMouseDown=t.onPopupMouseDown,x.onTouchStart=t.onPopupMouseDown,a.createElement(B3,aK({prefixCls:r,destroyPopupOnHide:n,visible:E,point:y&&S,className:i,align:k,onAlign:o,animation:l,getClassNameFromAlign:t.getPopupClassNameFromAlign},x,{stretch:v,getRootDomNode:t.getRootDomNode,style:u,mask:d,zIndex:g,transitionName:c,maskAnimation:f,maskTransitionName:h,maskMotion:p,ref:t.popupRef,motion:s,mobile:b,forceRender:_,onClick:w}),"function"==typeof m?m():m)})),cK(kK(t),"attachParent",(function(e){aJ.cancel(t.attachId);var r,n=t.props,i=n.getPopupContainer,o=n.getDocument,a=t.getRootDomNode();i?(a||0===i.length)&&(r=i(a)):r=o(t.getRootDomNode()).body,r?r.appendChild(e):t.attachId=aJ((function(){t.attachParent(e)}))})),cK(kK(t),"getContainer",(function(){if(!t.portalContainer){var e=(0,t.props.getDocument)(t.getRootDomNode()).createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",t.portalContainer=e}return t.attachParent(t.portalContainer),t.portalContainer})),cK(kK(t),"setPoint",(function(e){!t.props.alignPoint||!e||t.setState({point:{pageX:e.pageX,pageY:e.pageY}})})),cK(kK(t),"handlePortalUpdate",(function(){t.state.prevPopupVisible!==t.state.popupVisible&&t.props.afterPopupVisibleChange(t.state.popupVisible)})),cK(kK(t),"triggerContextValue",{onPopupMouseDown:t.onPopupMouseDown}),i="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,t.state={prevPopupVisible:i,popupVisible:i},G3.forEach((function(e){t["fire".concat(e)]=function(r){t.fireEvents(e,r)}})),t}return SK(n,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,t=this.props;if(this.state.popupVisible)return!this.clickOutsideHandler&&(this.isClickToHide()||this.isContextMenuToShow())&&(e=t.getDocument(this.getRootDomNode()),this.clickOutsideHandler=X1(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||t.getDocument(this.getRootDomNode()),this.touchOutsideHandler=X1(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||t.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=X1(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=X1(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),aJ.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,t=e.popupPlacement,r=e.popupAlign,n=e.builtinPlacements;return t&&n?function(e,t,r){return mK(mK({},e[t]||{}),r)}(n,t,r):r}},{key:"setPopupVisible",value:function(e,t){var r=this.props.alignPoint,n=this.state.popupVisible;this.clearDelayTimer(),n!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:n}),this.props.onPopupVisibleChange(e)),r&&t&&e&&this.setPoint(t)}},{key:"delaySetPopupVisible",value:function(e,t,r){var n=this,i=1e3*t;if(this.clearDelayTimer(),i){var o=r?{pageX:r.pageX,pageY:r.pageY}:null;this.delayTimer=window.setTimeout((function(){n.setPopupVisible(e,o),n.clearDelayTimer()}),i)}else this.setPopupVisible(e,r)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var t=this.props.children.props,r=this.props;return t[e]&&r[e]?this["fire".concat(e)]:t[e]||r[e]}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("click")||-1!==r.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==r.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("click")||-1!==r.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("hover")||-1!==r.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("hover")||-1!==r.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,r=e.showAction;return-1!==t.indexOf("focus")||-1!==r.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,r=e.hideAction;return-1!==t.indexOf("focus")||-1!==r.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,t){var r=this.props.children.props[e];r&&r(t);var n=this.props[e];n&&n(t)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var t=this.state.popupVisible,r=this.props,n=r.children,i=r.forceRender,o=r.alignPoint,s=r.className,l=r.autoDestroy,c=a.Children.only(n),u={key:"trigger"};this.isContextMenuToShow()?u.onContextMenu=this.onContextMenu:u.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(u.onClick=this.onClick,u.onMouseDown=this.onMouseDown,u.onTouchStart=this.onTouchStart):(u.onClick=this.createTwoChains("onClick"),u.onMouseDown=this.createTwoChains("onMouseDown"),u.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(u.onMouseEnter=this.onMouseEnter,o&&(u.onMouseMove=this.onMouseMove)):u.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?u.onMouseLeave=this.onMouseLeave:u.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(u.onFocus=this.onFocus,u.onBlur=this.onBlur):(u.onFocus=this.createTwoChains("onFocus"),u.onBlur=this.createTwoChains("onBlur"));var d=qL(c&&c.props&&c.props.className,s);d&&(u.className=d);var f=mK({},u);xY(c)&&(f.ref=SY(this.triggerRef,c.ref));var h,p=a.cloneElement(c,f);return(t||this.popupRef.current||i)&&(h=a.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!t&&l&&(h=null),a.createElement(U3.Provider,{value:this.triggerContextValue},p,h)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.popupVisible,n={};return void 0!==r&&t.popupVisible!==r&&(n.popupVisible=r,n.prevPopupVisible=t.popupVisible),n}}]),n}(a.Component);return cK(t,"contextType",U3),cK(t,"defaultProps",{prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:H3,getDocument:W3,onPopupVisibleChange:z3,afterPopupVisibleChange:z3,onPopupAlign:z3,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1}),t}(Z1);var q3={bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:0,adjustY:1}},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:0,adjustY:1}}};function Y3(e){var t,r=e.prefixCls,n=e.popupElement,i=e.popupStyle,o=e.visible,s=e.dropdownClassName,l=e.dropdownAlign,c=e.transitionName,u=e.getPopupContainer,d=e.children,f=e.range,h=e.popupPlacement,p=e.direction,g="".concat(r,"-dropdown");return a.createElement(K3,{showAction:[],hideAction:[],popupPlacement:void 0!==h?h:"rtl"===p?"bottomRight":"bottomLeft",builtinPlacements:q3,prefixCls:g,popupTransitionName:c,popup:n,popupAlign:l,popupVisible:o,popupClassName:qL(s,(t={},cK(t,"".concat(g,"-range"),f),cK(t,"".concat(g,"-rtl"),"rtl"===p),t)),popupStyle:i,getPopupContainer:u},d)}function J3(e){var t=e.open,r=e.value,n=e.isClickOutside,i=e.triggerOpen,o=e.forwardKeyDown,s=e.onKeyDown,l=e.blurToCancel,c=e.onSubmit,u=e.onCancel,d=e.onFocus,f=e.onBlur,h=pK(Object(a.useState)(!1),2),p=h[0],g=h[1],m=pK(Object(a.useState)(!1),2),v=m[0],y=m[1],b=Object(a.useRef)(!1),_=Object(a.useRef)(!1),w=Object(a.useRef)(!1),C={onMouseDown:function(){g(!0),i(!0)},onKeyDown:function(e){if(s(e,(function(){w.current=!0})),!w.current){switch(e.which){case x0.ENTER:return t?!1!==c()&&g(!0):i(!0),void e.preventDefault();case x0.TAB:return void(p&&t&&!e.shiftKey?(g(!1),e.preventDefault()):!p&&t&&!o(e)&&e.shiftKey&&(g(!0),e.preventDefault()));case x0.ESC:return g(!0),void u()}t||[x0.SHIFT].includes(e.which)?p||o(e):i(!0)}},onFocus:function(e){g(!0),y(!0),d&&d(e)},onBlur:function(e){!b.current&&n(document.activeElement)?(l?setTimeout((function(){for(var e=document.activeElement;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;n(e)&&u()}),0):t&&(i(!1),_.current&&c()),y(!1),f&&f(e)):b.current=!1}};return Object(a.useEffect)((function(){_.current=!1}),[t]),Object(a.useEffect)((function(){_.current=!0}),[r]),Object(a.useEffect)((function(){return function(e){return!H0&&typeof window<"u"&&window.addEventListener&&(H0=function(e){wK(W0).forEach((function(t){t(e)}))},window.addEventListener("mousedown",H0)),W0.add(e),function(){W0.delete(e),0===W0.size&&(window.removeEventListener("mousedown",H0),H0=null)}}((function(e){var r=function(e){var t,r=e.target;return e.composed&&r.shadowRoot&&(null===(t=e.composedPath)||void 0===t?void 0:t.call(e)[0])||r}(e);if(t){var o=n(r);o?(!v||o)&&i(!1):(b.current=!0,requestAnimationFrame((function(){b.current=!1})))}}))})),[C,{focused:v,typing:p}]}function X3(e){var t=e.valueTexts,r=e.onTextChange,n=pK(a.useState(""),2),i=n[0],o=n[1],s=a.useRef([]);function l(){o(s.current[0])}return s.current=t,a.useEffect((function(){t.every((function(e){return e!==i}))&&l()}),[t.join("||")]),[i,function(e){o(e),r(e)},l]}var Z3=function(e,t,r,n){var i=r?r.call(n,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var c=o[l];if(!s(c))return!1;var u=e[c],d=t[c];if(!1===(i=r?r.call(n,u,d,c):void 0)||void 0===i&&u!==d)return!1}return!0};function Q3(e,t){var r=t.formatList,n=t.generateConfig,i=t.locale;return rY((function(){if(!e)return[[""],""];for(var t="",o=[],a=0;a<r.length;a+=1){var s=r[a],l=l1(e,{generateConfig:n,locale:i,format:s});o.push(l),0===a&&(t=l)}return[o,t]}),[e,r],(function(e,t){return e[0]!==t[0]||!Z3(e[1],t[1])}))}function e5(e,t){var r=t.formatList,n=t.generateConfig,i=t.locale,o=pK(Object(a.useState)(null),2),s=o[0],l=o[1],c=Object(a.useRef)(null);function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];cancelAnimationFrame(c.current),t?l(e):c.current=requestAnimationFrame((function(){l(e)}))}var d=pK(Q3(s,{formatList:r,generateConfig:n,locale:i}),2)[1];function f(){u(null,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}return Object(a.useEffect)((function(){f(!0)}),[e]),Object(a.useEffect)((function(){return function(){return cancelAnimationFrame(c.current)}}),[]),[d,function(e){u(e)},f]}function t5(e){var t,r=e.prefixCls,n=void 0===r?"rc-picker":r,i=e.id,o=e.tabIndex,s=e.style,l=e.className,c=e.dropdownClassName,u=e.dropdownAlign,d=e.popupStyle,f=e.transitionName,h=e.generateConfig,p=e.locale,g=e.inputReadOnly,m=e.allowClear,v=e.autoFocus,y=e.showTime,b=e.picker,_=void 0===b?"date":b,w=e.format,C=e.use12Hours,E=e.value,S=e.defaultValue,k=e.open,x=e.defaultOpen,O=e.defaultOpenValue,I=e.suffixIcon,R=e.clearIcon,T=e.disabled,A=e.disabledDate,M=e.placeholder,N=e.getPopupContainer,D=e.pickerRef,P=e.panelRender,j=e.onChange,F=e.onOpenChange,V=e.onFocus,L=e.onBlur,$=e.onMouseDown,B=e.onMouseUp,U=e.onMouseEnter,z=e.onMouseLeave,H=e.onContextMenu,W=e.onClick,G=e.onKeyDown,K=e.onSelect,q=e.direction,Y=e.autoComplete,J=void 0===Y?"off":Y,X=a.useRef(null),Z="date"===_&&!!y||"time"===_,Q=p1(U0(w,_,y,C)),ee=a.useRef(null),te=a.useRef(null),re=a.useRef(null),ne=pK(k0(null,{value:E,defaultValue:S}),2),ie=ne[0],oe=ne[1],ae=pK(a.useState(ie),2),se=ae[0],le=ae[1],ce=a.useRef(null),ue=pK(k0(!1,{value:k,defaultValue:x,postState:function(e){return!T&&e},onChange:function(e){F&&F(e),!e&&ce.current&&ce.current.onClose&&ce.current.onClose()}}),2),de=ue[0],fe=ue[1],he=pK(Q3(se,{formatList:Q,generateConfig:h,locale:p}),2),pe=he[0],ge=he[1],me=pK(X3({valueTexts:pe,onTextChange:function(e){var t=c1(e,{locale:p,formatList:Q,generateConfig:h});t&&(!A||!A(t))&&le(t)}}),3),ve=me[0],ye=me[1],be=me[2],_e=function(e){le(e),oe(e),j&&!o1(h,ie,e)&&j(e,e?l1(e,{generateConfig:h,locale:p,format:Q[0]}):"")},we=function(e){T&&e||fe(e)},Ce=pK(J3({blurToCancel:Z,open:de,value:ve,triggerOpen:we,forwardKeyDown:function(e){return de&&ce.current&&ce.current.onKeyDown?ce.current.onKeyDown(e):(BK(!1,"Picker not correct forward KeyDown operation. Please help to fire issue about this."),!1)},isClickOutside:function(e){return!K0([ee.current,te.current,re.current],e)},onSubmit:function(){return!(!se||A&&A(se))&&(_e(se),we(!1),be(),!0)},onCancel:function(){we(!1),le(ie),be()},onKeyDown:function(e,t){null==G||G(e,t)},onFocus:V,onBlur:L}),2),Ee=Ce[0],Se=Ce[1],ke=Se.focused,xe=Se.typing;a.useEffect((function(){de||(le(ie),pe.length&&""!==pe[0]?ge!==ve&&be():ye(""))}),[de,pe]),a.useEffect((function(){de||be()}),[_]),a.useEffect((function(){le(ie)}),[ie]),D&&(D.current={focus:function(){X.current&&X.current.focus()},blur:function(){X.current&&X.current.blur()}});var Oe=pK(e5(ve,{formatList:Q,generateConfig:h,locale:p}),3),Ie=Oe[0],Re=Oe[1],Te=Oe[2],Ae=mK(mK({},e),{},{className:void 0,style:void 0,pickerValue:void 0,onPickerValueChange:void 0,onChange:null}),Me=a.createElement(J1,aK({},Ae,{generateConfig:h,className:qL(cK({},"".concat(n,"-panel-focused"),!xe)),value:se,locale:p,tabIndex:-1,onSelect:function(e){null==K||K(e),le(e)},direction:q,onPanelChange:function(t,r){var n=e.onPanelChange;Te(!0),null==n||n(t,r)}}));P&&(Me=P(Me));var Ne,De,Pe=a.createElement("div",{className:"".concat(n,"-panel-container"),onMouseDown:function(e){e.preventDefault()}},Me);I&&(Ne=a.createElement("span",{className:"".concat(n,"-suffix")},I)),m&&ie&&!T&&(De=a.createElement("span",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),_e(null),we(!1)},className:"".concat(n,"-clear"),role:"button"},R||a.createElement("span",{className:"".concat(n,"-clear-btn")}))),"production"!==Ni.exports.env.NODE_ENV&&BK(!O,"`defaultOpenValue` may confuse user for the current value status. Please use `defaultValue` instead.");var je="rtl"===q?"bottomRight":"bottomLeft";return a.createElement(O0.Provider,{value:{operationRef:ce,hideHeader:"time"===_,panelRef:ee,onSelect:function(e,t){("submit"===t||"key"!==t&&!Z)&&(_e(e),we(!1))},open:de,defaultOpenValue:O,onDateMouseEnter:Re,onDateMouseLeave:Te}},a.createElement(Y3,{visible:de,popupElement:Pe,popupStyle:d,prefixCls:n,dropdownClassName:c,dropdownAlign:u,getPopupContainer:N,transitionName:f,popupPlacement:je,direction:q},a.createElement("div",{ref:re,className:qL(n,l,(t={},cK(t,"".concat(n,"-disabled"),T),cK(t,"".concat(n,"-focused"),ke),cK(t,"".concat(n,"-rtl"),"rtl"===q),t)),style:s,onMouseDown:$,onMouseUp:function(){B&&B.apply(void 0,arguments),X.current&&(X.current.focus(),we(!0))},onMouseEnter:U,onMouseLeave:z,onContextMenu:H,onClick:W},a.createElement("div",{className:qL("".concat(n,"-input"),cK({},"".concat(n,"-input-placeholder"),!!Ie)),ref:te},a.createElement("input",aK({id:i,tabIndex:o,disabled:T,readOnly:g||"function"==typeof Q[0]||!xe,value:Ie||ve,onChange:function(e){ye(e.target.value)},autoFocus:v,placeholder:M,ref:X,title:ve},Ee,{size:z0(_,Q[0],h)},g1(e),{autoComplete:J})),Ne,De))))}var r5=function(e){OK(r,e);var t=RK(r);function r(){var e;CK(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).pickerRef=a.createRef(),e.focus=function(){e.pickerRef.current&&e.pickerRef.current.focus()},e.blur=function(){e.pickerRef.current&&e.pickerRef.current.blur()},e}return SK(r,[{key:"render",value:function(){return a.createElement(t5,aK({},this.props,{pickerRef:this.pickerRef}))}}]),r}(a.Component);function n5(e,t,r,n){var i=s1(e,r,n,1);function o(r){return r(e,t)?"same":r(i,t)?"closing":"far"}switch(r){case"year":return o((function(e,t){return function(e,t,r){var n=Z0(t,r);return"boolean"==typeof n?n:Math.floor(e.getYear(t)/10)===Math.floor(e.getYear(r)/10)}(n,e,t)}));case"quarter":case"month":return o((function(e,t){return Q0(n,e,t)}));default:return o((function(e,t){return r1(n,e,t)}))}}function i5(e){var t=e.values,r=e.picker,n=e.defaultDates,i=e.generateConfig,o=pK(a.useState((function(){return[m1(n,0),m1(n,1)]})),2),s=o[0],l=o[1],c=pK(a.useState(null),2),u=c[0],d=c[1],f=m1(t,0),h=m1(t,1);return[function(e){return s[e]?s[e]:m1(u,e)||function(e,t,r,n){var i=m1(e,0),o=m1(e,1);if(0===t)return i;if(i&&o)switch(n5(i,o,r,n)){case"same":case"closing":return i;default:return s1(o,r,n,-1)}return i}(t,e,r,i)||f||h||i.getNow()},function(e,r){if(e){var n=v1(u,e,r);l(v1(s,null,r)||[null,null]);var i=(r+1)%2;m1(t,i)||(n=v1(n,e,i)),d(n)}else(f||h)&&d(null)}]}function o5(e,t){return e&&e[0]&&e[1]&&t.isAfter(e[0],e[1])?[e[1],e[0]]:e}function a5(e,t,r,n){return!!(e||n&&n[t]||r[(t+1)%2])}function s5(e){var t,r,n,i=e.prefixCls,o=void 0===i?"rc-picker":i,s=e.id,l=e.style,c=e.className,u=e.popupStyle,d=e.dropdownClassName,f=e.transitionName,h=e.dropdownAlign,p=e.getPopupContainer,g=e.generateConfig,m=e.locale,v=e.placeholder,y=e.autoFocus,b=e.disabled,_=e.format,w=e.picker,C=void 0===w?"date":w,E=e.showTime,S=e.use12Hours,k=e.separator,x=void 0===k?"~":k,O=e.value,I=e.defaultValue,R=e.defaultPickerValue,T=e.open,A=e.defaultOpen,M=e.disabledDate,N=e.disabledTime,D=e.dateRender,P=e.panelRender,j=e.ranges,F=e.allowEmpty,V=e.allowClear,L=e.suffixIcon,$=e.clearIcon,B=e.pickerRef,U=e.inputReadOnly,z=e.mode,H=e.renderExtraFooter,W=e.onChange,G=e.onOpenChange,K=e.onPanelChange,q=e.onCalendarChange,Y=e.onFocus,J=e.onBlur,X=e.onMouseEnter,Z=e.onMouseLeave,Q=e.onOk,ee=e.onKeyDown,te=e.components,re=e.order,ne=e.direction,ie=e.activePickerIndex,oe=e.autoComplete,ae=void 0===oe?"off":oe,se="date"===C&&!!E||"time"===C,le=Object(a.useRef)({}),ce=Object(a.useRef)(null),ue=Object(a.useRef)(null),de=Object(a.useRef)(null),fe=Object(a.useRef)(null),he=Object(a.useRef)(null),pe=Object(a.useRef)(null),ge=Object(a.useRef)(null),me=p1(U0(_,C,E,S)),ve=pK(k0(0,{value:ie}),2),ye=ve[0],be=ve[1],_e=Object(a.useRef)(null),we=a.useMemo((function(){return Array.isArray(b)?b:[b||!1,b||!1]}),[b]),Ce=pK(k0(null,{value:O,defaultValue:I,postState:function(e){return"time"!==C||re?o5(e,g):e}}),2),Ee=Ce[0],Se=Ce[1],ke=pK(i5({values:Ee,picker:C,defaultDates:R,generateConfig:g}),2),xe=ke[0],Oe=ke[1],Ie=pK(k0(Ee,{postState:function(e){var t=e;if(we[0]&&we[1])return t;for(var r=0;r<2;r+=1)we[r]&&!m1(t,r)&&!m1(F,r)&&(t=v1(t,g.getNow(),r));return t}}),2),Re=Ie[0],Te=Ie[1],Ae=pK(k0([C,C],{value:z}),2),Me=Ae[0],Ne=Ae[1];Object(a.useEffect)((function(){Ne([C,C])}),[C]);var De=function(e,t){Ne(e),K&&K(t,e)},Pe=function(e,t,r){var n=e.picker,i=e.locale,o=e.selectedValue,s=e.disabledDate,l=e.disabled,c=e.generateConfig,u=m1(o,0),d=m1(o,1);function f(e){return c.locale.getWeekFirstDate(i.locale,e)}function h(e){return 100*c.getYear(e)+c.getMonth(e)}function p(e){return 10*c.getYear(e)+e1(c,e)}return[a.useCallback((function(e){if(s&&s(e))return!0;if(l[1]&&d)return!n1(c,e,d)&&c.isAfter(e,d);if(t&&d)switch(n){case"quarter":return p(e)>p(d);case"month":return h(e)>h(d);case"week":return f(e)>f(d);default:return!n1(c,e,d)&&c.isAfter(e,d)}return!1}),[s,l[1],d,t]),a.useCallback((function(e){if(s&&s(e))return!0;if(l[0]&&u)return!n1(c,e,d)&&c.isAfter(u,e);if(r&&u)switch(n){case"quarter":return p(e)<p(u);case"month":return h(e)<h(u);case"week":return f(e)<f(u);default:return!n1(c,e,u)&&c.isAfter(u,e)}return!1}),[s,l[0],u,r])]}({picker:C,selectedValue:Re,locale:m,disabled:we,disabledDate:M,generateConfig:g},le.current[1],le.current[0]),je=pK(Pe,2),Fe=je[0],Ve=je[1],Le=pK(k0(!1,{value:T,defaultValue:A,postState:function(e){return!we[ye]&&e},onChange:function(e){G&&G(e),!e&&_e.current&&_e.current.onClose&&_e.current.onClose()}}),2),$e=Le[0],Be=Le[1],Ue=$e&&0===ye,ze=$e&&1===ye,He=pK(Object(a.useState)(0),2),We=He[0],Ge=He[1];Object(a.useEffect)((function(){!$e&&ce.current&&Ge(ce.current.offsetWidth)}),[$e]);var Ke=a.useRef();function qe(e,t){if(e)clearTimeout(Ke.current),le.current[t]=!0,be(t),Be(e),$e||Oe(null,t);else if(ye===t){Be(e);var r=le.current;Ke.current=setTimeout((function(){r===le.current&&(le.current={})}))}}function Ye(e){qe(!0,e),setTimeout((function(){var t=[pe,ge][e];t.current&&t.current.focus()}),0)}function Je(e,t){var r=e,n=m1(r,0),i=m1(r,1);n&&i&&g.isAfter(n,i)&&("week"===C&&!i1(g,m.locale,n,i)||"quarter"===C&&!t1(g,n,i)||"week"!==C&&"quarter"!==C&&"time"!==C&&!n1(g,n,i)?(0===t?(r=[n,null],i=null):(n=null,r=[null,i]),le.current=cK({},t,!0)):("time"!==C||!1!==re)&&(r=o5(r,g))),Te(r);var o=r&&r[0]?l1(r[0],{generateConfig:g,locale:m,format:me[0]}):"",a=r&&r[1]?l1(r[1],{generateConfig:g,locale:m,format:me[0]}):"";q&&q(r,[o,a],{range:0===t?"start":"end"});var s=a5(n,0,we,F),l=a5(i,1,we,F);(null===r||s&&l)&&(Se(r),W&&(!o1(g,m1(Ee,0),n)||!o1(g,m1(Ee,1),i))&&W(r,[o,a]));var c=null;0!==t||we[1]?1===t&&!we[0]&&(c=0):c=1,null===c||c===ye||le.current[c]&&m1(r,c)||!m1(r,t)?qe(!1,t):Ye(c)}var Xe=function(e){return $e&&_e.current&&_e.current.onKeyDown?_e.current.onKeyDown(e):(BK(!1,"Picker not correct forward KeyDown operation. Please help to fire issue about this."),!1)},Ze={formatList:me,generateConfig:g,locale:m},Qe=pK(Q3(m1(Re,0),Ze),2),et=Qe[0],tt=Qe[1],rt=pK(Q3(m1(Re,1),Ze),2),nt=rt[0],it=rt[1],ot=function(e,t){var r=c1(e,{locale:m,formatList:me,generateConfig:g});r&&!(0===t?Fe:Ve)(r)&&(Te(v1(Re,r,t)),Oe(r,t))},at=pK(X3({valueTexts:et,onTextChange:function(e){return ot(e,0)}}),3),st=at[0],lt=at[1],ct=at[2],ut=pK(X3({valueTexts:nt,onTextChange:function(e){return ot(e,1)}}),3),dt=ut[0],ft=ut[1],ht=ut[2],pt=pK(Object(a.useState)(null),2),gt=pt[0],mt=pt[1],vt=pK(Object(a.useState)(null),2),yt=vt[0],bt=vt[1],_t=pK(e5(st,{formatList:me,generateConfig:g,locale:m}),3),wt=_t[0],Ct=_t[1],Et=_t[2],St=pK(e5(dt,{formatList:me,generateConfig:g,locale:m}),3),kt=St[0],xt=St[1],Ot=St[2],It=function(e,t){return{blurToCancel:se,forwardKeyDown:Xe,onBlur:J,isClickOutside:function(e){return!K0([ue.current,de.current,fe.current,ce.current],e)},onFocus:function(t){be(e),Y&&Y(t)},triggerOpen:function(t){qe(t,e)},onSubmit:function(){Je(Re,e),t()},onCancel:function(){qe(!1,e),Te(Ee),t()}}},Rt=pK(J3(mK(mK({},It(0,ct)),{},{open:Ue,value:st,onKeyDown:function(e,t){null==ee||ee(e,t)}})),2),Tt=Rt[0],At=Rt[1],Mt=At.focused,Nt=At.typing,Dt=pK(J3(mK(mK({},It(1,ht)),{},{open:ze,value:dt,onKeyDown:function(e,t){null==ee||ee(e,t)}})),2),Pt=Dt[0],jt=Dt[1],Ft=jt.focused,Vt=jt.typing,Lt=Ee&&Ee[0]?l1(Ee[0],{locale:m,format:"YYYYMMDDHHmmss",generateConfig:g}):"",$t=Ee&&Ee[1]?l1(Ee[1],{locale:m,format:"YYYYMMDDHHmmss",generateConfig:g}):"";Object(a.useEffect)((function(){$e||(Te(Ee),et.length&&""!==et[0]?tt!==st&&ct():lt(""),nt.length&&""!==nt[0]?it!==dt&&ht():ft(""))}),[$e,et,nt]),Object(a.useEffect)((function(){Te(Ee)}),[Lt,$t]),"production"!==Ni.exports.env.NODE_ENV&&O&&Array.isArray(b)&&(m1(b,0)&&!m1(O,0)||m1(b,1)&&!m1(O,1))&&BK(!1,"`disabled` should not set with empty `value`. You should set `allowEmpty` or `value` instead."),B&&(B.current={focus:function(){pe.current&&pe.current.focus()},blur:function(){pe.current&&pe.current.blur(),ge.current&&ge.current.blur()}});var Bt=Object.keys(j||{}).map((function(e){var t=j[e],r="function"==typeof t?t():t;return{label:e,onClick:function(){Je(r,null),qe(!1,ye)},onMouseEnter:function(){mt(r)},onMouseLeave:function(){mt(null)}}}));function Ut(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;$e&&yt&&yt[0]&&yt[1]&&g.isAfter(yt[1],yt[0])&&(n=yt);var i=E;if(E&&"object"===sK(E)&&E.defaultValue){var s=E.defaultValue;i=mK(mK({},E),{},{defaultValue:m1(s,ye)||void 0})}var l=null;return D&&(l=function(e,t){return D(e,t,{range:ye?"end":"start"})}),a.createElement(E1.Provider,{value:{inRange:!0,panelPosition:t,rangedValue:gt||Re,hoverRangedValue:n}},a.createElement(J1,aK({},e,r,{dateRender:l,showTime:i,mode:Me[ye],generateConfig:g,style:void 0,direction:ne,disabledDate:0===ye?Fe:Ve,disabledTime:function(e){return!!N&&N(e,0===ye?"start":"end")},className:qL(cK({},"".concat(o,"-panel-focused"),0===ye?!Nt:!Vt)),value:m1(Re,ye),locale:m,tabIndex:-1,onPanelChange:function(e,r){0===ye&&Et(!0),1===ye&&Ot(!0),De(v1(Me,r,ye),v1(Re,e,ye));var n=e;"right"===t&&Me[ye]===r&&(n=s1(n,r,g,-1)),Oe(n,ye)},onOk:null,onSelect:void 0,onChange:void 0,defaultValue:m1(Re,0===ye?1:0)})))}var zt=0,Ht=0;ye&&de.current&&he.current&&ue.current&&(zt=de.current.offsetWidth+he.current.offsetWidth,ue.current.offsetWidth&&zt>ue.current.offsetWidth&&(Ht=zt));var Wt="rtl"===ne?{right:zt}:{left:zt};var Gt,Kt,qt=a.createElement("div",{className:qL("".concat(o,"-range-wrapper"),"".concat(o,"-").concat(C,"-range-wrapper")),style:{minWidth:We}},a.createElement("div",{className:"".concat(o,"-range-arrow"),style:Wt}),function(){var e,t=q1(o,Me[ye],H),r=Y1({prefixCls:o,components:te,needConfirmButton:se,okDisabled:!m1(Re,ye)||M&&M(Re[ye]),locale:m,rangeList:Bt,onOk:function(){m1(Re,ye)&&(Je(Re,ye),Q&&Q(Re))}});if("time"===C||E)e=Ut();else{var n=xe(ye),i=s1(n,C,g),s=Me[ye]===C,l=Ut(!!s&&"left",{pickerValue:n,onPickerValueChange:function(e){Oe(e,ye)}}),c=Ut("right",{pickerValue:i,onPickerValueChange:function(e){Oe(s1(e,C,g,-1),ye)}});e="rtl"===ne?a.createElement(a.Fragment,null,c,s&&l):a.createElement(a.Fragment,null,l,s&&c)}var u=a.createElement(a.Fragment,null,a.createElement("div",{className:"".concat(o,"-panels")},e),(t||r)&&a.createElement("div",{className:"".concat(o,"-footer")},t,r));return P&&(u=P(u)),a.createElement("div",{className:"".concat(o,"-panel-container"),style:{marginLeft:Ht},ref:ue,onMouseDown:function(e){e.preventDefault()}},u)}());L&&(Gt=a.createElement("span",{className:"".concat(o,"-suffix")},L)),V&&(m1(Ee,0)&&!we[0]||m1(Ee,1)&&!we[1])&&(Kt=a.createElement("span",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseUp:function(e){e.preventDefault(),e.stopPropagation();var t=Ee;we[0]||(t=v1(t,null,0)),we[1]||(t=v1(t,null,1)),Je(t,null),qe(!1,ye)},className:"".concat(o,"-clear")},$||a.createElement("span",{className:"".concat(o,"-clear-btn")})));var Yt={size:z0(C,me[0],g)},Jt=0,Xt=0;de.current&&fe.current&&he.current&&(0===ye?Xt=de.current.offsetWidth:(Jt=zt,Xt=fe.current.offsetWidth));var Zt="rtl"===ne?{right:Jt}:{left:Jt};return a.createElement(O0.Provider,{value:{operationRef:_e,hideHeader:"time"===C,onDateMouseEnter:function(e){bt(v1(Re,e,ye)),0===ye?Ct(e):xt(e)},onDateMouseLeave:function(){bt(v1(Re,null,ye)),0===ye?Et():Ot()},hideRanges:!0,onSelect:function(e,t){var r=v1(Re,e,ye);"submit"===t||"key"!==t&&!se?(Je(r,ye),0===ye?Et():Ot()):Te(r)},open:$e}},a.createElement(Y3,{visible:$e,popupElement:qt,popupStyle:u,prefixCls:o,dropdownClassName:d,dropdownAlign:h,getPopupContainer:p,transitionName:f,range:!0,direction:ne},a.createElement("div",aK({ref:ce,className:qL(o,"".concat(o,"-range"),c,(t={},cK(t,"".concat(o,"-disabled"),we[0]&&we[1]),cK(t,"".concat(o,"-focused"),0===ye?Mt:Ft),cK(t,"".concat(o,"-rtl"),"rtl"===ne),t)),style:l,onClick:function(e){!$e&&!pe.current.contains(e.target)&&!ge.current.contains(e.target)&&(we[0]?we[1]||Ye(1):Ye(0))},onMouseEnter:X,onMouseLeave:Z,onMouseDown:function(e){$e&&(Mt||Ft)&&!pe.current.contains(e.target)&&!ge.current.contains(e.target)&&e.preventDefault()}},g1(e)),a.createElement("div",{className:qL("".concat(o,"-input"),(r={},cK(r,"".concat(o,"-input-active"),0===ye),cK(r,"".concat(o,"-input-placeholder"),!!wt),r)),ref:de},a.createElement("input",aK({id:s,disabled:we[0],readOnly:U||"function"==typeof me[0]||!Nt,value:wt||st,onChange:function(e){lt(e.target.value)},autoFocus:y,placeholder:m1(v,0)||"",ref:pe},Tt,Yt,{autoComplete:ae}))),a.createElement("div",{className:"".concat(o,"-range-separator"),ref:he},x),a.createElement("div",{className:qL("".concat(o,"-input"),(n={},cK(n,"".concat(o,"-input-active"),1===ye),cK(n,"".concat(o,"-input-placeholder"),!!kt),n)),ref:fe},a.createElement("input",aK({disabled:we[1],readOnly:U||"function"==typeof me[0]||!Vt,value:kt||dt,onChange:function(e){ft(e.target.value)},placeholder:m1(v,1)||"",ref:ge},Pt,Yt,{autoComplete:ae}))),a.createElement("div",{className:"".concat(o,"-active-bar"),style:mK(mK({},Zt),{},{width:Xt,position:"absolute"})}),Gt,Kt)))}var l5=function(e){OK(r,e);var t=RK(r);function r(){var e;CK(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).pickerRef=a.createRef(),e.focus=function(){e.pickerRef.current&&e.pickerRef.current.focus()},e.blur=function(){e.pickerRef.current&&e.pickerRef.current.blur()},e}return SK(r,[{key:"render",value:function(){return a.createElement(s5,aK({},this.props,{pickerRef:this.pickerRef}))}}]),r}(a.Component);function c5(e,t,r){return void 0!==r?r:"year"===e&&t.lang.yearPlaceholder?t.lang.yearPlaceholder:"quarter"===e&&t.lang.quarterPlaceholder?t.lang.quarterPlaceholder:"month"===e&&t.lang.monthPlaceholder?t.lang.monthPlaceholder:"week"===e&&t.lang.weekPlaceholder?t.lang.weekPlaceholder:"time"===e&&t.timePickerLocale.placeholder?t.timePickerLocale.placeholder:t.lang.placeholder}function u5(e,t,r){return void 0!==r?r:"year"===e&&t.lang.yearPlaceholder?t.lang.rangeYearPlaceholder:"month"===e&&t.lang.monthPlaceholder?t.lang.rangeMonthPlaceholder:"week"===e&&t.lang.weekPlaceholder?t.lang.rangeWeekPlaceholder:"time"===e&&t.timePickerLocale.placeholder?t.timePickerLocale.rangePlaceholder:t.lang.rangePlaceholder}var d5=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const f5={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z"}}]},name:"swap-right",theme:"outlined"};var h5=function(e,t){return a.createElement(xQ,mK(mK({},e),{},{ref:t,icon:f5}))};h5.displayName="SwapRightOutlined";const p5=a.forwardRef(h5);var g5=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};var m5={button:function(e){return a.createElement(n0,aK({size:"small",type:"primary"},e))},rangeItem:function(e){return a.createElement(h0,aK({color:"blue"},e))}};function v5(e){var t=e.format,r=e.picker,n=e.showHour,i=e.showMinute,o=e.showSecond,a=e.use12Hours,s=function(e){return e?Array.isArray(e)?e:[e]:[]}(t)[0],l=aK({},e);return s&&"string"==typeof s&&(!s.includes("s")&&void 0===o&&(l.showSecond=!1),!s.includes("m")&&void 0===i&&(l.showMinute=!1),!s.includes("H")&&!s.includes("h")&&void 0===n&&(l.showHour=!1),(s.includes("a")||s.includes("A"))&&void 0===a&&(l.use12Hours=!0)),"time"===r?l:("function"==typeof s&&delete l.format,{showTime:l})}!function(e,t){e.exports=function(e){function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e),n={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var r=100*e+t;return r<600?"凌晨":r<900?"早上":r<1100?"上午":r<1300?"中午":r<1800?"下午":"晚上"}};return r.default.locale(n,null,!0),n}(yf.exports)}({exports:{}});var y5,b5={},_5={},w5={};var C5,E5={},S5={exports:{}};function k5(){return C5||(C5=1,function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(this,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(S5)),S5.exports}var x5,O5={};var I5,R5,T5={};function A5(){return I5||(I5=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};e.default=t}(T5)),T5}function M5(){return R5||(R5=1,function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(k5()),n=t(function(){if(x5)return O5;x5=1,Object.defineProperty(O5,"__esModule",{value:!0}),O5.default=void 0;var e={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};return O5.default=e,O5}()),i=t(A5()),o={lang:(0,r.default)({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},n.default),timePickerLocale:(0,r.default)({},i.default)};e.default=o}(E5)),E5}var N5,D5,P5={};function j5(){return D5||(D5=1,function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t((y5||(y5=1,Object.defineProperty(w5,"__esModule",{value:!0}),w5.default=void 0,w5.default={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"}),w5)),n=t(M5()),i=t(A5()),o=t((N5||(N5=1,function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(M5()).default;e.default=r}(P5)),P5)),a="${label} is not a valid ${type}",s={locale:"en",Pagination:r.default,DatePicker:n.default,TimePicker:i.default,Calendar:o.default,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:a,method:a,array:a,object:a,number:a,date:a,boolean:a,integer:a,float:a,regexp:a,email:a,url:a,hex:a},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"}};e.default=s}(_5)),_5}!function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(j5()).default;e.default=r}(b5);const F5=Ti(b5);var V5,L5={},$5={};var B5,U5={},z5={};var H5,W5,G5={};function K5(){return H5||(H5=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};e.default=t}(G5)),G5}function q5(){return W5||(W5=1,function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(k5()),n=t(function(){if(B5)return z5;B5=1,Object.defineProperty(z5,"__esModule",{value:!0}),z5.default=void 0;var e={locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"};return z5.default=e,z5}()),i=t(K5()),o={lang:(0,r.default)({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeWeekPlaceholder:["开始周","结束周"]},n.default),timePickerLocale:(0,r.default)({},i.default)};o.lang.ok="确 定";var a=o;e.default=a}(U5)),U5}var Y5,J5={};!function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t((V5||(V5=1,Object.defineProperty($5,"__esModule",{value:!0}),$5.default=void 0,$5.default={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"}),$5)),n=t(q5()),i=t(K5()),o=t((Y5||(Y5=1,function(e){var t=IG.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(q5()).default;e.default=r}(J5)),J5)),a="${label}不是一个有效的${type}",s={locale:"zh-cn",Pagination:r.default,DatePicker:n.default,TimePicker:i.default,Calendar:o.default,global:{placeholder:"请选择"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开"},PageHeader:{back:"返回"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:a,method:a,array:a,object:a,number:a,date:a,boolean:a,integer:a,float:a,regexp:a,email:a,url:a,hex:a},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"}};e.default=s}(L5);const X5=Ti(L5);var Z5=jG(),Q5=NG();bf.extend(Q5),bf.extend(Z5);const e6=function(e){var t=function(e){function t(t,r){var n=function(n){OK(o,n);var i=RK(o);function o(n){var s;return CK(this,o),(s=i.call(this,n)).pickerRef=a.createRef(),s.focus=function(){s.pickerRef.current&&s.pickerRef.current.focus()},s.blur=function(){s.pickerRef.current&&s.pickerRef.current.blur()},s.renderPicker=function(r){var n=aK(aK({},r),s.props.locale),i=s.context,o=i.getPrefixCls,l=i.direction,c=i.getPopupContainer,u=s.props,d=u.prefixCls,f=u.getPopupContainer,h=u.className,p=u.size,g=u.bordered,m=void 0===g||g,v=u.placeholder,y=d5(u,["prefixCls","getPopupContainer","className","size","bordered","placeholder"]),b=s.props,_=b.format,w=b.showTime,C=o("picker",d),E={showToday:!0},S={};t&&(S.picker=t);var k=t||s.props.picker;S=aK(aK(aK({},S),w?v5(aK({format:_,picker:k},w)):{}),"time"===k?v5(aK(aK({format:_},s.props),{picker:k})):{});var x=o();return a.createElement(_Y.Consumer,null,(function(t){var r,i=p||t;return a.createElement(r5,aK({ref:s.pickerRef,placeholder:c5(k,n,v),suffixIcon:"time"===k?a.createElement(b0,null):a.createElement(m0,null),clearIcon:a.createElement(AQ,null),allowClear:!0,transitionName:"".concat(x,"-slide-up")},E,y,S,{locale:n.lang,className:qL((r={},cK(r,"".concat(C,"-").concat(i),i),cK(r,"".concat(C,"-borderless"),!m),r),h),prefixCls:C,getPopupContainer:f||c,generateConfig:e,prevIcon:a.createElement("span",{className:"".concat(C,"-prev-icon")}),nextIcon:a.createElement("span",{className:"".concat(C,"-next-icon")}),superPrevIcon:a.createElement("span",{className:"".concat(C,"-super-prev-icon")}),superNextIcon:a.createElement("span",{className:"".concat(C,"-super-next-icon")}),components:m5,direction:l}))}))},nY("quarter"!==t,r,"DatePicker.".concat(r," is legacy usage. Please use DatePicker[picker='").concat(t,"'] directly.")),s}return SK(o,[{key:"render",value:function(){return a.createElement(cY,{componentName:"DatePicker",defaultLocale:oY},this.renderPicker)}}]),o}(a.Component);return n.contextType=yY,r&&(n.displayName=r),n}return{DatePicker:t(),WeekPicker:t("week","WeekPicker"),MonthPicker:t("month","MonthPicker"),YearPicker:t("year","YearPicker"),TimePicker:t("time","TimePicker"),QuarterPicker:t("quarter","QuarterPicker")}}(e),r=t.DatePicker,n=t.WeekPicker,i=t.MonthPicker,o=t.YearPicker,s=t.TimePicker,l=t.QuarterPicker,c=function(e){var t=function(t){OK(n,t);var r=RK(n);function n(){var t;return CK(this,n),(t=r.apply(this,arguments)).pickerRef=a.createRef(),t.focus=function(){t.pickerRef.current&&t.pickerRef.current.focus()},t.blur=function(){t.pickerRef.current&&t.pickerRef.current.blur()},t.renderPicker=function(r){var n=aK(aK({},r),t.props.locale),i=t.context,o=i.getPrefixCls,s=i.direction,l=i.getPopupContainer,c=t.props,u=c.prefixCls,d=c.getPopupContainer,f=c.className,h=c.size,p=c.bordered,g=void 0===p||p,m=c.placeholder,v=g5(c,["prefixCls","getPopupContainer","className","size","bordered","placeholder"]),y=t.props,b=y.format,_=y.showTime,w=y.picker,C=o("picker",u),E={};E=aK(aK(aK({},E),_?v5(aK({format:b,picker:w},_)):{}),"time"===w?v5(aK(aK({format:b},t.props),{picker:w})):{});var S=o();return a.createElement(_Y.Consumer,null,(function(r){var i,o=h||r;return a.createElement(l5,aK({separator:a.createElement("span",{"aria-label":"to",className:"".concat(C,"-separator")},a.createElement(p5,null)),ref:t.pickerRef,placeholder:u5(w,n,m),suffixIcon:"time"===w?a.createElement(b0,null):a.createElement(m0,null),clearIcon:a.createElement(AQ,null),allowClear:!0,transitionName:"".concat(S,"-slide-up")},v,E,{className:qL((i={},cK(i,"".concat(C,"-").concat(o),o),cK(i,"".concat(C,"-borderless"),!g),i),f),locale:n.lang,prefixCls:C,getPopupContainer:d||l,generateConfig:e,prevIcon:a.createElement("span",{className:"".concat(C,"-prev-icon")}),nextIcon:a.createElement("span",{className:"".concat(C,"-next-icon")}),superPrevIcon:a.createElement("span",{className:"".concat(C,"-super-prev-icon")}),superNextIcon:a.createElement("span",{className:"".concat(C,"-super-next-icon")}),components:m5,direction:s}))}))},t}return SK(n,[{key:"render",value:function(){return a.createElement(cY,{componentName:"DatePicker",defaultLocale:oY},this.renderPicker)}}]),n}(a.Component);return t.contextType=yY,t}(e),u=r;return u.WeekPicker=n,u.MonthPicker=i,u.YearPicker=o,u.RangePicker=c,u.TimePicker=s,u.QuarterPicker=l,u}(GG),t6="zhCN"===Dh._lang?X5:F5,r6=({id:e,onChange:t=(()=>{}),defaultValue:r,value:n,focus:i,renderMode:o,rectStyle:l={},...c})=>{const u=HL(lp),[d,f]=wG({value:n,defaultValue:r,onChange:t}),h=Object(a.useRef)(null),p=Object(a.useMemo)((()=>d?bf(d):""),[d]);return Object(a.useEffect)((()=>{i&&h.current&&setTimeout((()=>{var e;null==(e=h.current)||e.focus()}),30)}),[i]),s.a.createElement("div",{className:`lakex-table-form-date lakex-table-form-date-render-mode-${o}`,id:e},s.a.createElement(e6,{ref:h,defaultValue:p,value:p,autoFocus:i,onChange:(...e)=>{const[,t]=e;f(t)},style:{...l},...c,locale:t6.DatePicker,getPopupContainer:()=>(null==u?void 0:u.getValue("modal.customModalContainer"))||document.body}))},n6=({value:e,showEmpty:t})=>{const r=HL(PH);if(!e)return t?s.a.createElement(kG,null):null;return s.a.createElement("div",{className:"lakex-table-form-email-readonly"},s.a.createElement("span",{className:"lakex-table-form-email-text"},e),s.a.createElement(XU,{className:"lakex-table-form-email-action",type:"FieldEmail",onClick:t=>{t.stopPropagation(),null==r||r.open("email","mailto:"+e)}}))},i6=e=>{const{id:t,defaultValue:r="",focus:n,onBlur:i,renderMode:o,prefix:l}=e,c=Object(a.useRef)(null),[d,f]=wG({value:e.value,defaultValue:e.defaultValue,onChange:e.onChange}),h=HL(PH);Object(a.useEffect)((()=>{n&&c.current&&c.current.focus({cursor:"end"})}),[n]);const p=null!==l?l:s.a.createElement(XU,{type:"FieldEmail",size:14});return s.a.createElement("div",{className:`lakex-table-form-email lakex-table-form-email-render-mode-${o}`,id:t},s.a.createElement(u.a,{allowClear:o!==Vz.LITE,value:d,defaultValue:r,type:"text",placeholder:Ph("请输入"),prefix:p,onChange:t=>{var r;const n=t.target.value;f(n),null==(r=e.onChange)||r.call(e,n)},onBlur:i,suffix:s.a.createElement(XU,{className:qL("lakex-table-form-email-action",{hasValue:d}),type:"FieldEmail",onClick:e=>{e.stopPropagation(),null==h||h.open("email","mailto:"+d)}}),autoFocus:n,ref:c}))},o6=$i.defineToken("ImageContribution");var a6=Object.defineProperty,s6=Object.getOwnPropertyDescriptor,l6=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?s6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&a6(t,r,o),o};let c6=class{getProvider(){const e=this.imageProvider.getContributions()||[],t=e[e.length-1];return null==t?void 0:t.registerImage()}};l6([wh(o6)],c6.prototype,"imageProvider",2),c6=l6([io()],c6);var u6=Object.defineProperty,d6=Object.getOwnPropertyDescriptor,f6=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?d6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&u6(t,r,o),o};let h6=class{get _provider(){return this._imageRegistry.getProvider()}getExts(){var e;return null!=(e=this._provider)&&e.getExts?this._provider.getExts():YH.IMAGE_EXT.join(",")}isImage(e){var t;if(null==(t=this._provider)||!t.isImage)try{const t=new URL(e);return ZH(t.origin+t.pathname)}catch{return!1}return this._provider.isImage(e)}tryGetWebp(e,t,r){var n;return null!=(n=this._provider)&&n.tryGetWebp?this._provider.tryGetWebp(e,t,r):e}viewImage(e,t){var r;null==(r=this._provider)||!r.viewImage||this._provider.viewImage(e,t)}getThumbnailUrl(e,t,r,n){var i;return null!=(i=this._provider)&&i.getThumbnailUrl?this._provider.getThumbnailUrl(e,t,r,n):e}};f6([ao(c6)],h6.prototype,"_imageRegistry",2),h6=f6([io()],h6);const p6=xo().contribution(o6).register(c6).register(h6),g6=({type:e="file",file:t,list:r=[],size:n=32})=>{const i=HL(PH),o=HL(nW),a=HL(h6);let l,c=t.src;if(!c)return null;if("file"===e){const e=null==o?void 0:o.getFileKey(t);e&&(l=t=>s.a.createElement(ZU,{ext:e,...t,size:n}))}else c=(null==a?void 0:a.getThumbnailUrl(c,t.width,t.height,n))||c,l=e=>s.a.createElement("img",{loading:"lazy",src:c,...e});return s.a.createElement("div",{className:`lakex-table-simple-file-item ${e}`,"data-id":t.uid},s.a.createElement("div",{className:"lakex-table-simple-file-img"},l&&s.a.createElement(l,{className:`lakex-table-simple-file-${e}`,onClick:n=>{n.preventDefault(),n.stopPropagation();let o={};"image"===e?o={list:r,index:r.findIndex((e=>e.src===t.src))}:"file"===e&&(o={size:t.size}),null==i||i.open(e,t.src,o)}})),s.a.createElement("div",{className:"lakex-table-simple-file-name"},t.name))},m6=({id:e,value:t=[]})=>{var r;return t?s.a.createElement("div",{className:"lakex-table-file-list",id:e},null==(r=t.map)?void 0:r.call(t,((e,t)=>s.a.createElement(g6,{key:e.uid||t,type:"file",file:e,size:24})))):null};var v6=(e=>(e.IMAGE="image",e.FILE="file",e))(v6||{}),y6=(e=>(e.PENDING="pending",e.RUNNING="running",e.SUCCESS="success",e.ERROR="error",e.ABORTED="aborted",e.TIMEOUT="timeout",e))(y6||{});const b6=$i.defineToken("UploadContribution");var _6=Object.defineProperty,w6=Object.getOwnPropertyDescriptor,C6=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?w6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_6(t,r,o),o};let E6=class{getUploader(){if(this._uploader)return this._uploader;const e=this.uploadProvider.getContributions(),t=e[e.length-1];return this._uploader=t.registerUpload(),this._uploader}};C6([wh(b6)],E6.prototype,"uploadProvider",2),E6=C6([io()],E6);var S6=Object.defineProperty,k6=Object.getOwnPropertyDescriptor,x6=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?k6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&S6(t,r,o),o};let O6=class extends fp{constructor(){super(...arguments),this._onDidChange=this._register(new _p),this.onDidChange=this._onDidChange.event,this._fileMap={}}async beforeUpload(e){}init(){this.uploadTask=this.taskService.createQueueTask({name:this.name})}async uploadFile(e,t){e.uid=(null==e?void 0:e.uid)||To();const r=this._uploadRegistry.getUploader();r.checkSize&&r.checkSize(e,this.code);try{await this.beforeUpload(e)}catch(t){return console.error(t),m.a.error(Ph("文件读取失败，请重新上传")),void this._onDidChange.emit({status:y6.ERROR,file:e})}!r.upload||r.upload(e,this.type,(e=>{e.status===y6.RUNNING&&e.percent?t.onProcess(e.percent):e.status===y6.SUCCESS?t.onSuccess():e.status===y6.ERROR&&t.onError(),this._onDidChange.emit(e)}))}addFile(e){return e.uid=(null==e?void 0:e.uid)||To(),this._fileMap[e.uid]=e,this.uploadTask.addJob(e.uid,(async e=>{await this.uploadFile(this._fileMap[e.jobId],e)})),this}destroy(){super.destroy(),this.uploadTask.destroy()}};x6([ao(EI)],O6.prototype,"taskService",2),x6([ao(lp)],O6.prototype,"configuration",2),x6([ao(E6)],O6.prototype,"_uploadRegistry",2),x6([Oi()],O6.prototype,"init",1),x6([Ii()],O6.prototype,"destroy",1),O6=x6([no()],O6);var I6=Object.defineProperty,R6=Object.getOwnPropertyDescriptor;let T6=class extends O6{constructor(){super(...arguments),this.name=Ph("图片上传任务"),this.type=v6.IMAGE,this.maxSizeCode="max_single_image_size"}beforeUpload(e){return new Promise(((t,r)=>{const n=new FileReader;n.addEventListener("load",(r=>{const n=()=>{this._onDidChange.emit({status:y6.RUNNING,file:e}),t(e)};if(r.target){const i=new Image;i.src=r.target.result,i.onload=()=>{e.width=i.width,e.height=i.height,n()},i.onerror=()=>{this._onDidChange.emit({status:y6.ERROR,file:e}),t(e)}}else n()}),!1),n.addEventListener("error",(()=>{r(e)})),n.readAsDataURL(e)}))}};T6=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?R6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&I6(t,r,o),o})([io()],T6);var A6=Object.defineProperty,M6=Object.getOwnPropertyDescriptor;let N6=class extends O6{constructor(){super(...arguments),this.name=Ph("附件上传任务"),this.type=v6.FILE,this.maxSizeCode="max_single_file_size"}};N6=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?M6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&A6(t,r,o),o})([io()],N6);var D6=Object.defineProperty,P6=Object.getOwnPropertyDescriptor,j6=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?P6(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&D6(t,r,o),o};let F6=class{initConfiguration(){this._configuration.registerConfiguration({id:"upload",type:"object",title:"上传",properties:{image:{type:"object",properties:{accept:{type:"string",description:"图片可接受的格式"}}},file:{type:"object",properties:{accept:{type:"string",description:"文件可接受的格式"}}}}}),this._configuration.registerDefaultValue({"upload.image.accept":this._imageService.getExts(),"upload.file.accept":this._fileService.getExts()})}getAccept(e){return e===v6.IMAGE?this._configuration.getValue("upload.image.accept"):e===v6.FILE?this._configuration.getValue("upload.file.accept"):void 0}uploadImage(e){return this.imageUploadTask.addFile(e)}uploadFile(e){return this.fileUploadTask.addFile(e)}};j6([ao(lp)],F6.prototype,"_configuration",2),j6([ao(nW)],F6.prototype,"_fileService",2),j6([ao(h6)],F6.prototype,"_imageService",2),j6([ao(N6)],F6.prototype,"fileUploadTask",2),j6([ao(T6)],F6.prototype,"imageUploadTask",2),F6=j6([io()],F6);const V6=xo().contribution(b6).register(E6).register(F6).register(N6).register(T6),L6=({onRetry:e,onRemove:t})=>s.a.createElement("div",{className:"lakex-table-file-upload-error"},s.a.createElement(XU,{className:"remove-file-icon",type:"Delete",onClick:t}),Ph("上传失败"),s.a.createElement("div",{className:"re-upload-file",onClick:e},Ph("重新上传"))),$6=({file:e,list:t=[],type:r="file",readonly:n,onRemove:i=(()=>{})})=>{const o=HL(PH),a=HL(nW),l=HL(h6);let c,u=e.src;if(!u)return null;if("file"===r){const t=null==a?void 0:a.getFileKey(e);t&&(c=e=>s.a.createElement(ZU,{ext:t,...e}))}else u=(null==l?void 0:l.getThumbnailUrl(u,e.width,e.height,150))||u,c=e=>s.a.createElement("img",{loading:"lazy",src:u,...e});return s.a.createElement("div",{className:qL("lakex-table-file-item"),"data-id":e.uid},s.a.createElement("div",{className:`lakex-table-file-${r}`},c&&s.a.createElement(c,{className:"lakex-table-file-item-image",size:120}),s.a.createElement("div",{className:"lakex-table-file-actions"},s.a.createElement(XU,{type:"Preview",onClick:n=>{let i={};"image"===r?i={list:t,index:t.findIndex((t=>t.src===e.src))}:"file"===r&&(i={size:e.size}),null==o||o.open(r,e.src,i)}}),s.a.createElement(XU,{type:"Download",onClick:()=>{return t=e.src,void window.open(t,"_blank");var t}}),!n&&s.a.createElement(XU,{type:"Delete",onClick:()=>i(e)}))),s.a.createElement("div",{className:"lakex-table-file-name"},e.name))},B6=({percent:e})=>s.a.createElement("div",{className:"lakex-table-file-uploading-file"},parseFloat(e.toFixed(2)),"%",s.a.createElement(v.a,{indicator:s.a.createElement(XU,{className:"lakex-table-file-uploading-icon",type:"Loading"})})),U6=()=>s.a.createElement("div",{className:"lakex-table-file-uploading-file"},0,"%",s.a.createElement(v.a,{indicator:s.a.createElement(XU,{className:"lakex-table-file-uploading-icon",type:"Loading"})})),z6=({event:e,type:t,list:r,onRemove:n=(()=>{}),onRetry:i=(()=>{})})=>{const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:u,isDragging:d}=HU({id:e.file.uid}),f={transform:y$.Transform.toString(c),transition:u,zIndex:d?"100":"auto",opacity:d?.3:1};let h=null;return e.status===y6.SUCCESS?h=s.a.createElement($6,{type:t,key:e.file.uid,file:e.file,list:r.filter((e=>e.status===y6.SUCCESS)).map((e=>e.file)),onRemove:n}):e.status===y6.RUNNING?h=s.a.createElement(B6,{key:e.file.uid,percent:e.percent||0}):e.status===y6.PENDING?h=s.a.createElement(U6,null):e.status===y6.ERROR&&(h=s.a.createElement(L6,{onRemove:()=>n(e.file),onRetry:()=>i(e.file)})),s.a.createElement("div",{ref:l,style:{...f},...a,...o},h)},H6=({id:e,type:t,list:r,onDragEnd:n=(()=>{}),onRemove:i=(()=>{}),onRetry:o=(()=>{})})=>{const l=Object(a.useMemo)((()=>r.map((e=>({...e,id:e.file.uid||To()})))),[r]),{activeId:c,sensors:u,handleDragStart:d,handleDragEnd:f}=(e=>{const[t,r]=Object(a.useState)(null);return{activeId:t,sensors:M$(A$(OB,{activationConstraint:{distance:8}})),handleDragStart:e=>{r(e.active.id)},handleDragEnd:async t=>{r(null);const{active:n,over:i}=t;n.id!==i.id&&e(n.id,i.id)}}})(n),h=Object(a.useMemo)((()=>r.find((e=>e.file.uid===c))),[c,r]);return s.a.createElement("div",{id:e},s.a.createElement(lU,{sensors:u,collisionDetection:B$,onDragStart:d,onDragEnd:f},s.a.createElement(FU,{items:l,strategy:MU},s.a.createElement("div",{className:"lakex-table-file"},r.map(((e,n)=>s.a.createElement("div",{key:e.id||n,className:"lakex-table-file-item-wrap"},s.a.createElement(z6,{event:e,type:t,list:r,onRemove:i,onRetry:o})))))),s.a.createElement(xU,{dropAnimation:null},h?s.a.createElement(z6,{event:h,type:t,list:r,onRemove:i,onRetry:o}):null)))},{Dragger:W6}=y.a,G6=e=>{var t;return(null==(t=null==e?void 0:e.map)?void 0:t.call(e,(e=>({id:e.uid,status:y6.SUCCESS,file:e}))))||[]},K6=({id:e=To(32),type:t=v6.IMAGE,files:r,className:n,onChange:i=(()=>{}),onCreate:o=(()=>{}),onRemove:l=(()=>{}),onOrderChange:c=(()=>{})})=>{const u=bG((e=>{i(e)}),300),d=Object(a.useRef)(null),f=dz(),h=HL(F6),p=null==h?void 0:h.getAccept(t),[g,v]=Object(a.useState)(G6(r)),_=Object(a.useRef)(G6(r)),[w,C]=Object(a.useState)(0===g.length);Object(a.useEffect)((()=>{const e=G6(r);v(e),_.current=e}),[r]);const E=e=>{e.status===y6.ERROR&&m.a.error(e.message||Ph("上传失败，请重试"));const t=_.current,r=t.findIndex((t=>t.file.uid===e.file.uid));r>-1?(e.id=e.file.uid,t[r]=e):t.push(e),e.status===y6.SUCCESS&&o(e.file),_.current=t,k(t)};Object(a.useEffect)((()=>{null==h||h.imageUploadTask.onDidChange((t=>{t.file.uploadId===e&&E(t)})),null==h||h.fileUploadTask.onDidChange((t=>{t.file.uploadId===e&&E(t)}))}),[]);const S=Object(a.useCallback)((r=>{r.uploadId=e,"image"===t?null==h||h.uploadImage(r):"file"===t&&(null==h||h.uploadFile(r))}),[]),k=Object(a.useCallback)((e=>{const t=e.filter((e=>e.status===y6.SUCCESS)).map((e=>e.file));g.map((e=>e.file.uid)).join(",")!==t.map((e=>e.uid)).join(",")&&u(t),v(e),C(0===e.length),f()}),[g]),x=fa.isMobile?"lakex-table-file-manage-component-h5":"";return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:qL("lakex-table-file-manage-component",x,n)},s.a.createElement("div",{onClick:()=>{var e;null==(e=d.current)||e.focus()},onPaste:e=>{var t;e.preventDefault(),e.stopPropagation();const r=null==(t=e.clipboardData)?void 0:t.files;if(!r||!r.length)return void m.a.error(Ph("剪贴板里没有文件可粘贴"));const n=Array.from(r);null==n||n.forEach((e=>S(e)))},className:"lakex-table-file-manage-component-upload"},s.a.createElement("input",{className:"lakex-table-file-manage-component-paste-container",ref:d}),s.a.createElement(W6,{showUploadList:!1,customRequest:e=>S(e.file),accept:p,openFileDialogOnClick:!1,multiple:!0},s.a.createElement("div",{className:w?"lakex-table-file-manage-component-empty-content":"lakex-table-file-manage-component-content"},s.a.createElement(XU,{type:"EditorPaste",size:22}),s.a.createElement("span",{className:"lakex-table-file-manage-component-title"},Ph("直接粘贴或拖拽到这里")),s.a.createElement(y.a,{customRequest:e=>S(e.file),accept:p,showUploadList:!1,multiple:!0},s.a.createElement(b.a,{className:"lakex-table-file-manage-component-upload-button"},s.a.createElement(XU,{className:"lakex-table-file-manage-component-plus-icon",type:"Add",size:18}),s.a.createElement("div",{className:"lakex-table-file-manage-component-button-title"},Ph("本地上传"))))))),!w&&s.a.createElement(H6,{type:t,list:g,onRemove:e=>{const t=[...g],r=t.findIndex((t=>t.file.uid===e.uid));r>-1&&(t.splice(r,1),_.current=t,k(t),l(e))},onRetry:e=>{S(e)},onDragEnd:(e,t)=>{const r=g.findIndex((e=>e.file.uid===t)),n=g.findIndex((t=>t.file.uid===e)),i=[...g],[o]=i.splice(r,1);i.splice(n,0,o),_.current=i,c({targetUid:e,sourceUid:t}),k(i)}})))},q6=({id:e,onChange:t,defaultValue:r,onCreate:n=(()=>{}),onUpdate:i=(()=>{}),onRemove:o=(()=>{}),onOrderChange:a=(()=>{}),style:l})=>s.a.createElement("div",{className:"lakex-table-file-form-upload",style:l||{}},s.a.createElement(K6,{id:e||To(6),type:v6.FILE,onChange:t,onCreate:n,onUpdate:i,onRemove:o,onOrderChange:a,files:r})),Y6=({id:e,onChange:t,defaultValue:r,onCreate:n=(()=>{}),onUpdate:i=(()=>{}),onRemove:o=(()=>{}),onOrderChange:a=(()=>{}),style:l})=>s.a.createElement("div",{className:"lakex-table-file-form-upload",style:l||{}},s.a.createElement(K6,{id:e,type:v6.IMAGE,onChange:t,onCreate:n,onUpdate:i,onRemove:o,onOrderChange:a,files:r})),J6=({id:e,value:t})=>{var r;return t?s.a.createElement("div",{className:"lakex-table-image-list",id:e},null==(r=t.map)?void 0:r.call(t,((e,r)=>s.a.createElement(g6,{key:e.uid||r,type:"image",file:e,list:t})))):null},X6=e=>{const{onClick:t=(()=>{}),list:r,onUnSelect:n=(()=>{}),onMentionTagClick:i=(()=>{}),writeable:o,showPlaceholder:a,hideDropdownIcon:l}=e;let c=null;return c=r&&0!==r.length||!a?s.a.createElement("div",{className:"lakex-table-form-mention-tag-wrap"},null==r?void 0:r.map((e=>e?s.a.createElement("span",{className:"lakex-table-form-mention-tag",key:e.uid,onClick:t=>{i(e)}},s.a.createElement("img",{className:"lakex-table-form-mention-tag-avatar",src:e.icon}),s.a.createElement("span",{className:"lakex-table-form-mention-tag-name"},e.name),o&&s.a.createElement("span",{className:"lakex-table-form-mention-tag-close",onClick:t=>{t.stopPropagation(),n(e,t)}},s.a.createElement(XU,{type:"Close"}))):null))):s.a.createElement("p",{className:"lakex-table-form-mention-placeholder"},Ph("请选择")),s.a.createElement("div",{className:qL("lakex-table-form-mention-content",{writeable:o}),onClick:t},c,o&&!l&&s.a.createElement("span",{className:"lakex-table-form-mention-caret-down",onClick:e.onClickDropDownIcon},s.a.createElement(XU,{type:"ReviewArrowDown",size:16})))};X6.defaultProps={writeable:!1,showPlaceholder:!0};const Z6=({isSelected:e,user:t,onSelect:r=(()=>{}),onUnselect:n=(()=>{})})=>{const i=qL("lakex-table-form-mention-selector-item",{selected:e});return s.a.createElement("div",{onClick:i=>{e?n(t):r(t)},className:i},s.a.createElement("div",{className:"lakex-table-form-mention-selector-content"},s.a.createElement("span",{className:"lakex-table-form-mention-selector-avatar"},s.a.createElement("img",{src:t.icon})),s.a.createElement("div",null,s.a.createElement("div",{className:"lakex-table-form-mention-selector-name"},t.name),s.a.createElement("div",{className:"lakex-table-form-mention-selector-login"},t.login))),e&&s.a.createElement(XU,{type:"Check"}))},Q6=({list:e,highlightId:t,selectedIds:r,emptyText:n=Ph("未搜索到结果"),onSelect:i,onUnselect:o})=>((({highlightId:e})=>{Object(a.useEffect)((()=>{const e=document.querySelector(".lakex-table-form-mention-selector-list");if(!e)return;const t=document.querySelector(".highlight");if(!t)return;const r=t.offsetTop-38,n=r+t.getBoundingClientRect().height;r<e.scrollTop?e.scrollTop-=e.scrollTop-r:n-e.scrollTop>e.getBoundingClientRect().height&&(e.scrollTop=n-e.getBoundingClientRect().height)}),[e])})({highlightId:t}),e&&e.length>0?s.a.createElement("ul",{className:"lakex-table-form-mention-selector-list"},e.map((e=>{if(!e)return null;const n=qL({highlight:t===e.uid});return s.a.createElement("li",{key:e.uid,className:n},s.a.createElement(Z6,{isSelected:r.includes(e.uid),onSelect:i,onUnselect:o,user:e}))}))):s.a.createElement("div",{className:"lakex-table-form-mention-selector-empty"},s.a.createElement("span",null,n))),e4=({type:e="text",defaultValue:t="",value:r,focus:n,onSearch:i=(()=>{}),onChange:o=(()=>{}),inputRef:l})=>{const c=Object(a.useRef)(),u=l||c,d=Object(a.useRef)();Object(a.useEffect)((()=>{n&&setTimeout((()=>{var e;null==(e=u.current)||e.focus()}),300)}),[n]);const f={type:e,placeholder:Ph("搜索人员"),onChange:e=>{o(e),!d.current&&i(e)},onCompositionStart:()=>{d.current=!0},onCompositionEnd:e=>{d.current=!1,i(e)},bordered:!1,defaultValue:t,value:r};return s.a.createElement(XL,{...f,ref:u,allowEnter:!1})},t4=e=>{const t=new Set;return e&&Array.isArray(e)&&e.forEach((e=>{t.add(e.uid)})),[...t.values()]},r4=e=>{const{inputRef:t}=e,{state:r,onKeyDown:n,onSearch:i,onSelect:o,onUnselect:l,onChange:c}=(e=>{const{selected:t,inputRef:r,focus:n}=e,i=HL(NI),[o,s]=Object(a.useState)(""),[l,c]=Object(a.useState)([]),[u,d]=Object(a.useState)(!1),[f,h]=Object(a.useState)(),[p,g]=Object(a.useState)((()=>t4(t)));Object(a.useEffect)((()=>{null==i||i.contextUsers().then((e=>{c(e)})),setTimeout((()=>{var e;n&&(null==(e=null==r?void 0:r.current)||e.focus())}),40)}),[]),Object(a.useEffect)((()=>{g(t4(t))}),[t]);const m=Object(a.useCallback)((e=>{var t;const r=e.keyCode||e.which;if([SN.UP,SN.DOWN].includes(r)){e.preventDefault();let n=l.findIndex((e=>e.uid===f));r===SN.UP?(n-=1,n<0&&(n=0)):r===SN.DOWN&&(n+=1,n>=l.length&&(n=l.length-1)),h(null==(t=l[n])?void 0:t.uid)}else if(r===SN.ENTER){e.preventDefault();const t=document.querySelector(".highlight .lakex-table-form-mention-selector-item");t&&t.click()}}),[l,f]);Object(a.useEffect)((()=>{const e=document.querySelector(".lakex-table-form-mention-selector-list"),t=null==e?void 0:e.querySelector("li.highlight");if(!t)return;const r=t.offsetTop-38,n=r+t.getBoundingClientRect().height;r<e.scrollTop?e.scrollTop-=e.scrollTop-r:n-e.scrollTop>e.getBoundingClientRect().height&&(e.scrollTop=n-e.getBoundingClientRect().height)}),[f]);const v=Object(a.useCallback)((t=>{var r;null==(r=e.onSelect)||r.call(e,t),!p.includes(t.uid)&&(g(p.concat(t.uid)),s(""))}),[e.onSelect,t]),y=Object(a.useCallback)((t=>{var r;null==(r=e.onUnselect)||r.call(e,t);const n=p.filter((e=>e!==t.uid));g(n)}),[e.onUnselect]),b=Object(a.useCallback)((e=>{const t=e.target.value||"";s(t)}),[]);return Object(a.useLayoutEffect)((()=>{!e.visible&&o&&s("")}),[e.visible]),{state:{list:l,loading:u,highlightId:f,selectedUserIds:p,filterValue:o},onKeyDown:m,onSearch:e=>{d(!0);const t=e.target.value;null==i||i.searchUser(t).then((e=>{c(e),d(!1)}))},onSelect:v,onUnselect:y,onChange:b}})(e);return s.a.createElement("div",{className:"lakex-table-form-mention-selector-container lakex-table-mention-wrapper",onKeyDown:n},s.a.createElement("div",{className:"lakex-table-form-mention-selector-search"},s.a.createElement(e4,{focus:e.focus,onSearch:i,onChange:c,inputRef:t,value:r.filterValue})),r.loading?s.a.createElement("div",{className:"lakex-table-form-mention-selector-spin"},s.a.createElement(v.a,null)):s.a.createElement("div",{className:"lakex-table-form-mention-selector-body"},s.a.createElement(Q6,{selectedIds:r.selectedUserIds,list:r.list,highlightId:r.highlightId,onSelect:o,onUnselect:l})))};const n4=({defaultValue:e,onChange:t,onSelect:r,onUnselect:n})=>{const[i,o]=Object(a.useState)((()=>function(e){return Ld(e)?[]:Array.isArray(e)?e:[e]}(e))),[s,l]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=e=>{let t=e.target;for(;t&&t!==document.body;){if(t.classList.contains("lakex-table-mention-wrapper"))return;t=t.parentNode}l(!1)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}}),[]),{state:{visible:s,selected:i},onMentionSelect:e=>{const n=i.concat(e);o(n),l(!1),t(n),r(e)},onMentionUnselect:e=>{const r=i.filter((t=>t.uid!==e.uid));o(r),l(!1),t(r),n(e)},onToggleVisible:()=>{l(!s)}}},i4=({id:e,onChange:t=(()=>{}),onSelect:r=(()=>{}),onUnselect:n=(()=>{}),defaultValue:i=[],onMentionTagClick:o=(()=>{}),renderMode:a})=>{const{state:l,onMentionSelect:c,onMentionUnselect:u,onToggleVisible:d}=n4({defaultValue:i,onChange:t,onSelect:r,onUnselect:n});return s.a.createElement(s.a.Fragment,null,s.a.createElement(_.a,{overlay:s.a.createElement(r4,{focus:!1,visible:l.visible,selected:l.selected,onSelect:c,onUnselect:u}),visible:l.visible,placement:"bottomLeft",dropdownClassName:"lakex-table-mention-wrapper"},s.a.createElement("div",{className:`lakex-table-form-mention lakex-table-mention-wrapper lakex-table-form-mention-render-mode-${a}`,id:e,onClick:()=>d()},s.a.createElement(X6,{writeable:l.visible,list:l.selected,hideDropdownIcon:a===Vz.LITE,onUnSelect:u,onMentionTagClick:o}))))},o4=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{var r;const{value:n,showEmpty:i,onMentionTagClick:o=(()=>{})}=e,l=Object(a.useRef)(null),c=Object(a.useRef)([]),[u,d]=Object(a.useState)(null);Object(a.useImperativeHandle)(t,(()=>({applyOverflow:e=>{h(e)}})));const f=Object(a.useCallback)(((e,t)=>{const r={};return u&&u.width&&u.index===t&&(r.width=u.width),r}),[u]);Object(a.useLayoutEffect)((()=>{const e=l.current,t=c.current,r=null==e?void 0:e.childNodes;!r||r.forEach((e=>{const r=e;t.push({width:r.scrollWidth,height:r.offsetHeight})}))}),[]);const h=Object(a.useCallback)((e=>{var t;const r=c.current;if(!e||!r||r.length<=1)return;const n=e.height,i=e.width;let o=-1,a=0,s=0,l=0;for(const e of r){o++;const{width:c,height:u}=e,f=a+c+3+12>i,h=i-a-c-3-12;if(f&&s+u+3>=n){const e=c>0&&c<h?c:l,n=e<12?(null==(t=r[o-1])?void 0:t.width)-12:e;return void d({index:n<12?o-1:o,width:Math.max(n,12)})}f&&(s+=3+u+3,a=0),a+=3+c,l=h}d(null)}),[c]);return n&&0!==n.length?s.a.createElement("div",{className:"lakex-table-form-mention-readonly"},s.a.createElement("div",{className:"lakex-table-form-mention-tag-wrap",ref:l},null==(r=null==n?void 0:n.map)?void 0:r.call(n,((e,t)=>{if(!e)return null;const r=f(e,t);return s.a.createElement("span",{className:"lakex-table-form-mention-tag",key:e.uuid,style:r,onClick:t=>{o(e)}},s.a.createElement("img",{className:"lakex-table-form-mention-tag-avatar",src:e.icon}),s.a.createElement("span",{className:"lakex-table-form-mention-tag-name"},e.name))})))):i?s.a.createElement("div",{className:"lakex-table-form-mention-readonly"},s.a.createElement(kG,null)):null}))),a4=({value:e,showEmpty:t})=>e||0===Number(e)?s.a.createElement("div",{className:"lakex-table-form-number-readonly"},e):t?s.a.createElement(kG,null):null,s4=e=>{const{id:t,defaultValue:r,focus:n,onBlur:i,renderMode:o}=e,l=null!==e.prefix?e.prefix:s.a.createElement(XU,{type:"FieldNumber",size:14}),[c,d]=wG({value:e.value,defaultValue:e.defaultValue,onChange:e.onChange}),f=Object(a.useRef)(null);return Object(a.useEffect)((()=>{n&&f.current&&f.current.focus({cursor:"end"})}),[n]),s.a.createElement("div",{className:`lakex-table-form-number lakex-table-form-number-render-mode-${o}`,id:t},s.a.createElement(u.a,{allowClear:o!==Vz.LITE,type:"text",value:c,defaultValue:r,placeholder:Ph("请输入"),prefix:l,onChange:t=>{var r;const n=t.target.value;d(n),null==(r=e.onChange)||r.call(e,n)},onBlur:i,autoFocus:n,ref:f}))},l4=({value:e,showEmpty:t})=>{const r=HL(PH);if(!e)return t?s.a.createElement(kG,null):null;return s.a.createElement("div",{className:"lakex-table-form-phone-readonly"},s.a.createElement("span",{className:"lakex-table-form-phone-text"},e),s.a.createElement(XU,{className:"lakex-table-form-phone-action",type:"FieldPhone",onClick:t=>{t.stopPropagation(),null==r||r.open("phone","tel:"+e)}}))},c4=e=>{const{id:t,defaultValue:r,prefix:n,focus:i,renderMode:o,onChange:l=(()=>{}),onBlur:c}=e,d=HL(PH),[f,h]=wG({value:e.value,defaultValue:e.defaultValue,onChange:e.onChange}),p=null!==n?n:s.a.createElement(XU,{type:"FieldPhone"}),g=Object(a.useRef)(null);return Object(a.useEffect)((()=>{i&&g.current&&g.current.focus({cursor:"end"})}),[i]),s.a.createElement("div",{className:`lakex-table-form-phone lakex-table-form-phone-render-mode-${o}`,id:t},s.a.createElement(u.a,{allowClear:o!==Vz.LITE,value:f,defaultValue:r,autoFocus:i,type:"text",placeholder:Ph("请输入"),prefix:p,onChange:e=>{const t=e.target.value;h(t),null==l||l(t)},onBlur:c,suffix:s.a.createElement(XU,{className:qL("lakex-table-form-phone-action",{hasValue:f}),type:"FieldPhone",onClick:e=>{e.stopPropagation(),null==d||d.open("phone","tel:"+f)}}),ref:g}))};var u4=(e=>(e.Dropdown="dropdown",e.List="list",e))(u4||{}),d4=(e=>(e.Select="select",e.MultiSelect="multiSelect",e))(d4||{});const f4=({placeholder:e,defaultValue:t="",value:r="",onChange:n=(()=>{}),focus:i,inputRef:o})=>{const l=Object(a.useRef)(),c=o||l;return Object(a.useEffect)((()=>{i&&setTimeout((()=>{var e;null==(e=c.current)||e.focus()}),300)}),[i]),s.a.createElement("div",{className:"lakex-table-dropdown-search"},s.a.createElement(XL,{ref:c,type:"text",placeholder:e,onChange:n,bordered:!1,defaultValue:t,value:r,allowEnter:!1}))},h4=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{value:r,color:n}=e,{state:i,style:o}=(({value:e,color:t})=>{const[r,n]=Object(a.useState)(e),i=HL(KD),o=t?{background:(null==i?void 0:i.getRenderColor(t))||"none"}:{};return o.color=null==i?void 0:i.getRenderTextColor(t),Object(a.useEffect)((()=>{n(e)}),[e]),{state:{optionValue:r},style:o}})({value:r,color:n});return Object(a.useImperativeHandle)(t,(()=>({getValue:()=>r||""}))),s.a.createElement("div",{className:qL("lakex-table-dropdown-item create",{active:e.isActive}),onClick:()=>{e.onCreate(r)}},s.a.createElement("span",{className:"lakex-table-dropdown-item-prefix"},Ph("新建选项")),i.optionValue&&s.a.createElement("span",{className:"lakex-table-dropdown-item-text",style:o},i.optionValue))}))),p4=e=>{const{item:t,colorable:r}=e,{labelColor:n}={labelColor:HL(KD)},[i,o]=Object(a.useState)(t.name),l=Object(a.useRef)(!1),c=Object(a.useRef)(null),d=bG((()=>{var r,n,i;!l.current||(null==(n=e.onOptionChange)||n.call(e,{...t,name:null==(r=c.current)?void 0:r.input.value}),l.current=!1,null==(i=e.onClose)||i.call(e,t))}),400);return Object(a.useEffect)((()=>()=>{var r,n;!l.current||null==(n=e.onOptionChange)||n.call(e,{...t,name:null==(r=c.current)?void 0:r.input.value})}),[]),s.a.createElement("div",{key:t.id,className:"lakex-table-dropdown-item editing active"},s.a.createElement(u.a,{ref:c,className:"lakex-table-dropdown-item-input editing-input",value:i,onChange:e=>{const t=(e.target.value||"").trim();o(t),l.current=!0},onPressEnter:e=>{e.stopPropagation(),d()},onKeyDown:r=>{var n;r.stopPropagation(),r.keyCode===SN.ESC&&(null==(n=e.onClose)||n.call(e,t))},onBlur:()=>{setTimeout((()=>{var e;(null==(e=c.current)?void 0:e.input)!==document.activeElement&&d()}),300)},autoFocus:!0}),r&&s.a.createElement(f.a,{placement:"rightTop",overlayClassName:"lakex-table-colorpicker",overlayStyle:{zIndex:1050},content:s.a.createElement(WL,{colorSource:[...$D],activeColor:t.color,onSelect:r=>{var n,i;null==(n=e.onOptionChange)||n.call(e,{...t,color:r}),null==(i=c.current)||i.focus()}})},s.a.createElement("span",{className:"option-color",style:{background:null==n?void 0:n.getRenderColor(t.color)}})))},g4=e=>{const{isEditing:t,isActive:r,isSelected:n,canEditing:i=!0,item:o,colorable:l,editable:c,onSelect:u=(()=>{}),onSetActive:h=(()=>{})}=e,{optionItem:p,setOptionItem:g,style:m}=(({item:e,colorable:t})=>{const r=r=>t?{background:e.color?null==n?void 0:n.getRenderColor(r.color):"none",color:null==n?void 0:n.getRenderTextColor(r.color)}:{},n=HL(KD),[i,o]=Object(a.useState)(e),[s,l]=Object(a.useState)(r(e));return{optionItem:i,setOptionItem(e){o(e),l(r(e))},labelColor:n,style:s}})({item:o,colorable:l}),[v,y]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{!r&&y(!1)}),[r]),t?s.a.createElement(p4,{onOptionChange:t=>{var r;(t.name!==o.name||t.color!==o.color)&&(null==(r=e.onOptionChange)||r.call(e,t),g(t))},item:p,colorable:l,onClose:()=>{var t;null==(t=e.onSetEditing)||t.call(e,null)}}):s.a.createElement("div",{key:p.uuid,className:qL("lakex-table-dropdown-item",{active:r}),onClick:()=>{!i||u(p)}},n&&s.a.createElement(XU,{type:"Check",size:14}),s.a.createElement("span",{className:"lakex-table-dropdown-item-text",style:m},p.name),c&&s.a.createElement(f.a,{visible:v,overlayClassName:"lakex-table-dropdown-popover-container",overlayStyle:{zIndex:1051},getPopupContainer:()=>{let e=document.getElementById("lakex-table-dropdown-popup-container");return e||(e=document.createElement("div"),e.id="lakex-table-dropdown-popup-container",e.onmouseup=e=>{e.preventDefault(),e.stopPropagation()},document.body.appendChild(e),e)},content:s.a.createElement(d.a,{onClick:({key:t,domEvent:r})=>{var n,i;r.stopPropagation(),"edit"===t?null==(n=e.onSetEditing)||n.call(e,p.uuid):"del"===t&&(null==(i=e.onRemove)||i.call(e,p.uuid)),y(!1)}},s.a.createElement(d.a.Item,{key:"edit",icon:s.a.createElement(XU,{type:"Edit",size:14})},Ph("编辑")),s.a.createElement(d.a.Item,{key:"del",icon:s.a.createElement(XU,{type:"Delete",size:14})},Ph("删除"))),trigger:"click",placement:"rightTop",onClick:e=>e.stopPropagation()},s.a.createElement(XU,{type:"MoreHorizontal",onClick:()=>{y(!v),h()}})))};g4.defaultProps={canEditing:!1,colorable:!1,editable:!1};const m4=e=>{const{options:t=[],focus:r,selectedIds:n,colorable:i,optionEditable:o,inputRef:l}=e,{state:c,onInputChange:u,onCreateOption:d,setActiveIdx:f,onOptionChange:h,onOptionDelete:p,onOptionSelect:g}=(e=>{const{options:t,onOptionCreate:r,colorable:n,inputRef:i,visible:o,focus:s}=e,[l,c]=Object(a.useState)(0),[u,d]=Object(a.useState)(""),f=HL(KD),h=Object(a.useMemo)((()=>{var e,r,i;if(n)return 0===t.length?null==(e=KD)?void 0:e.getNextColor(""):null==(i=KD)?void 0:i.getNextColor(null==(r=t[t.length-1])?void 0:r.color)}),[n,f,t]),p=Object(a.useMemo)((()=>u?t.filter((e=>{var t,r;return null==(r=null==(t=e.name)?void 0:t.toLowerCase)?void 0:r.call(t).includes(u.toLowerCase())})):t),[u,t]);Object(a.useEffect)((()=>{setTimeout((()=>{var e;s&&(null==(e=null==i?void 0:i.current)||e.focus())}),20)}),[]),Object(a.useLayoutEffect)((()=>{!o&&u&&d("")}),[o,u]);const g=Object(a.useMemo)((()=>""!==u&&!p.some((e=>e.name===u))),[u,p]),v=vG((e=>{const t=e.trim();if(!t)return void m.a.error(Ph("新建选项不能为空字符"));const n={name:t,uuid:To(6),color:h||""};null==r||r(n),d(""),c(0)})),y=Object(a.useMemo)((()=>({value:u,selectOptions:p,showNew:g,newOptionColor:h,activeIdx:l})),[u,g,h,p,l]),b=vG((t=>{var r,n;null==(r=e.onOptionChange)||r.call(e,t),null==(n=null==i?void 0:i.current)||n.focus()})),_=vG(((t,r)=>{var n;c(r),e.onOptionSelect(t),d(""),null==(n=null==i?void 0:i.current)||n.focus()})),w=Object(a.useCallback)((t=>{var r;e.onOptionDelete(t),null==(r=null==i?void 0:i.current)||r.focus()}),[]);return{state:y,onInputChange:Object(a.useCallback)((e=>{const t=e.target.value;d(t),c(0)}),[]),onCreateOption:v,setActiveIdx:c,onOptionChange:b,onOptionDelete:w,onOptionSelect:_}})(e),{activeIdx:v}=c,[y,b]=Object(a.useState)(null),_=Object(a.useRef)(null),w=Object(a.useCallback)((e=>{var t;const r=e.keyCode||e.which,n=r===SN.UP,i=r===SN.DOWN,o=c.selectOptions.length,a=c.showNew?o:o-1;if((n||i)&&o>0){e.preventDefault();let t=0;t=0===v?n?a:1:v===a?n?v-1:0:v+(n?-1:1),f(t)}else if(r===SN.ENTER){const e=0===o||v===o;if(c.showNew&&e){const e=null==(t=_.current)?void 0:t.getValue();e&&d(e)}else{const e=c.selectOptions[v];e&&g(e,v)}}}),[v,t,c.showNew,_.current,c.selectOptions]);return Object(a.useEffect)((()=>{const e=document.querySelector(".lakex-table-dropdown-list"),t=document.querySelector(".lakex-table-dropdown-item.active");if(!t)return;const r=t.offsetTop-38,n=r+t.getBoundingClientRect().height;r<e.scrollTop?e.scrollTop-=e.scrollTop-r:n-e.scrollTop>e.getBoundingClientRect().height&&(e.scrollTop=n-e.getBoundingClientRect().height)}),[v]),s.a.createElement("div",{className:"lakex-table-dropdown-celleditor",onKeyDown:w},s.a.createElement(f4,{placeholder:Ph(o?"可搜索或新建选项":"搜索选项"),onChange:u,focus:r,value:c.value,inputRef:l}),s.a.createElement("div",{className:"lakex-table-dropdown-list"},c.selectOptions.map(((e,t)=>{const r=v===t,a=null==n?void 0:n.includes(e.uuid),l=e.uuid===y;return s.a.createElement(g4,{key:e.uuid,isEditing:l,onSetEditing:e=>{b(e)},canEditing:!0,colorable:i,onOptionChange:h,onRemove:p,onSelect:e=>g(e,t),onSetActive:()=>{f(t)},isActive:r,isSelected:a,item:e,editable:!!o})})),c.showNew&&o&&s.a.createElement(h4,{isActive:v===c.selectOptions.length||0===c.selectOptions.length,ref:_,onCreate:e=>{d(e)},value:c.value,colorable:i,color:c.newOptionColor})))};m4.defaultProps={colorable:!0,editable:!1};const v4=({value:e=[],colorable:t,onDelete:r=(()=>{}),onClickDropDownIcon:n=(()=>{}),writeable:i,showPlaceholder:o,hideDropdownIcon:a})=>{const{labelColor:l}={labelColor:HL(KD)};return Array.isArray(e)?0===e.length&&o?s.a.createElement("p",{className:"lakex-table-dropdown-selected-placeholder"},Ph("请选择")):s.a.createElement("div",{className:"lakex-table-dropdown-selector"},s.a.createElement("div",{className:"lakex-table-dropdown-selected-list "+(i?"writeable":"")},e.map((e=>s.a.createElement("div",{className:"lakex-table-dropdown-selected-item",key:e.uuid,style:t?{background:e.color?null==l?void 0:l.getRenderColor(e.color):"none",color:null==l?void 0:l.getRenderTextColor(e.color)}:{}},s.a.createElement("span",{className:"lakex-table-dropdown-selected-item-text"},e.name),i&&s.a.createElement(XU,{className:"lakex-table-select-close-action",type:"Close",size:12,onClick:t=>{t.stopPropagation(),r(e)}}))))),i&&!a?s.a.createElement("span",{className:"lakex-table-form-mention-caret-down",onClick:e=>{null==n||n(e)}},s.a.createElement(XU,{type:"ReviewArrowDown",size:16})):null):null};function y4(e){return Lo(e)?[]:Array.isArray(e)?e:[e]}v4.defaultProps={hideDropdownIcon:!1,writeable:!1,showPlaceholder:!0};const b4=e=>{const{options:t,editable:r,optionEditable:n,colorable:i}=e,{state:o,onKeyDown:l,onToggleVisible:c,onToggleSelect:u}=(e=>{const{defaultValue:t,options:r,type:n}=e,[i,o]=Object(a.useState)(!1),[s,l]=Object(a.useState)((()=>y4(t))),c=Object(a.useRef)(null),u=Object(a.useMemo)((()=>!Lo(e.onChange)),[e.onChange]);Object(a.useEffect)((()=>{if(u){const e=y4(t);l(e)}}),[t,u]),Object(a.useEffect)((()=>{const e=e=>{let t=e.target;for(;t&&t!==document.body;){if(t.classList.contains("lakex-table-colorpicker")||t.classList.contains("lakex-table-dropdown-popover-container")||t.classList.contains("lakex-table-dropdown-celleditor")||t.classList.contains("lakex-table-select-close-action"))return;t=t.parentNode}o(!1)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}}),[]);const d=Object(a.useCallback)((e=>{(e.keyCode||e.which)===SN.ESC&&o(!1)}),[r]),f=Object(a.useMemo)((()=>r.filter((e=>s.includes(e.uuid)))),[r,s]),h=Object(a.useCallback)((()=>{o(!i)}),[i]),p=Object(a.useCallback)((t=>{var i;const o=n===d4.MultiSelect,a=t.uuid,c=s.includes(a),d=o?s.concat(a):[a],f=o?s.filter((e=>e!==a)):[],p=c?f:d;u?null==(i=e.onChange)||i.call(e,r.filter((e=>p.includes(e.uuid)))):l(p),!o&&!c&&h()}),[i,n,s,u,r]);return{state:{visible:i,selectedOptions:f,selectedIds:s,selectInputRef:c},onKeyDown:d,onToggleVisible:h,onToggleSelect:p}})(e);return s.a.createElement("div",{className:"lakex-table-dropdown",onKeyDown:l},s.a.createElement(_.a,{overlay:s.a.createElement(m4,{visible:o.visible,inputRef:o.selectInputRef,focus:!0,colorable:!!i,options:t,editable:!!r,optionEditable:!!n,selectedIds:o.selectedIds||[],onOptionCreate:t=>{var r;null==(r=e.onOptionCreate)||r.call(e,t)},onOptionChange:t=>{var r;null==(r=e.onOptionChange)||r.call(e,t)},onOptionDelete:t=>{var r;null==(r=e.onOptionDelete)||r.call(e,t)},onOptionSelect:e=>{u(e)}}),placement:"bottomLeft",visible:o.visible,overlayClassName:"lakex-table-dropdown"},s.a.createElement("div",{className:"lakex-table-dropdown-cellview",onClick:c},s.a.createElement(v4,{writeable:o.visible,colorable:!!i,value:o.selectedOptions,hideDropdownIcon:e.hideDropdownIcon,onDelete:e=>u(e),showPlaceholder:!0}))))},_4=({options:e,value:t,focus:r,onOptionSelect:n=(()=>{})})=>{const{radioRef:i}=(({focus:e})=>{const t=Object(a.useRef)(null);return Object(a.useEffect)((()=>{e&&setTimeout((()=>{var e;null==(e=t.current)||e.focus()}),300)}),[e]),{radioRef:t}})({focus:r});return s.a.createElement(g.a.Group,{ref:i,value:t},e.map(((e,t)=>s.a.createElement(g.a,{className:"lakex-table-form-select-radio",value:e.uuid,key:t,onChange:()=>{n([e])}},s.a.createElement("span",{className:"lakex-table-form-select-value"},e.name)))))},w4=({options:e=[],focus:t,value:r,onOptionSelect:n=(()=>{})})=>s.a.createElement(h.a.Group,{onChange:t=>{n(e.filter((e=>t.includes(e.uuid))))},value:r,autoFocus:t},e.map(((e,t)=>s.a.createElement(h.a,{className:"lakex-table-form-select-checkbox",value:e.uuid,key:t},s.a.createElement("span",{className:"lakex-table-form-select-value"},e.name))))),C4=(e,t)=>e!==d4.Select||Array.isArray(t)?t:[t],E4=e=>{const{id:t,type:r=d4.Select,defaultValue:n=[],value:i,options:o,renderMode:a,displayType:l=u4.List,focus:c=!1,className:u=""}=e;let d;e.onChange&&(d=t=>{var n;const i=r===d4.Select?t[0]:t;null==(n=e.onChange)||n.call(e,i)});const[f,h]=wG({value:i?C4(r,i):void 0,defaultValue:C4(r,n),onChange:d});let p;if(l===u4.Dropdown){const{defaultValue:t,onChange:r,...n}=e;p=s.a.createElement(b4,{...n,defaultValue:f,value:f,onChange:e=>{h(e.map((e=>e.uuid)))},onOptionCreate:t=>{var r;null==(r=e.onOptionCreate)||r.call(e,t),f.push(t.uuid),h(f)},onOptionChange:e.onOptionChange,onOptionDelete:e.onOptionDelete,hideDropdownIcon:a===Vz.LITE})}else l===u4.List&&r===d4.Select?p=s.a.createElement(_4,{value:f[0],options:o,focus:c,onOptionSelect:e=>{h(e.map((e=>e.uuid)))}}):l===u4.List&&r===d4.MultiSelect&&(p=s.a.createElement(w4,{value:f,options:o,focus:c,onOptionSelect:e=>{h(e.map((e=>e.uuid)))}}));return s.a.createElement("div",{className:`lakex-table-form-select lakex-table-form-select-${r||"normal"} ${u} lakex-table-form-select-render-mode-${a}`,id:t},p)},S4=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{colorable:r,type:n="",value:i=[],className:o="",showEmpty:l=!1}=e,c=HL(KD),u=Object(a.useRef)(null),d=Object(a.useRef)([]),[f,h]=Object(a.useState)(null),p=Object(a.useCallback)(((e,t)=>{const n={};if(r){const t=e.color?null==c?void 0:c.getRenderColor(e.color):"none";n.background=t,n.color=null==c?void 0:c.getRenderTextColor(e.color)}return f&&f.width&&f.index===t&&(n.width=f.width),n}),[r,f]);Object(a.useImperativeHandle)(t,(()=>({applyOverflow:e=>{g(e)}}))),Object(a.useLayoutEffect)((()=>{const e=u.current,t=d.current,r=null==e?void 0:e.childNodes;!r||r.forEach((e=>{const r=e;t.push({width:r.scrollWidth,height:r.offsetHeight})}))}),[]);const g=Object(a.useCallback)((e=>{var t;const r=d.current;if(!e||!r||r.length<=1)return;const n=e.height,i=e.width;let o=-1,a=0,s=0,l=0;for(const e of r){o++;const{width:c,height:u}=e,d=a+c+4+5>i,f=i-a-c-4-5;if(d&&s+u+4>=n){const e=c>0&&c<f?c:l,n=e<5?(null==(t=r[o-1])?void 0:t.width)-e:e-5;return void h({index:n<5?o-1:o,width:Math.max(n,12)})}d&&(s+=4+u+4,a=0),a+=4+c,l=f}h(null)}),[d]);return i&&0!==i.length?s.a.createElement("div",{className:`lakex-table-form-select lakex-table-form-select-${n||"normal"} ${o}`},s.a.createElement("div",{className:"lakex-table-form-select-readonly",ref:u},i.map(((e,t)=>{const r=p(e,t);return s.a.createElement("div",{className:"lakex-table-select-item lakex-table-select-item-overflow-apply",key:t,style:r},s.a.createElement("span",{className:"lakex-table-select-item-text"},e.name||""))})))):l?s.a.createElement(kG,null):null})));class k4 extends s.a.Component{constructor(e){super(e),this._inputRefs=[],this.getDefaultOptions=()=>{const{configs:e,multiple:t}=this.props,{options:r,color:n}=e;let i=!!n;if(r&&r.length>0)return r.forEach((e=>{e.uuid||(e.uuid=To(6)),typeof n>"u"&&(i=!!r[0]&&!!r[0].color)})),{options:r,multi:t,hasColor:i};const o=[{name:"",uuid:To(6),color:"$label-back-color:0-0"},{name:"",uuid:To(6),color:"$label-back-color:0-1"},{name:"",uuid:To(6),color:"$label-back-color:0-2"}];return o.forEach(((e,t)=>{i&&!e.color&&(e.color=0===t?KD.getNextColor(""):KD.getNextColor(o[t-1].color))})),{options:o,multi:t,hasColor:i}},this.onAddItem=e=>{const{options:t}=this.state,r={name:"",uuid:To(6),color:""},n=0===t.length?"":t[t.length-1].color;r.color=KD.getNextColor(n),t.push(r),this.setState({options:t.slice()},(()=>{this._optionListRef&&this._optionListRef.current&&(this._optionListRef.current.scrollTop=1e4),e&&this._inputRefs.length>1&&this._inputRefs[this._inputRefs.length-1].focus(),this.onChange()}))},this.onChangeItem=(e,t)=>{const r=e.target.value.trim(),{options:n}=this.state,i=[];n.forEach(((e,n)=>{const o=n===t?r:e.name;i.push({...e,name:o})})),this.setState({options:i},(()=>{this._inputRefs[t].focus(),this.onChange()}))},this.onDeleteItem=(e,t)=>{const{options:r}=this.state,n=r.filter(((e,r)=>r!==t));this._inputRefs.splice(t,1),this.setState({options:n},(()=>{this.onChange()}))},this.onChangeColor=(e,t)=>{const{options:r}=this.state,n=[];r.forEach((r=>{const i=r.uuid===e?t:r.color;n.push({...r,color:i})})),this.setState({options:n},(()=>{this.onChange()}))},this.toggleColor=e=>{const t=e.target.checked,{options:r}=this.state;t&&r[0]&&!r[0].color&&r.forEach(((e,t)=>{e.color=this.props.labelColor.getByIndex(t)})),this.setState({options:r,hasColor:t},(()=>{this.onChange()}))},this.beforeChange=e=>{this.setState({options:e},(()=>{this.onChange()}))},this.onPressEnter=e=>{e>=this.state.options.length-1?this.onAddItem(!0):this._inputRefs[e+1].input.focus()},this.onChangeOrder=(e,t)=>{const{options:r}=this.state,n=r.findIndex((t=>t.uuid===e)),i=r.findIndex((e=>e.uuid===t));this.setState({options:OU(r,n,i)},(()=>{this.props.onChangeOrder&&this.props.onChangeOrder(e,t),this.onChange()}))},this.state={options:[],multi:!1,hasColor:!1}}componentDidMount(){this._optionListRef=s.a.createRef();const{options:e,multi:t,hasColor:r}=this.getDefaultOptions();this.setState({options:e,multi:t,hasColor:r})}onChange(){const e={color:this.state.hasColor,options:[]},t=[];this.state.options.forEach((e=>{if(""===e.name)return;const r={name:e.name,uuid:e.uuid,color:this.state.hasColor?e.color:null};""!==e.name&&t.push(r)})),e.options=af(t,(e=>e.name)),this.props.multiple&&(e.multi=!!this.state.multi),this.props.onChange&&this.props.onChange(e)}_ignoreSortableRule(e){return!(!(null==e?void 0:e.tagName)||"input"!==e.tagName.toLowerCase())}render(){const{options:e}=this.state;return e?s.a.createElement("div",{className:"col-config-select-options"},this.props.title,s.a.createElement("div",{className:"multi-select"},s.a.createElement(h.a,{size:"small",checked:!!this.state.hasColor,onChange:this.toggleColor,style:{marginLeft:12}}),Ph("颜色")),s.a.createElement("div",{className:"option-list",ref:this._optionListRef},s.a.createElement(I4,{hasColor:this.state.hasColor,labelColor:this.props.labelColor,options:this.state.options,inputRefs:this._inputRefs,onChangeColor:this.onChangeColor,onChangeItem:this.onChangeItem,onDeleteItem:this.onDeleteItem,onPressEnter:this.onPressEnter,onChangeOrder:this.onChangeOrder,autoFocus:this.props.autoFocus})),s.a.createElement("div",{className:"select-options-add-item"+(this.state.hasColor?" colored":""),onClick:this.onAddItem},s.a.createElement(XU,{type:"Add"}),Ph("添加一个选项"))):null}}const x4=e=>{const t=HL(KD);return t?s.a.createElement(k4,{labelColor:t,...e}):null},O4=({hasColor:e,labelColor:t,option:r,index:n,inputRefs:i,autoFocus:o,onChangeColor:a,onChangeItem:l,onPressEnter:c,onDeleteItem:d})=>{const{attributes:h,listeners:p,setNodeRef:g,transform:m,transition:v,isDragging:y}=HU({id:r.uuid});let b=null;e&&(b=s.a.createElement(f.a,{placement:"leftTop",overlayClassName:"lakex-table-colorpicker",content:s.a.createElement(WL,{colorSource:[...$D],activeColor:r.color||"",onSelect:e=>{a(r.uuid,e)}})},s.a.createElement("span",{className:"option-color",style:{background:t.getRenderColor(r.color)}})));const _={transform:y$.Transform.toString(m),transition:v,zIndex:y?"100":"auto",opacity:y?.3:1};return s.a.createElement("div",{ref:g,className:"input-item",key:r.uuid,"data-id":r.uuid,style:_,...h},s.a.createElement("span",{className:"input-item-content"},b,s.a.createElement(u.a,{value:r.name,onChange:e=>{l(e,n)},onPressEnter:()=>{c(n)},ref:e=>{i[n]=e},autoFocus:o&&0===n}),s.a.createElement(XU,{type:"Delete",onClick:e=>{d(e,n)}})),s.a.createElement("div",{className:"input-item-drag",...p},s.a.createElement(XU,{type:"Drag"})))},I4=({autoFocus:e,hasColor:t,labelColor:r,options:n,inputRefs:i,onChangeColor:o,onChangeItem:a,onPressEnter:l,onDeleteItem:c,onChangeOrder:u})=>{const d=M$(A$(OB,{activationConstraint:{distance:8}}));return s.a.createElement(lU,{sensors:d,modifiers:[YU,KU],collisionDetection:B$,onDragEnd:async e=>{const{active:t,over:r}=e;t.id!==r.id&&u(t.id,r.id)}},s.a.createElement(FU,{items:n.map((e=>({...e,id:e.uuid}))),strategy:DU},n.map(((n,u)=>s.a.createElement(O4,{key:n.uuid,option:n,index:u,hasColor:t,labelColor:r,inputRefs:i,onChangeColor:o,onChangeItem:a,onPressEnter:l,onDeleteItem:c,autoFocus:!!e})))))},R4=({value:e,showEmpty:t})=>e?s.a.createElement("div",{className:"lakex-table-form-textarea-readonly"},e):t?s.a.createElement(kG,null):null,T4=({id:e,focus:t,defaultValue:r="",renderMode:n,value:i,onChange:o})=>{const l=Object(a.useRef)(null),[c,d]=wG({value:i,defaultValue:r,onChange:o});return Object(a.useEffect)((()=>{t&&l.current&&l.current.focus({cursor:"end"})}),[t]),s.a.createElement("div",{className:`lakex-table-form-textarea lakex-table-form-textarea-render-mode-${n}`,id:e||""},s.a.createElement(u.a.TextArea,{defaultValue:r,value:c,autoSize:{minRows:1},placeholder:Ph("请输入"),onChange:e=>{const t=e.target.value;d(t),null==o||o(t)},autoFocus:t,ref:l}))},A4=e=>{const t=HL(PH);return s.a.createElement("span",{className:qL("lakex-table-ui-link",e.className),onClick:r=>{null==t||t.open("link",e.href),e.onClick&&e.onClick(r)}},e.children)},M4=({value:e,showEmpty:t})=>e?s.a.createElement("div",{className:"lakex-table-form-link-readonly"},s.a.createElement(A4,{href:e.src},e.name)):t?s.a.createElement(kG,null):null,N4=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{defaultValue:r,onSubmit:n=(()=>{}),onBlur:i=(()=>{}),style:o}=e,l=Object(a.useRef)(),c=s.a.useRef(null);Object(a.useImperativeHandle)(t,(()=>({getValues:()=>{var e;const t=null==(e=c.current)?void 0:e.getFieldsValue();return d(t)}}))),Object(a.useEffect)((()=>{l.current&&setTimeout((()=>{var e;null==(e=l.current)||e.focus({cursor:"end"})}),300)}),[]);const d=Object(a.useCallback)((e=>{const t={src:e.src||e.name||"",name:e.name||e.src||""};return{src:Af(t.src)||`http://${t.src}`,name:t.name}}),[]),f=e=>{const t=d(e);n(t),i()};return s.a.createElement("div",{className:"lakex-table-link-editor",style:o||{},onKeyDown:e=>{var t;if(e.key===xN.ENTER){const e=null==(t=c.current)?void 0:t.getFieldsValue();f(e)}}},s.a.createElement(w.a,{initialValues:r,onFinish:f,ref:c},s.a.createElement(w.a.Item,{name:"name",label:Ph("文本"),className:"lakex-table-link-editor-title"},s.a.createElement(u.a,{ref:l,placeholder:Ph("请输入"),autoComplete:"off"})),s.a.createElement(w.a.Item,{name:"src",label:Ph("链接"),className:"lakex-table-link-editor-link"},s.a.createElement(u.a,{placeholder:Ph("请输入"),autoComplete:"off"})),s.a.createElement(w.a.Item,{className:"lakex-table-link-editor-footer"},s.a.createElement(b.a,{onClick:()=>i()},Ph("取消")),s.a.createElement(b.a,{type:"primary",htmlType:"submit"},Ph("确定")))))}))),D4=({id:e,defaultValue:t,useLinkEditor:r,prefix:n,renderMode:i,onChange:o=(()=>{}),onBlur:l=(()=>{}),focus:c})=>{var d;const{state:f,setVisible:h,checkLink:g,onInputChange:m,onSubmit:v}=(e=>{const{defaultValue:t,onChange:r}=e,[n,i]=Object(a.useState)((()=>Fo(t)?{src:t.src,name:t.name}:t)),[o,s]=Object(a.useState)(!1);Object(a.useEffect)((()=>{i(n)}),[n]);const l=Object(a.useCallback)((e=>{i(e),r(e)}),[r]);return Object(a.useEffect)((()=>{const e=e=>{e.target.closest(".lakex-table-form-link-popover")||s(!1)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}}),[]),{state:{value:n,visible:o},setVisible:s,checkLink:e=>{e.target.closest(".lakex-table-form-link-anchor")&&(n||(e.preventDefault(),e.stopPropagation(),s(!0)))},onSubmit:l,onInputChange:e=>{let t,n;if(e.target){if(!e.target.value)return void r(null);n=e.target.value,t=Af(e.target.value)}else t=e.src,n=e.name;const o={name:n,src:t};o.src||(o.src=o.name),o.name||(o.name=o.src),i(o),r(o)}}})({defaultValue:t,onChange:o});void 0===n&&(n=s.a.createElement(XU,{type:"FieldLink",size:14}));const y=r?"lakex-table-form-link-useeditor":"";return s.a.createElement("div",{className:`lakex-table-form-link ${y} lakex-table-form-link-render-mode-${i}`,id:e},!r&&s.a.createElement(u.a,{allowClear:!0,defaultValue:null==t?void 0:t.src,type:"text",placeholder:Ph("请输入"),prefix:n,onChange:m,autoFocus:c,onBlur:l}),r&&s.a.createElement(_.a,{overlayClassName:"lakex-table-form-link-popover",destroyTooltipOnHide:!0,overlay:s.a.createElement(N4,{defaultValue:t,onSubmit:v,onBlur:()=>h(!1)}),visible:f.visible},s.a.createElement(s.a.Fragment,null,f.value&&(f.value.src||f.value.name)?s.a.createElement(A4,{href:null==(d=f.value)?void 0:d.src,className:"lakex-table-form-link-anchor",onClick:e=>{g(e)}},f.value.name):s.a.createElement(u.a,{allowClear:!0,defaultValue:null==t?void 0:t.src,type:"text",placeholder:Ph("请输入"),onBlur:m,onPressEnter:m,autoFocus:c}),s.a.createElement(p.a,{title:Ph("编辑链接")},s.a.createElement(XU,{className:"lakex-table-link-editor-action",type:"FieldLink",size:14,onClick:()=>h(!0)})))))},P4=$i.defineToken("ToolbarServiceToken"),j4=$i.defineToken("ToolbarContribution");var F4;(e=>{e.isCustom=function(e){return!!e.RenderComponent},e.isNormal=function(e){return!!e.tooltip}})(F4||(F4={}));var V4=(e=>(e.NORMAL="normal",e.LITE="lite",e))(V4||{}),L4=Object.defineProperty,$4=Object.getOwnPropertyDescriptor,B4=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$4(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&L4(t,r,o),o};let U4=class{constructor(){this._items=new Map,this._customItems=new Map,this.isInit=!1}init(){var e;if(this.isInit)return;this.isInit=!0;const t=this.toolbarPluginProvider.getContributions();for(const r of t)try{null==(e=r.registerToolbar)||e.call(r,this)}catch(e){console.error(e)}}registerRender(e){this._toolbarRender=e}registerItem(e){if(F4.isCustom(e))this._registerCustomItem(e);else{if(!F4.isNormal(e))throw new Error("An invalid toolbar item!");this._registerNormalItem(e)}return e}getToolbarItem(e){return this._items.get(e)}getCustomItem(e){return this._customItems.get(e)}getRender(){return this._toolbarRender}unregisterItem(e){const t="string"==typeof e?e:e.id,r=this.getToolbarItem(t),n=this.getCustomItem(t);r&&this._items.delete(t),n&&this._customItems.delete(t)}get hasToolbars(){return this._customItems.size>0||this._items.size>0}_registerNormalItem(e){const{id:t}=e;if(this._items.has(t))throw new Error(`A normal toolbar item is already registered with the '${t}'`);this._items.set(t,e)}_registerCustomItem(e){const{id:t}=e;if(this._customItems.has(t))throw new Error(`A custom toolbar item is already registered with the '${t}'`);this._customItems.set(t,e)}destroy(){this._items.clear(),this._customItems.clear(),this._toolbarRender=null}};B4([wh(j4)],U4.prototype,"toolbarPluginProvider",2),B4([Ii()],U4.prototype,"destroy",1),U4=B4([io()],U4);const z4=()=>{},H4=({id:e,isActive:t,isDisable:r,isShowIcon:n,isShowTitle:i,iconType:o,iconSize:a,titleFontSize:l,tooltipStr:c,onCommand:u})=>s.a.createElement("button",{className:qL({"lakex-workbench-toolbar-button":!0,"lakex-workbench-toolbar-button-active":t,"lakex-workbench-toolbar-button-disable":r}),id:e,onClick:e=>{r||u(e)},tabIndex:-1},n&&o&&s.a.createElement(XU,{type:o,size:a}),i&&s.a.createElement("span",{className:"toolbar-button-title",style:{fontSize:l}},c)),W4=({onCommand:e=z4,id:t,tooltip:r,showTooltip:n=!1,disable:i,active:o,showIcon:a=!0,showTitle:l=!0,icon:c,iconSize:u=16,titleFontSize:d=14,visible:f=!1})=>{const h=No(i)?i():i,g=No(o)?o():o,m=No(a)?a():a,v=No(c)?c():c,y=No(l)?l():l,b=No(r)?r():r;return(No(f)?f():f)?n?s.a.createElement(p.a,{title:b},s.a.createElement("div",null,s.a.createElement(H4,{id:t,isDisable:h,isActive:g,isShowIcon:m,isShowTitle:y,iconSize:u,iconType:v,tooltipStr:b,titleFontSize:d,onCommand:e}))):s.a.createElement(H4,{id:t,isDisable:h,isActive:g,isShowIcon:m,isShowTitle:y,iconSize:u,iconType:v,tooltipStr:b,titleFontSize:d,onCommand:e}):null},G4=()=>s.a.createElement("div",{className:"lakex-table-workbench-toolbar-btn lake-workbench-toolbar-divider"});var K4=Object.defineProperty,q4=Object.getOwnPropertyDescriptor,Y4=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?q4(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&K4(t,r,o),o};let J4=class extends fp{constructor(){super(...arguments),this._$ref=s.a.createRef(),this._toolbarRef=s.a.createRef(),this._onChange=this._register(new _p),this.onChange=this._onChange.event,this.Buttons=({buttons:e,mode:t})=>Array.isArray(e)?s.a.createElement(s.a.Fragment,null,e.map(((e,r)=>s.a.createElement(s.a.Fragment,{key:r},this._renderButtonItem(e,t))))):s.a.createElement(s.a.Fragment,null)}init(){this._toolbarRegistry.init()}getDom(){return this._$ref.current}render(){const e=this._toolbarRegistry.getRender();return e?s.a.createElement("div",{className:"lakex-table-workbench-toolbar-container",style:{width:"100%"},ref:this._$ref},s.a.createElement(e,{ref:this._toolbarRef})):null}rerender(){this._toolbarRef.current&&this._toolbarRef.current.refresh()}filterVisibleButtons(e){return e?e.filter((e=>{const t=this._toolbarRegistry.getCustomItem(e);if(t)return!(null==t||!t.RenderComponent);const r=this._toolbarRegistry.getToolbarItem(e);return!(!r||!r.visible)&&(No(r.visible)?r.visible():r.visible)})).filter(((t,r)=>!!("|"!==t||e[r-1]&&e[r+1]))):[]}_renderButtonItem(e,t=V4.NORMAL){const r=this._toolbarRegistry.getCustomItem(e);if(r){const{RenderComponent:e,...t}=r;return s.a.createElement(e,{onCommand:e=>{var r;null==(r=t.onClick)||r.call(t,{target:e.currentTarget})}})}const n=this._toolbarRegistry.getToolbarItem(e);if(n){const{visible:e,onClick:r,...i}=n;return t===V4.LITE&&(CN(i.showTitle)&&(i.showTitle=!1),CN(i.showTooltip)&&(i.showTooltip=!0)),s.a.createElement(W4,{visible:e,onCommand:e=>{null==r||r({target:e.currentTarget})},...i})}return"|"===e&&this._toolbarRegistry.hasToolbars?s.a.createElement(G4,null):null}destroy(){super.destroy(),this._$ref.current=null,this._toolbarRef.current=null}};Y4([ao(U4)],J4.prototype,"_toolbarRegistry",2),Y4([Ii()],J4.prototype,"destroy",1),J4=Y4([io({token:P4})],J4);var X4=Object.defineProperty,Z4=Object.getOwnPropertyDescriptor,Q4=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Z4(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&X4(t,r,o),o};let e8=class{init(){this._toolbarRegistry.init()}};Q4([ao(U4)],e8.prototype,"_toolbarRegistry",2),e8=Q4([io({contrib:[jL]})],e8);const t8=xo().contribution(j4).register(e8).register(J4).register(U4);var r8=Object.defineProperty,n8=Object.getOwnPropertyDescriptor,i8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?n8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&r8(t,r,o),o};const o8=1004;let a8=class{init(){this.zIndex={...this._renderZIndexService.zIndex,mask:o8,modalRenderBase:1005,modalFromRender:1006,modalFromToolbar:1007,expandRecord:1008,modalFromExpandRecord:1009,modalMessage:1010}}get maxZIndex(){const e=Object.values(this.zIndex);return Math.max(...e)}};var s8;i8([ao(sH)],a8.prototype,"_renderZIndexService",2),i8([Oi()],a8.prototype,"init",1),a8=i8([io()],a8),(e=>{e.isAbsolutePosi=function(e){return e&&!Lo(e.left)&&!Lo(e.top)},e.isAttachRefPosi=function(e){return e&&!!e.placement&&!!e.origin}})(s8||(s8={}));var l8=(e=>(e.MODAL="modal",e.DRAWER="drawer",e))(l8||{});const c8=$i.defineToken("ModalServiceToken"),u8=$i.defineToken("ModalContribution");var d8=Object.defineProperty,f8=Object.getOwnPropertyDescriptor,h8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?f8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&d8(t,r,o),o};let p8=class{constructor(){this._modals=new Map,this._hasInit=!1}init(){if(this._hasInit)return;this._hasInit=!0;const e=this._modalPluginProvider.getContributions();for(const t of e)try{t.registerModal(this)}catch(e){console.error(e)}}registerItem(e){const{id:t}=e;this._modals.has(t)&&this._modals.delete(t),this._modals.set(t,e)}getModalItem(e){return this._modals.get(e)}getModalItems(){return[...this._modals.values()]}};h8([wh(u8)],p8.prototype,"_modalPluginProvider",2),p8=h8([io()],p8);var g8=Object.defineProperty,m8=Object.getOwnPropertyDescriptor,v8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?m8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&g8(t,r,o),o};let y8=class extends fp{constructor(){super(...arguments),this._$scrollContainer=null,this._hasScrollListener=!1,this._scrolledCount=0,this._onScrollEmitter=this._register(new _p),this._onScroll=this._onScrollEmitter.event,this._scrolledDistance=0,this._scrollHandler=e=>{this._getScrollDistance(e),this._scrolledDistance>10&&this._onScrollEmitter.emit()}}attachScrollContainer(e){!e||(this._$scrollContainer=e)}attachScrollListener(e,t){this._hasScrollListener||this._addGlobalScrollListener();const r=this._onScroll((()=>{e()}));return this._scrolledCount++,{destroy:()=>{this._scrolledCount--,r.destroy(),this._scrolledCount<=0&&this._removeGlobalScrollListener()}}}_getScrollDistance(e){const t=Math.abs(e.deltaX),r=Math.abs(e.deltaY);this._scrolledDistance=r||t}_addGlobalScrollListener(){!this._$scrollContainer||this._$scrollContainer.addEventListener("wheel",this._scrollHandler,{passive:!0})}_removeGlobalScrollListener(){!this._$scrollContainer||this._$scrollContainer.removeEventListener("wheel",this._scrollHandler)}destroy(){super.destroy()}};v8([Ii()],y8.prototype,"destroy",1),y8=v8([io()],y8);const b8=e=>{const t=Object(a.useRef)(null),r=HL(y8);Object(a.useEffect)((()=>{r.attachScrollContainer(t.current);const n=r.attachScrollListener((t=>{"block"===e.scrollStrategy?(null==t||t.preventDefault(),null==t||t.stopPropagation()):"close"===e.scrollStrategy&&e.onScrollAutoClose()}));return()=>{n.destroy()}}),[]);const n={zIndex:e.zIndex,opacity:e.visible?1:0,...e.style&&e.style};return e.enable?s.a.createElement("div",{className:"lakex-workbench-modal-mask",onClick:t=>{e.maskClick&&e.maskClick(),t.preventDefault()},style:n,ref:t,onContextMenu:e=>(e.preventDefault(),!1)}):null};function _8(e){return jo(e)&&e.endsWith("%")}function w8(e){return jo(e)&&e.startsWith("calc(")}function C8(e){return _8(e)||w8(e)}function E8(e){return!yN(e)}function S8(e,t){if(!e)return 0;if(w8(e)){if((e=e.replace(/^(\s|calc\()+|(\s|\))+$/g,"")).includes("%")){const[r,n]=e.split("%");return DL(parseInt(r,10)/100*t+n)}}else if(_8(e)){const r=e.replace("%","");return parseInt(r,10)/100*t}return 0}const k8=e=>{var t,r,n;const i=e.id,o=dz(),l=HL(c8),c=l.visibleList.includes(i),u=Object(a.useRef)(null),[d,f,h,p]=_G(),g=Object(a.useRef)(null),m=Object(a.useRef)(null),v=Object(a.useMemo)((()=>l.isDisableEscClose(i)),[i]),y=Object(a.useMemo)((()=>l.isDisableClickAwayClose(i)),[i]);Object(a.useEffect)((()=>{const e=l.onChange((e=>{const t=Date.now();m.current=t,o()}));return()=>{e.destroy()}}),[]),yG("esc",(t=>{v||(t.preventDefault(),l.close(e.id))})),Object(a.useLayoutEffect)((()=>{u.current?c?f(u.current):h(u.current):h()}),[u,c]),Object(a.useEffect)((()=>{let e;const t=l.onUpdatePosition((t=>{t.modalId===i&&(clearTimeout(e),e=Oo((()=>{var e;const t=null==(e=u.current)?void 0:e.getBoundingClientRect();p(t||null)})))}));return()=>{t.destroy(),clearTimeout(e)}}),[]);const b=Object(a.useMemo)((()=>{if(l.getModalProps(e.id).mode!==l8.DRAWER)return l.getPosition(e.id,d)}),[e.id,d,null==d?void 0:d.height,null==d?void 0:d.width,m.current]);if(!c)return null;const _=l.getModalProps(e.id),w={left:null!=(t=null==b?void 0:b.left)?t:"initial",top:null!=(r=null==b?void 0:b.top)?r:"initial"},C={},E=(null==(n=null==_?void 0:_.position)?void 0:n.placement)||"";if(s8.isAttachRefPosi(_.position)&&"cover"===E){const e=E8(_.position.origin)?_.position.origin:_.position.origin.getBoundingClientRect();w.width=null==e?void 0:e.width,w.height=null==e?void 0:e.height,C.width="100%",C.height="100%"}const S=()=>{var t;null==(t=g.current)||t.onCloseByClickAwayOrScroll(),l.close(e.id)},k=e.RenderComponent,x=null!=_.hasMask?_.hasMask:e.showMask;return s.a.createElement("div",{className:qL("lakex-workbench-modal-container",{hasAnimation:e.hasAnimation,hasMask:x,[`lakex-workbench-modal-container-mode-${_.mode}`]:!0,[`lakex-workbench-modal-container-placement-${E}`]:!0}),style:{zIndex:e.zIndex,visibility:b||_.mode!==l8.MODAL?"visible":"hidden"}},s.a.createElement(b8,{zIndex:e.maskZIndex,scrollStrategy:e.scrollStrategy,style:e.maskStyle,maskClick:S,onScrollAutoClose:S,enable:!y,visible:x}),s.a.createElement("div",{className:"lakex-workbench-modal-layout",style:{zIndex:e.zIndex,..._.mode===l8.MODAL&&b&&w}},s.a.createElement("div",{className:"lakex-workbench-modal-content",ref:u,style:{...C}},s.a.createElement(k,{..._,ref:g}))))},x8=({initialState:e})=>{const{message:t=""}=e,r=HL(c8),[n,i]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{i(!0);const e=setTimeout((()=>{r.close("tooltip")}),2e3);return()=>{clearTimeout(e)}}),[t]),s.a.createElement("div",{className:qL("lakex-table-tooltip",{"lakex-table-tooltip-active":n,"lakex-table-tooltip-placement-top":!0})},s.a.createElement("div",{className:"lakex-table-tooltip-message"},t))},O8=$i.defineToken("ViewportServiceToken");var I8=Object.defineProperty,R8=Object.getOwnPropertyDescriptor,T8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?R8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&I8(t,r,o),o};let A8=class{getPosition(e,t){if(Ld(t)||Ld(t.width)||Ld(t.height))return null;let r=null;return s8.isAbsolutePosi(e)?r=this._calculateAbsolutePosition(e,t):s8.isAttachRefPosi(e)&&(r=this._calculateAutoPlacementPosition(e,t)),(null==r?void 0:r.top)&&Number(r.top)<0&&(r.top=0),(null==r?void 0:r.left)&&Number(r.left)<0&&(r.left=0),!r||wN(r.left)||wN(r.top)?(console.warn("modal size has conflicts with the placement in this origin and viewport"),null):r}_calculateAbsolutePosition(e,t){const r={left:e.left,top:e.top},n=this._getBoundingBox(),{width:i,height:o}=n,a=(null==t?void 0:t.height)||0,s=(null==t?void 0:t.width)||0;if(C8(e.left)){const t=S8(e.left,i);r.left=t-Math.floor(s/2)}if(C8(e.top)){const t=S8(e.top,o);r.top=t-Math.floor(a/2)}return r}_calculateAutoPlacementPosition(e,t){if(!t)return null;const r=E8(e.origin)?e.origin:e.origin.getBoundingClientRect(),n=this._getBoundingBox(),i=(null==t?void 0:t.width)||0,o=(null==t?void 0:t.height)||0,a=e.placement,s=this.getRenderRangeBox(r,a,o,i);if(this._rectIsContain(s,n))return{left:s.left,top:s.top};const l={left:s.left,top:s.top},c=s.top+s.height>n.bottom,u=s.top<n.top;if(c||u){const e=this._autoLayoutWithMinimalOffset(r.top,o,[n.top,n.bottom]);l.top=e}const d=s.left+s.width>n.right;if(s.left<n.left||d){const e=this._autoLayoutWithMinimalOffset(r.left,i,[n.left,n.right]);l.left=e}return l}_autoLayoutWithMinimalOffset(e,t,[r,n]){const i=e+t+5;return e>r&&i<n?e:e<r?e+=r-e:i>n?e-=i-n:0}_getBoundingBox(){return this._viewportService.getViewportRect()}getRenderRangeBox(e,t,r,n){const i={left:0,top:0,width:n,height:r};if("top"===t&&(i.top=e.top-r-5),("bottom"===t||"bottomRight"===t)&&(i.top=e.top+e.height+5),("top"===t||"bottom"===t)&&(i.left=e.left-0),"left"===t&&(i.left=e.left-n-5),"bottomRight"===t&&(i.left=e.left+e.width-n),"right"===t&&(i.left=e.left+e.width+5),"left"===t||"right"===t){const t=Math.ceil((r-e.height)/2);i.top=e.top-t}return"cover"===t&&(i.left=e.left,i.top=e.top,i.width=n,i.height=r),i}_rectIsContain(e,t){if(e.left<0||e.top<0)return!1;const[r,n,i,o]=[e.left,e.top,e.left+e.width,e.top+e.height],[a,s,l,c]=[t.left,t.top,t.left+t.width,t.top+t.height];return r>=a&&n>=s&&i<=l&&o<=c}};T8([ao(O8)],A8.prototype,"_viewportService",2),A8=T8([io()],A8);var M8=Object.defineProperty,N8=Object.getOwnPropertyDescriptor,D8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?N8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&M8(t,r,o),o};const P8="lakex-workbench-global-modal-container";let j8=class extends fp{constructor(){super(...arguments),this._onBeforeClose=this._register(new _p),this.onBeforeClose=this._onBeforeClose.event,this._onUpdatePosition=this._register(new _p),this.onUpdatePosition=this._onUpdatePosition.event,this._visibleList=[],this._visibleListOpenArgs=new Map,this._toDestroyList=new gp,this._onChange=this._register(new _p),this.onChange=this._onChange.event,this._onAppend=this._register(new _p),this.onAppend=this._onAppend.event}init(){this._modalRegistry.init(),this._innerModalRegister()}destroy(){this._toDestroyList.destroy()}_innerModalRegister(){this._modalRegistry.registerItem({id:"tooltip",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:x8})}showTooltip(e,t){this.open("tooltip",{position:t,initialState:{message:e}})}confirm(e){const t=this._zIndexService.maxZIndex,r=e.type||"confirm",n={...e,zIndex:t,getContainer:this._getOrCreateRoot()};C.a[r](n)}open(e,t){t&&this._visibleListOpenArgs.set(e,t),this._addVisible(e)}close(e){this._removeVisible(e),this._visibleListOpenArgs.delete(e)}closeTopVisible(){if(!this._hasVisibleModal())return;const e=this.getTopVisibleModalId();this._removeVisible(e)}getTopVisibleModalId(){return this._visibleList[this._visibleList.length-1]}_hasVisibleModal(){return this._visibleList.length>0}closeAll(){this._removeVisible()}getPosition(e,t){var r;const n=this._visibleListOpenArgs.get(e),i=null==(r=this._modalRegistry.getModalItem(e))?void 0:r.position,o=(null==n?void 0:n.position)||i;return o?this._modalLayoutService.getPosition(o,t):null}emitUpdatePosition(e){this._onUpdatePosition.emit({modalId:e})}getModalProps(e){var t;const r={...this._modalRegistry.getModalItem(e),...this._visibleListOpenArgs.get(e)||{}};return r.mode===l8.DRAWER&&!(null!=(t=r.position)&&t.placement)&&(r.position={placement:"right"}),{...r,mode:r.mode||l8.MODAL,position:r.position||{},initialState:r.initialState||{}}}render(){const e=this._modalRegistry.getModalItems();return e?e.map((e=>this.getRenderModal(e))):null}getRenderModal(e){const{id:t,RenderComponent:r,hasMask:n,mode:i=l8.MODAL,zIndex:o="modalFromToolbar",scrollStrategy:a="block",maskStyle:l,hasAnimation:u=!1}=e,d=this._zIndexService.zIndex[o],f=this._zIndexService.zIndex.mask,h=s.a.createElement(k8,{id:t,key:t,mode:i,showMask:n,maskStyle:l||{},zIndex:d,maskZIndex:f,scrollStrategy:a,hasAnimation:u,RenderComponent:r});return c.a.createPortal(h,this._getOrCreateRoot())}get visibleList(){return this._visibleList}_getModalRegisterInfo(e){return this._modalRegistry.getModalItem(e)}isModalVisible(e){return this._visibleList.includes(e)}isDisableEscClose(e){var t;return!(null==(t=this._getModalRegisterInfo(e))||!t.disableEscClose)}isDisableClickAwayClose(e){var t;return!(null==(t=this._getModalRegisterInfo(e))||!t.disableClickAwayClose)}_getOrCreateRoot(){const e=this._configurationService.getValue("modal.customModalContainer")||document.body;let t=e.querySelector(`.${P8}`);if(!t){const r=document.createElement("div");r.classList.add(P8),e.appendChild(r),t=r}return t}_addVisible(e){if(!this._isValidModal(e))return;const t=this._visibleList,r=[...new Set(t.concat(e))];this._notify(r)}_removeVisible(e){if(e&&!this._isValidModal(e))return;const t=this._visibleList;let r=[];if(e){if(!this._modalRegistry.getModalItem(e))return void console.error(`The Compo: ${e} is not registered`);r=t.filter((t=>t!==e)),this._onBeforeClose.emit({modalId:e})}else t.forEach((e=>{this._onBeforeClose.emit({modalId:e})}));this._notify(r)}_isValidModal(e){return Boolean(this._modalRegistry.getModalItem(e))}_notify(e){this._visibleList=e,this._onChange.emit(this._visibleList)}emitAppendEvent(e){return this._onAppend.emit(e)}};D8([ao(p8)],j8.prototype,"_modalRegistry",2),D8([ao(a8)],j8.prototype,"_zIndexService",2),D8([ao(A8)],j8.prototype,"_modalLayoutService",2),D8([ao(lp)],j8.prototype,"_configurationService",2),D8([Ii()],j8.prototype,"destroy",1),j8=D8([io({token:c8,contrib:[jL]})],j8);var F8=Object.defineProperty,V8=Object.getOwnPropertyDescriptor,L8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?V8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&F8(t,r,o),o};let $8=class{getRenderViewPort(){return this._renderContext.$root.getBoundingClientRect()}getViewportRect(){const e=document.documentElement.getBoundingClientRect();return new DOMRect(e.x,0,e.width,e.height)}};L8([ao(Wz)],$8.prototype,"_renderContext",2),$8=L8([io({token:O8})],$8);const B8=xo().contribution(u8).register(j8).register(p8).register(y8).register(A8).register(a8).register($8),U8=e=>{const t=HL(p8),r=HL(c8);return Object(a.useEffect)((()=>{null==t||t.registerItem(e),null==r||r.emitAppendEvent(e.id)}),[]),s.a.createElement(s.a.Fragment,null)};class z8 extends s.a.PureComponent{constructor(e){super(e),this._$renderRef=s.a.createRef(),this._toDestroyCollection=[],this.state={isRenderReady:!1,isWorkbenchReady:!1,key:+new Date}}componentDidMount(){this.props.attachRender(this._$renderRef.current);const{container:e}=this.props;this.toolbarService=e.get(P4),this.modalService=e.get(c8),this.setState({isRenderReady:!0}),this.props.initWorkbench(),this.setState({isWorkbenchReady:!0}),this.modalService.onAppend((e=>{this.forceUpdate()})),e.get(cI).log({type:"workbench",action:"workbenchReady"})}componentWillUnmount(){this._toDestroyCollection.forEach((e=>e.destroy()))}_getWorkbenchRender(){const{isWorkbenchReady:e}=this.state;return e?s.a.createElement(s.a.Fragment,null,s.a.createElement(iz,{onError:this.props.onError},this.toolbarService.render()),s.a.createElement(iz,{onError:this.props.onError},this.modalService.render())):null}render(){const e=this.props.container;return s.a.createElement(s.a.Fragment,null,s.a.createElement(iz,{onError:this.props.onError},s.a.createElement(E.a,{prefixCls:"ant"},s.a.createElement(zL,{value:{container:e,onError:this.props.onError},key:this.state.key},s.a.createElement("div",{className:"lakex-table-workbench-container"},this._getWorkbenchRender(),s.a.createElement(iz,{onError:this.props.onError},s.a.createElement("div",{className:"lakex-table-render-container",ref:this._$renderRef,onContextMenu:e=>e.preventDefault()})))))))}}class H8 extends hE{constructor(e){super(),this.render=null,this._options=e||{},this.$root=e.$root,this.container=e.container,this._loadCoreServices(),this.registerPlugins(e.plugins,{container:this.container}),this._registerContribs(e.contribs),this._mountComponent(),this._logger.log({type:"workbench",action:"workbenchInited",data:e})}attachRender(e){this._options.renderService.initDom(e,this.$root)}initWorkbench(){this._workbenchRegistry.init(),this.container.get(xh).status=kh.WorkbenchInited}destroy(){var e;null==(e=this.render)||e.destroy(),this._workbenchRegistry.destroy(),this.unregisterPlugins(this.container),this._unMountComponent()}_loadCoreServices(){this.container.register({token:BL,useValue:{$root:this.$root}}),this._workbenchRegistry=this.container.get($L)}get _logger(){return this.container.get(cI)}_mountComponent(){c.a.render(s.a.createElement(z8,{key:+new Date,container:this.container,attachRender:e=>this.attachRender(e),initWorkbench:()=>this.initWorkbench(),onError:this._options.onError}),this.$root)}_unMountComponent(){c.a.unmountComponentAtNode(this.$root)}_registerContribs(e){if(e)for(const t of e)this.container.register(t)}}var W8=Object.defineProperty,G8=Object.getOwnPropertyDescriptor,K8=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?G8(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&W8(t,r,o),o};const q8=1004;let Y8=class{init(){this.zIndex={...this._renderZIndexService.zIndex,mask:q8,modalRenderBase:1005,modalFromRender:1006,modalFromToolbar:1007,expandRecord:1008,modalFromExpandRecord:1009,modalMessage:1010}}get maxZIndex(){const e=Object.values(this.zIndex);return Math.max(...e)}};K8([ao(sH)],Y8.prototype,"_renderZIndexService",2),K8([Oi()],Y8.prototype,"init",1),Y8=K8([io()],Y8);const J8=xo().contribution(jL).register(Y8).register($L);class X8{constructor(){this.kernelContainer=bh.createChild(),this.renderContainer=this.kernelContainer.createChild(),this.workbenchContainer=this.renderContainer.createChild()}init(){this._loadGlobalServices(),this._loadKernelServices(),this._loadRenderServices(),this._loadWorkbenchServices()}destroy(){this._unloadGlobalServices(),this._unloadKernelServices(),this._unloadRenderServices(),this._unloadWorkbenchServices()}_loadGlobalServices(){this.kernelContainer.load(YD,!0),this.kernelContainer.load(gI,!0),this.kernelContainer.load(Dp,!0)}_unloadGlobalServices(){this.kernelContainer.unload(YD),this.kernelContainer.unload(gI),this.kernelContainer.unload(Dp)}_loadKernelServices(){this.kernelContainer.load(kw,!0),this.kernelContainer.load(SI,!0),this.kernelContainer.load(DI,!0),this.kernelContainer.load(tx,!0),this.kernelContainer.load(MR,!0),this.kernelContainer.load(eR,!0),this.kernelContainer.load(VR,!0),this.kernelContainer.load(iI,!0)}_unloadKernelServices(){this.kernelContainer.unload(kw),this.kernelContainer.unload(SI),this.kernelContainer.unload(DI),this.kernelContainer.unload(tx),this.kernelContainer.unload(MR),this.kernelContainer.unload(eR),this.kernelContainer.unload(VR),this.kernelContainer.unload(iI)}_loadRenderServices(){this.renderContainer.load(qD,!0),this.renderContainer.load(FD,!0),this.renderContainer.load(iW,!0),this.renderContainer.load(p6,!0),this.renderContainer.load(cG,!0),this.renderContainer.load(V6,!0),this.renderContainer.load(tG,!0)}_unloadRenderServices(){this.renderContainer.unload(qD),this.renderContainer.unload(FD),this.renderContainer.unload(iW),this.renderContainer.unload(p6),this.renderContainer.unload(cG),this.renderContainer.unload(V6),this.renderContainer.unload(tG)}_loadWorkbenchServices(){this.workbenchContainer.load(J8,!0),this.workbenchContainer.load(t8,!0),this.workbenchContainer.load(B8,!0)}_unloadWorkbenchServices(){this.workbenchContainer.unload(J8),this.workbenchContainer.unload(t8),this.workbenchContainer.unload(B8)}}class Z8{init(e,t){this.kernelContainer=e.kernelContainer,this.renderContainer=e.renderContainer,this.workbenchContainer=e.workbenchContainer,this.configurationService=this.kernelContainer.get(lp),this._registerKernelConfig(t.kernelPlugins),this._registerRenderConfig(t.renderPlugins),this._registerWorkbenchConfig(t.workbenchPlugins),this._setInitConfigData(t.settings)}_registerKernelConfig(e){this.configurationService.registerConfiguration({id:"development",type:"object",title:"开发配置",properties:{disableReactDevTools:{type:"boolean",description:"是否禁用 react 开发工具"}}}),this.configurationService.registerDefaultValue({"development.disableReactDevTools":!0}),this.registerPluginConfiguration(e,this.configurationService)}_registerRenderConfig(e){this.renderContainer.get(eG).initConfiguration(),this.renderContainer.get(F6).initConfiguration(),this.configurationService.registerConfiguration({id:"render",type:"object",title:"渲染",properties:{noRecord:{type:"boolean",description:"不渲染 record 数据，表单提交编辑器不需要加载 record"},showFieldIcon:{type:"boolean",description:"是否展示字段 icon"},mode:{type:"string",description:"通用渲染模式",enum:Object.values(jz)},autoActive:{type:"boolean",description:"是否自动激活"}}}),this.configurationService.registerDefaultValue({"render.noRecord":!1,"render.showFieldIcon":!0,"render.mode":jz.NORMAL,"render.autoActive":!0}),this.registerPluginConfiguration(e,this.configurationService)}_registerWorkbenchConfig(e){this.configurationService.registerConfiguration({id:"workbench",type:"object",title:"Workbench",properties:{toolbar:{type:"object",properties:{visible:{type:"boolean",description:"是否显示工具栏"}}}}}),this.configurationService.registerDefaultValue({"workbench.toolbar.visible":!0}),this.configurationService.registerConfiguration({id:"modal",type:"object",title:"弹出窗",properties:{mode:{type:"string",description:"通用弹出层模式",enum:Object.values(l8)},customModalContainer:{type:"object",description:"自定义弹出层容器，类型为 HTMLElement | undefined"}}}),this.configurationService.registerDefaultValue({"modal.mode":l8.MODAL,"modal.customModalContainer":void 0}),this.registerPluginConfiguration(e,this.configurationService)}_setInitConfigData(e){e&&this.configurationService.setValue(e)}registerPluginConfiguration(e,t){!e||e.forEach((e=>{e.registerConfiguration&&e.registerConfiguration(t)}))}}yh.config({lifecycle:$i.Lifecycle.singleton});class Q8{constructor(e){this._destroy=!1,this._containerService=new X8,this._configService=new Z8,this._errors=[],this._reactErrors=[],this._options=e,Dh.setLanguage(e.lang),this._containerService.init(),this._loadCoreServices(),this._lifeService.status=kh.Init,this._configService.init({kernelContainer:this._containerService.kernelContainer,renderContainer:this._containerService.renderContainer,workbenchContainer:this._containerService.workbenchContainer},e),this._configService.configurationService.getValue("development.disableReactDevTools")&&(()=>{const e=()=>{},t=window.__REACT_DEVTOOLS_GLOBAL_HOOK__;if("object"==typeof t)for(const[r,n]of Object.entries(t))t[r]="function"==typeof n?e:null})(),this._lifeService.status=kh.Configed,PL.isTraceDi&&this._addContainerSlowLog(),this.kernel=new FR({container:this._containerService.kernelContainer,plugins:this._filterPlugins(e.kernelPlugins),contribs:e.kernelContribs,settings:e.settings,data:e.data}),this.render=new rG({container:this._containerService.renderContainer,plugins:this._filterPlugins(e.renderPlugins),contribs:e.renderContribs,kernelService:this.kernel.kernelService,onError:(e,t)=>{var r,n;e&&this._errors.push(e),t&&this._reactErrors.push(t),null==(n=(r=this._options).onError)||n.call(r,e,t)}}),this.workbench=new H8({$root:this.$root,container:this._containerService.workbenchContainer,plugins:this._filterPlugins(e.workbenchPlugins),contribs:e.workbenchContribs,renderService:this.render.renderService,onError:(e,t)=>{var r,n;e&&this._errors.push(e),t&&this._reactErrors.push(t),null==(n=(r=this._options).onError)||n.call(r,e,t)}}),this._logger.log({type:"core",action:"editorInited",data:e}),e.onDataLoaded&&this.kernel.onDataLoaded(e.onDataLoaded),e.onCollabUsersChange&&this.kernel.kernelService.onCollabUsersChange(e.onCollabUsersChange),this.kernel.onFinishExecuteCommand((e=>{var t,r;e.context.isRemote||null==(r=(t=this._options).onChange)||r.call(t)})),this._lifeService.when(kh.Rendered,(()=>{var t;null==(t=e.onRendered)||t.call(e)})),this._storage=this._containerService.kernelContainer.get(zh),Oo((()=>{var t;null==(t=e.onLoad)||t.call(e,this)})),this.kernel.start()}get $root(){return this._options.$root}get readService(){return this._containerService.kernelContainer.get(KO)}get commandService(){return this._containerService.kernelContainer.get(zI)}get tableId(){return this.readService.getTable().get("uuid")}get _logger(){return this._containerService.kernelContainer.get(cI)}_loadCoreServices(){this._lifeService=this._containerService.kernelContainer.get(xh)}_filterPlugins(e){const{disablePlugins:t,enablePlugins:r}=this._options;return r?e.filter((e=>r.some((t=>t.startsWith("workbench-")||t.startsWith("render-")||t.startsWith("kernel-")?t===e.pluginName:e.pluginName.replace(/^(workbench|render|kernel)-/,"")===t)))):t?e.filter((e=>!t.some((t=>t.startsWith("workbench-")||t.startsWith("render-")||t.startsWith("kernel-")?t===e.pluginName:e.pluginName.replace(/^(workbench|render|kernel)-/,"")===t)))):e}_addContainerSlowLog(){const e=PN({filter:e=>Number(e.time)>40});this._containerService.kernelContainer.container.applyMiddleware(e),this._containerService.renderContainer.container.applyMiddleware(e),this._containerService.workbenchContainer.container.applyMiddleware(e)}getService(e){var t,r;try{return this._containerService.workbenchContainer.get(e)}catch{console.warn("Workbench container not found:",e);try{return this._containerService.renderContainer.get(e)}catch{console.warn("Render container not found:",e);try{return this._containerService.kernelContainer.get(e)}catch(n){return console.warn("Kernel container not found:",e),console.error(n),null==(r=(t=this._options).onError)||r.call(t,n),null}}}}getContent(){return this.kernel.getContent()}setContent(e){this.kernel.setContent(e)}setRecords(e,t){t&&this._storage.clear([gk.table]),this.kernel.setRecords(e)}setUsers(e){this.kernel.setUsers(e)}isEmptyTable(){return!(!this._destroy&&this.readService)||this.readService.isEmptyTable()}destroy(){this._destroy=!0,this.kernel.destroy(),this.render.destroy(),this.workbench.destroy(),this._containerService.destroy()}}const e9=null;Dh.setData({"$1 条记录":"$1 records","$1个筛选":"$1 filters","(空)":"(Empty)","上一个":"Previous","上一张":"Previous","上一条记录":"Prev row","上传失败":"Upload failure","上传失败，请重试":"Upload failure, please retry","上传超时，请重试":"Upload timeout, please retry","上周":"Last week","上月":"Last month","下一个":"Next","下一张":"Next","下一条记录":"Next row","下周":"Next week","下月":"Next month","下载图片":"Download Picture","不包含":"Not contains","不存在对应字段":"There is no corresponding field","不存在对应选项":"There is no corresponding option","不展示":"None","不是":"is not","不等于":"Not equal to","不能与其他列重名":"Field name must be unique","中":"Middle","为空":"is empty","人员":"Mention","今天":"Today","从大到小":"9 → 1","从小到大":"1 → 9","任务流转一目了然":"Task flow is clear at a glance","低":"Low","你还未进行任何分组":"You haven't done any grouping yet","你还未进行任何排序":"You haven't done any sorting yet","你还未进行任何筛选":"You haven't done any filtering yet","保存":"Save","保持排序":"Keep sort","修改人":"Update people","修改分组":"Edit group","修改分组人员":"Edit group member","修改分组名称":"Edit group name","修改时间":"Update time","关闭弹窗 (ESC)":"Close modal (ESC)","分组":"Group","分组设置":"Group configs","切换视图":"Switch View","列名不能为空":"Field name must not empty","列类型":"Field type","创建人":"creator","创建时间":"Create time","删除":"Delete","删除分组":"Delete group","删除列":"Remove field","删除图片":"Remove Picture","删除行":"Remove row","删除视图":"Remove view","删除记录":"Remove record","删除该条件":"Delete this condition","剪贴板里没有文件可粘贴":"There is no file in the clipboard to paste","副本":"Copy","包含":"Contains","包含一个":"has one of","包含所有":"has all of","升序":"Asc","单选":"Select","取消":"Cancel","取消分组":"Ungroup","取消排序后，可进行拖拽":"After unsorting, you can drag and drop","取消筛选":"Unfilter","可以快速新建一个单选列进行分组":"You can quickly create a select column for grouping","可搜索或新建选项":"Select an option or create one","合并为分组":"Merge into group","向上插入行":"Insert row above","向上插入记录":"Insert record above","向下插入行":"Insert row below","向下插入记录":"Insert record below","向右插入列":"Insert field right","向右插入记录":"Insert record right","向左插入列":"Insert field left","向左插入记录":"Insert record left","否":"Not","唯一数":"Unique","唯一数 $1":"Unique $1","唯一数占比":"Percent Unique","唯一数占比 $1":"Unique $1","图片":"Image","图片上传任务":"Image upload task","图片列表":"image list","基础":"Basis","复制":"Copy","复制失败，没有足够的列":"Copy failed, not enough columns","复制成功":"Copy success","复制视图":"Copy view","复制记录":"Copy record","复制链接":"Copy link","复选框":"Checkbox","多选":"Multi-select","大于":"Greater than","大于等于":"Greater than or equal to","完成":"Finish","实际尺寸":"Actual size","封面效果":"Cover displays","封面来源":"Cover source","小于":"Less than","小于等于":"Less than or equal to","展开行":"Expand row","展开行（Space）":"Expand row（Space）","展开记录":"Expand record","已勾选":"Checked","已勾选 $1":"Checked $1","已勾选占比":"Percent Checked","已勾选占比 $1":"Checked $1","已填写 $1":"Filled $1","已填写占比":"Percent Filled","已填写占比 $1":"Filled $1","已填写数":"Filled","已存在该选项，不可重复创建！":"This option already exists","已选择 $1 个单元格":"$1 cells selected","平均值":"Average","平均值 $1":"Avg $1","并且":"And","开头不是":"Not Starts with","开头是":"Starts with","当":"Where","当前处于保持排序状态，为您重新定位":"Re-locate when keep sort","当前浏览器不支持访问剪贴板数据，建议您使用 Chrome 浏览器访问":"Current browser don't support access clipboard data, we recommend that you use the Chrome browser to visit","成功复制 $1 个单元格":"$1 cells copied","或者":"Or","手机号码":"Phone","按":"By","按以下选项进行分组":"Group by options","按以下选项进行排序":"Sort by the following options","按本列分组":"Group by current col","按本列筛选":"Filter by current col","排序":"Sort","排序设置":"Sort settings","搜索":"Search","搜索人员":"Search member","搜索选项":"Search option","放大":"Zoom out","数字":"Number","数字类型只能输入数字":"Number type can only enter numbers","数据表列名":"Field name","数据表已达最大行数限制":"Records in this table is over limits","文件读取失败，请重新上传":"File read failed, please re-upload","文本":"Text","文档已保存":"Document has been saved","新增字段":"New field","新建分组":"New group","新建视图":"New view","新建选项":"New option","新建选项不能为空字符":"The new option cannot be an empty character","无封面":"No cover","无权访问当前视图":"Not authorized to access current view","日期":"Date","时间范围 $1 天":"RNG $1 days","时间范围 $1 月":"RNG $1 months","时间范围（日）":"Date Range(days)","时间范围（月）":"Date Range(months)","明天":"Tomorrow","昨天":"Yesterday","是":"is","显示字段名":"Show column name","暂无人员":"Empty","最大值":"Max","最大值 $1":"Max $1","最小值":"Min","最小值 $1":"Min $1","最早时间":"Earlist Date","最早时间 $1":"Earlist Date $1","最晚时间":"Lastest Date","最晚时间 $1":"Latest Date $1","未分组":"Ungrouped","未勾选":"Unchecked","未勾选 $1":"Unchecked $1","未勾选占比":"Percent Unchecked","未勾选占比 $1":"Unchecked $1","未命名记录":"Untitled record","未填写 $1":"Empty $1","未填写占比":"Percent Empty","未填写占比 $1":"Empty $1","未填写数":"Empty","未搜索到结果":"No data","本周":"This week","本地上传":"Local Upload","本月":"This month","本记录不属于该分组，点击其他区域将移走该记录":"This record will move to its new position when you select another record","本记录因排序规则会移动，点击其他区域将移走该记录":"This record will move to its new position when you select another record","本记录将被移动到新的排序位置":"Record moved","本记录将被移至新的分组":"Record moved","本记录将被过滤":"Record filtered","本记录已被筛选过滤，点击其他区域将隐藏该记录":"This record is no longer visible based on this view's filter, and will be hidden when you select another record","查找":"Search","查看视图需要编辑权限":"View current view requires edit permission","标题":"Title","正在处理粘贴内容...":"Processing pasted content...","求和":"Sum","求和 $1":"Sum $1","添加一个选项":"Add an option","添加下一个":"Add next","添加分组条件":"Add grouping conditions","添加排序条件":"Add sorting conditions","添加筛选":"Add filter","添加筛选条件":"Add filter","添加记录":"Add record","画册视图":"Gallery view","画册配置":"Gallery setting","直接粘贴或拖拽到这里":"Paste or drag directly here","看板暂无分组":"Kanban no grouping","看板视图":"Kanban view","看板配置":"Kanban setting","确定":"Confirm","确认":"Confirm",'确认要删除 "$1" 分组吗':'Are you sure you want to delete the "$1" group','确认要删除 "$1" 字段吗':'Are you sure you want to delete the "$1" field',"空":"Empty","等于":"Equal to","筛选":"Filter","粘贴":"Paste","粘贴失败, 请稍后重试":"Paste failed, please try again later","粘贴成功":"Pasted successfully","系统字段不支持粘贴修改":"System fields do not support paste modification","结尾不是":"Not ends with","结尾是":"Ends with","统计":"Calculation","编辑":"Edit","编辑列":"Edit field","编辑链接":"Edit link","缩小":"Zoom in","行高":"Row height","表单":"Form","表格视图":"Grid view","表格配置":"Table Config","裁剪":"Clip","规范化存储和展示数据":"Normalized storage and presentation of data","视图名称":"view name","记录总数":"Count","设置该列内容类型，支持文本、日期、数字、单选、多选等":"Set the content type of the column, support text, date, number, single select, multiple select, etc.","请上传":"Please upload","请输入":"Please enter","请输入关键词...":"Please enter a keyword...","请输入关键词搜索":"Please enter keywords to search","请输入有效手机号":"Please enter a valid mobile phone number","请输入有效邮箱":"Please enter a valid email address","请选择":"Please choose","输入格式有误":"Please enter a valid data","过去7天":"7 days ago","还未设置任何分组":"No groupings applied to this view","还未设置任何排序":"No sorts applied to this view","还未设置任何筛选":"No filters applied to this view","适合展示图片类数据":"Suitable for displaying image data","适应":"Fit","适应屏幕":"adapt to screen","选择一列进行分组":"Pick a field to group by","选择一列进行排序":"Pick a field to sort by","选择分组字段":"Select grouping field","选项倒序":"Last-First","选项名不能为空":"Option name cannot be empty","选项名不能超过最大长度限制":"Option name cannot be over max length","选项设置":"Filed options","选项顺序":"First-Last","邮箱":"Email","重命名视图":"Rename view","重新上传":"Upload again","链接":"Link","附件":"File","附件上传任务":"Attachment upload task","附件列表":"attachment list","降序":"Desc","非空":"is not empty","颜色":"Color","高":"High","高级":"Advanced","（空）":"(Empty)"});class t9 extends PI{destroy(){}execute(e){return this.writeService.importTable(e),!0}}t9.commandName="importTable";var r9=Object.defineProperty,n9=Object.getOwnPropertyDescriptor,i9=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?n9(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&r9(t,r,o),o};let o9=class{static pluginModule(){return xo().register(this)}init(){this.commandService.registerCommand(t9.commandName,t9)}};o9.pluginName="kernel-import",i9([ao(zI)],o9.prototype,"commandService",2),o9=i9([io({contrib:nR})],o9);const a9=new Map;const s9=typeof BroadcastChannel>"u"?class{constructor(e){this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:ov(t.newValue||"")}),(e=>{$m||addEventListener("storage",e)})(this._onChange)}postMessage(e){Bm.setItem(this.room,iv((e=>new Uint8Array(e))(e)))}close(){(e=>{$m||removeEventListener("storage",e)})(this._onChange)}}:BroadcastChannel,l9=e=>ag(a9,e,(()=>{const t=sg(),r=new s9(e);return r.onmessage=e=>t.forEach((t=>t(e.data,"broadcastchannel"))),{bc:r,subs:t}})),c9=(e,t)=>{Vg(e,0);const r=uy(t);Hg(e,r)},u9=(e,t,r)=>{Vg(e,1),Hg(e,oy(t,r))},d9=(e,t,r)=>{try{ny(t,lm(e),r)}catch(e){console.error("Caught error while handling a Yjs update",e)}},f9=d9,h9=(e,t,r,n)=>{const i=um(e);switch(i){case 0:((e,t,r)=>{u9(t,r,lm(e))})(e,t,r);break;case 1:d9(e,r,n);break;case 2:f9(e,r,n);break;default:throw new Error("Unknown message type")}return i},p9=3e4;class g9 extends hg{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const e=km();null!==this.getLocalState()&&p9/2<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach(((r,n)=>{n!==this.clientID&&p9<=e-r.lastUpdated&&this.states.has(n)&&t.push(n)})),t.length>0&&m9(this,t,"timeout")}),pg(3e3)),e.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,r=this.meta.get(t),n=void 0===r?0:r.clock+1,i=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:n,lastUpdated:km()});const o=[],a=[],s=[],l=[];null===e?l.push(t):null==i?null!=e&&o.push(t):(a.push(t),Ym(i,e)||s.push(t)),(o.length>0||s.length>0||l.length>0)&&this.emit("change",[{added:o,updated:s,removed:l},"local"]),this.emit("update",[{added:o,updated:a,removed:l},"local"])}setLocalStateField(e,t){const r=this.getLocalState();null!==r&&this.setLocalState({...r,[e]:t})}getStates(){return this.states}}const m9=(e,t,r)=>{const n=[];for(let r=0;r<t.length;r++){const i=t[r];if(e.states.has(i)){if(e.states.delete(i),i===e.clientID){const t=e.meta.get(i);e.meta.set(i,{clock:t.clock+1,lastUpdated:km()})}n.push(i)}}n.length>0&&(e.emit("change",[{added:[],updated:[],removed:n},r]),e.emit("update",[{added:[],updated:[],removed:n},r]))},v9=(e,t,r=e.states)=>{const n=t.length,i=Dg();Vg(i,n);for(let o=0;o<n;o++){const n=t[o],a=r.get(n)||null,s=e.meta.get(n).clock;Vg(i,n),Vg(i,s),Ug(i,JSON.stringify(a))}return Pg(i)},y9=(e,t)=>{if(!t)return Om(e);const r=am(e);"AES-GCM"!==fm(r)&&(e=>{Promise.reject(e)})(em("Unknown encryption algorithm"));const n=lm(r),i=lm(r);return crypto.subtle.decrypt({name:"AES-GCM",iv:n},t,i).then((e=>new Uint8Array(e)))},b9=Iv("y-webrtc");class _9{constructor(e,t,r){this.webrtcConns=new Map,this.bcConns=new Set,this._bcSubscriber=e=>y9(new Uint8Array(e),null).then((e=>this.mux((()=>{const t=this.readMessage(e,(()=>{}));t&&this.broadcastBcMessage(Pg(t))})))),this._docUpdateHandler=e=>{const t=Dg();Vg(t,0),((e,t)=>{Vg(e,2),Hg(e,t)})(t,e),this.broadcastRoomMessage(Pg(t))},this._awarenessUpdateHandler=({added:e,updated:t,removed:r})=>{const n=e.concat(t).concat(r),i=Dg();Vg(i,1),Hg(i,v9(this.awareness,n)),this.broadcastRoomMessage(Pg(i))},this._beforeUnloadHandler=()=>{m9(this.awareness,[this.doc.clientID],"window unload"),this.provider.roomManager.disconnect()},this.readMessage=(e,t)=>{const r=am(e),n=Dg(),i=um(r),o=this.awareness,a=this.doc;let s=!1;switch(i){case 0:{Vg(n,0);const e=h9(r,n,a,this);1===e&&!this.synced&&t(),0===e&&(s=!0);break}case 3:Vg(n,1),Hg(n,v9(o,Array.from(o.getStates().keys()))),s=!0;break;case 1:((e,t,r)=>{const n=am(t),i=km(),o=[],a=[],s=[],l=[],c=um(n);for(let t=0;t<c;t++){const t=um(n);let r=um(n);const c=JSON.parse(fm(n)),u=e.meta.get(t),d=e.states.get(t),f=void 0===u?0:u.clock;(f<r||f===r&&null===c&&e.states.has(t))&&(null===c?t===e.clientID&&null!=e.getLocalState()?r++:e.states.delete(t):e.states.set(t,c),e.meta.set(t,{clock:r,lastUpdated:i}),void 0===u&&null!==c?o.push(t):void 0!==u&&null===c?l.push(t):null!==c&&(Ym(c,d)||s.push(t),a.push(t)))}(o.length>0||s.length>0||l.length>0)&&e.emit("change",[{added:o,updated:s,removed:l},r]),(o.length>0||a.length>0||l.length>0)&&e.emit("update",[{added:o,updated:a,removed:l},r])})(o,lm(r),this),this.provider.emit("awareness-changed",[this.awareness.getStates()]);break;case 4:{const e=1===cm(r),t=fm(r);if(t!==this.peerId&&(this.bcConns.has(t)&&!e||!this.bcConns.has(t)&&e)){const r=[],n=[];e?(this.bcConns.add(t),n.push(t)):(this.bcConns.delete(t),r.push(t)),this.provider.emit("peers",[{added:n,removed:r,webrtcPeers:Array.from(this.webrtcConns.keys()),bcPeers:Array.from(this.bcConns)}]),this.broadcastBcPeerId()}break}default:return console.error("Unable to compute message"),n}return this.provider.emit("read-messaged",[{messageType:i}]),s?n:null},this.broadcastBcMessage=e=>((e,t)=>{if(!t)return Om(e);const r=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:r},t,e).then((e=>{const t=Dg();return Ug(t,"AES-GCM"),Hg(t,r),Hg(t,new Uint8Array(e)),Pg(t)}))})(e,null).then((e=>this.mux((()=>((e,t,r=null)=>{const n=l9(e);n.bc.postMessage(t),n.subs.forEach((e=>e(t,r)))})(this.name,e))))),this.broadcastRoomMessage=e=>{this.bcconnected&&this.broadcastBcMessage(e),this.broadcastWebrtcConn(e)},this.broadcastBcPeerId=()=>{if(this.provider.filterBcConns){const e=Dg();Vg(e,4),Fg(e,1),Ug(e,this.peerId),this.broadcastBcMessage(Pg(e))}},this.broadcastWebrtcConn=e=>{b9("broadcast message in ",fv,this.name,hv);let t=!1;const r=Dg();zg(r,e),this.webrtcConns.forEach((e=>{e.connected&&(t=!0);try{e.sendWebrtcConn(r)}catch{}})),t||this.provider.websocketManager.getConns().forEach((e=>{if(e.connected){const t=av(Pg(r));e.send({action:"broadcast",data:{type:"webrtc-encoder",topic:this.name,data:t}})}}))},this.bindWebsocket=()=>{this.provider.websocketManager.getConns().forEach((e=>{e.on("message",(e=>{const t=e.data;if("webrtc-encoder"===(null==t?void 0:t.type)){if(b9("receive message from websocket"),!t.data)return;const e=(e=>ov(e.replaceAll("-","+").replaceAll("_","/")))(t.data),r=this.readMessage(e,(()=>{}));null!==r&&this.broadcastWebrtcConn(Pg(r))}}))}))},this.checkIsSynced=()=>{let e=!0;this.webrtcConns.forEach((t=>{t.synced||(e=!1)})),(!e&&this.synced||e&&!this.synced)&&(this.synced=e,this.provider.emit("synced",[{synced:e}]),b9("synced ",fv,this.name,hv," with all peers"))},this.readPeerMessage=(e,t)=>{const r=e.room;return b9("received message from ",fv,e.remotePeerId,gv," (",r.name,")",hv,_v),this.readMessage(t,(()=>{e.synced=!0,b9("synced ",fv,r.name,hv," with ",fv,e.remotePeerId),this.checkIsSynced()}))},this.peerId=Sm(),this.doc=e,this.awareness=t.awareness,this.provider=t,this.synced=!1,this.name=r,this.mux=(()=>{let e=!0;return(t,r)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==r&&r()}})(),this.bcconnected=!1,typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof er.exports<"u"&&er.exports.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),this.provider.websocketManager.announce(this);((e,t)=>{l9(e).subs.add(t)})(this.name,this._bcSubscriber),this.bcconnected=!0,this.broadcastBcPeerId();const e=Dg();Vg(e,0),c9(e,this.doc),this.broadcastBcMessage(Pg(e));const t=Dg();Vg(t,0),u9(t,this.doc),this.broadcastBcMessage(Pg(t));const r=Dg();Vg(r,3),this.broadcastBcMessage(Pg(r));const n=Dg();Vg(n,1),Hg(n,v9(this.awareness,[this.doc.clientID])),this.broadcastBcMessage(Pg(n)),this.bindWebsocket()}disconnect(){this.provider.websocketManager.getConns().forEach((e=>{e.connected&&e.send({action:"broadcast",data:{type:"unsubscribe",topics:[this.name]}})})),m9(this.awareness,[this.doc.clientID],"disconnect");const e=Dg();Vg(e,4),Fg(e,0),Ug(e,this.peerId),this.broadcastBcMessage(Pg(e)),((e,t)=>{const r=l9(e),n=r.subs.delete(t);n&&0===r.subs.size&&(r.bc.close(),a9.delete(e))})(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach((e=>e.destroy()))}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof er.exports<"u"&&er.exports.off("exit",this._beforeUnloadHandler)}}class w9{constructor(){this._rooms=new Map}getNames(){return Array.from(this._rooms.keys())}forEach(e){this._rooms.forEach(e)}get(e){return this._rooms.get(e)}set(e,t){this._rooms.set(e,t)}openRoom(e,t,r){if(this._rooms.has(r))throw em(`A Yjs Doc connected to room "${r}" already exists!`);const n=new _9(e,t,r);return this._rooms.set(r,n),n}deleteRoom(e){this._rooms.delete(e)}disconnect(){this._rooms.forEach((e=>{e.disconnect()}))}destroy(){this.disconnect();const e=this._rooms.keys();for(const t of e)this.deleteRoom(t)}}const C9=3e4,E9=e=>{if(e.shouldConnect&&null===e.ws){const t=new WebSocket(e.url),r=e.binaryType;let n=null;r&&(t.binaryType=r),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=t=>{e.lastMessageReceived=km();const r=t.data,i="string"==typeof r?JSON.parse(r):r;i&&"pong"===i.type&&(clearTimeout(n),n=setTimeout(o,C9/2)),e.emit("message",[i,e])};const i=t=>{null!==e.ws&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:t},e])):e.unsuccessfulReconnects++,setTimeout(E9,vg(1200*mg(e.unsuccessfulReconnects+1),2500),e)),clearTimeout(n)},o=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=e=>i(e),t.onopen=()=>{e.lastMessageReceived=km(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),n=setTimeout(o,C9/2)}}};class S9 extends hg{constructor(e,{binaryType:t}={}){super(),this.url=e,this.ws=null,this.binaryType=t||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval((()=>{this.connected&&C9<km()-this.lastMessageReceived&&this.ws.close()}),C9/2),E9(this)}send(e){this.ws&&this.ws.send(JSON.stringify(e))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&null===this.ws&&E9(this)}}function k9(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var x9={exports:{}};!function(e,t){e.exports=function(){var e=Math.floor,t=Math.abs,r=Math.pow;return function(){function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){if(!s&&k9)return k9(a);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var o=k9,a=0;a<n.length;a++)i(n[a]);return i}return e}()({1:[function(e,t,r){function n(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e,t,r){return 3*(t+r)/4-r}function o(e){var t,r,o=n(e),a=o[0],s=o[1],l=new d(i(e,a,s)),c=0,f=0<s?a-4:a;for(r=0;r<f;r+=4)t=u[e.charCodeAt(r)]<<18|u[e.charCodeAt(r+1)]<<12|u[e.charCodeAt(r+2)]<<6|u[e.charCodeAt(r+3)],l[c++]=255&t>>16,l[c++]=255&t>>8,l[c++]=255&t;return 2===s&&(t=u[e.charCodeAt(r)]<<2|u[e.charCodeAt(r+1)]>>4,l[c++]=255&t),1===s&&(t=u[e.charCodeAt(r)]<<10|u[e.charCodeAt(r+1)]<<4|u[e.charCodeAt(r+2)]>>2,l[c++]=255&t>>8,l[c++]=255&t),l}function a(e){return c[63&e>>18]+c[63&e>>12]+c[63&e>>6]+c[63&e]}function s(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(16711680&e[o]<<16)+(65280&e[o+1]<<8)+(255&e[o+2]),i.push(a(n));return i.join("")}function l(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,l=r-n;a<l;a+=o)i.push(s(e,a,a+o>l?l:a+o));return 1===n?(t=e[r-1],i.push(c[t>>2]+c[63&t<<4]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(c[t>>10]+c[63&t>>4]+c[63&t<<2]+"=")),i.join("")}r.byteLength=function(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i},r.toByteArray=o,r.fromByteArray=l;for(var c=[],u=[],d=typeof Uint8Array>"u"?Array:Uint8Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,p=f.length;h<p;++h)c[h]=f[h],u[f.charCodeAt(h)]=h;u[45]=62,u[95]=63},{}],2:[function(){},{}],3:[function(e,t,n){(function(){(function(){var t=String.fromCharCode,i=Math.min;function o(e){if(2147483647<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=a.prototype,t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return d(e,t);if(ArrayBuffer.isView(e))return f(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=p(e);if(i)return i;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(0>e)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e,t,r){return l(e),0>=e||void 0===t?o(e):"string"==typeof r?o(e).fill(t,r):o(e).fill(t)}function u(e){return l(e),o(0>e?0:0|g(e))}function d(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|m(e,t),n=o(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}function f(e){for(var t=0>e.length?0:0|g(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(0>t||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=a.prototype,n}function p(e){if(a.isBuffer(e)){var t=0|g(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0===e.length?"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0:"number"!=typeof e.length||K(e.length)?o(0):f(e)}function g(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function m(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(e).length;default:if(i)return n?-1:B(e).length;t=(""+t).toLowerCase(),i=!0}}function v(e,t,r){var n=!1;if((void 0===t||0>t)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),0>=r)||(r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return O(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),K(r=+r)&&(r=i?0:e.length-1),0>r&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(0>r){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:_(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):_(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function _(e,t,r,n,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var a,s=1,l=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=(n+"").toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(2>e.length||2>t.length)return-1;s=2,l/=2,c/=2,r/=2}if(i){var u=-1;for(a=r;a<l;a++)if(o(e,a)!==o(t,-1===u?0:a-u))-1!==u&&(a-=a-u),u=-1;else if(-1===u&&(u=a),a-u+1===c)return u*s}else for(r+c>l&&(r=l-c),a=r;0<=a;a--){for(var d=!0,f=0;f<c;f++)if(o(e,a+f)!==o(t,f)){d=!1;break}if(d)return a}return-1}function w(e,t,r,n){r=+r||0;var i=e.length-r;n?(n=+n)>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a,s=0;s<n;++s){if(K(a=parseInt(t.substr(2*s,2),16)))return s;e[r+s]=a}return s}function C(e,t,r,n){return W(B(t,e.length-r),e,r,n)}function E(e,t,r,n){return W(U(t),e,r,n)}function S(e,t,r,n){return E(e,t,r,n)}function k(e,t,r,n){return W(H(t),e,r,n)}function x(e,t,r,n){return W(z(t,e.length-r),e,r,n)}function O(e,t,r){return 0===t&&r===e.length?q.fromByteArray(e):q.fromByteArray(e.slice(t,r))}function I(e,t,r){r=i(e.length,r);for(var n=[],o=t;o<r;){var a,s,l,c,u=e[o],d=null,f=239<u?4:223<u?3:191<u?2:1;o+f<=r&&(1===f?128>u&&(d=u):2===f?128==(192&(a=e[o+1]))&&127<(c=(31&u)<<6|63&a)&&(d=c):3===f?(a=e[o+1],s=e[o+2],128==(192&a)&&128==(192&s)&&2047<(c=(15&u)<<12|(63&a)<<6|63&s)&&(55296>c||57343<c)&&(d=c)):4===f&&(a=e[o+1],s=e[o+2],l=e[o+3],128==(192&a)&&128==(192&s)&&128==(192&l)&&65535<(c=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&l)&&1114112>c&&(d=c))),null===d?(d=65533,f=1):65535<d&&(d-=65536,n.push(55296|1023&d>>>10),d=56320|1023&d),n.push(d),o+=f}return R(n)}function R(e){var r=e.length;if(r<=4096)return t.apply(String,e);for(var n="",i=0;i<r;)n+=t.apply(String,e.slice(i,i+=4096));return n}function T(e,r,n){var o="";n=i(e.length,n);for(var a=r;a<n;++a)o+=t(127&e[a]);return o}function A(e,r,n){var o="";n=i(e.length,n);for(var a=r;a<n;++a)o+=t(e[a]);return o}function M(e,t,r){var n=e.length;(!t||0>t)&&(t=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=$(e[o]);return i}function N(e,r,n){for(var i=e.slice(r,n),o="",a=0;a<i.length;a+=2)o+=t(i[a]+256*i[a+1]);return o}function D(e,t,r){if(e%1!=0||0>e)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function j(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("Index out of range")}function F(e,t,r,n,i){return t=+t,r>>>=0,i||j(e,t,r,4),Y.write(e,t,r,n,23,4),r+4}function V(e,t,r,n,i){return t=+t,r>>>=0,i||j(e,t,r,8),Y.write(e,t,r,n,52,8),r+8}function L(e){if(2>(e=(e=e.split("=")[0]).trim().replace(J,"")).length)return"";for(;e.length%4!=0;)e+="=";return e}function $(e){return 16>e?"0"+e.toString(16):e.toString(16)}function B(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],a=0;a<n;++a){if(55295<(r=e.charCodeAt(a))&&57344>r){if(!i){if(56319<r){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===n){-1<(t-=3)&&o.push(239,191,189);continue}i=r;continue}if(56320>r){-1<(t-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,128>r){if(0>(t-=1))break;o.push(r)}else if(2048>r){if(0>(t-=2))break;o.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(t-=3))break;o.push(224|r>>12,128|63&r>>6,128|63&r)}else{if(!(1114112>r))throw new Error("Invalid code point");if(0>(t-=4))break;o.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}}return o}function U(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function z(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!(0>(t-=2));++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}function H(e){return q.toByteArray(L(e))}function W(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}var q=e("base64-js"),Y=e("ieee754");n.Buffer=a,n.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},n.INSPECT_MAX_BYTES=50,n.kMaxLength=2147483647,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch{return!1}}(),a.TYPED_ARRAY_SUPPORT||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){return a.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return a.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&null!=Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,a.alloc=function(e,t,r){return c(e,t,r)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(G(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,o=0,s=i(r,n);o<s;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(G(o,Uint8Array)&&(o=a.from(o)),!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},a.byteLength=m,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):v.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},a.prototype.compare=function(e,t,r,n,o){if(G(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),0>t||r>e.length||0>n||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var s=(o>>>=0)-(n>>>=0),l=(r>>>=0)-(t>>>=0),c=i(s,l),u=this.slice(n,o),d=e.slice(t,r),f=0;f<c;++f)if(u[f]!==d[f]){s=u[f],l=d[f];break}return s<l?-1:l<s?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),0<e.length&&(0>r||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return C(this,e,t,r);case"ascii":return E(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return k(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){var r=this.length;0>(e=~~e)?0>(e+=r)&&(e=0):e>r&&(e=r),0>(t=void 0===t?r:~~t)?0>(t+=r)&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=a.prototype,n},a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);for(var i=this[e],o=1,a=0;++a<t&&(o*=256);)i+=this[e+a]*o;return i>=(o*=128)&&(i-=r(2,8*t)),i},a.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);for(var i=t,o=1,a=this[e+--i];0<i&&(o*=256);)a+=this[e+--i]*o;return a>=(o*=128)&&(a-=r(2,8*t)),a},a.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),Y.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),Y.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),Y.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),Y.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,i){e=+e,t>>>=0,n>>>=0,i||P(this,e,t,n,r(2,8*n)-1,0);var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=255&e/o;return t+n},a.prototype.writeUIntBE=function(e,t,n,i){e=+e,t>>>=0,n>>>=0,i||P(this,e,t,n,r(2,8*n)-1,0);var o=n-1,a=1;for(this[t+o]=255&e;0<=--o&&(a*=256);)this[t+o]=255&e/a;return t+n},a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t>>>=0,!i){var o=r(2,8*n-1);P(this,e,t,n,o-1,-o)}var a=0,s=1,l=0;for(this[t]=255&e;++a<n&&(s*=256);)0>e&&0===l&&0!==this[t+a-1]&&(l=1),this[t+a]=255&(e/s>>0)-l;return t+n},a.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t>>>=0,!i){var o=r(2,8*n-1);P(this,e,t,n,o-1,-o)}var a=n-1,s=1,l=0;for(this[t+a]=255&e;0<=--a&&(s*=256);)0>e&&0===l&&0!==this[t+a+1]&&(l=1),this[t+a]=255&(e/s>>0)-l;return t+n},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return V(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return V(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var o=i-1;0<=o;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&128>i||"latin1"===n)&&(e=i)}}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%l]}return this};var J=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(e,t,r){(function(n){(function(){function i(){let e;try{e=r.storage.getItem("debug")}catch{}return!e&&typeof n<"u"&&"env"in n&&(e=n.env.DEBUG),e}r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"===e||(n++,"%c"===e&&(i=n))})),e.splice(i,0,r)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch{}},r.load=i,r.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch{}}(),r.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),t.exports=e("./common")(r);const{formatters:o}=t.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this)}).call(this,e("_process"))},{"./common":5,_process:12}],5:[function(e,r){r.exports=function(r){function n(e){function t(...e){if(!t.enabled)return;const i=t,o=+new Date,a=o-(r||o);i.diff=a,i.prev=r,i.curr=o,r=o,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,r)=>{if("%%"===t)return"%";s++;const o=n.formatters[r];if("function"==typeof o){const r=e[s];t=o.call(i,r),e.splice(s,1),s--}return t})),n.formatArgs.call(i,e),(i.log||n.log).apply(i,e)}let r,o=null;return t.namespace=e,t.useColors=n.useColors(),t.color=n.selectColor(e),t.extend=i,t.destroy=n.destroy,Object.defineProperty(t,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?n.enabled(e):o,set:e=>{o=e}}),"function"==typeof n.init&&n.init(t),t}function i(e,t){const r=n(this.namespace+(typeof t>"u"?":":t)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){const e=[...n.names.map(o),...n.skips.map(o).map((e=>"-"+e))].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.names=[],n.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(r).forEach((e=>{n[e]=r[e]})),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return n.colors[t(r)%n.colors.length]},n.enable(n.load()),n}},{ms:11}],6:[function(e,t){function r(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}t.exports=function(e,t,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof t&&(n=t,t=""),t&&(n.code=t);try{return r(e,n)}catch{n.message=e.message,n.stack=e.stack;const t=function(){};return t.prototype=Object.create(Object.getPrototypeOf(e)),r(new t,n)}}},{}],7:[function(e,t){function r(e){console&&console.warn&&console.warn(e)}function n(){n.init.call(this)}function i(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function o(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function a(e,t,n,a){var s,l,c;if(i(n),void 0===(l=e._events)?(l=e._events=Object.create(null),e._eventsCount=0):(void 0!==l.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),l=e._events),c=l[t]),void 0===c)c=l[t]=n,++e._eventsCount;else if("function"==typeof c?c=l[t]=a?[n,c]:[c,n]:a?c.unshift(n):c.push(n),0<(s=o(e))&&c.length>s&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=c.length,r(u)}return e}function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=s.bind(n);return i.listener=r,n.wrapFn=i,i}function c(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?h(i):d(i,i.length)}function u(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}function f(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function h(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function p(e,t,r){"function"==typeof e.on&&g(e,"error",t,r)}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}var m,v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};m=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var b=Number.isNaN||function(e){return e!=e};t.exports=n,t.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&p(e,i,{once:!0})}))},n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var _=10;Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(e){if("number"!=typeof e||0>e||b(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");_=e}}),n.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||b(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return o(this)},n.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(0<t.length&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)y(s,this,t);else{var l=s.length,c=d(s,l);for(r=0;r<l;++r)y(c[r],this,t)}return!0},n.prototype.addListener=function(e,t){return a(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return a(this,e,t,!0)},n.prototype.once=function(e,t){return i(t),this.on(e,l(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){return i(t),this.prependListener(e,l(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,n,o,a,s;if(i(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,a=r.length-1;0<=a;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,o=a;break}if(0>o)return this;0===o?r.shift():f(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},n.prototype.listeners=function(e){return c(this,e,!0)},n.prototype.rawListeners=function(e){return c(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):u.call(e,t)},n.prototype.listenerCount=u,n.prototype.eventNames=function(){return 0<this._eventsCount?m(this._events):[]}},{}],8:[function(e,t){t.exports=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},{}],9:[function(n,i,o){o.read=function(e,t,n,i,o){var a,s,l=8*o-i-1,c=(1<<l)-1,u=c>>1,d=-7,f=n?o-1:0,h=n?-1:1,p=e[t+f];for(f+=h,a=p&(1<<-d)-1,p>>=-d,d+=l;0<d;a=256*a+e[t+f],f+=h,d-=8);for(s=a&(1<<-d)-1,a>>=-d,d+=i;0<d;s=256*s+e[t+f],f+=h,d-=8);if(0===a)a=1-u;else{if(a===c)return s?NaN:1/0*(p?-1:1);s+=r(2,i),a-=u}return(p?-1:1)*s*r(2,a-i)},o.write=function(n,i,o,a,s,l){var c,u,d,f=Math.LN2,h=Math.log,p=8*l-s-1,g=(1<<p)-1,m=g>>1,v=23===s?r(2,-24)-r(2,-77):0,y=a?0:l-1,b=a?1:-1,_=0>i||0===i&&0>1/i?1:0;for(i=t(i),isNaN(i)||i===1/0?(u=isNaN(i)?1:0,c=g):(c=e(h(i)/f),1>i*(d=r(2,-c))&&(c--,d*=2),2<=(i+=1<=c+m?v/d:v*r(2,1-m))*d&&(c++,d/=2),c+m>=g?(u=0,c=g):1<=c+m?(u=(i*d-1)*r(2,s),c+=m):(u=i*r(2,m-1)*r(2,s),c=0));8<=s;n[o+y]=255&u,y+=b,u/=256,s-=8);for(c=c<<s|u,p+=s;0<p;n[o+y]=255&c,y+=b,c/=256,p-=8);n[o+y-b]|=128*_}},{}],10:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},{}],11:[function(e,r){var n=Math.round;function i(e){if(!(100<(e+="").length)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();return"years"===n||"year"===n||"yrs"===n||"yr"===n||"y"===n?315576e5*r:"weeks"===n||"week"===n||"w"===n?6048e5*r:"days"===n||"day"===n||"d"===n?864e5*r:"hours"===n||"hour"===n||"hrs"===n||"hr"===n||"h"===n?36e5*r:"minutes"===n||"minute"===n||"mins"===n||"min"===n||"m"===n?6e4*r:"seconds"===n||"second"===n||"secs"===n||"sec"===n||"s"===n?1e3*r:"milliseconds"===n||"millisecond"===n||"msecs"===n||"msec"===n||"ms"===n?r:void 0}}}function o(e){var r=t(e);return 864e5<=r?n(e/864e5)+"d":36e5<=r?n(e/36e5)+"h":6e4<=r?n(e/6e4)+"m":1e3<=r?n(e/1e3)+"s":e+"ms"}function a(e){var r=t(e);return 864e5<=r?s(e,r,864e5,"day"):36e5<=r?s(e,r,36e5,"hour"):6e4<=r?s(e,r,6e4,"minute"):1e3<=r?s(e,r,1e3,"second"):e+" ms"}function s(e,t,r,i){return n(e/r)+" "+i+(t>=1.5*r?"s":"")}r.exports=function(e,t){t=t||{};var r=typeof e;if("string"==r&&0<e.length)return i(e);if("number"===r&&isFinite(e))return t.long?a(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],12:[function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(u===setTimeout)return setTimeout(e,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch{try{return u.call(null,e,0)}catch{return u.call(this,e,0)}}}function o(e){if(d===clearTimeout)return clearTimeout(e);if((d===n||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch{try{return d.call(null,e)}catch{return d.call(this,e)}}}function a(){g&&h&&(g=!1,h.length?p=h.concat(p):m=-1,p.length&&s())}function s(){if(!g){var e=i(a);g=!0;for(var t=p.length;t;){for(h=p,p=[];++m<t;)h&&h[m].run();m=-1,t=p.length}h=null,g=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var u,d,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch{u=r}try{d="function"==typeof clearTimeout?clearTimeout:n}catch{d=n}}();var h,p=[],g=!1,m=-1;f.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new l(e,t)),1!==p.length||g||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(){return[]},f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],13:[function(e,t){(function(e){(function(){let r;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window>"u"?e:window):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))}).call(this)}).call(this,typeof Ri>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Ri)},{}],14:[function(e,t){(function(r,n){(function(){var i=e("safe-buffer").Buffer,o=n.crypto||n.msCrypto;t.exports=o&&o.getRandomValues?function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var n=i.allocUnsafe(e);if(0<e)if(65536<e)for(var a=0;a<e;a+=65536)o.getRandomValues(n.slice(a,a+65536));else o.getRandomValues(n);return"function"==typeof t?r.nextTick((function(){t(null,n)})):n}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,e("_process"),typeof Ri>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Ri)},{_process:12,"safe-buffer":30}],15:[function(e,t){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e,t,n){function i(e,r,n){return"string"==typeof t?t:t(e,r,n)}n||(n=Error);var o=function(e){function t(t,r,n){return e.call(this,i(t,r,n))||this}return r(t,e),t}(n);o.prototype.name=n.name,o.prototype.code=e,l[e]=o}function i(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return e+""})),2<r?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(e+"")}function o(e,t,r){return e.substr(!r||0>r?0:+r,t.length)===t}function a(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function s(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}var l={};n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,l;if("string"==typeof t&&o(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be",a(e," argument"))l="The ".concat(e," ").concat(n," ").concat(i(t,"type"));else{var c=s(e,".")?"property":"argument";l='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(i(t,"type"))}return l+=". Received type ".concat(typeof r)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=l},{}],16:[function(e,t){(function(r){(function(){function n(e){return this instanceof n?(s.call(this,e),l.call(this,e),this.allowHalfOpen=!0,void(e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",i))))):new n(e)}function i(){this._writableState.ended||r.nextTick(o,this)}function o(e){e.end()}var a=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=n;var s=e("./_stream_readable"),l=e("./_stream_writable");e("inherits")(n,s);for(var c,u=a(l.prototype),d=0;d<u.length;d++)c=u[d],n.prototype[c]||(n.prototype[c]=l.prototype[c]);Object.defineProperty(n.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(n.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(n.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(n.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(e,t){function r(e){return this instanceof r?void n.call(this,e):new r(e)}t.exports=r;var n=e("./_stream_transform");e("inherits")(r,n),r.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":19,inherits:10}],18:[function(e,t){(function(r,n){(function(){function i(e){return N.from(e)}function o(e){return N.isBuffer(e)||e instanceof D}function a(e,t,r){return"function"==typeof e.prependListener?e.prependListener(t,r):void(e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r))}function s(t,r,n){R=R||e("./_stream_duplex"),t=t||{},"boolean"!=typeof n&&(n=r instanceof R),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=B(this,t,"readableHighWaterMark",n),this.buffer=new L,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(!j&&(j=e("string_decoder/").StringDecoder),this.decoder=new j(t.encoding),this.encoding=t.encoding)}function l(t){if(R=R||e("./_stream_duplex"),!(this instanceof l))return new l(t);var r=this instanceof R;this._readableState=new s(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),M.call(this)}function c(e,t,r,n,o){T("readableAddChunk",t);var a,s=e._readableState;if(null===t)s.reading=!1,p(e,s);else if(o||(a=d(s,t)),a)K(e,a);else if(s.objectMode||t&&0<t.length)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===N.prototype||(t=i(t)),n)s.endEmitted?K(e,new G):u(e,s,t,!0);else if(s.ended)K(e,new H);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?u(e,s,t,!1):v(e,s)):u(e,s,t,!1)}else n||(s.reading=!1,v(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function u(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&g(e)),v(e,t)}function d(e,t){var r;return o(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new z("chunk",["string","Buffer","Uint8Array"],t)),r}function f(e){return 1073741824<=e?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function h(e,t){return 0>=e||0===t.length&&t.ended?0:t.objectMode?1:e==e?(e>t.highWaterMark&&(t.highWaterMark=f(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)):t.flowing&&t.length?t.buffer.head.data.length:t.length}function p(e,t){if(T("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?g(e):(t.needReadable=!1,!t.emittedReadable&&(t.emittedReadable=!0,m(e)))}}function g(e){var t=e._readableState;T("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(T("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(m,e))}function m(e){var t=e._readableState;T("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,S(e)}function v(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(y,e,t))}function y(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(T("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function b(e){return function(){var t=e._readableState;T("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&A(e,"data")&&(t.flowing=!0,S(e))}}function _(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function w(e){T("readable nexttick read 0"),e.read(0)}function C(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(E,e,t))}function E(e,t){T("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),S(e),t.flowing&&!t.reading&&e.read(0)}function S(e){var t=e._readableState;for(T("flow",t.flowing);t.flowing&&null!==e.read(););}function k(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function x(e){var t=e._readableState;T("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(O,t,e))}function O(e,t){if(T("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function I(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}var R,T;t.exports=l,l.ReadableState=s,e("events").EventEmitter;var A=function(e,t){return e.listeners(t).length},M=e("./internal/streams/stream"),N=e("buffer").Buffer,D=n.Uint8Array||function(){},P=e("util");T=P&&P.debuglog?P.debuglog("stream"):function(){};var j,F,V,L=e("./internal/streams/buffer_list"),$=e("./internal/streams/destroy"),B=e("./internal/streams/state").getHighWaterMark,U=e("../errors").codes,z=U.ERR_INVALID_ARG_TYPE,H=U.ERR_STREAM_PUSH_AFTER_EOF,W=U.ERR_METHOD_NOT_IMPLEMENTED,G=U.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(l,M);var K=$.errorOrDestroy,q=["error","close","destroy","pause","resume"];Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),l.prototype.destroy=$.destroy,l.prototype._undestroy=$.undestroy,l.prototype._destroy=function(e,t){t(e)},l.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=N.from(e,t),t=""),r=!0),c(this,e,t,!1,r)},l.prototype.unshift=function(e){return c(this,e,null,!0,!1)},l.prototype.isPaused=function(){return!1===this._readableState.flowing},l.prototype.setEncoding=function(t){j||(j=e("string_decoder/").StringDecoder);var r=new j(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this},l.prototype.read=function(e){T("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0===t.highWaterMark?0<t.length:t.length>=t.highWaterMark)||t.ended))return T("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?x(this):g(this),null;if(0===(e=h(e,t))&&t.ended)return 0===t.length&&x(this),null;var n,i=t.needReadable;return T("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&T("length less than watermark",i=!0),t.ended||t.reading?T("reading or ended",i=!1):i&&(T("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,!t.reading&&(e=h(r,t))),null===(n=0<e?k(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(!t.ended&&(t.needReadable=!0),r!==e&&t.ended&&x(this)),null!==n&&this.emit("data",n),n},l.prototype._read=function(){K(this,new W("_read()"))},l.prototype.pipe=function(e,t){function n(e,t){T("onunpipe"),e===f&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,o())}function i(){T("onend"),e.end()}function o(){T("cleanup"),e.removeListener("close",c),e.removeListener("finish",u),e.removeListener("drain",g),e.removeListener("error",l),e.removeListener("unpipe",n),f.removeListener("end",i),f.removeListener("end",d),f.removeListener("data",s),m=!0,h.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&g()}function s(t){T("ondata");var r=e.write(t);T("dest.write",r),!1===r&&((1===h.pipesCount&&h.pipes===e||1<h.pipesCount&&-1!==I(h.pipes,e))&&!m&&(T("false write response, pause",h.awaitDrain),h.awaitDrain++),f.pause())}function l(t){T("onerror",t),d(),e.removeListener("error",l),0===A(e,"error")&&K(e,t)}function c(){e.removeListener("finish",u),d()}function u(){T("onfinish"),e.removeListener("close",c),d()}function d(){T("unpipe"),f.unpipe(e)}var f=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,T("pipe count=%d opts=%j",h.pipesCount,t);var p=t&&!1===t.end||e===r.stdout||e===r.stderr?d:i;h.endEmitted?r.nextTick(p):f.once("end",p),e.on("unpipe",n);var g=b(f);e.on("drain",g);var m=!1;return f.on("data",s),a(e,"error",l),e.once("close",c),e.once("finish",u),e.emit("pipe",f),h.flowing||(T("pipe resume"),f.resume()),e},l.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=I(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},l.prototype.on=function(e,t){var n=M.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=0<this.listenerCount("readable"),!1!==i.flowing&&this.resume()):"readable"==e&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,T("on readable",i.length,i.reading),i.length?g(this):!i.reading&&r.nextTick(w,this)),n},l.prototype.addListener=l.prototype.on,l.prototype.removeListener=function(e,t){var n=M.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(_,this),n},l.prototype.removeAllListeners=function(e){var t=M.prototype.removeAllListeners.apply(this,arguments);return("readable"===e||void 0===e)&&r.nextTick(_,this),t},l.prototype.resume=function(){var e=this._readableState;return e.flowing||(T("resume"),e.flowing=!e.readableListening,C(this,e)),e.paused=!1,this},l.prototype.pause=function(){return T("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(T("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},l.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(T("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){T("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||!(r.objectMode||i&&i.length)||t.push(i)||(n=!0,e.pause())})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<q.length;o++)e.on(q[o],this.emit.bind(this,q[o]));return this._read=function(t){T("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(l.prototype[Symbol.asyncIterator]=function(){return void 0===F&&(F=e("./internal/streams/async_iterator")),F(this)}),Object.defineProperty(l.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(l.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(l.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),l._fromList=k,Object.defineProperty(l.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(l.from=function(t,r){return void 0===V&&(V=e("./internal/streams/from")),V(l,t,r)})}).call(this)}).call(this,e("_process"),typeof Ri>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Ri)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(e,t){function r(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new l);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(e){return this instanceof n?(d.call(this,e),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),void this.on("prefinish",i)):new n(e)}function i(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?o(this,null,null):this._flush((function(t,r){o(e,t,r)}))}function o(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new u;if(e._transformState.transforming)throw new c;return e.push(null)}t.exports=n;var a=e("../errors").codes,s=a.ERR_METHOD_NOT_IMPLEMENTED,l=a.ERR_MULTIPLE_CALLBACK,c=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,u=a.ERR_TRANSFORM_WITH_LENGTH_0,d=e("./_stream_duplex");e("inherits")(n,d),n.prototype.push=function(e,t){return this._transformState.needTransform=!1,d.prototype.push.call(this,e,t)},n.prototype._transform=function(e,t,r){r(new s("_transform()"))},n.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},n.prototype._destroy=function(e,t){d.prototype._destroy.call(this,e,(function(e){t(e)}))}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(e,t){(function(r,n){(function(){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){x(t,e)}}function o(e){return A.from(e)}function a(e){return A.isBuffer(e)||e instanceof M}function s(){}function l(t,r,n){O=O||e("./_stream_duplex"),t=t||{},"boolean"!=typeof n&&(n=r instanceof O),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=D(this,t,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){v(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function c(t){var r=this instanceof(O=O||e("./_stream_duplex"));return r||I.call(c,this)?(this._writableState=new l(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),void T.call(this)):new c(t)}function u(e,t){var n=new U;H(e,n),r.nextTick(t,n)}function d(e,t,n,i){var o;return null===n?o=new B:"string"!=typeof n&&!t.objectMode&&(o=new j("chunk",["string","Buffer"],n)),!o||(H(e,o),r.nextTick(i,o),!1)}function f(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=A.from(t,r)),t}function h(e,t,r,n,i,o){if(!r){var a=f(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else p(e,t,!1,s,n,i,o);return l}function p(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new $("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function g(e,t,n,i,o){--t.pendingcb,n?(r.nextTick(o,i),r.nextTick(S,e,t),e._writableState.errorEmitted=!0,H(e,i)):(o(i),e._writableState.errorEmitted=!0,H(e,i),S(e,t))}function m(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function v(e,t){var n=e._writableState,i=n.sync,o=n.writecb;if("function"!=typeof o)throw new V;if(m(n),t)g(e,n,i,t,o);else{var a=w(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||_(e,n),i?r.nextTick(y,e,n,a,o):y(e,n,a,o)}}function y(e,t,r,n){r||b(e,t),t.pendingcb--,n(),S(e,t)}function b(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function _(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,o=Array(n),a=t.corkedRequestsFree;a.entry=r;for(var s=0,l=!0;r;)o[s]=r,r.isBuf||(l=!1),r=r.next,s+=1;o.allBuffers=l,p(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,d=r.callback;if(p(e,t,!1,t.objectMode?1:c.length,c,u,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final((function(r){t.pendingcb--,r&&H(e,r),t.prefinished=!0,e.emit("prefinish"),S(e,t)}))}function E(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(C,e,t)))}function S(e,t){var r=w(t);if(r&&(E(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}function k(e,t,n){t.ending=!0,S(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function x(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}var O;t.exports=c,c.WritableState=l;var I,R={deprecate:e("util-deprecate")},T=e("./internal/streams/stream"),A=e("buffer").Buffer,M=n.Uint8Array||function(){},N=e("./internal/streams/destroy"),D=e("./internal/streams/state").getHighWaterMark,P=e("../errors").codes,j=P.ERR_INVALID_ARG_TYPE,F=P.ERR_METHOD_NOT_IMPLEMENTED,V=P.ERR_MULTIPLE_CALLBACK,L=P.ERR_STREAM_CANNOT_PIPE,$=P.ERR_STREAM_DESTROYED,B=P.ERR_STREAM_NULL_VALUES,U=P.ERR_STREAM_WRITE_AFTER_END,z=P.ERR_UNKNOWN_ENCODING,H=N.errorOrDestroy;e("inherits")(c,T),l.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(l.prototype,"buffer",{get:R.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(I=Function.prototype[Symbol.hasInstance],Object.defineProperty(c,Symbol.hasInstance,{value:function(e){return!!I.call(this,e)||this===c&&e&&e._writableState instanceof l}})):I=function(e){return e instanceof this},c.prototype.pipe=function(){H(this,new L)},c.prototype.write=function(e,t,r){var n=this._writableState,i=!1,l=!n.objectMode&&a(e);return l&&!A.isBuffer(e)&&(e=o(e)),"function"==typeof t&&(r=t,t=null),l?t="buffer":!t&&(t=n.defaultEncoding),"function"!=typeof r&&(r=s),n.ending?u(this,r):(l||d(this,n,e,r))&&(n.pendingcb++,i=h(this,n,l,e,t,r)),i},c.prototype.cork=function(){this._writableState.corked++},c.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest&&_(this,e))},c.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new z(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),c.prototype._write=function(e,t,r){r(new F("_write()"))},c.prototype._writev=null,c.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||k(this,n,r),this},Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),c.prototype.destroy=N.destroy,c.prototype._undestroy=N.undestroy,c.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),typeof Ri>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Ri)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(e,t){(function(r){(function(){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){return{value:e,done:t}}function o(e){var t=e[u];if(null!==t){var r=e[m].read();null!==r&&(e[p]=null,e[u]=null,e[d]=null,t(i(r,!1)))}}function a(e){r.nextTick(o,e)}function s(e,t){return function(r,n){e.then((function(){return t[h]?void r(i(void 0,!0)):void t[g](r,n)}),n)}}var l,c=e("./end-of-stream"),u=Symbol("lastResolve"),d=Symbol("lastReject"),f=Symbol("error"),h=Symbol("ended"),p=Symbol("lastPromise"),g=Symbol("handlePromise"),m=Symbol("stream"),v=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((n(l={get stream(){return this[m]},next:function(){var e=this,t=this[f];if(null!==t)return Promise.reject(t);if(this[h])return Promise.resolve(i(void 0,!0));if(this[m].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[f]?n(e[f]):t(i(void 0,!0))}))}));var n,o=this[p];if(o)n=new Promise(s(o,this));else{var a=this[m].read();if(null!==a)return Promise.resolve(i(a,!1));n=new Promise(this[g])}return this[p]=n,n}},Symbol.asyncIterator,(function(){return this})),n(l,"return",(function(){var e=this;return new Promise((function(t,r){e[m].destroy(null,(function(e){return e?void r(e):void t(i(void 0,!0))}))}))})),l),v);t.exports=function(e){var t,r=Object.create(y,(n(t={},m,{value:e,writable:!0}),n(t,u,{value:null,writable:!0}),n(t,d,{value:null,writable:!0}),n(t,f,{value:null,writable:!0}),n(t,h,{value:e._readableState.endEmitted,writable:!0}),n(t,g,{value:function(e,t){var n=r[m].read();n?(r[p]=null,r[u]=null,r[d]=null,e(i(n,!1))):(r[u]=e,r[d]=t)},writable:!0}),t));return r[p]=null,c(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[d];return null!==t&&(r[p]=null,r[u]=null,r[d]=null,t(e)),void(r[f]=e)}var n=r[u];null!==n&&(r[p]=null,r[u]=null,r[d]=null,n(i(void 0,!0))),r[h]=!0})),e.on("readable",a.bind(null,r)),r}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":24,_process:12}],22:[function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?r(Object(t),!0).forEach((function(r){i(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}));return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function s(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function l(e,t,r){c.prototype.copy.call(e,t,r)}var c=e("buffer").Buffer,u=e("util").inspect,d=u&&u.custom||"inspect";t.exports=function(){function e(){o(this,e),this.head=null,this.tail=null,this.length=0}return s(e,[{key:"push",value:function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t=c.allocUnsafe(e>>>0),r=this.head,n=0;r;)l(r.data,t,n),n+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(n+=o===i.length?i:i.slice(0,e),0==(e-=o)){o===i.length?(++r,this.head=t.next?t.next:this.tail=null):(this.head=t,t.data=i.slice(o));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++n,this.head=r.next?r.next:this.tail=null):(this.head=r,r.data=i.slice(o));break}++n}return this.length-=n,t}},{key:d,value:function(e,t){return u(this,n({},t,{depth:0,customInspect:!1}))}}]),e}()},{buffer:3,util:2}],23:[function(e,t){(function(e){(function(){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,o){var a=this,s=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return s||l?(o?o(t):t&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!o&&t?a._writableState?a._writableState.errorEmitted?e.nextTick(n,a):(a._writableState.errorEmitted=!0,e.nextTick(r,a,t)):e.nextTick(r,a,t):o?(e.nextTick(n,a),o(t)):e.nextTick(n,a)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:12}],24:[function(e,t){function r(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}function n(){}function i(e){return e.setHeader&&"function"==typeof e.abort}function o(e,t,s){if("function"==typeof t)return o(e,null,t);t||(t={}),s=r(s||n);var l=t.readable||!1!==t.readable&&e.readable,c=t.writable||!1!==t.writable&&e.writable,u=function(){e.writable||f()},d=e._writableState&&e._writableState.finished,f=function(){c=!1,d=!0,l||s.call(e)},h=e._readableState&&e._readableState.endEmitted,p=function(){l=!1,h=!0,c||s.call(e)},g=function(t){s.call(e,t)},m=function(){var t;return l&&!h?(e._readableState&&e._readableState.ended||(t=new a),s.call(e,t)):c&&!d?(e._writableState&&e._writableState.ended||(t=new a),s.call(e,t)):void 0},v=function(){e.req.on("finish",f)};return i(e)?(e.on("complete",f),e.on("abort",m),e.req?v():e.on("request",v)):c&&!e._writableState&&(e.on("end",u),e.on("close",u)),e.on("end",p),e.on("finish",f),!1!==t.error&&e.on("error",g),e.on("close",m),function(){e.removeListener("complete",f),e.removeListener("abort",m),e.removeListener("request",v),e.req&&e.req.removeListener("finish",f),e.removeListener("end",u),e.removeListener("close",u),e.removeListener("finish",f),e.removeListener("end",p),e.removeListener("error",g),e.removeListener("close",m)}}var a=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;t.exports=o},{"../../../errors":15}],25:[function(e,t){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(e,t){function r(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}function n(e){if(e)throw e}function i(e){return e.setHeader&&"function"==typeof e.abort}function o(t,n,o,a){a=r(a);var s=!1;t.on("close",(function(){s=!0})),void 0===c&&(c=e("./end-of-stream")),c(t,{readable:n,writable:o},(function(e){return e?a(e):(s=!0,void a())}));var l=!1;return function(e){if(!s)return l?void 0:(l=!0,i(t)?t.abort():"function"==typeof t.destroy?t.destroy():void a(e||new f("pipe")))}}function a(e){e()}function s(e,t){return e.pipe(t)}function l(e){return e.length&&"function"==typeof e[e.length-1]?e.pop():n}var c,u=e("../../../errors").codes,d=u.ERR_MISSING_ARGS,f=u.ERR_STREAM_DESTROYED;t.exports=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=l(t);if(Array.isArray(t[0])&&(t=t[0]),2>t.length)throw new d("streams");var i,c=t.map((function(e,r){var s=r<t.length-1;return o(e,s,0<r,(function(e){i||(i=e),e&&c.forEach(a),s||(c.forEach(a),n(i))}))}));return t.reduce(s)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(t,r){function n(e,t,r){return null==e.highWaterMark?t?e[r]:null:e.highWaterMark}var i=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;r.exports={getHighWaterMark:function(t,r,o,a){var s=n(r,a,o);if(null!=s){if(!isFinite(s)||e(s)!==s||0>s)throw new i(a?o:"highWaterMark",s);return e(s)}return t.objectMode?16:16384}}},{"../../../errors":15}],28:[function(e,t){t.exports=e("events").EventEmitter},{events:7}],29:[function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(e,t,r){function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,r){return a(e,t,r)}var o=e("buffer"),a=o.Buffer;a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=o:(n(o,r),r.Buffer=i),i.prototype=Object.create(a.prototype),n(a,i),i.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,r)},i.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=a(e);return void 0===t?n.fill(0):"string"==typeof r?n.fill(t,r):n.fill(t),n},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o.SlowBuffer(e)}},{buffer:3}],31:[function(e,t,r){function n(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function i(e){var t=n(e);if("string"!=typeof t&&(m.isEncoding===v||!v(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){var t;switch(this.encoding=i(e),this.encoding){case"utf16le":this.text=u,this.end=d,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=f,this.end=h,t=3;break;default:return this.write=p,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=m.allocUnsafe(t)}function a(e){return 127>=e?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e,t,r){var n=t.length-1;if(n<r)return 0;var i=a(t[n]);return 0<=i?(0<i&&(e.lastNeed=i-1),i):--n<r||-2===i?0:0<=(i=a(t[n]))?(0<i&&(e.lastNeed=i-2),i):--n<r||-2===i?0:0<=(i=a(t[n]))?(0<i&&(2===i?i=0:e.lastNeed=i-3),i):0}function l(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�"}}function c(e){var t=this.lastTotal-this.lastNeed,r=l(this,e);return void 0===r?this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length)):r}function u(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(55296<=n&&56319>=n)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function d(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function f(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function g(e){return e&&e.length?this.write(e):""}var m=e("safe-buffer").Buffer,v=m.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};r.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var r=s(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){return this.lastNeed<=e.length?(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),void(this.lastNeed-=e.length))}},{"safe-buffer":30}],32:[function(e,t){(function(e){(function(){function r(t){try{if(!e.localStorage)return!1}catch{return!1}var r=e.localStorage[t];return null!=r&&"true"===(r+"").toLowerCase()}t.exports=function(e,t){function n(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(r("noDeprecation"))return e;var i=!1;return n}}).call(this)}).call(this,typeof Ri>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Ri)},{}],"/":[function(e,t){function r(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}function n(e){console.warn(e)}const i=e("debug")("simple-peer"),o=e("get-browser-rtc"),a=e("randombytes"),s=e("readable-stream"),l=e("queue-microtask"),c=e("err-code"),{Buffer:u}=e("buffer"),d=65536;class f extends s.Duplex{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=a(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||a(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||f.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},f.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:o(),!this._wrtc)throw c(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(e){return void this.destroy(c(e,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch((e=>{this.destroy(c(e,"ERR_PC_PEER_IDENTITY"))})),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach((e=>{this.addStream(e)})),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof e)try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then((()=>{this.destroyed||(this._pendingCandidates.forEach((e=>{this._addIceCandidate(e)})),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())})).catch((e=>{this.destroy(c(e,"ERR_SET_REMOTE_DESCRIPTION"))})),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(c(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch((e=>{!t.address||t.address.endsWith(".local")?n("Ignoring unsupported ICE candidate."):this.destroy(c(e,"ERR_ADD_ICE_CANDIDATE"))}))}send(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,t){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(e){this.destroy(c(e,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach((t=>{this.addTrack(t,e)}))}}addTrack(e,t){if(this.destroying)return;if(this.destroyed)throw c(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const r=this._senderMap.get(e)||new Map;let n=r.get(t);if(n)throw n.removed?c(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):c(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");n=this._pc.addTrack(e,t),r.set(t,n),this._senderMap.set(e,r),this._needsNegotiation()}replaceTrack(e,t,r){if(this.destroying)return;if(this.destroyed)throw c(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const n=this._senderMap.get(e),i=n?n.get(r):null;if(!i)throw c(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),null==i.replaceTrack?this.destroy(c(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):i.replaceTrack(t)}removeTrack(e,t){if(this.destroying)return;if(this.destroyed)throw c(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const r=this._senderMap.get(e),n=r?r.get(t):null;if(!n)throw c(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(n):this.destroy(c(e,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach((t=>{this.removeTrack(t,e)}))}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,l((()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1})))}negotiate(){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout((()=>{this._createOffer()}),0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,(()=>{}))}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),l((()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()})))}_setupData(e){if(!e.channel)return this.destroy(c(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=d),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{const t=e.error instanceof Error?e.error:new Error(`Datachannel error: ${e.message} ${e.filename}:${e.lineno}:${e.colno}`);this.destroy(c(t,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval((()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1}),5e3)}_read(){}_write(e,t,r){if(this.destroyed)return r(c(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(e){return this.destroy(c(e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>d?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=r):r(null)}else this._debug("write before connect"),this._chunk=e,this._cb=r}_onFinish(){if(!this.destroyed){const e=()=>{setTimeout((()=>this.destroy()),1e3)};this._connected?e():this.once("connect",e)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout((()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))}),this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=r(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})}};this._pc.setLocalDescription(e).then((()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(c(e,"ERR_CREATE_OFFER"))}))}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach((e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))}))}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=r(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(e).then((()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(c(e,"ERR_CREATE_ANSWER"))}))}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(c(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),("connected"===e||"completed"===e)&&(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(c(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(c(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach((t=>{Object.assign(e,t)})),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then((r=>{const n=[];r.forEach((e=>{n.push(t(e))})),e(null,n)}),(t=>e(t))):0<this._pc.getStats.length?this._pc.getStats((r=>{if(this.destroyed)return;const n=[];r.result().forEach((e=>{const r={};e.names().forEach((t=>{r[t]=e.stat(t)})),r.id=e.id,r.type=e.type,r.timestamp=e.timestamp,n.push(t(r))})),e(null,n)}),(t=>e(t))):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats(((t,r)=>{if(this.destroyed)return;t&&(r=[]);const n={},i={},o={};let a=!1;r.forEach((e=>{("remotecandidate"===e.type||"remote-candidate"===e.type)&&(n[e.id]=e),("localcandidate"===e.type||"local-candidate"===e.type)&&(i[e.id]=e),("candidatepair"===e.type||"candidate-pair"===e.type)&&(o[e.id]=e)}));const s=e=>{a=!0;let t=i[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=+t.port):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=+t.portNumber):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=+t[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let r=n[e.remoteCandidateId];r&&(r.ip||r.address)?(this.remoteAddress=r.ip||r.address,this.remotePort=+r.port):r&&r.ipAddress?(this.remoteAddress=r.ipAddress,this.remotePort=+r.portNumber):"string"==typeof e.googRemoteAddress&&(r=e.googRemoteAddress.split(":"),this.remoteAddress=r[0],this.remotePort=+r[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(r.forEach((e=>{"transport"===e.type&&e.selectedCandidatePairId&&s(o[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&s(e)})),a||Object.keys(o).length&&!Object.keys(i).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(e){return this.destroy(c(e,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval((()=>this._onInterval()),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)}))};e()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>d)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach((e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0})),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=u.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach((t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some((e=>e.id===t.id))||(this._remoteStreams.push(t),l((()=>{this._debug("on stream"),this.emit("stream",t)})))}))}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],i.apply(null,e)}}f.WEBRTC_SUPPORT=!!o(),f.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},f.channelConfig={},t.exports=f},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")}()}(x9);const O9=x9.exports,I9=Iv("y-webrtc");class R9{constructor(e,t,r,n){this._wsEnabled=!1,this._handleData=e=>{const t=this.room.readPeerMessage(this,e);null!==t&&this.sendWebrtcConn(t)},this._handleConnect=()=>{this.connected=!0;const e=this.room.provider.doc,t=this.room.awareness,r=Dg();Vg(r,0),c9(r,e),this.sendWebrtcConn(r);const n=t.getStates();if(n.size>0){const e=Dg();Vg(e,1),Hg(e,v9(t,Array.from(n.keys()))),this.sendWebrtcConn(e)}},this._handleClose=()=>{var e;this.connected=!1,this.closed=!0,this.room.webrtcConns.has(this.remotePeerId)&&(this.room.webrtcConns.delete(this.remotePeerId),this.room.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(this.room.webrtcConns.keys()),bcPeers:Array.from(this.room.bcConns)}])),this.room.checkIsSynced(),null==(e=this.peer)||e.destroy(),this.room.provider.websocketManager.announce(this.room)},this._handleError=()=>{this._wsEnabled=!0,I9("webrtc enable websocket conn backup",fv),this._handleConnect()},this.sendWebrtcConn=e=>{if(I9("send webrtc message to ",fv,this.remotePeerId,hv,gv," (",this.room.name,")",_v),this.peer)try{if(this._wsEnabled){const t=av(Pg(e));this.websocketConn.send({action:"broadcast",data:{type:"webrtc-encoder",topic:this.room.name,data:t}})}else this.peer.send(Pg(e))}catch(e){console.error(e)}},I9("webrtc establishing connection to ",fv,r),this.websocketConn=e,this.room=n,this.remotePeerId=r,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new O9({initiator:t,...n.provider.peerOpts}),this.bindWebrtc()}bindWebrtc(){this.peer.on("signal",(e=>{void 0===this.glareToken&&(this.glareToken=Date.now()+Math.random()),this.websocketConn.publishMessage(this.room,{to:this.remotePeerId,from:this.room.peerId,type:"signal",token:this.glareToken,signal:e})})),this.peer.on("connect",(()=>{I9("webrtc connected to ",fv,this.remotePeerId),this._handleConnect()})),this.peer.on("close",(()=>{this._handleClose(),I9("webrtc closed connection to ",fv,this.remotePeerId)})),this.peer.on("error",(e=>{I9("Error in webrtc connection to ",fv,this.remotePeerId,": ",e),this._handleError()})),this.peer.on("data",(e=>{this._handleData(e)}))}destroy(){this.peer.destroy()}}const T9=Iv("y-webrtc");class A9 extends S9{constructor(e,t){super(e),this.providers=new Set,this.publishMessage=(e,t)=>{this.send({action:"broadcast",data:{type:"y-publish",topic:e.name,data:t}})},this.url=e,this.roomManager=t,this.bindConnect(),this.bindMessage(),this.bindDisconnect()}bindConnect(){this.on("connect",(()=>{T9(`websocket connected (${this.url})`);const e=this.roomManager.getNames();this.send({action:"broadcast",data:{type:"subscribe",topics:e}}),this.roomManager.forEach((e=>this.publishMessage(e,{type:"announce",from:e.peerId})))}))}bindMessage(){this.on("message",(e=>{const t=e.data;if("y-publish"===(null==t?void 0:t.type)){const e=t.topic,r=this.roomManager.get(e);if(null==r||"string"!=typeof e)return;const n=r.webrtcConns,i=r.peerId;if(null==t.data||t.data.from===i||void 0!==t.data.to&&t.data.to!==i||r.bcConns.has(t.data.from))return;const o=n.has(t.data.from)?()=>{}:()=>r.provider.emit("peers",[{removed:[],added:[t.data.from],webrtcPeers:Array.from(r.webrtcConns.keys()),bcPeers:Array.from(r.bcConns)}]);switch(t.data.type){case"announce":n.size<r.provider.maxConns&&(ag(n,t.data.from,(()=>new R9(this,!0,t.data.from,r))),o());break;case"signal":if("offer"===t.data.signal.type){const e=n.get(t.data.from);if(e){const r=t.data.token,n=e.glareToken;if(n&&n>r)return void T9("offer rejected: ",t.data.from);e.glareToken=void 0}}if("answer"===t.data.signal.type){T9("offer answered by: ",t.data.from);n.get(t.data.from).glareToken=void 0}t.data.to===i&&(ag(n,t.data.from,(()=>new R9(this,!1,t.data.from,r))).peer.signal(t.data.signal),o())}}}))}bindDisconnect(){this.on("disconnect",(()=>T9(`websocket disconnect (${this.url})`)))}}class M9 extends fg{constructor(e){super(),this._conns=new Map,this.announce=e=>{this._conns.forEach((t=>{t.connected&&(t.send({action:"broadcast",data:{type:"subscribe",topics:[e.name]}}),e.webrtcConns.size<e.provider.maxConns&&t.publishMessage(e,{type:"announce",from:e.peerId}))}))},this._provider=e}createConn(e,t){const r=ag(this._conns,e,(()=>new A9(e,t)));this._conns.set(e,r),r.on("connect",(()=>{this.emit("connect",[r])})),r.providers.add(this._provider)}getConns(){return this._conns}disconnect(){this._conns.forEach((e=>{e.providers.delete(this),0===e.providers.size&&(e.destroy(),this._conns.delete(e.url))}))}destroy(){this.disconnect(),super.destroy()}}class N9 extends fg{constructor(e,t,{signalUrls:r,awareness:n=new g9(t),maxConns:i=20+pg(15*wm()),filterBcConns:o=!0,peerOpts:a={config:{iceServers:[{urls:"stun:stun.syncthing.net:3478"},{urls:"stun:stun.qq.com:3478"},{urls:"stun:freestun.net:3479"},{urls:"stun:freestun.net:5350"},{urls:"stun:111.206.174.2:3478"},{urls:"stun:stun.miwifi.com:3478"},{urls:"stun:stun.newtocktech.com:3478"}]}}}={}){super(),this.roomName=e,this.doc=t,this.filterBcConns=o,this.awareness=n,this.shouldConnect=!1,this.signalUrls=r,this.maxConns=i,this.peerOpts=a,this.room=new _9(this.doc,this,this.roomName),this.roomManager=new w9,this.roomManager.set(this.roomName,this.room),this.websocketManager=new M9(this),this.connect(),t.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalUrls.forEach((e=>{this.websocketManager.createConn(e,this.roomManager)})),this.websocketManager.once("connect",(()=>{this.room&&this.room.connect()}))}disconnect(){this.shouldConnect=!1,this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.room.destroy(),this.roomManager.destroy(),this.websocketManager.destroy(),super.destroy()}}var D9=Object.defineProperty,P9=Object.getOwnPropertyDescriptor,j9=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?P9(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&D9(t,r,o),o};let F9=class{constructor(){this.provider=null,this.handleFlush=vN((()=>{this._kernelService._onDataChanged.emit("collab-synced")}),300),this.handleAwareness=e=>{const t=[];for(const r of e.values())null!=r&&r.user&&t.push(r.user);return this._kernelService._onCollabUsersChange.emit(t),t}}bindEvent(){this.doc=this._struct.doc;const e=this._configuration.getValue("collab.urls"),t=this._configuration.getValue("collab.roomId");this.provider=new N9(t,this.doc,{signalUrls:e}),this.provider.awareness.setLocalStateField("user",this._readService.currentUser),this.provider.on("read-messaged",this.handleFlush),this.provider.on("awareness-changed",this.handleAwareness)}destroy(){var e,t;null==(e=this.provider)||e.destroy(),null==(t=this.provider)||t.off("read-messaged",this.handleFlush),this.provider=null}};j9([ao(lp)],F9.prototype,"_configuration",2),j9([ao(jR)],F9.prototype,"_kernelService",2),j9([ao(KO)],F9.prototype,"_readService",2),j9([ao(Pp)],F9.prototype,"_struct",2),F9=j9([io()],F9);var V9=Object.defineProperty,L9=Object.getOwnPropertyDescriptor,$9=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?L9(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&V9(t,r,o),o};let B9=class{constructor(){this._spells=[],this.startTask=vN((()=>{this._spells.length>0&&(this.collabDoc.submitCommand({spells:this._spells,user:this._readService.currentUser}),this._spells=[])}),1e3)}bindEvent(e){this.collabDoc=e;const t=this._configuration.getValue("collab.skipTable");this.collabDoc.on("command",(e=>{var r,n;const{user:i}=e[0],o=e[0].spells;let a=!1;for(const e of o){if(!e||(null==t?void 0:t.includes(e.table)))return;if(e.isRemote=!0,this._contentService.setUsers([i]),this._driver.execute(e),["field_boolean","field_date","field_number","field_select","field_string","field_uri"].includes(e.table)){const t=null==(r=e.where)?void 0:r.field_uuid;let i=null==(n=e.where)?void 0:n.record_uuid;Array.isArray(i)||(i=[i]);for(const e of i)t&&e&&this._eventService._onCellChange.emit({fieldId:t,recordId:e,cellValue:this._readService.getCell(t,e)});a=!0}}a&&this._writeService.refreshView(),this._kernelService._onDataChanged.emit("spell-execute")})),this._modelEvent.onChange((({spell:e})=>{e.isRemote||(null==t?void 0:t.includes(e.table))||this.collabSpell(e)}))}collabSpell(e){this._spells.push(e),this.startTask()}destroy(){this._spells=null,this.collabDoc=null}};$9([ao(lp)],B9.prototype,"_configuration",2),$9([ao(KO)],B9.prototype,"_readService",2),$9([ao(nI)],B9.prototype,"_writeService",2),$9([ao(jR)],B9.prototype,"_kernelService",2),$9([ao(Lh)],B9.prototype,"_modelEvent",2),$9([ao(jh)],B9.prototype,"_driver",2),$9([ao(xO)],B9.prototype,"_contentService",2),$9([ao(Bk)],B9.prototype,"_eventService",2),$9([Ii()],B9.prototype,"destroy",1),B9=$9([io()],B9);var U9=Object.defineProperty,z9=Object.getOwnPropertyDescriptor,H9=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?z9(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&U9(t,r,o),o};let W9=class{constructor(){this.isBindedEvent=!1}init(){if(!this._configuration.getValue("collab.enable"))return;const e=this._configuration.getValue("collab.type");if(e===VN.SPELL){const e=this._configuration.getValue("collab.emitter");if(!e)return;e.docReady&&(this.collabDoc=e.doc),e.on("docReady",(e=>{this.collabDoc=e,setTimeout((()=>{this.isRendered&&!this.isBindedEvent&&this.bindEvent()}),1e3)}))}else e===VN.YJS&&setTimeout((()=>{this.isRendered&&!this.isBindedEvent&&this.bindEvent()}),1e3);this._lifecycleService.when(kh.Rendered,(()=>{this.isRendered=!0,setTimeout((()=>{this.bindEvent()}),1e3)}))}bindEvent(){if(this.isBindedEvent)return;const e=this._configuration.getValue("collab.type");e===VN.SPELL?this._bindSpell.bindEvent(this.collabDoc):e===VN.YJS&&this._collabYjs.bindEvent(),this.isBindedEvent=!0}destroy(){var e;null==(e=this._collabYjs)||e.destroy()}};H9([ao(xh)],W9.prototype,"_lifecycleService",2),H9([ao(lp)],W9.prototype,"_configuration",2),H9([ao(B9)],W9.prototype,"_bindSpell",2),H9([ao(F9)],W9.prototype,"_collabYjs",2),H9([Ii()],W9.prototype,"destroy",1),W9=H9([io()],W9);var G9=Object.defineProperty,K9=Object.getOwnPropertyDescriptor,q9=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?K9(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&G9(t,r,o),o};let Y9=class{static pluginModule(){return xo().contribution(FN).register(W9).register(B9).register(F9).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"collab",type:"object",properties:{enable:{type:"boolean",description:"是否开启协同模式"},roomId:{type:"string",description:"协同房间id"},urls:{type:"array",description:"协同链接队列"},type:{type:"string",description:"协同模式",enum:Object.values(VN)}}}),e.registerDefaultValue({"collab.enable":!1,"collab.type":VN.YJS})}init(){this._collabService.init()}destroy(){this._collabService.destroy()}};Y9.pluginName="kernel-collaboration",q9([ao(W9)],Y9.prototype,"_collabService",2),Y9=q9([io({contrib:nR})],Y9);const J9=[yj,rP,cP,mP,EP,TP,FP,HP,XP,ij,dj,kj,Mj,Lj,Gj,Qj,aF,hF,_F,RF,jF,$F,GF,eV,cV,yV,IV,jV,zV,o9,SF,Y9,qV,tL,aL,fL,mL,wL];function X9(e){const t=HL(bR);return{isReadonly:(...r)=>(null==t?void 0:t.isReadonly(e,...r))||!1,can:(r,...n)=>(null==t?void 0:t.can(r,e,...n))||!1,canCreate:(...r)=>(null==t?void 0:t.canCreate(e,...r))||!1,canDelete:(...r)=>(null==t?void 0:t.canDelete(e,...r))||!1,canUpdate:(...r)=>(null==t?void 0:t.canUpdate(e,...r))||!1,canRead:(...r)=>(null==t?void 0:t.canRead(e,...r))||!1}}function Z9(){const e=HL(KO),t=HL(jR),r=e.getActiveView(),[n,i]=Object(a.useState)(r),o=Object(a.useCallback)((()=>{const t=e.getActiveView();i(t)}),[e]);return Object(a.useLayoutEffect)((()=>{const e=t.onDataLoaded((()=>{o()})),r=t.onDataChanged((()=>{o()}));return()=>{e.destroy(),r.destroy()}}),[t,o]),n}function Q9(){const e=HL(KO),t=HL(jR),[r,n]=Object(a.useState)(e.getViews()),i=()=>{const t=e.getViews();n(t)};return Object(a.useEffect)((()=>{const e=t.onDataLoaded((()=>{i()})),r=t.onDataChanged((()=>{i()}));return()=>{e.destroy(),r.destroy()}}),[]),r}function e7(){const e=HL(KO),t=HL(jR),r=HL(ZO),n=()=>{var t;const r=e.getActiveView(),n=null==(t=e.getViewGroup())?void 0:t.group,i=e.getViewFieldGroups(),o=n?null:e.getViewRecords(),a=n?e.getGroupViewRecords():null,s=e.getViewFields(),l=e.getViewConfig(),c=e.getViewFilters();return{view:r,group:n,fields:e.getAllFields(),fieldGroups:i,viewRecords:o,groupViewRecords:a,viewFields:s,viewConfig:l,filters:c}},[i,o]=Object(a.useState)(n()),s=e=>{e=e||n(),o(e)};return Object(a.useEffect)((()=>{const e=t.onDataLoaded((()=>{s()})),r=t.onDataChanged((()=>{s()}));return()=>{e.destroy(),r.destroy()}}),[]),Object(a.useEffect)((()=>{const t=r.onBeforeRefresh((({commandName:t,params:r})=>{if("setCell"===t){const t=n(),i=(t,r)=>{for(const n of t)if(n.get("record_uuid")===r.recordId){const t=e.getViewRecordCells(n.get("view_uuid"),n.get("record_uuid"));for(const e of t)if(e.fieldId===r.fieldId){e.value=r.value,e.temp=!0;break}break}};if(t.group){const e=t.groupViewRecords||[];for(const t of e){const e=t.viewRecords;!e||i(e,r)}}else i(t.viewRecords,r);s(t)}}));return()=>{t.destroy()}}),[]),i}var t7=(e=>(e.changeFieldType="changeFieldType",e.updateFieldName="updateFieldName",e.updateFieldHidden="updateFieldHidden",e.updateFieldProperty="updateFieldProperty",e.updateField="updateField",e))(t7||{});function r7(e){const t=HL(jR),r=HL(KO),n=HL(zI),i=X9(aR.TABLE).isReadonly(),[o,s]=Object(a.useState)((()=>r.getField(e))),l=dz();Object(a.useEffect)((()=>{e&&s(r.getField(e))}),[e,r]);const c=null==o?void 0:o.get("type"),u=null==o?void 0:o.get("name");Object(a.useEffect)((()=>{const i=null==n?void 0:n.onDidExecuteCommand((({context:t})=>{if(Object.values(t7).includes(t.commandName)){const n=t.argArray[0];let i=n.uuid;"updateField"===t.commandName&&(i=n.field.get("uuid")),e&&i===e&&(s(r.getField(e)),l())}})),o=t.onDataChanged((t=>{("command-undo"===t||"command-redo"===t||"collab-synced"===t)&&s(r.getField(e))}));return()=>{null==i||i.destroy(),null==o||o.destroy()}}),[n,e,r,t]);return o?{field:o,fieldId:e,fieldName:u,fieldType:c,fieldOptions:r.getFieldOptions(o.get("uuid")),isPrimary:!1,updateProperty:t=>(null==n||n.execCommand("updateField",{field:o,newFieldProperty:t}),r.getField(e)),hasPermissionForWrite:e=>i}:{}}const n7=["addField","removeField","changeFieldOrder",...Object.values(t7)];function i7(){const e=HL(jR),t=HL(KO),r=HL(zI),[n,i]=Object(a.useState)((()=>null==t?void 0:t.getAllViewFields()));return Object(a.useEffect)((()=>{const n=null==r?void 0:r.onDidExecuteCommand((({context:e})=>{n7.includes(e.commandName)&&i(null==t?void 0:t.getAllViewFields())})),o=e.onDataChanged((e=>{("command-undo"===e||"command-redo"===e)&&i(null==t?void 0:t.getAllViewFields())}));return()=>{n.destroy(),o.destroy()}}),[r,t,e]),n||null}function o7(e,t){const r=HL(KO),n=HL(zI),i=HL(Bk),o=HL(ZO),{field:s,fieldType:l}=r7(t),c=X9(aR.TABLE).isReadonly(),u=Object(a.useCallback)(((e,t)=>r.getCell(t,e)),[r]),[d,f]=Object(a.useState)((()=>u(e,t)));Object(a.useEffect)((()=>{f(u(e,t))}),[e,t,u]),Object(a.useEffect)((()=>{const r=null==i?void 0:i.onCellChange((r=>{r.recordId===e&&r.fieldId===t&&f(u(e,t))}));return()=>{null==r||r.destroy()}}),[i,t,e,u]);const h=Object(a.useCallback)((i=>{if(c)return;if(!e||!t||!d)return null;const a={recordId:e,fieldId:t,value:i,fieldType:l,uuid:d.uuid};if(!a)return;const s=r.getActiveView(),u=null==o?void 0:o.getRefreshType((null==s?void 0:s.get("uuid"))||"",a.fieldId||"");u&&(null==s?void 0:s.get("type"))===LE.GRID?null==n||n.execDeferCommand("setCell",a,u):null==n||n.execCommand("setCell",a)}),[n,e,t,d,c]);return e&&t&&s&&d?{fieldId:t,recordId:e,fieldType:l,value:d.value,errorMessage:d.errorMessage,setCell:h}:null}const a7=Object(a.memo)((({cell:e,boxRect:t,isSelected:r=!1})=>{const n=o7(null==e?void 0:e.recordId,null==e?void 0:e.fieldId),i=((e,t,r)=>Object(a.useMemo)((()=>e&&""!==e?null!=r&&r.ignore?e:cf.getRenderText(e,t,null==r?void 0:r.fonStyle):""),[e,t,null==r?void 0:r.ignore]))(n?n.value:null==e?void 0:e.value,t,{ignore:r||!t,fonStyle:{lineHeight:24,font:"14px PingFang SC",fontSize:14}});return s.a.createElement(R4,{key:null==e?void 0:e.uuid,value:i})}),((e,t)=>{var r,n,i;const o=(null==(r=e.cell)?void 0:r.updated_at)!==(null==(n=t.cell)?void 0:n.updated_at),a=e.boxRect!==t.boxRect,s=e.isSelected!==t.isSelected;return!((null==(i=t.cell)?void 0:i.temp)||o||a||s)})),s7=e=>s.a.createElement(XU,{type:"FieldText",...e}),l7=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;if(!r)return null;const a=bG((e=>{null==i||i(e)}),100);return s.a.createElement(T4,{id:r.uuid,defaultValue:n,value:r.value||"",onChange:e=>{a(e)},...o})},c7=e=>s.a.createElement(T4,{...e}),u7=$i.defineToken("FieldTextPluginFieldTagContribution");var d7=Object.defineProperty,f7=Object.getOwnPropertyDescriptor,h7=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?f7(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&d7(t,r,o),o};let p7=class{constructor(){this.getTextFieldTagComponent=()=>{var e,t;const r=this.fieldTextPluginFieldTagProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getTextFieldTagComponent)?void 0:t.call(e):null}}};h7([wh(u7)],p7.prototype,"fieldTextPluginFieldTagProvider",2),p7=h7([io()],p7);var g7=Object.defineProperty,m7=Object.getOwnPropertyDescriptor,v7=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?m7(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&g7(t,r,o),o};let y7=class{constructor(){this.fieldType="text",this.showFieldIcon=!0}static pluginModule(){return xo().contribution(u7).register(this).register(p7)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return a7}getFieldEditComponent(){return l7}getFieldIcon(){return this.showFieldIcon?s7:null}getFieldTagComponent(){return this._fieldTextService.getTextFieldTagComponent()}getFieldFormComponent(){return c7}};y7.pluginName="render-field-text",v7([ao(lp)],y7.prototype,"_configuration",2),v7([ao(p7)],y7.prototype,"_fieldTextService",2),y7=v7([io({contrib:[Pz,Dz]})],y7);const b7=Object(a.memo)((e=>{const{cell:t,field:r,checkCell:n,isSelected:i=!1}=e,o=(null==t?void 0:t.recordId)||"",l=(null==t?void 0:t.fieldId)||"",c=X9(aR.TABLE).isReadonly(),u=o7(o,l),d=HL(KO).getFieldOptions(l).toJSON(),f=u?u.value:null==t?void 0:t.value,h=d.filter((e=>e.uuid===f))||null,p=HL(Qz),g=Object(a.useCallback)((e=>{null==p||p.emitClickCellIcon({recordId:o,fieldId:l,event:e,iconName:"cellSelectIcon"})}),[o,l]);return!n||null!=u&&u.value?s.a.createElement(s.a.Fragment,null,s.a.createElement(v4,{writeable:i&&!c,colorable:!(null==r||!r.get("color")),value:h,onDelete:e=>{null==u||u.setCell(null)},showPlaceholder:!1,onClickDropDownIcon:g})):null}),((e,t)=>{var r;const n=e.cell,i=t.cell,o=e.isSelected!==t.isSelected;return e.fieldUpdatedAt!==t.fieldUpdatedAt||!(null==(r=t.cell)?void 0:r.temp)&&!o&&(null!=n&&n.updated_at||null!=i&&i.updated_at?(null==n?void 0:n.updated_at)===(null==i?void 0:i.updated_at):Vd(null==n?void 0:n.value,null==i?void 0:i.value)&&Vd(null==n?void 0:n.name,null==i?void 0:i.name)&&Vd(null==n?void 0:n.color,null==i?void 0:i.color))})),_7=e=>s.a.createElement(XU,{type:"FieldSelect",...e}),w7=e=>{var t;const{displayType:r,defaultValue:n,cell:i,onCellChange:o,...a}=e,{field:l,fieldId:c,fieldOptions:u,updateProperty:d}=r7((null==(t=e.field)?void 0:t.get("uuid"))||""),f=X9(aR.FIELD).canUpdate(l),h=o7(null==i?void 0:i.recordId,null==i?void 0:i.fieldId),p=dz(),g=vG((async e=>{const t=u.toJSON().concat(e);await d({options:t}),(async e=>{const t=((null==h?void 0:h.value)||[]).includes(e.uuid);null==h||h.setCell(t?"":e.uuid)})(e),p()})),m=vG((e=>{const t=Bp(u,(t=>t.get("uuid")===e.uuid?e:t));d({options:t}),p()})),v=vG((e=>{const t=Vp(u,(t=>t.get("uuid")!==e));d({options:t}),p()})),y=vG((e=>{null==o||o(e)}));if(!l||!h)return null;const b=h?h.value:null==i?void 0:i.value;return s.a.createElement(E4,{id:c,defaultValue:n?[n.value]:[],value:b?[b]:null,type:l.type,options:u.toJSON(),colorable:l.get("color"),editable:!0,optionEditable:f,displayType:r,onChange:y,onOptionChange:m,onOptionCreate:g,onOptionDelete:v,...a})},C7=e=>{const{viewField:t,...r}=e,{field:n,fieldOptions:i}=r7(t.get("field_uuid")||""),o="dropdown"===(null==t?void 0:t.get("display_type"))?u4.Dropdown:u4.List;return s.a.createElement(E4,{type:d4.Select,options:(null==i?void 0:i.toJSON())||[],colorable:null==n?void 0:n.get("color"),displayType:o,editable:!1,...r})};C7.OptionEditable=e=>{var t;if(!zE.isSelectLike(e.type))return null;const r={type:e.type,options:(null==(t=null==e?void 0:e.options)?void 0:t.toJSON())||[],color:(null==e?void 0:e.color)||!1};return s.a.createElement(x4,{title:s.a.createElement("span",{className:"lakex-table-form-design-option-title"},Ph("选项设置")),onChange:e.onChange,onChangeOrder:e.onChangeOrder,multiple:!1,configs:r,autoFocus:e.autoFocus})};var E7=Object.defineProperty,S7=Object.getOwnPropertyDescriptor,k7=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?S7(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&E7(t,r,o),o};let x7=class{constructor(){this.fieldType="select",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return b7}getFieldEditComponent(){return w7}getFieldIcon(){return this.showFieldIcon?_7:null}getFieldFormComponent(){return C7}};x7.pluginName="render-field-select",k7([ao(lp)],x7.prototype,"_configuration",2),x7=k7([io({contrib:[Pz,Dz]})],x7);const O7=Object(a.memo)((e=>{var t,r,n;const{cell:i,field:o,writeable:l,isSelected:c=!1}=e,u=(null==i?void 0:i.recordId)||"",d=(null==i?void 0:i.fieldId)||"",f=X9(aR.TABLE).isReadonly(),h=o7(u,d),p=(h?h.value:null==i?void 0:i.value)||[],g=HL(Qz),m=HL(KO).getFieldOptions(d).toJSON(),v=Object(a.useRef)(null),y=null==(n=null==(t=p.map)?void 0:(r=t.call(p,(e=>{const t=m.find((t=>t.uuid===e));return{...t,value:null==t?void 0:t.uuid}}))).filter)?void 0:n.call(r,(e=>!!e)),b=Object(a.useCallback)((e=>{null==g||g.emitClickCellIcon({recordId:u,fieldId:d,event:e,iconName:"cellSelectIcon"})}),[u,d]);return Object(a.useLayoutEffect)((()=>{!v.current||!e.boxRect||v.current.applyOverflow(e.boxRect)}),[e.boxRect,v,c]),i?f||!c?s.a.createElement(S4,{ref:v,colorable:!(null==o||!o.get("color")),value:y}):s.a.createElement(v4,{writeable:Ld(l)?c&&!f:l,colorable:!(null==o||!o.get("color")),value:y,onDelete:e=>{const t=y.filter((t=>t.uuid!==e.uuid));null==h||h.setCell(t)},showPlaceholder:!1,onClickDropDownIcon:b}):null}),((e,t)=>{var r;const n=e.cell,i=t.cell,o=e.boxRect!==t.boxRect,a=e.isSelected!==t.isSelected;return e.fieldUpdatedAt!==t.fieldUpdatedAt||!((null==(r=t.cell)?void 0:r.temp)||o||a)&&(null==n?void 0:n.updated_at)===(null==i?void 0:i.updated_at)})),I7=e=>s.a.createElement(XU,{type:"FieldMultiSelect",...e}),R7=e=>{var t;const{displayType:r,cell:n,defaultValue:i,onChange:o,onCellChange:a,...l}=e,{field:c,fieldOptions:u,updateProperty:d}=r7((null==(t=e.field)?void 0:t.get("uuid"))||""),f=o7(null==n?void 0:n.recordId,null==n?void 0:n.fieldId),h=dz(),p=X9(aR.FIELD).canUpdate(c),g=null==n?void 0:n.value,m=i||[""],v=vG((async e=>{const t=u.toJSON().concat(e);d({options:t}),(async e=>{const t=(null==n?void 0:n.value)||[],r=t.includes(e.uuid)?t.filter((t=>t!==e.uuid)):t.concat(e.uuid);null==f||f.setCell(r.map((e=>({value:e}))))})(e),h()})),y=vG((e=>{const t=Bp(u,(t=>t.get("uuid")===e.uuid?e:t));d({options:t}),h()})),b=vG((e=>{const t=Vp(u,(t=>t.get("uuid")!==e));d({options:t}),h()})),_=vG((e=>{const t=Vp(u,(t=>e.includes(t.get("uuid")))).map((e=>{const t=e.toJSON();return t.value=t.uuid,t}));null==a||a(t),null==o||o(t)}));return c?s.a.createElement(E4,{id:c.get("uuid"),defaultValue:m,value:g,type:c.get("type"),options:u.toJSON(),colorable:null==c?void 0:c.get("color"),editable:!0,optionEditable:p,displayType:r,onChange:_,onOptionChange:y,onOptionCreate:v,onOptionDelete:b,...l}):null},T7=e=>{const{viewField:t,onChange:r,...n}=e,{field:i,fieldOptions:o}=r7(t.get("field_uuid")||""),a="dropdown"===(null==t?void 0:t.get("display_type"))?u4.Dropdown:u4.List;return s.a.createElement(E4,{type:d4.MultiSelect,options:null==o?void 0:o.toJSON(),colorable:null==i?void 0:i.get("color"),displayType:a,editable:!1,onChange:e=>{if(!o)return;const t=Vp(o,(t=>e.includes(t.get("uuid")))).map((e=>e.get("uuid")));null==r||r(t)},...n})};T7.OptionEditable=e=>{var t;if(!zE.isSelectLike(e.type))return null;const r={type:e.type,options:(null==(t=null==e?void 0:e.options)?void 0:t.toJSON())||[],color:(null==e?void 0:e.color)||!1};return s.a.createElement(x4,{title:s.a.createElement("span",{className:"lakex-table-form-design-option-title"},Ph("选项设置")),onChange:e.onChange,onChangeOrder:e.onChangeOrder,multiple:!0,configs:r,autoFocus:e.autoFocus})};var A7=Object.defineProperty,M7=Object.getOwnPropertyDescriptor,N7=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?M7(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&A7(t,r,o),o};let D7=class{constructor(){this.fieldType="multiSelect",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return O7}getFieldEditComponent(){return R7}getFieldIcon(){return this.showFieldIcon?I7:null}getFieldFormComponent(){return T7}};D7.pluginName="render-field-multi-select",N7([ao(lp)],D7.prototype,"_configuration",2),D7=N7([io({contrib:[Pz,Dz]})],D7);const P7=Object(a.memo)((({cell:e})=>{const t=o7(null==e?void 0:e.recordId,null==e?void 0:e.fieldId),r=t?t.value:null==e?void 0:e.value;return null==r?null:s.a.createElement(a4,{key:null==e?void 0:e.updated_at,value:r})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),j7=e=>s.a.createElement(XU,{type:"FieldNumber",...e}),F7=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(s4,{id:null==r?void 0:r.uuid,defaultValue:n,value:r.value||"",prefix:e.renderMode===Vz.LITE?void 0:s.a.createElement(XU,{type:"FieldNumber"}),onChange:e=>{null==i||i(e)},...o}):null},V7=e=>s.a.createElement(s4,{...e});var L7=Object.defineProperty,$7=Object.getOwnPropertyDescriptor,B7=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$7(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&L7(t,r,o),o};let U7=class{constructor(){this.fieldType="number",this.isStrictValidatedValue=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return P7}getFieldEditComponent(){return F7}getFieldIcon(){return this.showFieldIcon?j7:null}getFieldRules(){return this._numberField.rules}getFieldFormComponent(){return V7}};U7.pluginName="render-field-number",B7([ao(fP)],U7.prototype,"_numberField",2),B7([ao(lp)],U7.prototype,"_configuration",2),U7=B7([io({contrib:[Pz,Dz]})],U7);const z7=Object(a.memo)((({cell:e,checkCell:t=!0,disableOpen:r=!1,isSelected:n=!1,boxRect:i})=>{const o=(null==e?void 0:e.recordId)||"",l=(null==e?void 0:e.fieldId)||"",c=X9(aR.TABLE).isReadonly(),u=o7(o,l),d=(u?u.value:null==e?void 0:e.value)||[],f=HL(Qz),h=HL(KO),p=HL(PH),g=Object(a.useRef)(null),m=vG((e=>{null==f||f.emitClickCellIcon({recordId:o,fieldId:l,event:e,iconName:"cellMentionIcon"})})),v=Object(a.useCallback)((e=>{!n&&h.getActiveViewType()===LE.GRID||!r&&(null==p||p.open("user",e))}),[n]);return Object(a.useLayoutEffect)((()=>{!g.current||!i||g.current.applyOverflow(i)}),[i,g,n]),t&&!d?null:c||!n?s.a.createElement(o4,{ref:g,value:d.toJSON?d.toJSON():d,onMentionTagClick:v}):s.a.createElement(X6,{showPlaceholder:!1,writeable:n&&!c,list:d||[],onUnSelect:e=>{const t=null==d?void 0:d.filter((t=>t.uid!==e.uid));null==u||u.setCell(t)},onMentionTagClick:v,onClickDropDownIcon:m})}),((e,t)=>{var r,n,i;const o=e.cell,a=t.cell,s=e.boxRect!==t.boxRect,l=e.isSelected!==t.isSelected;return!((null==(r=t.cell)?void 0:r.temp)||s||l)&&(null!=o&&o.updated_at||null!=a&&a.updated_at?(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at):Vd(o.uuid,a.uuid))})),H7=e=>s.a.createElement(XU,{type:"FieldMention",...e}),W7=e=>{const{field:t,cell:r,onCellChange:n,...i}=e,o=HL(PH),l=o7(null==r?void 0:r.recordId,null==r?void 0:r.fieldId),c=Object(a.useCallback)((e=>{null==o||o.open("user",e)}),[]);return r?s.a.createElement(i4,{onMentionTagClick:c,id:r.uuid,defaultValue:r.value,onChange:e=>{null==l||l.setCell(e)},...i}):null},G7=e=>{const t=HL(PH),r=Object(a.useCallback)((e=>{null==t||t.open("user",e)}),[]);return s.a.createElement(i4,{...e,onMentionTagClick:r})};var K7=Object.defineProperty,q7=Object.getOwnPropertyDescriptor,Y7=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?q7(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&K7(t,r,o),o};let J7=class{constructor(){this.fieldType="mention",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return z7}getFieldEditComponent(){return W7}getFieldIcon(){return this.showFieldIcon?H7:null}getFieldFormComponent(){return G7}};J7.pluginName="render-field-mention",Y7([ao(lp)],J7.prototype,"_configuration",2),J7=Y7([io({contrib:[Pz,Dz]})],J7);const X7=Object(a.memo)((({cell:e})=>{const t=o7(null==e?void 0:e.recordId,null==e?void 0:e.fieldId);let r=t?t.value:null==e?void 0:e.value;return"number"==typeof r&&(r=new Date(r)),s.a.createElement(xG,{key:null==e?void 0:e.fieldId,value:r})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),Z7=e=>s.a.createElement(XU,{type:"FieldDate",...e}),Q7=e=>{const{cell:t,defaultValue:r,onCellChange:n,...i}=e;return t?s.a.createElement(r6,{id:t.fieldId,defaultValue:r,value:t.value,onChange:e=>{null==n||n(e)},...i}):null},eee=e=>s.a.createElement(r6,{...e});var tee=Object.defineProperty,ree=Object.getOwnPropertyDescriptor,nee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ree(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tee(t,r,o),o};let iee=class{constructor(){this.fieldType="date",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return X7}getFieldEditComponent(){return Q7}getFieldIcon(){return this.showFieldIcon?Z7:null}getFieldFormComponent(){return eee}};iee.pluginName="render-field-date",nee([ao(lp)],iee.prototype,"_configuration",2),iee=nee([io({contrib:[Pz,Dz]})],iee);const oee=Object(a.memo)((e=>{const{readonly:t,cell:r}=e,n=X9(aR.TABLE).isReadonly(),i=HL(zI),o=o7(null==r?void 0:r.recordId,null==r?void 0:r.fieldId),l=Object(a.useCallback)((e=>{!n&&!t&&(null==o||o.setCell(e))}),[n,t,i]),c=o?o.value:null==r?void 0:r.value;return s.a.createElement(uz,{value:!!c,onChange:l})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),aee=e=>{const{field:t,recordId:r}=e,n=o7(r,null==t?void 0:t.get("uuid")),i=Object(a.useCallback)((e=>{null==n||n.setCell(e)}),[]);return n?s.a.createElement(SG,{id:n.uuid,defaultValue:n.value,value:n.value,onChange:i}):null},see=e=>s.a.createElement(XU,{type:"FieldCheckbox",...e}),lee=e=>s.a.createElement(SG,{type:cz.Radio,...e});var cee=Object.defineProperty,uee=Object.getOwnPropertyDescriptor,dee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cee(t,r,o),o};let fee=class{constructor(){this.fieldType="checkbox",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return oee}getFieldEditComponent(){return aee}getFieldIcon(){return this.showFieldIcon?see:null}getFieldFormComponent(){return lee}};fee.pluginName="render-field-checkbox",dee([ao(lp)],fee.prototype,"_configuration",2),fee=dee([io({contrib:[Pz,Dz]})],fee);const hee=Object(a.memo)((({cell:e,isSelected:t=!1})=>{const r=HL(PH),n=Object(a.useCallback)((e=>{!t||null==r||r.open("user",e)}),[t]);return e&&null!=e.value?s.a.createElement(o4,{value:e.value?[e.value]:[],onMentionTagClick:n}):null}),((e,t)=>{var r,n,i;const o=e.isSelected!==t.isSelected;return!(null==(r=t.cell)?void 0:r.temp)&&!o&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),pee=e=>s.a.createElement(XU,{type:"FieldCreator",...e});var gee=Object.defineProperty,mee=Object.getOwnPropertyDescriptor,vee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?mee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&gee(t,r,o),o};let yee=class{constructor(){this.fieldType="userId",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return hee}getFieldIcon(){return this.showFieldIcon?pee:null}};yee.pluginName="render-field-user-id",vee([ao(lp)],yee.prototype,"_configuration",2),yee=vee([io({contrib:[Pz,Dz]})],yee);const bee=Object(a.memo)((({cell:e})=>{let t=null==e?void 0:e.value;return"number"==typeof t&&(t=new Date(t)),s.a.createElement(xG,{key:null==e?void 0:e.uuid,value:t,format:"YYYY-MM-DD HH:mm:ss"})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),_ee=e=>s.a.createElement(XU,{type:"FieldCreatedAt",...e});var wee=Object.defineProperty,Cee=Object.getOwnPropertyDescriptor,Eee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wee(t,r,o),o};let See=class{constructor(){this.fieldType="createdAt",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return bee}getFieldIcon(){return this.showFieldIcon?_ee:null}};See.pluginName="render-field-created-at",Eee([ao(lp)],See.prototype,"_configuration",2),See=Eee([io({contrib:[Pz,Dz]})],See);const kee=Object(a.memo)((({cell:e,isSelected:t=!1})=>{const r=HL(PH),n=Object(a.useCallback)((e=>{!t||null==r||r.open("user",e)}),[t]);return e?s.a.createElement(o4,{value:e.value?[e.value]:[],onMentionTagClick:n}):null}),((e,t)=>{var r,n,i;const o=e.isSelected!==t.isSelected;return!(null==(r=t.cell)?void 0:r.temp)&&!o&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),xee=e=>s.a.createElement(XU,{type:"FieldModifier",...e});var Oee=Object.defineProperty,Iee=Object.getOwnPropertyDescriptor,Ree=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Iee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Oee(t,r,o),o};let Tee=class{constructor(){this.fieldType="modifierId",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return kee}getFieldIcon(){return this.showFieldIcon?xee:null}};Tee.pluginName="render-field-modifier-id",Ree([ao(lp)],Tee.prototype,"_configuration",2),Tee=Ree([io({contrib:[Pz,Dz]})],Tee);const Aee=Object(a.memo)((({cell:e})=>{let t=null==e?void 0:e.value;return"number"==typeof t&&(t=new Date(t)),s.a.createElement(xG,{value:t,format:"YYYY-MM-DD HH:mm:ss"})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),Mee=e=>s.a.createElement(XU,{type:"FieldUpdatedAt",...e});var Nee=Object.defineProperty,Dee=Object.getOwnPropertyDescriptor,Pee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Dee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Nee(t,r,o),o};let jee=class{constructor(){this.fieldType="updatedAt",this.isSystemType=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return Aee}getFieldIcon(){return this.showFieldIcon?Mee:null}};jee.pluginName="render-field-updated-at",Pee([ao(lp)],jee.prototype,"_configuration",2),jee=Pee([io({contrib:[Pz,Dz]})],jee);const Fee=Object(a.memo)((({cell:e,readonly:t})=>{const r=X9(aR.TABLE).canUpdate(),n=HL(Qz),i=(null==e?void 0:e.recordId)||"",o=(null==e?void 0:e.fieldId)||"",l=o7(i,o),c=l?l.value:null==e?void 0:e.value,u=Object(a.useCallback)((e=>{null==n||n.emitClickCellIcon({recordId:i,fieldId:o,event:e,iconName:"cellImageIcon"})}),[i,o]);return 0===c.length?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(J6,{value:c}),r&&!t&&s.a.createElement(XU,{type:"Add",onClick:u}))}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),Vee=e=>s.a.createElement(XU,{type:"FieldImage",...e}),Lee=e=>{const{field:t,cell:r,recordId:n,defaultValue:i,onCellChange:o,...a}=e,l=HL(zI),c=HL(c8),{fieldUriModel:u}=HL(Ok);return t?e.renderMode===Vz.LITE?s.a.createElement("div",{className:"lakex-table-field-image-editable-lite",onClick:e=>{const r={position:{placement:"bottom",origin:e.target},initialState:{fieldId:t.get("uuid"),fieldType:t.get("type"),recordId:n}};c.open("expandRecordFileEditable",r)}},i?i.map((e=>s.a.createElement("div",{key:e.src,className:"lakex-table-field-image-editable-wrap"},s.a.createElement("img",{loading:"lazy",src:e.src})))):s.a.createElement("p",{className:"lakex-table-field-image-placeholder"},Ph("请上传"))):s.a.createElement(Y6,{id:(null==r?void 0:r.uuid)||To(32),defaultValue:i,onChange:e=>{null==o||o(e)},onOrderChange:({targetUid:e,sourceUid:r})=>{var i,o;const a=null==(i=u.findOne({uid:e}))?void 0:i.get("uuid"),s=null==(o=u.findOne({uid:r}))?void 0:o.get("uuid");l.execCommand("updateValueOrder",{fieldId:t.get("uuid"),fieldType:t.get("type"),recordId:n,targetValueId:a,sourceValueId:s})},...a}):null},$ee=e=>s.a.createElement(Y6,{...e});var Bee=Object.defineProperty,Uee=Object.getOwnPropertyDescriptor,zee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Uee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bee(t,r,o),o};let Hee=class{constructor(){this.fieldType="image",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return Fee}getFieldEditComponent(){return Lee}getFieldIcon(){return this.showFieldIcon?Vee:null}getFieldFormComponent(){return $ee}};Hee.pluginName="render-field-image",zee([ao(lp)],Hee.prototype,"_configuration",2),Hee=zee([io({contrib:[Pz,Dz]})],Hee);const Wee=Object(a.memo)((({cell:e,readonly:t})=>{const r=X9(aR.TABLE).canUpdate(),n=HL(Qz),i=(null==e?void 0:e.recordId)||"",o=(null==e?void 0:e.fieldId)||"",l=o7(i,o),c=l?l.value:null==e?void 0:e.value,u=Object(a.useCallback)((e=>{i&&o&&(null==n||n.emitClickCellIcon({recordId:i,fieldId:o,event:e,iconName:"cellFileIcon"}))}),[i,o]);return 0===(null==c?void 0:c.length)?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(m6,{value:c}),r&&!t&&s.a.createElement(XU,{type:"Add",onClick:u}))}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),Gee=e=>s.a.createElement(XU,{type:"FieldFile",...e}),Kee=e=>{const{field:t,recordId:r,cell:n,onCellChange:i,...o}=e,a=HL(zI),l=HL(c8),{fieldUriModel:c}=HL(Ok);return t&&n?e.renderMode===Vz.LITE?s.a.createElement("div",{className:"lakex-table-field-file-editable-lite",onClick:e=>{const n={position:{placement:"bottom",origin:e.target},initialState:{fieldId:t.get("uuid"),fieldType:t.get("type"),recordId:r}};l.open("expandRecordFileEditable",n)}},n.value?n.value.map((e=>s.a.createElement("div",{className:"lakex-table-field-file-editable-wrap"},s.a.createElement(g6,{key:e.uid,type:"file",file:e})))):s.a.createElement("p",{className:"lakex-table-field-file-placeholder"},Ph("请上传"))):s.a.createElement(q6,{id:(null==n?void 0:n.uuid)||To(32),defaultValue:n.value,onChange:e=>{null==i||i(e)},onOrderChange:({targetUid:e,sourceUid:n})=>{var i,o;const s=null==(i=c.findOne({uid:e}))?void 0:i.get("uuid"),l=null==(o=c.findOne({uid:n}))?void 0:o.get("uuid");null==a||a.execCommand("updateValueOrder",{fieldId:t.get("uuid"),fieldType:t.get("type"),recordId:r,targetValueId:s,sourceValueId:l})},...o}):null},qee=e=>s.a.createElement(q6,{...e});var Yee=Object.defineProperty,Jee=Object.getOwnPropertyDescriptor,Xee=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Jee(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Yee(t,r,o),o};let Zee=class{constructor(){this.fieldType="file",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return Wee}getFieldEditComponent(){return Kee}getFieldIcon(){return this.showFieldIcon?Gee:null}getFieldFormComponent(){return qee}};Zee.pluginName="render-field-file",Xee([ao(lp)],Zee.prototype,"_configuration",2),Zee=Xee([io({contrib:[Pz,Dz]})],Zee);const Qee=e=>s.a.createElement(XU,{type:"FieldLink",...e}),ete=Object(a.memo)((e=>{const{cell:t,readonly:r}=e,n=X9(aR.TABLE).isReadonly(),i=HL(Qz),o=null==t?void 0:t.recordId,a=null==t?void 0:t.fieldId,l=o7(null==t?void 0:t.recordId,null==t?void 0:t.fieldId),c=l?l.value:null==t?void 0:t.value;return c?s.a.createElement(s.a.Fragment,null,s.a.createElement(M4,{key:a,value:c}),!n&&!r&&s.a.createElement(Qee,{onClick:e=>{e.stopPropagation(),o&&a&&(null==i||i.emitClickCellIcon({recordId:o,fieldId:a,iconName:"cellLinkIcon",event:e}))}})):null}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),tte=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,useLinkEditor:o,...a}=e;return r?s.a.createElement(D4,{useLinkEditor:o,id:r.uuid,defaultValue:n,onChange:i,...a}):null},rte=e=>s.a.createElement(D4,{...e});var nte=Object.defineProperty,ite=Object.getOwnPropertyDescriptor,ote=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ite(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nte(t,r,o),o};let ate=class{constructor(){this.fieldType="link",this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return ete}getFieldEditComponent(){return tte}getFieldIcon(){return this.showFieldIcon?Qee:null}getFieldRules(){return this._linkField.rules}getFieldFormComponent(){return rte}};ate.pluginName="render-field-link",ote([ao(Pj)],ate.prototype,"_linkField",2),ote([ao(lp)],ate.prototype,"_configuration",2),ate=ote([io({contrib:[Pz,Dz]})],ate);const ste=Object(a.memo)((({cell:e})=>{const t=o7(null==e?void 0:e.recordId,null==e?void 0:e.fieldId),r=t?t.value:null==e?void 0:e.value;return r?s.a.createElement(n6,{key:null==e?void 0:e.fieldId,value:r||""}):null}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),lte=e=>s.a.createElement(XU,{type:"FieldEmail",...e}),cte=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(i6,{id:r.uuid,defaultValue:n,value:r.value,prefix:e.renderMode===Vz.LITE?void 0:s.a.createElement(XU,{type:"FieldEmail"}),onChange:e=>{null==i||i(e)},...o}):null},ute=e=>s.a.createElement(i6,{...e});var dte=Object.defineProperty,fte=Object.getOwnPropertyDescriptor,hte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?fte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dte(t,r,o),o};let pte=class{constructor(){this.fieldType="email",this.isShowValidTipInGrid=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return ste}getFieldEditComponent(){return cte}getFieldIcon(){return this.showFieldIcon?lte:null}getFieldRules(){return this._emailField.rules}getFieldFormComponent(){return ute}};pte.pluginName="render-field-email",hte([ao(Uj)],pte.prototype,"_emailField",2),hte([ao(lp)],pte.prototype,"_configuration",2),pte=hte([io({contrib:[Pz,Dz]})],pte);const gte=Object(a.memo)((({cell:e})=>{const t=o7(null==e?void 0:e.recordId,null==e?void 0:e.fieldId),r=t?t.value:null==e?void 0:e.value;return null==r?null:s.a.createElement(l4,{key:null==e?void 0:e.fieldId,value:r})}),((e,t)=>{var r,n,i;return(null==(r=t.cell)||!r.temp)&&(null==(n=e.cell)?void 0:n.updated_at)===(null==(i=t.cell)?void 0:i.updated_at)})),mte=e=>s.a.createElement(XU,{type:"FieldPhone",...e}),vte=e=>{const{field:t,cell:r,defaultValue:n,onCellChange:i,...o}=e;return r?s.a.createElement(c4,{id:r.uuid,defaultValue:n,value:r.value||"",prefix:e.renderMode===Vz.LITE?void 0:s.a.createElement(XU,{type:"FieldPhone"}),onChange:e=>{null==i||i(e)},...o}):null},yte=e=>s.a.createElement(c4,{...e});var bte=Object.defineProperty,_te=Object.getOwnPropertyDescriptor,wte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_te(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bte(t,r,o),o};let Cte=class{constructor(){this.fieldType="phone",this.isShowValidTipInGrid=!0,this.showFieldIcon=!0}static pluginModule(){return xo().register(this)}init(){this.showFieldIcon=this._configuration.getValue("render.showFieldIcon")}getFieldComponent(){return gte}getFieldEditComponent(){return vte}getFieldIcon(){return this.showFieldIcon?mte:null}getFieldRules(){return this._phoneField.rules}getFieldFormComponent(){return yte}};Cte.pluginName="render-field-phone",wte([ao(Yj)],Cte.prototype,"_phoneField",2),wte([ao(lp)],Cte.prototype,"_configuration",2),Cte=wte([io({contrib:[Pz,Dz]})],Cte);var Ete=Object.defineProperty,Ste=Object.getOwnPropertyDescriptor,kte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ste(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ete(t,r,o),o};let xte=class extends fp{constructor(){super(...arguments),this._onShowNewGroup=this._register(new _p),this.onShowNewGroup=this._onShowNewGroup.event,this._onShowEditGroup=this._register(new _p),this.onShowEditGroup=this._onShowEditGroup.event}showNewGroup(e,t){this._onShowNewGroup.emit({target:e,groupField:t})}showEditGroup(e,t,r){this._onShowEditGroup.emit({target:e,groupField:t,groupOption:r})}destroy(){super.destroy()}};kte([Ii()],xte.prototype,"destroy",1),xte=kte([io()],xte);var Ote=Object.defineProperty,Ite=Object.getOwnPropertyDescriptor;let Rte=class{static pluginModule(){return xo().register(this).register(xte)}init(){}};Rte.pluginName="render-group",Rte=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ite(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ote(t,r,o),o})([io({contrib:[jL,u8]})],Rte);const Tte=$i.defineToken("HighlightRenderPluginContribution");var Ate=Object.defineProperty,Mte=Object.getOwnPropertyDescriptor,Nte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Mte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ate(t,r,o),o};let Dte=class extends fp{constructor(){super(...arguments),this._highlightCellIds=new Set,this._highlightRecordIds=new Set,this._onChange=this._register(new _p),this.onChange=this._onChange.event}destroy(){this._clear(),this._onChange.destroy()}_getCellIdByHighlightItem(e){return e.fieldId?`${e.recordId}-${e.fieldId}`:null}isInHighlight(e){if(Lo(e.recordId))return!1;if(!Lo(e.fieldId)){const t=this._getCellIdByHighlightItem(e);return this._highlightCellIds.has(t)}return this._highlightRecordIds.has(e.recordId)}setHighlights(e){this._clear(),e.forEach((e=>{const{recordId:t}=e;t&&this._highlightRecordIds.add(t);const r=this._getCellIdByHighlightItem(e);r&&this._highlightCellIds.add(r)})),this._notify()}clearHighlights(){this._clear(),this._notify()}_clear(){this._highlightCellIds.clear(),this._highlightRecordIds.clear()}_notify(){this._onChange.emit({highlightCellIds:this._highlightCellIds,highlightRecordIds:this._highlightRecordIds})}};Nte([Ii()],Dte.prototype,"destroy",1),Dte=Nte([io()],Dte);var Pte=Object.defineProperty,jte=Object.getOwnPropertyDescriptor;let Fte=class{static pluginModule(){return xo().contribution(Tte).register(this).register(Dte)}init(){}};Fte.pluginName="render-highlight",Fte=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?jte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pte(t,r,o),o})([io({contrib:Dz})],Fte);const Vte=$i.defineToken("WorkbenchHotkeyContribution"),Lte=$i.defineToken("SelectionRenderPluginScrollContribution");class $te{static createAt(e,t){return new $te(e,t)}static equal(e,t){return!(!e||!t)&&(e===t||MF.equal(e.start,t.start)&&MF.equal(e.end,t.end))}constructor(e,t){t||(t=e);const{minRow:r,minColumn:n,maxRow:i,maxColumn:o}=function(e,t){const{column:r,row:n}=e,{column:i,row:o}=t;return{minColumn:Math.min(r,i),maxColumn:Math.max(r,i),minRow:Math.min(n,o),maxRow:Math.max(n,o)}}(e,t);this._start=new MF(r,n,e.rowCount,e.columnCount),this._end=new MF(i,o,t.rowCount,t.columnCount),this._isCollapsed=MF.equal(e,this._end)}get start(){return this._start}get end(){return this._end}get isCollapsed(){return this._isCollapsed}get rowCount(){return this._start.rowCount}get columnCount(){return this._start.columnCount}cloneRange(){return new $te(this._start,this._end)}}class Bte{static createAt(e){return new Bte(e)}static equal(e,t){return e._recordId===t._recordId}constructor(e){this._recordId=e}get isCollapsed(){return!0}get recordId(){return this._recordId}cloneRange(){return new Bte(this._recordId)}}class Ute{constructor(e,t,r){if(this._anchor=t,this._focus=r,this._ranges=[],0===e.length)throw new Error("ranges construct error");this._ranges=function(e){return 1===e.length?[...e]:e.sort(((e,t)=>e.start.row<t.start.row?-1:e.start.row>t.start.row?1:e.start.column-t.start.column))}(e.slice())}static createBy(e,t=e[0].start,r=e[0].end){let n;return n=Array.isArray(e)?e:[e],new Ute(n,t,r)}static equal(e,t){return!(e.ranges.length!==t.ranges.length||e.rowCount!==t.rowCount||e.columnCount!==t.columnCount||!MF.equal(e.anchor,t.anchor)||!MF.equal(e.focus,t.focus))}destroy(){delete this._ranges,delete this._anchor,delete this._focus}get type(){return 0===this.rangeCount?AF.NONE:this.isCollapsed?AF.CARET:AF.RANGE}get rangeCount(){return this._ranges.length}get ranges(){return this._ranges.slice()}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get isMultiSelection(){return this._ranges.length>1}get isAllSelect(){return 1===this._ranges.length&&0===this._ranges[0].start.row&&0===this._ranges[0].start.column&&this._ranges[0].end.row===this._ranges[0].start.rowCount-1&&this._ranges[0].end.column===this._ranges[0].start.columnCount-1}get focus(){return this._focus}get anchor(){return this._anchor}get rowCount(){return this.anchor.rowCount}get columnCount(){return this.anchor.columnCount}isValid(){return this._ranges.length>0}cloneSelection(){return new Ute(function(e){return e.map((e=>e.cloneRange()))}(this._ranges),this._anchor,this._focus)}getRangeAt(e){return this._ranges[e]}}class zte{constructor(e){if(this._ranges=[],0===e.length)throw new Error("ranges construct error");this._ranges=e.slice()}static createBy(e){let t;return t=Array.isArray(e)?e:[e],new zte(t)}get type(){return 0===this.rangeCount?AF.NONE:this.isCollapsed?AF.CARET:AF.RANGE}get rangeCount(){return this._ranges.length}get ranges(){return this._ranges.slice()}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}destroy(){delete this._ranges}getRangeAt(e){return this._ranges[e]}removeAllRanges(){this._ranges=[]}removeRange(e){const t=this._ranges.findIndex((t=>t.recordId===e.recordId));return this._ranges.splice(t,1)}}var Hte=Object.defineProperty,Wte=Object.getOwnPropertyDescriptor,Gte=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Wte(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Hte(t,r,o),o};function Kte(e){return e instanceof Ute}let qte=class extends fp{constructor(){super(...arguments),this._onChange=this._register(new _p),this.onChange=this._onChange.event,this._onAnchorChange=this._register(new _p),this.onAnchorChange=this._onAnchorChange.event,this._selection=null,this._prevSelection=null,this._fieldValue=null,this._kanbanScrollService=null,this._cardScrollService=null,this._gridScrollService=null}get _currentViewType(){return this._readService.getActiveView().get("type")}get gridScrollService(){return this._gridScrollService}setKanbanScrollService(e){this._kanbanScrollService=e}setCardScrollService(e){this._cardScrollService=e}setGridScrollService(e){this._gridScrollService=e}destroy(){this._selection=null,this._onChange.destroy(),this._onAnchorChange.destroy()}hasSelection(){return null!==this._selection}isEqualSelection(e){return!!(this._selection&&e instanceof Ute&&this._selection instanceof Ute)&&Ute.equal(e,this._selection)}getSelection(){return this._selection}getFieldValue(){return this._currentViewType===LE.GRID?this._fieldValue:null}getFieldValues(){return this._selection instanceof Ute?this._getSelectFieldValues(this._selection):null}setSelection(e){var t,r;const n=this._readService.getActiveView();let i;if(n){if(this._prevSelection=this._selection,n.get("type")===LE.GRID){if(i=Array.isArray(e)?Ute.createBy(e):e.cloneSelection(),i instanceof Ute&&this._prevSelection instanceof Ute&&MF.equal(i.anchor,this._prevSelection.anchor)){if(i instanceof Ute&&this._fieldValue){const e=this._readService.getFlatViewRecords(n.get("uuid")),o=this._readService.getViewFields(n.get("uuid"))||[],a=null==(t=e.get(i.anchor.row))?void 0:t.get("record_uuid"),s=null==(r=o.get(i.anchor.column))?void 0:r.get("field_uuid");(this._fieldValue.recordId!==a||this._fieldValue.fieldId!==s)&&(this._fieldValue=this._getSelectFieldValue(i),this._onAnchorChange.emit({selection:i,fieldValue:this._fieldValue}))}}else this._fieldValue=this._getSelectFieldValue(i),this._onAnchorChange.emit({selection:i,fieldValue:this._fieldValue});if(this._prevSelection instanceof Ute&&i instanceof Ute&&Ute.equal(i,this._prevSelection))return}else i=e;this._selection=i,this._onChange.emit({selection:this._selection})}}removeSelection(){this._selection=null,this._prevSelection=null,this._fieldValue=null,this._onChange.emit({selection:null}),this._onAnchorChange.emit({selection:null,fieldValue:null})}getRangeAt(e){var t;return null==(t=this._selection)?void 0:t.getRangeAt(e)}createGridSelectionByScope(e,t,r,n){return function(e,t,r,n){const i=new MF(e.row,e.column,r,n),o=new MF(t.row,t.column,r,n),a=$te.createAt(i,o);return Ute.createBy([a],i,o)}(e,t,r,n)}createGridSelectionByIndex(e,t,r,n){if(Ld(r)||Ld(n)){const e=this._readService.getActiveView();r=Ld(r)?(this._readService.getFlatViewRecords(null==e?void 0:e.get("uuid"))||[]).length:r,n=Ld(n)?(this._readService.getViewFields(null==e?void 0:e.get("uuid"))||[]).length:n}return function(e,t,r,n){const i=$te.createAt(new MF(e,t,r,n),new MF(e,t,r,n));return Ute.createBy([i])}(e,t,r,n)}createRowGridSelectionByIndex(e,t,r){return function(e,t,r){const n=$te.createAt(new MF(e,0,t,r),new MF(e,r-1,t,r));return Ute.createBy([n])}(e,t,r)}createColumnGridSelectionByIndex(e,t,r){return function(e,t,r){const n=$te.createAt(new MF(0,e,t,r),new MF(t-1,e,t,r));return Ute.createBy([n])}(e,t,r)}createSelectionById(e,t){const r=this._readService.getActiveView();if(!r)return null;if(r.get("type")===LE.GRID){const n=this._readService.getViewFields(r.get("uuid"))||[],i=this._readService.getFlatViewRecords(r.get("uuid"))||[];let o=0;t&&"string"==typeof t&&(o=Lp(n,(e=>e.get("field_uuid")===t)));const a=Lp(i,(t=>t.get("record_uuid")===e)),s=$te.createAt(new MF(a,o,i.length,n.length));return Ute.createBy([s])}const n=Bte.createAt(e);return zte.createBy([n])}moveToRecord(e){const t=this._readService.getActiveView(),r=this._readService.getFlatViewRecords(null==t?void 0:t.get("uuid")),n=Lp(r,(t=>t.get("record_uuid")===e));if(!(n<0)){if((null==t?void 0:t.get("type"))===LE.GRID){const e=this._readService.getViewFieldsCount(),t=this.createGridSelectionByIndex(n,0,r.length,e);this.scrollToSelection(t,"end")}if((null==t?void 0:t.get("type"))===LE.KANBAN&&this._kanbanScrollService){const r=this._readService.getGroupViewRecords(null==t?void 0:t.get("uuid")),{index:n,groupId:i}=this._kanbanScrollService.getKanbanGroupPositionByRecordId(e,r);i&&n>=0&&this._kanbanScrollIntoView(i,n,"end")}(null==t?void 0:t.get("type"))===LE.CARD&&this._cardScrollIntoView(n,"end")}}moveUp(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtRowStart?null:Ute.createBy([$te.createAt(new MF(e.row-1,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveDown(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtRowEnd?null:Ute.createBy([$te.createAt(new MF(e.row+1,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}moveLeft(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtColumnStart?e.isAtRowStart?null:Ute.createBy([$te.createAt(new MF(e.row-1,e.columnCount-1,e.rowCount,e.columnCount))]):Ute.createBy([$te.createAt(new MF(e.row,e.column-1,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveRight(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtColumnEnd?e.isAtRowEnd?null:Ute.createBy([$te.createAt(new MF(e.row+1,0,e.rowCount,e.columnCount))]):Ute.createBy([$te.createAt(new MF(e.row,e.column+1,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}moveFocusUp(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtRowStart){const n=e.getRangeAt(0),i=new MF(r.row-1,r.column,n.rowCount,n.columnCount);return Ute.createBy([$te.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"start")}}moveFocusDown(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtRowEnd){const n=e.getRangeAt(0),i=new MF(r.row+1,r.column,n.rowCount,n.columnCount);return Ute.createBy([$te.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"end")}}moveFocusLeft(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtColumnStart){const n=e.getRangeAt(0),i=new MF(r.row,r.column-1,n.rowCount,n.columnCount);return Ute.createBy([$te.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"start")}}moveFocusRight(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){const t=e.anchor,r=e.focus;if(!r.isAtColumnEnd){const n=e.getRangeAt(0),i=new MF(r.row,r.column+1,n.rowCount,n.columnCount);return Ute.createBy([$te.createAt(t,i)],t,i)}return null}(this._selection);this.scrollToSelection(e,"end")}}moveTop(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtRowStart?null:Ute.createBy([$te.createAt(new MF(0,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveBottom(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtRowEnd?null:Ute.createBy([$te.createAt(new MF(e.rowCount-1,e.column,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}moveFirstLeft(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtColumnStart?null:Ute.createBy([$te.createAt(new MF(e.row,0,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"start")}}moveLastRight(){var e;const t=null==(e=this._selection)?void 0:e.getRangeAt(0);if(this._selection&&this._selection instanceof Ute&&t){const e=function(e){return e.isAtColumnEnd?null:Ute.createBy([$te.createAt(new MF(e.row,e.columnCount-1,e.rowCount,e.columnCount))])}(this._selection.anchor);this.scrollToSelection(e,"end")}}selectAll(){const e=this._readService.getActiveView();if(e&&e.get("type")===LE.GRID){const t=this._readService.getViewRecordsCount(e.get("uuid")),r=this._readService.getViewFieldsCount(e.get("uuid")),n=this.createGridSelectionByScope({row:0,column:0},{row:t-1,column:r-1},t,r);this.setSelection(n)}}getSelectBoundingRect(){if(this._selection){const e=this._renderContext.$root,t=this.getSelectAnchorTarget();if(t){const r=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.right<r.left||n.left>r.right||n.bottom<r.top||n.top>r.bottom?null:DOMRect.fromRect({x:n.x,y:n.y,width:n.width,height:n.height})}}return null}_getSelectPositionTarget(e){return this._renderContext.$root.querySelector(`.lakex-viewer-grid-row[data-row="${e.row}"] .lakex-viewer-grid-cell[data-col="${e.column}"]`)}getSelectAnchorTarget(e){return!e&&this._selection instanceof Ute&&(e=this._selection),e?this._getSelectPositionTarget(e.anchor):null}getSelectFocusTarget(e){return!e&&this._selection instanceof Ute&&(e=this._selection),e?this._getSelectPositionTarget(e.focus):null}isSelectOneCell(){const e=this._selection;if(!e)return!1;if(this._currentViewType===LE.GRID){const{anchor:t,focus:r}=e;return t.row===r.row&&t.column===r.column}return!1}isSelectOneCol(e){const t=this._selection;if(!t)return!1;if(this._currentViewType===LE.GRID){const{anchor:r,focus:n,rowCount:i}=t;return 0===r.row&&n.row===i-1&&r.column===n.column&&r.column===e}return!1}isSelectOneRow(e){const t=this._selection;if(!t)return!1;if(this._currentViewType===LE.GRID){const{anchor:r,focus:n,columnCount:i}=t;return 0===r.column&&n.column===i-1&&r.row===n.row&&r.row===e}return!1}isInSelect(e,t){const r=this._selection;if(!r)return!1;const{start:n,end:i}=r.ranges[0];return e>=n.row&&e<=i.row&&t>=n.column&&t<=i.column}isActiveCell(e,t){const r=this._selection;return!!r&&(r.anchor.column===t&&r.anchor.row===e)}isAtStart(){const e=this._selection,{anchor:t,focus:r}=e;return!!e&&(t.row===r.row&&t.column===r.column&&e.anchor.isAtRowStart&&e.anchor.isAtColumnStart)}isAtEnd(){const e=this._selection,{anchor:t,focus:r}=e;return!!e&&(t.row===r.row&&t.column===r.column&&e.anchor.isAtRowEnd&&e.anchor.isAtColumnEnd)}scrollToAnchorPosition(e,t,r){const n=null==e?void 0:e.anchor;this._gridScrollIntoView(n.row,t,(()=>{requestAnimationFrame((()=>{var t;const n=this.getSelectAnchorTarget(e);n&&(null==(t=this._gridScrollService)||t.horizontalScroll(n,e.anchor.column)),this.setSelection(e),r&&r()}))}))}scrollToFocusPosition(e,t,r){const n=null==e?void 0:e.focus;this._gridScrollIntoView(n.row,t,(()=>{requestAnimationFrame((()=>{var t;const n=this.getSelectFocusTarget(e);n&&(null==(t=this._gridScrollService)||t.horizontalScroll(n,e.focus.column)),this.setSelection(e),r&&r()}))}))}scrollToSelection(e,t,r){if(!e)return;const n=this._readService.getActiveView();if((null==n?void 0:n.get("type"))!==LE.GRID)if((null==n?void 0:n.get("type"))===LE.KANBAN&&this._kanbanScrollService){const{recordId:i}=e.getRangeAt(0),o=this._readService.getGroupViewRecords(null==n?void 0:n.get("uuid")),{index:a,groupId:s}=this._kanbanScrollService.getKanbanGroupPositionByRecordId(i,o);s&&a>=0&&this._kanbanScrollIntoView(s,a,t,(()=>{var t,n;null==(n=null==(t=this._kanbanScrollService)?void 0:t.groupRefs[s])||n.scrollIntoView(),this.setSelection(e),r&&r()}))}else if((null==n?void 0:n.get("type"))!==LE.CARD);else{const{recordId:i}=e.getRangeAt(0),o=this._readService.getViewRecords(null==n?void 0:n.get("uuid"));let a=-1;for(let e=0;e<o.length;e++)if(o.get(e).get("record_uuid")===i){a=e;break}a>=0&&this._cardScrollIntoView(a,t,(()=>{this.setSelection(e),r&&r()}))}else this.scrollToFocusPosition(e,t,r)}_gridScrollIntoView(e,t,r){var n;null==(n=this._gridScrollService)||n.scrollIntoView({index:e,align:t,done:()=>{r&&r()}})}_kanbanScrollIntoView(e,t,r,n){var i;null==(i=this._kanbanScrollService)||i.scrollIntoView(e,{index:t,align:r,done:()=>{n&&n()}})}_cardScrollIntoView(e,t,r){var n;null==(n=this._cardScrollService)||n.scrollToIndex({index:e,align:t}),r&&r()}_getSelectFieldValue(e){var t,r;if(!e)return null;const n=this._readService.getActiveView();if(!n)return null;const i=e.anchor,o=this._readService.getViewFields(n.get("uuid")),a=this._readService.getFlatViewRecords(n.get("uuid")),s=null==(t=o.get(i.column))?void 0:t.get("field_uuid"),l=null==(r=a.get(i.row))?void 0:r.get("record_uuid");return s&&l?this._readService.getCell(s,l):null}_getSelectFieldValues(e){var t,r;if(!e)return null;const n=this._readService.getActiveView();if(!n)return null;const i=this._readService.getViewFields(n.get("uuid"))||[],o=this._readService.getFlatViewRecords(n.get("uuid"))||[],a=[],s=e.getRangeAt(0);for(let e=s.start.row;e<=s.end.row;e++)for(let n=s.start.column;n<=s.end.column;n++){const s=null==(t=null==i?void 0:i.get(n))?void 0:t.get("field_uuid"),l=null==(r=o.get(e))?void 0:r.get("record_uuid");if(!s||!l)continue;const c=this._readService.getCell(s,l);c&&a.push(c)}return a}};function Yte(){const e=HL(qte),[t,r]=Object(a.useState)((()=>null==e?void 0:e.getSelection()));return Object(a.useEffect)((()=>{const t=null==e?void 0:e.onChange((({selection:e})=>{r(e)}));return()=>{null==t||t.destroy()}}),[e]),t}Gte([ao(KO)],qte.prototype,"_readService",2),Gte([ao(Wz)],qte.prototype,"_renderContext",2),Gte([Ii()],qte.prototype,"destroy",1),qte=Gte([io()],qte);const Jte=Object(a.createContext)(null);function Xte(){return Object(a.useContext)(Jte)}function Zte(e){const t=Yte();return s.a.createElement(Jte.Provider,{value:t},e.children)}var Qte=Object.defineProperty,ere=Object.getOwnPropertyDescriptor;let tre=class{get SelectionContainer(){return Zte}};function rre(){const e=HL(qte),t=HL(zI),[r,n]=Object(a.useState)(null==e?void 0:e.getFieldValue()),i=HL(KO),o=HL(Bk),s=Object(a.useCallback)(((e,t)=>i.getCell(t,e)),[i]);return Object(a.useEffect)((()=>{const t=null==e?void 0:e.onAnchorChange((({fieldValue:e})=>{n(e)}));return()=>{null==t||t.destroy()}}),[e]),Object(a.useEffect)((()=>{const e=null==o?void 0:o.onCellChange((e=>{!r||e.recordId===r.recordId&&e.fieldId===r.fieldId&&n(s(r.recordId,r.fieldId))}));return()=>{null==e||e.destroy()}}),[t,s,r]),r}function nre(e){const t=HL(qte),[r,n]=Object(a.useState)(null),i=rre(),o=Object(a.useCallback)((()=>{const e=null==t?void 0:t.getSelectBoundingRect();return e?{left:e.left,top:e.top,width:e.width,height:e.height}:null}),[]),s=Object(a.useCallback)((()=>{const e=o();n(e)}),[]);return Object(a.useLayoutEffect)((()=>{const t=setTimeout((()=>{e&&s()}),80);return()=>{clearTimeout(t)}}),[e,null==i?void 0:i.value]),Object(a.useLayoutEffect)((()=>{e&&s()}),[e]),r}tre=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ere(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Qte(t,r,o),o})([io()],tre);const ire=$i.defineToken("ViewerGridPluginRecordContribution"),ore=$i.defineToken("ViewerGridPluginStatisticsContribution"),are=$i.defineToken("ViewerGridPluginAddFieldContribution"),sre=$i.defineToken("ViewerGridPluginAddRecordContribution");var lre=Object.defineProperty,cre=Object.getOwnPropertyDescriptor,ure=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lre(t,r,o),o};let dre=class{constructor(){this.UNGROUP_KEY="ungroup",this.Record=null,this.Statistics=null,this.AddField=null,this.AddRecord=null,this._getRecordComponent=()=>{var e,t;const r=this.viewerGridPluginRecordProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getRecordComponent)?void 0:t.call(e):null},this._getStatisticsComponent=()=>{var e,t;const r=this.viewerGridPluginStatisticsProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getStatisticsComponent)?void 0:t.call(e):null},this._getAddFieldComponent=()=>{var e,t;const r=this.viewerGridPluginAddFieldProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getAddFieldComponent)?void 0:t.call(e):null},this._getAddRecordComponent=()=>{var e,t;const r=this.viewerGridPluginAddRecordProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getAddRecordComponent)?void 0:t.call(e):null}}init(){this.Record=this._getRecordComponent(),this.Statistics=this._getStatisticsComponent(),this.AddField=this._getAddFieldComponent(),this.AddRecord=this._getAddRecordComponent()}};ure([wh(ire)],dre.prototype,"viewerGridPluginRecordProvider",2),ure([wh(ore)],dre.prototype,"viewerGridPluginStatisticsProvider",2),ure([wh(are)],dre.prototype,"viewerGridPluginAddFieldProvider",2),ure([wh(sre)],dre.prototype,"viewerGridPluginAddRecordProvider",2),dre=ure([io()],dre);var fre=Object.defineProperty,hre=Object.getOwnPropertyDescriptor,pre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fre(t,r,o),o};let gre=class extends fp{constructor(){super(...arguments),this._onResizeStart=this._register(new _p),this.onResizeStart=this._onResizeStart.event,this._onResize=this._register(new _p),this.onResize=this._onResize.event,this._onResizeEnd=this._register(new _p),this.onResizeEnd=this._onResizeEnd.event,this._indexColWidth=80,this._minColWidth=80,this._maxColWidth=800,this._defaultColWidth=180,this._scrollStep=10,this._scrollThreshold=100,this._groupRowGap=14,this._rootLeft=0,this._rootRight=0,this._scrollLeft=0,this._field=null,this._index=-1,this._startW=0,this._minW=this._indexColWidth+this._minColWidth,this._maxW=Number.MAX_SAFE_INTEGER,this._stickyPaneWidth=0}get indexColWidth(){return this._indexColWidth}get defaultColWidth(){return this._defaultColWidth}get groupRowGap(){return this._groupRowGap}get stickyColNum(){return this._configuration.getValue("viewerGrid.stickyColNum")}getStickyPaneWidth(e){return this._getColTotalWidth(e,this.stickyColNum)+this._indexColWidth}_getColTotalWidth(e,t=0){return Bp(e,(e=>e.get("size")||this._defaultColWidth)).slice(0,t).reduce(((e,t)=>e+t),0)}emitResizeStart(e,t,r){const n=t.get(r),i=this._renderContext.$root.getBoundingClientRect();this._field=n,this._index=r,this._startW=this._getColTotalWidth(t,r+1)+this._indexColWidth,this._minW=this._getColTotalWidth(t,r)+this._indexColWidth+this._minColWidth,this._maxW=this._minW-this._minColWidth+this._maxColWidth,this._stickyPaneWidth=this.getStickyPaneWidth(t),this._rootLeft=i.left,this._rootRight=i.right,this._$scroller=this._renderContext.$root.querySelector('div[data-virtuoso-scroller="true"]'),this._scrollLeft=this._$scroller.scrollLeft,document.body.style.cursor="col-resize",this._onResizeStart.emit({field:this._field,x:e.clientX-this._rootLeft})}emitResizing(e){if(this._index<this.stickyColNum){const t=e.clientX-this._rootLeft,r=this._minW,n=this._maxW;t>=r&&t<=n&&t>0&&this._onResize.emit({field:this._field,x:t})}else{const t=e.clientX-this._rootLeft,r=this._minW-this._scrollLeft,n=this._maxW-this._scrollLeft;t>=r&&t<n&&this._rootRight-this._rootLeft-t<=this._scrollThreshold&&(this._scrollLeft+=this._scrollStep,this._$scroller.scrollLeft+=this._scrollStep),this._scrollLeft>0&&t<this._stickyPaneWidth+this._scrollThreshold&&r<this._stickyPaneWidth&&(this._scrollLeft-=this._scrollStep,this._$scroller.scrollLeft-=this._scrollStep),t>=r&&t<=n&&t>0&&this._onResize.emit({field:this._field,x:t})}}emitResizeEnd(e){var t,r,n;this._onResizeEnd.emit({field:this._field,x:e.clientX-this._rootLeft});const i=this._index<this.stickyColNum,o=e.clientX-this._rootLeft+(i?0:this._scrollLeft),a=Math.max(o,this._minW)-this._startW,s=(null==(t=this._field)?void 0:t.get("size"))||this._defaultColWidth,l=Math.max(s+a,this._minColWidth);this._commandService.execCommand("changeColWidth",{viewId:null==(r=this._field)?void 0:r.get("view_uuid"),fieldId:null==(n=this._field)?void 0:n.get("field_uuid"),size:Math.min(l,this._maxColWidth)}),this._reset()}_reset(){this._startW=0,this._minW=this._indexColWidth+this._minColWidth,this._maxW=Number.MAX_SAFE_INTEGER,this._stickyPaneWidth=0,this._field=null,this._index=-1,this._rootLeft=0,this._rootRight=0,this._scrollLeft=0,document.body.style.cursor="default"}destroy(){super.destroy()}};pre([ao(Wz)],gre.prototype,"_renderContext",2),pre([ao(zI)],gre.prototype,"_commandService",2),pre([ao(lp)],gre.prototype,"_configuration",2),pre([Ii()],gre.prototype,"destroy",1),gre=pre([io()],gre);var mre=Object.defineProperty,vre=Object.getOwnPropertyDescriptor,yre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mre(t,r,o),o};let bre=class{constructor(){this._recordHeightMap={low:36,middle:58,high:146}}getRowHeight(e="low"){return this._recordHeightMap[e]||this._recordHeightMap.low}get rowHeightSize(){const e=this._readService.getViewConfig().get("record_height");return this._recordHeightMap[e]}};yre([ao(KO)],bre.prototype,"_readService",2),bre=yre([io()],bre);var _re=Object.defineProperty,wre=Object.getOwnPropertyDescriptor,Cre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?wre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_re(t,r,o),o};let Ere=class{constructor(){this._tableVirtuosoRef=null,this._tableScroller=null,this._timer=void 0,this.scrollChangedVersion=null,this.onScroll=vN((()=>{this.scrollChangedVersion=To()}),60)}get tableVirtuosoRef(){return this._tableVirtuosoRef}get tableScroller(){if(!this._tableScroller){const e=this.renderContext.$root.querySelector('div[data-virtuoso-scroller="true"]');e&&(this._tableScroller=e)}return this._tableScroller}destroy(){clearTimeout(this._timer),this._tableVirtuosoRef=null,this._tableScroller=null}setTableVirtuosoRef(e){this._tableVirtuosoRef=e}isScrolling(e){var t;e?(clearTimeout(this._timer),null==(t=this.tableScroller)||t.setAttribute("data-scrolling","true")):this._timer=setTimeout((()=>{var e;null==(e=this.tableScroller)||e.setAttribute("data-scrolling","false")}),600)}scrollIntoView(e){var t;null==(t=this._tableVirtuosoRef)||t.scrollIntoView(e)}scrollTo(e){var t;null==(t=this._tableVirtuosoRef)||t.scrollTo(e)}horizontalScroll(e,t){const r=this._readService.getActiveView(),n=t<this._columnControllerService.stickyColNum,i=this.tableScroller;if(!n&&e&&i&&r){const t=i.getBoundingClientRect(),n=e.getBoundingClientRect(),o=this._readService.getViewFields(r.get("uuid"))||[],a=this._readService.getViewGroup(null==r?void 0:r.get("uuid"))?this._columnControllerService.groupRowGap:0,s=this._columnControllerService.getStickyPaneWidth(o)+a;n.right>t.right&&(i.scrollLeft+=n.right-t.right),n.left<t.left+s&&(i.scrollLeft-=t.left+s-n.left)}}mouseMoveScroll(e,t,r,n,i){const o=this.tableScroller,a=(null==n?void 0:n.left)||0,s=(null==n?void 0:n.top)||0,l=e.clientX,c=e.clientY,u=100;o&&l+u>=t?o.scrollLeft+=10:o&&l-u<=a+this._columnControllerService.getStickyPaneWidth(i)&&(o.scrollLeft-=10),o&&c-u<=s?o.scrollTop-=10:o&&c+u>=r&&(o.scrollTop+=10)}};Cre([ao(Wz)],Ere.prototype,"renderContext",2),Cre([ao(gre)],Ere.prototype,"_columnControllerService",2),Cre([ao(KO)],Ere.prototype,"_readService",2),Ere=Cre([io()],Ere);var Sre=Object.defineProperty,kre=Object.getOwnPropertyDescriptor,xre=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kre(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Sre(t,r,o),o};let Ore=class{constructor(){this._rowCoordsByIndex=new Map,this._colCoordsByIndex=new Map,this._scrollUpdatedVersion=""}get _viewport(){return this._renderViewPort.viewport}updateCellCoordsInViewPort(){this._scrollUpdatedVersion&&this._scrollUpdatedVersion===this._scrollService.scrollChangedVersion||(this._scrollUpdatedVersion=this._scrollService.scrollChangedVersion,this._updateRowsLayout(),this._updateColsLayout())}getCellIndexesByClientXY(e,t){if(!this._renderViewPort.isDotInViewPort(e,t))return null;const r=this._getTargetRowIndexByClientY(t);if(Ld(r))return null;const n=this._getTargetColIndexByClientX(e);return Ld(n)?null:[r,n]}_updateRowsLayout(){this._rowCoordsByIndex.clear();const e=this._renderContext.$root;if(!this._viewport)return;const t=e.querySelectorAll(".lakex-viewer-grid-row-container.normal .lakex-viewer-grid-row[data-row]");if(t)for(const e of t){const t=Number(e.getAttribute("data-row")),r=e.getBoundingClientRect();r.top<this._viewport.top||r.bottom>this._viewport.bottom||this._rowCoordsByIndex.set(t,{top:r.top,bottom:r.bottom})}}_updateColsLayout(){this._colCoordsByIndex.clear();const e=this._renderContext.$root;if(!this._viewport)return;const t=e.querySelectorAll(".lakex-viewer-grid-header-column[data-col-index]");if(t)for(const e of t){const t=Number(e.getAttribute("data-col-index")),r=e.getBoundingClientRect();r.left<this._viewport.left||r.right>this._viewport.right||this._colCoordsByIndex.set(t,{left:r.left,right:r.right})}}_getTargetRowIndexByClientY(e){if(!this._rowCoordsByIndex)return null;const t=[...this._rowCoordsByIndex.keys()];let r=0,n=t.length-1;const i=Date.now();for(;r<=n;){if(Date.now()-i>500)return null;const o=Math.floor((r+n)/2),a=t[o],s=this._rowCoordsByIndex.get(a);if(!s){console.warn("_getTargetRowIndexByClientY.get curRowIndex never");break}if(e<s.bottom&&s.top<e)return a;s.bottom<e?r=o+1:e<s.top&&(n=o-1)}return null}_getTargetColIndexByClientX(e){if(!this._colCoordsByIndex)return null;const t=[...this._colCoordsByIndex.keys()];let r=0,n=t.length-1;const i=Date.now();for(;r<=n;){if(Date.now()-i>500)return null;const o=Math.floor((r+n)/2),a=t[o],s=this._colCoordsByIndex.get(a);if(!s){console.warn("_getTargetColIndexByClientX.get curRowIndex never");break}if(e<s.right&&s.left<e)return a;s.left<e?r=o+1:e<s.right&&(n=o-1)}return null}};xre([ao(Wz)],Ore.prototype,"_renderContext",2),xre([ao(Yz)],Ore.prototype,"_renderViewPort",2),xre([ao(Ere)],Ore.prototype,"_scrollService",2),Ore=xre([io()],Ore);var Ire=(e=>(e.laketable="text/laketable",e.text="text/plain",e.html="text/html",e))(Ire||{});const Rre=class{static _setDataToInnerCache(e){Rre._innerCache.push(e)}static _getDataFromInnerCache(){return Rre._innerCache[Rre._innerCache.length-1]}static getFilesFromClipBoard(e){const t=e&&(e.dataTransfer||e.clipboardData);if(!t)return null;const r=t.getData(Ire.text);let n=[];try{t.items&&t.items.length>0?n=Array.from(t.items).map((e=>{let t="file"===e.kind?e.getAsFile():null;return null!==t&&(t.type&&t.type.indexOf("image/png")>-1&&!t.lastModified&&(t=new File([t],"image.png",{type:t.type})),t.ext=r.split(".").pop()),t})).filter((e=>e)):t.files&&t.files.length>0&&(n=Array.from(t.files))}catch{t.files&&t.files.length>0&&(n=Array.from(t.files))}return n}static async getClipboardData(e,t,r){if(null!=r&&r.disableClipboardApi){const t=Rre._getDataFromInnerCache();return t?t[e]:null}if(t){const r=Rre.getClipboardDataFromClipboardEvent(t,e);if(r)return r}return await Rre.getClipboardDataFromClipboardApi(e)}static getClipboardDataFromClipboardEvent(e,t){var r;const n=e&&(e.dataTransfer||e.clipboardData);return n?null==(r=n.getData)?void 0:r.call(n,t):null}static async getClipboardDataFromClipboardApi(e){var t;if(null==(t=navigator.clipboard)||!t.read)return Rre.notSupportClipboardApiToast(),null;try{const t=await navigator.clipboard.read();for(const r of t)for(const t of r.types)if(t===e)return await(await r.getType(t)).text()}catch(e){console.error("getClipboardDataFromClipboardApi err",e)}return null}static async writeToClipboardData(e,t,r){if(null!=r&&r.disableClipboardApi)Rre._setDataToInnerCache(e);else{if(null!=t&&t.setData)return null!=e.laketable&&t.setData(Ire.laketable,e.laketable),null!=e.html&&t.setData(Ire.html,e.html),void(null!=e.text&&t.setData(Ire.text,e.text));if(e.html){!function(e){const t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.clip="rect(0, 0, 0, 0)",document.body.appendChild(t),t.innerHTML=e;const r=document.createRange(),n=window.getSelection(),i=t.querySelector("table");if(!i||!n)return!1;r.selectNodeContents(i),n.removeAllRanges(),n.addRange(r);let o=!1;try{if(o=document.execCommand("copy"),!o)throw"copy command was unsuccessful"}catch(e){throw new Error("unable to copy using execCommand: ",{cause:e})}finally{t.remove(),n.removeAllRanges()}}(e.html);try{const t=new Blob([e.html],{type:Ire.html}),r=new ClipboardItem({[Ire.html]:t});await navigator.clipboard.write([r])}catch(e){return void console.error("writeToClipboardDataByClipboardApi err",e)}}}}};let Tre=Rre;Tre._innerCache=[],Tre.notSupportClipboardApiToast=vN((()=>{m.a.error(Ph("当前浏览器不支持访问剪贴板数据，建议您使用 Chrome 浏览器访问"))}),100);var Are=(e=>(e.COPY="copy",e.CUT="cut",e.NULL="null",e))(Are||{});var Mre=DX;var Nre=function(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],a=t(o);if(null!=a&&(void 0===s?a==a&&!Mre(a):r(a,s)))var s=a,l=o}return l};var Dre=function(e,t){return e>t};var Pre=function(e){return e},jre=Nre,Fre=Dre,Vre=Pre;var Lre=function(e){return e&&e.length?jre(e,Vre,Fre):void 0};var $re=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Bre=TX,Ure=$re;var zre=function(e){if(!Ure(e))return!1;var t=Bre(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Hre=gX["__core-js_shared__"],Wre=function(){var e=/[^.]+$/.exec(Hre&&Hre.keys&&Hre.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var Gre=function(e){return!!Wre&&Wre in e},Kre=Function.prototype.toString;var qre=function(e){if(null!=e){try{return Kre.call(e)}catch{}try{return e+""}catch{}}return""},Yre=zre,Jre=Gre,Xre=$re,Zre=qre,Qre=/^\[object .+?Constructor\]$/,ene=Function.prototype,tne=Object.prototype,rne=ene.toString,nne=tne.hasOwnProperty,ine=RegExp("^"+rne.call(nne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var one=function(e){return!(!Xre(e)||Jre(e))&&(Yre(e)?ine:Qre).test(Zre(e))};var ane=function(e,t){return null==e?void 0:e[t]},sne=one,lne=ane;var cne=function(e,t){var r=lne(e,t);return sne(r)?r:void 0},une=cne,dne=function(){try{var e=une(Object,"defineProperty");return e({},"",{}),e}catch{}}(),fne=dne,hne=fne;var pne=function(e,t,r){"__proto__"==t&&hne?hne(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var gne=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n};var mne=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}},vne=mne();var yne=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},bne=TX,_ne=AX;var wne=function(e){return _ne(e)&&"[object Arguments]"==bne(e)},Cne=wne,Ene=AX,Sne=Object.prototype,kne=Sne.hasOwnProperty,xne=Sne.propertyIsEnumerable,One=Cne(function(){return arguments}())?Cne:function(e){return Ene(e)&&kne.call(e,"callee")&&!xne.call(e,"callee")},Ine=One,Rne={exports:{}};var Tne=function(){return!1};!function(e,t){var r=gX,n=Tne,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Buffer:void 0,s=(a?a.isBuffer:void 0)||n;e.exports=s}(Rne,Rne.exports);var Ane=/^(?:0|[1-9]\d*)$/;var Mne=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Ane.test(e))&&e>-1&&e%1==0&&e<t};var Nne=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Dne=TX,Pne=Nne,jne=AX,Fne={};Fne["[object Float32Array]"]=Fne["[object Float64Array]"]=Fne["[object Int8Array]"]=Fne["[object Int16Array]"]=Fne["[object Int32Array]"]=Fne["[object Uint8Array]"]=Fne["[object Uint8ClampedArray]"]=Fne["[object Uint16Array]"]=Fne["[object Uint32Array]"]=!0,Fne["[object Arguments]"]=Fne["[object Array]"]=Fne["[object ArrayBuffer]"]=Fne["[object Boolean]"]=Fne["[object DataView]"]=Fne["[object Date]"]=Fne["[object Error]"]=Fne["[object Function]"]=Fne["[object Map]"]=Fne["[object Number]"]=Fne["[object Object]"]=Fne["[object RegExp]"]=Fne["[object Set]"]=Fne["[object String]"]=Fne["[object WeakMap]"]=!1;var Vne=function(e){return jne(e)&&Pne(e.length)&&!!Fne[Dne(e)]};var Lne=function(e){return function(t){return e(t)}},$ne={exports:{}};!function(e,t){var r=fX,n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,o=i&&i.exports===n&&r.process,a=function(){try{return i&&i.require&&i.require("util").types||o&&o.binding&&o.binding("util")}catch{}}();e.exports=a}($ne,$ne.exports);var Bne=Vne,Une=Lne,zne=$ne.exports,Hne=zne&&zne.isTypedArray,Wne=Hne?Une(Hne):Bne,Gne=yne,Kne=Ine,qne=yX,Yne=Rne.exports,Jne=Mne,Xne=Wne,Zne=Object.prototype.hasOwnProperty;var Qne=function(e,t){var r=qne(e),n=!r&&Kne(e),i=!r&&!n&&Yne(e),o=!r&&!n&&!i&&Xne(e),a=r||n||i||o,s=a?Gne(e.length,String):[],l=s.length;for(var c in e)(t||Zne.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Jne(c,l)))&&s.push(c);return s},eie=Object.prototype;var tie=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||eie)};var rie=function(e,t){return function(r){return e(t(r))}},nie=rie(Object.keys,Object),iie=tie,oie=nie,aie=Object.prototype.hasOwnProperty;var sie=function(e){if(!iie(e))return oie(e);var t=[];for(var r in Object(e))aie.call(e,r)&&"constructor"!=r&&t.push(r);return t},lie=zre,cie=Nne;var uie=function(e){return null!=e&&cie(e.length)&&!lie(e)},die=Qne,fie=sie,hie=uie;var pie=function(e){return hie(e)?die(e):fie(e)},gie=vne,mie=pie;var vie=function(e,t){return e&&gie(e,t,mie)},yie=uie;var bie=function(e,t){return function(r,n){if(null==r)return r;if(!yie(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}},_ie=bie(vie),wie=_ie;var Cie=function(e,t,r,n){return wie(e,(function(e,i,o){t(n,e,r(e),o)})),n};var Eie=function(){this.__data__=[],this.size=0};var Sie=function(e,t){return e===t||e!=e&&t!=t},kie=Sie;var xie=function(e,t){for(var r=e.length;r--;)if(kie(e[r][0],t))return r;return-1},Oie=xie,Iie=Array.prototype.splice;var Rie=function(e){var t=this.__data__,r=Oie(t,e);return!(r<0)&&(r==t.length-1?t.pop():Iie.call(t,r,1),--this.size,!0)},Tie=xie;var Aie=function(e){var t=this.__data__,r=Tie(t,e);return r<0?void 0:t[r][1]},Mie=xie;var Nie=function(e){return Mie(this.__data__,e)>-1},Die=xie;var Pie=function(e,t){var r=this.__data__,n=Die(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},jie=Eie,Fie=Rie,Vie=Aie,Lie=Nie,$ie=Pie;function Bie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Bie.prototype.clear=jie,Bie.prototype.delete=Fie,Bie.prototype.get=Vie,Bie.prototype.has=Lie,Bie.prototype.set=$ie;var Uie=Bie,zie=Uie;var Hie=function(){this.__data__=new zie,this.size=0};var Wie=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Gie=function(e){return this.__data__.get(e)};var Kie=function(e){return this.__data__.has(e)},qie=cne(gX,"Map"),Yie=cne(Object,"create"),Jie=Yie;var Xie=function(){this.__data__=Jie?Jie(null):{},this.size=0};var Zie=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Qie=Yie,eoe=Object.prototype.hasOwnProperty;var toe=function(e){var t=this.__data__;if(Qie){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return eoe.call(t,e)?t[e]:void 0},roe=Yie,noe=Object.prototype.hasOwnProperty;var ioe=function(e){var t=this.__data__;return roe?void 0!==t[e]:noe.call(t,e)},ooe=Yie;var aoe=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ooe&&void 0===t?"__lodash_hash_undefined__":t,this},soe=Xie,loe=Zie,coe=toe,uoe=ioe,doe=aoe;function foe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}foe.prototype.clear=soe,foe.prototype.delete=loe,foe.prototype.get=coe,foe.prototype.has=uoe,foe.prototype.set=doe;var hoe=foe,poe=Uie,goe=qie;var moe=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},voe=moe;var yoe=function(e,t){var r=e.__data__;return voe(t)?r["string"==typeof t?"string":"hash"]:r.map},boe=yoe;var _oe=function(e){var t=boe(this,e).delete(e);return this.size-=t?1:0,t},woe=yoe;var Coe=function(e){return woe(this,e).get(e)},Eoe=yoe;var Soe=function(e){return Eoe(this,e).has(e)},koe=yoe;var xoe=function(e,t){var r=koe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Ooe=function(){this.size=0,this.__data__={hash:new hoe,map:new(goe||poe),string:new hoe}},Ioe=_oe,Roe=Coe,Toe=Soe,Aoe=xoe;function Moe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Moe.prototype.clear=Ooe,Moe.prototype.delete=Ioe,Moe.prototype.get=Roe,Moe.prototype.has=Toe,Moe.prototype.set=Aoe;var Noe=Moe,Doe=Uie,Poe=qie,joe=Noe;var Foe=function(e,t){var r=this.__data__;if(r instanceof Doe){var n=r.__data__;if(!Poe||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new joe(n)}return r.set(e,t),this.size=r.size,this},Voe=Uie,Loe=Hie,$oe=Wie,Boe=Gie,Uoe=Kie,zoe=Foe;function Hoe(e){var t=this.__data__=new Voe(e);this.size=t.size}Hoe.prototype.clear=Loe,Hoe.prototype.delete=$oe,Hoe.prototype.get=Boe,Hoe.prototype.has=Uoe,Hoe.prototype.set=zoe;var Woe=Hoe;var Goe=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Koe=function(e){return this.__data__.has(e)},qoe=Noe,Yoe=Goe,Joe=Koe;function Xoe(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new qoe;++t<r;)this.add(e[t])}Xoe.prototype.add=Xoe.prototype.push=Yoe,Xoe.prototype.has=Joe;var Zoe=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var Qoe=function(e,t){return e.has(t)},eae=Xoe,tae=Zoe,rae=Qoe;var nae=function(e,t,r,n,i,o){var a=1&r,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,h=2&r?new eae:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],g=t[d];if(n)var m=a?n(g,p,d,t,e,o):n(p,g,d,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!tae(t,(function(e,t){if(!rae(h,t)&&(p===e||i(p,e,r,n,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var iae=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var oae=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},aae=gX.Uint8Array,sae=Sie,lae=nae,cae=iae,uae=oae,dae=mX?mX.prototype:void 0,fae=dae?dae.valueOf:void 0;var hae=function(e,t,r,n,i,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new aae(e),new aae(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return sae(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=cae;case"[object Set]":var l=1&n;if(s||(s=uae),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var u=lae(s(e),s(t),n,i,o,a);return a.delete(e),u;case"[object Symbol]":if(fae)return fae.call(e)==fae.call(t)}return!1};var pae=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},gae=pae,mae=yX;var vae=function(e,t,r){var n=t(e);return mae(e)?n:gae(n,r(e))};var yae=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var bae=yae,_ae=function(){return[]},wae=Object.prototype.propertyIsEnumerable,Cae=Object.getOwnPropertySymbols,Eae=Cae?function(e){return null==e?[]:(e=Object(e),bae(Cae(e),(function(t){return wae.call(e,t)})))}:_ae,Sae=vae,kae=Eae,xae=pie;var Oae=function(e){return Sae(e,xae,kae)},Iae=Oae,Rae=Object.prototype.hasOwnProperty;var Tae=function(e,t,r,n,i,o){var a=1&r,s=Iae(e),l=s.length;if(l!=Iae(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:Rae.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<l;){var g=e[u=s[c]],m=t[u];if(n)var v=a?n(m,g,u,t,e,o):n(g,m,u,e,t,o);if(!(void 0===v?g===m||i(g,m,r,n,o):v)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(h=!1)}return o.delete(e),o.delete(t),h},Aae=cne(gX,"DataView"),Mae=qie,Nae=cne(gX,"Promise"),Dae=cne(gX,"Set"),Pae=cne(gX,"WeakMap"),jae=TX,Fae=qre,Vae="[object Map]",Lae="[object Promise]",$ae="[object Set]",Bae="[object WeakMap]",Uae="[object DataView]",zae=Fae(Aae),Hae=Fae(Mae),Wae=Fae(Nae),Gae=Fae(Dae),Kae=Fae(Pae),qae=jae;(Aae&&qae(new Aae(new ArrayBuffer(1)))!=Uae||Mae&&qae(new Mae)!=Vae||Nae&&qae(Nae.resolve())!=Lae||Dae&&qae(new Dae)!=$ae||Pae&&qae(new Pae)!=Bae)&&(qae=function(e){var t=jae(e),r="[object Object]"==t?e.constructor:void 0,n=r?Fae(r):"";if(n)switch(n){case zae:return Uae;case Hae:return Vae;case Wae:return Lae;case Gae:return $ae;case Kae:return Bae}return t});var Yae=Woe,Jae=nae,Xae=hae,Zae=Tae,Qae=qae,ese=yX,tse=Rne.exports,rse=Wne,nse="[object Arguments]",ise="[object Array]",ose="[object Object]",ase=Object.prototype.hasOwnProperty;var sse=function(e,t,r,n,i,o){var a=ese(e),s=ese(t),l=a?ise:Qae(e),c=s?ise:Qae(t),u=(l=l==nse?ose:l)==ose,d=(c=c==nse?ose:c)==ose,f=l==c;if(f&&tse(e)){if(!tse(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new Yae),a||rse(e)?Jae(e,t,r,n,i,o):Xae(e,t,l,r,n,i,o);if(!(1&r)){var h=u&&ase.call(e,"__wrapped__"),p=d&&ase.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return o||(o=new Yae),i(g,m,r,n,o)}}return!!f&&(o||(o=new Yae),Zae(e,t,r,n,i,o))},lse=sse,cse=AX;var use=function e(t,r,n,i,o){return t===r||(null==t||null==r||!cse(t)&&!cse(r)?t!=t&&r!=r:lse(t,r,n,i,e,o))},dse=Woe,fse=use;var hse=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new dse;if(n)var f=n(c,u,l,e,t,d);if(!(void 0===f?fse(u,c,3,n,d):f))return!1}}return!0},pse=$re;var gse=function(e){return e==e&&!pse(e)},mse=gse,vse=pie;var yse=function(e){for(var t=vse(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,mse(i)]}return t};var bse=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}},_se=hse,wse=yse,Cse=bse;var Ese=function(e){var t=wse(e);return 1==t.length&&t[0][2]?Cse(t[0][0],t[0][1]):function(r){return r===e||_se(r,e,t)}},Sse=yX,kse=DX,xse=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ose=/^\w*$/;var Ise=function(e,t){if(Sse(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!kse(e))||(Ose.test(e)||!xse.test(e)||null!=t&&e in Object(t))},Rse=Noe;function Tse(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(Tse.Cache||Rse),r}Tse.Cache=Rse;var Ase=Tse;var Mse=function(e){var t=Ase(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t},Nse=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dse=/\\(\\)?/g,Pse=Mse((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Nse,(function(e,r,n,i){t.push(n?i.replace(Dse,"$1"):r||e)})),t})),jse=yX,Fse=Ise,Vse=Pse,Lse=UX;var $se=function(e,t){return jse(e)?e:Fse(e,t)?[e]:Vse(Lse(e))},Bse=DX;var Use=function(e){if("string"==typeof e||Bse(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t},zse=$se,Hse=Use;var Wse=function(e,t){for(var r=0,n=(t=zse(t,e)).length;null!=e&&r<n;)e=e[Hse(t[r++])];return r&&r==n?e:void 0},Gse=Wse;var Kse=function(e,t,r){var n=null==e?void 0:Gse(e,t);return void 0===n?r:n};var qse=function(e,t){return null!=e&&t in Object(e)},Yse=$se,Jse=Ine,Xse=yX,Zse=Mne,Qse=Nne,ele=Use;var tle=function(e,t,r){for(var n=-1,i=(t=Yse(t,e)).length,o=!1;++n<i;){var a=ele(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Qse(i)&&Zse(a,i)&&(Xse(e)||Jse(e))},rle=qse,nle=tle;var ile=function(e,t){return null!=e&&nle(e,t,rle)},ole=use,ale=Kse,sle=ile,lle=Ise,cle=gse,ule=bse,dle=Use;var fle=function(e,t){return lle(e)&&cle(t)?ule(dle(e),t):function(r){var n=ale(r,e);return void 0===n&&n===t?sle(r,e):ole(t,n,3)}};var hle=function(e){return function(t){return null==t?void 0:t[e]}},ple=Wse;var gle=function(e){return function(t){return ple(t,e)}},mle=hle,vle=gle,yle=Ise,ble=Use;var _le=function(e){return yle(e)?mle(ble(e)):vle(e)},wle=Ese,Cle=fle,Ele=Pre,Sle=yX,kle=_le;var xle=function(e){return"function"==typeof e?e:null==e?Ele:"object"==typeof e?Sle(e)?Cle(e[0],e[1]):wle(e):kle(e)},Ole=gne,Ile=Cie,Rle=xle,Tle=yX;var Ale=function(e,t){return function(r,n){var i=Tle(r)?Ole:Ile,o=t?t():{};return i(r,e,Rle(n),o)}},Mle=pne,Nle=Ale((function(e,t,r){Mle(e,r,t)})),Dle=Nle,Ple=Ine,jle=yX,Fle=mX?mX.isConcatSpreadable:void 0;var Vle=function(e){return jle(e)||Ple(e)||!!(Fle&&e&&e[Fle])},Lle=pae,$le=Vle;var Ble=function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=$le),o||(o=[]);++a<s;){var l=t[a];r>0&&n(l)?r>1?e(l,r-1,n,i,o):Lle(o,l):i||(o[o.length]=l)}return o},Ule=_ie,zle=uie;var Hle=function(e,t){var r=-1,n=zle(e)?Array(e.length):[];return Ule(e,(function(e,i,o){n[++r]=t(e,i,o)})),n};var Wle=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e},Gle=DX;var Kle=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=Gle(e),a=void 0!==t,s=null===t,l=t==t,c=Gle(t);if(!s&&!c&&!o&&e>t||o&&a&&l&&!s&&!c||n&&a&&l||!r&&l||!i)return 1;if(!n&&!o&&!c&&e<t||c&&r&&i&&!n&&!o||s&&r&&i||!a&&i||!l)return-1}return 0},qle=Kle;var Yle=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var l=qle(i[n],o[n]);if(l)return n>=s?l:l*("desc"==r[n]?-1:1)}return e.index-t.index},Jle=vX,Xle=Wse,Zle=xle,Qle=Hle,ece=Wle,tce=Lne,rce=Yle,nce=Pre,ice=yX;var oce=function(e,t,r){t=t.length?Jle(t,(function(e){return ice(e)?function(t){return Xle(t,1===e.length?e[0]:e)}:e})):[nce];var n=-1;t=Jle(t,tce(Zle));var i=Qle(e,(function(e,r,i){return{criteria:Jle(t,(function(t){return t(e)})),index:++n,value:e}}));return ece(i,(function(e,t){return rce(e,t,r)}))};var ace=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},sce=ace,lce=Math.max;var cce=function(e,t,r){return t=lce(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=lce(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),sce(e,this,s)}};var uce=function(e){return function(){return e}},dce=uce,fce=fne,hce=fce?function(e,t){return fce(e,"toString",{configurable:!0,enumerable:!1,value:dce(t),writable:!0})}:Pre,pce=hce,gce=Date.now;var mce=function(e){var t=0,r=0;return function(){var n=gce(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},vce=mce(pce),yce=Pre,bce=cce,_ce=vce;var wce=function(e,t){return _ce(bce(e,t,yce),e+"")},Cce=Sie,Ece=uie,Sce=Mne,kce=$re;var xce=function(e,t,r){if(!kce(r))return!1;var n=typeof t;return!!("number"==n?Ece(r)&&Sce(t,r.length):"string"==n&&t in r)&&Cce(r[t],e)},Oce=Ble,Ice=oce,Rce=xce,Tce=wce((function(e,t){if(null==e)return[];var r=t.length;return r>1&&Rce(e,t[0],t[1])?t=[]:r>2&&Rce(t[0],t[1],t[2])&&(t=[t[0]]),Ice(e,Oce(t,1),[])})),Ace=Tce,Mce=/\s/;var Nce=function(e){for(var t=e.length;t--&&Mce.test(e.charAt(t)););return t},Dce=Nce,Pce=/^\s+/;var jce=function(e){return e&&e.slice(0,Dce(e)+1).replace(Pce,"")},Fce=jce,Vce=$re,Lce=DX,$ce=/^[-+]0x[0-9a-f]+$/i,Bce=/^0b[01]+$/i,Uce=/^0o[0-7]+$/i,zce=parseInt;var Hce=function(e){if("number"==typeof e)return e;if(Lce(e))return NaN;if(Vce(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Vce(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Fce(e);var r=Bce.test(e);return r||Uce.test(e)?zce(e.slice(2),r?2:8):$ce.test(e)?NaN:+e},Wce=Hce,Gce=1/0;var Kce=function(e){return e?(e=Wce(e))===Gce||e===-Gce?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},qce=Kce;var Yce=function(e){var t=qce(e),r=t%1;return t==t?r?t-r:t:0},Jce=Yce;var Xce=function(e){return"number"==typeof e&&e==Jce(e)};function Zce(e){for(var t=10;t>0&&e;){if(e.tagName&&"td"===e.tagName.toLowerCase()){if(""!==e.innerHTML)return!1;t-=1}e=e.nextSibling}return!0}var Qce=/^\s*\(?¥\s*\(?[\d,.]+\)?$/,eue=/^#+$/,tue=/^\d\.\d+[Ee]\+\d+$/,rue=String.fromCharCode(165),nue=String.fromCharCode(36),iue=String.fromCharCode(8364),oue=String.fromCharCode(163);function aue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;e=function(e){return e.replace(/\\0022/g,"")}(e=function(e,t,r){var n=e.match(/<col[^>]*>/g),i=0;if(n){var o=n[n.length-1].match(/<col[^>]*span=(\d+)[^>]*>/);o&&(i=parseInt(o[1],10))}if(i>r){var a=e.split("</tr>");e=(a=a.map((function(e){var t=e.match(/(\s*<td[^>]*>\s*<\/td>)(\s*)$/);if(t){var r=t[1].repeat(i-30);e.endsWith(r+t[2])&&(e=e.substr(0,e.length-r.length-t[2].length))}return e}))).join("</tr>")}var s=e.match(/\s*<tr[^>]*>\s*(<td[^>]*>\s*<\/td>\s*)+<\/tr>/g);if(s&&s.length>t){var l=e.match(/<td[^>]*>[^<]*[^\s<]+[^<]*<\/td>/g);if(!l)return"<table><tr><td></td></tr></table>";var c=l[l.length-1],u=e.lastIndexOf(c),d=e.slice(0,u+c.length);e=e.slice(u+c.length);var f={};s.forEach((function(e){f[e]=f[e]||{content:e,count:0},f[e].count+=1}));for(var h=Object.values(f),p=(h=Ace(h,"count")).length-1;h[p];){var g=h[p];if(g.count>t){var m=g.content.replace(/([*.?+$^[\](){}|/\\])/g,(function(e){return"\\".concat(e)}));e=e.replace(new RegExp(m,"g"),"")}p--}e=d+e}return e}(e,200,200));var o=(new DOMParser).parseFromString(e,"text/html"),a=o.body,s=function(e,t){for(var r=e.length,n=[],i=0;i<r;i++)t(e[i])&&n.push(e[i]);return n}(o.all,(function(e){return"STYLE"===e.tagName}));if(!a)return null;for(var l,c=a.firstChild,u=[],d=[],f={},h={},p=[],g={},m=!1;c;)if(uue(c)){var v=Cue(c,u.length,s,i);v.mergeCells&&(d=d.concat(v.mergeCells)),v.startCell&&(l=v.startCell),v.selectOptions&&Object.assign(g,v.selectOptions),Object.assign(h,v.rows),v.columns&&Object.assign(f,v.columns),u=u.concat(v.table),v.cellsNeedFix&&(p=p.concat(v.cellsNeedFix)),c=wue(c),m=!1}else if(mue(c))pue(c)&&(c.innerHTML=""),due(c)&&(c.innerHTML=c.innerHTML.replace(/\n/g,"<br/>")),c=c.firstChild||wue(c),m=!1;else if(hue(c)){var y=c.innerText.trim(),b=c.getAttribute("href");lue(u,u.length,y,b),m=!1,c=wue(c)}else if(fue(c)){var _=c.getAttribute("src");cue(u,u.length,_,i),m=!1,c=wue(c)}else if(yue(c))c=c.firstChild||wue(c);else if(bue(c))m=!1,c=wue(c);else if(_ue(c)){var w=c.data;if(""!==w.trim()||!mue(c.parentNode))sue(u,m?u.length-1:u.length,w),m=!0;c=wue(c)}else c=wue(c);var C=function(e){var t={};return e.forEach((function(e,r){e.forEach((function(e,n){e&&0!==Object.keys(e).length&&(t[r]=t[r]||{},0!==Object.keys(e).length&&(t[r][n]=e))}))})),t}(u);d=Dle(d,(function(e){return"".concat(e.row,":").concat(e.col)}));var E=Lre(u.map((function(e){return e.length})))||20,S={name:r||"Sheet".concat(t+1),rowCount:n?Math.max(u.length,n.rowCount):u.length,colCount:n?Math.max(E,n.colCount):E,data:C,mergeCells:d,rows:h,columns:f,filter:{},index:t,defaults:{}};return l&&(S.startCell=l),Object.keys(g).length>0&&(S.selectOptions=g),p.length>0&&(S.cellsNeedFix=p),S}function sue(e,t,r){e[t]=e[t]||[],e[t][0]?e[t][0].value+=""+r:e[t][0]={value:r}}function lue(e,t,r,n){e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value={class:"link",text:r,url:n}}function cue(e,t,r,n){r=function(e){return e.replace(/\?x-oss-process=image\/resize.+/,"")}(r),e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value=n?{class:"image",name:"",src:r}:{class:"image",name:"",status:"needUpload",originSrc:r}}function uue(e){return"TABLE"===e.tagName}function due(e){return"PRE"===e.tagName}function fue(e){return"IMG"===e.tagName}function hue(e){return"A"===e.tagName}function pue(e){var t=e.getAttribute("style");return t&&t.startsWith("mso-element")}var gue=["BODY","ARTICLE","ASIDE","ADDRESS","DD","DL","FIELDSET","FIGCAPTION","FIGURE","FOOTER","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","P","DIV","PRE","BLOCKQUOTE","UL","OL","LI","TABLE","THEAD","TBODY","TFOOT","SECTION"];function mue(e){return 1===e.nodeType&&gue.includes(e.tagName)}var vue=["B","I","ABBR","CITE","CODE","DFN","DEL","EM","KBD","STRONG","SAMP","A","BDO","Q","SPAN","SUB","SUP","BUTTON","LABEL"];function yue(e){return 1===e.nodeType&&vue.includes(e.tagName)}function bue(e){return"BR"===e.tagName}function _ue(e){return 3===e.nodeType}function wue(e){if(e.nextSibling)return e.nextSibling;for(var t=e.parentNode;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}return null}function Cue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=e.cloneNode(!0);document.body.appendChild(i);var o=function(e,t){return function(e){for(var t,r=e.rows,n=r.length,i=[],o=[],a=0,s=0,l=0,c=0;c<n;c++){for(var u=r[c].cells,d=0,f=0;f<u.length;f++){var h=u[f],p=h.rowSpan,g=h.colSpan;a+=p*g,d+=g,p>1&&(s+=(p-1)*g)}o[c]=d,0===c&&(t=d),l=Math.max(d,l)}if(Xce(a/t)&&t===l){var m=0;if(o.forEach((function(e){m+=l-e})),m!==s){var v=s-m;if(v&&Xce(v/l)){for(var y=[],b=0;b<n;b++){for(var _=r[b].cells;i[b+y.length]===l;)y.push(b+y.length);for(var w=b+y.length,C=0;C<_.length;C++){var E=_[C],S=E.rowSpan,k=E.colSpan;if(S>1)for(var x=1;x<S;x++)i[w+x]=(i[w+x]||0)+k}}y.forEach((function(t){e.insertRow(t)}))}}}}(e),function(e){var t=e.rows[0];0===t.cells.length&&t.remove(),e.rows.length>1&&1===t.cells.length&&""===t.cells[0].innerText.trim()&&0===t.cells[0].getElementsByTagName("img").length&&1===t.cells[0].colSpan&&1===t.cells[0].rowSpan&&t.remove()}(e),function(e){Array.from(e.rows).forEach((function(e){var t=e.getAttribute("style"),r=t&&t.match(/mso-xlrowspan:(\d+)/),n=e.getAttribute("height");if(r&&n){var i=parseInt(r[1]);n=parseInt(n)/i||24,e.setAttribute("height",n),e.style.height=n+"px"}if(Array.from(e.cells).forEach((function(t){var r=t.getAttribute("style");if(t.setAttribute("height",n),t.style.height=n+"px",t.colSpan>1&&r&&-1!==r.indexOf("mso-ignore:colspan")){var i=t.colSpan;t.setAttribute("colSpan",1);for(var o=1;o<i;o++){var a=t.cloneNode();e.insertBefore(a,t.nextSibling)}}})),r){var o=parseInt(r[1]);if(o<1e6)for(var a=1;a<o;a++){var s=e.cloneNode();e.parentNode.insertBefore(s,e)}}}))}(e),function(e,t){for(var r=[],n=e.rows,i=n.length,o=100,a=0;a<i;a++){var s=n[a].cells,l=s.length;r[a]=r[a]||[];for(var c=l>16300,u=0;u<l;u++){var d=s[u];if(c&&u>o&&""===d.innerHTML&&Zce(d))break;o=Math.max(o,u);for(var f=d.rowSpan,h=void 0===f?1:f,p=d.colSpan,g=void 0===p?1:p,m=h>1||g>1,v=u;r[a][v];)v++;if(r[a][v]={rowSpan:h,colSpan:g,isMulti:m,element:d},m)for(var y=h;y>0;){for(var b=g;b>0;){if(1!==b||1!==y){var _=a+y-1,w=v+b-1;r[_]=r[_]||[],r[_][w]={isEmpty:!0,parent:{row:a,col:v}}}b--}y--}}}var C=r.map((function(e){return e.length})),E=Math.max.apply(Math,wK(C));return r.forEach((function(e,r){if(e.length<E)for(var n=E-e.length;n--;)0!==r||t?e.push({rowSpan:1,colSpan:1,isShadow:!0,element:null}):e.unshift({rowSpan:1,colSpan:1,isShadow:!0,element:null});for(var i=0;i<E;i++)e[i]||(e[i]={rowSpan:1,colSpan:1,isShadow:!0,element:null})})),{rows:r.length,cols:E,table:r}}(e,t)}(i,n),a={};r&&r.forEach((function(e){document.body.appendChild(e),Object.assign(a,function(e){var t=/([^{}]+){([^{}]+)}/,r=e.match(/[^{}]+{([^{}]+)}/g),n={};return r&&r.forEach((function(e){var r=e.match(t);if(r){var i=r[1].trim(),o=r[2];if(i.startsWith(".")){var a=o.match(/mso-number-format:(.+);(\n|$)/);a&&(n[i.substr(1)]=function(e){return-1!==(e=e.replace(/\/|"|\\/g,"")).indexOf("Date")?"date":-1!==e.indexOf("Time")?"time":e.endsWith("%")?"percentage":-1!==e.indexOf(oue)?{name:"currency",symbol:oue}:-1!==e.indexOf(iue)?{name:"currency",symbol:iue}:-1!==e.indexOf(rue)?{name:"currency",symbol:rue}:e.match(/^@$/)?"text":-1!==e.indexOf("General")||-1!==e.indexOf("Standard")||-1!==e.indexOf("Fixed")?"auto":e.match(/(年|月|日|时|分|秒|dd|y|m|h|s|md|dm)/)?e.match(/(时|分|秒|s|h)/)?"datetime":e.match(/[^d]ddd[^d]/)?{name:"datetime",formatter:"dddd"}:"date":-1!==e.indexOf(nue)?{name:"currency",symbol:nue}:"number"}(a[1]))}}})),0===Object.keys(n).length?null:n}(e.innerHTML))}));var s={table:[]},l=i.querySelectorAll("col");if(l.length>0){var c={},u=0;l.forEach((function(e){for(var t=parseInt(e.getAttribute("width")),r=e.span,n=0;n<r&&u<o.cols;)c[u]=0!==t?{size:t}:{size:0,hidden:!0,oldSize:120},u+=1,n+=1})),s.columns=c}var d=Array.from(i.rows);s.rows={},d.forEach((function(e,r){if(0===e.offsetHeight&&r!==d.length-1)s.rows[r+t]={size:0,hidden:!0,oldSize:24};else{var n=Math.max(e.offsetHeight,24)||24,i={size:n};24!==n&&(i.customSize=n),s.rows[r+t]=i}}));var f=i.getAttribute("data-startCell");if(f){var h=f.split(":");s.startCell={row:parseInt(h[0])||0,col:parseInt(h[1])||0}}var p=i.getAttribute("data-selectOptions");if(p)try{s.selectOptions=JSON.parse(decodeURIComponent(p))}catch(e){console.log(e)}return o.table.forEach((function(e,r){s.table[r]=[],e.forEach((function(e,i){if(e.element){var o=function(e,t){var r=e.getAttribute("data-value");if(r)try{var n=JSON.parse(decodeURIComponent(r));if(function(e){return!!e.class&&("link"===e.class?e.text&&e.url:"file"===e.class||"image"===e.class?e.name&&e.src:"checkbox"===e.class?void 0!==e.value:"select"===e.class?e.value&&(e.options||e.optionId):"mention"===e.class?e.value&&e.value[0].id&&e.value[0].login:"formula"===e.class&&void 0!==e.formula)}(n))return n}catch(e){console.log(e)}for(var i=e.querySelectorAll("img"),o=i.length,a=0;a<o;a++){var s=i[a].getAttribute("src");if(s)return t?{class:"image",src:s,name:"image"}:{class:"image",status:"needUpload",originSrc:s,name:"image"}}e.innerHTML=e.innerHTML.replace(/<!--\[if[\s\S]+<!--\[endif\]-->/g,"").replace(/<rt[^>]*>[^<]*<\/rt>/g,"").replace(/\n/g,"").replace(/<br>\s*/g,"\n");var l,c=e.innerHTML.replace(/<[^>]+>/g,"").trim();c="string"!=typeof(l=c)?l:l.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&nbsp;/g," ");var u=e.querySelector("a");return u&&u.getAttribute("href")?{class:"link",text:c.replace(/\n/g,""),url:u.getAttribute("href")}:(c.endsWith(" %")&&(c=c.replace(/ %$/,"%")),c)}(e.element,n),l=function(e){try{var t=window.getComputedStyle(e),r={};1===e.childNodes.length&&"S"===e.childNodes[0].tagName&&(r.strikeThrough=!0);var n=function(e){var t;-1!==e.indexOf("pt")&&(t=parseInt(e,10));var r=12;if(-1!==e.indexOf("em")?r=parseFloat(e,14):-1!==e.indexOf("px")&&(r=parseFloat(e,10)),t=t||Math.round(r/1.3333333),Sue[t])return t;var n=Object.keys(Sue).map((function(e){return parseInt(e,10)}));n.sort();for(var i=0;n[i];){if(n[i]>t)return n[i];i++}return n[i-1]}(t.fontSize);return-1!==t.textDecoration.indexOf("underline")&&(r.underline=!0),-1!==t.textDecoration.indexOf("line-through")&&(r.strikeThrough=!0),(n>12||e.style.fontSize&&e.style.fontSize.indexOf("px")>0)&&(r.fontSize=n),["rgba(0, 0, 0)","rgb(0, 0, 0)","rgba(0, 0, 0, 0.65)","rgb(88, 90, 90)"].includes(t.color)||(r.color=t.color),"italic"===t.fontStyle&&(r.fontStyle=t.fontStyle),"normal"===t.whiteSpace&&e.classList.length>0&&(r.overflow="wrap"),["400",400,"normal"].includes(t.fontWeight)||(r.fontWeight=t.fontWeight),"middle"!==t.verticalAlign&&(r.vAlign=Eue[t.verticalAlign]||"middle"),"start"!==t.textAlign&&"left"!==t.textAlign&&(r.hAlign=Eue[t.textAlign]||"left"),"rgba(0, 0, 0, 0)"!==t.backgroundColor&&"rgb(255, 255, 255)"!==t.backgroundColor&&(r.backColor=t.backgroundColor),"0px"!==t.borderLeftWidth&&"rgb(204, 204, 204)"!==t.borderLeftColor&&(r.border=r.border||{},r.border.left={color:t.borderLeftColor,lineStyle:"dashed"===t.borderLeftStyle?"dash":"normal"}),"0px"!==t.borderRightWidth&&"rgb(204, 204, 204)"!==t.borderRightColor&&(r.border=r.border||{},r.border.right={color:t.borderRightColor,lineStyle:"dashed"===t.borderRightStyle?"dash":"normal"}),"0px"!==t.borderTopWidth&&"rgb(204, 204, 204)"!==t.borderTopColor&&(r.border=r.border||{},r.border.top={color:t.borderTopColor,lineStyle:"dashed"===t.borderTopStyle?"dash":"normal"}),"0px"!==t.borderBottomWidth&&"rgb(204, 204, 204)"!==t.borderBottomColor&&(r.border=r.border||{},r.border.bottom={color:t.borderBottomColor,lineStyle:"dashed"===t.borderBottomStyle?"dash":"normal"}),0===Object.keys(r).length?null:r}catch{return null}}(e.element),c=function(e){var t=e.getAttribute("data-note");if(t)try{var r=JSON.parse(decodeURIComponent(t));if(r.text)return r}catch(e){console.log(e)}}(e.element),u={name:"auto"},d=!1;if(a){var f=e.element.classList&&e.element.classList[0];a[f]&&("object"===sK(a[f])?Object.assign(u,a[f]):u.name=a[f],["currency","number","percentage"].includes(u.name)&&(u.decimal=2),s.table[r][i]=s.table[r][i]||{},s.table[r][i].type=u,["text","auto"].includes(u.name)||(d=!0))}l&&(s.table[r][i]=s.table[r][i]||{},s.table[r][i].style=l),c&&(s.table[r][i]=s.table[r][i]||{},s.table[r][i].note=c),void 0!==o&&""!==o?(s.table[r][i]=s.table[r][i]||{},s.table[r][i].type=u,s.table[r][i].value=o,"string"==typeof o&&((eue.test(o)||tue.test(o))&&(d=!0),Qce.test(o)&&"auto"===u.name&&(d=!0,s.table[r][i].type.name="currency",s.table[r][i].type.symbol=rue,s.table[r][i].type.decimal=2))):""===o&&s.columns&&s.columns[i]&&s.columns[i].size<=15&&s.columns[i].size>=0&&(d=!0),d&&n&&(s.cellsNeedFix=s.cellsNeedFix||[],s.cellsNeedFix.push({row:r+t,col:i})),e.isMulti&&(s.mergeCells=s.mergeCells||[],s.mergeCells.push({row:r+t,col:i,rowCount:e.rowSpan,colCount:e.colSpan}),l&&(s.table[r+e.rowSpan-1]=s.table[r+e.rowSpan-1]||[],s.table[r+e.rowSpan-1][i+e.colSpan-1]=s.table[r+e.rowSpan-1][i+e.colSpan-1]||{},s.table[r+e.rowSpan-1][i+e.colSpan-1].style=l))}}))})),i.remove(),r&&r.forEach((function(e){e.remove()})),s}var Eue={"-webkit-left":"left","-webkit-right":"right","-webkit-center":"center",left:"left",right:"right",center:"center","-webkit-baseline-middle":"middle",top:"top",bottom:"bottom",middle:"middle"};var Sue={9:12,10:13,11:14,12:16,14:19,16:22,18:24,22:29,24:32,30:40,36:48};class kue{}kue.html=new class{serialize(e){return e?this._standardTableValueToTableHTML(e):""}deserialize(e){return this._tableHTMLToStandardTableValue(e)}_getTrHTML(e){var t;const{cells:r,fields:n,rowHeight:i}=e,o=[];o.length=r.length;const a=r.length;return IN(0,(null==(t=r[0])?void 0:t.length)||0,(e=>{const t=null==n?void 0:n[e];IN(0,a,(n=>{var a,s;o[n]=o[n]||`<tr style="height: ${i}px">`;const l=r[n][e];let c="",u="";if(l&&(l.value||[pE.CHECKBOX,pE.SELECT,pE.MULTI_SELECT].includes(null==t?void 0:t.type))){switch(null==t?void 0:t.type){case pE.SELECT:case pE.MULTI_SELECT:{const e=l.formatValue.split(",");c=` data-value="${encodeURIComponent(JSON.stringify({class:"select",value:e,options:null==(a=t.options)?void 0:a.map((e=>({id:e.get("uuid"),value:e.get("name"),color:e.get("color")}))),color:!(null==(s=t.options)||!s.get(0).get("color")),multi:t.type===pE.MULTI_SELECT}))}"`,u=l.formatValue;break}case pE.MENTION:c=` data-value="${encodeURIComponent(JSON.stringify({class:t.type,value:l.formatValue}))}"`,u=l.formatValue;break;case pE.IMAGE:{const e=l.value;u=(null==e?void 0:e.map((e=>`<img src="${e.src}" height=${t.size} />`)).join(""))||"";break}case pE.LINK:{const e=l.value;u=e?`<a href="${e.src}">${e.name}</a>`:"";break}case pE.FILE:{const e=l.value;u=e?e.map((e=>`<a href="${e.src}">${e.name}</a>`)).join(""):"";break}case pE.CHECKBOX:{const e=l.value;u=!0===e?"✅":"🔲",c=` data-value="${encodeURIComponent(JSON.stringify({class:t.type,value:!0===e}))}"`;break}default:u=vf(l.formatValue)}o[n]+=`<td ${c}>${u}</td>`}else o[n]+="<td></td>"}))})),IN(0,a,(e=>{o[e]+="</tr>"})),o}_standardTableValueToTableHTML(e){const{startCell:t,fields:r}=e,n=this._getTrHTML(e),i=[];r&&r.forEach((e=>{i.push(`<col width=${e.size}>`)}));const o=`<colgroup>${i.join("")}</colgroup>`;return`\x3c!--StartFragment--\x3e<style type="text/css">\x3c!--\n    td {border: 0.5pt solid #ccc;white-space: nowrap;}\n    br {mso-data-placement:same-cell;}\n    .numberstr{mso-number-format:"@";}\n    .perc {mso-number-format:0%;}\n    .curr¥ {mso-number-format:"¥#,##0.00;[red]¥#,##0.00";}\n    .curr$ {mso-number-format:"$#,##0.00;[red]$#,##0.00";}\n    .curr£ {mso-number-format:"£#,##0.00;[red]£#,##0.00";}\n    .curr€ {mso-number-format:"€#,##0.00;[red]€#,##0.00";}\n    --\x3e</style><table style="font-size: 12px;" data-startCell="${t.row}:${t.column}">${o}${n.join("")}</table>\x3c!--EndFragment--\x3e`}_tableHTMLToStandardTableValue(e){const t=aue(e),{rowCount:r,colCount:n,data:i}=t,o=[];let a=0;for(;a<r;){if(o[a]=[],o[a].length=n,i[a]){let e=0;for(;e<n;){if(i[a][e]){const t=i[a][e],r=this._htmlValueToTableCell(t);o[a][e]=r}e++}}a++}return{cells:o}}_htmlValueToTableCell(e){const t={fieldType:pE.TEXT,value:""},r=e.value||"";if(jo(r)||Po(r)||Fd(r))return t.value=r,t;const n=r.class;if("link"===n){const e=r,n={name:e.text,src:e.url};t.fieldType=pE.LINK,t.value=n}else if("file"===n){const e=r,n=[{name:e.text,src:e.url}];t.fieldType=pE.IMAGE,t.value=n}else if("image"===n){const e=r,n=[{name:e.name,src:e.originSrc}];t.fieldType=pE.IMAGE,t.value=n}else if("select"===n){const e=r;if(e.multi){const r=e.value;t.fieldType=pE.MULTI_SELECT,t.value=r}else{const r=e.value[0];t.fieldType=pE.SELECT,t.value=r}}return t}},kue.text=new class{serialize(e){if(!e)return"";const{cells:t}=e,r=[],n=t.length,i=t[0].length;return IN(0,n,(e=>{const n=[];IN(0,i,(r=>{const i=t[e][r];let o="";o=i?i.formatValue:"",n.push(o)})),r.push(n.join("\t"))})),r.join("\n")}deserialize(e){const t=[],r={cells:t};return e&&e.split("\n").forEach(((e,r)=>{const n=e.split("\t");t[r]=[],n.forEach(((e,n)=>{const i={fieldType:pE.TEXT,value:e};t[r][n]=i}))})),r}},kue.laketable=new class{serialize(e){return JSON.stringify(e)}deserialize(e){return JSON.parse(e)}};var xue=Object.defineProperty,Oue=Object.getOwnPropertyDescriptor,Iue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Oue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xue(t,r,o),o};let Rue=class{constructor(){this.runningStatus=Are.NULL}get _selection(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelection();return Kte(t)?t:null}copy(e){m.a.destroy(),this._enable()&&(!this._selection||0===this._selection.rangeCount||(this.runningStatus=Are.COPY,this._setDataToClipboard(e),this._showCopyCutSuccessMessage(),this.runningStatus=Are.NULL))}cut(e){!this._enable()||(this.runningStatus=Are.CUT,this.runningStatus=Are.NULL)}_enable(){var e;return!(this.runningStatus!==Are.NULL||!this._selection)&&(!!window.formulaCopy||!(this._abilityService.isReadonly(aR.TABLE)&&(null==(e=window.appData)?void 0:e.disableDocumentCopy)))}_setDataToClipboard(e){null==e||e.preventDefault();const t=this._getDataBySelections(),r=e&&(e.dataTransfer||e.clipboardData),n=kue.laketable.serialize(t),i=kue.html.serialize(t),o=kue.text.serialize(t),a=this._configuration.getValue("clipboard.clipboardApi.disable");return Tre.writeToClipboardData({laketable:n,html:i,text:o},r,{disableClipboardApi:a}),t}_getDataBySelections(){const e=this._selection,t=null==e?void 0:e.getRangeAt(0),r=null==t?void 0:t.start,n=null==t?void 0:t.end;if(!e||!r||!n)return null;const i=n.row-r.row+1,o=n.column-r.column+1,a=new Array(i).fill(0).map((e=>new Array(o).fill(0))),s=[],l=this._readService.getActiveView(),c=this._readService.getViewFields(null==l?void 0:l.get("uuid"))||[],u=this._readService.getFlatViewRecords(null==l?void 0:l.get("uuid"))||[],d=this._readService.getViewConfig(null==l?void 0:l.get("uuid"));for(let e=0;e<o;e++){const t=c.get(e+r.column),n=t.get("field"),o=(null==n?void 0:n.get("uuid"))||"";n&&s.push({...n.toJSON(),size:t.get("size")||180});for(let t=0;t<i;t++){const n=u.get(t+r.row).get("record_uuid"),i=this._readService.getCell(o,n);i&&(a[t][e]=i)}}return{fields:s,cells:a,startCell:r,rowHeight:this._rowControllerService.getRowHeight(null==d?void 0:d.get("record_height"))}}_showCopyCutSuccessMessage(){const e=this._selection,t=null==e?void 0:e.getRangeAt(0),r=null==t?void 0:t.start,n=null==t?void 0:t.end;if(!e||!r||!n)return null;const i=n.row-r.row+1,o=n.column-r.column+1;m.a.success(Ph("成功复制 $1 个单元格",i*o))}};Iue([ao(KO)],Rue.prototype,"_readService",2),Iue([ao(qte),cN()],Rue.prototype,"_selectionService",2),Iue([ao(bre)],Rue.prototype,"_rowControllerService",2),Iue([ao(lp)],Rue.prototype,"_configuration",2),Iue([ao(bR)],Rue.prototype,"_abilityService",2),Rue=Iue([io()],Rue);var Tue=Object.defineProperty,Aue=Object.getOwnPropertyDescriptor,Mue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Aue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Tue(t,r,o),o};let Nue=class{constructor(){this._pasteData=null}get _selection(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelection();if(Kte(t)){const{anchor:e,focus:r}=t,n=r.row-e.row+1,i=r.column-e.column+1;return{startRowIndex:e.row,startColIndex:e.column,rowCount:n,colCount:i}}return null}async paste(e){!this._selection||(m.a.destroy(),this._asyncPasteIfNeedUpload(e),this._pasteData=await this._getStdCellValueFromClip(e),this._process(this._selection,this._pasteData))}async _getStdCellValueFromClip(e){let t=null;const r=this._configuration.getValue("clipboard.clipboardApi.disable"),n=[{key:Ire.laketable,serializer:kue.laketable},{key:Ire.html,serializer:kue.html},{key:Ire.text,serializer:kue.text}];for(const i of n){const{key:n,serializer:o}=i,a=await Tre.getClipboardData(n,e,{disableClipboardApi:r});if(a&&(t=o.deserialize(a)),t)break}return t}async _process(e,t){if(!this._enable(e,t))return;const{cells:r}=t,n=r.length*r[0].length,i=m.a.loading(Ph("正在处理粘贴内容..."),0);return new Promise((r=>{setTimeout((()=>{var n,o,a,s,l,c,u,d,f,h;const p=null==(n=this._selectionService)?void 0:n.getSelection(),g=this._commandService.execCommand("pasteUpdateRecords",{selection:e,pasteData:t,colCount:(null==p?void 0:p.columnCount)||1}),v=(null==(a=null==(o=null==g?void 0:g.result)?void 0:o.data)?void 0:a.createRecordIds)||[];if(v.length>0&&p){const e=this._selectionService.createGridSelectionByIndex(p.anchor.row,p.anchor.column,p.rowCount+v.length,p.columnCount);this._selectionService.setSelection(e)}i(),0===(null==(s=null==g?void 0:g.result)?void 0:s.code)?m.a.success(null==(l=null==g?void 0:g.result)?void 0:l.message):(null==(c=null==g?void 0:g.result)?void 0:c.code)&&(null==(u=null==g?void 0:g.result)?void 0:u.code)>0?m.a.error(null==(d=null==g?void 0:g.result)?void 0:d.message):-1===(null==(f=null==g?void 0:g.result)?void 0:f.code)&&(console.error(`Internal Error After execCommand: "pasteUpdateRecords", ${null==(h=null==g?void 0:g.result)?void 0:h.message}`),m.a.error(Ph("粘贴失败, 请稍后重试"))),r(null==g?void 0:g.result)}),n>100?100:0)}))}_enable(e,t){var r,n;if(!t||!e)return!1;const{rowCount:i,startRowIndex:o,startColIndex:a}=e;if(o+i>this._readService.maxRecordCount)return m.a.error(Ph("数据表已达最大行数限制")),!1;const s=(null==(r=this._readService.getAllViewFields())?void 0:r.length)||0;return!(a+((null==(n=t.fields)?void 0:n.length)||0)>s)||(m.a.error(Ph("复制失败，没有足够的列")),!1)}async _asyncPasteIfNeedUpload(e){if(!this._selection||!e)return;const t=Tre.getFilesFromClipBoard(e),r=null==t?void 0:t[0];if(!r)return;const n=this._readService.getCellByIndexes(this._selection.startRowIndex,this._selection.startColIndex);if(!n||![pE.IMAGE,pE.FILE].includes(n.fieldType))return void console.warn("target field type is not support for file");this._uploadService.getAccept(null==n?void 0:n.fieldType);const i=(null==n?void 0:n.fieldType)===pE.IMAGE?this._uploadService.uploadImage(r):this._uploadService.uploadFile(r),o={...this._selection,rowCount:1,colCount:1},a=i.onDidChange((async e=>{var t;if(e.status!==y6.ERROR)if(e.status!==y6.TIMEOUT){if(e.status===y6.SUCCESS){const r=e.file,i={cells:[[{...n,value:null==(t=n.value||[])?void 0:t.concat([r])}]]};await this._process(o,i),a.destroy()}}else m.a.error(e.message||Ph("上传超时，请重试"));else m.a.error(e.message||Ph("上传失败，请重试"))}))}};Mue([ao(KO)],Nue.prototype,"_readService",2),Mue([ao(qte),cN()],Nue.prototype,"_selectionService",2),Mue([ao(zI)],Nue.prototype,"_commandService",2),Mue([ao(lp)],Nue.prototype,"_configuration",2),Mue([ao(F6)],Nue.prototype,"_uploadService",2),Nue=Mue([io()],Nue);var Due=Object.defineProperty,Pue=Object.getOwnPropertyDescriptor,jue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Pue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Due(t,r,o),o};let Fue=class{constructor(){this._onCopy=null,this._onCut=null,this._onPaste=null}static pluginModule(){return xo().register(this).register(Rue).register(Nue)}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}get _isGridView(){return this._readService.getActiveViewType()===LE.GRID}get _isPasteInUpload(){var e;const t=null==(e=document.activeElement)?void 0:e.classList;return null==t?void 0:t.contains("ant-upload")}init(){}static registerConfiguration(e){e.registerConfiguration({id:"clipboard",type:"object",title:"粘贴板",properties:{"clipboardApi.disable":{type:"boolean",description:"不使用 clipboard api"}}}),e.registerDefaultValue({"clipboard.clipboardApi.disable":!1})}registerHotkey(e){e.registerItem({id:"copy",hotkey:"copy",name:"copy",enableOnInput:!1,preventDefault:!0,isEnable:()=>this._hasSelection()&&this._isGridView,onHotKey:e=>{this._copyCutService.copy(e)}}),e.registerItem({id:"cut",hotkey:"cut",name:"cut",preventDefault:!0,enableOnInput:!1,isEnable:()=>!this._abilityService.isReadonly(aR.TABLE)&&this._hasSelection()&&this._isGridView,onHotKey:e=>{this._copyCutService.cut(e)}}),e.registerItem({id:"paste",hotkey:"paste",name:"paste",preventDefault:!0,enableOnInput:!1,isEnable:()=>!this._abilityService.isReadonly(aR.TABLE)&&this._hasSelection()&&this._isGridView&&!this._isPasteInUpload,onHotKey:e=>{this._pasteService.paste(e)}})}destroy(){var e,t,r;null==(e=this._onCopy)||e.destroy(),null==(t=this._onCut)||t.destroy(),null==(r=this._onPaste)||r.destroy()}};Fue.pluginName="render-clipboard",jue([ao(KO)],Fue.prototype,"_readService",2),jue([ao(bR)],Fue.prototype,"_abilityService",2),jue([ao(Rue)],Fue.prototype,"_copyCutService",2),jue([ao(Nue)],Fue.prototype,"_pasteService",2),jue([ao(qte),cN()],Fue.prototype,"_selectionService",2),Fue=jue([io({contrib:[Dz,hz]})],Fue);const Vue=$i.defineToken("RefreshRenderPluginContribution");function Lue(e){const t=HL(Dte),[r,n]=Object(a.useState)((()=>t.isInHighlight(e)));return Object(a.useEffect)((()=>{const r=t.onChange((({highlightCellIds:r,highlightRecordIds:i})=>{const o=t.isInHighlight(e);n(o)}));return()=>{r.destroy()}}),[t]),r}var $ue=Object.defineProperty,Bue=Object.getOwnPropertyDescriptor,Uue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$ue(t,r,o),o};let zue=class extends fp{constructor(){super(...arguments),this._task=null,this._originCellValue=null,this._handleRefresh=()=>{},this._selectionListener=null,this._commandListener=null,this._onRefreshTooltipChange=this._register(new _p),this.onRefreshTooltipChange=this._onRefreshTooltipChange.event,this.DESC_MAP={[XO.GROUP]:{text:Ph("本记录将被移至新的分组"),ps:Ph("本记录不属于该分组，点击其他区域将移走该记录")},[XO.FILTER]:{text:Ph("本记录将被过滤"),ps:Ph("本记录已被筛选过滤，点击其他区域将隐藏该记录")},[XO.SORT]:{text:Ph("本记录将被移动到新的排序位置"),ps:Ph("本记录因排序规则会移动，点击其他区域将移走该记录")}}}destroy(){super.destroy()}init(){this._bindEvent()}_bindEvent(){this._refreshEventService.onBeforeRefresh((async({type:e,commandName:t,params:r,action:n})=>{var i,o,a,s,l,c;const u=this._readService.getActiveView();if(null==(i=this._selectionListener)||i.destroy(),null==(o=this._commandListener)||o.destroy(),"setCell"===t){const i=r,o=this._readService.getCell(i.fieldId,i.recordId),l=null==(a=this._selectionService)?void 0:a.getSelection();if(!this._originCellValue&&o&&(this._originCellValue=o.value),this._task)if(t===this._task.commandName&&i.recordId===this._task.params.recordId&&i.fieldId===this._task.params.fieldId){if(Vd(null==i?void 0:i.value,this._originCellValue))return this._task=null,this._hideHighlight(),void this._hideTooltip();this._task={type:e,commandName:t,params:r,action:n}}else await this._task.action(),this._task={type:e,commandName:t,params:r,action:n};else this._task={type:e,commandName:t,params:r,action:n};return(null==u?void 0:u.get("type"))===LE.GRID&&this._showHighlight(u,i.recordId),this._showTooltip(e,i.recordId),this._handleRefresh=async()=>{var e,t;null==(e=this._commandListener)||e.destroy(),await(null==(t=this._task)?void 0:t.action()),this._afterRefresh(),this._updateSelection(u,i.recordId,l)},(null==u?void 0:u.get("type"))===LE.GRID&&(this._selectionListener=null==(s=this._selectionService)?void 0:s.onChange((({selection:e})=>{e?e.isCollapsed&&e.anchor.row!==l.anchor.row&&this._handleRefresh():this._handleRefresh()}))),void(this._commandListener=this._commandService.onDidExecuteCommand((()=>{this._handleRefresh()})))}if("addEmptyRecord"===t){const{uuid:i}=r,o=null==(l=this._selectionService)?void 0:l.getSelection();return this._task?(await this._task.action(),this._task={type:e,commandName:t,params:r,action:n}):this._task={type:e,commandName:t,params:r,action:n},(null==u?void 0:u.get("type"))===LE.GRID&&this._showHighlight(u,i),this._showTooltip(e,i),this._handleRefresh=async()=>{var e;await(null==(e=this._task)?void 0:e.action()),this._afterRefresh()},(null==u?void 0:u.get("type"))===LE.GRID&&(this._selectionListener=null==(c=this._selectionService)?void 0:c.onChange((({selection:e})=>{var t;e?e.isCollapsed&&e.anchor.row!==(null==(t=null==o?void 0:o.anchor)?void 0:t.row)&&this._handleRefresh():this._handleRefresh()}))),void(this._commandListener=this._commandService.onDidExecuteCommand((()=>{this._handleRefresh()})))}n()}))}_showHighlight(e,t){const r=Bp(this._readService.getViewFields(null==e?void 0:e.get("uuid")),(e=>({recordId:t,fieldId:e.get("field_uuid")})))||[];this._highlightService.setHighlights(r)}_hideHighlight(){this._highlightService.clearHighlights()}_showTooltip(e,t){this._onRefreshTooltipChange.emit({type:e,recordId:t,desc:this.DESC_MAP[e]})}_hideTooltip(){this._onRefreshTooltipChange.emit({type:null,recordId:"",desc:{text:"",ps:""}})}_updateSelection(e,t,r){var n,i,o;if((null==e?void 0:e.get("type"))===LE.GRID&&r){const a=this._readService.getFlatViewRecords(e.get("uuid")),s=r.anchor,l=Lp(a,(e=>(null==e?void 0:e.get("record_uuid"))===t));if(l>=0){const e=null==(n=this._selectionService)?void 0:n.getSelection(),t=null==(i=this._selectionService)?void 0:i.createGridSelectionByIndex(l,e?e.anchor.column:s.column,s.rowCount,s.columnCount);null==(o=this._selectionService)||o.scrollToSelection(t,"center")}}}_afterRefresh(){var e,t;this._task=null,this._originCellValue=null,this._hideHighlight(),this._hideTooltip(),null==(e=this._selectionListener)||e.destroy(),null==(t=this._commandListener)||t.destroy()}};Uue([ao(ZO)],zue.prototype,"_refreshEventService",2),Uue([ao(qte),cN()],zue.prototype,"_selectionService",2),Uue([ao(KO)],zue.prototype,"_readService",2),Uue([ao(Dte)],zue.prototype,"_highlightService",2),Uue([ao(zI)],zue.prototype,"_commandService",2),Uue([Ii()],zue.prototype,"destroy",1),zue=Uue([io()],zue);var Hue=Object.defineProperty,Wue=Object.getOwnPropertyDescriptor,Gue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Wue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Hue(t,r,o),o};let Kue=class{static pluginModule(){return xo().contribution(Vue).register(this).register(zue)}init(){this._refreshService.init()}};Kue.pluginName="render-refresh",Gue([ao(zue)],Kue.prototype,"_refreshService",2),Kue=Gue([io({contrib:Dz})],Kue);var que=Object.defineProperty,Yue=Object.getOwnPropertyDescriptor,Jue=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Yue(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&que(t,r,o),o},Xue=(e=>(e.HEADER="header",e.GROUP_HEADER="group_header",e.CELL="cell",e.MULTI_CELL="multi_cell",e.KANBAN_RECORD="kanban_record",e.CARD_RECORD="card_record",e))(Xue||{});let Zue=class extends fp{constructor(){super(...arguments),this._onContextMenu=this._register(new _p),this.contextMenuInfo=null,this.onContextMenu=this._onContextMenu.event}showContextMenu(e){this._onContextMenu.emit(e),this.contextMenuInfo=e}destroy(){super.destroy()}};Jue([Ii()],Zue.prototype,"destroy",1),Zue=Jue([io()],Zue);var Que=Object.defineProperty,ede=Object.getOwnPropertyDescriptor;let tde=class{static pluginModule(){return xo().register(this).register(Zue)}init(e){}};tde.pluginName="render-context-menu",tde=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ede(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Que(t,r,o),o})([io({contrib:Dz})],tde);const rde=$i.defineToken("ViewerRowHeaderIconContribution");var nde=Object.defineProperty,ide=Object.getOwnPropertyDescriptor,ode=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ide(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nde(t,r,o),o};let ade=class{constructor(){this._getExpandRecordRecordHeaderIcon=()=>{var e,t;const r=this._viewerGridRecordHeaderIconContribution.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getHeaderIcon)?void 0:t.call(e):null}}get ExpandRecordRecordHeaderIcon(){return this._getExpandRecordRecordHeaderIcon()}};ode([wh(rde)],ade.prototype,"_viewerGridRecordHeaderIconContribution",2),ade=ode([io()],ade);const sde=({recordId:e})=>{const t=HL(Qz);return s.a.createElement(E.a,{prefixCls:"ant"},s.a.createElement(p.a,{title:Ph("展开行（Space）"),placement:"top",shouldHiddenOnHover:!0,shouldArrowCenter:!0},s.a.createElement("div",{className:"lakex-viewer-grid-row-expander",onClick:r=>{r.stopPropagation(),null==t||t.emitClickRecord({recordId:e})}},s.a.createElement(XU,{type:"RowExpand"}))))};var lde=Object.defineProperty,cde=Object.getOwnPropertyDescriptor,ude=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?cde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&lde(t,r,o),o};let dde=class{static pluginModule(){return xo().register(this)}getHeaderIcon(){return sde}registerOpenerApp(){return[{name:"record",display_name:"Record",description:"记录"}]}registerOpener(){return[{openerName:"record-opener",apps:["record"],autoClear:!0,open:e=>{var t;this._lifecycleService.status<kh.Rendered?this._lifecycleService.when(kh.Rendered,(()=>{var t;null==(t=this._renderService)||t.emitClickRecord({recordId:e})})):null==(t=this._renderService)||t.emitClickRecord({recordId:e})}}]}};dde.pluginName="render-expand-record",ude([ao(Qz)],dde.prototype,"_renderService",2),ude([ao(xh)],dde.prototype,"_lifecycleService",2),dde=ude([io({contrib:[rde,lH]})],dde);var fde=Object.defineProperty,hde=Object.getOwnPropertyDescriptor,pde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fde(t,r,o),o};function gde(e){var t;let r=-1,n=-1;return r=parseInt((null==e?void 0:e.getAttribute("data-col"))||"",10),n=parseInt((null==(t=null==e?void 0:e.parentNode)?void 0:t.getAttribute("data-row"))||"",10),(wN(r)||wN(n))&&console.warn("getCoordinateFromNode NaN error",{column:r,row:n}),{row:n,column:r}}const mde="ant";let vde=class{constructor(){this._selectorMap={[LE.GRID]:".lakex-viewer-grid-cell",[LE.KANBAN]:".lakex-viewer-kanban-record",[LE.CARD]:".lakex-viewer-card-record-item"},this._baseSelector="",this._mouseDownEmitter=null,this._mouseMoveEmitter=null,this._mouseUpEmitter=null}static pluginModule(){return xo().contribution(Lte).register(this).register(qte).register(tre)}init(){this._listenEvent(),this._registerScrollService()}_registerScrollService(){const e=this._selectionPluginProvider.getContributions();for(const t of e)try{t.registerScrollService(this._selectionService)}catch(e){console.error(e)}}_listenEvent(){let e=null,t=null;this._mouseDownEmitter=EL(document.body,"mousedown",(r=>{var n,i,o;if(null==(n=this._mouseMoveEmitter)||n.destroy(),null==(i=this._mouseUpEmitter)||i.destroy(),xL(r.target,`.${P8}`)||xL(r.target,`.${mde}-picker-dropdown`)||xL(r.target,`.${mde}-popover`)||xL(r.target,`.${mde}-select-dropdown`))return;if(this._activeTableService.isAutoActive||(this._renderContext.$workbenchRoot.contains(r.target)?this._activeTableService.active():this._activeTableService.inactive()),!this._renderContext.$root.contains(r.target))return void this._removeSelection();const a=this._readService.getActiveView();if(!a)return;if(a.get("type")!==LE.GRID)return void this._removeSelection();const s=this._selectionService.gridScrollService,l=document.body.clientWidth,c=document.body.clientHeight,u=null==(o=null==s?void 0:s.tableScroller)?void 0:o.getBoundingClientRect();if(this._baseSelector=this._selectorMap[(null==a?void 0:a.get("type"))||""],e=xL(r.target,this._baseSelector),!this._baseSelector||!e)return void this._removeSelection();if(2===r.button)return;const d=this._readService.getViewFields(a.get("uuid"))||[],f=this._readService.getViewRecordsCount(a.get("uuid")),h=d.length;this._mouseMoveEmitter=EL(this._renderContext.$root,"mousemove",(r=>{if(Ld(e))return;s&&u&&s.mouseMoveScroll(r,l,c,u,d);const n=xL(r.target,this._baseSelector);n!==t&&n&&(t=n,this._updateSelection(e,t,f,h))})),this._mouseUpEmitter=EL(document.body,"mouseup",(r=>{var n,i;null==(n=this._mouseMoveEmitter)||n.destroy();const o=xL(r.target,this._baseSelector);Ld(e)||(o!==t&&o&&(t=o,this._updateSelection(e,t,f,h)),null==(i=this._mouseUpEmitter)||i.destroy(),e=null,t=null)}))}))}_updateSelection(e,t,r,n){var i,o;const a=gde(e),s=gde(t),l=null==(i=this._selectionService)?void 0:i.createGridSelectionByScope(a,s,r,n);null==(o=this._selectionService)||o.setSelection(l)}_removeSelection(){var e;null==(e=this._selectionService)||e.removeSelection()}destroy(){var e,t,r;null==(e=this._mouseDownEmitter)||e.destroy(),null==(t=this._mouseMoveEmitter)||t.destroy(),null==(r=this._mouseUpEmitter)||r.destroy(),this._mouseDownEmitter=null,this._mouseMoveEmitter=null,this._mouseUpEmitter=null}};vde.pluginName="render-selection",pde([ao(Wz)],vde.prototype,"_renderContext",2),pde([ao(KO)],vde.prototype,"_readService",2),pde([ao(Bz)],vde.prototype,"_activeTableService",2),pde([ao(qte),cN()],vde.prototype,"_selectionService",2),pde([wh(Lte)],vde.prototype,"_selectionPluginProvider",2),vde=pde([io({contrib:Dz})],vde);var yde=Object.defineProperty,bde=Object.getOwnPropertyDescriptor,_de=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?bde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&yde(t,r,o),o};let wde=class{static pluginModule(){return gG.register(this),gG}get _isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get _currentViewType(){return this._readService.getActiveView().get("type")}_hasSelection(){return!1}init(){this._hotkeyService.init()}destroy(){this._hotkeyService.destroy()}};wde.pluginName="render-hotkey",_de([ao(fz)],wde.prototype,"_hotkeyService",2),_de([ao(KO)],wde.prototype,"_readService",2),_de([ao(bR)],wde.prototype,"_abilityService",2),wde=_de([io({contrib:[Dz]})],wde);const Cde=$i.defineToken("StatisticsRenderPluginContribution");var Ede=Object.defineProperty,Sde=Object.getOwnPropertyDescriptor,kde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Ede(t,r,o),o};let xde=class extends fp{constructor(){super(...arguments),this._onClick=this._register(new _p),this.onClick=this._onClick.event}open(e,t,r,n){this._onClick.emit({view:e,field:t,stat:r,target:n})}destroy(){super.destroy()}};kde([Ii()],xde.prototype,"destroy",1),xde=kde([io()],xde);const Ode=[pE.TEXT,pE.SELECT,pE.MULTI_SELECT,pE.NUMBER,pE.DATE,pE.IMAGE,pE.FILE,pE.PHONE,pE.MENTION,pE.LINK,pE.EMAIL,pE.USER_ID,pE.CREATED_AT,pE.MODIFIER_ID,pE.UPDATED_AT],Ide=[pE.DATE,pE.CREATED_AT,pE.UPDATED_AT],Rde={none:{stats:Ph("统计"),text:Ph("不展示")},count:{stats:Ph("$1 条记录"),text:Ph("记录总数")},filled:{stats:Ph("已填写 $1"),text:Ph("已填写数"),types:Ode},empty:{stats:Ph("未填写 $1"),text:Ph("未填写数"),types:Ode},checked:{stats:Ph("已勾选 $1"),text:Ph("已勾选"),types:[pE.CHECKBOX]},unchecked:{stats:Ph("未勾选 $1"),text:Ph("未勾选"),types:[pE.CHECKBOX]},unique:{stats:Ph("唯一数 $1"),text:Ph("唯一数"),types:Ode},percentFilled:{stats:Ph("已填写占比 $1"),text:Ph("已填写占比"),types:Ode},percentEmpty:{stats:Ph("未填写占比 $1"),text:Ph("未填写占比"),types:Ode},percentUnique:{stats:Ph("唯一数占比 $1"),text:Ph("唯一数占比"),types:Ode},sum:{stats:Ph("求和 $1"),text:Ph("求和"),types:[pE.NUMBER]},average:{stats:Ph("平均值 $1"),text:Ph("平均值"),types:[pE.NUMBER]},max:{stats:Ph("最大值 $1"),text:Ph("最大值"),types:[pE.NUMBER]},min:{stats:Ph("最小值 $1"),text:Ph("最小值"),types:[pE.NUMBER]},earliestDate:{stats:Ph("最早时间 $1"),text:Ph("最早时间"),types:Ide},latestDate:{stats:Ph("最晚时间 $1"),text:Ph("最晚时间"),types:Ide},dateRange:{stats:Ph("时间范围 $1 天"),text:Ph("时间范围（日）"),types:Ide},monthRange:{stats:Ph("时间范围 $1 月"),text:Ph("时间范围（月）"),types:Ide},percentChecked:{stats:Ph("已勾选占比 $1"),text:Ph("已勾选占比"),types:[pE.CHECKBOX]},percentUnchecked:{stats:Ph("未勾选占比 $1"),text:Ph("未勾选占比"),types:[pE.CHECKBOX]}},Tde=({viewField:e,recordIds:t})=>{const r=HL(KO),n=HL(xde),i=r.getActiveView(),[o,s]=Object(a.useState)(void 0),[l,c]=Object(a.useState)();return Object(a.useEffect)((()=>{i&&e&&(e=>{window.requestIdleCallback?requestIdleCallback(e):e()})((()=>{const n=r.getStatValue(i.get("uuid"),e.get("field_uuid"),t);s(null==n?void 0:n.stat.toJSON()),c(null==n?void 0:n.value)}))}),[null==i?void 0:i.get("uuid"),null==e?void 0:e.get("field_uuid"),t]),{stat:o,statValue:l,onClick(t){null==n||n.open(i,e.get("field"),o,t.currentTarget)}}},Ade=({viewField:e,recordIds:t})=>{let r;const{stat:n,statValue:i,onClick:o}=Tde({viewField:e,recordIds:t});if(n&&n.type){const{stats:e}=Rde[n.type];let t=i;("earliestDate"===n.type||"latestDate"===n.type&&i)&&(t=bf(n.value).format("YYYY-MM-DD")),r=s.a.createElement("span",{className:"lakex-table-stats-filled"},s.a.createElement("span",{className:"lakex-table-stats-text"},Ph(e,t+"")),s.a.createElement(XU,{type:"ReviewArrowDown",size:14}))}else r=s.a.createElement("span",{className:"lakex-table-stats-unfilled"},s.a.createElement("span",{className:"lakex-table-stats-text"},Rde.none.stats),s.a.createElement(XU,{type:"ReviewArrowDown",size:14}));return s.a.createElement("div",{className:"lakex-table-stats",onClick:o},r)};var Mde=Object.defineProperty,Nde=Object.getOwnPropertyDescriptor;let Dde=class{static pluginModule(){return xo().contribution(Cde).register(xde).register(this)}init(){}getStatisticsComponent(){return Ade}};Dde.pluginName="render-statistics",Dde=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Nde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Mde(t,r,o),o})([io({contrib:[Dz,ore]})],Dde);var Pde=Object.defineProperty,jde=Object.getOwnPropertyDescriptor,Fde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pde(t,r,o),o};let Vde=class{static pluginModule(){return xo().register(this)}init(){}registerHotkey(e){e.registerItem({id:"undo",hotkey:"⌘+Z",name:"撤销",enableOnInput:!1,isEnable:()=>!0,onHotKey:()=>{this._commandService.undo()}}),e.registerItem({id:"redo",hotkey:"⌘+shift+Z",name:"重做",enableOnInput:!1,isEnable:()=>!0,onHotKey:()=>{this._commandService.redo()}})}};Vde.pluginName="render-history",Fde([ao(zI)],Vde.prototype,"_commandService",2),Vde=Fde([io({contrib:[Dz,hz]})],Vde);const Lde=({listeners:e,disable:t=!1})=>t?s.a.createElement(p.a,{title:Ph("取消排序后，可进行拖拽")},s.a.createElement("div",{className:qL("lakex-viewer-grid-row-dragger",{disable:t}),...e,onClick:e=>e.stopPropagation()},s.a.createElement(XU,{type:"Drag"}))):s.a.createElement("div",{className:qL("lakex-viewer-grid-row-dragger"),...e,onClick:e=>e.stopPropagation()},s.a.createElement(XU,{type:"Drag"}));var $de=Object.defineProperty,Bde=Object.getOwnPropertyDescriptor,Ude=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Bde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$de(t,r,o),o};let zde=class{get OrderDragIcon(){return Lde}updateViewOrder(e,t){this._commandService.execCommand("changeViewOrder",{sourceViewId:e,targetViewId:t})}updateRecordOrder(e,t,r,n,i){const o=this._readService.getActiveView();this._commandService.execCommand("changeRecordOrder",{viewId:null==o?void 0:o.get("uuid"),sourceRecordId:e,targetRecordId:t,sourceGroupItem:r,targetGroupItem:n,direction:i})}updateFieldOrder(e,t){const r=this._readService.getActiveView();this._commandService.execCommand("changeFieldOrder",{viewId:null==r?void 0:r.get("uuid"),sourceFieldId:e,targetFieldId:t})}updateFieldOptionOrder(e,t,r){this._commandService.execCommand("changeFieldOptionOrder",{fieldId:e,sourceFieldOptionId:t,targetFieldOptionId:r})}};Ude([ao(zI)],zde.prototype,"_commandService",2),Ude([ao(KO)],zde.prototype,"_readService",2),zde=Ude([io()],zde);const Hde=$i.defineToken("OrderRenderPluginContribution");var Wde=Object.defineProperty,Gde=Object.getOwnPropertyDescriptor;let Kde=class{static pluginModule(){return xo().contribution(Hde).register(this).register(zde)}init(){}};Kde.pluginName="render-order",Kde=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wde(t,r,o),o})([io({contrib:Dz})],Kde);var qde=Object.defineProperty,Yde=Object.getOwnPropertyDescriptor,Jde=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Yde(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&qde(t,r,o),o};let Xde=class{static pluginModule(){return xo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"view",type:"object",title:"视图",properties:{useWindowScroll:{type:"boolean",description:"滚动容器是否为 window"},customScrollParent:{type:"object",description:"自定义滚动容器，useWindowScroll 场景下触发滚动加载，类型为 HTMLElement | undefined"}}}),e.registerDefaultValue({"view.useWindowScroll":!1,"view.customScrollParent":void 0})}init(){this._commandService.onDidExecuteCommand((({context:e})=>{if("switchView"===e.commandName){const t=e.argArray[0].viewId;this._openerService.setHash("view",t)}}))}registerOpenerApp(){return[{name:"view",display_name:"View",description:"视图"}]}registerOpener(){return[{openerName:"view-opener",apps:["view"],open:e=>{this._commandService.execCommand("switchView",{viewId:e},!0)}}]}};Xde.pluginName="render-viewer-manage",Jde([ao(zI)],Xde.prototype,"_commandService",2),Jde([ao(PH)],Xde.prototype,"_openerService",2),Xde=Jde([io({contrib:[Dz,lH]})],Xde);const Zde=()=>{const e=HL(Qz),t=Object(a.useCallback)((t=>{t.preventDefault(),e.emitClickIcon({iconName:"grid-field-config",event:t})}),[e]);return s.a.createElement("div",{className:"lakex-viewer-grid-header-blank",onClick:t},s.a.createElement(XU,{type:"Add"}))};var Qde=Object.defineProperty,efe=Object.getOwnPropertyDescriptor;let tfe=class{static pluginModule(){return xo().register(this)}init(){}getAddFieldComponent(){return Zde}};tfe.pluginName="render-add-field",tfe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?efe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Qde(t,r,o),o})([io({contrib:[Dz,are]})],tfe);const rfe=({inGroup:e=!1,index:t=-1,viewGroupRecord:r,viewRecords:n,viewFields:i})=>{const o=HL(zI),l=HL(KO),c=HL(qte),u=Object(a.useCallback)((()=>{var a,s;if(e){const e=null==(a=n[t])?void 0:a.viewRecord.get("record_uuid");let i="";if(r){const e=null==r?void 0:r.option;e&&(null!=(s=e.value)&&s.toJSON&&(e.value=e.value.toJSON()),i=l.keyValue(e))}o.execCommand("addEmptyRecord",{sourceRecordId:e,groupItemKey:i})}else o.execCommand("addEmptyRecord");if(c){const r=c.createGridSelectionByIndex(e?t+1:n.length,0,n.length+1,i.length);null==c||c.setSelection(r)}}),[]);return s.a.createElement("div",{className:"lakex-viewer-grid-add-record"},s.a.createElement(XU,{type:"Add",onClick:u,size:14}))};var nfe=Object.defineProperty,ife=Object.getOwnPropertyDescriptor;let ofe=class{static pluginModule(){return xo().register(this)}init(){}getAddRecordComponent(){return rfe}};ofe.pluginName="render-add-record",ofe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?ife(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nfe(t,r,o),o})([io({contrib:[Dz,sre]})],ofe);var afe=Object.defineProperty,sfe=Object.getOwnPropertyDescriptor,lfe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?sfe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&afe(t,r,o),o};let cfe=class extends fp{constructor(){super(...arguments),this._onEditGroupName=this._register(new _p),this.onEditGroupName=this._onEditGroupName.event}updateFieldGroupName(e,t){this._commandService.execCommand("changeFieldGroupName",{fieldGroupId:e,name:t})}emitEdit(e){this._onEditGroupName.emit({fieldGroupId:e})}destroy(){super.destroy()}};lfe([ao(zI)],cfe.prototype,"_commandService",2),lfe([Ii()],cfe.prototype,"destroy",1),cfe=lfe([io()],cfe);var ufe=Object.defineProperty,dfe=Object.getOwnPropertyDescriptor;let ffe=class{static pluginModule(){return xo().register(this).register(cfe)}init(){}};ffe.pluginName="render-field-group",ffe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dfe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ufe(t,r,o),o})([io({contrib:Dz})],ffe);const hfe=0,pfe=1,gfe=2,mfe=4;function vfe(e,t){return r=>e(t(r))}function yfe(e,t){return t(e)}function bfe(e,t){return r=>e(t,r)}function _fe(e,t){return()=>e(t)}function wfe(e,t){return t(e),e}function Cfe(...e){return e}function Efe(e){e()}function Sfe(e){return()=>e}function kfe(e){return void 0!==e}function xfe(){}function Ofe(e,t){return e(pfe,t)}function Ife(e,t){e(hfe,t)}function Rfe(e){e(gfe)}function Tfe(e){return e(mfe)}function Afe(e,t){return Ofe(e,bfe(t,hfe))}function Mfe(e,t){const r=e(pfe,(e=>{r(),t(e)}));return r}function Nfe(){const e=[];return(t,r)=>{switch(t){case gfe:return void e.splice(0,e.length);case pfe:return e.push(r),()=>{const t=e.indexOf(r);t>-1&&e.splice(t,1)};case hfe:return void e.slice().forEach((e=>{e(r)}));default:throw new Error(`unrecognized action ${t}`)}}}function Dfe(e){let t=e;const r=Nfe();return(e,n)=>{switch(e){case pfe:n(t);break;case hfe:t=n;break;case mfe:return t}return r(e,n)}}function Pfe(e){return wfe(Nfe(),(t=>Afe(e,t)))}function jfe(e,t){return wfe(Dfe(t),(t=>Afe(e,t)))}function Ffe(e,...t){const r=function(...e){return t=>e.reduceRight(yfe,t)}(...t);return(t,n)=>{switch(t){case pfe:return Ofe(e,r(n));case gfe:return void Rfe(e)}}}function Vfe(e,t){return e===t}function Lfe(e=Vfe){let t;return r=>n=>{e(t,n)||(t=n,r(n))}}function $fe(e){return t=>r=>{e(r)&&t(r)}}function Bfe(e){return t=>vfe(t,e)}function Ufe(e){return t=>()=>t(e)}function zfe(e,t){return r=>n=>r(t=e(t,n))}function Hfe(e){return t=>r=>{e>0?e--:t(r)}}function Wfe(e){let t,r=null;return n=>i=>{r=i,!t&&(t=setTimeout((()=>{t=void 0,n(r)}),e))}}function Gfe(e){let t,r;return n=>i=>{t=i,r&&clearTimeout(r),r=setTimeout((()=>{n(t)}),e)}}function Kfe(...e){const t=new Array(e.length);let r=0,n=null;const i=Math.pow(2,e.length)-1;return e.forEach(((e,o)=>{const a=Math.pow(2,o);Ofe(e,(e=>{const s=r;r|=a,t[o]=e,s!==i&&r===i&&n&&(n(),n=null)}))})),e=>o=>{const a=()=>e([o].concat(t));r===i?a():n=a}}function qfe(...e){return function(t,r){switch(t){case pfe:return function(...e){return()=>{e.map(Efe)}}(...e.map((e=>Ofe(e,r))));case gfe:return;default:throw new Error(`unrecognized action ${t}`)}}}function Yfe(e,t=Vfe){return Ffe(e,Lfe(t))}function Jfe(...e){const t=Nfe(),r=new Array(e.length);let n=0;const i=Math.pow(2,e.length)-1;return e.forEach(((e,o)=>{const a=Math.pow(2,o);Ofe(e,(e=>{r[o]=e,n|=a,n===i&&Ife(t,r)}))})),function(e,o){switch(e){case pfe:return n===i&&o(r),Ofe(t,o);case gfe:return Rfe(t);default:throw new Error(`unrecognized action ${e}`)}}}function Xfe(e,t=[],{singleton:r}={singleton:!0}){return{id:Zfe(),constructor:e,dependencies:t,singleton:r}}const Zfe=()=>Symbol();const Qfe=typeof document<"u"?s.a.useLayoutEffect:s.a.useEffect;function ehe(e,t,r){const n=Object.keys(t.required||{}),i=Object.keys(t.optional||{}),o=Object.keys(t.methods||{}),a=Object.keys(t.events||{}),l=s.a.createContext({});function c(e,r){e.propsReady&&Ife(e.propsReady,!1);for(const i of n){Ife(e[t.required[i]],r[i])}for(const n of i)if(n in r){Ife(e[t.optional[n]],r[n])}e.propsReady&&Ife(e.propsReady,!0)}function u(e){return a.reduce(((r,n)=>(r[n]=function(e){let t,r;const n=()=>t&&t();return function(i,o){switch(i){case pfe:return o?r===o?void 0:(n(),r=o,t=Ofe(e,o),t):(n(),xfe);case gfe:return n(),void(r=null);default:throw new Error(`unrecognized action ${i}`)}}}(e[t.events[n]]),r)),{})}return{Component:s.a.forwardRef(((d,f)=>{const{children:h,...p}=d,[g]=s.a.useState((()=>wfe(function(e){const t=new Map,r=({id:e,constructor:n,dependencies:i,singleton:o})=>{if(o&&t.has(e))return t.get(e);const a=n(i.map((e=>r(e))));return o&&t.set(e,a),a};return r(e)}(e),(e=>c(e,p))))),[m]=s.a.useState(_fe(u,g));return Qfe((()=>{for(const e of a)e in p&&Ofe(m[e],p[e]);return()=>{Object.values(m).map(Rfe)}}),[p,m,g]),Qfe((()=>{c(g,p)})),s.a.useImperativeHandle(f,Sfe(function(e){return o.reduce(((r,n)=>(r[n]=r=>{Ife(e[t.methods[n]],r)},r)),{})}(g))),s.a.createElement(l.Provider,{value:g},r?s.a.createElement(r,function(e,t){const r={},n={};let i=0;const o=e.length;for(;i<o;)n[e[i]]=1,i+=1;for(const e in t)n.hasOwnProperty(e)||(r[e]=t[e]);return r}([...n,...i,...a],p),h):h)})),usePublisher:e=>s.a.useCallback(bfe(Ife,s.a.useContext(l)[e]),[e]),useEmitterValue:e=>{const t=s.a.useContext(l)[e],[r,n]=s.a.useState(_fe(Tfe,t));return Qfe((()=>Ofe(t,(e=>{e!==r&&n(Sfe(e))}))),[t,r]),r},useEmitter:(e,t)=>{const r=s.a.useContext(l)[e];Qfe((()=>Ofe(r,t)),[t,r])}}}const the=typeof document<"u"?s.a.useLayoutEffect:s.a.useEffect;var rhe=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e))(rhe||{});const nhe={0:"debug",1:"log",2:"warn",3:"error"},ihe=Xfe((()=>{const e=Dfe(3);return{log:Dfe(((t,r,n=1)=>{var i;n>=(null!=(i=(typeof globalThis>"u"?window:globalThis).VIRTUOSO_LOG_LEVEL)?i:Tfe(e))&&console[nhe[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,r)})),logLevel:e}}),[],{singleton:!0});function ohe(e,t=!0){const r=s.a.useRef(null);let n=e=>{};if(typeof ResizeObserver<"u"){const i=s.a.useMemo((()=>new ResizeObserver((t=>{const r=t[0].target;null!==r.offsetParent&&e(r)}))),[e]);n=e=>{e&&t?(i.observe(e),r.current=e):(r.current&&i.unobserve(r.current),r.current=null)}}return{ref:r,callbackRef:n}}function ahe(e,t=!0){return ohe(e,t).callbackRef}function she(e,t,r,n,i,o,a){const l=s.a.useCallback((r=>{const s=function(e,t,r,n){const i=e.length;if(0===i)return null;const o=[];for(let a=0;a<i;a++){const i=e.item(a);if(!i||void 0===i.dataset.index)continue;const s=parseInt(i.dataset.index),l=parseFloat(i.dataset.knownSize),c=t(i,r);if(0===c&&n("Zero-sized element, this should not happen",{child:i},rhe.ERROR),c===l)continue;const u=o[o.length-1];0===o.length||u.size!==c||u.endIndex!==s-1?o.push({startIndex:s,endIndex:s,size:c}):o[o.length-1].endIndex++}return o}(r.children,t,"offsetHeight",i);let l=r.parentElement;for(;!l.dataset.virtuosoScroller;)l=l.parentElement;const c="window"===l.lastElementChild.dataset.viewportType,u=a?a.scrollTop:c?window.pageYOffset||document.documentElement.scrollTop:l.scrollTop,d=a?a.scrollHeight:c?document.documentElement.scrollHeight:l.scrollHeight,f=a?a.offsetHeight:c?window.innerHeight:l.offsetHeight;n({scrollTop:Math.max(u,0),scrollHeight:d,viewportHeight:f}),null==o||o(function(e,t,r){return"normal"!==t&&!(null!=t&&t.endsWith("px"))&&r(`${e} was not resolved to pixel value correctly`,t,rhe.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}("row-gap",getComputedStyle(r).rowGap,i)),null!==s&&e(s)}),[e,t,i,o,a,n]);return ohe(l,r)}function lhe(e,t){return Math.round(e.getBoundingClientRect()[t])}function che(e,t){return Math.abs(e-t)<1.01}function uhe(e,t,r,n=xfe,i){const o=s.a.useRef(null),a=s.a.useRef(null),l=s.a.useRef(null),u=s.a.useCallback((r=>{const n=r.target,i=n===window||n===document,o=i?window.pageYOffset||document.documentElement.scrollTop:n.scrollTop,s=i?document.documentElement.scrollHeight:n.scrollHeight,u=i?window.innerHeight:n.offsetHeight,d=()=>{e({scrollTop:Math.max(o,0),scrollHeight:s,viewportHeight:u})};r.suppressFlushSync?d():c.a.flushSync(d),null!==a.current&&(o===a.current||o<=0||o===s-u)&&(a.current=null,t(!0),l.current&&(clearTimeout(l.current),l.current=null))}),[e,t]);return s.a.useEffect((()=>{const e=i||o.current;return n(i||o.current),u({target:e,suppressFlushSync:!0}),e.addEventListener("scroll",u,{passive:!0}),()=>{n(null),e.removeEventListener("scroll",u)}}),[o,u,r,n,i]),{scrollerRef:o,scrollByCallback:function(e){o.current.scrollBy(e)},scrollToCallback:function(r){const n=o.current;if(!n||"offsetHeight"in n&&0===n.offsetHeight)return;const i="smooth"===r.behavior;let s,c,u;n===window?(c=Math.max(lhe(document.documentElement,"height"),document.documentElement.scrollHeight),s=window.innerHeight,u=document.documentElement.scrollTop):(c=n.scrollHeight,s=lhe(n,"height"),u=n.scrollTop);const d=c-s;if(r.top=Math.ceil(Math.max(Math.min(d,r.top),0)),che(s,c)||r.top===u)return e({scrollTop:u,scrollHeight:c,viewportHeight:s}),void(i&&t(!0));i?(a.current=r.top,l.current&&clearTimeout(l.current),l.current=setTimeout((()=>{l.current=null,a.current=null,t(!0)}),1e3)):a.current=null,n.scrollTo(r)}}}const dhe=Xfe((()=>{const e=Nfe(),t=Nfe(),r=Dfe(0),n=Nfe(),i=Dfe(0),o=Nfe(),a=Nfe(),s=Dfe(0),l=Dfe(0),c=Dfe(0),u=Dfe(0),d=Nfe(),f=Nfe(),h=Dfe(!1);return Afe(Ffe(e,Bfe((({scrollTop:e})=>e))),t),Afe(Ffe(e,Bfe((({scrollHeight:e})=>e))),a),Afe(t,i),{scrollContainerState:e,scrollTop:t,viewportHeight:o,headerHeight:s,fixedHeaderHeight:l,fixedFooterHeight:c,footerHeight:u,scrollHeight:a,smoothScrollTargetReached:n,scrollTo:d,scrollBy:f,statefulScrollTop:i,deviation:r,scrollingInProgress:h}}),[],{singleton:!0}),fhe={lvl:0};function hhe(e,t,r,n=fhe,i=fhe){return{k:e,v:t,lvl:r,l:n,r:i}}function phe(e){return e===fhe}function ghe(){return fhe}function mhe(e,t){if(phe(e))return fhe;const{k:r,l:n,r:i}=e;if(t===r){if(phe(n))return i;if(phe(i))return n;{const[t,r]=Che(n);return Ohe(She(e,{k:t,v:r,l:Ehe(n)}))}}return Ohe(She(e,t<r?{l:mhe(n,t)}:{r:mhe(i,t)}))}function vhe(e,t){if(!phe(e))return t===e.k?e.v:t<e.k?vhe(e.l,t):vhe(e.r,t)}function yhe(e,t,r="k"){if(phe(e))return[-1/0,void 0];if(Number(e[r])===t)return[e.k,e.v];if(Number(e[r])<t){const n=yhe(e.r,t,r);return n[0]===-1/0?[e.k,e.v]:n}return yhe(e.l,t,r)}function bhe(e,t,r){return phe(e)?hhe(t,r,1):t===e.k?She(e,{k:t,v:r}):t<e.k?xhe(She(e,{l:bhe(e.l,t,r)})):xhe(She(e,{r:bhe(e.r,t,r)}))}function _he(e,t,r){if(phe(e))return[];const{k:n,v:i,l:o,r:a}=e;let s=[];return n>t&&(s=s.concat(_he(o,t,r))),n>=t&&n<=r&&s.push({k:n,v:i}),n<=r&&(s=s.concat(_he(a,t,r))),s}function whe(e){return phe(e)?[]:[...whe(e.l),{k:e.k,v:e.v},...whe(e.r)]}function Che(e){return phe(e.r)?[e.k,e.v]:Che(e.r)}function Ehe(e){return phe(e.r)?e.l:Ohe(She(e,{r:Ehe(e.r)}))}function She(e,t){return hhe(void 0!==t.k?t.k:e.k,void 0!==t.v?t.v:e.v,void 0!==t.lvl?t.lvl:e.lvl,void 0!==t.l?t.l:e.l,void 0!==t.r?t.r:e.r)}function khe(e){return phe(e)||e.lvl>e.r.lvl}function xhe(e){return The(Ahe(e))}function Ohe(e){const{l:t,r:r,lvl:n}=e;if(r.lvl>=n-1&&t.lvl>=n-1)return e;if(n>r.lvl+1){if(khe(t))return Ahe(She(e,{lvl:n-1}));if(!phe(t)&&!phe(t.r))return She(t.r,{l:She(t,{r:t.r.l}),r:She(e,{l:t.r.r,lvl:n-1}),lvl:n});throw new Error("Unexpected empty nodes")}if(khe(e))return The(She(e,{lvl:n-1}));if(phe(r)||phe(r.l))throw new Error("Unexpected empty nodes");{const t=r.l,i=khe(t)?r.lvl-1:r.lvl;return She(t,{l:She(e,{r:t.l,lvl:n-1}),r:The(She(r,{l:t.r,lvl:i})),lvl:t.lvl+1})}}function Ihe(e,t,r){if(phe(e))return[];return function(e){return Rhe(e,(({k:e,v:t})=>({index:e,value:t})))}(_he(e,yhe(e,t)[0],r))}function Rhe(e,t){const r=e.length;if(0===r)return[];let{index:n,value:i}=t(e[0]);const o=[];for(let a=1;a<r;a++){const{index:r,value:s}=t(e[a]);o.push({start:n,end:r-1,value:i}),n=r,i=s}return o.push({start:n,end:1/0,value:i}),o}function The(e){const{r:t,lvl:r}=e;return phe(t)||phe(t.r)||t.lvl!==r||t.r.lvl!==r?e:She(t,{l:She(e,{r:t.l}),lvl:r+1})}function Ahe(e){const{l:t}=e;return phe(t)||t.lvl!==e.lvl?e:She(t,{r:She(e,{l:t.r})})}function Mhe(e,t,r,n=0){let i=e.length-1;for(;n<=i;){const o=Math.floor((n+i)/2),a=r(e[o],t);if(0===a)return o;if(-1===a){if(i-n<2)return o-1;i=o-1}else{if(i===n)return o;n=o+1}}throw new Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function Nhe(e,t,r){return e[Mhe(e,t,r)]}const Dhe=Xfe((()=>({recalcInProgress:Dfe(!1)})),[],{singleton:!0});function Phe(e){const{size:t,startIndex:r,endIndex:n}=e;return e=>e.start===r&&(e.end===n||e.end===1/0)&&e.value===t}function jhe(e,t){let r=0,n=0;for(;r<e;)r+=t[n+1]-t[n]-1,n++;return n-(r===e?0:1)}function Fhe({index:e},t){return t===e?0:t<e?-1:1}function Vhe({offset:e},t){return t===e?0:t<e?-1:1}function Lhe(e){return{index:e.index,value:e}}function $he(e,t,r,n=0){return n>0&&(t=Math.max(t,Nhe(e,n,Fhe).offset)),Rhe(function(e,t,r,n){const i=Mhe(e,t,n),o=Mhe(e,r,n,i);return e.slice(i,o+1)}(e,t,r,Vhe),Lhe)}function Bhe(e,t,r,n){let i=e,o=0,a=0,s=0,l=0;if(0!==t){l=Mhe(i,t-1,Fhe),s=i[l].offset;const e=yhe(r,t-1);o=e[0],a=e[1],i.length&&i[l].size===yhe(r,t)[1]&&(l-=1),i=i.slice(0,l+1)}else i=[];for(const{start:e,value:l}of Ihe(r,t,1/0)){const t=e-o,r=t*a+s+t*n;i.push({offset:r,size:l,index:e}),o=e,s=r,a=l}return{offsetTree:i,lastIndex:o,lastOffset:s,lastSize:a}}function Uhe(e,[t,r,n,i]){t.length>0&&n("received item sizes",t,rhe.DEBUG);const o=e.sizeTree;let a=o,s=0;if(r.length>0&&phe(o)&&2===t.length){const e=t[0].size,n=t[1].size;a=r.reduce(((t,r)=>bhe(bhe(t,r,e),r+1,n)),a)}else[a,s]=function(e,t){let r=phe(e)?0:1/0;for(const n of t){const{size:t,startIndex:i,endIndex:o}=n;if(r=Math.min(r,i),phe(e)){e=bhe(e,0,t);continue}const a=Ihe(e,i-1,o+1);if(a.some(Phe(n)))continue;let s=!1,l=!1;for(const{start:r,end:n,value:i}of a)s?(o>=r||t===i)&&(e=mhe(e,r)):(l=i!==t,s=!0),n>o&&o>=r&&i!==t&&(e=bhe(e,o+1,i));l&&(e=bhe(e,i,t))}return[e,r]}(a,t);if(a===o)return e;const{offsetTree:l,lastIndex:c,lastSize:u,lastOffset:d}=Bhe(e.offsetTree,s,a,i);return{sizeTree:a,offsetTree:l,lastIndex:c,lastOffset:d,lastSize:u,groupOffsetTree:r.reduce(((e,t)=>bhe(e,t,zhe(t,l,i))),ghe()),groupIndices:r}}function zhe(e,t,r){if(0===t.length)return 0;const{offset:n,index:i,size:o}=Nhe(t,e,Fhe),a=e-i,s=o*a+(a-1)*r+n;return s>0?s+r:s}function Hhe(e,t,r){if(function(e){return typeof e.groupIndex<"u"}(e))return t.groupIndices[e.groupIndex]+1;{let n=Whe("LAST"===e.index?r:e.index,t);return n=Math.max(0,n,Math.min(r,n)),n}}function Whe(e,t){if(!Ghe(t))return e;let r=0;for(;t.groupIndices[r]<=e+r;)r++;return e+r}function Ghe(e){return!phe(e.groupOffsetTree)}const Khe={offsetHeight:"height",offsetWidth:"width"},qhe=Xfe((([{log:e},{recalcInProgress:t}])=>{const r=Nfe(),n=Nfe(),i=jfe(n,0),o=Nfe(),a=Nfe(),s=Dfe(0),l=Dfe([]),c=Dfe(void 0),u=Dfe(void 0),d=Dfe(((e,t)=>lhe(e,Khe[t]))),f=Dfe(void 0),h=Dfe(0),p={offsetTree:[],sizeTree:ghe(),groupOffsetTree:ghe(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]},g=jfe(Ffe(r,Kfe(l,e,h),zfe(Uhe,p),Lfe()),p),m=jfe(Ffe(l,Lfe(),zfe(((e,t)=>({prev:e.current,current:t})),{prev:[],current:[]}),Bfe((({prev:e})=>e))),[]);Afe(Ffe(l,$fe((e=>e.length>0)),Kfe(g,h),Bfe((([e,t,r])=>{const n=e.reduce(((e,n,i)=>bhe(e,n,zhe(n,t.offsetTree,r)||i)),ghe());return{...t,groupIndices:e,groupOffsetTree:n}}))),g),Afe(Ffe(n,Kfe(g),$fe((([e,{lastIndex:t}])=>e<t)),Bfe((([e,{lastIndex:t,lastSize:r}])=>[{startIndex:e,endIndex:t,size:r}]))),r),Afe(c,u);const v=jfe(Ffe(c,Bfe((e=>void 0===e))),!0);Afe(Ffe(u,$fe((e=>void 0!==e&&phe(Tfe(g).sizeTree))),Bfe((e=>[{startIndex:0,endIndex:0,size:e}]))),r);const y=Pfe(Ffe(r,Kfe(g),zfe((({sizes:e},[t,r])=>({changed:r!==e,sizes:r})),{changed:!1,sizes:p}),Bfe((e=>e.changed))));Ofe(Ffe(s,zfe(((e,t)=>({diff:e.prev-t,prev:t})),{diff:0,prev:0}),Bfe((e=>e.diff))),(e=>{const{groupIndices:r}=Tfe(g);if(e>0)Ife(t,!0),Ife(o,e+jhe(e,r));else if(e<0){const t=Tfe(m);t.length>0&&(e-=jhe(-e,t)),Ife(a,e)}})),Ofe(Ffe(s,Kfe(e)),(([e,t])=>{e<0&&t("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:s},rhe.ERROR)}));const b=Pfe(o);Afe(Ffe(o,Kfe(g),Bfe((([e,t])=>{const r=t.groupIndices.length>0,n=[],i=t.lastSize;if(r){const r=vhe(t.sizeTree,0);let o=0,a=0;for(;o<e;){const e=t.groupIndices[a],s=t.groupIndices.length===a+1?1/0:t.groupIndices[a+1]-e-1;n.push({startIndex:e,endIndex:e,size:r}),n.push({startIndex:e+1,endIndex:e+1+s-1,size:i}),a++,o+=s+1}const s=whe(t.sizeTree);return o!==e&&s.shift(),s.reduce(((t,{k:r,v:n})=>{let i=t.ranges;return 0!==t.prevSize&&(i=[...t.ranges,{startIndex:t.prevIndex,endIndex:r+e-1,size:t.prevSize}]),{ranges:i,prevIndex:r+e,prevSize:n}}),{ranges:n,prevIndex:e,prevSize:0}).ranges}return whe(t.sizeTree).reduce(((t,{k:r,v:n})=>({ranges:[...t.ranges,{startIndex:t.prevIndex,endIndex:r+e-1,size:t.prevSize}],prevIndex:r+e,prevSize:n})),{ranges:[],prevIndex:0,prevSize:i}).ranges}))),r);const _=Pfe(Ffe(a,Kfe(g,h),Bfe((([e,{offsetTree:t},r])=>zhe(-e,t,r)))));return Afe(Ffe(a,Kfe(g,h),Bfe((([e,t,r])=>{if(t.groupIndices.length>0){if(phe(t.sizeTree))return t;let n=ghe();const i=Tfe(m);let o=0,a=0,s=0;for(;o<-e;){s=i[a];const e=i[a+1]-s-1;a++,o+=e+1}if(n=whe(t.sizeTree).reduce(((t,{k:r,v:n})=>bhe(t,Math.max(0,r+e),n)),n),o!==-e){n=bhe(n,0,vhe(t.sizeTree,s));n=bhe(n,1,yhe(t.sizeTree,1-e)[1])}return{...t,sizeTree:n,...Bhe(t.offsetTree,0,n,r)}}{const n=whe(t.sizeTree).reduce(((t,{k:r,v:n})=>bhe(t,Math.max(0,r+e),n)),ghe());return{...t,sizeTree:n,...Bhe(t.offsetTree,0,n,r)}}}))),g),{data:f,totalCount:n,sizeRanges:r,groupIndices:l,defaultItemSize:u,fixedItemSize:c,unshiftWith:o,shiftWith:a,shiftWithOffset:_,beforeUnshiftWith:b,firstItemIndex:s,gap:h,sizes:g,listRefresh:y,statefulTotalCount:i,trackItemSizes:v,itemSize:d}}),Cfe(ihe,Dhe),{singleton:!0}),Yhe=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function Jhe(e){const t="number"==typeof e?{index:e}:e;return t.align||(t.align="start"),(!t.behavior||!Yhe)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const Xhe=Xfe((([{sizes:e,totalCount:t,listRefresh:r,gap:n},{scrollingInProgress:i,viewportHeight:o,scrollTo:a,smoothScrollTargetReached:s,headerHeight:l,footerHeight:c,fixedHeaderHeight:u,fixedFooterHeight:d},{log:f}])=>{const h=Nfe(),p=Dfe(0);let g=null,m=null,v=null;function y(){g&&(g(),g=null),v&&(v(),v=null),m&&(clearTimeout(m),m=null),Ife(i,!1)}return Afe(Ffe(h,Kfe(e,o,t,p,l,c,f),Kfe(n,u,d),Bfe((([[e,t,n,o,a,l,c,u],d,f,p])=>{const b=Jhe(e),{align:_,behavior:w,offset:C}=b,E=o-1,S=Hhe(b,t,E);let k=zhe(S,t.offsetTree,d)+l;"end"===_?(k+=f+yhe(t.sizeTree,S)[1]-n+p,S===E&&(k+=c)):"center"===_?k+=(f+yhe(t.sizeTree,S)[1]-n+p)/2:k-=a,C&&(k+=C);const x=t=>{y(),t?(u("retrying to scroll to",{location:e},rhe.DEBUG),Ife(h,e)):u("list did not change, scroll successful",{},rhe.DEBUG)};if(y(),"smooth"===w){let e=!1;v=Ofe(r,(t=>{e=e||t})),g=Mfe(s,(()=>{x(e)}))}else g=Mfe(Ffe(r,function(e){return t=>{const r=setTimeout((()=>{t(!1)}),e);return e=>{e&&(t(!0),clearTimeout(r))}}}(150)),x);return m=setTimeout((()=>{y()}),1200),Ife(i,!0),u("scrolling from index to",{index:S,top:k,behavior:w},rhe.DEBUG),{top:k,behavior:w}}))),a),{scrollToIndex:h,topListHeight:p}}),Cfe(qhe,dhe,ihe),{singleton:!0});const Zhe="up",Qhe="down",epe={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},tpe=Xfe((([{scrollContainerState:e,scrollTop:t,viewportHeight:r,headerHeight:n,footerHeight:i,scrollBy:o}])=>{const a=Dfe(!1),s=Dfe(!0),l=Nfe(),c=Nfe(),u=Dfe(4),d=Dfe(0),f=jfe(Ffe(qfe(Ffe(Yfe(t),Hfe(1),Ufe(!0)),Ffe(Yfe(t),Hfe(1),Ufe(!1),Gfe(100))),Lfe()),!1),h=jfe(Ffe(qfe(Ffe(o,Ufe(!0)),Ffe(o,Ufe(!1),Gfe(200))),Lfe()),!1);Afe(Ffe(Jfe(Yfe(t),Yfe(d)),Bfe((([e,t])=>e<=t)),Lfe()),s),Afe(Ffe(s,Wfe(50)),c);const p=Pfe(Ffe(Jfe(e,Yfe(r),Yfe(n),Yfe(i),Yfe(u)),zfe(((e,[{scrollTop:t,scrollHeight:r},n,i,o,a])=>{const s={viewportHeight:n,scrollTop:t,scrollHeight:r};if(t+n-r>-a){let r,n;return t>e.state.scrollTop?(r="SCROLLED_DOWN",n=e.state.scrollTop-t):(r="SIZE_DECREASED",n=e.state.scrollTop-t||e.scrollTopDelta),{atBottom:!0,state:s,atBottomBecause:r,scrollTopDelta:n}}let l;return l=s.scrollHeight>e.state.scrollHeight?"SIZE_INCREASED":n<e.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":t<e.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:l,state:s}}),epe),Lfe(((e,t)=>e&&e.atBottom===t.atBottom)))),g=jfe(Ffe(e,zfe(((e,{scrollTop:t,scrollHeight:r,viewportHeight:n})=>{if(che(e.scrollHeight,r))return{scrollTop:t,scrollHeight:r,jump:0,changed:!1};{const i=r-(t+n)<1;return e.scrollTop!==t&&i?{scrollHeight:r,scrollTop:t,jump:e.scrollTop-t,changed:!0}:{scrollHeight:r,scrollTop:t,jump:0,changed:!0}}}),{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),$fe((e=>e.changed)),Bfe((e=>e.jump))),0);Afe(Ffe(p,Bfe((e=>e.atBottom))),a),Afe(Ffe(a,Wfe(50)),l);const m=Dfe(Qhe);Afe(Ffe(e,Bfe((({scrollTop:e})=>e)),Lfe(),zfe(((e,t)=>Tfe(h)?{direction:e.direction,prevScrollTop:t}:{direction:t<e.prevScrollTop?Zhe:Qhe,prevScrollTop:t}),{direction:Qhe,prevScrollTop:0}),Bfe((e=>e.direction))),m),Afe(Ffe(e,Wfe(50),Ufe("none")),m);const v=Dfe(0);return Afe(Ffe(f,$fe((e=>!e)),Ufe(0)),v),Afe(Ffe(t,Wfe(100),Kfe(f),$fe((([e,t])=>!!t)),zfe((([e,t],[r])=>[t,r]),[0,0]),Bfe((([e,t])=>t-e))),v),{isScrolling:f,isAtTop:s,isAtBottom:a,atBottomState:p,atTopStateChange:c,atBottomStateChange:l,scrollDirection:m,atBottomThreshold:u,atTopThreshold:d,scrollVelocity:v,lastJumpDueToItemResize:g}}),Cfe(dhe)),rpe=Xfe((([{log:e}])=>{const t=Dfe(!1),r=Pfe(Ffe(t,$fe((e=>e)),Lfe()));return Ofe(t,(t=>{t&&Tfe(e)("props updated",{},rhe.DEBUG)})),{propsReady:t,didMount:r}}),Cfe(ihe),{singleton:!0});function npe(e,t){0==e?t():requestAnimationFrame((()=>npe(e-1,t)))}function ipe(e,t){const r=t-1;return"number"==typeof e?e:"LAST"===e.index?r:e.index}const ope=Xfe((([{sizes:e,listRefresh:t,defaultItemSize:r},{scrollTop:n},{scrollToIndex:i},{didMount:o}])=>{const a=Dfe(!0),s=Dfe(0),l=Dfe(!1);return Afe(Ffe(o,Kfe(s),$fe((([e,t])=>!!t)),Ufe(!1)),a),Ofe(Ffe(Jfe(t,o),Kfe(a,e,r,l),$fe((([[,e],t,{sizeTree:r},n,i])=>e&&(!phe(r)||kfe(n))&&!t&&!i)),Kfe(s)),(([,e])=>{Ife(l,!0),npe(3,(()=>{Mfe(n,(()=>Ife(a,!0))),Ife(i,e)}))})),{scrolledToInitialItem:a,initialTopMostItemIndex:s}}),Cfe(qhe,dhe,Xhe,rpe),{singleton:!0});function ape(e){return!!e&&("smooth"===e?"smooth":"auto")}const spe=Xfe((([{totalCount:e,listRefresh:t},{isAtBottom:r,atBottomState:n},{scrollToIndex:i},{scrolledToInitialItem:o},{propsReady:a,didMount:s},{log:l},{scrollingInProgress:c}])=>{const u=Dfe(!1),d=Nfe();let f=null;function h(e){Ife(i,{index:"LAST",align:"end",behavior:e})}function p(e){const t=Mfe(n,(t=>{e&&!t.atBottom&&"SIZE_INCREASED"===t.notAtBottomBecause&&!f&&(Tfe(l)("scrolling to bottom due to increased size",{},rhe.DEBUG),h("auto"))}));setTimeout(t,100)}return Ofe(Ffe(Jfe(Ffe(Yfe(e),Hfe(1)),s),Kfe(Yfe(u),r,o,c),Bfe((([[e,t],r,n,i,o])=>{let a=t&&i,s="auto";return a&&(s=((e,t)=>"function"==typeof e?ape(e(t)):t&&ape(e))(r,n||o),a=a&&!!s),{totalCount:e,shouldFollow:a,followOutputBehavior:s}})),$fe((({shouldFollow:e})=>e))),(({totalCount:e,followOutputBehavior:r})=>{f&&(f(),f=null),f=Mfe(t,(()=>{Tfe(l)("following output to ",{totalCount:e},rhe.DEBUG),h(r),f=null}))})),Ofe(Ffe(Jfe(Yfe(u),e,a),$fe((([e,,t])=>e&&t)),zfe((({value:e},[,t])=>({refreshed:e===t,value:t})),{refreshed:!1,value:0}),$fe((({refreshed:e})=>e)),Kfe(u,e)),(([,e])=>{p(!1!==e)})),Ofe(d,(()=>{p(!1!==Tfe(u))})),Ofe(Jfe(Yfe(u),n),(([e,t])=>{e&&!t.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===t.notAtBottomBecause&&h("auto")})),{followOutput:u,autoscrollToBottom:d}}),Cfe(qhe,tpe,Xhe,ope,rpe,ihe,dhe));function lpe(e){return e.reduce(((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e)),{totalCount:0,groupIndices:[]})}const cpe=Xfe((([{totalCount:e,groupIndices:t,sizes:r},{scrollTop:n,headerHeight:i}])=>{const o=Nfe(),a=Nfe(),s=Pfe(Ffe(o,Bfe(lpe)));return Afe(Ffe(s,Bfe((e=>e.totalCount))),e),Afe(Ffe(s,Bfe((e=>e.groupIndices))),t),Afe(Ffe(Jfe(n,r,i),$fe((([e,t])=>Ghe(t))),Bfe((([e,t,r])=>yhe(t.groupOffsetTree,Math.max(e-r,0),"v")[0])),Lfe(),Bfe((e=>[e]))),a),{groupCounts:o,topItemsIndexes:a}}),Cfe(qhe,dhe));function upe(e,t){return!(!e||e[0]!==t[0]||e[1]!==t[1])}function dpe(e,t){return!(!e||e.startIndex!==t.startIndex||e.endIndex!==t.endIndex)}const fpe="top",hpe="bottom",ppe="none";function gpe(e,t,r){return"number"==typeof e?r===Zhe&&t===fpe||r===Qhe&&t===hpe?e:0:r===Zhe?t===fpe?e.main:e.reverse:t===hpe?e.main:e.reverse}function mpe(e,t){return"number"==typeof e?e:e[t]||0}const vpe=Xfe((([{scrollTop:e,viewportHeight:t,deviation:r,headerHeight:n,fixedHeaderHeight:i}])=>{const o=Nfe(),a=Dfe(0),s=Dfe(0),l=Dfe(0);return{listBoundary:o,overscan:l,topListHeight:a,increaseViewportBy:s,visibleRange:jfe(Ffe(Jfe(Yfe(e),Yfe(t),Yfe(n),Yfe(o,upe),Yfe(l),Yfe(a),Yfe(i),Yfe(r),Yfe(s)),Bfe((([e,t,r,[n,i],o,a,s,l,c])=>{const u=e-l,d=a+s,f=Math.max(r-u,0);let h=ppe;const p=mpe(c,fpe),g=mpe(c,hpe);return n-=l,i+=r+s,(n+=r+s)>e+d-p&&(h=Zhe),(i-=l)<e-f+t+g&&(h=Qhe),h!==ppe?[Math.max(u-r-gpe(o,fpe,h)-p,0),u-f-s+t+gpe(o,hpe,h)+g]:null})),$fe((e=>null!=e)),Lfe(upe)),[0,0])}}),Cfe(dhe),{singleton:!0});const ype={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function bpe(e,t,r){if(0===e.length)return[];if(!Ghe(t))return e.map((e=>({...e,index:e.index+r,originalIndex:e.index})));const n=e[0].index,i=e[e.length-1].index,o=[],a=Ihe(t.groupOffsetTree,n,i);let s,l=0;for(const n of e){let e;(!s||s.end<n.index)&&(s=a.shift(),l=t.groupIndices.indexOf(s.start)),e=n.index===s.start?{type:"group",index:l}:{index:n.index-(l+1)+r,groupIndex:l},o.push({...e,size:n.size,offset:n.offset,originalIndex:n.index,data:n.data})}return o}function _pe(e,t,r,n,i,o){const{lastSize:a,lastOffset:s,lastIndex:l}=i;let c=0,u=0;if(e.length>0){c=e[0].offset;const t=e[e.length-1];u=t.offset+t.size}const d=r-l,f=c,h=s+d*a+(d-1)*n-u;return{items:bpe(e,i,o),topItems:bpe(t,i,o),topListHeight:t.reduce(((e,t)=>t.size+e),0),offsetTop:c,offsetBottom:h,top:f,bottom:u,totalCount:r,firstItemIndex:o}}function wpe(e,t,r,n,i,o){let a=0;if(r.groupIndices.length>0)for(const t of r.groupIndices){if(t-a>=e)break;a++}const s=e+a,l=ipe(t,s);return _pe(Array.from({length:s}).map(((e,t)=>({index:t+l,size:0,offset:0,data:o[t+l]}))),[],s,i,r,n)}const Cpe=Xfe((([{sizes:e,totalCount:t,data:r,firstItemIndex:n,gap:i},o,{visibleRange:a,listBoundary:s,topListHeight:l},{scrolledToInitialItem:c,initialTopMostItemIndex:u},{topListHeight:d},f,{didMount:h},{recalcInProgress:p}])=>{const g=Dfe([]),m=Dfe(0),v=Nfe();Afe(o.topItemsIndexes,g);const y=jfe(Ffe(Jfe(h,p,Yfe(a,upe),Yfe(t),Yfe(e),Yfe(u),c,Yfe(g),Yfe(n),Yfe(i),r),$fe((([e,t,,r,,,,,,,n])=>{const i=n&&n.length!==r;return e&&!t&&!i})),Bfe((([,,[e,t],r,n,i,o,a,s,l,c])=>{const u=n,{sizeTree:d,offsetTree:f}=u,h=Tfe(m);if(0===r)return{...ype,totalCount:r};if(0===e&&0===t)return 0===h?{...ype,totalCount:r}:wpe(h,i,n,s,l,c||[]);if(phe(d))return h>0?null:_pe(function(e,t,r){if(Ghe(t)){const n=Whe(e,t);return[{index:yhe(t.groupOffsetTree,n)[0],size:0,offset:0},{index:n,size:0,offset:0,data:r&&r[0]}]}return[{index:e,size:0,offset:0,data:r&&r[0]}]}(ipe(i,r),u,c),[],r,l,u,s);const p=[];if(a.length>0){const e=a[0],t=a[a.length-1];let r=0;for(const n of Ihe(d,e,t)){const i=n.value,o=Math.max(n.start,e),a=Math.min(n.end,t);for(let e=o;e<=a;e++)p.push({index:e,size:i,offset:r,data:c&&c[e]}),r+=i}}if(!o)return _pe([],p,r,l,u,s);const g=a.length>0?a[a.length-1]+1:0,v=$he(f,e,t,g);if(0===v.length)return null;const y=r-1;return _pe(wfe([],(r=>{for(const n of v){const i=n.value;let o=i.offset,a=n.start;const s=i.size;if(i.offset<e){a+=Math.floor((e-i.offset+l)/(s+l));const t=a-n.start;o+=t*s+t*l}a<g&&(o+=(g-a)*s,a=g);const u=Math.min(n.end,y);for(let e=a;e<=u&&!(o>=t);e++)r.push({index:e,size:s,offset:o,data:c&&c[e]}),o+=s+l}})),p,r,l,u,s)})),$fe((e=>null!==e)),Lfe()),ype);Afe(Ffe(r,$fe(kfe),Bfe((e=>null==e?void 0:e.length))),t),Afe(Ffe(y,Bfe((e=>e.topListHeight))),d),Afe(d,l),Afe(Ffe(y,Bfe((e=>[e.top,e.bottom]))),s),Afe(Ffe(y,Bfe((e=>e.items))),v);return{listState:y,topItemsIndexes:g,endReached:Pfe(Ffe(y,$fe((({items:e})=>e.length>0)),Kfe(t,r),$fe((([{items:e},t])=>e[e.length-1].originalIndex===t-1)),Bfe((([,e,t])=>[e-1,t])),Lfe(upe),Bfe((([e])=>e)))),startReached:Pfe(Ffe(y,Wfe(200),$fe((({items:e,topItems:t})=>e.length>0&&e[0].originalIndex===t.length)),Bfe((({items:e})=>e[0].index)),Lfe())),rangeChanged:Pfe(Ffe(y,$fe((({items:e})=>e.length>0)),Bfe((({items:e})=>{let t=0,r=e.length-1;for(;"group"===e[t].type&&t<r;)t++;for(;"group"===e[r].type&&r>t;)r--;return{startIndex:e[t].index,endIndex:e[r].index}})),Lfe(dpe))),itemsRendered:v,initialItemCount:m,...f}}),Cfe(qhe,cpe,vpe,ope,Xhe,tpe,rpe,Dhe),{singleton:!0}),Epe=Xfe((([{sizes:e,firstItemIndex:t,data:r,gap:n},{initialTopMostItemIndex:i},{initialItemCount:o,listState:a},{didMount:s}])=>(Afe(Ffe(s,Kfe(o),$fe((([,e])=>0!==e)),Kfe(i,e,t,n,r),Bfe((([[,e],t,r,n,i,o=[]])=>wpe(e,t,r,n,i,o)))),a),{})),Cfe(qhe,ope,Cpe,rpe),{singleton:!0}),Spe=Xfe((([{scrollVelocity:e}])=>{const t=Dfe(!1),r=Nfe(),n=Dfe(!1);return Afe(Ffe(e,Kfe(n,t,r),$fe((([e,t])=>!!t)),Bfe((([e,t,r,n])=>{const{exit:i,enter:o}=t;if(r){if(i(e,n))return!1}else if(o(e,n))return!0;return r})),Lfe()),t),Ofe(Ffe(Jfe(t,e,r),Kfe(n)),(([[e,t,r],n])=>e&&n&&n.change&&n.change(t,r))),{isSeeking:t,scrollSeekConfiguration:n,scrollVelocity:e,scrollSeekRangeChanged:r}}),Cfe(tpe),{singleton:!0}),kpe=Xfe((([{topItemsIndexes:e}])=>{const t=Dfe(0);return Afe(Ffe(t,$fe((e=>e>0)),Bfe((e=>Array.from({length:e}).map(((e,t)=>t))))),e),{topItemCount:t}}),Cfe(Cpe)),xpe=Xfe((([{footerHeight:e,headerHeight:t,fixedHeaderHeight:r,fixedFooterHeight:n},{listState:i}])=>{const o=Nfe(),a=jfe(Ffe(Jfe(e,n,t,r,i),Bfe((([e,t,r,n,i])=>e+t+r+n+i.offsetBottom+i.bottom))),0);return Afe(Yfe(a),o),{totalListHeight:a,totalListHeightChanged:o}}),Cfe(dhe,Cpe),{singleton:!0});function Ope(e){let t,r=!1;return()=>(r||(r=!0,t=e()),t)}const Ipe=Ope((()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent))),Rpe=Xfe((([{scrollBy:e,scrollTop:t,deviation:r,scrollingInProgress:n},{isScrolling:i,isAtBottom:o,scrollDirection:a,lastJumpDueToItemResize:s},{listState:l},{beforeUnshiftWith:c,shiftWithOffset:u,sizes:d,gap:f},{log:h},{recalcInProgress:p}])=>{const g=Pfe(Ffe(l,Kfe(s),zfe((([,e,t,r],[{items:n,totalCount:i,bottom:o,offsetBottom:a},s])=>{const l=o+a;let c=0;return t===i&&e.length>0&&n.length>0&&(0===n[0].originalIndex&&0===e[0].originalIndex||(c=l-r,0!==c&&(c+=s))),[c,n,i,l]}),[0,[],0,0]),$fe((([e])=>0!==e)),Kfe(t,a,n,o,h,p),$fe((([,e,t,r,,,n])=>!n&&!r&&0!==e&&t===Zhe)),Bfe((([[e],,,,,t])=>(t("Upward scrolling compensation",{amount:e},rhe.DEBUG),e)))));function m(t){t>0?(Ife(e,{top:-t,behavior:"auto"}),Ife(r,0)):(Ife(r,0),Ife(e,{top:-t,behavior:"auto"}))}return Ofe(Ffe(g,Kfe(r,i)),(([e,t,n])=>{n&&Ipe()?Ife(r,t-e):m(-e)})),Ofe(Ffe(Jfe(jfe(i,!1),r,p),$fe((([e,t,r])=>!e&&!r&&0!==t)),Bfe((([e,t])=>t)),Wfe(1)),m),Afe(Ffe(u,Bfe((e=>({top:-e})))),e),Ofe(Ffe(c,Kfe(d,f),Bfe((([e,{lastSize:t,groupIndices:r,sizeTree:n},i])=>{function o(e){return e*(t+i)}if(0===r.length)return o(e);{let t=0;const i=vhe(n,0);let a=0,s=0;for(;a<e;){a++,t+=i;let n=r.length===s+1?1/0:r[s+1]-r[s]-1;a+n>e&&(t-=i,n=e-a+1),a+=n,t+=o(n),s++}return t}}))),(t=>{Ife(r,t),requestAnimationFrame((()=>{Ife(e,{top:t}),requestAnimationFrame((()=>{Ife(r,0),Ife(p,!1)}))}))})),{deviation:r}}),Cfe(dhe,tpe,Cpe,qhe,ihe,Dhe)),Tpe=Xfe((([{didMount:e},{scrollTo:t},{listState:r}])=>{const n=Dfe(0);return Ofe(Ffe(e,Kfe(n),$fe((([,e])=>0!==e)),Bfe((([,e])=>({top:e})))),(e=>{Mfe(Ffe(r,Hfe(1),$fe((e=>e.items.length>1))),(()=>{requestAnimationFrame((()=>{Ife(t,e)}))}))})),{initialScrollTop:n}}),Cfe(rpe,dhe,Cpe),{singleton:!0}),Ape=Xfe((([{viewportHeight:e},{totalListHeight:t}])=>{const r=Dfe(!1),n=jfe(Ffe(Jfe(r,e,t),$fe((([e])=>e)),Bfe((([,e,t])=>Math.max(0,e-t))),Wfe(0),Lfe()),0);return{alignToBottom:r,paddingTopAddition:n}}),Cfe(dhe,xpe),{singleton:!0}),Mpe=Xfe((([{scrollTo:e,scrollContainerState:t}])=>{const r=Nfe(),n=Nfe(),i=Nfe(),o=Dfe(!1),a=Dfe(void 0);return Afe(Ffe(Jfe(r,n),Bfe((([{viewportHeight:e,scrollTop:t,scrollHeight:r},{offsetTop:n}])=>({scrollTop:Math.max(0,t-n),scrollHeight:r,viewportHeight:e})))),t),Afe(Ffe(e,Kfe(n),Bfe((([e,{offsetTop:t}])=>({...e,top:e.top+t})))),i),{useWindowScroll:o,customScrollParent:a,windowScrollContainerState:r,windowViewportRect:n,windowScrollTo:i}}),Cfe(dhe)),Npe=({itemTop:e,itemBottom:t,viewportTop:r,viewportBottom:n,locationParams:{behavior:i,align:o,...a}})=>e<r?{...a,behavior:i,align:null!=o?o:"start"}:t>n?{...a,behavior:i,align:null!=o?o:"end"}:null,Dpe=Xfe((([{sizes:e,totalCount:t,gap:r},{scrollTop:n,viewportHeight:i,headerHeight:o,fixedHeaderHeight:a,fixedFooterHeight:s,scrollingInProgress:l},{scrollToIndex:c}])=>{const u=Nfe();return Afe(Ffe(u,Kfe(e,i,t,o,a,s,n),Kfe(r),Bfe((([[e,t,r,n,i,o,a,s],c])=>{const{done:u,behavior:d,align:f,calculateViewLocation:h=Npe,...p}=e,g=Hhe(e,t,n-1),m=zhe(g,t.offsetTree,c)+i+o,v=h({itemTop:m,itemBottom:m+yhe(t.sizeTree,g)[1],viewportTop:s+o,viewportBottom:s+r-a,locationParams:{behavior:d,align:f,...p}});return v?u&&Mfe(Ffe(l,$fe((e=>!1===e)),Hfe(Tfe(l)?1:2)),u):u&&u(),v})),$fe((e=>null!==e))),c),{scrollIntoView:u}}),Cfe(qhe,dhe,Xhe,Cpe,ihe),{singleton:!0}),Ppe=Xfe((([{sizes:e,sizeRanges:t},{scrollTop:r},{initialTopMostItemIndex:n},{didMount:i},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:s}])=>{const l=Nfe(),c=Dfe(void 0),u=Dfe(null),d=Dfe(null);return Afe(a,u),Afe(s,d),Ofe(Ffe(l,Kfe(e,r,o,u,d)),(([e,t,r,n,i,o])=>{const a=function(e){return whe(e).map((({k:e,v:t},r,n)=>{const i=n[r+1];return{startIndex:e,endIndex:i?i.k-1:1/0,size:t}}))}(t.sizeTree);n&&null!==i&&null!==o&&(r=i.scrollTop-o.offsetTop),e({ranges:a,scrollTop:r})})),Afe(Ffe(c,$fe(kfe),Bfe(jpe)),n),Afe(Ffe(i,Kfe(c),$fe((([,e])=>void 0!==e)),Lfe(),Bfe((([,e])=>e.ranges))),t),{getState:l,restoreStateFrom:c}}),Cfe(qhe,dhe,ope,rpe,Mpe));function jpe(e){return{offset:e.scrollTop,index:0,align:"start"}}const Fpe=Xfe((([e,t,r,n,i,o,a,s,l,c])=>({...e,...t,...r,...n,...i,...o,...a,...s,...l,...c})),Cfe(vpe,Epe,rpe,Spe,xpe,Tpe,Ape,Mpe,Dpe,ihe)),Vpe=Xfe((([{totalCount:e,sizeRanges:t,fixedItemSize:r,defaultItemSize:n,trackItemSizes:i,itemSize:o,data:a,firstItemIndex:s,groupIndices:l,statefulTotalCount:c,gap:u,sizes:d},{initialTopMostItemIndex:f,scrolledToInitialItem:h},p,g,m,{listState:v,topItemsIndexes:y,...b},{scrollToIndex:_},w,{topItemCount:C},{groupCounts:E},S])=>(Afe(b.rangeChanged,S.scrollSeekRangeChanged),Afe(Ffe(S.windowViewportRect,Bfe((e=>e.visibleHeight))),p.viewportHeight),{totalCount:e,data:a,firstItemIndex:s,sizeRanges:t,initialTopMostItemIndex:f,scrolledToInitialItem:h,topItemsIndexes:y,topItemCount:C,groupCounts:E,fixedItemHeight:r,defaultItemHeight:n,gap:u,...m,statefulTotalCount:c,listState:v,scrollToIndex:_,trackItemSizes:i,itemSize:o,groupIndices:l,...b,...S,...p,sizes:d,...g})),Cfe(qhe,ope,dhe,Ppe,spe,Cpe,Xhe,Rpe,kpe,cpe,Fpe)),Lpe="-webkit-sticky",$pe="sticky",Bpe=Ope((()=>{if(typeof document>"u")return $pe;const e=document.createElement("div");return e.style.position=Lpe,e.style.position===Lpe?Lpe:$pe}));function Upe(e,t){const r=s.a.useRef(null),n=s.a.useCallback((n=>{if(null===n||!n.offsetParent)return;const i=n.getBoundingClientRect(),o=i.width;let a,s;if(t){const e=t.getBoundingClientRect(),r=i.top-e.top;a=e.height-Math.max(0,r),s=r+t.scrollTop}else a=window.innerHeight-Math.max(0,i.top),s=i.top+window.pageYOffset;r.current={offsetTop:s,visibleHeight:a,visibleWidth:o},e(r.current)}),[e,t]),{callbackRef:i,ref:o}=ohe(n),a=s.a.useCallback((()=>{n(o.current)}),[n,o]);return s.a.useEffect((()=>{if(t){t.addEventListener("scroll",a);const e=new ResizeObserver(a);return e.observe(t),()=>{t.removeEventListener("scroll",a),e.unobserve(t)}}return window.addEventListener("scroll",a),window.addEventListener("resize",a),()=>{window.removeEventListener("scroll",a),window.removeEventListener("resize",a)}}),[a,t]),i}const zpe=s.a.createContext(void 0),Hpe=s.a.createContext(void 0);function Wpe(e){return e}const Gpe=Xfe((()=>{const e=Dfe((e=>`Item ${e}`)),t=Dfe(null),r=Dfe((e=>`Group ${e}`)),n=Dfe({}),i=Dfe(Wpe),o=Dfe("div"),a=Dfe(xfe),s=(e,t=null)=>jfe(Ffe(n,Bfe((t=>t[e])),Lfe()),t);return{context:t,itemContent:e,groupContent:r,components:n,computeItemKey:i,headerFooterTag:o,scrollerRef:a,FooterComponent:s("Footer"),HeaderComponent:s("Header"),TopItemListComponent:s("TopItemList"),ListComponent:s("List","div"),ItemComponent:s("Item","div"),GroupComponent:s("Group","div"),ScrollerComponent:s("Scroller","div"),EmptyPlaceholder:s("EmptyPlaceholder"),ScrollSeekPlaceholder:s("ScrollSeekPlaceholder")}})),Kpe=Xfe((([e,t])=>({...e,...t})),Cfe(Vpe,Gpe)),qpe=({height:e})=>s.a.createElement("div",{style:{height:e}}),Ype={position:Bpe(),zIndex:1,overflowAnchor:"none"},Jpe={overflowAnchor:"none"},Xpe=s.a.memo((function({showTopList:e=!1}){const t=hge("listState"),r=fge("sizeRanges"),n=hge("useWindowScroll"),i=hge("customScrollParent"),o=fge("windowScrollContainerState"),a=fge("scrollContainerState"),l=i||n?o:a,c=hge("itemContent"),u=hge("context"),d=hge("groupContent"),f=hge("trackItemSizes"),h=hge("itemSize"),p=hge("log"),g=fge("gap"),{callbackRef:m}=she(r,h,f,e?xfe:l,p,g,i),[v,y]=s.a.useState(0);pge("deviation",(e=>{v!==e&&y(e)}));const b=hge("EmptyPlaceholder"),_=hge("ScrollSeekPlaceholder")||qpe,w=hge("ListComponent"),C=hge("ItemComponent"),E=hge("GroupComponent"),S=hge("computeItemKey"),k=hge("isSeeking"),x=hge("groupIndices").length>0,O=hge("paddingTopAddition"),I=hge("scrolledToInitialItem"),R=e?{}:{boxSizing:"border-box",paddingTop:t.offsetTop+O,paddingBottom:t.offsetBottom,marginTop:v,...I?{}:{visibility:"hidden"}};return!e&&0===t.totalCount&&b?s.a.createElement(b,tge(b,u)):s.a.createElement(w,{...tge(w,u),ref:m,style:R,"data-test-id":e?"virtuoso-top-item-list":"virtuoso-item-list"},(e?t.topItems:t.items).map((e=>{const r=e.originalIndex,n=S(r+t.firstItemIndex,e.data,u);return k?s.a.createElement(_,{...tge(_,u),key:n,index:e.index,height:e.size,type:e.type||"item",..."group"===e.type?{}:{groupIndex:e.groupIndex}}):"group"===e.type?s.a.createElement(E,{...tge(E,u),key:n,"data-index":r,"data-known-size":e.size,"data-item-index":e.index,style:Ype},d(e.index,u)):s.a.createElement(C,{...tge(C,u),...rge(C,e.data),key:n,"data-index":r,"data-known-size":e.size,"data-item-index":e.index,"data-item-group-index":e.groupIndex,style:Jpe},x?c(e.index,e.groupIndex,e.data,u):c(e.index,e.data,u))})))})),Zpe={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},Qpe={width:"100%",height:"100%",position:"absolute",top:0},ege={width:"100%",position:Bpe(),top:0,zIndex:1};function tge(e,t){if("string"!=typeof e)return{context:t}}function rge(e,t){return{item:"string"==typeof e?void 0:t}}const nge=s.a.memo((function(){const e=hge("HeaderComponent"),t=fge("headerHeight"),r=hge("headerFooterTag"),n=ahe((e=>t(lhe(e,"height")))),i=hge("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,tge(e,i))):null})),ige=s.a.memo((function(){const e=hge("FooterComponent"),t=fge("footerHeight"),r=hge("headerFooterTag"),n=ahe((e=>t(lhe(e,"height")))),i=hge("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,tge(e,i))):null}));function oge({usePublisher:e,useEmitter:t,useEmitterValue:r}){return s.a.memo((function({style:n,children:i,...o}){const a=e("scrollContainerState"),l=r("ScrollerComponent"),c=e("smoothScrollTargetReached"),u=r("scrollerRef"),d=r("context"),{scrollerRef:f,scrollByCallback:h,scrollToCallback:p}=uhe(a,c,l,u);return t("scrollTo",p),t("scrollBy",h),s.a.createElement(l,{ref:f,style:{...Zpe,...n},"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...o,...tge(l,d)},i)}))}function age({usePublisher:e,useEmitter:t,useEmitterValue:r}){return s.a.memo((function({style:n,children:i,...o}){const a=e("windowScrollContainerState"),l=r("ScrollerComponent"),c=e("smoothScrollTargetReached"),u=r("totalListHeight"),d=r("deviation"),f=r("customScrollParent"),h=r("context"),{scrollerRef:p,scrollByCallback:g,scrollToCallback:m}=uhe(a,c,l,xfe,f);return the((()=>(p.current=f||window,()=>{p.current=null})),[p,f]),t("windowScrollTo",m),t("scrollBy",g),s.a.createElement(l,{style:{position:"relative",...n,...0!==u?{height:u+d}:{}},"data-virtuoso-scroller":!0,...o,...tge(l,h)},i)}))}const sge=({children:e})=>{const t=s.a.useContext(zpe),r=fge("viewportHeight"),n=fge("fixedItemHeight"),i=ahe(vfe(r,(e=>lhe(e,"height"))));return s.a.useEffect((()=>{t&&(r(t.viewportHeight),n(t.itemHeight))}),[t,r,n]),s.a.createElement("div",{style:Qpe,ref:i,"data-viewport-type":"element"},e)},lge=({children:e})=>{const t=s.a.useContext(zpe),r=fge("windowViewportRect"),n=fge("fixedItemHeight"),i=hge("customScrollParent"),o=Upe(r,i);return s.a.useEffect((()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))}),[t,r,n]),s.a.createElement("div",{ref:o,style:Qpe,"data-viewport-type":"window"},e)},cge=({children:e})=>{const t=hge("TopItemListComponent"),r=hge("headerHeight"),n={...ege,marginTop:`${r}px`},i=hge("context");return s.a.createElement(t||"div",{style:n,context:i},e)},uge=s.a.memo((function(e){const t=hge("useWindowScroll"),r=hge("topItemsIndexes").length>0,n=hge("customScrollParent"),i=n||t?mge:gge,o=n||t?lge:sge;return s.a.createElement(i,{...e},r&&s.a.createElement(cge,null,s.a.createElement(Xpe,{showTopList:!0})),s.a.createElement(o,null,s.a.createElement(nge,null),s.a.createElement(Xpe,null),s.a.createElement(ige,null)))})),{Component:dge,usePublisher:fge,useEmitterValue:hge,useEmitter:pge}=ehe(Kpe,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},uge),gge=oge({usePublisher:fge,useEmitterValue:hge,useEmitter:pge}),mge=age({usePublisher:fge,useEmitterValue:hge,useEmitter:pge}),vge=dge,yge={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},bge={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:_ge,ceil:wge,floor:Cge,min:Ege,max:Sge}=Math;function kge(e,t,r){return Array.from({length:t-e+1}).map(((t,n)=>{const i=null===r?null:r[n+e];return{index:n+e,data:i}}))}function xge(e,t){return e&&e.column===t.column&&e.row===t.row}function Oge(e,t){return e&&e.width===t.width&&e.height===t.height}const Ige=Xfe((([{overscan:e,visibleRange:t,listBoundary:r},{scrollTop:n,viewportHeight:i,scrollBy:o,scrollTo:a,smoothScrollTargetReached:s,scrollContainerState:l,footerHeight:c,headerHeight:u},d,f,{propsReady:h,didMount:p},{windowViewportRect:g,useWindowScroll:m,customScrollParent:v,windowScrollContainerState:y,windowScrollTo:b},_])=>{const w=Dfe(0),C=Dfe(0),E=Dfe(yge),S=Dfe({height:0,width:0}),k=Dfe({height:0,width:0}),x=Nfe(),O=Nfe(),I=Dfe(0),R=Dfe(null),T=Dfe({row:0,column:0}),A=Nfe(),M=Nfe(),N=Dfe(!1),D=Dfe(0),P=Dfe(!0),j=Dfe(!1);Ofe(Ffe(p,Kfe(D),$fe((([e,t])=>!!t))),(()=>{Ife(P,!1),Ife(C,0)})),Ofe(Ffe(Jfe(p,P,k,S,D,j),$fe((([e,t,r,n,,i])=>e&&!t&&0!==r.height&&0!==n.height&&!i))),(([,,,,e])=>{Ife(j,!0),npe(1,(()=>{Ife(x,e)})),Mfe(Ffe(n),(()=>{Ife(r,[0,0]),Ife(P,!0)}))})),Afe(Ffe(M,$fe((e=>null!=e&&e.scrollTop>0)),Ufe(0)),C),Ofe(Ffe(p,Kfe(M),$fe((([,e])=>null!=e))),(([,e])=>{!e||(Ife(S,e.viewport),Ife(k,null==e?void 0:e.item),Ife(T,e.gap),e.scrollTop>0&&(Ife(N,!0),Mfe(Ffe(n,Hfe(1)),(e=>{Ife(N,!1)})),Ife(a,{top:e.scrollTop})))})),Afe(Ffe(S,Bfe((({height:e})=>e))),i),Afe(Ffe(Jfe(Yfe(S,Oge),Yfe(k,Oge),Yfe(T,((e,t)=>e&&e.column===t.column&&e.row===t.row)),Yfe(n)),Bfe((([e,t,r,n])=>({viewport:e,item:t,gap:r,scrollTop:n})))),A),Afe(Ffe(Jfe(Yfe(w),t,Yfe(T,xge),Yfe(k,Oge),Yfe(S,Oge),Yfe(R),Yfe(C),Yfe(N),Yfe(P),Yfe(D)),$fe((([,,,,,,,e])=>!e)),Bfe((([e,[t,r],n,i,o,a,s,,l,c])=>{const{row:u,column:d}=n,{height:f,width:h}=i,{width:p}=o;if(0===s&&(0===e||0===p))return yge;if(0===h){const t=ipe(c,e);return function(e){return{...bge,items:e}}(kge(t,0===t?Math.max(s-1,0):t,a))}const g=Age(p,h,d);let m,v;l?0===t&&0===r&&s>0?(m=0,v=s-1):(m=g*Cge((t+u)/(f+u)),v=g*wge((r+u)/(f+u))-1,v=Ege(e-1,Sge(v,g-1)),m=Ege(v,Sge(0,m))):(m=0,v=-1);const y=kge(m,v,a),{top:b,bottom:_}=Rge(o,n,i,y),w=wge(e/g);return{items:y,offsetTop:b,offsetBottom:w*f+(w-1)*u-_,top:b,bottom:_,itemHeight:f,itemWidth:h}}))),E),Afe(Ffe(R,$fe((e=>null!==e)),Bfe((e=>e.length))),w),Afe(Ffe(Jfe(S,k,E,T),$fe((([e,t,{items:r}])=>r.length>0&&0!==t.height&&0!==e.height)),Bfe((([e,t,{items:r},n])=>{const{top:i,bottom:o}=Rge(e,n,t,r);return[i,o]})),Lfe(upe)),r);const F=Dfe(!1);Afe(Ffe(n,Kfe(F),Bfe((([e,t])=>t||0!==e))),F);const V=Pfe(Ffe(Yfe(E),$fe((({items:e})=>e.length>0)),Kfe(w,F),$fe((([{items:e},t,r])=>r&&e[e.length-1].index===t-1)),Bfe((([,e])=>e-1)),Lfe())),L=Pfe(Ffe(Yfe(E),$fe((({items:e})=>e.length>0&&0===e[0].index)),Ufe(0),Lfe())),$=Pfe(Ffe(Yfe(E),Kfe(N),$fe((([{items:e},t])=>e.length>0&&!t)),Bfe((([{items:e}])=>({startIndex:e[0].index,endIndex:e[e.length-1].index}))),Lfe(dpe),Wfe(0)));Afe($,f.scrollSeekRangeChanged),Afe(Ffe(x,Kfe(S,k,w,T),Bfe((([e,t,r,n,i])=>{const o=Jhe(e),{align:a,behavior:s,offset:l}=o;let c=o.index;"LAST"===c&&(c=n-1),c=Sge(0,c,Ege(n-1,c));let u=Tge(t,i,r,c);return"end"===a?u=_ge(u-t.height+r.height):"center"===a&&(u=_ge(u-t.height/2+r.height/2)),l&&(u+=l),{top:u,behavior:s}}))),a);const B=jfe(Ffe(E,Bfe((e=>e.offsetBottom+e.bottom))),0);return Afe(Ffe(g,Bfe((e=>({width:e.visibleWidth,height:e.visibleHeight})))),S),{data:R,totalCount:w,viewportDimensions:S,itemDimensions:k,scrollTop:n,scrollHeight:O,overscan:e,scrollBy:o,scrollTo:a,scrollToIndex:x,smoothScrollTargetReached:s,windowViewportRect:g,windowScrollTo:b,useWindowScroll:m,customScrollParent:v,windowScrollContainerState:y,deviation:I,scrollContainerState:l,footerHeight:c,headerHeight:u,initialItemCount:C,gap:T,restoreStateFrom:M,...f,initialTopMostItemIndex:D,gridState:E,totalListHeight:B,...d,startReached:L,endReached:V,rangeChanged:$,stateChanged:A,propsReady:h,stateRestoreInProgress:N,..._}}),Cfe(vpe,dhe,tpe,Spe,rpe,Mpe,ihe));function Rge(e,t,r,n){const{height:i}=r;if(void 0===i||0===n.length)return{top:0,bottom:0};return{top:Tge(e,t,r,n[0].index),bottom:Tge(e,t,r,n[n.length-1].index)+i}}function Tge(e,t,r,n){const i=Age(e.width,r.width,t.column),o=Cge(n/i),a=o*r.height+Sge(0,o-1)*t.row;return a>0?a+t.row:a}function Age(e,t,r){return Sge(1,Cge((e+r)/(Cge(t)+r)))}const Mge=Xfe((()=>{const e=Dfe((e=>`Item ${e}`)),t=Dfe({}),r=Dfe(null),n=Dfe("virtuoso-grid-item"),i=Dfe("virtuoso-grid-list"),o=Dfe(Wpe),a=Dfe("div"),s=Dfe(xfe),l=(e,r=null)=>jfe(Ffe(t,Bfe((t=>t[e])),Lfe()),r);return{context:r,itemContent:e,components:t,computeItemKey:o,itemClassName:n,listClassName:i,headerFooterTag:a,scrollerRef:s,FooterComponent:l("Footer"),HeaderComponent:l("Header"),ListComponent:l("List","div"),ItemComponent:l("Item","div"),ScrollerComponent:l("Scroller","div"),ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}})),Nge=Xfe((([e,t])=>({...e,...t})),Cfe(Ige,Mge)),Dge=s.a.memo((function(){const e=Uge("gridState"),t=Uge("listClassName"),r=Uge("itemClassName"),n=Uge("itemContent"),i=Uge("computeItemKey"),o=Uge("isSeeking"),a=Bge("scrollHeight"),l=Uge("ItemComponent"),c=Uge("ListComponent"),u=Uge("ScrollSeekPlaceholder"),d=Uge("context"),f=Bge("itemDimensions"),h=Bge("gap"),p=Uge("log"),g=Uge("stateRestoreInProgress"),m=ahe((e=>{const t=e.parentElement.parentElement.scrollHeight;a(t);const r=e.firstChild;if(r){const{width:e,height:t}=r.getBoundingClientRect();f({width:e,height:t})}h({row:Gge("row-gap",getComputedStyle(e).rowGap,p),column:Gge("column-gap",getComputedStyle(e).columnGap,p)})}));return g?null:s.a.createElement(c,{ref:m,className:t,...tge(c,d),style:{paddingTop:e.offsetTop,paddingBottom:e.offsetBottom},"data-test-id":"virtuoso-item-list"},e.items.map((t=>{const a=i(t.index,t.data,d);return o?s.a.createElement(u,{key:a,...tge(u,d),index:t.index,height:e.itemHeight,width:e.itemWidth}):s.a.createElement(l,{...tge(l,d),className:r,"data-index":t.index,key:a},n(t.index,t.data,d))})))})),Pge=s.a.memo((function(){const e=Uge("HeaderComponent"),t=Bge("headerHeight"),r=Uge("headerFooterTag"),n=ahe((e=>t(lhe(e,"height")))),i=Uge("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,tge(e,i))):null})),jge=s.a.memo((function(){const e=Uge("FooterComponent"),t=Bge("footerHeight"),r=Uge("headerFooterTag"),n=ahe((e=>t(lhe(e,"height")))),i=Uge("context");return e?s.a.createElement(r,{ref:n},s.a.createElement(e,tge(e,i))):null})),Fge=({children:e})=>{const t=s.a.useContext(Hpe),r=Bge("itemDimensions"),n=Bge("viewportDimensions"),i=ahe((e=>{n(e.getBoundingClientRect())}));return s.a.useEffect((()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),r({height:t.itemHeight,width:t.itemWidth}))}),[t,n,r]),s.a.createElement("div",{style:Qpe,ref:i},e)},Vge=({children:e})=>{const t=s.a.useContext(Hpe),r=Bge("windowViewportRect"),n=Bge("itemDimensions"),i=Uge("customScrollParent"),o=Upe(r,i);return s.a.useEffect((()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))}),[t,r,n]),s.a.createElement("div",{ref:o,style:Qpe},e)},Lge=s.a.memo((function({...e}){const t=Uge("useWindowScroll"),r=Uge("customScrollParent"),n=r||t?Wge:Hge,i=r||t?Vge:Fge;return s.a.createElement(n,{...e},s.a.createElement(i,null,s.a.createElement(Pge,null),s.a.createElement(Dge,null),s.a.createElement(jge,null)))})),{Component:$ge,usePublisher:Bge,useEmitterValue:Uge,useEmitter:zge}=ehe(Nge,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged"}},Lge),Hge=oge({usePublisher:Bge,useEmitterValue:Uge,useEmitter:zge}),Wge=age({usePublisher:Bge,useEmitterValue:Uge,useEmitter:zge});function Gge(e,t,r){return"normal"!==t&&!(null!=t&&t.endsWith("px"))&&r(`${e} was not resolved to pixel value correctly`,t,rhe.WARN),"normal"===t?0:parseInt(null!=t?t:"0",10)}const Kge=$ge,qge=Xfe((()=>{const e=Dfe((e=>s.a.createElement("td",null,"Item $",e))),t=Dfe(null),r=Dfe(null),n=Dfe(null),i=Dfe({}),o=Dfe(Wpe),a=Dfe(xfe),l=(e,t=null)=>jfe(Ffe(i,Bfe((t=>t[e])),Lfe()),t);return{context:t,itemContent:e,fixedHeaderContent:r,fixedFooterContent:n,components:i,computeItemKey:o,scrollerRef:a,TableComponent:l("Table","table"),TableHeadComponent:l("TableHead","thead"),TableFooterComponent:l("TableFoot","tfoot"),TableBodyComponent:l("TableBody","tbody"),TableRowComponent:l("TableRow","tr"),ScrollerComponent:l("Scroller","div"),EmptyPlaceholder:l("EmptyPlaceholder"),ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),FillerRow:l("FillerRow")}})),Yge=Xfe((([e,t])=>({...e,...t})),Cfe(Vpe,qge)),Jge=({height:e})=>s.a.createElement("tr",null,s.a.createElement("td",{style:{height:e}})),Xge=({height:e})=>s.a.createElement("tr",null,s.a.createElement("td",{style:{height:e,padding:0,border:0}})),Zge={overflowAnchor:"none"},Qge=s.a.memo((function(){const e=ome("listState"),t=ime("sizeRanges"),r=ome("useWindowScroll"),n=ome("customScrollParent"),i=ime("windowScrollContainerState"),o=ime("scrollContainerState"),a=n||r?i:o,l=ome("itemContent"),c=ome("trackItemSizes"),u=ome("itemSize"),d=ome("log"),{callbackRef:f,ref:h}=she(t,u,c,a,d,void 0,n),[p,g]=s.a.useState(0);ame("deviation",(e=>{p!==e&&(h.current.style.marginTop=`${e}px`,g(e))}));const m=ome("EmptyPlaceholder"),v=ome("ScrollSeekPlaceholder")||Jge,y=ome("FillerRow")||Xge,b=ome("TableBodyComponent"),_=ome("TableRowComponent"),w=ome("computeItemKey"),C=ome("isSeeking"),E=ome("paddingTopAddition"),S=ome("firstItemIndex"),k=ome("statefulTotalCount"),x=ome("context");if(0===k&&m)return s.a.createElement(m,tge(m,x));const O=e.offsetTop+E+p,I=e.offsetBottom,R=O>0?s.a.createElement(y,{height:O,key:"padding-top",context:x}):null,T=I>0?s.a.createElement(y,{height:I,key:"padding-bottom",context:x}):null,A=e.items.map((e=>{const t=e.originalIndex,r=w(t+S,e.data,x);return C?s.a.createElement(v,{...tge(v,x),key:r,index:e.index,height:e.size,type:e.type||"item"}):s.a.createElement(_,{...tge(_,x),...rge(_,e.data),key:r,"data-index":t,"data-known-size":e.size,"data-item-index":e.index,style:Zge},l(e.index,e.data,x))}));return s.a.createElement(b,{ref:f,"data-test-id":"virtuoso-item-list",...tge(b,x)},[R,...A,T])})),eme=({children:e})=>{const t=s.a.useContext(zpe),r=ime("viewportHeight"),n=ime("fixedItemHeight"),i=ahe(vfe(r,(e=>lhe(e,"height"))));return s.a.useEffect((()=>{t&&(r(t.viewportHeight),n(t.itemHeight))}),[t,r,n]),s.a.createElement("div",{style:Qpe,ref:i,"data-viewport-type":"element"},e)},tme=({children:e})=>{const t=s.a.useContext(zpe),r=ime("windowViewportRect"),n=ime("fixedItemHeight"),i=ome("customScrollParent"),o=Upe(r,i);return s.a.useEffect((()=>{t&&(n(t.itemHeight),r({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))}),[t,r,n]),s.a.createElement("div",{ref:o,style:Qpe,"data-viewport-type":"window"},e)},rme=s.a.memo((function(e){const t=ome("useWindowScroll"),r=ome("customScrollParent"),n=ime("fixedHeaderHeight"),i=ime("fixedFooterHeight"),o=ome("fixedHeaderContent"),a=ome("fixedFooterContent"),l=ome("context"),c=ahe(vfe(n,(e=>lhe(e,"height")))),u=ahe(vfe(i,(e=>lhe(e,"height")))),d=r||t?lme:sme,f=r||t?tme:eme,h=ome("TableComponent"),p=ome("TableHeadComponent"),g=ome("TableFooterComponent"),m=o?s.a.createElement(p,{key:"TableHead",style:{zIndex:2,position:"sticky",top:0},ref:c,...tge(p,l)},o()):null,v=a?s.a.createElement(g,{key:"TableFoot",style:{zIndex:1,position:"sticky",bottom:0},ref:u,...tge(g,l)},a()):null;return s.a.createElement(d,{...e},s.a.createElement(f,null,s.a.createElement(h,{style:{borderSpacing:0,overflowAnchor:"none"},...tge(h,l)},[m,s.a.createElement(Qge,{key:"TableBody"}),v])))})),{Component:nme,usePublisher:ime,useEmitterValue:ome,useEmitter:ame}=ehe(Yge,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},rme),sme=oge({usePublisher:ime,useEmitterValue:ome,useEmitter:ame}),lme=age({usePublisher:ime,useEmitterValue:ome,useEmitter:ame}),cme=nme,ume=({isFolding:e,onFold:t})=>s.a.createElement("span",{className:"lakex-viewer-grid-group-fold"},s.a.createElement(XU,{type:"ReviewArrowDown",size:16,onClick:()=>{t&&t(!e)}}));var dme=Object.defineProperty,fme=Object.getOwnPropertyDescriptor,hme=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?fme(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dme(t,r,o),o};let pme=class extends fp{constructor(){super(...arguments),this.groupFolding=new Set,this._onGroupFoldingChange=this._register(new _p),this.onGroupFoldingChange=this._onGroupFoldingChange.event}get FoldIcon(){return ume}setGroupFolding(e,t){t?this.groupFolding.add(e):this.groupFolding.delete(e),this._onGroupFoldingChange.emit(new Set(this.groupFolding))}clearGroupFolding(){this.groupFolding=new Set,this._onGroupFoldingChange.emit(new Set(this.groupFolding))}destroy(){super.destroy()}};function gme(e){const t=HL(zue),[r,n]=Object(a.useState)(!1),[i,o]=Object(a.useState)(null);return Object(a.useEffect)((()=>{const r=null==t?void 0:t.onRefreshTooltipChange((({recordId:t,desc:r})=>{if(!t)return n(!1),void o(null);n(e===t),o(r)}));return()=>{null==r||r.destroy()}}),[t]),{isInRefresh:r,refreshDesc:i}}hme([Ii()],pme.prototype,"destroy",1),pme=hme([io()],pme);const mme=({record:e})=>{const{isInRefresh:t,refreshDesc:r}=gme(e.get("record_uuid"));return t?s.a.createElement("div",{className:"lakex-viewer-grid-row-tooltip"},null==r?void 0:r.text,s.a.createElement(p.a,{placement:"top",title:null==r?void 0:r.ps},s.a.createElement("div",{className:"lakex-viewer-grid-row-tooltip-icon"},s.a.createElement(XU,{type:"Question",size:16})))):null},vme=({index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,sticky:o=!0,hasBlank:l=!1,isDragging:c=!1,isGroupLast:u=!1,disableDrag:d=!1,listeners:f})=>{const h=HL(dre),p=Xte(),{Record:g}=h,m=Object(a.useMemo)((()=>{const t=null==p?void 0:p.getRangeAt(0);return(null==t?void 0:t.start.row)===e}),[p]),v=Object(a.useMemo)((()=>{if(!p)return!1;const{anchor:e,focus:t}=p;return m&&e.row===t.row&&e.column===t.column}),[p,m]);return f?s.a.createElement("div",{className:qL("lakex-viewer-grid-row-container",{"is-dragging":c,sticky:o,normal:!o,"group-last":u,selected:m,"is-select-one":v})},o&&s.a.createElement(mme,{record:t}),g&&s.a.createElement(g,{index:e,record:t,records:r,fields:n,config:i,sticky:o,hasBlank:l,disableDrag:d,listeners:f})):s.a.createElement("div",{className:qL("lakex-viewer-grid-row-container",{sticky:o,normal:!o,"group-last":u,"is-select-one":v})},o&&s.a.createElement(mme,{record:t}),g&&s.a.createElement(g,{index:e,record:t,records:r,fields:n,config:i,sticky:o,hasBlank:l,disableDrag:d}))},yme=$i.defineToken("ContextMenuContribution");var bme=Object.defineProperty,_me=Object.getOwnPropertyDescriptor,wme=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_me(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bme(t,r,o),o};let Cme=class{constructor(){this._items=new Map,this.isInit=!1}init(){var e;if(this.isInit)return;this.isInit=!0;const t=this.toolbarPluginProvider.getContributions();for(const r of t)try{null==(e=r.registerContextMenu)||e.call(r,this)}catch(e){console.error(e)}}registerItem(e){const{key:t}=e;if(this._items.has(t))throw new Error(`A contextmenu item is already registered with the '${t}'`);return this._items.set(t,e),e}getContextMenuItem(e){return"|"===e?e:this._items.get(e)}unregisterItem(e){const t="string"==typeof e?e:e.key;this.getContextMenuItem(t)&&this._items.delete(t)}get hasContextMenu(){return this._items.size>0}};wme([wh(yme)],Cme.prototype,"toolbarPluginProvider",2),Cme=wme([io()],Cme);var Eme=Object.defineProperty,Sme=Object.getOwnPropertyDescriptor,kme=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Sme(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Eme(t,r,o),o};let xme=class{getMenuItems(e){const t=(this._configurationService.getValue("contextMenu")||[]).map((e=>this._contextMenuRegistry.getContextMenuItem(e))).filter((e=>void 0!==e));return this.cleanMenuItems(t,e)}cleanMenuItems(e,t){const r=[];return e.forEach((e=>{if("|"===e){const t=r[r.length-1];(!t||"|"===t)&&r.pop(),r.push(e)}else{if(null==e.visible&&(e.visible=!0),!(ls(e.visible)?e.visible(t):e.visible))return;r.push({...e,name:ls(e.name)?e.name(t):e.name})}})),"|"===r[r.length-1]&&r.pop(),"|"===r[0]&&r.shift(),r}};kme([ao(lp)],xme.prototype,"_configurationService",2),kme([ao(Cme)],xme.prototype,"_contextMenuRegistry",2),xme=kme([io()],xme);class Ome extends OB{}Ome.activators=[{eventName:"onPointerDown",handler:({nativeEvent:e})=>function(e){return!(e.dataset&&e.dataset.noDnd)}(e.target)}];const Ime=({viewRecords:e,viewFields:t,groupViewRecords:r,group:n,filters:i,viewField:o,index:l,size:c,rootHeight:u})=>{var d,f;const h=X9(aR.TABLE).canUpdate(),p=HL(qte),g=HL(gre),m=HL(Zue),v=HL(nH),y=HL(Qz),{attributes:b,listeners:_,setNodeRef:w,over:C,active:E}=HU({id:o.get("uuid"),disabled:!h}),[S,k]=Object(a.useState)(!1),x=X9(aR.FIELD),{field:O,fieldId:I}=r7(o.get("field_uuid")),R=Object(a.useMemo)((()=>Fp(i,(e=>e.get("field_uuid")===(null==O?void 0:O.get("uuid"))))),[i,O]),T=Xte(),A=Object(a.useMemo)((()=>null==p?void 0:p.isSelectOneCol(l)),[T,l]),M=({type:e})=>{const t=v.getFieldIcon(e);return t?s.a.createElement(t,{size:16}):null},N=({type:e})=>{const t=v.getFieldTagComponent(e);return t&&O?s.a.createElement(t,{field:O,position:"gridHeader"}):null},D=Object(a.useCallback)((()=>{if(!p)return;const i=n?r.map((e=>{var t;return(null==(t=e.viewRecords)?void 0:t.length)||0})).reduce(((e,t)=>e+t),0):e.length,o=p.createColumnGridSelectionByIndex(l,i,t.length);p.setSelection(o)}),[l,e,t,n]),P=vG(((e,t)=>{!x.canUpdate(t)||null==y||y.emitClickEvent({eventName:"gridHeader:doubleClick",data:{fieldId:t.get("uuid"),event:e}})})),j=Object(a.useCallback)((({e:e,fieldId:t})=>{e.preventDefault(),e.stopPropagation(),D(),null==m||m.showContextMenu({e:e,from:Xue.HEADER,fieldId:t})}),[l,e,t,n]);if(Object(a.useEffect)((()=>{if(S){const e=EL(window,"mousemove",EN((e=>{g.emitResizing(e)}),16)),t=EL(window,"mouseup",(t=>{g.emitResizeEnd(t),k(!1),e.destroy()}));return()=>{e.destroy(),t.destroy()}}}),[S]),!O||!v.getFieldTargetPlugin(O.get("type")))return null;const F=null==(d=null==E?void 0:E.data.current)?void 0:d.sortable.index,V=null==(f=null==C?void 0:C.data.current)?void 0:f.sortable.index;return s.a.createElement("div",{key:O.get("updated_at"),ref:w,className:qL("lakex-viewer-grid-header-column",{"in-filter":R,"is-selected":A}),"data-col-index":l,"data-field-id":I,style:{width:(c||g.defaultColWidth)+"px"},onClick:e=>D(),onContextMenu:e=>j({e:e,fieldId:I}),onDoubleClick:e=>P(e,O)},s.a.createElement("div",{className:"lakex-viewer-grid-header-column-content",..._,...b},s.a.createElement("div",{className:"lakex-viewer-grid-header-column-icon"},s.a.createElement(M,{type:O.get("type")})),s.a.createElement("div",{className:"lakex-viewer-grid-header-column-name"},O.get("name")),s.a.createElement(N,{type:O.get("type")})),s.a.createElement("div",{className:"lakex-viewer-grid-header-column-dropdown",onClick:e=>j({e:e,fieldId:I})},s.a.createElement(XU,{type:"ReviewArrowDown",size:16})),s.a.createElement("div",{className:"lakex-viewer-grid-header-column-resizer",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),g.emitResizeStart(e,t,l),k(!0)}}),(null==C?void 0:C.id)===o.get("uuid")&&(null==C?void 0:C.id)!==(null==E?void 0:E.id)&&s.a.createElement("div",{className:qL("lakex-viewer-grid-dragger-line",{left:F>V,right:F<V}),style:{height:u}}))},Rme=({viewRecords:e,viewFields:t,groupViewRecords:r,group:n,filters:i,sticky:o,stickyColNum:a,rootHeight:l,hasBlank:c=!1})=>{const u=HL(dre).AddField,d=o?Hp(t,0,a):Hp(t,a,t.length);return s.a.createElement("div",{className:"lakex-viewer-grid-header-row"},o&&s.a.createElement("div",{className:"lakex-viewer-grid-header-index"}),Bp(d,((c,u)=>{const d=u+(o?0:a);return s.a.createElement(Ime,{key:c.get("uuid"),viewFields:t,groupViewRecords:r,viewRecords:e,group:n,filters:i,viewField:c,index:d,size:c.get("size"),rootHeight:l})})),c&&u&&s.a.createElement(u,null))},Tme=({fieldGroups:e,viewFields:t,sticky:r,stickyColNum:n})=>{const i=HL(gre),o=HL(Zue),l=HL(cfe,{optional:!0}),c=Object(a.useMemo)((()=>r?Hp(t,0,n):Hp(t,n,t.length)),[t,r,n]),d=Object(a.useMemo)((()=>{const t={};return e.forEach((e=>{t[e.get("uuid")]=e})),t}),[e]),[f,h]=Object(a.useState)(""),[p,g]=Object(a.useState)(""),m=Object(a.useRef)(null),v=Object(a.useCallback)((({e:e,fieldGroupId:t})=>{e.preventDefault(),e.stopPropagation(),null==o||o.showContextMenu({e:e,fieldGroupId:t,from:Xue.GROUP_HEADER})}),[]),y=Object(a.useCallback)((e=>{null==l||l.updateFieldGroupName(f,p),h(""),g("")}),[f,p]);return Object(a.useEffect)((()=>{const e=null==l?void 0:l.onEditGroupName((({fieldGroupId:e})=>{const t=d[e];h(e),g(t.name)}));return()=>{null==e||e.destroy()}}),[d]),Object(a.useEffect)((()=>{var e;""!==f&&(null==(e=m.current)||e.focus())}),[f]),0===e.length?null:s.a.createElement("div",{className:"lakex-viewer-grid-header-group-row"},c.map(((e,t)=>{var n,o,a;const l=e.group_uuid&&d[e.group_uuid];if(l&&(null==(n=c[t-1])||!n.group_uuid||(null==(o=c[t-1])?void 0:o.group_uuid)!==e.group_uuid)){const n=[e];for(let r=t;r<c.length&&l&&(null==(a=c[r+1])?void 0:a.group_uuid)===e.group_uuid;r++)n.push(c[r+1]);const o=n.map((e=>e.size||i.defaultColWidth)).reduce(((e,t)=>e+t),0),b=r?i.indexColWidth:0;return s.a.createElement("div",{key:((null==e?void 0:e.group_uuid)||"")+t,className:"lakex-viewer-grid-header-group-column",style:{width:o+b+"px"},onDoubleClick:()=>{const t=e.group_uuid&&d[e.group_uuid];h(e.group_uuid||""),g(t.name)},onContextMenu:t=>v({e:t,fieldGroupId:e.group_uuid})},f===e.group_uuid?s.a.createElement(u.a,{ref:m,value:p,autoComplete:"off",onChange:e=>{const t=e.target.value;g(t)},onMouseDown:OL,onMouseMove:OL,onMouseUp:OL,onBlur:y,onKeyDown:e=>{var t;e.keyCode===SN.ENTER&&(null==(t=m.current)||t.blur())}}):l.name)}if(!l){const t=e.size||i.defaultColWidth,n=r?i.indexColWidth:0;return s.a.createElement("div",{key:e.field_uuid,className:"lakex-viewer-grid-header-group-column",style:{width:t+n+"px"}})}return null})))},Ame=({viewRecords:e,viewFields:t,groupViewRecords:r,group:n,fieldGroups:i,filters:o})=>{var l,c,u,d;const f=HL(zde),h=HL(gre),p=HL(Wz),g=X9(aR.FIELD).canCreate(),[m,v]=Object(a.useState)(null),y=Object(a.useRef)(null),b=M$(A$(Ome,{activationConstraint:{distance:8}})),_=Object(a.useMemo)((()=>Lp(t,(e=>e.get("uuid")===m))),[m,t]),w=t.get(_);return s.a.createElement(lU,{sensors:b,modifiers:[WU],collisionDetection:B$,onDragStart:e=>{v(e.active.id),p.$root&&(y.current=p.$root.getBoundingClientRect())},onDragEnd:async e=>{var r,n;const{active:i,over:o}=e;if(v(null),i.id!==o.id){const e=null==(r=Fp(t,(e=>e.get("uuid")===i.id)))?void 0:r.get("field_uuid"),a=null==(n=Fp(t,(e=>e.get("uuid")===o.id)))?void 0:n.get("field_uuid");await f.updateFieldOrder(e,a)}},autoScroll:{threshold:{x:.2,y:0}}},s.a.createElement(FU,{items:Bp(t,(e=>({...e,id:e.get("uuid")}))),strategy:AU},s.a.createElement("div",{className:qL("lakex-viewer-grid-header",{"has-group":i.length>0})},s.a.createElement("div",{className:"lakex-viewer-grid-header-left"},s.a.createElement("div",{className:"lakex-viewer-grid-header-main"},s.a.createElement(Tme,{viewFields:t,viewRecords:e,groupViewRecords:r,group:n,fieldGroups:i,sticky:!0,stickyColNum:h.stickyColNum}),s.a.createElement(Rme,{viewFields:t,viewRecords:e,groupViewRecords:r,group:n,filters:o,sticky:!0,stickyColNum:h.stickyColNum,rootHeight:(null==(l=y.current)?void 0:l.height)||"100%"}))),s.a.createElement("div",{className:qL("lakex-viewer-grid-header-right",{"has-blank":g})},s.a.createElement("div",{className:"lakex-viewer-grid-header-main"},s.a.createElement(Tme,{viewFields:t,viewRecords:e,groupViewRecords:r,group:n,fieldGroups:i,sticky:!1,stickyColNum:h.stickyColNum}),s.a.createElement(Rme,{viewFields:t,viewRecords:e,groupViewRecords:r,group:n,filters:o,sticky:!1,stickyColNum:h.stickyColNum,rootHeight:(null==(c=y.current)?void 0:c.height)||"100%",hasBlank:g})))),s.a.createElement(xU,{style:{height:null==(u=y.current)?void 0:u.height},dropAnimation:null},w?s.a.createElement("div",{className:"lakex-viewer-grid-header-drag-overlay"},s.a.createElement(Ime,{viewFields:t,viewRecords:e,groupViewRecords:r,group:n,filters:o,viewField:w,index:_,size:w.get("size"),rootHeight:(null==(d=y.current)?void 0:d.height)||"100%"})):null)))},Mme=({cellNum:e})=>s.a.createElement("div",{className:"lakex-viewer-grid-footer-column-name"},Ph("已选择 $1 个单元格",e)),Nme=({viewField:e,viewRecords:t})=>{const r=HL(dre).Statistics;return r?s.a.createElement(r,{viewField:e,recordIds:t.map((e=>e.get("record_uuid")))}):null},Dme=({width:e,viewField:t,viewRecords:r})=>{const n=Yte(),i=null==n?void 0:n.getRangeAt(0),o=i?(i.end.column-i.start.column+1)*(i.end.row-i.start.row+1):0;return Object(a.useMemo)((()=>s.a.createElement("div",{className:"lakex-viewer-grid-footer-column",style:{width:e+"px"}},o>1?s.a.createElement(Mme,{cellNum:o}):s.a.createElement(Nme,{viewField:t,viewRecords:r}))),[o,t,r])},Pme=({viewRecords:e,viewFields:t,indexColWidth:r,defaultColWidth:n,stickyColNum:i,sticky:o})=>{const a=o?Hp(t,0,i):Hp(t,i,t.length);return s.a.createElement(s.a.Fragment,null,Bp(a,((t,a)=>{if(!t.get("field"))return null;const l=a+(o?0:i);return 0===l?s.a.createElement(Dme,{key:t.get("uuid")+"_"+l,width:r+(t.get("size")||n),viewField:t,viewRecords:e}):s.a.createElement("div",{key:t.get("uuid")+"_"+l,className:"lakex-viewer-grid-footer-column",style:{width:(t.get("size")||n)+"px"}},s.a.createElement(Nme,{viewField:t,viewRecords:e}))})))},jme=({viewRecords:e,viewFields:t})=>{const r=HL(gre),{indexColWidth:n,defaultColWidth:i,stickyColNum:o}=r;return s.a.createElement("div",{className:"lakex-viewer-grid-footer"},s.a.createElement("div",{className:"lakex-viewer-grid-footer-left"},s.a.createElement(Pme,{viewRecords:e,viewFields:t,indexColWidth:n,defaultColWidth:i,stickyColNum:o,sticky:!0})),s.a.createElement("div",{className:"lakex-viewer-grid-footer-right"},s.a.createElement(Pme,{viewRecords:e,viewFields:t,indexColWidth:n,defaultColWidth:i,stickyColNum:o,sticky:!1})))},Fme=({stickyPaneWidth:e,isUngroup:t,groupField:r,groupOption:n,viewRecords:i,fields:o,isFolding:a,onFold:l})=>{const c=HL(nH),u=HL(gre),d=HL(dre),f=HL(pme,{optional:!0}),h=null==c?void 0:c.getFieldComponent(null==r?void 0:r.get("type")),p=d.Statistics,g=null==f?void 0:f.FoldIcon;return s.a.createElement("div",{className:qL("lakex-viewer-grid-group-header",{folded:a})},s.a.createElement("div",{className:"left",style:{width:e}},s.a.createElement("div",{className:qL("lakex-viewer-grid-group-header-index",{"no-sticky-col":0===u.stickyColNum})},g&&s.a.createElement(g,{isFolding:a,onFold:l}),t?Ph("（空）"):h&&s.a.createElement("div",{className:"lakex-viewer-grid-group-field"},s.a.createElement(h,{readonly:!0,field:r,cell:n,checkCell:!1,writeable:!1}))),Hp(o,0,u.stickyColNum).map(((e,t)=>{var r;return s.a.createElement("div",{key:"group_"+(null==(r=e.get("field"))?void 0:r.get("uuid"))+"_"+t,className:qL("lakex-viewer-grid-group-header-column sticky"),style:{width:e.get("size")+"px"}},p?s.a.createElement(p,{viewField:e,recordIds:i.map((e=>e.get("record_uuid")))}):null)}))),s.a.createElement("div",{className:"right"},Hp(o,u.stickyColNum,o.length).map(((e,t)=>{var r;return s.a.createElement("div",{key:"group_"+(null==(r=e.get("field"))?void 0:r.get("uuid"))+"_"+t,className:qL("lakex-viewer-grid-group-header-column"),style:{width:e.get("size")+"px"}},p?s.a.createElement(p,{viewField:e,recordIds:i.map((e=>e.get("record_uuid")))}):null)}))))},Vme=({isSameGroup:e,recordIndexMap:t,active:r,over:n,record:i})=>{var o,a,l,c;const u=null==(a=null==(o=null==r?void 0:r.data.current)?void 0:o.sortable)?void 0:a.index,d=null==(c=null==(l=null==n?void 0:n.data.current)?void 0:l.sortable)?void 0:c.index;if(!n||!r)return null;if(!e&&n.id===i.id&&n.id!==r.id){const e=t[n.id].isGroupFirst,r=t[n.id].isGroupLast;return s.a.createElement("div",{className:qL("lakex-viewer-grid-group-dragger-line",{top:u>d,bottom:u<d,first:e,last:r})})}return null},Lme=({stickyPaneWidth:e,index:t,record:r,groupViewRecords:n,viewFields:i,viewConfig:o,allRecords:a,recordIndexMap:l,groupFolding:c})=>{var u;const d=HL(dre),f=HL(pme,{optional:!0}),h=X9(aR.TABLE).isReadonly(),{groupIndex:p,isGroupFirst:g,isGroupLast:m}=l[r.id],v=n[p],y=(null==(u=v.option)?void 0:u.value)||d.UNGROUP_KEY,b=c.has(y),_=null==d?void 0:d.AddRecord;let w=null;const{attributes:C,listeners:E,setNodeRef:S,transform:k,transition:x,isDragging:O,over:I,active:R}=HU({id:r.id,disabled:h});if(!b){const e={transform:"",transition:x,opacity:O?0:1},n=!(!R||!I)&&l[R.id].groupIndex===l[I.id].groupIndex;n&&(e.transform=y$.Transform.toString(k)||""),w=s.a.createElement("div",{ref:h?void 0:S,className:"lakex-viewer-grid-group-row",style:e,...C},s.a.createElement(vme,{key:(null==r?void 0:r.id)+"_sticky_"+t,index:t,record:r.viewRecord,viewRecords:a.map((e=>e.viewRecord)),viewFields:i,viewConfig:o,sticky:!0,isGroupLast:m,listeners:E}),s.a.createElement(vme,{key:(null==r?void 0:r.id)+"_"+t,index:t,record:r.viewRecord,viewRecords:a.map((e=>e.viewRecord)),viewFields:i,viewConfig:o,sticky:!1,isGroupLast:m}),s.a.createElement(Vme,{isSameGroup:n,recordIndexMap:l,allRecords:a,active:R,over:I,record:r}))}return s.a.createElement("td",null,g&&s.a.createElement(Fme,{stickyPaneWidth:e,isUngroup:!v.option,groupField:v.field,groupOption:v.option,viewRecords:v.viewRecords,fields:i,isFolding:b,onFold:e=>{null==f||f.setGroupFolding(y,e)}}),w,!h&&m&&!b&&s.a.createElement("div",{className:"lakex-viewer-grid-row-container sticky",style:{width:e}},_?s.a.createElement(_,{inGroup:!0,index:t,viewGroupRecord:v,viewRecords:a,viewFields:i}):null))},$me=({style:e,context:t,...r})=>{const{rootRect:n,useWindowScroll:i}=t;return s.a.createElement("table",{...r,style:{...e,width:i?"auto":"100%",minWidth:i?"750px":"auto",minHeight:i?0:null==n?void 0:n.height}})},Bme=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=HL(sH);return s.a.createElement("thead",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridHeader}})})),Ume=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=HL(sH);return s.a.createElement("tfoot",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridFooter}})})),zme=({style:e,...t})=>{const[r,n]=Object(a.useState)(0),i=t["data-known-size"],o={"--child-height":`${r}px`};return Object(a.useEffect)((()=>{n((e=>0===i?e:i))}),[i]),s.a.createElement("tr",{className:"height-preserving-tr",...t,style:{...e,...o}})},Hme=({groupViewRecords:e,viewFields:t,viewConfig:r,group:n,fieldGroups:i,filters:o,stickyPaneWidth:c,recordHeight:u,rootRect:d,useWindowScroll:f,customScrollParent:h,customModalContainer:p})=>{const g=HL(Ere),v=HL(dre),y=HL(pme,{optional:!0}),b=null==v?void 0:v.AddRecord,{allRecords:_,recordIndexMap:w}=(e=>{const t={},r=[];let n=0;for(let i=0;i<e.length;i++){const o=e[i].viewRecords||[];i>0&&(n+=(e[i-1].viewRecords||[]).length);for(let e=0;e<o.length;e++){const a=o[e];t[a.get("record_uuid")]={groupIndex:i,totalIndex:n+e,indexInGroup:e,isGroupFirst:0===e,isGroupLast:e===o.length-1},r.push({id:a.get("record_uuid"),viewRecord:a})}}return{recordIndexMap:t,allRecords:r}})(e),{activeId:C,sensors:E,onDragStart:S,onDragEnd:k}=((e,t,r,n)=>{const i=HL(Ere),o=HL(zde),s=HL(qte),l=HL(KO),[c,u]=Object(a.useState)(null);return{activeId:c,sensors:M$(A$(OB,{activationConstraint:{distance:8}})),onDragStart:e=>{u(e.active.id),null==s||s.removeSelection()},onDragEnd:async r=>{var a,s,c,d;u(null);const{active:f,over:h}=r;if(f.id!==h.id){const r=f.id;let u=h.id;const{groupIndex:p}=e[r],{groupIndex:g}=e[u],v=t[p]||null,y=t[g]||null;if((null==n?void 0:n.get("keep_sort"))&&v===y)return void m.a.warn(Ph("取消排序后，可进行拖拽"));if(v&&y&&v!==y){const e=null==(a=f.data.current.sortable)?void 0:a.index,t=null==(s=h.data.current.sortable)?void 0:s.index,n=l.getOriginViewRecords(),i=Lp(n,(e=>e.get("record_uuid")===r)),o=Lp(n,(e=>e.get("record_uuid")===u));e<t&&i>o&&(u=null==(c=n[o+1])?void 0:c.record_uuid),e>t&&i<o&&(u=null==(d=n[o-1])?void 0:d.record_uuid)}if(await o.updateRecordOrder(r,u,v,y),null!=n&&n.get("keep_sort")){const e=Lp(l.getFlatViewRecords(n.get("view_uuid")),(e=>e.get("record_uuid")===r));return i.scrollIntoView({index:e,align:"start"}),void m.a.warn(Ph("当前处于保持排序状态，为您重新定位"))}}}}})(w,e,0,r),x=X9(aR.RECORD).canCreate(),[O,I]=Object(a.useState)((null==y?void 0:y.groupFolding)||new Set),R=Object(a.useRef)(null),T=_.findIndex((e=>e.id===C)),A=_[T];return Object(a.useEffect)((()=>{null==y||y.clearGroupFolding()}),[null==n?void 0:n.get("uuid")]),Object(a.useEffect)((()=>{const e=null==y?void 0:y.onGroupFoldingChange((e=>{I(e)}));return()=>{null==e||e.destroy()}}),[y]),Object(a.useEffect)((()=>{R.current&&(null==g||g.setTableVirtuosoRef(R.current))}),[g,R]),CG((()=>{null==y||y.clearGroupFolding(),null==g||g.destroy()})),0===_.length&&x?b?s.a.createElement(b,{inGroup:!0,index:-1,viewRecords:[],viewFields:t}):null:s.a.createElement(lU,{sensors:E,modifiers:[YU,qU],collisionDetection:B$,onDragStart:S,onDragEnd:k,autoScroll:{threshold:{x:0,y:.2}}},s.a.createElement(FU,{items:_,strategy:DU},s.a.createElement(s.a.Fragment,null,s.a.createElement(cme,{ref:R,useWindowScroll:f,customScrollParent:h,context:{rootRect:d,useWindowScroll:f},components:{Table:$me,TableHead:Bme,TableFoot:Ume,TableRow:zme},isScrolling:e=>{null==g||g.isScrolling(e)},onScroll:()=>{null==g||g.onScroll()},data:_,defaultItemHeight:u,itemSize:t=>{var r;if(void 0===t.dataset.index)return u;const n=parseInt(t.dataset.index),i=_[n],{isGroupFirst:o,isGroupLast:a,groupIndex:s}=w[i.id],l=(null==(r=e[s].option)?void 0:r.value)||v.UNGROUP_KEY,c=O.has(l);return(c?0:u)+(o?56:0)+(a&&!c&&x?40:0)+(n===_.length-1?20:0)},increaseViewportBy:360,style:{width:"100%",height:(null==d?void 0:d.height)||0,overflow:"overlay"},fixedHeaderContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(Ame,{groupViewRecords:e,viewFields:t,viewConfig:r,group:n,fieldGroups:i,filters:o}))),fixedFooterContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(jme,{viewRecords:_.map((e=>e.viewRecord)),viewFields:t,group:n,stickyPaneWidth:c}))),itemContent:(n,i)=>s.a.createElement(s.a.Fragment,null,s.a.createElement(Lme,{key:i.id,groupViewRecords:e,stickyPaneWidth:c,index:n,record:i,viewFields:t,viewConfig:r,allRecords:_,recordIndexMap:w,groupFolding:O}),n===_.length-1?s.a.createElement("div",{className:"lakex-viewer-grid-group-gap-line"}):null)}),Object(l.createPortal)(s.a.createElement(xU,{dropAnimation:null,style:{width:`${d.width}px`,left:`${d.left}px`,overflow:"hidden"}},A?s.a.createElement("div",{className:"lakex-viewer-grid-group-row"},s.a.createElement(vme,{index:T,record:A.viewRecord,viewRecords:_.map((e=>e.viewRecord)),viewFields:t,viewConfig:r,sticky:!0,isGroupLast:!1}),s.a.createElement(vme,{index:T,record:A.viewRecord,viewRecords:_.map((e=>e.viewRecord)),viewFields:t,viewConfig:r,sticky:!1,isGroupLast:!1})):null),p))))},Wme=({index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,listeners:o={}})=>{const{canCreate:a}=X9(aR.FIELD);return s.a.createElement("div",{className:"lakex-viewer-grid-list-row"},s.a.createElement(vme,{index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,sticky:!0,listeners:o,disableDrag:!(null==i||!i.get("keep_sort"))}),s.a.createElement(vme,{index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,sticky:!1,hasBlank:a(),disableDrag:!(null==i||!i.get("keep_sort"))}))},Gme=({index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i})=>{const o=!X9(aR.TABLE).canUpdate()||!(null==i||!i.get("keep_sort")),{attributes:a,listeners:l,setNodeRef:c,transform:u,transition:d,isDragging:f}=HU({id:t.get("record_uuid"),disabled:o}),h={transform:y$.Transform.toString(u),transition:d,zIndex:f?"100":"auto",opacity:f?0:1};return s.a.createElement("td",{ref:o?void 0:c,style:h,...a},s.a.createElement(Wme,{index:e,record:t,viewRecords:r,viewFields:n,viewConfig:i,listeners:l}))},Kme=({style:e,context:t,...r})=>{const{rootRect:n,useWindowScroll:i}=t;return s.a.createElement("table",{...r,style:{...e,width:i?"auto":"100%",minWidth:i?"750px":"auto",minHeight:i?0:null==n?void 0:n.height}})},qme=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=HL(sH);return s.a.createElement("thead",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridHeader}})})),Yme=s.a.forwardRef(((e,t)=>{const{style:r,...n}=e,i=HL(sH);return s.a.createElement("tfoot",{ref:t,...n,style:{...r,zIndex:null==i?void 0:i.zIndex.gridFooter}})})),Jme=({style:e,...t})=>{const[r,n]=Object(a.useState)(0),i=t["data-known-size"],o={"--child-height":`${r}px`};return Object(a.useEffect)((()=>{n((e=>0===i?e:i))}),[i]),s.a.createElement("tr",{className:"height-preserving-tr",...t,style:{...e,...o}})},Xme=({viewRecords:e,viewFields:t,viewConfig:r,fieldGroups:n,filters:i,stickyPaneWidth:o,recordHeight:c,rootRect:u,useWindowScroll:d,customScrollParent:f,customModalContainer:h})=>{const p=X9(aR.RECORD).canCreate(),g=HL(Ere),m=HL(dre),v=null==m?void 0:m.AddRecord,y=Object(a.useRef)(null),{activeId:b,sensors:_,onDragStart:w,onDragEnd:C}=(()=>{const e=HL(zde),t=HL(qte),[r,n]=Object(a.useState)(null);return{activeId:r,sensors:M$(A$(OB,{activationConstraint:{distance:8}})),onDragStart:e=>{n(e.active.id),null==t||t.removeSelection()},onDragEnd:async t=>{n(null);const{active:r,over:i}=t;if(r.id!==i.id){const t=r.id,n=i.id;await e.updateRecordOrder(t,n)}}}})(),E=Lp(e,(e=>e.get("record_uuid")===b)),S=e.get(E),k=Object(a.useMemo)((()=>Bp(e,(e=>({id:e.get("record_uuid")})))),[e]);return Object(a.useEffect)((()=>{y.current&&(null==g||g.setTableVirtuosoRef(y.current))}),[g,y]),CG((()=>{null==g||g.destroy()})),0===e.length&&p?v?s.a.createElement(v,{viewRecords:e,viewFields:t}):null:s.a.createElement(lU,{sensors:_,modifiers:[YU,qU],collisionDetection:B$,onDragStart:w,onDragEnd:C,autoScroll:{threshold:{x:0,y:.2}}},s.a.createElement(FU,{items:k,strategy:DU},s.a.createElement(s.a.Fragment,null,s.a.createElement(cme,{ref:y,useWindowScroll:d,customScrollParent:f,context:{rootRect:u,useWindowScroll:d},components:{Table:Kme,TableHead:qme,TableFoot:Yme,TableRow:Jme},isScrolling:e=>{null==g||g.isScrolling(e)},onScroll:()=>{null==g||g.onScroll()},data:e.toArray(),defaultItemHeight:c,itemSize:t=>{if(void 0===t.dataset.index)return c;const r=parseInt(t.dataset.index);return c+(r===e.length-1&&p?40:0)},increaseViewportBy:360,style:{width:"100%",height:(null==u?void 0:u.height)||0,overflow:"overlay"},fixedHeaderContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(Ame,{viewRecords:e,viewFields:t,viewConfig:r,fieldGroups:n,filters:i}))),fixedFooterContent:()=>s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(jme,{viewRecords:e,viewFields:t,stickyPaneWidth:o}))),itemContent:(n,i)=>i?s.a.createElement(s.a.Fragment,null,s.a.createElement(Gme,{key:i.get("record_uuid"),index:n,record:i,viewRecords:e,viewFields:t,viewConfig:r}),n===e.length-1&&s.a.createElement("td",null,s.a.createElement("div",{className:"lakex-viewer-grid-row-container sticky",style:{width:o}},p&&v?s.a.createElement(v,{viewRecords:e,viewFields:t}):null))):null}),Object(l.createPortal)(s.a.createElement(xU,{dropAnimation:null,style:{width:`${u.width}px`,left:`${u.left}px`,overflow:"hidden"}},S?s.a.createElement(Wme,{index:E,record:S,viewRecords:e,viewFields:t,viewConfig:r}):null),h))))},Zme=({viewRecords:e,groupViewRecords:t,viewFields:r,viewConfig:n,group:i,fieldGroups:o,filters:l})=>{const c=HL(bre),u=HL(gre),{rootRect:d,useWindowScroll:f,customScrollParent:h,customModalContainer:p}=(()=>{const e=HL(Wz),t=HL(Ere),r=HL(lp),n=Object(a.useRef)(e.getRenderBoundingClientRect()),i=HL(lp),[o,s]=Object(a.useState)((null==i?void 0:i.getValue("view.useWindowScroll"))||!1),l=null==i?void 0:i.getValue("view.customScrollParent"),c=(null==i?void 0:i.getValue("modal.customModalContainer"))||document.body;return Object(a.useEffect)((()=>{const i=vN((()=>{if(null!=r&&r.getValue("view.useWindowScroll"))return;const i=e.getRenderBoundingClientRect();if(n.current=i,t.tableScroller){t.tableScroller.style.height=i.height+"px";const e=t.tableScroller.querySelector("table");e&&(e.style.width="100%",e.style.minWidth="auto",e.style.minHeight=i.height+"px")}}),300);return window.addEventListener("resize",i),window.addEventListener("lakex_table_view_resize",i),()=>{window.removeEventListener("resize",i),window.removeEventListener("lakex_table_view_resize",i)}}),[e]),Object(a.useEffect)((()=>{const t=null==i?void 0:i.onConfigurationChange((({key:t,value:r})=>{if("view.useWindowScroll"===t){const t=e.getRenderBoundingClientRect();n.current=t,s(r)}}));return()=>{null==t||t.destroy()}}),[]),{rootRect:n.current,useWindowScroll:o,customScrollParent:l,customModalContainer:c}})(),g=Object(a.useMemo)((()=>c.getRowHeight(null==n?void 0:n.get("record_height"))),[c,null==n?void 0:n.get("record_height")]),m=Object(a.useMemo)((()=>{const e=i?null==u?void 0:u.groupRowGap:0;return((null==u?void 0:u.getStickyPaneWidth(r||[]))||0)+e}),[u,r]);return Object(a.useEffect)((()=>{const e=e=>{("ResizeObserver loop completed with undelivered notifications."===e.message||"ResizeObserver loop limit exceeded"===e.message)&&e.stopImmediatePropagation()};return window.addEventListener("error",e),()=>{window.removeEventListener("error",e)}}),[]),s.a.createElement("div",{className:qL("lakex-viewer-grid-content",{"in-group":!!i})},i?s.a.createElement(Hme,{groupViewRecords:t,viewFields:r,viewConfig:n,group:i,fieldGroups:o,filters:l,stickyPaneWidth:m,recordHeight:g,rootRect:d,useWindowScroll:f,customScrollParent:h,customModalContainer:p}):s.a.createElement(Xme,{viewRecords:e,viewFields:r,viewConfig:n,fieldGroups:o,filters:l,stickyPaneWidth:m,recordHeight:g,rootRect:d,useWindowScroll:f,customScrollParent:h,customModalContainer:p}))},Qme=s.a.forwardRef(((e,t)=>{const r=HL(tre),n=e7(),i=s.a.createElement("div",{ref:t,className:"lakex-viewer-grid"},s.a.createElement("div",{className:"lakex-viewer-grid-inner"},s.a.createElement(Zme,{viewRecords:n.viewRecords,groupViewRecords:n.groupViewRecords,viewFields:n.viewFields,viewConfig:n.viewConfig,group:n.group,fieldGroups:n.fieldGroups,filters:n.filters}))),o=null==r?void 0:r.SelectionContainer;return o?s.a.createElement(o,null,i):i}));class eve extends iG{constructor(){super(...arguments),this.viewType=LE.GRID,this.title=Ph("表格视图"),this.desc=Ph("规范化存储和展示数据"),this.icon=e=>s.a.createElement(XU,{type:"GridView",size:16,...e}),this.colorCls="yuque-color-green-6",this.Component=Qme}}var tve=Object.defineProperty,rve=Object.getOwnPropertyDescriptor,nve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tve(t,r,o),o};let ive=class{static pluginModule(){return xo().contribution(ire).contribution(ore).contribution(are).contribution(sre).register(this).register(dre).register(Ore).register(gre).register(bre).register(Ere)}static registerConfiguration(e){e.registerConfiguration({id:"viewerGrid",type:"object",title:"表格视图",properties:{stickyColNum:{type:"number",description:"冻结列个数"}}}),e.registerDefaultValue({"viewerGrid.stickyColNum":1})}get _isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get _currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.get("type")}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}init(){this._viewerGridService.init()}registerViewer(e){e.registerItem(new eve({onError:e.onError}))}registerHotkey(e){e.registerItem({id:"grid-field-move-up",hotkey:"up",name:"up 向上移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveUp()}}),e.registerItem({id:"grid-field-move-down",hotkey:"down",name:"down 向下移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveDown()}}),e.registerItem({id:"grid-field-move-left",hotkey:"left",name:"left 向左移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveLeft()}}),e.registerItem({id:"grid-field-move-right",hotkey:"right, tab",name:"right 向右移动选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveRight()}}),e.registerItem({id:"grid-field-move-top",hotkey:"⌘+up",name:"移动到第一行选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveTop()}}),e.registerItem({id:"grid-field-move-bottom",hotkey:"⌘+down",name:"移动到最后一行选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveBottom()}}),e.registerItem({id:"grid-field-move-first-left",hotkey:"⌘+left",name:"移动到第一列选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFirstLeft()}}),e.registerItem({id:"grid-field-move-last-right",hotkey:"⌘+right",name:"移动到最后一列选区",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveLastRight()}}),e.registerItem({id:"grid-field-focus-move-up",hotkey:"shift+up",name:"选区终点上移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusUp()}}),e.registerItem({id:"grid-field-focus-move-down",hotkey:"shift+down",name:"选区终点下移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusDown()}}),e.registerItem({id:"grid-field-focus-move-left",hotkey:"shift+left",name:"选区终点左移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusLeft()}}),e.registerItem({id:"grid-field-focus-move-right",hotkey:"shift+right",name:"选区终点右移",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._hasSelection();return e&&t},onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.moveFocusRight()}}),e.registerItem({id:"grid-field-select-all",hotkey:"⌘+A",name:"全选",enableOnInput:!1,isEnable:()=>this._currentViewType===LE.GRID,onHotKey:e=>{var t;e.preventDefault(),null==(t=this._selectionService)||t.selectAll()}}),e.registerItem({id:"grid-add-record-before",hotkey:"⌘+shift+enter",name:"向上插入行",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._isReadonly,r=this._hasSelection();return!t&&e&&r},onHotKey:e=>{var t,r,n,i;e.preventDefault();const o=this._readService.getFlatViewRecords(),a=null==(t=this._selectionService)?void 0:t.getFieldValue(),s=Lp(o,(e=>e.get("record_uuid")===(null==a?void 0:a.recordId)));if(s<0)return;const l=this._readService.getViewFields(),c=o.get(s),u=(null==(r=this._selectionService)?void 0:r.getSelection()).anchor.column;this._commandService.execCommand("addEmptyRecord",{sourceRecordId:c.get("record_uuid"),direction:"before",groupItemKey:c.get("group_item_key")});const d=null==(n=this._selectionService)?void 0:n.createGridSelectionByIndex(s,u,((null==o?void 0:o.length)||0)+1,(null==l?void 0:l.length)||0);null==(i=this._selectionService)||i.setSelection(d)}}),e.registerItem({id:"grid-add-record-after",hotkey:"shift+enter",name:"向下插入行",enableOnInput:!1,isEnable:()=>{const e=this._currentViewType===LE.GRID,t=this._isReadonly,r=this._hasSelection();return!t&&e&&r},onHotKey:e=>{var t,r,n,i;e.preventDefault();const o=this._readService.getFlatViewRecords(),a=null==(t=this._selectionService)?void 0:t.getFieldValue(),s=Lp(o,(e=>e.get("record_uuid")===(null==a?void 0:a.recordId)));if(s<0)return;const l=this._readService.getViewFields(),c=o.get(s),u=(null==(r=this._selectionService)?void 0:r.getSelection()).anchor.column;this._commandService.execCommand("addEmptyRecord",{sourceRecordId:c.get("record_uuid"),direction:"after",groupItemKey:c.get("group_item_key")});const d=null==(n=this._selectionService)?void 0:n.createGridSelectionByIndex(s+1,u,((null==o?void 0:o.length)||0)+1,(null==l?void 0:l.length)||0);null==(i=this._selectionService)||i.setSelection(d)}})}registerScrollService(e){e.setGridScrollService(this._scrollService)}};ive.pluginName="render-viewer-grid",nve([ao(KO)],ive.prototype,"_readService",2),nve([ao(bR)],ive.prototype,"_abilityService",2),nve([ao(qte),cN()],ive.prototype,"_selectionService",2),nve([ao(zI)],ive.prototype,"_commandService",2),nve([ao(Ere)],ive.prototype,"_scrollService",2),nve([ao(dre)],ive.prototype,"_viewerGridService",2),ive=nve([io({contrib:[Dz,Lte,hz,Lz]})],ive);var ove=Object.defineProperty,ave=Object.getOwnPropertyDescriptor,sve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?ave(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ove(t,r,o),o};let lve=class extends fp{constructor(){super(...arguments),this._onEditingChange=this._register(new _p),this.onEditingChange=this._onEditingChange.event}emitEditingChange({editing:e,recordId:t,fieldId:r}){this._onEditingChange.emit({recordId:t,fieldId:r,editing:e})}destroy(){super.destroy()}};sve([Ii()],lve.prototype,"destroy",1),lve=sve([io()],lve);const cve=Object(a.memo)((({fieldType:e,cell:t})=>{const r=HL(nH).getCellIsShowValidTip(e),n=t.errorMessage;return n&&r?s.a.createElement(p.a,{title:n,placement:"left"},s.a.createElement("span",{className:"lakex-table-grid-invalid-flag"})):null}),((e,t)=>e.cell.updated_at===t.cell.updated_at)),uve=e=>{const{fieldType:t,cell:r,field:n,isSelected:i,boxRect:o}=e,a=HL(nH).getFieldComponent(t);return a&&n?s.a.createElement(a,{key:r.updated_at,field:n,fieldUpdatedAt:n.get("updated_at"),cell:r,focus:!1,boxRect:o,isSelected:i}):null},dve=({cell:e,field:t,size:r,rowIndex:n,colIndex:i,rowCount:o,colCount:l,minHeight:c,isFrozen:u})=>{const d=null==e?void 0:e.recordId,f=null==t?void 0:t.get("uuid"),h=HL(Zue),p=HL(Qz),g=HL(qte),m=HL(sH),v=null==t?void 0:t.get("type"),y=Object(a.useRef)(null),b=Xte(),_=Lue({recordId:d,fieldId:f}),w=function(e,t){const r=HL(lve),[n,i]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const n=r.onEditingChange((({recordId:r,fieldId:n,editing:o})=>{r===e&&n===t&&i(o)}));return()=>{n.destroy()}}),[r]),n}(d,f),C=Object(a.useMemo)((()=>null==g?void 0:g.isActiveCell(n,i)),[b]),E=Object(a.useMemo)((()=>null==g?void 0:g.isInSelect(n,i)),[b]),S=Object(a.useMemo)((()=>C&&u?null==m?void 0:m.zIndex.gridCellFrozenPreviewer:u?null==m?void 0:m.zIndex.gridCellFrozen:C?null==m?void 0:m.zIndex.gridCellPreviewer:null==m?void 0:m.zIndex.gridCell),[C,u]),[k,x]=Object(a.useState)(0),O=Object(a.useCallback)((({e:e,recordId:t,fieldId:r})=>{const a=null==g?void 0:g.getSelection();if(e.preventDefault(),a&&(null==g||!g.isSelectOneCell())&&(null==g?void 0:g.isInSelect(n,i)))return void(null==h||h.showContextMenu({from:Xue.MULTI_CELL,e:e,selection:a}));const s=null==g?void 0:g.createGridSelectionByIndex(n,i,o,l);s&&(null==g||g.setSelection(s)),null==h||h.showContextMenu({from:Xue.CELL,e:e,recordId:t,fieldId:r,selection:a})}),[g,h]),I=Object(a.useCallback)((e=>{null==g||g.scrollToAnchorPosition(null==g?void 0:g.getSelection(),e.clientY>window.innerHeight/2?"end":"start",(()=>{null==p||p.emitDoubleClickCell({fieldId:f,recordId:d,event:e,fieldType:v})}))}),[v,f,d]),R=Object(a.useCallback)((e=>{null==p||p.emitClickEvent({eventName:"activeCellClick",data:{fieldId:f,recordId:d,event:e,fieldType:v}})}),[v,f,d,C]),T=Object(a.useCallback)((e=>{if(2!==e.button&&!C){const e=null==g?void 0:g.createGridSelectionByIndex(n,i,o,l);e&&(null==g||g.setSelection(e),null==g||g.scrollToSelection(e))}}),[C]),A=Object(a.useMemo)((()=>({width:r?r-20:0,height:c-12})),[r,c]);return Object(a.useLayoutEffect)((()=>{var e;if(C&&v===pE.TEXT){const t=null==(e=y.current)?void 0:e.getBoundingClientRect();t&&window.innerHeight-t.bottom<40?x(c-t.height):x(0)}else x(0)}),[C,c,v]),s.a.createElement("div",{ref:y,"data-col":i,"data-record-uuid":null==e?void 0:e.recordId,"data-field-uuid":null==t?void 0:t.get("uuid"),className:qL("lakex-viewer-grid-cell",{"in-select":E&&!C,"in-highlight":_,selected:C,editing:w,[`height-${c}`]:c},v),style:{width:r+"px",minHeight:c,zIndex:S,transform:C?`translateY(${k}px)`:""},onContextMenu:e=>O({e:e,recordId:d,fieldId:f,from:Xue.CELL}),onScrollCapture:e=>e.stopPropagation(),onDoubleClick:I,onClick:R,onMouseDown:T},s.a.createElement(uve,{key:e.updated_at,cell:e,field:t,fieldType:v,isSelected:!!C,boxRect:A}),e&&s.a.createElement(cve,{fieldType:v,cell:e}))},fve=({record:e,fields:t,records:r,config:n,index:i,sticky:o,hasBlank:l=!1,disableDrag:c=!1,listeners:u={}})=>{const d=HL(ade),f=HL(bre),h=HL(qte),p=HL(zde),g=HL(Qz),m=HL(KO),v=HL(lp),y=HL(gre),b=d.ExpandRecordRecordHeaderIcon,_=null==p?void 0:p.OrderDragIcon,w=Object(a.useCallback)((()=>{(null==v?void 0:v.getValue("render.mode"))===jz.MOBILE&&(null==g||g.emitClickRecord({recordId:e.get("record_uuid")}))}),[e.get("record_uuid")]),C=Object(a.useMemo)((()=>f.getRowHeight(null==n?void 0:n.get("record_height"))),[f,null==n?void 0:n.get("record_height")]),E=$p(t,((e,t)=>(e[t.get("field_uuid")]=t,e)),{}),S=null==m?void 0:m.getViewRecordCells(e.get("record_uuid")),k=Object(a.useMemo)((()=>Vp(Hp(S,0,y.stickyColNum),(e=>!!e))||[]),[S,y.stickyColNum]),x=Object(a.useMemo)((()=>Vp(null==S?void 0:S.slice(y.stickyColNum,S.length),(e=>!!e))||[]),[S,y.stickyColNum]);return s.a.createElement("div",{className:"lakex-viewer-grid-row","data-row":i,"data-record-uuid":e.get("record_uuid"),style:{height:C},onClick:w},o&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-viewer-grid-row-index",onClick:()=>{const e=null==h?void 0:h.createRowGridSelectionByIndex(i,r.length,t.length);null==h||h.setSelection(e)}},_&&s.a.createElement(_,{listeners:u,disable:c}),s.a.createElement("div",{className:"lakex-viewer-grid-row-number"},i+1),b&&s.a.createElement(b,{recordId:e.get("record_uuid")})),Bp(k,((n,o)=>{const a=E[(null==n?void 0:n.fieldId)||""];return s.a.createElement(dve,{key:e.get("record_uuid")+"-"+(null==n?void 0:n.updated_at),rowIndex:i,colIndex:o,rowCount:r.length,colCount:t.length,cell:n,field:null==a?void 0:a.get("field"),size:(null==a?void 0:a.get("size"))||y.defaultColWidth,minHeight:C,isFrozen:!0})}))),!o&&s.a.createElement(s.a.Fragment,null,Bp(x,((n,o)=>{const a=E[(null==n?void 0:n.fieldId)||""];return s.a.createElement(dve,{key:e.get("record_uuid")+"_"+(null==n?void 0:n.fieldId)+"_"+o,rowIndex:i,colIndex:o+y.stickyColNum,rowCount:r.length,colCount:t.length,cell:n,field:null==a?void 0:a.get("field"),size:(null==a?void 0:a.get("size"))||y.defaultColWidth,minHeight:C,isFrozen:!1})})),l&&s.a.createElement("div",{className:"lakex-viewer-grid-row-blank"})))};var hve=Object.defineProperty,pve=Object.getOwnPropertyDescriptor;let gve=class{static pluginModule(){return xo().contribution(rde).register(this).register(ade)}getRecordComponent(){return fve}};gve.pluginName="render-viewer-grid-record",gve=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?pve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hve(t,r,o),o})([io({contrib:ire})],gve);var mve=Object.defineProperty,vve=Object.getOwnPropertyDescriptor;let yve=class{static pluginModule(){return xo().register(pme).register(this)}init(){}};yve.pluginName="render-viewer-grid-group",yve=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?vve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mve(t,r,o),o})([io({contrib:Dz})],yve);var bve=Object.defineProperty,_ve=Object.getOwnPropertyDescriptor;let wve=class{static pluginModule(){return xo().register(this).register(lve)}init(e){}};wve.pluginName="render-viewer-grid-cell-editor",wve=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?_ve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bve(t,r,o),o})([io({contrib:[Dz]})],wve);var Cve=Object.defineProperty,Eve=Object.getOwnPropertyDescriptor,Sve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Eve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Cve(t,r,o),o};let kve=class extends fp{constructor(){super(...arguments),this.gridGap=20,this._onRefreshLayout=this._register(new _p),this.onRefreshLayout=this._onRefreshLayout.event}_getViewRect(){return this._renderContext.getRenderBoundingClientRect()}_getColCount(e){let t=5;return e<1440&&(t=Math.max(5-Math.ceil((1440-e)/300),2)),t}_getRowCount(e,t){return Math.ceil(e/t)}_getCardWidth(e,t){return Math.floor(Math.floor(e-20*(t+1))/t)}getCoverHeight(e){return Math.round(e/1.6)}_getFieldNameHeight(){return 23}_getCardHeight(e,t,r){var n;let i=0;r.get("cover_field_uuid")&&(i+=this.getCoverHeight(e));for(let e=0;e<t.length;e++){const o=t.get(e);if(o.get("hidden"))continue;r.get("show_field_name")&&(i+=this._getFieldNameHeight());const a=null==(n=o.get("field"))?void 0:n.get("type");a===pE.IMAGE?i+=48:a===pE.TEXT?i+=20+(0===e?28:40):i+=48}return i+20}getLayout(e,t,r){const n=this._getViewRect(),i=this._getColCount(n.width),o=this._getRowCount(e.length,i),a=this._getCardWidth(n.width,i);return{viewRect:n,width:a,height:this._getCardHeight(a,t,r),colCount:i,rowCount:o}}refresh(){this._onRefreshLayout.emit()}destroy(){super.destroy()}};Sve([ao(Wz)],kve.prototype,"_renderContext",2),Sve([Ii()],kve.prototype,"destroy",1),kve=Sve([io()],kve);var xve=Object.defineProperty,Ove=Object.getOwnPropertyDescriptor;let Ive=class{constructor(){this._virtuosoRef=null}get virtuosoRef(){return this._virtuosoRef}setVirtuosoRef(e){this._virtuosoRef=e}scrollToIndex(e){var t;null==(t=this._virtuosoRef)||t.scrollToIndex(e)}scrollTo(e){var t;null==(t=this._virtuosoRef)||t.scrollTo(e)}};Ive=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Ove(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&xve(t,r,o),o})([io()],Ive);const Rve=({height:e})=>s.a.createElement("div",{className:"lakex-table-card-cover empty",style:{height:e}},s.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/bmw-prod/94c60ed0-e53a-4ad1-9ffe-ec7fd1266b46.svg",draggable:"false"})),Tve=({viewRecord:e,width:t})=>{const{getCoverHeight:r,cell:n,viewConfig:i,opener:o,imageService:a}=(({viewRecord:e,width:t})=>{const r=HL(KO),n=HL(PH),i=HL(h6),o=HL(kve),a=null==r?void 0:r.getViewConfig();return{cell:null==r?void 0:r.getCell((null==a?void 0:a.get("cover_field_uuid"))||"",e.get("record_uuid")),opener:n,imageService:i,viewConfig:a,getCoverHeight:()=>null==o?void 0:o.getCoverHeight(t)}})({viewRecord:e,width:t});if(null==i||!i.get("cover_field_uuid"))return null;if(null==n||!n.value)return s.a.createElement(Rve,{height:r()});const l=n.value[0];if(null==l||!l.src)return s.a.createElement(Rve,{height:r()});const c={height:r()},u=a.getThumbnailUrl(l.src,l.width,l.height,390);return c.backgroundImage=`url(${u})`,c.backgroundRepeat="no-repeat",c.backgroundPosition="center center","clip"===i.get("cover_display")?c.backgroundSize="cover":c.backgroundSize="contain",s.a.createElement("div",{className:"lakex-table-card-image",style:c,onClick:e=>{e.preventDefault(),e.stopPropagation(),null==o||o.open("image",l.src,{width:l.width,height:l.height})}})};const Ave=({cell:e,field:t,viewConfig:r,index:n})=>{const i=HL(nH),o=i.getFieldComponent(null==t?void 0:t.get("type")),a=function(e,t){t.value,zE.isSelectLike(e.type)||zE.isImage(e.type)||zE.isSystemDate(e.type)}(t,e),l=null==i?void 0:i.getFieldIcon(t.get("type"));let c=null;return 0===n&&null==(null==e?void 0:e.value)&&(c=s.a.createElement("div",{key:null==e?void 0:e.fieldId,className:qL("lakex-viewer-card-field-content first empty")},Ph("未命名记录"))),s.a.createElement("div",{className:"lakex-viewer-card-cell-field"},r.get("show_field_name")&&s.a.createElement("div",{className:"lakex-viewer-card-field-name"},s.a.createElement(s.a.Fragment,null,l&&s.a.createElement(l,{size:16}),null==t?void 0:t.get("name"))),c,o&&!c&&s.a.createElement("div",{className:qL("lakex-viewer-card-field-content",`${t.get("type")}`,{first:0===n})},s.a.createElement(o,{cell:e,field:t,fieldProps:a,readonly:!0})))},Mve=200,Nve=300,Dve=({fieldMap:e,cell:t,index:r,viewConfig:n})=>{const i=e.get(t.fieldId);return i?s.a.createElement(Ave,{cell:t,field:i,viewConfig:n,index:r}):null},Pve=e=>{const{className:t,viewRecord:r,width:n=Mve,height:i=Nve,viewConfig:o,fieldMap:l,disableDrag:c=!1}=e,{cells:u,isSelected:d,isInHighlight:f,onShowRecord:h,onShowContextMenu:p}=(({viewRecord:e})=>{const t=HL(Zue),r=HL(Qz),n=HL(KO),i=Xte(),o=Object(a.useMemo)((()=>!!i&&i.getRangeAt(0).recordId===(null==e?void 0:e.get("record_uuid"))),[i]),s=Lue({recordId:null==e?void 0:e.get("record_uuid")}),l=Object(a.useCallback)((()=>{const t=null==e?void 0:e.get("record_uuid");t&&(null==r||r.emitClickRecord({recordId:t}))}),[e,r]),c=Object(a.useCallback)((r=>{r.preventDefault(),null==t||t.showContextMenu({e:r,from:Xue.CARD_RECORD,recordId:null==e?void 0:e.get("record_uuid")})}),[e,t]);return{cells:null==n?void 0:n.getViewRecordCells(e.get("record_uuid")),isSelected:o,isInHighlight:s,onShowRecord:l,onShowContextMenu:c}})({viewRecord:r}),g=qL("lakex-viewer-card-record-item",t,{selected:d,"in-highlight":f});if(c)return s.a.createElement("div",{className:g,onClick:h,onContextMenu:p,"data-record-uuid":null==r?void 0:r.get("record_uuid"),style:{width:n,height:i}},s.a.createElement(Tve,{viewRecord:r,width:n}),Bp(u,((e,t)=>s.a.createElement(Dve,{key:e.fieldType+e.uuid,cell:e,index:t,viewConfig:o,fieldMap:l}))));const{attributes:m,listeners:v,setNodeRef:y,transform:b,transition:_,isDragging:w}=HU({id:r.get("record_uuid"),disabled:c}),C={transform:y$.Transform.toString(b),transition:_,zIndex:w?"100":"auto",opacity:w?0:1};return s.a.createElement("div",{ref:y,className:g,onClick:h,onContextMenu:p,"data-record-uuid":null==r?void 0:r.get("record_uuid"),style:{...C,width:n,height:i},...v,...m},s.a.createElement(Tve,{viewRecord:r,width:n}),Bp(u,((e,t)=>s.a.createElement(Dve,{key:e.fieldType+e.uuid,cell:e,index:t,viewConfig:o,fieldMap:l}))))};Pve.defaultProps={isShowEmpty:!1,isShowField:!1};const jve=s.a.forwardRef(((e,t)=>{const{style:r,context:n,...i}=e,{colCount:o,cardWidth:a,gridGap:l}=n;return s.a.createElement("div",{ref:t,...i,style:{...r,display:"grid",gridTemplateColumns:`repeat(${o}, ${a}px)`,columnGap:`${l}px`,padding:`0 ${l}px`}})})),Fve=s.a.forwardRef(((e,t)=>{const{context:r,...n}=e,{colCount:i,gridGap:o}=r,a={};return e["data-index"]<i&&(a.paddingTop=`${o}px`),s.a.createElement("div",{...n,style:a})})),Vve=s.a.forwardRef(((e,t)=>{const{fields:r,viewRecords:n,viewFields:i,viewConfig:o}=e,{SelectionContainer:c}=HL(tre)||{},u=X9(aR.TABLE).isReadonly(),{rootRect:d,cardWidth:f,cardHeight:h,colCount:p,gridGap:g,useWindowScroll:m,customScrollParent:v,customModalContainer:y}=(({viewRecords:e,viewFields:t,viewConfig:r})=>{const n=HL(kve),i=HL(lp),[o,s]=Object(a.useState)(Mve),[l,c]=Object(a.useState)(Nve),[u,d]=Object(a.useState)(0),[f,h]=Object(a.useState)(),[p,g]=Object(a.useState)((null==i?void 0:i.getValue("view.useWindowScroll"))||!1),m=null==i?void 0:i.getValue("view.customScrollParent"),v=(null==i?void 0:i.getValue("modal.customModalContainer"))||document.body,y=Object(a.useCallback)((()=>{const i=null==n?void 0:n.getLayout(e,t,r);h(null==i?void 0:i.viewRect),s((null==i?void 0:i.width)||Mve),c((null==i?void 0:i.height)||Nve),d((null==i?void 0:i.colCount)||0)}),[e,t,r]);return Object(a.useEffect)((()=>{const e=null==i?void 0:i.onConfigurationChange((({key:e,value:t})=>{"view.useWindowScroll"===e&&(y(),g(t))}));return()=>{null==e||e.destroy()}}),[y]),Object(a.useEffect)((()=>{const e=vN((()=>{p||y()}),300);window.addEventListener("resize",e),window.addEventListener("lakex_table_view_resize",e);const t=null==n?void 0:n.onRefreshLayout((()=>{y()}));return()=>{window.removeEventListener("resize",e),window.removeEventListener("lakex_table_view_resize",e),null==t||t.destroy()}}),[p,y]),Object(a.useEffect)((()=>{y()}),[y]),{rootRect:f,gridGap:null==n?void 0:n.gridGap,cardWidth:o,cardHeight:l,colCount:u,useWindowScroll:p,customScrollParent:m,customModalContainer:v}})({viewRecords:n,viewFields:i,viewConfig:o}),{activeId:b,sensors:_,onDragStart:w,onDragEnd:C}=(()=>{const e=HL(zde),[t,r]=Object(a.useState)(null);return{activeId:t,sensors:M$(A$(OB,{activationConstraint:{distance:8}})),onDragStart:e=>{r(e.active.id)},onDragEnd:async t=>{r(null);const{active:n,over:i}=t;if(n.id!==i.id){const t=n.id,r=i.id;await e.updateRecordOrder(t,r)}}}})(),E=(()=>{const e=HL(Ive),t=Object(a.useRef)(null);return Object(a.useEffect)((()=>{t.current&&(null==e||e.setVirtuosoRef(t.current))}),[e,t]),t})(),S=Object(a.useMemo)((()=>Bp(n,(e=>({viewRecord:e,id:e.get("record_uuid")})))),[n]),k=Object(a.useMemo)((()=>Fp(n,(e=>e.get("record_uuid")===b))),[b,n]),x=new Map;if(r.forEach((e=>{x.set(e.get("uuid"),e)})),!o||!n||0===n.length||!i)return null;const O=s.a.createElement("div",{ref:t,className:"lakex-viewer-card"},s.a.createElement("div",{className:"lakex-viewer-card-inner"},s.a.createElement("div",{className:"lakex-viewer-card-content"},s.a.createElement(lU,{sensors:_,modifiers:[qU],collisionDetection:B$,onDragStart:w,onDragEnd:C},s.a.createElement(s.a.Fragment,null,s.a.createElement(FU,{items:S,strategy:MU},s.a.createElement(Kge,{useWindowScroll:m,customScrollParent:v,ref:E,context:{gridGap:g,colCount:p,cardWidth:f,cardHeight:h},components:{List:jve,Item:Fve},style:{width:"100%",height:null==d?void 0:d.height},data:S,itemContent:(e,t)=>s.a.createElement(Pve,{key:t.viewRecord.get("record_uuid"),viewRecord:t.viewRecord,fieldMap:x,viewConfig:o,width:f,height:h,disableDrag:u||!(null==o||!o.get("keep_sort"))})})),Object(l.createPortal)(s.a.createElement(xU,{dropAnimation:null},k?s.a.createElement(Pve,{viewRecord:k,fieldMap:x,viewConfig:o,width:f,height:h}):null),y))))));return c?s.a.createElement(c,null,O):O})),Lve=s.a.forwardRef(((e,t)=>{const r=e7();return s.a.createElement(Vve,{ref:t,fields:r.fields,viewRecords:r.viewRecords,viewFields:r.viewFields,viewConfig:r.viewConfig})}));class $ve extends iG{constructor(){super(...arguments),this.viewType=LE.CARD,this.title=Ph("画册视图"),this.desc=Ph("适合展示图片类数据"),this.icon=e=>s.a.createElement(XU,{type:"CardView",size:16,...e}),this.colorCls="yuque-color-blue-5",this.Component=Lve}}var Bve=Object.defineProperty,Uve=Object.getOwnPropertyDescriptor,zve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Uve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Bve(t,r,o),o};let Hve=class{static pluginModule(){return xo().register(this).register(kve).register(Ive)}init(){}registerViewer(e){e.registerItem(new $ve({onError:e.onError}))}registerScrollService(e){e.setCardScrollService(this._scrollService)}};Hve.pluginName="render-viewer-card",zve([ao(Ive)],Hve.prototype,"_scrollService",2),Hve=zve([io({contrib:[Dz,Lz,Lte]})],Hve);const Wve=$i.defineToken("ViewerKanbanPluginGroupContribution");var Gve=Object.defineProperty,Kve=Object.getOwnPropertyDescriptor,qve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Kve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Gve(t,r,o),o};let Yve=class{get Group(){return this._getGroupComponent()}_getGroupComponent(){var e,t;const r=this.viewerKanbanPluginGroupProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getGroupComponent)?void 0:t.call(e):null}};qve([wh(Wve)],Yve.prototype,"viewerKanbanPluginGroupProvider",2),Yve=qve([io()],Yve);const Jve=$i.defineToken("ViewerKanbanGroupActionContribution");var Xve=Object.defineProperty,Zve=Object.getOwnPropertyDescriptor,Qve=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Zve(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Xve(t,r,o),o};let eye=class{constructor(){this.getKanbanGroupActionComponents=()=>{const e=this._viewerKanbanGroupActionProvider.getContributions({cache:!1});if(e.length>0){let t=[];return e.forEach((e=>{var r;const n=null==(r=e.getKanbanGroupActionComponent)?void 0:r.call(e);!n||(Array.isArray(n)?t=t.concat(n):t.push(n))})),t}return null}}getGroup(){const e=this._readService.getActiveView();return e?this._readService.getViewGroup(null==e?void 0:e.get("uuid")):null}getGroupField(){const e=this.getGroup();return null==e?void 0:e.field}getSupportGroupFields(){return Vp(this._readService.getAllFields(),(e=>[pE.SELECT,pE.MENTION].includes(e.get("type"))))}getGroupFieldOption(e,t){if(e.get("type")===pE.SELECT){return Fp(this._readService.getFieldOptions(e.get("uuid")),(e=>e.get("uuid")===t.value))}return e.get("type")===pE.MENTION?t:null}createGroup(){var e;const t=this._readService.getAllFields(),r={field:{uuid:To(32),name:wE(pE.SELECT,t.toJSON()),type:pE.SELECT,color:!0,options:[]}};null==(e=this._commandService)||e.execCommand("addField",r)}};Qve([wh(Jve)],eye.prototype,"_viewerKanbanGroupActionProvider",2),Qve([ao(KO)],eye.prototype,"_readService",2),Qve([ao(zI)],eye.prototype,"_commandService",2),eye=Qve([io()],eye);var tye=Object.defineProperty,rye=Object.getOwnPropertyDescriptor,nye=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&tye(t,r,o),o};let iye=class{constructor(){this.UNGROUP_KEY="ungroup"}toKanbanData(e){return(null==e?void 0:e.map((e=>{var t;return{id:(null==(t=e.option)?void 0:t.uuid)||this.UNGROUP_KEY,...e}})))||[]}addRecord(e,t){var r,n;const i=this._readService.getGroupViewRecords();let o;if(o=t?i.find((e=>{var r;return(null==(r=e.option)?void 0:r.uuid)===t.uuid})):i[0],!o)return;const a=o.viewRecords.length>0?o.viewRecords[0].get("record_uuid"):"",s=this._commandService.execCommand("addEmptyRecord",{sourceRecordId:a,groupItemKey:t?null==(r=this._readService)?void 0:r.keyValue(t):"",position:"after"}),l=null==s?void 0:s.result;l&&l[0]&&(null==(n=this._renderService)||n.emitClickRecord({recordId:l[0].uuid,isNewRecord:!0}))}};nye([ao(zI)],iye.prototype,"_commandService",2),nye([ao(KO)],iye.prototype,"_readService",2),nye([ao(Qz)],iye.prototype,"_renderService",2),iye=nye([io()],iye);var oye=Object.defineProperty,aye=Object.getOwnPropertyDescriptor,sye=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oye(t,r,o),o};let lye=class{constructor(){this._virtuosoRefs={},this._groupRefs={}}get virtuosoRefs(){return this._virtuosoRefs}get groupRefs(){return this._groupRefs}setVirtuosoRefs(e){this._virtuosoRefs=e}setGroupRefs(e){this._groupRefs=e}scrollIntoView(e,t){var r;null==(r=this._virtuosoRefs[e])||r.scrollIntoView(t)}scrollTo(e,t){var r;null==(r=this._virtuosoRefs[e])||r.scrollTo(t)}getKanbanGroupPositionByRecordId(e,t){var r;let n="",i=-1;for(let o=0;o<t.length;o++){const a=t[o].viewRecords||[];for(let s=0;s<a.length;s++)if(a[s].get("record_uuid")===e){n=(null==(r=t[o].option)?void 0:r.uuid)||this._dataServce.UNGROUP_KEY,i=s;break}}return{index:i,groupId:n}}};sye([ao(iye)],lye.prototype,"_dataServce",2),lye=sye([io()],lye);const cye=({groupField:e})=>{const{onAddGroup:t}=(({groupField:e})=>{const t=HL(xte);return{onAddGroup:r=>{null==t||t.showNewGroup(r.target.parentNode,e)}}})({groupField:e});return e?s.a.createElement("div",{className:"lakex-viewer-kanban-group"},s.a.createElement("div",{className:"lakex-table-kanban-group-title"},s.a.createElement("div",{className:"lakex-viewer-kanban-new-group"},s.a.createElement("button",{className:"lakex-table-button lakex-viewer-kanban-new-group-button",onClick:t},s.a.createElement(XU,{type:"Add"}),Ph("新建分组"))))):null},uye=e=>{const t=X9(aR.TABLE).isReadonly();return s.a.createElement("div",{className:"lakex-table-kanban-empty"},s.a.createElement("div",{className:"lakex-table-kanban-empty-body"},s.a.createElement("h1",null,Ph("看板暂无分组")),s.a.createElement("p",null,Ph("可以快速新建一个单选列进行分组")),s.a.createElement(b.a,{type:"primary",onClick:e.onCreate,disabled:t},Ph("新建分组"))))};const dye=({viewRecord:e,fields:t,viewConfig:r})=>{const n=HL(Zue),i=HL(nH),o=HL(Qz),l=HL(KO),c=Xte(),u=e.get("record_uuid"),d=Object(a.useMemo)((()=>!!c&&c.getRangeAt(0).recordId===u),[c]),f=Lue({recordId:u}),h=Object(a.useCallback)((e=>{e.preventDefault(),null==n||n.showContextMenu({from:Xue.KANBAN_RECORD,e:e,recordId:u})}),[u,n]),p=Object(a.useCallback)((()=>{null==o||o.emitClickRecord({recordId:u})}),[u,o]),g=null==l?void 0:l.getViewRecordCells(e.get("view_uuid"),e.get("record_uuid"));return s.a.createElement("div",{key:u+e.get("updated_at"),className:qL("lakex-viewer-kanban-record",{selected:d,"in-highlight":f}),"data-record-uuid":u,onClick:p,onContextMenu:h},s.a.createElement("div",{className:"lakex-viewer-kanban-field-list"},null==g?void 0:g.map(((e,n)=>{const o=Fp(t,(t=>t.get("uuid")===(null==e?void 0:e.fieldId)));if(!o)return null;const a=i.getFieldComponent(o.get("type")),l=null==i?void 0:i.getFieldIcon(o.get("type"));if(null==(null==e?void 0:e.value)||""==(null==e?void 0:e.value))return 0===n?s.a.createElement("div",{key:e.fieldType+e.cellId,className:"lakex-viewer-kanban-field empty first"},(null==r?void 0:r.get("show_field_name"))&&s.a.createElement("div",{className:"lakex-viewer-kanban-field-name"},s.a.createElement(s.a.Fragment,null,l&&s.a.createElement(l,{size:16}),o.get("name"))),s.a.createElement("div",{className:"lakex-viewer-kanban-field-content"},Ph("未命名记录"))):" ";const c=function(e,t){t.value,zE.isSelectLike(e.type)||zE.isImage(e.type)||zE.isSystemDate(e.type)}(o,e);return s.a.createElement("div",{key:e.fieldType+e.uuid+e.updated_at,className:qL("lakex-viewer-kanban-field",{first:0===n})},(null==r?void 0:r.get("show_field_name"))&&s.a.createElement("div",{className:"lakex-viewer-kanban-field-name"},l&&s.a.createElement(l,{size:16}),o.get("name")),s.a.createElement("div",{className:"lakex-viewer-kanban-field-content"},a?s.a.createElement(a,{readonly:!0,key:n,cell:e,field:o,fieldProps:c}):null))}))))},fye=({viewRecord:e,fields:t,viewConfig:r})=>{const n=X9(aR.TABLE).isReadonly(),{attributes:i,listeners:o,setNodeRef:a,transform:l,transition:c,isDragging:u}=HU({id:e.get("record_uuid"),disabled:n}),d={transform:y$.Transform.toString(l),transition:c,zIndex:u?"100":"auto",opacity:u?0:1};return s.a.createElement("div",{ref:n?void 0:a,className:"lakex-viewer-kanban-record-container",style:d,...i,...o},s.a.createElement(dye,{key:e.get("uuid")+e.get("updated_at"),viewRecord:e,fields:t,viewConfig:r}))},hye=({children:e,...t})=>{const[r,n]=Object(a.useState)(0),i=t["data-known-size"],o={"--child-height":`${r}px`};return Object(a.useEffect)((()=>{n((e=>0===i?e:i))}),[i]),s.a.createElement("div",{...t,className:"height-preserving-kanban-record",style:o},e)};const pye=(e,t,r,n,i)=>{const o=HL(KO),s=HL(zde),l=HL(lye),c=Object(a.useMemo)((()=>{const e=Object.keys(t),r=e.findIndex((e=>e===n));return r>-1&&(e.splice(r,1),e.unshift(n)),e}),[t]),[u,d]=Object(a.useState)(null),f=Object(a.useRef)(null),h=Object(a.useRef)(!1),p=e=>e in t?e:Object.keys(t).find((r=>t[r].map((e=>e.get("record_uuid"))).includes(e))),g=Object(a.useCallback)((e=>{var r;if(u&&u in t)return B$({...e,droppableContainers:e.droppableContainers.filter((e=>e.id in t))});const n=(e=>{let{droppableContainers:t,droppableRects:r,pointerCoordinates:n}=e;if(!n)return[];const i=[];for(const e of t){const{id:t}=e,o=r.get(t);if(o&&H$(n,o)){const r=V$(o).reduce(((e,t)=>e+D$(n,t)),0),a=Number((r/4).toFixed(4));i.push({id:t,data:{droppableContainer:e,value:a}})}}return i.sort(j$)})(e);let i=L$(n.length>0?n:z$(e),"id");if(null!=i){if(i in t){const n=t[i];n.length>0&&(i=null==(r=B$({...e,droppableContainers:e.droppableContainers.filter((e=>e.id!==i&&n.map((e=>e.get("record_uuid"))).includes(e.id)))})[0])?void 0:r.id)}return f.current=i,[{id:i}]}return h.current&&(f.current=u),f.current?[{id:f.current}]:[]}),[u,t]),v=M$(A$(OB,{activationConstraint:{distance:8}}));return{activeId:u,containers:c,sensors:v,collisionDetectionStrategy:g,onDragStart:e=>{d(e.active.id)},onDragOver:({active:e,over:n})=>{const i=null==n?void 0:n.id;if(null==i||e.id in t)return;const o=p(i),a=p(e.id);!o||!a||a!==o&&r((t=>{const r=t[a],s=t[o],l=s.map((e=>e.get("record_uuid"))).indexOf(i),c=r.map((e=>e.get("record_uuid"))).indexOf(e.id);let u;if(i in t)u=s.length+1;else{const t=n&&e.rect.current.translated&&e.rect.current.translated.top>n.rect.top+n.rect.height?1:0;u=l>=0?l+t:s.length+1}return h.current=!0,{...t,[a]:t[a].filter((t=>t.get("record_uuid")!==e.id)),[o]:[...t[o].slice(0,u),t[a][c],...t[o].slice(u,t[o].length)]}}))},onDragEnd:({active:r,over:a})=>{var c,u,f,h,g,v;if(r.id in t&&(null==a?void 0:a.id)){if(0===(null==(c=a.data.current.sortable)?void 0:c.index)&&(null==(u=null==a?void 0:a.data.current.sortable)?void 0:u.items[0])===n)return;const t=e.find((e=>{var t;return(null==(t=e.option)?void 0:t.uuid)===r.id}));return void s.updateFieldOptionOrder(null==t?void 0:t.option.field_uuid,r.id,a.id)}let y;for(const t of e)if(t.viewRecords.find((e=>e.get("record_uuid")===r.id))){y=t.id;break}if(!y)return void d(null);const b=null==a?void 0:a.id,_=p(b);if(null!=b){if(_){if((null==i?void 0:i.get("keep_sort"))&&y===_)return void m.a.warn(Ph("取消排序后，可进行拖拽"));const n=e.find((e=>e.id===y))||null,a=e.find((e=>e.id===_))||null,c=((null==n?void 0:n.viewRecords)||[]).map((e=>e.get("record_uuid"))).indexOf(r.id),u=t[_].map((e=>e.get("record_uuid"))).indexOf(b),d=r.id;let p=null==(f=null==a?void 0:a.viewRecords[u])?void 0:f.get("record_uuid");if(y===_&&c===u)return;if(y!==_){const e=u===(null==a?void 0:a.viewRecords.length),t=o.getOriginViewRecords();if(e)p=null==(h=a.viewRecords[u-1])?void 0:h.get("record_uuid");else if(p){const e=Lp(t,(e=>e.get("record_uuid")===p));p=null==(g=t.get(e+1))?void 0:g.get("record_uuid")}const r=Lp(t,(e=>e.get("record_uuid")===d)),n=Lp(t,(e=>e.get("record_uuid")===p));r<n&&(p=null==(v=t.get(n-1))?void 0:v.get("record_uuid"))}if(s.updateRecordOrder(d,p,n,a,RE.reverse),null!=i&&i.get("keep_sort")){const e=o.getGroupViewRecords(i.get("view_uuid")),{index:t,groupId:n}=l.getKanbanGroupPositionByRecordId(r.id,e);return l.scrollIntoView(n,{index:t,align:"start"}),void m.a.warn(Ph("当前处于保持排序状态，为您重新定位"))}}d(null)}else d(null)},onDragCancel:()=>{d(null)},findContainer:p,getIndex:e=>{const r=p(e);return r?t[r].map((e=>e.get("record_uuid"))).indexOf(e):-1}}},gye=s.a.forwardRef(((e,t)=>{const{isReadonly:r,kanbanService:n,kanbanGroupService:i,scrollService:o,fields:c,viewConfig:u,isEmpty:d,data:f,items:h,setItems:p,ungroupId:g,groupRef:m,SelectionContainer:v,useWindowScroll:y,customScrollParent:b,customModalContainer:_}=function({viewId:e}){const t=HL(KO),r=e7(),n=HL(jR),i=HL(Yve),o=HL(eye),s=HL(iye),{SelectionContainer:l}=HL(tre)||{},c=HL(lye),u=HL(lp),d=X9(aR.TABLE).isReadonly(),f=null==s?void 0:s.UNGROUP_KEY,h=r.groupViewRecords,p=null==s?void 0:s.toKanbanData(h),g=Object(a.useRef)({}),[m,v]=Object(a.useState)((()=>{const e={};return p.forEach((t=>{e[t.id]=t.viewRecords})),e})),[y,b]=Object(a.useState)(null==u?void 0:u.getValue("view.useWindowScroll")),_=null==u?void 0:u.getValue("view.customScrollParent"),w=(null==u?void 0:u.getValue("modal.customModalContainer"))||document.body;Object(a.useEffect)((()=>{g.current&&(null==c||c.setGroupRefs(g.current))}),[c,g]),Object(a.useEffect)((()=>{const r=n.onDataChanged((()=>{var r;if(e===(null==(r=t.getActiveView())?void 0:r.get("uuid"))){const e=t.getGroupViewRecords(),r=(null==s?void 0:s.toKanbanData(e))||[],n={};r.forEach((e=>{n[e.id]=e.viewRecords})),v(n)}}));return()=>{r.destroy()}}),[e]),Object(a.useEffect)((()=>{const e=null==u?void 0:u.onConfigurationChange((({key:e,value:t})=>{"view.useWindowScroll"===e&&b(t)}));return()=>{null==e||e.destroy()}}),[]);const C=r.group;return{isReadonly:d,ungroupId:f,fields:r.fields,viewConfig:r.viewConfig,group:C,isEmpty:!C,data:p,items:m,setItems:v,kanbanService:i,kanbanGroupService:o,scrollService:c,groupRef:g,SelectionContainer:l,useWindowScroll:y,customScrollParent:_,customModalContainer:w}}(e),{activeId:w,containers:C,sensors:E,collisionDetectionStrategy:S,onDragStart:k,onDragOver:x,onDragEnd:O,onDragCancel:I}=pye(f,h,p,g,u),R=n.Group,T=Object(a.useRef)({}),A=Object(a.useMemo)((()=>{if(w&&!C.includes(w))for(const e of Object.values(h)){const t=e.find((e=>e.get("record_uuid")===w));if(t)return t}return null}),[w,C,h]);if(Object(a.useEffect)((()=>{T.current&&(null==o||o.setVirtuosoRefs(T.current))}),[o,T]),!i)return null;let M;M=d?s.a.createElement("div",{className:"lakex-viewer-kanban-content empty"},s.a.createElement(uye,{onCreate:()=>null==i?void 0:i.createGroup()})):s.a.createElement("div",{className:"lakex-viewer-kanban-content"},s.a.createElement(lU,{sensors:E,modifiers:[qU],collisionDetection:S,measuring:{droppable:{strategy:jB.Always}},onDragStart:k,onDragOver:x,onDragEnd:O,onDragCancel:I},s.a.createElement(s.a.Fragment,null,s.a.createElement(FU,{items:C,strategy:AU},null==C?void 0:C.map((e=>{const t=f.find((t=>t.id===e));return t&&R?s.a.createElement(R,{key:e,ref:t=>{t&&(m.current[e]=t.getRecordsRef())},groupId:e,items:h[e],disableDrag:e===g,groupField:t.field,groupOption:t.option},s.a.createElement(FU,{items:h[e].map((e=>e.get("record_uuid"))),strategy:DU},s.a.createElement(vge,{useWindowScroll:y,customScrollParent:b,ref:t=>{T.current[e]=t},components:{Item:hye},data:h[e],className:"lakex-viewer-kanban-group-scorller",itemContent:(e,t)=>s.a.createElement(fye,{key:t.get("record_uuid"),viewRecord:t,fields:c,viewConfig:u})}))):null}))),Object(l.createPortal)(s.a.createElement(xU,{dropAnimation:null},A&&s.a.createElement(dye,{viewRecord:A,fields:c,viewConfig:u})),_))),!r&&s.a.createElement(cye,{groupField:i.getGroupField()}));const N=s.a.createElement("div",{ref:t,className:"lakex-viewer-kanban"},s.a.createElement("div",{className:"lakex-viewer-kanban-inner"},M));return v?s.a.createElement(v,null,N):N}));class mye extends iG{constructor(){super(...arguments),this.viewType=LE.KANBAN,this.title=Ph("看板视图"),this.desc=Ph("任务流转一目了然"),this.icon=e=>s.a.createElement(XU,{type:"KanbanView",size:16,...e}),this.colorCls="yuque-color-cyan-5",this.Component=gye}}var vye=Object.defineProperty,yye=Object.getOwnPropertyDescriptor,bye=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vye(t,r,o),o};let _ye=class{static pluginModule(){return xo().contribution(Wve).contribution(Jve).register(this).register(Yve).register(eye).register(iye).register(lye)}init(){}registerViewer(e){e.registerItem(new mye({onError:e.onError}))}registerScrollService(e){e.setKanbanScrollService(this._scrollService)}};_ye.pluginName="render-viewer-kanban",bye([ao(lye)],_ye.prototype,"_scrollService",2),_ye=bye([io({contrib:[Dz,Lz,Lte]})],_ye);const wye=e=>{var t;const{count:r=0,groupField:n,groupOption:i}=e,{isReadonly:o,getFieldComponent:l,getKanbanGroupActions:c,onOpenSetting:u}=function(e){const{groupField:t,groupOption:r}=e,n=HL(nH),i=HL(eye),o=HL(xte),s=X9(aR.TABLE).isReadonly(),l=Object(a.useCallback)((e=>{if(s)return;const n=e.target.closest(".lakex-viewer-kanban-group-header");null==o||o.showEditGroup(n,t,r)}),[t,r]);return{isReadonly:s,onOpenSetting:l,getFieldComponent:e=>n.getFieldComponent(e),getKanbanGroupActions:()=>null==i?void 0:i.getKanbanGroupActionComponents()}}(e),d=l(n.get("type"));return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-kanban-group-title"},s.a.createElement("div",{className:"lakex-table-kanban-group-title-content",onClick:u},d&&s.a.createElement(d,{readonly:!0,field:n,cell:i,checkCell:!1,writeable:!1,disableOpen:!0})),s.a.createElement("div",{className:"lakex-table-kanban-group-title-count"},r)),n&&i&&!o&&s.a.createElement("div",{className:"lakex-table-kanban-group-actions"},null==(t=c())?void 0:t.map(((e,t)=>e?s.a.createElement(e,{key:t,groupField:n,groupOption:i}):null))))},Cye=({count:e=0,groupField:t,groupOption:r})=>{const n=HL(iye),i=X9(aR.TABLE).isReadonly();return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-kanban-group-title"},s.a.createElement("div",{className:"lakex-table-kanban-group-title-content"},Ph("未分组")),s.a.createElement("div",{className:"lakex-table-kanban-group-title-count"},e)),s.a.createElement("div",{className:"lakex-table-kanban-group-actions"},!i&&s.a.createElement(p.a,{title:Ph("添加记录"),placement:"bottom",overlayClassName:"lakex-table-toolbar-tooltip"},s.a.createElement("button",{className:"lakex-table-button",onClick:()=>null==n?void 0:n.addRecord(t,r)},s.a.createElement(XU,{type:"Add"})))))},Eye=s.a.forwardRef((({groupId:e,items:t,disableDrag:r,groupField:n,groupOption:i,children:o},l)=>{const c=X9(aR.TABLE).isReadonly(),u=i&&n,d=t.length,f=Object(a.useRef)(null),{attributes:h,listeners:p,setNodeRef:g,transform:m,transition:v,isDragging:y}=HU({id:e,data:{type:"container",children:t},disabled:c||r}),b={transform:r?"":y$.Transform.toString(m),transition:y?v:"",zIndex:y?"100":"auto"};return Object(a.useImperativeHandle)(l,(()=>({getRecordsRef:()=>f.current}))),s.a.createElement("div",{ref:g,className:"lakex-viewer-kanban-group",style:b,...h},s.a.createElement("div",{className:qL("lakex-viewer-kanban-group-header",{"disable-drag":r}),...p},u?s.a.createElement(wye,{count:d,groupField:n,groupOption:i}):s.a.createElement(Cye,{count:d,groupField:n,groupOption:i})),s.a.createElement("div",{ref:f,className:"lakex-table-kanban-group-records"},o))})),Sye=({groupField:e,groupOption:t,name:r})=>{const n=HL(iye);return e&&t?s.a.createElement(p.a,{title:Ph("添加记录"),placement:"card"===r?"bottomRight":"bottom",overlayClassName:"lakex-table-toolbar-tooltip"},s.a.createElement("button",{className:"lakex-table-button",onClick:()=>null==n?void 0:n.addRecord(e,t)},s.a.createElement(XU,{type:"Add"}))):null};var kye=Object.defineProperty,xye=Object.getOwnPropertyDescriptor,Oye=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kye(t,r,o),o};let Iye=class extends fp{constructor(){super(...arguments),this._onAddGroupRecordClick=this._register(new _p),this.onAddGroupRecordClick=this._onAddGroupRecordClick.event,this._onGroupSettingClick=this._register(new _p),this.onGroupSettingClick=this._onGroupSettingClick.event}openSettingModal(e,t,r,n){this._onGroupSettingClick.emit({target:e.target,groupField:t,groupOption:r,$title:n})}destroy(){super.destroy()}};Oye([Ii()],Iye.prototype,"destroy",1),Iye=Oye([io()],Iye);const Rye=({groupField:e,groupOption:t})=>{const{onOpenSetting:r}=(({groupField:e,groupOption:t})=>{const r=HL(Iye);return{onOpenSetting:Object(a.useCallback)((n=>{const i=n.target.closest(".lakex-viewer-kanban-group-header");null==r||r.openSettingModal(n,e,t,i)}),[e,t])}})({groupField:e,groupOption:t});return e&&t?s.a.createElement("button",{className:"lakex-table-button",onClick:e=>r(e)},s.a.createElement(XU,{type:"MoreHorizontal"})):null};var Tye=Object.defineProperty,Aye=Object.getOwnPropertyDescriptor;let Mye=class{static pluginModule(){return xo().register(this).register(Iye)}getKanbanGroupActionComponent(){return[Sye,Rye]}getGroupComponent(){return Eye}};Mye.pluginName="render-viewer-kanban-group",Mye=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?Aye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Tye(t,r,o),o})([io({contrib:[Wve,Jve]})],Mye);const Nye=[y7,x7,D7,U7,J7,iee,fee,yee,See,Tee,jee,Hee,Zee,ate,pte,Cte,Rte,Fte,Fue,Kue,tde,dde,vde,wde,Dde,Vde,Kde,Xde,tfe,ofe,ffe,ive,gve,yve,wve,Hve,_ye,Mye],Dye=Object(a.forwardRef)(((e,t)=>{const r=HL(P4),n=HL(lp),i=HL(jR),o=HL(Bz),l=r.Buttons,c=dz(),u=Object(a.useRef)(null),d=Object(a.useRef)(),f=Object(a.useRef)(0);Object(a.useEffect)((()=>{const e=i.onDataLoaded((()=>{c()})),t=i.onDataChanged((()=>{c()}));return()=>{e.destroy(),t.destroy()}}),[]),Object(a.useEffect)((()=>{const e=null==o?void 0:o.onStatusChange((()=>{c()}));return()=>{null==e||e.destroy()}}),[o]),Object(a.useEffect)((()=>{if(u.current)return d.current=new ResizeObserver((e=>{const t=e[0].contentRect.height;f.current!==t&&(f.current=e[0].contentRect.height,window.dispatchEvent(new CustomEvent("lakex_table_view_resize")))})),d.current.observe(u.current),()=>{var e;null==(e=d.current)||e.disconnect()}}),[]),Object(a.useImperativeHandle)(t,(()=>({refresh:c})));const h=r.filterVisibleButtons(n.getValue("toolbar.topLeft")),p=r.filterVisibleButtons(n.getValue("toolbar.topRight")),g=r.filterVisibleButtons(n.getValue("toolbar.left")),m=r.filterVisibleButtons(null!=o&&o.isActive?n.getValue("toolbar.right"):[]),v=n.getValue("toolbar.mode"),y=0!==h.length||0!==p.length;return s.a.createElement("div",{ref:u,className:"lakex-workbench-toolbar-container"},s.a.createElement("div",{className:qL("lakex-table-workbench-toolbar",{"lakex-table-workbench-toolbar-multi-row":y})},(h.length>0||p.length>0)&&s.a.createElement("div",{className:"lakex-table-workbench-toolbar-top-section"},s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-left"},h.length>0?s.a.createElement(l,{buttons:h,mode:v}):null),s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-right"},p.length>0?s.a.createElement(l,{buttons:p,mode:v}):null)),(g.length>0||m.length>0)&&s.a.createElement("div",{className:"lakex-table-workbench-toolbar-main-section"},s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-left"},g.length>0?s.a.createElement(l,{buttons:g,mode:v}):null),s.a.createElement("div",{className:"lakex-table-workbench-toolbar-group lakex-table-workbench-toolbar-group-right"},m.length>0?s.a.createElement(l,{buttons:m,mode:v}):null))))}));var Pye=Object.defineProperty,jye=Object.getOwnPropertyDescriptor;let Fye=class{static pluginModule(){return xo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"toolbar",type:"object",title:"工具栏",properties:{left:{type:"array",description:"左侧工具栏"},right:{type:"array",description:"右侧工具栏"},topLeft:{type:"array",description:"左上工具栏"},topRight:{type:"array",description:"右上工具栏"},mode:{type:"string",description:"展示模式",enum:Object.values(V4)}}}),e.registerDefaultValue({"toolbar.mode":V4.NORMAL})}init(){}registerToolbar(e){e.registerRender(Dye)}};Fye.pluginName="workbench-toolbar",Fye=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?jye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pye(t,r,o),o})([io({contrib:[jL,j4]})],Fye);var Vye=Object.defineProperty,Lye=Object.getOwnPropertyDescriptor,$ye=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Lye(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Vye(t,r,o),o};let Bye=class{getDefaultFilter(){const e=this._readService.getActiveView();if(!e)return;const t=this._readService.getViewFilters(e.get("uuid"));let r;if(0===t.length){const t=this._readService.getViewFields(null==e?void 0:e.get("uuid"));if(!t)return;r=t.get(0).get("field")}else{const e=t.get(t.length-1).get("field_uuid");r=this._readService.getField(e)}if(!r)return;const n=this.getConditions(r.get("type"));return{uuid:To(32),field_uuid:r.get("uuid"),func:n[0].func,expected:null,operator:t.length>0?t.get(t.length-1).get("operator"):IE.And}}getFilterByFieldId(e){const t=this._readService.getField(e);if(!t)return;const r=this.getConditions(t.get("type"));return{uuid:To(32),field_uuid:t.get("uuid"),func:r[0].func,expected:null,operator:IE.And}}getConditions(e){const t=PE[e];return DE.filter((e=>e.type===t))}getMentionFieldValues(e){const t=this._readService.getFieldCells(e);let r=[];return null==t||t.forEach((e=>{Array.isArray(null==e?void 0:e.value)?r=r.concat(null==e?void 0:e.value):e.value&&r.push(e.value)})),af(r,"uid")}};$ye([ao(KO)],Bye.prototype,"_readService",2),Bye=$ye([io()],Bye);const Uye="lakex-table-filter-modal-empty",zye=()=>s.a.createElement("div",{className:Uye},s.a.createElement("div",{className:`${Uye}-desc`},Ph("还未设置任何筛选"))),Hye=e=>{const t=HL(KO),r=t.getActiveView(),n=Vp(t.getViewFields(null==r?void 0:r.get("uuid"),!1),(t=>{var r,n;return!(!e.defaultValue||(null==(r=t.get("field"))?void 0:r.get("uuid"))!==e.defaultValue)||zE.isFilter(null==(n=t.get("field"))?void 0:n.get("type"))})),i=null==t?void 0:t.getViewFieldGroups(null==r?void 0:r.get("uuid"));return{filterFields:n,groupMap:Object(a.useMemo)((()=>{const e={};return null==i||i.forEach((t=>{e[t.get("uuid")]=t})),e}),[i])}},Wye=({filter:e,bordered:t=!0,className:r,defaultValue:n="",onFieldChange:i=(()=>{})})=>{const{filterFields:o,groupMap:a}=Hye({defaultValue:n}),l=HL(nH);return s.a.createElement(S.a,{className:`lakex-table-filter-field-select ${r}`,defaultValue:n,dropdownClassName:"lakex-table-filter-field-select-dropdown",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:12}),onChange:t=>{var r;const n=Fp(o,(e=>{var r;return(null==(r=e.get("field"))?void 0:r.get("uuid"))===t}));i(e,null==(r=null==n?void 0:n.get("field"))?void 0:r.toJSON())},bordered:t},Bp(o,(e=>{var t,r,n,i,o;const c=null==l?void 0:l.getFieldIcon(null==(t=e.get("field"))?void 0:t.get("type"));return s.a.createElement(S.a.Option,{value:null==(r=e.get("field"))?void 0:r.get("uuid"),key:null==(n=e.get("field"))?void 0:n.get("uuid")},c&&s.a.createElement(c,null),s.a.createElement("div",{className:"lakex-table-filter-field-select-name"},e.get("group_uuid")?`${a[e.get("group_uuid")].name}-${null==(i=e.get("field"))?void 0:i.get("name")}`:null==(o=e.get("field"))?void 0:o.get("name")))})))},Gye=({filter:e,onFuncChange:t})=>{const r=HL(Bye),n=HL(KO),i=null==n?void 0:n.getField(e.field_uuid),o=null==r?void 0:r.getConditions(null==i?void 0:i.get("type"));return null!=o&&o.some((t=>t.func===e.func))||t(e,null==o?void 0:o[0].func),{conditions:o}},Kye=({filter:e,onFuncChange:t=(()=>{})})=>{const{conditions:r}=Gye({filter:e,onFuncChange:t});return s.a.createElement(S.a,{value:e.func||(null==r?void 0:r[0].func),dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:12}),style:{marginRight:5,width:110},onChange:r=>{t(e,r)}},null==r?void 0:r.map((e=>s.a.createElement(S.a.Option,{value:e.func,key:e.func},e.text))))},qye=({filter:e})=>{const t=HL(KO),r=HL(Bye);return{getMentionValues:()=>null==r?void 0:r.getMentionFieldValues(e.field_uuid),field:null==t?void 0:t.getField(e.field_uuid)}},Yye=({filter:e,onExpectedChange:t=(()=>{})})=>{const r=HL(KO),{getMentionValues:n,field:i}=qye({filter:e}),o=null==i?void 0:i.get("type");if(o===pE.DATE||jE.includes(e.func))return null;let a;if(o===pE.SELECT||o===pE.MULTI_SELECT){let n=(null==e?void 0:e.expected)||[];"string"==typeof(null==e?void 0:e.expected)&&(n=null==e?void 0:e.expected.split(","));const l=null==r?void 0:r.getFieldOptions(i.get("uuid")),c=Vp(l,(e=>n.includes(e.get("uuid")))).map((e=>e.get("uuid")));a=s.a.createElement(S.a,{value:c,dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:12}),onChange:n=>{if(null==n||""===n||0===n.length)return void t(e,"");if("select"===o)return void t(e,n);const i=[],a=null==r?void 0:r.getFieldOptions(e.field.uuid);null==a||a.forEach((e=>{n.includes(e.get("uuid"))&&i.push(e.uuid)})),t(e,i)},mode:"multiSelect"===o?"multiple":null},Bp(l,((e,t)=>s.a.createElement(S.a.Option,{key:t,value:e.get("uuid")},e.get("name")))))}else if("checkbox"===o)a=s.a.createElement("span",{className:"lakex-table-filter-checkbox"},s.a.createElement(h.a,{defaultChecked:!0===Boolean(e.expected),onChange:r=>{t(e,r.target.checked?"true":"false")}}));else if(zE.isMentionLike(o)){const r=n()||[],i={};null==r||r.forEach((e=>{i[e.uid]=e}));const o=null!=e&&e.expected?e.expected.split(","):[];a=s.a.createElement(S.a,{value:o,dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:12}),onChange:r=>{const n=r.map((e=>i[e]));n.sort(((e,t)=>e.name.localeCompare(t.name))),t(e,0===r.length?"":n.map((e=>e.uid)).join(","))},mode:"multiple"},null==r?void 0:r.map(((e,t)=>s.a.createElement(S.a.Option,{key:t,value:e.uid+""},s.a.createElement("span",{className:"lakex-table-selector-avatar"},s.a.createElement("img",{src:e.icon})),e.name))))}else a=s.a.createElement(GL,{placeholder:Ph("请输入"),defaultValue:e.expected,onChange:r=>{t(e,r.target.value)}});return s.a.createElement("div",{className:"lakex-table-select-expected"},a)},Jye=({index:e,filter:t,onOperatorChange:r=(()=>{})})=>{if(0===e)return s.a.createElement("div",{className:"lakex-table-filter-where"},Ph("当"));if(1===e)return s.a.createElement(S.a,{value:t.operator,dropdownClassName:"lakex-table-menu-item",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:12}),onChange:e=>{r(t,e)},style:{width:"70px",marginRight:5}},s.a.createElement(S.a.Option,{value:IE.And},Ph("并且")),s.a.createElement(S.a.Option,{value:IE.Or},Ph("或者")));const n=t.operator===IE.And?Ph("并且"):Ph("或者");return s.a.createElement("div",{className:"lakex-table-filter-where"},n)},Xye=({filter:e,index:t=0,onRemove:r=(()=>{}),onFieldChange:n=(()=>{}),onExpectedChange:i=(()=>{}),onFuncChange:o=(()=>{}),onOperatorChange:a=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-filter-item"},s.a.createElement(XU,{type:"Close",onClick:()=>{r(e)},size:14}),s.a.createElement(Jye,{index:t,filter:e,onOperatorChange:a}),s.a.createElement(Wye,{filter:e,defaultValue:e.field_uuid,onFieldChange:n}),s.a.createElement(Kye,{filter:e,onFuncChange:o}),s.a.createElement(Yye,{filter:e,onExpectedChange:i})),Zye=({onAddFilter:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-add-filter",onClick:e},s.a.createElement(XU,{type:"Add"}),Ph("添加筛选")),Qye=()=>{const e=HL(zI),t=HL(KO),r=HL(Bye),n=t.getActiveView(),i=t.getViewFilters(null==n?void 0:n.get("uuid")).toJSON(),o=t.getViewConfig(),[s,l]=Object(a.useState)(i||[]);return{state:{filters:s},fields:t.getAllFields(),onAddFilter(){const t=[...s],n=null==r?void 0:r.getDefaultFilter();!n||(t.push(n),null==e||e.execCommand("createFilter",{viewId:null==o?void 0:o.get("view_uuid"),filter:n}),l(t))},onRemoveFilter(t){const r=[...s];Jd(r,(e=>e.uuid===t.uuid)),null==e||e.execCommand("removeFilter",{filterId:t.uuid}),l(r)},onFieldChange(t,n){var i;const a=[...s];for(const s of a)if(s.uuid===t.uuid){s.field_uuid=n.uuid;const t=r.getConditions(null==n?void 0:n.type);s.func=null==(i=t[0])?void 0:i.func,s.expected=null,(null==n?void 0:n.type)===pE.CHECKBOX&&(s.expected="true"),s.field=n,null==e||e.execCommand("updateFilter",{viewId:null==o?void 0:o.get("view_uuid"),filter:s}),l(a);break}},onFuncChange(t,r){const n=[...s];for(const i of n)if(i.uuid===t.uuid){i.func=r,null==e||e.execCommand("updateFilter",{viewId:null==o?void 0:o.get("view_uuid"),filter:i}),l(n);break}},onExpectedChange(t,r){const n=[...s];for(const i of n)if(i.uuid===t.uuid){Array.isArray(r)&&(r=r.join(",")),i.expected=r,null==e||e.execCommand("updateFilter",{viewId:null==o?void 0:o.get("view_uuid"),filter:i}),l(n);break}},onOperatorChange(t,r){const n=[...s];for(const e of n)e.operator=r;null==e||e.execCommand("updateFilter",{viewId:null==o?void 0:o.get("view_uuid"),filter:n}),l(n)}}},ebe=()=>{const{state:e,onAddFilter:t,onRemoveFilter:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a}=Qye();let l;return l=0===e.filters.length?s.a.createElement(zye,null):e.filters.map(((e,t)=>s.a.createElement(Xye,{key:e.field_uuid+"_"+t,index:t,filter:e,onRemove:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a}))),s.a.createElement("div",{className:"lakex-table-filter-modal"},l,s.a.createElement(Zye,{onAddFilter:t}))},tbe=e=>e.showCloseIcon||e.title?s.a.createElement("div",{className:"lakex-table-ui-popup-header",onClick:e.onClose},e.title&&s.a.createElement("h1",{className:"lakex-table-ui-popup-header-title"},e.title),e.showCloseIcon&&s.a.createElement(XU,{className:"lakex-table-ui-popup-close-icon",type:"Close",size:18})):null,rbe=({title:e,showCloseIcon:t,onClose:r,children:n})=>s.a.createElement("div",{className:qL("lakex-table-ui-popup")},s.a.createElement(tbe,{title:e,onClose:r,showCloseIcon:!!t}),s.a.createElement("div",{className:qL("lakex-table-ui-popup-content")},n)),nbe=e=>{const t={maxWidth:e.maxWidth,...e.style&&e.style};return s.a.createElement("span",{style:t,className:qL("lakex-table-ui-text-ellipsis",e.className)},e.children)},ibe=e=>s.a.createElement(k.a,{...e,className:qL("lakex-table-h5-switch",e.className)}),obe=({options:e,className:t,style:r,onChange:n,defaultValue:i})=>{const[o,l]=Object(a.useState)(i),c={...r&&r};(!Array.isArray(e)||2!==e.length)&&console.error("options length is valid!");return s.a.createElement("div",{style:c,className:qL("lakex-table-h5-choose",t)},e.map((e=>s.a.createElement("div",{key:e.value,className:qL("lakex-table-h5-choose-item",o===e.value&&"active"),onClick:()=>(e=>{l(e.value),n(e)})(e)},s.a.createElement("span",{className:"lakex-table-h5-choose-item-desc"},e.label)))))},abe=e=>{const[t,r]=Object(a.useState)(e.list);return s.a.createElement("ul",{className:"lakex-table-ui-list-switch"},t.map((n=>s.a.createElement("li",{className:"lakex-table-ui-item-switch",key:n.key},s.a.createElement("div",{className:"lakex-table-ui-item-left"},n.icon,s.a.createElement(nbe,{className:"lakex-table-ui-item-name"},null==n?void 0:n.title)),s.a.createElement(ibe,{disabled:n.disabled,checked:n.checked,onChange:i=>{n.checked=i,e.onSwitch(n,i),r([...t])}})))))},sbe=e=>{const[t,r]=Object(a.useState)(e.defaultValue);return s.a.createElement("ul",{className:"lakex-table-ui-list-check"},e.list.map((n=>{const i=Array.isArray(t)?t.includes(n.key):n.key===t;return s.a.createElement("li",{className:"lakex-table-ui-item-check",key:n.key,onClick:()=>{if(e.multiple){const i=[...t],o=i.findIndex((e=>e===n.key));o>-1?i.splice(o,1):i.push(n.key),r(i),e.onCheck(e.list.filter((e=>i.includes(e.key))))}else r(n.key),e.onCheck(n)}},s.a.createElement("div",{className:"lakex-table-ui-item-left"},n.icon,s.a.createElement(nbe,{className:"lakex-table-ui-item-name"},null==n?void 0:n.title)),i&&s.a.createElement(XU,{type:"Check",size:"16"}))})))},lbe=e=>{const[t,r]=Object(a.useState)(e.list);return s.a.createElement("ul",{className:"lakex-table-ui-list-choose"},t.map((n=>s.a.createElement("li",{className:"lakex-table-ui-item-choose",key:n.key},s.a.createElement("div",{className:"lakex-table-ui-item-left"},s.a.createElement(nbe,{className:"lakex-table-ui-item-name"},null==n?void 0:n.title)),s.a.createElement(obe,{defaultValue:n.defaultValue,options:n.options,onChange:i=>{n.defaultValue=i.value,e.onChoose(n,i),r([...t])}})))))},cbe=e=>{const[t,r]=Object(a.useState)(e.list);return Object(a.useEffect)((()=>{r(e.list)}),[e.list]),s.a.createElement("ul",{className:"lakex-table-ui-list-select"},t.map((t=>{const r=t.options.find((e=>e.value===t.defaultValue));return s.a.createElement("li",{className:"lakex-table-ui-item-select",key:t.key},s.a.createElement("div",{className:"lakex-table-ui-item-left"},s.a.createElement(nbe,{className:"lakex-table-ui-item-name"},t.title)),s.a.createElement("div",{className:"lakex-table-ui-item-right",onClick:()=>{e.onSelect(t)}},s.a.createElement(nbe,{className:"lakex-table-ui-item-name"},(null==r?void 0:r.label)||""),s.a.createElement(XU,{type:"ArrowRight",size:18})))})))},ube=e=>{const t={...e.style&&e.style};return s.a.createElement("div",{className:qL("lakex-table-empty-no-data",e.className),style:t},s.a.createElement("div",{className:"intrinsic-aspect-ratio-container"},s.a.createElement("div",{className:"lakex-table-empty-no-data-inner"})),e.desc&&s.a.createElement("p",{className:"lakex-table-empty-no-data-desc"},e.desc),e.children&&e.children)},dbe=e=>{const{text:t="",prefixIcon:r="",className:n,style:i={},border:o,children:a,autoWrap:l}=e;return s.a.createElement("div",{className:qL("lakex-table-select-bar",o&&"lakex-table-select-bar-has-border",l&&"lakex-table-select-bar-auto-wrap",n),onClick:e.onClick,style:i},r&&s.a.createElement("span",{className:"prefix-icon"},r),a||s.a.createElement(nbe,{className:"lakex-table-select-bar-text"},t),s.a.createElement(XU,{type:"ArrowDown",className:"arrow-down"}))};dbe.defaultProps={border:!0,autoWrap:!1};const fbe=({option:e,style:t,className:r})=>{const n=HL(KD),i={...t&&t,...e.color?{background:n.getRenderColor(e.color),color:n.getRenderTextColor(e.color)}:{}};return s.a.createElement(nbe,{className:qL("lakex-table-select-tag",r),style:i},e.value)},hbe=({mention:e,style:t,className:r})=>{const n={...t&&t};return s.a.createElement("div",{className:qL("lakex-table-mention-tag",r),style:n},s.a.createElement("img",{className:"lakex-table-mention-tag-avatar",src:e.avatar_url,alt:"avatar"}),s.a.createElement(nbe,{className:"lakex-table-mention-tag-name"},e.name))},pbe=({onAddFilter:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-h5-empty"},s.a.createElement(ube,{desc:Ph("你还未进行任何筛选"),className:"no-data"}),s.a.createElement(b.a,{type:"primary",onClick:()=>e(),className:"no-data-btn"},s.a.createElement(XU,{type:"Add"}),Ph("添加筛选条件"))),gbe=({index:e,filter:t,onOperatorChange:r=(()=>{})})=>{const n=HL(lp),i=HL(c8),o=n.getValue("modal.mode"),l=Object(a.useCallback)((()=>{i.close("filter-select-operator")}),[]);if(0===e)return s.a.createElement("div",{className:"lakex-table-h5-filter-where"},Ph("当"));const c=t.operator===IE.And?Ph("并且"):Ph("或者");return s.a.createElement("div",{className:"lakex-table-h5-filter-where"},s.a.createElement(dbe,{className:"lakex-table-h5-filter-col",text:c,onClick:()=>{i.open("filter-select-operator",{initialState:{value:t.operator}})}}),s.a.createElement(U8,{id:"filter-select-operator",mode:o,hasMask:o===l8.DRAWER,hasAnimation:o===l8.DRAWER,position:o===l8.DRAWER?{placement:"bottom"}:void 0,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:e})=>s.a.createElement(rbe,{title:Ph("请选择"),onClose:l,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:e.value,list:[{key:IE.And,title:Ph("并且")},{key:IE.Or,title:Ph("或者")}],onCheck:e=>{l(),r(t,e.key)}}))}))},mbe=({filter:e,className:t="",defaultValue:r="",onFieldChange:n=(()=>{})})=>{const{filterFields:i,groupMap:o}=Hye({defaultValue:r}),l=HL(lp),c=HL(KO),u=HL(c8),d=l.getValue("modal.mode"),f=HL(nH),h=Object(a.useCallback)((()=>{u.close("filter-field-select")}),[]),p=c.getField(null==e?void 0:e.field_uuid)||(null==i?void 0:i.get(0).get("field"));if(!p)return null;const g=null==f?void 0:f.getFieldIcon(null==p?void 0:p.get("type"));return s.a.createElement("div",{className:t},s.a.createElement(dbe,{prefixIcon:g,className:"lakex-table-h5-filter-col",text:p.get("name"),onClick:()=>{u.open("filter-field-select",{initialState:{value:r}})}}),s.a.createElement(U8,{id:"filter-field-select",mode:d,hasMask:d===l8.DRAWER,hasAnimation:d===l8.DRAWER,position:d===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:t})=>s.a.createElement(rbe,{title:Ph("请选择"),onClose:h,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:t.value,list:Bp(i,(e=>{var t;const r=null==f?void 0:f.getFieldIcon(null==(t=e.get("field"))?void 0:t.get("type"));return{key:e.get("field").get("uuid"),title:e.get("group_uuid")?`${o[e.get("group_uuid")].name}-${e.get("field").get("name")}`:e.get("field").get("name"),icon:r&&s.a.createElement(r,null)}})),onCheck:t=>{var r;const o=Fp(i,(e=>{var r;return(null==(r=e.get("field"))?void 0:r.get("uuid"))===t.key}));n(e,null==(r=null==o?void 0:o.get("field"))?void 0:r.toJSON()),h()}}))}))},vbe=({filter:e,className:t="",onFuncChange:r=(()=>{})})=>{var n;const{conditions:i}=Gye({filter:e,onFuncChange:r}),o=HL(lp),l=HL(c8),c=o.getValue("modal.mode"),u=Object(a.useCallback)((()=>{l.close("filter-func-select")}),[]),d=e.func||(null==i?void 0:i[0].func),f=(null==(n=null==i?void 0:i.find((e=>e.func===d)))?void 0:n.text)||(null==i?void 0:i[0].text);return s.a.createElement("div",{className:t},s.a.createElement(dbe,{className:"lakex-table-h5-filter-func",text:f,onClick:()=>{l.open("filter-func-select",{initialState:{value:d}})}}),s.a.createElement(U8,{id:"filter-func-select",mode:c,hasMask:c===l8.DRAWER,hasAnimation:c===l8.DRAWER,position:c===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:t})=>s.a.createElement(rbe,{title:Ph("请选择"),onClose:u,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:t.value,list:i.map((e=>({key:e.func,title:e.text}))),onCheck:t=>{r(e,t.key),u()}}))}))},ybe=({filter:e,onExpectedChange:t=(()=>{})})=>{const{getMentionValues:r,field:n}=qye({filter:e}),i=HL(lp),o=HL(c8),a=HL(KO),l=i.getValue("modal.mode"),c=n.get("type");if(c===pE.DATE||jE.includes(e.func))return null;let u;if(c===pE.SELECT||c===pE.MULTI_SELECT){let r=(null==e?void 0:e.expected)||[];"string"==typeof(null==e?void 0:e.expected)&&(r=null==e?void 0:e.expected.split(","));const i=a.getFieldOptions(n.get("uuid")),d=Vp(i,(e=>r.includes(e.get("uuid")))),f=Bp(d,(e=>e.get("uuid")));u=s.a.createElement(s.a.Fragment,null,s.a.createElement(dbe,{className:"lakex-table-h5-filter-col",text:Bp(d,(e=>e.get("name"))).join(", "),onClick:()=>{o.open("filter-expected-select",{initialState:{value:f}})}},(!f||!f.length)&&s.a.createElement("span",{className:"lakex-table-h5-condition-placeholder"},Ph("请选择"))),s.a.createElement(U8,{id:"filter-expected-select",mode:l,hasMask:l===l8.DRAWER,hasAnimation:l===l8.DRAWER,position:l===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:r})=>s.a.createElement(rbe,{title:Ph("请选择"),onClose:()=>{o.close("filter-expected-select")},showCloseIcon:!0},s.a.createElement(sbe,{multiple:c===pE.MULTI_SELECT,defaultValue:null==r?void 0:r.value,list:Bp(i,(e=>({key:e.get("uuid"),title:s.a.createElement(fbe,{option:{color:e.get("color"),value:e.get("name")}})}))),onCheck:r=>{if(null==r||""===r||0===r.length)return void t(e,"");if("select"===c)return t(e,r.key),void o.close("filter-expected-select");const n=[];i.forEach((e=>{r.some((t=>t.key===e.uuid))&&n.push(e.uuid)})),t(e,n)}}))}))}else if("checkbox"===c)u=s.a.createElement("span",{className:"lakex-table-h5-filter-checkbox"},s.a.createElement(h.a,{defaultChecked:!0===Boolean(e.expected),onChange:r=>{t(e,r.target.checked?"true":"false")}}));else if(zE.isMentionLike(c)){const n=r()||[],i={};null==n||n.forEach((e=>{i[e.uid]=e}));const a=null!=e&&e.expected?e.expected.split(","):[];u=s.a.createElement(s.a.Fragment,null,s.a.createElement(dbe,{className:"lakex-table-h5-filter-col",text:a.map((e=>i[e])).map((e=>e.name)).join(", "),onClick:()=>{o.open("filter-expected-mention",{initialState:{value:a}})}},(!a||!a.length)&&s.a.createElement("span",{className:"lakex-table-h5-condition-placeholder"},Ph("请选择"))),s.a.createElement(U8,{id:"filter-expected-mention",mode:l,hasMask:l===l8.DRAWER,hasAnimation:l===l8.DRAWER,position:l===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:r})=>s.a.createElement(rbe,{title:Ph("请选择"),onClose:()=>{o.close("filter-expected-mention")},showCloseIcon:!0},n.length?s.a.createElement(sbe,{multiple:!0,defaultValue:null==r?void 0:r.value,list:n.map(((e,t)=>({key:String(e.uid),title:s.a.createElement(hbe,{mention:{avatar_url:e.icon,name:e.name}})}))),onCheck:r=>{null!=r&&""!==r&&0!==r.length?t(e,0===r.length?"":r.map((e=>e.key)).join(",")):t(e,"")}}):s.a.createElement(ube,{desc:Ph("暂无人员")}))}))}else u=s.a.createElement(GL,{className:"lakex-table-h5-filter-expected-input",placeholder:Ph("请输入"),defaultValue:e.expected,onChange:r=>{t(e,r.target.value)}});return s.a.createElement("div",{className:"lakex-table-h5-filter-expected"},u)},bbe=e=>{const{filter:t,index:r,onRemove:n,onOperatorChange:i,onFieldChange:o,onFuncChange:a,onExpectedChange:l}=e;return s.a.createElement("div",{className:"lakex-table-h5-filter-item",key:r},s.a.createElement(gbe,{index:r,filter:t,onOperatorChange:i}),s.a.createElement("div",{className:"lakex-table-h5-filter-item-content"},s.a.createElement("div",{className:"lakex-table-h5-filter-item-content-inner"},s.a.createElement("div",{className:"lakex-table-h5-filter-item-content-head"},s.a.createElement(mbe,{className:"lakex-table-h5-filter-item-field",filter:t,defaultValue:t.field_uuid,onFieldChange:o}),s.a.createElement(vbe,{className:"lakex-table-h5-filter-item-func",filter:t,onFuncChange:a})),s.a.createElement("div",null,s.a.createElement(ybe,{filter:t,onExpectedChange:l}))),s.a.createElement(XU,{type:"Delete",size:18,onClick:()=>{n(t)}})))},_be=e=>{const{state:t,onRemoveFilter:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a,onAddFilter:l}=Qye(),c=HL(c8);return s.a.createElement(rbe,{title:Ph("筛选"),onClose:()=>{null==c||c.close("filter")},showCloseIcon:!0},0===t.filters.length?s.a.createElement(pbe,{onAddFilter:l}):s.a.createElement("div",{className:"lakex-table-h5-filter"},t.filters.map(((e,t)=>s.a.createElement(bbe,{key:e.field_uuid+"_"+t,index:t,filter:e,onRemove:r,onFieldChange:n,onFuncChange:i,onExpectedChange:o,onOperatorChange:a}))),s.a.createElement(b.a,{className:"lakex-table-h5-filter-add",onClick:()=>l()},s.a.createElement(XU,{type:"Add"}),Ph("添加筛选条件"))))};var wbe=Object.defineProperty,Cbe=Object.getOwnPropertyDescriptor,Ebe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Cbe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wbe(t,r,o),o};let Sbe=class{constructor(){this._getTitle=()=>{const e=this._readService.getActiveView();if(!e)return Ph("筛选");const t=this._readService.getViewFilters(e.get("uuid"));return t&&0!==t.length?Ph("$1个筛选",t.length):Ph("筛选")},this._getActive=()=>{const e=this._readService.getActiveView();if(!e)return!1;const t=this._readService.getViewFilters(e.get("uuid"));return t&&t.length>0}}static pluginModule(){return xo().register(Bye).register(this)}init(){}registerToolbar(e){e.registerItem({id:"filter",icon:"ViewerFilter",tooltip:this._getTitle,visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))!==LE.FORM},active:this._getActive,onClick:e=>{const t=e.target;this._modalService.open("filter",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"filter",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER?{placement:"bottom"}:void 0,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?_be:ebe})}registerContextMenu(e){e.registerItem({key:"filterByField",name:({fieldId:e})=>{const t=this._readService.getActiveView();return Fp(this._readService.getViewFilters(null==t?void 0:t.get("uuid")),(t=>t.get("field_uuid")===e))?Ph("取消筛选"):Ph("按本列筛选")},icon:"ViewerFilter",hotkey:"",visible:({from:e})=>e===Xue.HEADER,onClick:({initialState:e})=>{var t,r;const{fieldId:n}=e,i=this._readService.getActiveView(),o=Fp(this._readService.getViewFilters(null==i?void 0:i.get("uuid")),(e=>e.get("field_uuid")===n));let a=null;if(o)a=null==(t=this._commandService)?void 0:t.execCommand("removeFilter",{filterId:o.get("uuid")});else{const e=this._filterService.getFilterByFieldId(n);a=null==(r=this._commandService)?void 0:r.execCommand("createFilter",{viewId:null==i?void 0:i.get("uuid"),filter:e});const t=this._workbenchContext.$root.querySelector("#filter");t&&this._modalService.open("filter",{position:{origin:t,placement:"bottom"}})}null!=a&&a.isSuccess?this._modalService.close("context-menu-modal"):null!=a&&a.error&&m.a.error(a.error.message)}})}};Sbe.pluginName="workbench-filter",Ebe([ao(c8)],Sbe.prototype,"_modalService",2),Ebe([ao(KO)],Sbe.prototype,"_readService",2),Ebe([ao(zI)],Sbe.prototype,"_commandService",2),Ebe([ao(Bye)],Sbe.prototype,"_filterService",2),Ebe([ao(BL)],Sbe.prototype,"_workbenchContext",2),Ebe([ao(lp)],Sbe.prototype,"_configuration",2),Sbe=Ebe([io({contrib:[jL,j4,u8,yme]})],Sbe);const kbe=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{groupField:r,groupOption:n,color:i,onSubmit:o,defaultColor:l}=e,{inputRef:c,state:d,labelColor:h,onChange:p,onChangeColor:g,onPressEnter:m}=(({groupField:e,groupOption:t,defaultColor:r,onSubmit:n,ref:i})=>{const o=HL(KD),[s,l]=Object(a.useState)((null==t?void 0:t.color)||r||KD.getNextColor("")),[c,u]=Object(a.useState)(null==t?void 0:t.name),d=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e;l((null==t?void 0:t.color)||r||KD.getNextColor("")),u(null==t?void 0:t.name),null==(e=d.current)||e.focus()}),[null==t?void 0:t.color,null==t?void 0:t.name]);const f=Object(a.useCallback)((()=>{null==n||n({fieldId:e.get("uuid"),fieldOption:{name:c,color:s}})}),[e.get("uuid"),c,s]);return Object(a.useImperativeHandle)(i,(()=>({onSubmit:()=>{f()}}))),{inputRef:d,state:{name:c,optionColor:s},labelColor:o,onPressEnter:f,onChange:e=>{u(e.target.value)},onChangeColor:e=>{l(e)}}})({groupField:r,groupOption:n,defaultColor:l,onSubmit:o,ref:t});let v=null;return i&&(v=s.a.createElement(f.a,{placement:"leftTop",overlayClassName:"lakex-table-colorpicker",content:s.a.createElement(WL,{colorSource:[...$D],activeColor:d.optionColor,onSelect:g})},s.a.createElement("span",{className:"lakex-table-group-item-option-color",style:{background:h.getRenderColor(d.optionColor)}}))),s.a.createElement("div",{className:"lakex-table-group-item-input"},s.a.createElement("span",{className:"lakex-table-group-item-input-content"},v,s.a.createElement(u.a,{ref:c,value:d.name,onChange:e=>{p(e)},onPressEnter:()=>{m()},autoFocus:!0})))}))),xbe=({groupField:e,groupOption:t={},onSubmit:r})=>s.a.createElement("div",{className:"lakex-table-group-item-mention"},s.a.createElement(i4,{id:e.get("uuid"),defaultValue:(null==t?void 0:t.value)||[],onChange:n=>{const i=n.map((e=>e.uid)).join(",");null==r||r({fieldId:e.get("uuid"),fieldOption:{...t,uuid:i,name:i,value:i,users:n}})}})),Obe=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{var r;const n=e.initialState.groupField,{field:i,fieldType:o,fieldOptions:l}=r7(n.get("uuid")),c=HL(zI),u=HL(c8),d=Object(a.useRef)(null),f=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(({fieldId:e,fieldOption:t})=>{const r=c.execCommand("createFieldOption",{fieldId:e,fieldOption:t});null!=r&&r.isSuccess?u.close("addGroupItem"):null!=r&&r.error&&m.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]),h=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(({fieldId:e,fieldOption:t})=>{if(!t.name)return;const r=c.execCommand("createFieldOption",{fieldId:e,fieldOption:t});null!=r&&r.isSuccess?u.close("addGroupItem"):null!=r&&r.error&&m.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]);if(Object(a.useImperativeHandle)(t,(()=>({onCloseByClickAwayOrScroll:()=>{var e;o===pE.SELECT&&(null==(e=d.current)||e.onSubmit())}}))),o===pE.MENTION)return s.a.createElement(xbe,{groupField:i,onSubmit:f});const p=KD.getNextColor((null==(r=null==l?void 0:l.get(l.length-1))?void 0:r.get("color"))||"");return s.a.createElement(kbe,{ref:d,groupField:i,color:null==n?void 0:n.get("color"),defaultColor:p,onSubmit:h})}))),Ibe=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{var r,n;const i=null==(r=e.initialState)?void 0:r.groupField,o=null==(n=e.initialState)?void 0:n.groupOption,l=HL(zI),c=HL(c8),u=Object(a.useRef)(null),d=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(({fieldId:e,fieldOption:t})=>{const r=l.execCommand("updateFieldOption",{optionId:o.uuid,fieldOption:t});null!=r&&r.isSuccess&&c.close("editGroupItem"),null!=r&&r.error&&m.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]),f=Object(a.useCallback)((({fieldId:e,fieldOption:t})=>{(({fieldId:e,fieldOption:t})=>{if(t.name===o.name&&t.color===o.color)return void c.close("editGroupItem");const r=l.execCommand("updateFieldOption",{optionId:o.uuid,fieldOption:t});null!=r&&r.isSuccess?c.close("editGroupItem"):null!=r&&r.error&&m.a.error(r.error.message)})({fieldId:e,fieldOption:t})}),[]);return Object(a.useImperativeHandle)(t,(()=>({onCloseByClickAwayOrScroll:()=>{var e;i.get("type")===pE.SELECT&&(null==(e=u.current)||e.onSubmit())}}))),i.get("type")===pE.MENTION?s.a.createElement(xbe,{groupField:i,groupOption:o,onSubmit:d}):s.a.createElement(kbe,{ref:u,groupField:i,groupOption:o,color:null==i?void 0:i.get("color"),onSubmit:f})})));var Rbe=Object.defineProperty,Tbe=Object.getOwnPropertyDescriptor,Abe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Tbe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Rbe(t,r,o),o};let Mbe=class{static pluginModule(){return xo().register(this)}init(){var e,t;null==(e=this._groupItemService)||e.onShowEditGroup((({target:e,groupField:t,groupOption:r})=>{var n;null==(n=this._modalService)||n.open("editGroupItem",{position:{origin:e,placement:"cover"},initialState:{groupField:t,groupOption:r}})})),null==(t=this._groupItemService)||t.onShowNewGroup((({target:e,groupField:t})=>{var r;null==(r=this._modalService)||r.open("addGroupItem",{position:{origin:e,placement:"cover"},initialState:{groupField:t}})}))}registerModal(e){e.registerItem({id:"addGroupItem",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:Obe}),e.registerItem({id:"editGroupItem",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:Ibe})}registerContextMenu(e){e.registerItem({key:"groupByField",name:({fieldId:e})=>{const t=this._readService.getActiveView(),r=this._readService.getViewGroup(null==t?void 0:t.get("uuid"));return r&&r.field.get("uuid")===e?Ph("取消分组"):Ph("按本列分组")},icon:"ViewerGroup",hotkey:"",visible:({from:e})=>e===Xue.HEADER,onClick:({initialState:e})=>{var t,r,n;const i=this._readService.getActiveView(),{fieldId:o}=e;if(!i)return;const a=this._readService.getViewGroup(i.get("uuid")),s=a&&a.field.get("uuid")===o;let l=null;l=a?s?null==(r=this._commandService)?void 0:r.execCommand("removeGridGroup",{viewId:i.get("uuid")}):null==(n=this._commandService)?void 0:n.execCommand("updateGridGroup",{viewId:i.get("uuid"),group:{field_uuid:o,type:NE.ASC}}):null==(t=this._commandService)?void 0:t.execCommand("createGridGroup",{viewId:i.get("uuid"),group:{field_uuid:o,type:NE.ASC}}),null!=l&&l.isSuccess?this._modalService.close("context-menu-modal"):null!=l&&l.error&&m.a.error(l.error.message)}})}};Mbe.pluginName="workbench-group",Abe([ao(xte),cN()],Mbe.prototype,"_groupItemService",2),Abe([ao(c8)],Mbe.prototype,"_modalService",2),Abe([ao(KO)],Mbe.prototype,"_readService",2),Abe([ao(zI)],Mbe.prototype,"_commandService",2),Mbe=Abe([io({contrib:[jL,u8,yme]})],Mbe);const Nbe=({className:e,defaultValue:t="",onFieldSelect:r=(()=>{})})=>{const{sortFields:n,groupMap:i}=(e=>{const t=HL(KO),r=null==t?void 0:t.getActiveView(),n=Vp(null==t?void 0:t.getViewFields(null==r?void 0:r.get("uuid"),!1),(t=>{var r,n;return!(!e.defaultValue||(null==(r=t.get("field"))?void 0:r.get("uuid"))!==e.defaultValue)||zE.isSort(null==(n=t.get("field"))?void 0:n.get("type"))})),i=null==t?void 0:t.getViewFieldGroups(null==r?void 0:r.get("uuid"));return{sortFields:n,groupMap:Object(a.useMemo)((()=>{const e={};return null==i||i.forEach((t=>{e[t.get("uuid")]=t})),e}),[i])}})({defaultValue:t}),o=HL(nH);return s.a.createElement(S.a,{className:`lakex-table-sort-field-select ${e}`,defaultValue:t,dropdownClassName:"lakex-table-sort-field-select-dropdown",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:12}),onChange:e=>{const t=Fp(n,(t=>t.get("field_uuid")===e));r(null==t?void 0:t.get("field"))},bordered:!1},Bp(n,(e=>{var t,r,n,a,l;const c=null==o?void 0:o.getFieldIcon(null==(t=e.get("field"))?void 0:t.get("type"));return s.a.createElement(S.a.Option,{value:null==(r=e.get("field"))?void 0:r.get("uuid"),key:null==(n=e.get("field"))?void 0:n.get("uuid")},c&&s.a.createElement(c,null),s.a.createElement("div",{className:"lakex-table-sort-field-select-name"},e.get("group_uuid")?`${i[e.get("group_uuid")].name}-${null==(a=e.get("field"))?void 0:a.get("name")}`:null==(l=e.get("field"))?void 0:l.get("name")))})))},Dbe="lakex-table-sort-modal-empty",Pbe=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:Dbe},s.a.createElement("div",{className:`${Dbe}-empty-desc`},Ph("还未设置任何排序")),s.a.createElement(Nbe,{defaultValue:Ph("选择一列进行排序"),onFieldSelect:e})),jbe=({auto:e=!1,onUpdateAuto:t=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-sort-setting"},s.a.createElement("h2",{className:"lakex-table-sort-setting-title"},Ph("排序设置")),s.a.createElement("div",{className:"lakex-table-sort-setting-action"},s.a.createElement("span",null,Ph("保持排序")),s.a.createElement(k.a,{checked:e,onChange:t,size:"small"}))),Fbe=e=>{switch(e){case"select":case"multiSelect":return{asc:Ph("选项顺序"),desc:Ph("选项倒序")};case"number":case"phone":return{asc:Ph("从小到大"),desc:Ph("从大到小")};default:return{asc:Ph("升序"),desc:Ph("降序"),style:{padding:"0 16px"}}}},Vbe=({sort:e,field:t,onUpdateType:r=(()=>{})})=>{if(!t)return null;if(zE.isCheckbox(t.type))return s.a.createElement(g.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(g.a.Button,{value:"asc"},s.a.createElement("span",{className:"lakex-table-sort-field-order-radio"},s.a.createElement(h.a,{checked:!1},s.a.createElement(XU,{type:"RightArrow"})),s.a.createElement(h.a,{checked:!0}))),s.a.createElement(g.a.Button,{value:"desc"},s.a.createElement("span",{className:"lakex-table-sort-field-order-radio"},s.a.createElement(h.a,{checked:!0},s.a.createElement(XU,{type:"RightArrow"})),s.a.createElement(h.a,{checked:!1}))));const n=Fbe(t.type);return s.a.createElement(g.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(g.a.Button,{value:"asc"},s.a.createElement("span",{style:n.style},n.asc)),s.a.createElement(g.a.Button,{value:"desc"},s.a.createElement("span",{style:n.style},n.desc)))},Lbe=({sort:e,field:t,onRemove:r=(()=>{}),onChange:n=(()=>{}),onUpdateType:i=(()=>{})})=>{const{state:o,onFieldSelect:l}=(({field:e,onChange:t})=>{const[r,n]=Object(a.useState)(e);return{state:{activeField:r},onFieldSelect(e){t(e.get("uuid")),n(e)}}})({field:t,onChange:n});return s.a.createElement("div",{className:"lakex-table-sort-item"},s.a.createElement(XU,{type:"Close",onClick:()=>{r(e)}}),s.a.createElement(Nbe,{defaultValue:null==t?void 0:t.get("uuid"),onFieldSelect:l,className:"lakex-table-sort-item-select"}),s.a.createElement(Vbe,{sort:e,field:o.activeField,onUpdateType:i}))},$be=({onCancel:e=(()=>{}),onSubmit:t=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-sort-footer"},s.a.createElement(b.a,{onClick:e},Ph("取消")),s.a.createElement(b.a,{type:"primary",onClick:t},Ph("确定"))),Bbe=e=>{var t;const r=HL(c8),n=HL(zI),i=HL(KO),o=(null==(t=i.getViewSort())?void 0:t.toJSON())||(null==e?void 0:e.sort),s=i.getViewConfig(),l=i.getView(),[c,u]=Object(a.useState)(o),[d,f]=Object(a.useState)(!(null==s||!s.get("keep_sort"))),h=e=>{if(l)return e?o?null==n?void 0:n.execCommand("updateSort",{viewId:null==s?void 0:s.get("view_uuid"),sort:e,auto:d}):null==n?void 0:n.execCommand("createSort",{viewId:null==s?void 0:s.get("view_uuid"),sort:e}):null==n?void 0:n.execCommand("removeSort",{viewId:null==s?void 0:s.get("view_uuid")})},p=i.getAllFields(),g=Object(a.useCallback)((()=>c?Fp(p,(e=>e.get("uuid")===c.field_uuid)):null),[c,p]);return{state:{sort:c,auto:d},fields:p,getCurrnetSortField:g,onAddOption(e){e||(e=i.getViewFields().get(0).get("field"));const t={field_uuid:null==e?void 0:e.get("uuid"),type:jN.ASC};if(d)return h(t),void u(t);u(t)},onRemoveOption(){if(d)return h(null),void u(null);u(null)},onUpdateOption(e){const t={field_uuid:e,type:(null==c?void 0:c.type)||jN.ASC};if(d)return h(t),void u(t);u(t)},onUpdateType(e){const t={field_uuid:null==c?void 0:c.field_uuid,type:e};if(d)return h(t),void u(t);u(t)},onUpdateAuto(e){if(d!==e)return null==n||n.execCommand("updateSort",{viewId:null==s?void 0:s.get("view_uuid"),sort:c,auto:e}),void f(e);f(e)},onCancel(){r.close("sort")},onSubmit(){h(c),r.close("sort")}}},Ube=()=>{const{state:e,fields:t,onCancel:r,onSubmit:n,onAddOption:i,onUpdateOption:o,onRemoveOption:a,onUpdateType:l,onUpdateAuto:c}=Bbe();let u;if(e.sort){const i=Fp(t,(t=>{var r;return t.get("uuid")===(null==(r=e.sort)?void 0:r.field_uuid)}));u=s.a.createElement(s.a.Fragment,null,s.a.createElement(jbe,{auto:e.auto,onUpdateAuto:c}),s.a.createElement(Lbe,{field:i,sort:e.sort,onRemove:a,onChange:o,onUpdateType:l}),!e.auto&&s.a.createElement($be,{onCancel:r,onSubmit:n}))}else u=s.a.createElement(s.a.Fragment,null,s.a.createElement(Pbe,{onAddOption:i}),!e.auto&&s.a.createElement($be,{onCancel:r,onSubmit:n}));return s.a.createElement("div",{className:"lakex-table-sort-modal"},u)},zbe=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-h5-empty"},s.a.createElement(ube,{desc:Ph("你还未进行任何排序"),className:"no-data"}),s.a.createElement(b.a,{type:"primary",onClick:()=>e(),className:"no-data-btn"},s.a.createElement(XU,{type:"Add"}),Ph("添加排序条件"))),Hbe=e=>{const{state:t,onCancel:r,onSubmit:n,onAddOption:i,onUpdateOption:o,onRemoveOption:l,onUpdateType:c,onUpdateAuto:u,getCurrnetSortField:d}=Bbe(),f=HL(lp),h=HL(c8),p=f.getValue("modal.mode"),g=HL(KO),m=HL(nH),v=Object(a.useMemo)((()=>null==g?void 0:g.getViewFields()),[]);return s.a.createElement(rbe,{title:Ph("排序"),onClose:r,showCloseIcon:!0},(()=>{if(!t.sort)return s.a.createElement(zbe,{onAddOption:i});const e=d(),r=Fbe(null==e?void 0:e.get("type")),a=null==m?void 0:m.getFieldIcon(null==e?void 0:e.get("type"));return s.a.createElement("div",{className:"lakex-table-h5-sort"},s.a.createElement("div",{className:"lakex-table-h5-sort-tip"},Ph("按以下选项进行排序")),s.a.createElement(dbe,{prefixIcon:a,className:"lakex-table-h5-filter-col",text:null==e?void 0:e.get("name"),onClick:()=>{null==h||h.open("sort-select",{initialState:{sort:t.sort}})}}),s.a.createElement(U8,{id:"sort-select",mode:p,hasMask:p===l8.DRAWER,hasAnimation:p===l8.DRAWER,position:p===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:e})=>{var t;return s.a.createElement(rbe,{title:Ph("请选择"),onClose:()=>{null==h||h.close("sort-select")},showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:null==(t=e.sort)?void 0:t.field_uuid,list:Bp(v,(e=>{var t;const r=null==m?void 0:m.getFieldIcon(null==(t=e.get("field"))?void 0:t.get("type"));return{key:e.get("field").get("uuid"),title:e.get("field").get("name"),icon:r&&s.a.createElement(r,null)}})),onCheck:e=>{null==h||h.close("sort-select"),o(e.key)}}))}}),s.a.createElement(obe,{className:"lakex-table-h5-sort-display-radio",options:[{label:r.asc,value:"asc"},{label:r.desc,value:"desc"}],onChange:e=>c(e.value),defaultValue:t.sort.type}),s.a.createElement(abe,{className:"lakex-table-h5-sort-auto",list:[{key:"auto",checked:t.auto,title:Ph("保持排序")}],onSwitch:(e,t)=>{u(t)}}),s.a.createElement(b.a,{type:"primary",className:"lakex-table-h5-sort-confirm",onClick:()=>n(),style:{opacity:t.auto?0:1}},Ph("确定")),s.a.createElement(b.a,{className:"lakex-table-h5-sort-del",onClick:()=>l()},s.a.createElement(XU,{type:"Delete",className:"del-icon"}),Ph("删除该条件")))})())};var Wbe=Object.defineProperty,Gbe=Object.getOwnPropertyDescriptor,Kbe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Gbe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Wbe(t,r,o),o};let qbe=class{constructor(){this._getActive=()=>{const e=this._readService.getActiveView();if(!e)return!1;const t=this._readService.getViewConfig(e.get("uuid"));return!(null==t||!t.get("keep_sort"))}}static pluginModule(){return xo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"sort",icon:"ViewerSort",tooltip:Ph("排序"),visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))!==LE.FORM},active:this._getActive,onClick:e=>{const t=e.target;this._modalService.open("sort",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"sort",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?Hbe:Ube})}registerContextMenu(e){e.registerItem({key:"sortByAsc",name:Ph("升序"),hotkey:"",visible:({from:e})=>e===Xue.HEADER,onClick:({initialState:e})=>{var t,r;const{fieldId:n}=e,i=this._readService.getActiveView();if(!i)return;const o=this._readService.getViewSort(i.get("uuid")),a=this._readService.getViewConfig(null==i?void 0:i.get("uuid"));let s=null;s=o?null==(r=this._commandService)?void 0:r.execCommand("updateSort",{viewId:i.get("uuid"),sort:{field_uuid:n,type:"asc"},auto:!(null==a||!a.get("keep_sort"))}):null==(t=this._commandService)?void 0:t.execCommand("createSort",{viewId:i.get("uuid"),sort:{field_uuid:n,type:"asc"}}),null!=s&&s.isSuccess?this._modalService.close("context-menu-modal"):null!=s&&s.error&&m.a.error(s.error.message)}}),e.registerItem({key:"sortByDesc",name:Ph("降序"),hotkey:"",visible:({from:e})=>e===Xue.HEADER,onClick:({initialState:e})=>{var t,r;const{fieldId:n}=e,i=this._readService.getActiveView();if(!i)return;const o=this._readService.getViewSort(i.get("uuid")),a=this._readService.getViewConfig(null==i?void 0:i.get("uuid"));let s=null;s=o?null==(r=this._commandService)?void 0:r.execCommand("updateSort",{viewId:i.get("uuid"),sort:{field_uuid:n,type:"desc"},auto:!(null==a||!a.get("keep_sort"))}):null==(t=this._commandService)?void 0:t.execCommand("createSort",{viewId:i.get("uuid"),sort:{field_uuid:n,type:"desc"}}),null!=s&&s.isSuccess?this._modalService.close("context-menu-modal"):null!=s&&s.error&&m.a.error(s.error.message)}})}};qbe.pluginName="workbench-sort",Kbe([ao(c8)],qbe.prototype,"_modalService",2),Kbe([ao(KO)],qbe.prototype,"_readService",2),Kbe([ao(zI)],qbe.prototype,"_commandService",2),Kbe([ao(lp)],qbe.prototype,"_configuration",2),qbe=Kbe([io({contrib:[jL,j4,u8,yme]})],qbe);const Ybe=e=>{const{initialState:t}=e,{items:r,disableDel:n}=t,i=Object(a.useRef)(null);return s.a.createElement("div",{ref:i,className:"lakex-grid-context-menu"},s.a.createElement(d.a,{mode:"vertical"},r.map(((t,r)=>"|"===t?s.a.createElement(x.a,{key:r}):s.a.createElement(d.a.Item,{className:qL({disable:"deleteField"===t.key&&n}),key:t.key,icon:ls(t.icon)?t.icon({}):s.a.createElement(XU,{type:t.icon}),onClick:r=>{var n;null==(n=t.onClick)||n.call(t,e,r)}},t.name,s.a.createElement("span",{className:"lakex-grid-context-menu-item-hotkey"},t.hotkey))))))};var Jbe=Object.defineProperty,Xbe=Object.getOwnPropertyDescriptor,Zbe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xbe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jbe(t,r,o),o};let Qbe=class{constructor(){this._contextMenuModalId="context-menu-modal",this._destroyList=new gp}static pluginModule(){return xo().contribution(yme).register(xme).register(Cme).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"contextMenu",type:"array",title:"右键菜单"}),e.registerDefaultValue({contextMenu:[]})}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.get("type")}init(){var e;this._contextMenuRegistry.init(),this._destroyList.push(this._contextMenuService.onContextMenu((({e:e,from:t,...r})=>{const n=this._readService.getViewFields()||[],i=e.currentTarget,o=e.clientX,a=e.clientY,s={height:0,width:0,left:o,right:o,top:a,bottom:a};this._modalService.open(this._contextMenuModalId,{position:{origin:s,placement:"right"},initialState:{items:this._contextMenuWorkbenchService.getMenuItems({from:t,fieldId:r.fieldId}),originRect:i.getBoundingClientRect(),disableDel:1===n.length,...r}})})));const t=null==(e=this._selectionService)?void 0:e.onAnchorChange((e=>{var t;null!=(t=this._selectionService)&&t.hasSelection()||this._modalService.close(this._contextMenuModalId);const r=e.fieldValue,n=this._contextMenuService.contextMenuInfo;((null==r?void 0:r.fieldId)!==(null==n?void 0:n.fieldId)||(null==r?void 0:r.recordId)!==(null==n?void 0:n.recordId))&&this._modalService.close(this._contextMenuModalId)}));t&&this._destroyList.push(t)}destroy(){this._destroyList.destroy()}registerModal(e){e.registerItem({id:this._contextMenuModalId,hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:Ybe})}};Qbe.pluginName="workbench-context-menu",Zbe([ao(c8)],Qbe.prototype,"_modalService",2),Zbe([ao(Zue)],Qbe.prototype,"_contextMenuService",2),Zbe([ao(xme)],Qbe.prototype,"_contextMenuWorkbenchService",2),Zbe([ao(qte),cN()],Qbe.prototype,"_selectionService",2),Zbe([ao(KO)],Qbe.prototype,"_readService",2),Zbe([ao(Cme)],Qbe.prototype,"_contextMenuRegistry",2),Zbe([ao(bR)],Qbe.prototype,"_abilityService",2),Qbe=Zbe([io({contrib:[jL,u8,yme]})],Qbe);var e_e=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}},t_e={"text/plain":"Text","text/html":"Url",default:"Text"};var r_e=function(e,t){var r,n,i,o,a,s,l=!1;t||(t={}),r=t.debug||!1;try{if(i=e_e(),o=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=e,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),typeof n.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=t_e[t.format]||t_e.default;window.clipboardData.setData(i,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(s),o.selectNodeContents(s),a.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(i){r&&console.error("unable to copy using execCommand: ",i),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(i){r&&console.error("unable to copy using clipboardData: ",i),r&&console.error("falling back to prompt"),n=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(n,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(o):a.removeAllRanges()),s&&document.body.removeChild(s),i()}return l};const n_e=$i.defineToken("ExpandRecordContribution");var i_e=(e=>(e.NORMAL="normal",e.LITE="lite",e))(i_e||{}),o_e=Object.defineProperty,a_e=Object.getOwnPropertyDescriptor,s_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?a_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&o_e(t,r,o),o};let l_e=class{constructor(){this._recordProviders=[],this._tooltipComponent=null}init(){var e;const t=this.expendRecordProvider.getContributions();for(const r of t)try{null==(e=r.registerExpandRecord)||e.call(r,this)}catch(e){console.error(e)}}getProviders(){return this._recordProviders}getTooltipComponent(){return this._tooltipComponent}registerRecordProvider(e){this._recordProviders.push(e)}registerRecordTooltip(e){this._tooltipComponent=e}};s_e([wh(n_e)],l_e.prototype,"expendRecordProvider",2),l_e=s_e([io()],l_e);const c_e=Object(a.memo)((({recordId:e,field:t})=>{const r=o7(e,t.get("uuid")),n=t.get("type")||"",i=HL(nH).getFieldComponent(n);return n&&i?Lo(null==r?void 0:r.value)?s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},s.a.createElement("span",{className:"lakex-cell-field-in-expand-record cell-empty"},Ph("(空)"))):s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},i&&s.a.createElement(i,{key:null==r?void 0:r.uuid,cell:r,field:t})):null})),u_e=Object(a.memo)((({recordId:e,field:t,renderMode:r=Vz.NORMAL})=>{const n=o7(e,t.get("uuid")),i=t.get("type")||"",o=HL(nH),l=HL(l_e).getTooltipComponent(),[c,u]=Object(a.useState)("");if(!n)return null;const d=o.getFieldEditComponent(i)||o.getFieldComponent(i);if(!d)return s.a.createElement("h1",null,"尚未注册FieldEditComponent");const f={...zE.isLink(i)&&{useLinkEditor:!0},...zE.isSelectLike(i)&&{displayType:"dropdown"}};if(zE.isSystemType(i))return s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},s.a.createElement(d,{key:n.uuid,field:t,recordId:e,cell:n,readonly:!1,focus:!1}));const h=s.a.createElement(d,{key:n.uuid+n.updated_at,defaultValue:n.value,field:t,cell:n,renderMode:r,recordId:e,onCellChange:e=>{const t=o.cellValueChecker(i,e);u(t),null==n||n.setCell(e)},...f});return s.a.createElement("div",{className:"lakex-cell-field-in-expand-record"},l?s.a.createElement(l,{cell:n,field:t},h):h,s.a.createElement("p",{className:qL("lakex-table-expand-item-error",{show:c})},c))})),d_e=Object(a.memo)((({type:e})=>{const t=HL(nH).getFieldIcon(e);return s.a.createElement("div",{className:"lakex-cell-field-in-expand-record-icon"},t&&s.a.createElement(t,{size:16}))})),f_e=Object(a.memo)((({field:e,position:t})=>{const r=HL(nH).getFieldTagComponent(e.get("type"));return r?s.a.createElement(r,{field:e,position:t}):null})),h_e=({field:e,isReadonly:t})=>{const{field:r,fieldType:n,fieldName:i}=r7((null==e?void 0:e.get("uuid"))||""),o=HL(c8),l=Object(a.useCallback)((e=>{t||o.open("addOrUpdateField",{position:{origin:e.currentTarget,placement:"bottom"},initialState:{fieldId:null==r?void 0:r.get("uuid")}})}),[t]);return r?s.a.createElement("div",{className:"lakex-table-expand-record-form-item-label",onClick:l},s.a.createElement(d_e,{type:n}),s.a.createElement("div",{className:"lakex-table-expand-record-form-item-label-name"},i),!t&&s.a.createElement(XU,{type:"ReviewArrowDown"}),s.a.createElement(f_e,{field:r,position:"expandRecord"})):null},p_e=({recordId:e,field:t,isReadonly:r})=>{const n=HL(lp);return t?s.a.createElement(s.a.Fragment,null,s.a.createElement(h_e,{isReadonly:r,field:t}),s.a.createElement("div",{className:"lakex-table-expand-record-form-item-content"},r?s.a.createElement(c_e,{key:t.get("type")+t.get("uuid"),recordId:e,field:t}):s.a.createElement(u_e,{key:t.get("type")+t.get("uuid"),recordId:e,field:t,renderMode:(null==n?void 0:n.getValue("expandRecord.fieldRenderMode"))||Vz.NORMAL}))):null};function g_e(e){const{recordId:t,showAddNext:r}=e,n=HL(lp),i=X9(aR.TABLE).isReadonly(),{ids:o}=function(){const e=HL(KO),[t,r]=Object(a.useState)((()=>e.getVisibleRecordIdsInActiveView()));return{ids:t}}(),s=rre(),l=Object(a.useMemo)((()=>t||(null==s?void 0:s.recordId)),[null==s?void 0:s.recordId,t]),[c,u]=Object(a.useState)(l),{isInRefresh:d,refreshDesc:f}=gme(c),[h,p]=Object(a.useState)(null),g=i7(),m=Object(a.useMemo)((()=>{const e=o[0];return c===e}),[c,o]),{title:v}=function(e){const t=HL(KO),r=HL(Bk),[n,i]=Object(a.useState)((()=>t.getPrimaryCellInRecord(e)));return Object(a.useEffect)((()=>{i(t.getPrimaryCellInRecord(e))}),[t,e]),Object(a.useEffect)((()=>{const n=null==r?void 0:r.onCellChange((r=>{i(t.getPrimaryCellInRecord(e))}));return()=>{null==n||n.destroy()}}),[t,r,e]),{title:(null==n?void 0:n.formattedValue)||""}}(c),y=Object(a.useMemo)((()=>{const e=o[o.length-1];return c===e}),[c,o]),b=HL(zI),_=e=>{if(!o)return;const t=null!==h?h:c;let r=null,n=o.findIndex((e=>e===t));"up"!==e||m?"down"===e&&!y&&(null!==h?n=o.findIndex((e=>e===h)):n++,r=o[n]):(n--,r=o[n]),r&&(u(r),p(null))},w=vG((()=>{var e;const t=null==b?void 0:b.execCommand("addEmptyRecord"),r=null==t?void 0:t.result,n=null==(e=null==r?void 0:r[0])?void 0:e.uuid;u(n)}));return{showAddNext:r,isReadonly:i,layoutMode:null==n?void 0:n.getValue("expandRecord.fieldLayoutMode"),title:v,fields:Bp(g,(e=>e.get("field"))),disableUp:m,disableDown:y,rowId:c,isInRefresh:d,refreshDesc:f,onShowNextRecord:()=>{_("down")},onShowPrevRecord:()=>{_("up")},onAddNextRecord:w}}const m_e=()=>{const e=HL(c8),t=Object(a.useCallback)((t=>{e.open("addOrUpdateField",{position:{origin:t.currentTarget,placement:"bottom"}})}),[]);return s.a.createElement("div",{id:"lark-table-expand-record-add-column",className:"add-column-button",onClick:t},s.a.createElement(XU,{type:"Add"}),s.a.createElement("div",{className:"title"},Ph("新增字段")))},v_e=({focus:e=!1,children:t,className:r})=>{const n=Object(a.useRef)(null);return Object(a.useLayoutEffect)((()=>{if(e&&n.current){n.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});const e=n.current.querySelector("input")||n.current.querySelector("textarea");setTimeout((()=>{const t=null==e?void 0:e.value.length;t&&(null==e||e.setSelectionRange(t,t)),null==e||e.focus()}),300)}}),[e]),s.a.createElement("div",{className:r,ref:n},t)},y_e=({desc:e})=>s.a.createElement("div",{className:"lakex-table-expand-record-refresh-tooltip"},s.a.createElement(O.a,{message:null==e?void 0:e.text,type:"warning",showIcon:!0,closable:!0})),b_e=({mode:e,initialState:t})=>{const r=HL(c8),n=HL(l_e),{showAddNext:i,isReadonly:o,title:l,layoutMode:c,rowId:u,fields:d,disableUp:f,disableDown:h,isInRefresh:g,refreshDesc:v,onShowNextRecord:y,onShowPrevRecord:_,onAddNextRecord:w}=g_e({recordId:(null==t?void 0:t.recordId)||"",showAddNext:!(null==t||!t.showAddNext)}),C=HL(PH),[E,S]=Object(a.useState)(e===l8.MODAL?"calc(100vh - 200px)":void 0),k=Object(a.useRef)(null),x=(null==t?void 0:t.showAddNext)||e!==l8.DRAWER;yG("⌘+shift+,",(()=>{_()})),yG("⌘+shift+.",(()=>{y()})),Object(a.useEffect)((()=>{if(k.current){if(e===l8.DRAWER)return;const t=k.current.getBoundingClientRect();S(t.height)}}),[x]);const O=()=>{r.close("expandRecord")},I=n.getProviders(),R=E&&"number"==typeof E?`${E}px`:E;return s.a.createElement("div",{className:`lakex-expand-record lakex-table-expand-record lakex-table-input lakex-ui-modal-mode-${e} lakex-table-input lakex-table-expand-record-layout-${c} `},g&&s.a.createElement(y_e,{desc:v}),s.a.createElement("div",{className:"lakex-table-expand-record-head"},s.a.createElement("div",{className:"lakex-table-expand-record-head-action"},s.a.createElement("h1",{className:"lakex-table-expand-record-title"},l||s.a.createElement("span",{className:"lakex-table-expand-record-empty-title"},Ph("未命名记录"))),s.a.createElement("div",{className:"lakex-table-expand-record-head-aciton-wrap"},s.a.createElement(p.a,{placement:"top",title:s.a.createElement("span",null,Ph("复制链接"))},s.a.createElement("span",{className:"lakex-table-expand-record-more-action",onClick:e=>{e.stopPropagation();const t=null==C?void 0:C.getOpenLink("record",u);!t||(r_e(t),m.a.success({content:Ph("复制成功"),style:{zIndex:1050}}))}},s.a.createElement(XU,{type:"Addlink",size:16}))),s.a.createElement("span",{className:"lakex-table-expand-record-action-split"}),s.a.createElement("span",{className:"lakex-table-expand-record-direction"},s.a.createElement(p.a,{placement:"top",title:s.a.createElement("div",{className:"lakex-table-expand-record-direction-tip"},Ph("上一条记录"),s.a.createElement("br",null),Rz.adapterHotKey("⌘+shift+,"))},s.a.createElement(b.a,{className:"lakex-table-expand-record-up",disabled:f,onClick:_,type:"text"},s.a.createElement(XU,{type:"ArrowUp",size:16}))),s.a.createElement(p.a,{placement:"top",title:s.a.createElement("div",{className:"lakex-table-expand-record-direction-tip"},Ph("下一条记录"),s.a.createElement("br",null),Rz.adapterHotKey("⌘+shift+."))},s.a.createElement(b.a,{className:"lakex-table-expand-record-down",disabled:h,onClick:y,type:"text"},s.a.createElement(XU,{type:"ArrowDown",size:16})))),s.a.createElement("span",{className:"lakex-table-expand-record-action-split"}),s.a.createElement(p.a,{placement:"top",title:Ph("关闭弹窗 (ESC)")},s.a.createElement(XU,{type:"RowCollpse",size:16,onClick:O}))))),s.a.createElement("div",{ref:k,className:"lakex-table-expand-record-form",style:{height:R}},null==d?void 0:d.map(((e,t)=>{const r=`${u}-${null==e?void 0:e.get("uuid")}`;return s.a.createElement(v_e,{className:"lakex-table-expand-record-form-item",key:r},s.a.createElement(p_e,{recordId:u,field:e,isReadonly:o}))})),!o&&s.a.createElement(m_e,null),I.map((e=>{const r=e.RenderComponent;return s.a.createElement(r,{key:u,recordId:u,isReadonly:o,isNewRecord:null==t?void 0:t.isNewRecord})}))),!o&&x&&s.a.createElement("div",{className:"lakex-table-expand-record-operation-button"},s.a.createElement("div",{className:"create-row-footer"},i&&s.a.createElement(b.a,{onClick:w},Ph("添加下一个")),s.a.createElement(b.a,{onClick:O},Ph("完成")))))},__e={[pE.IMAGE]:Y6,[pE.FILE]:q6},w_e=e=>{const t=e.initialState||{},{fieldType:r,recordId:n,fieldId:i}=t,o=HL(c8),l=HL(zI),{fieldUriModel:c}=HL(Ok),u=o7(n,i),d=null==u?void 0:u.value,f=Object(a.useMemo)((()=>r===pE.IMAGE?Ph("图片列表"):r===pE.FILE?Ph("附件列表"):null),[r]),h={style:{width:520},defaultValue:d,onChange:e=>{null==l||l.execCommand("setCell",{...u,value:e})},onOrderChange:({targetUid:e,sourceUid:t})=>{var o,a;const s=null==(o=c.findOne({uid:e}))?void 0:o.get("uuid"),u=null==(a=c.findOne({uid:t}))?void 0:a.get("uuid");null==l||l.execCommand("updateValueOrder",{fieldId:i,fieldType:r,recordId:n,targetValueId:s,sourceValueId:u})}};if(![pE.IMAGE,pE.FILE].includes(r))return null;const p=__e[r];return s.a.createElement("div",{className:"lakex-table-cell-file-uploader"},s.a.createElement("div",{className:"file-uploader-header"},s.a.createElement("h4",{className:"file-uploader-header-title"},f),s.a.createElement(XU,{type:"Close",className:"file-uploader-close",onClick:e=>{null==o||o.close("expandRecordFileEditable")}})),s.a.createElement(p,{...h}))};var C_e=Object.defineProperty,E_e=Object.getOwnPropertyDescriptor,S_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?E_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&C_e(t,r,o),o};let k_e=class{constructor(){this._toDestroyCollection=new gp,this._handleExpandRecord=({initialState:e})=>{const{recordId:t}=e;this._openExpandRecord(t),this._modalService.close("context-menu-modal")}}static pluginModule(){return xo().contribution(n_e).register(l_e).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"expandRecord",type:"object",title:"行展开",properties:{fieldRenderMode:{type:"string",description:"字段渲染模式",enum:Object.values(Vz)},fieldLayoutMode:{type:"string",description:"字段排版模式",enum:Object.values(i_e)},modalDrawerModeViews:{type:"array",description:"使用侧边栏打开的视图列表"}}}),e.registerDefaultValue({"expandRecord.fieldRenderMode":Vz.LITE,"expandRecord.fieldLayouteMode":i_e.LITE,"expandRecord.modalDrawerModeViews":[LE.GRID]})}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.get("type")}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}init(){this._expandRecordRegistry.init(),this._toDestroyCollection.push(this._renderService.onClickRecord((e=>{const{recordId:t,isNewRecord:r}=e;this.currentViewType!==LE.FORM&&(this._modalService.close("viewerGridCellEditor"),this._openExpandRecord(t,r))})))}destroy(){this._toDestroyCollection.destroy()}_openExpandRecord(e,t){var r;const n=null!=(r=this._configuration.getValue("expandRecord.modalDrawerModeViews"))&&r.includes(this.currentViewType)?l8.DRAWER:l8.MODAL;this._modalService.open("expandRecord",{mode:n,hasMask:n!==l8.DRAWER,initialState:{recordId:e,isNewRecord:t}})}registerModal(e){e.registerItem({id:"expandRecord",hasMask:!0,scrollStrategy:"block",zIndex:"expandRecord",position:{left:"50%",top:"50%"},hasAnimation:!0,RenderComponent:b_e}),e.registerItem({id:"expandRecordFileEditable",hasMask:!1,scrollStrategy:"block",zIndex:"expandRecord",RenderComponent:w_e})}registerHotkey(e){e.registerItem({id:"expandRecord",hotkey:"space",name:"行展开",enableOnInput:!1,isEnable:()=>{const e=this.currentViewType===LE.GRID;return this._hasSelection()&&e},onHotKey:e=>{e.preventDefault(),this._modalService.close("viewerGridCellEditor"),this._modalService.open("expandRecord"),this._openExpandRecord()}})}registerContextMenu(e){e.registerItem({key:"expandRecord",name:()=>this.currentViewType===LE.GRID?Ph("展开行"):Ph("展开记录"),icon:"RowExpand",hotkey:Rz.adapterHotKey("Space"),visible:({from:e})=>e===Xue.CELL||e===Xue.CARD_RECORD||e===Xue.KANBAN_RECORD,onClick:this._handleExpandRecord})}};k_e.pluginName="workbench-expand-record",S_e([ao(Qz)],k_e.prototype,"_renderService",2),S_e([ao(KO)],k_e.prototype,"_readService",2),S_e([ao(bR)],k_e.prototype,"_abilityService",2),S_e([ao(c8)],k_e.prototype,"_modalService",2),S_e([ao(lp)],k_e.prototype,"_configuration",2),S_e([ao(qte),cN()],k_e.prototype,"_selectionService",2),S_e([ao(l_e)],k_e.prototype,"_expandRecordRegistry",2),k_e=S_e([io({contrib:[jL,u8,Vte,n_e,yme]})],k_e);var x_e=Object.defineProperty,O_e=Object.getOwnPropertyDescriptor,I_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?O_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&x_e(t,r,o),o};let R_e=class{static pluginModule(){return xo().contribution(Vte).register(this)}init(){this._workbenchHotkeyPluginProvider.getContributions({cache:!1}).forEach((e=>{e.registerHotkey(this._hotkeyRegistry)}))}registerHotkey(e){e.registerItem({id:"save",hotkey:"⌘+S",name:Ph("保存"),enableOnInput:!1,isEnable:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))!==LE.FORM},onHotKey:e=>{e.preventDefault(),m.a.success(Ph("文档已保存"))}})}};R_e.pluginName="workbench-hotkey",I_e([wh(Vte)],R_e.prototype,"_workbenchHotkeyPluginProvider",2),I_e([ao(Nz)],R_e.prototype,"_hotkeyRegistry",2),I_e([ao(KO)],R_e.prototype,"_readService",2),R_e=I_e([io({contrib:[jL,Vte]})],R_e);const T_e=["none","-","count","filled","empty","checked","unchecked","unique","-","percentFilled","percentEmpty","percentUnique","-","sum","average","max","min","earliestDate","latestDate","dateRange","monthRange","percentChecked","percentUnchecked"],A_e=({initialState:e})=>{const t=e.stat,r=(null==t?void 0:t.type)||"none",{menus:n,onChange:i}=(({field:e,view:t})=>{const r=HL(zI),n=HL(c8),i=[];for(const t of T_e){const r=Rde[t];if("-"!==t){if(r){if(!r.types){i.push({...r,type:t});continue}r.types.includes(e.get("type"))&&i.push({...r,type:t})}}else i.push(t)}return"-"===i[i.length-1]&&i.splice(i.length-1,1),{menus:i,onChange(i,o){"none"===i&&o?null==r||r.execCommand("removeStat",{viewId:t.get("uuid"),fieldId:e.get("uuid")}):null==r||r.execCommand("updateStat",{viewId:t.get("uuid"),fieldId:e.get("uuid"),type:i}),null==n||n.close("stat-option")}}})(e);return s.a.createElement("div",{className:"lakex-table-stats-option-list"},n.map(((e,n)=>{if("-"===e)return s.a.createElement("div",{key:n,className:"lakex-table-stats-option-seperator"});const o=e.type,a=e.text;return o?s.a.createElement("div",{key:o,className:"lakex-table-stats-option-item",onClick:()=>{i(o,t)}},o===r?s.a.createElement(XU,{type:"Check",size:14}):s.a.createElement("span",{className:"lakex-table-stats-empty"}),a):null})))};var M_e=Object.defineProperty,N_e=Object.getOwnPropertyDescriptor,D_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?N_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&M_e(t,r,o),o};let P_e=class{static pluginModule(){return xo().register(this)}init(){this._statControllerService.onClick((({view:e,field:t,stat:r,target:n})=>{this._modalService.open("stat-option",{position:{placement:"top",origin:n},initialState:{view:e,field:t,stat:r}})}))}registerModal(e){e.registerItem({id:"stat-option",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:A_e})}};P_e.pluginName="workbench-statistics",D_e([ao(c8)],P_e.prototype,"_modalService",2),D_e([ao(xde)],P_e.prototype,"_statControllerService",2),P_e=D_e([io({contrib:[jL,u8]})],P_e);var j_e=Object.defineProperty,F_e=Object.getOwnPropertyDescriptor,V_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?F_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&j_e(t,r,o),o};let L_e=class{constructor(){this._handleInsertRecordBefore=({initialState:e})=>{var t,r;const{recordId:n}=e,i=this._readService.getOriginViewRecords(),o=Lp(i,(e=>e.get("record_uuid")===n));if(o<0)return;const a=this._readService.getViewFields(),s=i.get(o),l=this._commandService.execCommand("addEmptyRecord",{sourceRecordId:s.get("record_uuid"),direction:"before",groupItemKey:s.get("group_item_key")}),c=this._readService.getActiveView(),u=null==l?void 0:l.result;if((null==c?void 0:c.get("type"))===LE.GRID){const e=null==(t=this._selectionService)?void 0:t.createGridSelectionByIndex(o,0,((null==i?void 0:i.length)||0)+1,(null==a?void 0:a.length)||0);null==(r=this._selectionService)||r.setSelection(e)}else u&&u[0]&&this._modalService.open("expandRecord",{initialState:{recordId:u[0].uuid}});this._modalService.close("context-menu-modal")},this._handleInsertRecordAfter=({initialState:e})=>{var t,r;const{recordId:n}=e,i=this._readService.getOriginViewRecords(),o=Lp(i,(e=>e.get("record_uuid")===n));if(o<0)return;const a=this._readService.getViewFields(),s=i.get(o),l=this._commandService.execCommand("addEmptyRecord",{sourceRecordId:s.get("record_uuid"),direction:"after",groupItemKey:s.get("group_item_key")}),c=this._readService.getActiveView(),u=null==l?void 0:l.result;if((null==c?void 0:c.get("type"))===LE.GRID){const e=null==(t=this._selectionService)?void 0:t.createGridSelectionByIndex(o+1,0,((null==i?void 0:i.length)||0)+1,(null==a?void 0:a.length)||0);null==(r=this._selectionService)||r.setSelection(e)}else u&&u[0]&&this._modalService.open("expandRecord",{initialState:{recordId:u[0].uuid}});this._modalService.close("context-menu-modal")},this._handleRemoveRecord=({initialState:e})=>{var t;const{recordId:r}=e;this._commandService.execCommand("removeRecords",{recordIds:[r]}),null==(t=this._selectionService)||t.removeSelection(),this._modalService.close("context-menu-modal")},this._handleRemoveRecords=({initialState:e})=>{var t;const{selection:r}=e;if(r){if(r.isAllSelect)this._commandService.execCommand("removeRecords",{all:!0});else{const e=r.getRangeAt(0).start.row,t=r.getRangeAt(0).end.row,n=this._readService.getFlatViewRecords().slice(e,t+1).map((e=>e.record_uuid));this._commandService.execCommand("removeRecords",{recordIds:n})}null==(t=this._selectionService)||t.removeSelection(),this._modalService.close("context-menu-modal")}}}static pluginModule(){return xo().register(this)}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.get("type")}init(){}registerToolbar(e){e.registerItem({id:"add-record",icon:"Add",iconSize:14,tooltip:Ph("添加记录"),visible:()=>this.currentViewType!==LE.FORM,showTitle:!0,showTooltip:!1,onClick:()=>{var e;const t=this._commandService.execCommand("addEmptyRecord").result,r=null==(e=null==t?void 0:t[0])?void 0:e.uuid;r&&Oo((()=>{var e;null==(e=this._selectionService)||e.moveToRecord(r),this._modalService.open("expandRecord",{initialState:{recordId:r,showAddNext:!0,isNewRecord:!0}})}))}})}registerContextMenu(e){e.registerItem({key:"insertRecordUp",name:()=>this.currentViewType===LE.GRID?Ph("向上插入行"):Ph("向上插入记录"),icon:"UpArrow",hotkey:Rz.adapterHotKey("⌘+⇧+Enter"),visible:({from:e})=>!this.isReadonly&&(e===Xue.CELL||e===Xue.KANBAN_RECORD),onClick:e=>{this.currentViewType===LE.KANBAN?this._handleInsertRecordAfter(e):this._handleInsertRecordBefore(e)}}),e.registerItem({key:"insertRecordDown",name:()=>this.currentViewType===LE.GRID?Ph("向下插入行"):Ph("向下插入记录"),icon:"DownArrow",hotkey:Rz.adapterHotKey("⇧+Enter"),visible:({from:e})=>!this.isReadonly&&(e===Xue.CELL||e===Xue.KANBAN_RECORD),onClick:e=>{this.currentViewType===LE.KANBAN?this._handleInsertRecordBefore(e):this._handleInsertRecordAfter(e)}}),e.registerItem({key:"insertRecordLeft",name:Ph("向左插入记录"),icon:"LeftArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.CARD_RECORD,onClick:this._handleInsertRecordBefore}),e.registerItem({key:"insertRecordRight",name:Ph("向右插入记录"),icon:"RightArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.CARD_RECORD,onClick:this._handleInsertRecordAfter}),e.registerItem({key:"copyRecord",name:Ph("复制记录"),hotkey:"",visible:({from:e})=>e===Xue.KANBAN_RECORD,onClick:({initialState:e})=>{const{recordId:t}=e,r=this._readService.getOriginViewRecords(),n=Lp(r,(e=>e.get("record_uuid")===t)),i=r.get(n);this._commandService.execCommand("copyRecord",{sourceRecordId:i.get("record_uuid")}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"removeRecord",name:()=>this.currentViewType===LE.GRID?Ph("删除行"):Ph("删除记录"),icon:"Delete",hotkey:"",visible:({from:e})=>!this.isReadonly&&e!==Xue.HEADER&&e!==Xue.GROUP_HEADER,onClick:async e=>{const{initialState:t}=e,{selection:r}=t;r&&!r.isCollapsed?this._handleRemoveRecords(e):this._handleRemoveRecord(e)}})}};L_e.pluginName="workbench-add-record",V_e([ao(c8)],L_e.prototype,"_modalService",2),V_e([ao(KO)],L_e.prototype,"_readService",2),V_e([ao(zI)],L_e.prototype,"_commandService",2),V_e([ao(qte),cN()],L_e.prototype,"_selectionService",2),V_e([ao(bR)],L_e.prototype,"_abilityService",2),L_e=V_e([io({contrib:[jL,j4,yme]})],L_e);var $_e=Object.defineProperty,B_e=Object.getOwnPropertyDescriptor,U_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?B_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&$_e(t,r,o),o};let z_e=class extends fp{constructor(){super(...arguments),this.isInSearching=!1,this._onSearching=this._register(new _p),this.onSearching=this._onSearching.event,this._onExitSearching=this._register(new _p),this.onExitSearching=this._onExitSearching.event}_getViewSearchResult(e,t=""){const r=this._readService.isGroup(e),n=this._readService.getViewFields(e),i=[];if(r){const r=this._readService.getGroupViewRecords(e);for(const e of r){const r=e.viewRecords;if(r)for(const e of r)for(const r of n){const n=this._getMatch(t,r.get("field_uuid"),e.get("record_uuid"));n&&i.push(n)}}}else{const r=this._readService.getViewRecords(e);if(!n||0===n.length)return i;for(const e of r)for(const r of n){const n=this._getMatch(t,r.get("field_uuid"),e.get("record_uuid"));n&&i.push(n)}}return i}_getMatch(e,t,r){const n=this._readService.getCellFormattedValue(t,r);if(n&&n.includes(e))return{fieldId:t,recordId:r}}getSearchResult(e){const t=this._readService.getActiveView();if(!t)return[];const r=this._getViewSearchResult(t.get("uuid"),e);return(null==t?void 0:t.get("type"))!==LE.GRID?af(r.map((e=>({recordId:e.recordId}))),"recordId"):r}emitSearchingEvent(){this.isInSearching=!0,this._onSearching.emit()}emitExitSearchingEvent(){this.isInSearching=!1,this._onExitSearching.emit()}destroy(){super.destroy()}};U_e([ao(KO)],z_e.prototype,"_readService",2),U_e([Ii()],z_e.prototype,"destroy",1),z_e=U_e([io()],z_e);const H_e=()=>{const e=HL(c8),t=HL(z_e),r=HL(Dte),n=HL(qte),i=HL(KO),[o,s]=Object(a.useState)(null),[l,c]=Object(a.useState)(0),[u,d]=Object(a.useState)(0),[f,h]=Object(a.useState)([]),p=Object(a.useRef)(null),g=Object(a.useRef)(null),m=Object(a.useRef)(!1);Object(a.useLayoutEffect)((()=>{const e=setTimeout((()=>{var e;null==(e=g.current)||e.focus()}),50);return()=>{clearTimeout(e)}}));const v=()=>{s(null),h([]),c(0),d(0),null==r||r.clearHighlights(),(null==i?void 0:i.getActiveView().get("type"))!==LE.GRID&&(null==n||n.removeSelection())},y=bG((()=>{var e,n,i;if(null!=m&&m.current)return;const o=null==(i=(null==(e=g.current)?void 0:e.input)||(null==(n=g.current)?void 0:n.nativeElement))?void 0:i.value;if(!o)return void v();const a=(null==t?void 0:t.getSearchResult(o))||[];s(o),c(a.length),h(a),d(0),a.length>0?null==r||r.setHighlights(a):null==r||r.clearHighlights()}),300);return Object(a.useEffect)((()=>{const e=f[u];if(!e)return;const t=null==n?void 0:n.createSelectionById(e.recordId,e.fieldId);null==n||n.scrollToSelection(t,"center")}),[u,f]),Object(a.useEffect)((()=>{const t=e.onBeforeClose((({modalId:e})=>{"search"===e&&v()}));return()=>{t.destroy()}}),[]),{state:{query:o,count:l,current:u},onCloseSearch:()=>{e.close("search"),v()},onCompositionStart:()=>{m.current=!0},onCompositionEnd:()=>{m.current=!1,y()},searchBox:p,onChangeQuery:y,onClear:()=>{s(null)},searchInput:g,composition:m,onSearchPrev:()=>{d(u>0?u-1:l-1)},onSearchNext:()=>{d(u<l-1?u+1:0)}}},{TabPane:W_e}=I.a,G_e={x:0,y:0},K_e=({top:e=0,left:t=0})=>{var r,n;const{state:i,onCloseSearch:o,searchInput:a,onChangeQuery:l,onCompositionStart:c,onCompositionEnd:d,onSearchPrev:f,onSearchNext:h}=H_e(),{attributes:p,listeners:g,setNodeRef:m,transform:v}=fU({id:"search"});return s.a.createElement("div",{className:"lakex-table-search grid",ref:m,...g,...p,style:{top:e,right:10-t,"--translate-x":`${null!=(r=null==v?void 0:v.x)?r:0}px`,"--translate-y":`${null!=(n=null==v?void 0:v.y)?n:0}px`}},s.a.createElement(XU,{className:"lakex-search-close-action",type:"Close",size:14,onClick:o}),s.a.createElement(I.a,{defaultActiveKey:"search",animated:!1},s.a.createElement(W_e,{tab:Ph("查找"),key:"search"},s.a.createElement("div",{className:"search-input"},s.a.createElement(u.a,{ref:a,className:"lakex-table-search-input",defaultValue:i.query,onChange:l,onCompositionStart:c,onCompositionEnd:d,autoFocus:!0,onPressEnter:h}),i.query&&s.a.createElement("span",{className:"search-result"},Math.min(i.current+1,i.count)," / ",i.count)),s.a.createElement("div",{className:"search-foot"},s.a.createElement(b.a,{size:"small",onClick:f},Ph("上一个")),s.a.createElement(b.a,{size:"small",onClick:h},Ph("下一个"))))))},q_e=()=>{const[{x:e,y:t},r]=Object(a.useState)(G_e),n=M$(A$(TB,{activationConstraint:{distance:8}}));return s.a.createElement(lU,{sensors:n,onDragEnd:({delta:e})=>{r((({x:t,y:r})=>({x:t+e.x,y:r+e.y})))}},s.a.createElement(K_e,{top:t,left:e}))},Y_e=()=>{const{searchInput:e,onClear:t,composition:r,onCloseSearch:n,onChangeQuery:i}=H_e();return Object(a.useEffect)((()=>{r.current=!1}),[]),s.a.createElement("div",{className:qL("lakex-table-h5-search-bar")},s.a.createElement(u.a,{ref:e,prefix:s.a.createElement(XU,{type:"Search",size:"16",className:"lakex-table-h5-search-icon"}),className:"lakex-table-h5-search-input",placeholder:Ph("请输入关键词搜索"),clearable:!0,onClear:t,onChange:i}),s.a.createElement("span",{className:"lakex-table-h5-search-cancel",onClick:n},Ph("取消")))},J_e=()=>{const e=HL(z_e),t=HL(lp),r=HL(c8),n=HL($8),{state:i,searchBox:o,onCloseSearch:l,searchInput:c,onChangeQuery:d,onCompositionStart:f,onCompositionEnd:h,onSearchNext:g}=H_e(),[m,v]=Object(a.useState)(!1),y=(null==t?void 0:t.getValue("toolbar.mode"))===V4.NORMAL,b=Object(a.useCallback)((()=>{v(!1),l(),null==e||e.emitExitSearchingEvent()}),[l]),_=Object(a.useCallback)((e=>{e.keyCode===SN.ESC&&b()}),[b]);return Object(a.useEffect)((()=>{const t=null==e?void 0:e.onSearching((()=>{v(!0)}));return()=>{null==t||t.destroy()}}),[]),y?s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:()=>{const e=null==n?void 0:n.getRenderViewPort();!e||null==r||r.open("search",{initialState:{searchParams:{openFrom:"toolbar"}},position:{left:e.right,top:e.top}})},tabIndex:-1},s.a.createElement(XU,{type:"Search"}),s.a.createElement("span",{className:"toolbar-button-title"},Ph("搜索"))):m?s.a.createElement("div",{className:"lakex-search-toolbar-btn",ref:o.current},s.a.createElement(u.a,{ref:c,className:"lakex-table-search-input",defaultValue:i.query,placeholder:Ph("请输入关键词..."),onChange:d,onCompositionStart:f,onCompositionEnd:h,autoFocus:!0,allowClear:!0,bordered:!1,onPressEnter:g,onKeyDown:_,onBlur:b})):s.a.createElement(p.a,{title:Ph("搜索")},s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:()=>{v(!0),null==e||e.emitSearchingEvent()},tabIndex:-1},s.a.createElement(XU,{type:"Search"})))};var X_e=Object.defineProperty,Z_e=Object.getOwnPropertyDescriptor,Q_e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Z_e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&X_e(t,r,o),o};let ewe=class{static pluginModule(){return xo().register(this).register(z_e)}_getSearchPosition(){const e=this._viewportService.getRenderViewPort();return{left:e.right,top:e.top}}get _isLiteMode(){return this._configuration.getValue("toolbar.mode")===V4.LITE}init(){}registerToolbar(e){const t=this._configuration.getValue("render.mode");this._isLiteMode&&t!==jz.MOBILE?e.registerItem({id:"search",RenderComponent:J_e}):e.registerItem({id:"search",icon:"Search",tooltip:Ph("搜索"),visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))!==LE.FORM},onClick:e=>{let r;r=t===jz.MOBILE?{placement:"cover",origin:this._toolbarService.getDom()}:this._getSearchPosition(),this._modalService.open("search",{initialState:{searchParams:{openFrom:"toolbar"}},position:r})}})}registerModal(e){const t=this._configuration.getValue("render.mode");e.registerItem({id:"search",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:t===jz.MOBILE?Y_e:q_e})}registerHotkey(e){e.registerItem({id:"search",hotkey:"⌘+F",name:Ph("查找"),enableOnInput:!1,isEnable:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))!==LE.FORM},onHotKey:e=>{e.preventDefault(),this._isLiteMode?this._searchService.emitSearchingEvent():this._modalService.open("search",{initialState:{searchParams:{openFrom:"hotkey"}},position:this._getSearchPosition()})}})}};ewe.pluginName="workbench-search",Q_e([ao(c8)],ewe.prototype,"_modalService",2),Q_e([ao(KO)],ewe.prototype,"_readService",2),Q_e([ao($8)],ewe.prototype,"_viewportService",2),Q_e([ao(P4)],ewe.prototype,"_toolbarService",2),Q_e([ao(lp)],ewe.prototype,"_configuration",2),Q_e([ao(z_e)],ewe.prototype,"_searchService",2),ewe=Q_e([io({contrib:[jL,j4,u8,Vte]})],ewe);var twe=Object.defineProperty,rwe=Object.getOwnPropertyDescriptor,nwe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?rwe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&twe(t,r,o),o};let iwe=class{constructor(){this._handleCopy=()=>{this._copyCutService.copy(),this._modalService.close("context-menu-modal")},this._handlePaste=()=>{this._pasteService.paste(),this._modalService.close("context-menu-modal")}}static pluginModule(){return xo().register(this)}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get currentViewType(){var e;return null==(e=this._readService.getActiveView())?void 0:e.get("type")}init(){}registerContextMenu(e){e.registerItem({key:"copy",name:Ph("复制"),hotkey:Rz.adapterHotKey("⌘+C"),visible:({from:e})=>e===Xue.CELL||e===Xue.MULTI_CELL,onClick:this._handleCopy}),e.registerItem({key:"paste",name:Ph("粘贴"),hotkey:Rz.adapterHotKey("⌘+V"),visible:({from:e})=>!this.isReadonly&&(e===Xue.CELL||e===Xue.MULTI_CELL),onClick:this._handlePaste})}};iwe.pluginName="workbench-clipboard",nwe([ao(c8)],iwe.prototype,"_modalService",2),nwe([ao(KO)],iwe.prototype,"_readService",2),nwe([ao(bR)],iwe.prototype,"_abilityService",2),nwe([ao(Rue)],iwe.prototype,"_copyCutService",2),nwe([ao(Nue)],iwe.prototype,"_pasteService",2),iwe=nwe([io({contrib:[jL,yme]})],iwe);const owe=()=>{const e=X9(aR.TABLE).isReadonly(),[t,r]=Object(a.useState)(!1),n=HL(zI),i=HL(c8),o=HL(Bz),l=HL(Qz),c=null==l?void 0:l.getViewNodes(),d=Object(a.useRef)(null),f=Z9(),[h,p]=Object(a.useState)((null==f?void 0:f.get("name"))||"");Object(a.useEffect)((()=>{p((null==f?void 0:f.get("name"))||"")}),[f]);const g=Object(a.useMemo)((()=>{let e=0;for(let t=0;t<h.length;t++)e+=h.charCodeAt(t)>255?14:7;return e+16}),[h]),m=e=>{var t,i;const o=((null==(t=e.target)?void 0:t.value)||"").trim()||Ph("表格视图");n.execCommand("updateViewName",{viewId:null==f?void 0:f.get("uuid"),name:o}),r(!1),null==(i=d.current)||i.blur()},v=Array.from(c).map((e=>e[1])).find((e=>e.viewType===(null==f?void 0:f.get("type"))));return v?s.a.createElement("div",{className:"view-manage-signal-toolbar-item"},s.a.createElement("div",{onClick:()=>{e||r(!0)},id:"lakex-table-toolbar-view-manage",className:qL("view-manage",!t&&"view-manage-normal")},v.icon({className:v.colorCls,size:16}),s.a.createElement(u.a,{ref:d,onClick:()=>{var e;null==(e=d.current)||e.focus()},onMouseDown:e=>{e.stopPropagation()},value:h,style:{width:g},onChange:e=>{const t=e.target.value;p(t)},onBlur:m,onPressEnter:m,bordered:!1,className:qL("input-name",e&&"input-name-disable"),placeholder:Ph("视图名称")})),!e&&(null==o?void 0:o.isActive)&&s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:e=>{const t=e.currentTarget;null==i||i.open("add-view",{position:{origin:t,placement:"bottom"}})}},s.a.createElement(XU,{type:"Add"}),s.a.createElement("span",{className:"toolbar-button-title"},Ph("新建视图")))):null},awe=({onCommand:e})=>{const t=Q9(),r=Z9(),n=HL(Qz),i=null==n?void 0:n.getViewNodes();if(Object(a.useMemo)((()=>1===t.length),[t]))return s.a.createElement(owe,null);const o=Array.from(i).map((e=>e[1])).find((e=>e.viewType===(null==r?void 0:r.get("type"))));return o?s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{className:"lakex-workbench-toolbar-button view-manage-multiple-toolbar-item",onClick:e,tabIndex:-1},o.icon({className:o.colorCls,size:16}),s.a.createElement("span",{className:"lakex-table-view-manage-title"},null==r?void 0:r.get("name")),s.a.createElement(XU,{type:"ArrowDown"}))):null},swe=e=>{const t=HL(c8),r=HL(zI),n=HL(PH),i=HL(lp),o=HL(Qz),l=X9(aR.TABLE).isReadonly(),c=null==o?void 0:o.getViewNodes(),u=Object(a.useMemo)((()=>{if(c){const e=i.getValue("viewerManage.viewTypes"),t=Array.from(c).map((e=>e[1]));return e.map((e=>{const r=t.find((t=>t.viewType===e));return r?{key:e,icon:r.icon({className:r.colorCls,size:16}),title:r.title,desc:r.desc}:null})).filter((e=>!!e))}return[]}),[c]),d=Object(a.useMemo)((()=>e.hasTitle?[{icon:s.a.createElement(XU,{type:"Add"}),title:s.a.createElement("span",null,Ph("新建视图")),children:u}]:u),[e.hasTitle]);return s.a.createElement(nz,{menuKey:"addView",configs:d,onClick:e=>{const i=To(32);r.execCommand("addView",{uuid:i,type:e.key}),null==n||n.open("view",i),t.close("add-view"),t.close("view-manage")},className:qL({"lakex-table-menu-container":!0,"lakex-table-view-create":!0,"lakex-table-view-create-no-title":!e.hasTitle}),onDoubleClick:()=>{},onInputBlur:()=>{},readonly:l})};swe.defaultProps={hasTitle:!1};const lwe=[{key:"rename",title:Ph("重命名视图")},{key:"copy",title:Ph("复制视图")},{key:"remove",title:Ph("删除视图")}],cwe=()=>{const e=HL(c8),t=HL(zI),r=HL(PH),n=HL(zde),i=HL(Qz),o=HL(lp),s=X9(aR.TABLE).isReadonly(),l=Q9(),c=Z9(),[u,d]=Object(a.useState)(null),f=i.getViewNodes(),h=Object(a.useMemo)((()=>{const e=o.getValue("viewerManage.viewTypes");return Vp(l,(t=>e.includes(t.get("type"))))}),[l]),p=(r,n)=>{var i;const o=r.key,a=n.key;switch(null==(i=n.domEvent)||i.stopPropagation(),a){case"rename":d(o);break;case"copy":t.execCommand("copyView",{viewId:o}),e.close("view-manage");break;case"remove":if(h.length<=1)return;t.execCommand("removeView",{viewId:o}),e.close("view-manage")}},g=()=>{d(null)},m=(e,r)=>{e.stopPropagation(),t.execCommand("updateViewName",{viewId:r.key,name:e.target.value}),g()},v=Object(a.useCallback)(((e={unActiveViewColor:!1})=>Bp(h,(t=>{const r=Array.from(f).map((e=>e[1])).find((e=>e.viewType===t.get("type")));if(!r)return null;let n;return n=e.unActiveViewColor&&(null==c?void 0:c.get("uuid"))!==t.get("uuid")?"":r.colorCls,{key:t.get("uuid"),title:t.get("name"),icon:r.icon({className:n,size:16}),onSettingClick:p,onTitleChange:m,settings:lwe,draggable:!0}})).filter((e=>!!e))),[l]);return{views:l,isReadonly:s,activeView:c,onModalClose:()=>{e.close("view-manage")},onChooseView:t=>{if(u)return;const n=t.key,i=Fp(h,(e=>e.get("uuid")===n));i&&(null==r||r.open("view",i.get("uuid")),e.close("view-manage"))},onRenameView:e=>{d(e.key)},editingKey:u,onDragEnd:e=>{const{active:t,over:r}=e;t.id!==r.id&&n.updateViewOrder(t.id,r.id)},onCancelEditing:g,onViewNameChange:m,onHandleSetting:p,getChooseConfigs:v}},uwe=()=>{const{views:e,getChooseConfigs:t,onChooseView:r,onRenameView:n,onCancelEditing:i,onDragEnd:o,isReadonly:a,editingKey:l,activeView:c}=cwe();if(e.length<=1)return null;const u=t();return s.a.createElement("div",{className:"lakex-table-menu-container lakex-table-view-manage"},s.a.createElement(nz,{menuKey:u.map((e=>null==e?void 0:e.title)).join(","),configs:u,onClick:r,onDoubleClick:()=>!a&&n,defaultSelectedKeys:[(null==c?void 0:c.get("uuid"))||""],onInputBlur:i,editingKey:l,className:"lakex-table-view-manage-inner",readonly:a,onDragEnd:o,draggable:!a}),!a&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-view-manage-hr"}),s.a.createElement(swe,{hasTitle:!0})))},dwe=e=>{const{getChooseConfigs:t,onChooseView:r,onModalClose:n,activeView:i}=cwe();return s.a.createElement(rbe,{title:Ph("切换视图"),onClose:n,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:i.get("uuid"),list:t(),onCheck:e=>r(e)}))};var fwe=(e=>(e.MENU="menu",e.TAB="tab",e))(fwe||{});const hwe=Object(a.createContext)(null);var pwe=a.forwardRef((function(e,t){var r=e.prefixCls,n=e.className,i=e.style,o=e.id,s=e.active,l=e.tabKey,c=e.children;return a.createElement("div",{id:o&&"".concat(o,"-panel-").concat(l),role:"tabpanel",tabIndex:s?0:-1,"aria-labelledby":o&&"".concat(o,"-tab-").concat(l),"aria-hidden":!s,style:i,className:qL(r,s&&"".concat(r,"-active"),n),ref:t},c)}));"production"!==Ni.exports.env.NODE_ENV&&(pwe.displayName="TabPane");var gwe=["key","forceRender","style","className","destroyInactiveTabPane"];function mwe(e){var t=e.id,r=e.activeKey,n=e.animated,i=e.tabPosition,o=e.destroyInactiveTabPane,s=a.useContext(hwe),l=s.prefixCls,c=s.tabs,u=n.tabPane,d="".concat(l,"-tabpane");return a.createElement("div",{className:qL("".concat(l,"-content-holder"))},a.createElement("div",{className:qL("".concat(l,"-content"),"".concat(l,"-content-").concat(i),cK({},"".concat(l,"-content-animated"),u))},c.map((function(e){var i=e.key,s=e.forceRender,l=e.style,c=e.className,f=e.destroyInactiveTabPane,h=bK(e,gwe),p=i===r;return a.createElement(hJ,aK({key:i,visible:p,forceRender:s,removeOnLeave:!(!o&&!f),leavedClassName:"".concat(d,"-hidden")},n.tabPaneMotion),(function(e,r){var n=e.style,o=e.className;return a.createElement(pwe,aK({},h,{prefixCls:d,id:t,tabKey:i,animated:u,active:p,style:mK(mK({},l),n),className:qL(c,o),ref:r}))}))}))))}var vwe=a.createContext(null);var ywe=new Map;var bwe=new T3((function(e){e.forEach((function(e){var t,r=e.target;null===(t=ywe.get(r))||void 0===t||t.forEach((function(e){return e(r)}))}))}));Ni.exports.env.NODE_ENV,Ni.exports.env.NODE_ENV;var _we=function(e){OK(r,e);var t=RK(r);function r(){return CK(this,r),t.apply(this,arguments)}return SK(r,[{key:"render",value:function(){return this.props.children}}]),r}(a.Component);function wwe(e,t){var r=e.children,n=e.disabled,i=a.useRef(null),o=a.useRef(null),s=a.useContext(vwe),l="function"==typeof r,c=l?r(i):r,u=a.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),d=!l&&a.isValidElement(c)&&xY(c),f=kY(d?c.ref:null,i),h=function(){var e;return CY(i.current)||(i.current&&"object"===sK(i.current)?CY(null===(e=i.current)||void 0===e?void 0:e.nativeElement):null)||CY(o.current)};a.useImperativeHandle(t,(function(){return h()}));var p=a.useRef(e);p.current=e;var g=a.useCallback((function(e){var t=p.current,r=t.onResize,n=t.data,i=e.getBoundingClientRect(),o=i.width,a=i.height,l=e.offsetWidth,c=e.offsetHeight,d=Math.floor(o),f=Math.floor(a);if(u.current.width!==d||u.current.height!==f||u.current.offsetWidth!==l||u.current.offsetHeight!==c){var h={width:d,height:f,offsetWidth:l,offsetHeight:c};u.current=h;var g=l===Math.round(o)?o:l,m=c===Math.round(a)?a:c,v=mK(mK({},h),{},{offsetWidth:g,offsetHeight:m});null==s||s(v,e,n),r&&Promise.resolve().then((function(){r(v,e)}))}}),[]);return a.useEffect((function(){var e=h();return e&&!n&&function(e,t){ywe.has(e)||(ywe.set(e,new Set),bwe.observe(e)),ywe.get(e).add(t)}(e,g),function(){return function(e,t){ywe.has(e)&&(ywe.get(e).delete(t),ywe.get(e).size||(bwe.unobserve(e),ywe.delete(e)))}(e,g)}}),[i.current,n]),a.createElement(_we,{ref:o},d?a.cloneElement(c,{ref:f}):c)}var Cwe=a.forwardRef(wwe);"production"!==Ni.exports.env.NODE_ENV&&(Cwe.displayName="SingleObserver");function Ewe(e,t){var r=e.children,n="function"==typeof r?[r]:PK(r);return"production"!==Ni.exports.env.NODE_ENV&&(n.length>1?VK(!1,"Find more than one child node with `children` in ResizeObserver. Please use ResizeObserver.Collection instead."):0===n.length&&VK(!1,"`children` of ResizeObserver is empty. Nothing is in observe.")),n.map((function(r,n){var i=(null==r?void 0:r.key)||"".concat("rc-observer-key","-").concat(n);return a.createElement(Cwe,aK({},e,{key:i,ref:0===n?t:void 0}),r)}))}var Swe=a.forwardRef(Ewe);"production"!==Ni.exports.env.NODE_ENV&&(Swe.displayName="ResizeObserver"),Swe.Collection=function(e){var t=e.children,r=e.onBatchResize,n=a.useRef(0),i=a.useRef([]),o=a.useContext(vwe),s=a.useCallback((function(e,t,a){n.current+=1;var s=n.current;i.current.push({size:e,element:t,data:a}),Promise.resolve().then((function(){s===n.current&&(null==r||r(i.current),i.current=[])})),null==o||o(e,t,a)}),[r,o]);return a.createElement(vwe.Provider,{value:s},t)};var kwe={width:0,height:0,left:0,top:0};function xwe(e,t){var r=a.useRef(e),n=pK(a.useState({}),2)[1];return[r.current,function(e){var i="function"==typeof e?e(r.current):e;i!==r.current&&t(i,r.current),r.current=i,n({})}]}var Owe=.1,Iwe=.01,Rwe=20,Twe=Math.pow(.995,Rwe);function Awe(e){var t=pK(Object(a.useState)(0),2),r=t[0],n=t[1],i=Object(a.useRef)(0),o=Object(a.useRef)();return o.current=e,E0((function(){var e;null===(e=o.current)||void 0===e||e.call(o)}),[r]),function(){i.current===r&&(i.current+=1,n(i.current))}}var Mwe={width:0,height:0,left:0,top:0,right:0};function Nwe(e){var t;return e instanceof Map?(t={},e.forEach((function(e,r){t[r]=e}))):t=e,JSON.stringify(t)}var Dwe="TABS_DQ";function Pwe(e){return String(e).replace(/"/g,Dwe)}function jwe(e,t,r,n){return!(!r||n||!1===e||void 0===e&&(!1===t||null===t))}function Fwe(e,t){var r=e.prefixCls,n=e.editable,i=e.locale,o=e.style;return n&&!1!==n.showAdd?a.createElement("button",{ref:t,type:"button",className:"".concat(r,"-nav-add"),style:o,"aria-label":(null==i?void 0:i.addAriaLabel)||"Add tab",onClick:function(e){n.onEdit("add",{event:e})}},n.addIcon||"+"):null}const Vwe=a.forwardRef(Fwe);var Lwe=a.forwardRef((function(e,t){var r=e.position,n=e.prefixCls,i=e.extra;if(!i)return null;var o,s={};return"object"!==sK(i)||a.isValidElement(i)?s.right=i:s=i,"right"===r&&(o=s.right),"left"===r&&(o=s.left),o?a.createElement("div",{className:"".concat(n,"-extra-content"),ref:t},o):null}));"production"!==Ni.exports.env.NODE_ENV&&(Lwe.displayName="ExtraContent");var $we,Bwe=a.createContext(null),Uwe=[];function zwe(e){var t=e.match(/^(.*)px$/),r=Number(null==t?void 0:t[1]);return Number.isNaN(r)?function(e){if(typeof document>"u")return 0;if(e||void 0===$we){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var r=document.createElement("div"),n=r.style;n.position="absolute",n.top="0",n.left="0",n.pointerEvents="none",n.visibility="hidden",n.width="200px",n.height="150px",n.overflow="hidden",r.appendChild(t),document.body.appendChild(r);var i=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;i===o&&(o=r.clientWidth),document.body.removeChild(r),$we=i-o}return $we}():r}var Hwe="rc-util-locker-".concat(Date.now()),Wwe=0;function Gwe(e){var t=!!e,r=pK(a.useState((function(){return Wwe+=1,"".concat(Hwe,"_").concat(Wwe)})),1)[0];C0((function(){if(t){var e=function(e){if(typeof document>"u"||!e||!(e instanceof Element))return{width:0,height:0};var t=getComputedStyle(e,"::-webkit-scrollbar"),r=t.width,n=t.height;return{width:zwe(r),height:zwe(n)}}(document.body).width,n=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth;dX("\nhtml body {\n  overflow-y: hidden;\n  ".concat(n?"width: calc(100% - ".concat(e,"px);"):"","\n}"),r)}else uX(r);return function(){uX(r)}}),[t,r])}var Kwe=!1;var qwe=function(e){return!1!==e&&($Y()&&e?"string"==typeof e?document.querySelector(e):"function"==typeof e?e():e:null)},Ywe=a.forwardRef((function(e,t){var r=e.open,n=e.autoLock,i=e.getContainer,o=e.debug,s=e.autoDestroy,c=void 0===s||s,u=e.children,d=pK(a.useState(r),2),f=d[0],h=d[1],p=f||r;"production"!==Ni.exports.env.NODE_ENV&&BK($Y()||!r,"Portal only work in client side. Please call 'useEffect' to show Portal instead default render in SSR."),a.useEffect((function(){(c||r)&&h(r)}),[r,c]);var g=pK(a.useState((function(){return qwe(i)})),2),m=g[0],v=g[1];a.useEffect((function(){var e=qwe(i);v(null!=e?e:null)}));var y=function(e,t){var r=pK(a.useState((function(){if(!$Y())return null;var e=document.createElement("div");return"production"!==Ni.exports.env.NODE_ENV&&t&&e.setAttribute("data-debug",t),e})),1)[0],n=a.useRef(!1),i=a.useContext(Bwe),o=pK(a.useState(Uwe),2),s=o[0],l=o[1],c=i||(n.current?void 0:function(e){l((function(t){return[e].concat(wK(t))}))});function u(){r.parentElement||document.body.appendChild(r),n.current=!0}function d(){var e;null===(e=r.parentElement)||void 0===e||e.removeChild(r),n.current=!1}return C0((function(){return e?i?i(u):u():d(),d}),[e]),C0((function(){s.length&&(s.forEach((function(e){return e()})),l(Uwe))}),[s]),[r,c]}(p&&!m,o),b=pK(y,2),_=b[0],w=b[1],C=null!=m?m:_;Gwe(n&&r&&$Y()&&(C===_||C===document.body));var E=null;u&&xY(u)&&t&&(E=u.ref);var S=kY(E,t);if(!p||!$Y()||void 0===m)return null;var k=!1===C||function(e){return"boolean"==typeof e&&(Kwe=e),Kwe}(),x=u;return t&&(x=a.cloneElement(u,{ref:S})),a.createElement(Bwe.Provider,{value:w},k?x:Object(l.createPortal)(x,C))}));function Jwe(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}function Xwe(e){return function(e){return Jwe(e)instanceof ShadowRoot}(e)?Jwe(e):null}"production"!==Ni.exports.env.NODE_ENV&&(Ywe.displayName="Portal");var Zwe=0,Qwe=mK({},a).useId;const eCe=Qwe?function(e){var t=Qwe();return e||("test"===Ni.exports.env.NODE_ENV?"test-id":t)}:function(e){var t=pK(a.useState("ssr-id"),2),r=t[0],n=t[1];return a.useEffect((function(){var e=Zwe;Zwe+=1,n("rc_unique_".concat(e))}),[]),e||("test"===Ni.exports.env.NODE_ENV?"test-id":r)};var tCe=a.createContext(null);function rCe(e){return e?Array.isArray(e)?e:[e]:[]}function nCe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>2?arguments[2]:void 0)?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function iCe(e,t,r,n){return t||(r?{motionName:"".concat(e,"-").concat(r)}:n?{motionName:n}:null)}function oCe(e){return e.ownerDocument.defaultView}function aCe(e){for(var t=[],r=null==e?void 0:e.parentElement,n=["hidden","scroll","clip","auto"];r;){var i=oCe(r).getComputedStyle(r);[i.overflowX,i.overflowY,i.overflow].some((function(e){return n.includes(e)}))&&t.push(r),r=r.parentElement}return t}function sCe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Number.isNaN(e)?t:e}function lCe(e){return sCe(parseFloat(e),0)}function cCe(e,t){var r=mK({},e);return(t||[]).forEach((function(e){if(!(e instanceof HTMLBodyElement||e instanceof HTMLHtmlElement)){var t=oCe(e).getComputedStyle(e),n=t.overflow,i=t.overflowClipMargin,o=t.borderTopWidth,a=t.borderBottomWidth,s=t.borderLeftWidth,l=t.borderRightWidth,c=e.getBoundingClientRect(),u=e.offsetHeight,d=e.clientHeight,f=e.offsetWidth,h=e.clientWidth,p=lCe(o),g=lCe(a),m=lCe(s),v=lCe(l),y=sCe(Math.round(c.width/f*1e3)/1e3),b=sCe(Math.round(c.height/u*1e3)/1e3),_=(f-h-m-v)*y,w=(u-d-p-g)*b,C=p*b,E=g*b,S=m*y,k=v*y,x=0,O=0;if("clip"===n){var I=lCe(i);x=I*y,O=I*b}var R=c.x+S-x,T=c.y+C-O,A=R+c.width+2*x-S-k-_,M=T+c.height+2*O-C-E-w;r.left=Math.max(r.left,R),r.top=Math.max(r.top,T),r.right=Math.min(r.right,A),r.bottom=Math.min(r.bottom,M)}})),r}function uCe(e){var t="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),r=t.match(/^(.*)\%$/);return r?e*(parseFloat(r[1])/100):parseFloat(t)}function dCe(e,t){var r=pK(t||[],2),n=r[0],i=r[1];return[uCe(e.width,n),uCe(e.height,i)]}function fCe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[e[0],e[1]]}function hCe(e,t){var r,n=t[0],i=t[1];return r="t"===n?e.y:"b"===n?e.y+e.height:e.y+e.height/2,{x:"l"===i?e.x:"r"===i?e.x+e.width:e.x+e.width/2,y:r}}function pCe(e,t){var r={t:"b",b:"t",l:"r",r:"l"};return e.map((function(e,n){return n===t?r[e]||"c":e})).join("")}function gCe(e){var t=e.prefixCls,r=e.align,n=e.arrow,i=e.arrowPos,o=n||{},s=o.className,l=o.content,c=i.x,u=void 0===c?0:c,d=i.y,f=void 0===d?0:d,h=a.useRef();if(!r||!r.points)return null;var p={position:"absolute"};if(!1!==r.autoArrow){var g=r.points[0],m=r.points[1],v=g[0],y=g[1],b=m[0],_=m[1];v!==b&&["t","b"].includes(v)?"t"===v?p.top=0:p.bottom=0:p.top=f,y!==_&&["l","r"].includes(y)?"l"===y?p.left=0:p.right=0:p.left=u}return a.createElement("div",{ref:h,className:qL("".concat(t,"-arrow"),s),style:p},l)}function mCe(e){var t=e.prefixCls,r=e.open,n=e.zIndex,i=e.mask,o=e.motion;return i?a.createElement(hJ,aK({},o,{motionAppear:!0,visible:r,removeOnLeave:!0}),(function(e){var r=e.className;return a.createElement("div",{style:{zIndex:n},className:qL("".concat(t,"-mask"),r)})})):null}var vCe=a.memo((function(e){return e.children}),(function(e,t){return t.cache}));"production"!==Ni.exports.env.NODE_ENV&&(vCe.displayName="PopupContent");var yCe=a.forwardRef((function(e,t){var r=e.popup,n=e.className,i=e.prefixCls,o=e.style,s=e.target,l=e.onVisibleChanged,c=e.open,u=e.keepDom,d=e.fresh,f=e.onClick,h=e.mask,p=e.arrow,g=e.arrowPos,m=e.align,v=e.motion,y=e.maskMotion,b=e.forceRender,_=e.getPopupContainer,w=e.autoDestroy,C=e.portal,E=e.zIndex,S=e.onMouseEnter,k=e.onMouseLeave,x=e.onPointerEnter,O=e.ready,I=e.offsetX,R=e.offsetY,T=e.offsetR,A=e.offsetB,M=e.onAlign,N=e.onPrepare,D=e.stretch,P=e.targetWidth,j=e.targetHeight,F="function"==typeof r?r():r,V=c||u,L=(null==_?void 0:_.length)>0,$=pK(a.useState(!_||!L),2),B=$[0],U=$[1];if(C0((function(){!B&&L&&s&&U(!0)}),[B,L,s]),!B)return null;var z="auto",H={left:"-1000vw",top:"-1000vh",right:z,bottom:z};if(O||!c){var W,G=m.points,K=m.dynamicInset||(null===(W=m._experimental)||void 0===W?void 0:W.dynamicInset),q=K&&"r"===G[0][1],Y=K&&"b"===G[0][0];q?(H.right=T,H.left=z):(H.left=I,H.right=z),Y?(H.bottom=A,H.top=z):(H.top=R,H.bottom=z)}var J={};return D&&(D.includes("height")&&j?J.height=j:D.includes("minHeight")&&j&&(J.minHeight=j),D.includes("width")&&P?J.width=P:D.includes("minWidth")&&P&&(J.minWidth=P)),c||(J.pointerEvents="none"),a.createElement(C,{open:b||V,getContainer:_&&function(){return _(s)},autoDestroy:w},a.createElement(mCe,{prefixCls:i,open:c,zIndex:E,mask:h,motion:y}),a.createElement(Swe,{onResize:M,disabled:!c},(function(e){return a.createElement(hJ,aK({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:b,leavedClassName:"".concat(i,"-hidden")},v,{onAppearPrepare:N,onEnterPrepare:N,visible:c,onVisibleChanged:function(e){var t;null==v||null===(t=v.onVisibleChanged)||void 0===t||t.call(v,e),l(e)}}),(function(r,s){var l=r.className,u=r.style,h=qL(i,l,n);return a.createElement("div",{ref:SY(e,t,s),className:h,style:mK(mK(mK(mK({"--arrow-x":"".concat(g.x||0,"px"),"--arrow-y":"".concat(g.y||0,"px")},H),J),u),{},{boxSizing:"border-box",zIndex:E},o),onMouseEnter:S,onMouseLeave:k,onPointerEnter:x,onClick:f},p&&a.createElement(gCe,{prefixCls:i,arrow:p,arrowPos:g,align:m}),a.createElement(vCe,{cache:!c&&!d},F))}))})))}));"production"!==Ni.exports.env.NODE_ENV&&(yCe.displayName="Popup");var bCe=a.forwardRef((function(e,t){var r=e.children,n=e.getTriggerDOMNode,i=xY(r),o=kY(a.useCallback((function(e){EY(t,n?n(e):e)}),[n]),r.ref);return i?a.cloneElement(r,{ref:o}):r}));"production"!==Ni.exports.env.NODE_ENV&&(bCe.displayName="TriggerWrapper");var _Ce=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];const wCe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ywe,t=a.forwardRef((function(t,r){var n=t.prefixCls,i=void 0===n?"rc-trigger-popup":n,o=t.children,s=t.action,c=void 0===s?"hover":s,u=t.showAction,d=t.hideAction,f=t.popupVisible,h=t.defaultPopupVisible,p=t.onPopupVisibleChange,g=t.afterPopupVisibleChange,m=t.mouseEnterDelay,v=t.mouseLeaveDelay,y=void 0===v?.1:v,b=t.focusDelay,_=t.blurDelay,w=t.mask,C=t.maskClosable,E=void 0===C||C,S=t.getPopupContainer,k=t.forceRender,x=t.autoDestroy,O=t.destroyPopupOnHide,I=t.popup,R=t.popupClassName,T=t.popupStyle,A=t.popupPlacement,M=t.builtinPlacements,N=void 0===M?{}:M,D=t.popupAlign,P=t.zIndex,j=t.stretch,F=t.getPopupClassNameFromAlign,V=t.fresh,L=t.alignPoint,$=t.onPopupClick,B=t.onPopupAlign,U=t.arrow,z=t.popupMotion,H=t.maskMotion,W=t.popupTransitionName,G=t.popupAnimation,K=t.maskTransitionName,q=t.maskAnimation,Y=t.className,J=t.getTriggerDOMNode,X=bK(t,_Ce),Z=x||O||!1,Q=pK(a.useState(!1),2),ee=Q[0],te=Q[1];C0((function(){te(e2())}),[]);var re=a.useRef({}),ne=a.useContext(tCe),ie=a.useMemo((function(){return{registerSubPopup:function(e,t){re.current[e]=t,null==ne||ne.registerSubPopup(e,t)}}}),[ne]),oe=eCe(),ae=pK(a.useState(null),2),se=ae[0],le=ae[1],ce=_0((function(e){wY(e)&&se!==e&&le(e),null==ne||ne.registerSubPopup(oe,e)})),ue=pK(a.useState(null),2),de=ue[0],fe=ue[1],he=_0((function(e){wY(e)&&de!==e&&fe(e)})),pe=a.Children.only(o),ge=(null==pe?void 0:pe.props)||{},me={},ve=_0((function(e){var t,r,n=de;return(null==n?void 0:n.contains(e))||(null===(t=Xwe(n))||void 0===t?void 0:t.host)===e||e===n||(null==se?void 0:se.contains(e))||(null===(r=Xwe(se))||void 0===r?void 0:r.host)===e||e===se||Object.values(re.current).some((function(t){return(null==t?void 0:t.contains(e))||e===t}))})),ye=iCe(i,z,G,W),be=iCe(i,H,q,K),_e=pK(a.useState(h||!1),2),we=_e[0],Ce=_e[1],Ee=null!=f?f:we,Se=_0((function(e){void 0===f&&Ce(e)}));C0((function(){Ce(f||!1)}),[f]);var ke=a.useRef(Ee);ke.current=Ee;var xe=_0((function(e){Object(l.flushSync)((function(){Ee!==e&&(Se(e),null==p||p(e))}))})),Oe=a.useRef(),Ie=function(){clearTimeout(Oe.current)},Re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Ie(),0===t?xe(e):Oe.current=setTimeout((function(){xe(e)}),1e3*t)};a.useEffect((function(){return Ie}),[]);var Te=pK(a.useState(!1),2),Ae=Te[0],Me=Te[1];C0((function(e){(!e||Ee)&&Me(!0)}),[Ee]);var Ne=pK(a.useState(null),2),De=Ne[0],Pe=Ne[1],je=pK(a.useState([0,0]),2),Fe=je[0],Ve=je[1],Le=function(e){Ve([e.clientX,e.clientY])},$e=function(e,t,r,n,i,o,s){var l=pK(a.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:i[n]||{}}),2),c=l[0],u=l[1],d=a.useRef(0),f=a.useMemo((function(){return t?aCe(t):[]}),[t]),h=a.useRef({});e||(h.current={});var p=_0((function(){if(t&&r&&e){let e=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:G,n=x.x+e,i=x.y+t,o=n+P,a=i+D,s=Math.max(n,r.left),l=Math.max(i,r.top),c=Math.min(o,r.right),u=Math.min(a,r.bottom);return Math.max(0,(c-s)*(u-l))},at=function(){oe=x.y+ve,ae=oe+D,se=x.x+me,le=se+P};var a,l,c,d=t,p=d.ownerDocument,g=oCe(d).getComputedStyle(d),m=g.width,v=g.height,y=g.position,b=d.style.left,_=d.style.top,w=d.style.right,C=d.style.bottom,E=mK(mK({},i[n]),o),S=p.createElement("div");if(null===(a=d.parentElement)||void 0===a||a.appendChild(S),S.style.left="".concat(d.offsetLeft,"px"),S.style.top="".concat(d.offsetTop,"px"),S.style.position=y,S.style.height="".concat(d.offsetHeight,"px"),S.style.width="".concat(d.offsetWidth,"px"),d.style.left="0",d.style.top="0",d.style.right="auto",d.style.bottom="auto",Array.isArray(r))c={x:r[0],y:r[1],width:0,height:0};else{var k=r.getBoundingClientRect();c={x:k.x,y:k.y,width:k.width,height:k.height}}var x=d.getBoundingClientRect(),O=p.documentElement,I=O.clientWidth,R=O.clientHeight,T=O.scrollWidth,A=O.scrollHeight,M=O.scrollTop,N=O.scrollLeft,D=x.height,P=x.width,j=c.height,F=c.width,V={left:0,top:0,right:I,bottom:R},L={left:-N,top:-M,right:T-N,bottom:A-M},$=E.htmlRegion,B="visible",U="visibleFirst";"scroll"!==$&&$!==U&&($=B);var z=$===U,H=cCe(L,f),W=cCe(V,f),G=$===B?W:H,K=z?W:G;d.style.left="auto",d.style.top="auto",d.style.right="0",d.style.bottom="0";var q=d.getBoundingClientRect();d.style.left=b,d.style.top=_,d.style.right=w,d.style.bottom=C,null===(l=d.parentElement)||void 0===l||l.removeChild(S);var Y=sCe(Math.round(P/parseFloat(m)*1e3)/1e3),J=sCe(Math.round(D/parseFloat(v)*1e3)/1e3);if(0===Y||0===J||wY(r)&&!V0(r))return;var X=E.offset,Z=E.targetOffset,Q=pK(dCe(x,X),2),ee=Q[0],te=Q[1],re=pK(dCe(c,Z),2),ne=re[0],ie=re[1];c.x-=ne,c.y-=ie;var oe,ae,se,le,ce=pK(E.points||[],2),ue=ce[0],de=fCe(ce[1]),fe=fCe(ue),he=hCe(c,de),pe=hCe(x,fe),ge=mK({},E),me=he.x-pe.x+ee,ve=he.y-pe.y+te,ye=e(me,ve),be=e(me,ve,W),_e=hCe(c,["t","l"]),we=hCe(x,["t","l"]),Ce=hCe(c,["b","r"]),Ee=hCe(x,["b","r"]),Se=E.overflow||{},ke=Se.adjustX,xe=Se.adjustY,Oe=Se.shiftX,Ie=Se.shiftY,Re=function(e){return"boolean"==typeof e?e:e>=0};at();var Te=Re(xe),Ae=fe[0]===de[0];if(Te&&"t"===fe[0]&&(ae>K.bottom||h.current.bt)){var Me=ve;Ae?Me-=D-j:Me=_e.y-Ee.y-te;var Ne=e(me,Me),De=e(me,Me,W);Ne>ye||Ne===ye&&(!z||De>=be)?(h.current.bt=!0,ve=Me,te=-te,ge.points=[pCe(fe,0),pCe(de,0)]):h.current.bt=!1}if(Te&&"b"===fe[0]&&(oe<K.top||h.current.tb)){var Pe=ve;Ae?Pe+=D-j:Pe=Ce.y-we.y-te;var je=e(me,Pe),Fe=e(me,Pe,W);je>ye||je===ye&&(!z||Fe>=be)?(h.current.tb=!0,ve=Pe,te=-te,ge.points=[pCe(fe,0),pCe(de,0)]):h.current.tb=!1}var Ve=Re(ke),Le=fe[1]===de[1];if(Ve&&"l"===fe[1]&&(le>K.right||h.current.rl)){var $e=me;Le?$e-=P-F:$e=_e.x-Ee.x-ee;var Be=e($e,ve),Ue=e($e,ve,W);Be>ye||Be===ye&&(!z||Ue>=be)?(h.current.rl=!0,me=$e,ee=-ee,ge.points=[pCe(fe,1),pCe(de,1)]):h.current.rl=!1}if(Ve&&"r"===fe[1]&&(se<K.left||h.current.lr)){var ze=me;Le?ze+=P-F:ze=Ce.x-we.x-ee;var He=e(ze,ve),We=e(ze,ve,W);He>ye||He===ye&&(!z||We>=be)?(h.current.lr=!0,me=ze,ee=-ee,ge.points=[pCe(fe,1),pCe(de,1)]):h.current.lr=!1}at();var Ge=!0===Oe?0:Oe;"number"==typeof Ge&&(se<W.left&&(me-=se-W.left-ee,c.x+F<W.left+Ge&&(me+=c.x-W.left+F-Ge)),le>W.right&&(me-=le-W.right-ee,c.x>W.right-Ge&&(me+=c.x-W.right+Ge)));var Ke=!0===Ie?0:Ie;"number"==typeof Ke&&(oe<W.top&&(ve-=oe-W.top-te,c.y+j<W.top+Ke&&(ve+=c.y-W.top+j-Ke)),ae>W.bottom&&(ve-=ae-W.bottom-te,c.y>W.bottom-Ke&&(ve+=c.y-W.bottom+Ke)));var qe=x.x+me,Ye=qe+P,Je=x.y+ve,Xe=Je+D,Ze=c.x,Qe=Ze+F,et=c.y,tt=et+j,rt=(Math.max(qe,Ze)+Math.min(Ye,Qe))/2-qe,nt=(Math.max(Je,et)+Math.min(Xe,tt))/2-Je;null==s||s(t,ge);var it=q.right-x.x-(me+x.width),ot=q.bottom-x.y-(ve+x.height);u({ready:!0,offsetX:me/Y,offsetY:ve/J,offsetR:it/Y,offsetB:ot/J,arrowX:rt/Y,arrowY:nt/J,scaleX:Y,scaleY:J,align:ge})}})),g=function(){u((function(e){return mK(mK({},e),{},{ready:!1})}))};return C0(g,[n]),C0((function(){e||g()}),[e]),[c.ready,c.offsetX,c.offsetY,c.offsetR,c.offsetB,c.arrowX,c.arrowY,c.scaleX,c.scaleY,c.align,function(){d.current+=1;var e=d.current;Promise.resolve().then((function(){d.current===e&&p()}))}]}(Ee,se,L?Fe:de,A,N,D,B),Be=pK($e,11),Ue=Be[0],ze=Be[1],He=Be[2],We=Be[3],Ge=Be[4],Ke=Be[5],qe=Be[6],Ye=Be[7],Je=Be[8],Xe=Be[9],Ze=Be[10],Qe=function(e,t,r,n){return a.useMemo((function(){var i=rCe(null!=r?r:t),o=rCe(null!=n?n:t),a=new Set(i),s=new Set(o);return e&&(a.has("hover")&&(a.delete("hover"),a.add("click")),s.has("hover")&&(s.delete("hover"),s.add("click"))),[a,s]}),[e,t,r,n])}(ee,c,u,d),et=pK(Qe,2),tt=et[0],rt=et[1],nt=tt.has("click"),it=rt.has("click")||rt.has("contextMenu"),ot=_0((function(){Ae||Ze()}));(function(e,t,r,n,i){C0((function(){if(e&&t&&r){let e=function(){n(),i()};var o=r,a=aCe(t),s=aCe(o),l=oCe(o),c=new Set([l].concat(wK(a),wK(s)));return c.forEach((function(t){t.addEventListener("scroll",e,{passive:!0})})),l.addEventListener("resize",e,{passive:!0}),n(),function(){c.forEach((function(t){t.removeEventListener("scroll",e),l.removeEventListener("resize",e)}))}}}),[e,t,r])})(Ee,de,se,ot,(function(){ke.current&&L&&it&&Re(!1)})),C0((function(){ot()}),[Fe,A]),C0((function(){Ee&&(null==N||!N[A])&&ot()}),[JSON.stringify(D)]);var at=a.useMemo((function(){var e=function(e,t,r,n){for(var i=r.points,o=Object.keys(e),a=0;a<o.length;a+=1){var s,l=o[a];if(nCe(null===(s=e[l])||void 0===s?void 0:s.points,i,n))return"".concat(t,"-placement-").concat(l)}return""}(N,i,Xe,L);return qL(e,null==F?void 0:F(Xe))}),[Xe,F,N,i,L]);a.useImperativeHandle(r,(function(){return{forceAlign:ot}}));var st=pK(a.useState(0),2),lt=st[0],ct=st[1],ut=pK(a.useState(0),2),dt=ut[0],ft=ut[1],ht=function(){if(j&&de){var e=de.getBoundingClientRect();ct(e.width),ft(e.height)}};function pt(e,t,r,n){me[e]=function(i){var o;null==n||n(i),Re(t,r);for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];null===(o=ge[e])||void 0===o||o.call.apply(o,[ge,i].concat(s))}}C0((function(){De&&(Ze(),De(),Pe(null))}),[De]),(nt||it)&&(me.onClick=function(e){var t;ke.current&&it?Re(!1):!ke.current&&nt&&(Le(e),Re(!0));for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];null===(t=ge.onClick)||void 0===t||t.call.apply(t,[ge,e].concat(n))}),function(e,t,r,n,i,o,s,l){var c=a.useRef(e),u=a.useRef(!1);c.current!==e&&(u.current=!0,c.current=e),a.useEffect((function(){var e=aJ((function(){u.current=!1}));return function(){aJ.cancel(e)}}),[e]),a.useEffect((function(){if(t&&n&&(!i||o)){var e=function(){var e=!1;return[function(t){var r=t.target;e=s(r)},function(t){var r=t.target;!u.current&&c.current&&!e&&!s(r)&&l(!1)}]},a=pK(e(),2),d=a[0],f=a[1],h=pK(e(),2),p=h[0],g=h[1],m=oCe(n);m.addEventListener("mousedown",d,!0),m.addEventListener("click",f,!0),m.addEventListener("contextmenu",f,!0);var v,y,b=Xwe(r);return b&&(b.addEventListener("mousedown",p,!0),b.addEventListener("click",g,!0),b.addEventListener("contextmenu",g,!0)),"production"!==Ni.exports.env.NODE_ENV&&VK((null==r||null===(v=r.getRootNode)||void 0===v?void 0:v.call(r))===(null===(y=n.getRootNode)||void 0===y?void 0:y.call(n)),"trigger element and popup element should in same shadow root."),function(){m.removeEventListener("mousedown",d,!0),m.removeEventListener("click",f,!0),m.removeEventListener("contextmenu",f,!0),b&&(b.removeEventListener("mousedown",p,!0),b.removeEventListener("click",g,!0),b.removeEventListener("contextmenu",g,!0))}}}),[t,r,n,i,o])}(Ee,it,de,se,w,E,ve,Re);var gt,mt,vt=tt.has("hover"),yt=rt.has("hover");vt&&(pt("onMouseEnter",!0,m,(function(e){Le(e)})),pt("onPointerEnter",!0,m,(function(e){Le(e)})),gt=function(){(Ee||Ae)&&Re(!0,m)},L&&(me.onMouseMove=function(e){var t;null===(t=ge.onMouseMove)||void 0===t||t.call(ge,e)})),yt&&(pt("onMouseLeave",!1,y),pt("onPointerLeave",!1,y),mt=function(){Re(!1,y)}),tt.has("focus")&&pt("onFocus",!0,b),rt.has("focus")&&pt("onBlur",!1,_),tt.has("contextMenu")&&(me.onContextMenu=function(e){var t;ke.current&&rt.has("contextMenu")?Re(!1):(Le(e),Re(!0)),e.preventDefault();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];null===(t=ge.onContextMenu)||void 0===t||t.call.apply(t,[ge,e].concat(n))}),Y&&(me.className=qL(ge.className,Y));var bt=mK(mK({},ge),me),_t={};["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"].forEach((function(e){X[e]&&(_t[e]=function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];null===(t=bt[e])||void 0===t||t.call.apply(t,[bt].concat(n)),X[e].apply(X,n)})}));var wt=a.cloneElement(pe,mK(mK({},bt),_t)),Ct={x:Ke,y:qe},Et=U?mK({},!0!==U?U:{}):null;return a.createElement(a.Fragment,null,a.createElement(Swe,{disabled:!Ee,ref:he,onResize:function(){ht(),ot()}},a.createElement(bCe,{getTriggerDOMNode:J},wt)),a.createElement(tCe.Provider,{value:ie},a.createElement(yCe,{portal:e,ref:ce,prefixCls:i,popup:I,className:qL(R,at),style:T,target:de,onMouseEnter:gt,onMouseLeave:mt,onPointerEnter:gt,zIndex:P,open:Ee,keepDom:Ae,fresh:V,onClick:$,mask:w,motion:ye,maskMotion:be,onVisibleChanged:function(e){Me(!1),Ze(),null==g||g(e)},onPrepare:function(){return new Promise((function(e){ht(),Pe((function(){return e}))}))},forceRender:k,autoDestroy:Z,getPopupContainer:S,align:Xe,arrow:Et,arrowPos:Ct,ready:Ue,offsetX:ze,offsetY:He,offsetR:We,offsetB:Ge,onAlign:ot,stretch:j,targetWidth:lt/Ye,targetHeight:dt/Je})))}));return"production"!==Ni.exports.env.NODE_ENV&&(t.displayName="Trigger"),t}(Ywe);var CCe=x0.ESC,ECe=x0.TAB;var SCe=Object(a.forwardRef)((function(e,t){var r=e.overlay,n=e.arrow,i=e.prefixCls,o=Object(a.useMemo)((function(){return"function"==typeof r?r():r}),[r]),l=SY(t,null==o?void 0:o.ref);return s.a.createElement(s.a.Fragment,null,n&&s.a.createElement("div",{className:"".concat(i,"-arrow")}),s.a.cloneElement(o,{ref:xY(o)?l:void 0}))})),kCe={adjustX:1,adjustY:1},xCe=[0,0],OCe={topLeft:{points:["bl","tl"],overflow:kCe,offset:[0,-4],targetOffset:xCe},top:{points:["bc","tc"],overflow:kCe,offset:[0,-4],targetOffset:xCe},topRight:{points:["br","tr"],overflow:kCe,offset:[0,-4],targetOffset:xCe},bottomLeft:{points:["tl","bl"],overflow:kCe,offset:[0,4],targetOffset:xCe},bottom:{points:["tc","bc"],overflow:kCe,offset:[0,4],targetOffset:xCe},bottomRight:{points:["tr","br"],overflow:kCe,offset:[0,4],targetOffset:xCe}},ICe=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function RCe(e,t){var r,n=e.arrow,i=void 0!==n&&n,o=e.prefixCls,l=void 0===o?"rc-dropdown":o,c=e.transitionName,u=e.animation,d=e.align,f=e.placement,h=void 0===f?"bottomLeft":f,p=e.placements,g=void 0===p?OCe:p,m=e.getPopupContainer,v=e.showAction,y=e.hideAction,b=e.overlayClassName,_=e.overlayStyle,w=e.visible,C=e.trigger,E=void 0===C?["hover"]:C,S=e.autoFocus,k=e.overlay,x=e.children,O=e.onVisibleChange,I=bK(e,ICe),R=pK(s.a.useState(),2),T=R[0],A=R[1],M="visible"in e?w:T,N=s.a.useRef(null),D=s.a.useRef(null),P=s.a.useRef(null);s.a.useImperativeHandle(t,(function(){return N.current}));var j=function(e){A(e),null==O||O(e)};!function(e){var t=e.visible,r=e.triggerRef,n=e.onVisibleChange,i=e.autoFocus,o=e.overlayRef,s=a.useRef(!1),l=function(){var e,i;t&&(null===(e=r.current)||void 0===e||null===(i=e.focus)||void 0===i||i.call(e),null==n||n(!1))},c=function(){var e;return!(null===(e=o.current)||void 0===e||!e.focus||(o.current.focus(),s.current=!0,0))},u=function(e){switch(e.keyCode){case CCe:l();break;case ECe:var t=!1;s.current||(t=c()),t?e.preventDefault():l()}};a.useEffect((function(){return t?(window.addEventListener("keydown",u),i&&aJ(c,3),function(){window.removeEventListener("keydown",u),s.current=!1}):function(){s.current=!1}}),[t])}({visible:M,triggerRef:P,onVisibleChange:j,autoFocus:S,overlayRef:D});var F,V=function(){return s.a.createElement(SCe,{ref:D,overlay:k,prefixCls:l,arrow:i})},L=s.a.cloneElement(x,{className:qL(null===(r=x.props)||void 0===r?void 0:r.className,M&&(F=e.openClassName,void 0!==F?F:"".concat(l,"-open"))),ref:xY(x)?SY(P,x.ref):void 0}),$=y;return!$&&-1!==E.indexOf("contextMenu")&&($=["click"]),s.a.createElement(wCe,aK({builtinPlacements:g},I,{prefixCls:l,ref:N,popupClassName:qL(b,cK({},"".concat(l,"-show-arrow"),i)),popupStyle:_,action:E,showAction:v,hideAction:$,popupPlacement:h,popupAlign:d,popupTransitionName:c,popupAnimation:u,popupVisible:M,stretch:function(){var t=e.minOverlayWidthMatchTrigger,r=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!r}()?"minWidth":"",popup:"function"==typeof k?V:V(),onPopupVisibleChange:j,onPopupClick:function(t){var r=e.onOverlayClick;A(!1),r&&r(t)},getPopupContainer:m}),L)}const TCe=s.a.forwardRef(RCe);var ACe=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],MCe=void 0;function NCe(e,t){var r=e.prefixCls,n=e.invalidate,i=e.item,o=e.renderItem,s=e.responsive,l=e.responsiveDisabled,c=e.registerSize,u=e.itemKey,d=e.className,f=e.style,h=e.children,p=e.display,g=e.order,m=e.component,v=void 0===m?"div":m,y=bK(e,ACe),b=s&&!p;function _(e){c(u,e)}a.useEffect((function(){return function(){_(null)}}),[]);var w,C=o&&i!==MCe?o(i):h;n||(w={opacity:b?0:1,height:b?0:MCe,overflowY:b?"hidden":MCe,order:s?g:MCe,pointerEvents:b?"none":MCe,position:b?"absolute":MCe});var E={};b&&(E["aria-hidden"]=!0);var S=a.createElement(v,aK({className:qL(!n&&r,d),style:mK(mK({},w),f)},E,y,{ref:t}),C);return s&&(S=a.createElement(Swe,{onResize:function(e){_(e.offsetWidth)},disabled:l},S)),S}var DCe=a.forwardRef(NCe);function PCe(){var e=a.useRef(null);return function(t){e.current||(e.current=[],function(e){if(typeof MessageChannel>"u")aJ(e);else{var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(void 0)}}((function(){Object(l.unstable_batchedUpdates)((function(){e.current.forEach((function(e){e()})),e.current=null}))}))),e.current.push(t)}}function jCe(e,t){var r=pK(a.useState(t),2),n=r[0],i=r[1];return[n,_0((function(t){e((function(){i(t)}))}))]}DCe.displayName="Item";var FCe=s.a.createContext(null),VCe=["component"],LCe=["className"],$Ce=["className"],BCe=function(e,t){var r=a.useContext(FCe);if(!r){var n=e.component,i=void 0===n?"div":n,o=bK(e,VCe);return a.createElement(i,aK({},o,{ref:t}))}var s=r.className,l=bK(r,LCe),c=e.className,u=bK(e,$Ce);return a.createElement(FCe.Provider,{value:null},a.createElement(DCe,aK({ref:t,className:qL(s,c)},l,u)))},UCe=a.forwardRef(BCe);UCe.displayName="RawItem";var zCe=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],HCe="responsive",WCe="invalidate";function GCe(e){return"+ ".concat(e.length," ...")}function KCe(e,t){var r=e.prefixCls,n=void 0===r?"rc-overflow":r,i=e.data,o=void 0===i?[]:i,s=e.renderItem,l=e.renderRawItem,c=e.itemKey,u=e.itemWidth,d=void 0===u?10:u,f=e.ssr,h=e.style,p=e.className,g=e.maxCount,m=e.renderRest,v=e.renderRawRest,y=e.suffix,b=e.component,_=void 0===b?"div":b,w=e.itemComponent,C=e.onVisibleChange,E=bK(e,zCe),S="full"===f,k=PCe(),x=pK(jCe(k,null),2),O=x[0],I=x[1],R=O||0,T=pK(jCe(k,new Map),2),A=T[0],M=T[1],N=pK(jCe(k,0),2),D=N[0],P=N[1],j=pK(jCe(k,0),2),F=j[0],V=j[1],L=pK(jCe(k,0),2),$=L[0],B=L[1],U=pK(Object(a.useState)(null),2),z=U[0],H=U[1],W=pK(Object(a.useState)(null),2),G=W[0],K=W[1],q=a.useMemo((function(){return null===G&&S?Number.MAX_SAFE_INTEGER:G||0}),[G,O]),Y=pK(Object(a.useState)(!1),2),J=Y[0],X=Y[1],Z="".concat(n,"-item"),Q=Math.max(D,F),ee=g===HCe,te=o.length&&ee,re=g===WCe,ne=te||"number"==typeof g&&o.length>g,ie=Object(a.useMemo)((function(){var e=o;return te?e=null===O&&S?o:o.slice(0,Math.min(o.length,R/d)):"number"==typeof g&&(e=o.slice(0,g)),e}),[o,d,O,g,te]),oe=Object(a.useMemo)((function(){return te?o.slice(q+1):o.slice(ie.length)}),[o,ie,te,q]),ae=Object(a.useCallback)((function(e,t){var r;return"function"==typeof c?c(e):null!==(r=c&&(null==e?void 0:e[c]))&&void 0!==r?r:t}),[c]),se=Object(a.useCallback)(s||function(e){return e},[s]);function le(e,t,r){G===e&&(void 0===t||t===z)||(K(e),r||(X(e<o.length-1),null==C||C(e)),void 0!==t&&H(t))}function ce(e,t){M((function(r){var n=new Map(r);return null===t?n.delete(e):n.set(e,t),n}))}function ue(e){return A.get(ae(ie[e],e))}C0((function(){if(R&&"number"==typeof Q&&ie){var e=$,t=ie.length,r=t-1;if(!t)return void le(0,null);for(var n=0;n<t;n+=1){var i=ue(n);if(S&&(i=i||0),void 0===i){le(n-1,void 0,!0);break}if(e+=i,0===r&&e<=R||n===r-1&&e+ue(r)<=R){le(r,null);break}if(e+Q>R){le(n-1,e-i-$+F);break}}y&&ue(0)+$>R&&H(null)}}),[R,A,F,$,ae,ie]);var de=J&&!!oe.length,fe={};null!==z&&te&&(fe={position:"absolute",left:z,top:0});var he,pe={prefixCls:Z,responsive:te,component:w,invalidate:re},ge=l?function(e,t){var r=ae(e,t);return a.createElement(FCe.Provider,{key:r,value:mK(mK({},pe),{},{order:t,item:e,itemKey:r,registerSize:ce,display:t<=q})},l(e,t))}:function(e,t){var r=ae(e,t);return a.createElement(DCe,aK({},pe,{order:t,key:r,item:e,renderItem:se,itemKey:r,registerSize:ce,display:t<=q}))},me={order:de?q:Number.MAX_SAFE_INTEGER,className:"".concat(Z,"-rest"),registerSize:function(e,t){V(t),P(F)},display:de};if(v)v&&(he=a.createElement(FCe.Provider,{value:mK(mK({},pe),me)},v(oe)));else{var ve=m||GCe;he=a.createElement(DCe,aK({},pe,me),"function"==typeof ve?ve(oe):ve)}var ye=a.createElement(_,aK({className:qL(!re&&n,p),style:h,ref:t},E),ie.map(ge),ne?he:null,y&&a.createElement(DCe,aK({},pe,{responsive:ee,responsiveDisabled:!te,order:q,className:"".concat(Z,"-suffix"),registerSize:function(e,t){B(t)},display:!0,style:fe}),y));return ee&&(ye=a.createElement(Swe,{onResize:function(e,t){I(t.clientWidth)},disabled:!te},ye)),ye}var qCe=a.forwardRef(KCe);qCe.displayName="Overflow",qCe.Item=UCe,qCe.RESPONSIVE=HCe,qCe.INVALIDATE=WCe;var YCe=a.createContext(null);function JCe(e,t){return void 0===e?null:"".concat(e,"-").concat(t)}function XCe(e){return JCe(a.useContext(YCe),e)}var ZCe=["children","locked"],QCe=a.createContext(null);function eEe(e){var t=e.children,r=e.locked,n=bK(e,ZCe),i=a.useContext(QCe),o=rY((function(){return function(e,t){var r=mK({},e);return Object.keys(t).forEach((function(e){var n=t[e];void 0!==n&&(r[e]=n)})),r}(i,n)}),[i,n],(function(e,t){return!(r||e[0]===t[0]&&l3(e[1],t[1],!0))}));return a.createElement(QCe.Provider,{value:o},t)}var tEe=[],rEe=a.createContext(null);function nEe(){return a.useContext(rEe)}var iEe=a.createContext(tEe);function oEe(e){var t=a.useContext(iEe);return a.useMemo((function(){return void 0!==e?[].concat(wK(t),[e]):t}),[t,e])}var aEe=a.createContext(null),sEe=a.createContext({});function lEe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(V0(e)){var r=e.nodeName.toLowerCase(),n=["input","select","textarea","button"].includes(r)||e.isContentEditable||"a"===r&&!!e.getAttribute("href"),i=e.getAttribute("tabindex"),o=Number(i),a=null;return i&&!Number.isNaN(o)?a=o:n&&null===a&&(a=0),n&&e.disabled&&(a=null),null!==a&&(a>=0||t&&a<0)}return!1}var cEe=x0.LEFT,uEe=x0.RIGHT,dEe=x0.UP,fEe=x0.DOWN,hEe=x0.ENTER,pEe=x0.ESC,gEe=x0.HOME,mEe=x0.END,vEe=[dEe,fEe,cEe,uEe];function yEe(e,t){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=wK(e.querySelectorAll("*")).filter((function(e){return lEe(e,t)}));return lEe(e,t)&&r.unshift(e),r}(e,!0);return r.filter((function(e){return t.has(e)}))}function bEe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return null;var i=yEe(e,t),o=i.length,a=i.findIndex((function(e){return r===e}));return n<0?-1===a?a=o-1:a-=1:n>0&&(a+=1),i[a=(a+o)%o]}function _Ee(e,t,r,n,i,o,s,l,c,u){var d=a.useRef(),f=a.useRef();f.current=t;var h=function(){aJ.cancel(d.current)};return a.useEffect((function(){return function(){h()}}),[]),function(a){var p=a.which;if([].concat(vEe,[hEe,pEe,gEe,mEe]).includes(p)){var g,m,v,y=function(){return g=new Set,m=new Map,v=new Map,o().forEach((function(e){var t=document.querySelector("[data-menu-id='".concat(JCe(n,e),"']"));t&&(g.add(t),v.set(t,e),m.set(e,t))})),g};y();var b=function(e,t){for(var r=e||document.activeElement;r;){if(t.has(r))return r;r=r.parentElement}return null}(m.get(t),g),_=v.get(b),w=function(e,t,r,n){var i,o,a,s,l="prev",c="next",u="children",d="parent";if("inline"===e&&n===hEe)return{inlineTrigger:!0};var f=(cK(i={},dEe,l),cK(i,fEe,c),i),h=(cK(o={},cEe,r?c:l),cK(o,uEe,r?l:c),cK(o,fEe,u),cK(o,hEe,u),o),p=(cK(a={},dEe,l),cK(a,fEe,c),cK(a,hEe,u),cK(a,pEe,d),cK(a,cEe,r?u:d),cK(a,uEe,r?d:u),a);switch(null===(s={inline:f,horizontal:h,vertical:p,inlineSub:f,horizontalSub:p,verticalSub:p}["".concat(e).concat(t?"":"Sub")])||void 0===s?void 0:s[n]){case l:return{offset:-1,sibling:!0};case c:return{offset:1,sibling:!0};case d:return{offset:-1,sibling:!1};case u:return{offset:1,sibling:!1};default:return null}}(e,1===s(_,!0).length,r,p);if(!w&&p!==gEe&&p!==mEe)return;(vEe.includes(p)||[gEe,mEe].includes(p))&&a.preventDefault();var C=function(e){if(e){var t=e,r=e.querySelector("a");null!=r&&r.getAttribute("href")&&(t=r);var n=v.get(e);l(n),h(),d.current=aJ((function(){f.current===n&&t.focus()}))}};if([gEe,mEe].includes(p)||w.sibling||!b){var E;E=b&&"inline"!==e?function(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}(b):i.current;var S,k=yEe(E,g);S=p===gEe?k[0]:p===mEe?k[k.length-1]:bEe(E,g,b,w.offset),C(S)}else if(w.inlineTrigger)c(_);else if(w.offset>0)c(_,!0),h(),d.current=aJ((function(){y();var e=b.getAttribute("aria-controls"),t=bEe(document.getElementById(e),g);C(t)}),5);else if(w.offset<0){var x=s(_,!0),O=x[x.length-2],I=m.get(O);c(O,!1),C(I)}}null==u||u(a)}}var wEe="__RC_UTIL_PATH_SPLIT__",CEe=function(e){return e.join(wEe)},EEe="rc-menu-more";function SEe(){var e=pK(a.useState({}),2)[1],t=Object(a.useRef)(new Map),r=Object(a.useRef)(new Map),n=pK(a.useState([]),2),i=n[0],o=n[1],s=Object(a.useRef)(0),l=Object(a.useRef)(!1),c=Object(a.useCallback)((function(n,i){"production"!==Ni.exports.env.NODE_ENV&&BK(!t.current.has(n),"Duplicated key '".concat(n,"' used in Menu by path [").concat(i.join(" > "),"]"));var o=CEe(i);r.current.set(o,n),t.current.set(n,o),s.current+=1;var a=s.current;!function(e){Promise.resolve().then(e)}((function(){a===s.current&&(l.current||e({}))}))}),[]),u=Object(a.useCallback)((function(e,n){var i=CEe(n);r.current.delete(i),t.current.delete(e)}),[]),d=Object(a.useCallback)((function(e){o(e)}),[]),f=Object(a.useCallback)((function(e,r){var n=function(e){return e.split(wEe)}(t.current.get(e)||"");return r&&i.includes(n[0])&&n.unshift(EEe),n}),[i]),h=Object(a.useCallback)((function(e,t){return e.some((function(e){return f(e,!0).includes(t)}))}),[f]),p=Object(a.useCallback)((function(e){var n="".concat(t.current.get(e)).concat(wEe),i=new Set;return wK(r.current.keys()).forEach((function(e){e.startsWith(n)&&i.add(r.current.get(e))})),i}),[]);return a.useEffect((function(){return function(){l.current=!0}}),[]),{registerPath:c,unregisterPath:u,refreshOverflowKeys:d,isSubPathKey:h,getKeyPath:f,getKeys:function(){var e=wK(t.current.keys());return i.length&&e.push(EEe),e},getSubPathKeys:p}}function kEe(e){var t=a.useRef(e);t.current=e;var r=a.useCallback((function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(n))}),[]);return e?r:void 0}var xEe=Math.random().toFixed(5).toString().slice(2),OEe=0;function IEe(e,t,r,n){var i=a.useContext(QCe),o=i.activeKey,s=i.onActive,l=i.onInactive,c={active:o===e};return t||(c.onMouseEnter=function(t){null==r||r({key:e,domEvent:t}),s(e)},c.onMouseLeave=function(t){null==n||n({key:e,domEvent:t}),l(e)}),c}function REe(e){var t=a.useContext(QCe),r=t.mode,n=t.rtl,i=t.inlineIndent;if("inline"!==r)return null;return n?{paddingRight:e*i}:{paddingLeft:e*i}}function TEe(e){var t,r=e.icon,n=e.props,i=e.children;return null===r||!1===r?null:("function"==typeof r?t=a.createElement(r,mK({},n)):"boolean"!=typeof r&&(t=r),t||i||null)}var AEe=["item"];function MEe(e){var t=e.item,r=bK(e,AEe);return Object.defineProperty(r,"item",{get:function(){return BK(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),r}var NEe=["title","attribute","elementRef"],DEe=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],PEe=["active"],jEe=function(e){OK(r,e);var t=RK(r);function r(){return CK(this,r),t.apply(this,arguments)}return SK(r,[{key:"render",value:function(){var e=this.props,t=e.title,r=e.attribute,n=e.elementRef,i=vK(bK(e,NEe),["eventKey","popupClassName","popupOffset","onTitleClick"]);return BK(!r,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),a.createElement(qCe.Item,aK({},r,{title:"string"==typeof t?t:void 0},i,{ref:n}))}}]),r}(a.Component),FEe=a.forwardRef((function(e,t){var r,n=e.style,i=e.className,o=e.eventKey,s=e.warnKey,l=e.disabled,c=e.itemIcon,u=e.children,d=e.role,f=e.onMouseEnter,h=e.onMouseLeave,p=e.onClick,g=e.onKeyDown,m=e.onFocus,v=bK(e,DEe),y=XCe(o),b=a.useContext(QCe),_=b.prefixCls,w=b.onItemClick,C=b.disabled,E=b.overflowDisabled,S=b.itemIcon,k=b.selectedKeys,x=b.onActive,O=a.useContext(sEe)._internalRenderMenuItem,I="".concat(_,"-item"),R=a.useRef(),T=a.useRef(),A=C||l,M=kY(t,T),N=oEe(o);"production"!==Ni.exports.env.NODE_ENV&&s&&BK(!1,"MenuItem should not leave undefined `key`.");var D=function(e){return{key:o,keyPath:wK(N).reverse(),item:R.current,domEvent:e}},P=c||S,j=IEe(o,A,f,h),F=j.active,V=bK(j,PEe),L=k.includes(o),$=REe(N.length),B={};"option"===e.role&&(B["aria-selected"]=L);var U=a.createElement(jEe,aK({ref:R,elementRef:M,role:null===d?"none":d||"menuitem",tabIndex:l?null:-1,"data-menu-id":E&&y?null:y},v,V,B,{component:"li","aria-disabled":l,style:mK(mK({},$),n),className:qL(I,(r={},cK(r,"".concat(I,"-active"),F),cK(r,"".concat(I,"-selected"),L),cK(r,"".concat(I,"-disabled"),A),r),i),onClick:function(e){if(!A){var t=D(e);null==p||p(MEe(t)),w(t)}},onKeyDown:function(e){if(null==g||g(e),e.which===x0.ENTER){var t=D(e);null==p||p(MEe(t)),w(t)}},onFocus:function(e){x(o),null==m||m(e)}}),u,a.createElement(TEe,{props:mK(mK({},e),{},{isSelected:L}),icon:P}));return O&&(U=O(U,e,{selected:L})),U}));function VEe(e,t){var r=e.eventKey,n=nEe(),i=oEe(r);return a.useEffect((function(){if(n)return n.registerPath(r,i),function(){n.unregisterPath(r,i)}}),[i]),n?null:a.createElement(FEe,aK({},e,{ref:t}))}const LEe=a.forwardRef(VEe);var $Ee=["className","children"],BEe=function(e,t){var r=e.className,n=e.children,i=bK(e,$Ee),o=a.useContext(QCe),s=o.prefixCls,l=o.mode,c=o.rtl;return a.createElement("ul",aK({className:qL(s,c&&"".concat(s,"-rtl"),"".concat(s,"-sub"),"".concat(s,"-").concat("inline"===l?"inline":"vertical"),r),role:"menu"},i,{"data-menu-list":!0,ref:t}),n)},UEe=a.forwardRef(BEe);function zEe(e,t){return PK(e).map((function(e,r){if(a.isValidElement(e)){var n,i,o=e.key,s=null!==(n=null===(i=e.props)||void 0===i?void 0:i.eventKey)&&void 0!==n?n:o,l=null==s;l&&(s="tmp_key-".concat([].concat(wK(t),[r]).join("-")));var c={key:s,eventKey:s};return"production"!==Ni.exports.env.NODE_ENV&&l&&(c.warnKey=!0),a.cloneElement(e,c)}return e}))}UEe.displayName="SubMenuList";var HEe={adjustX:1,adjustY:1},WEe={topLeft:{points:["bl","tl"],overflow:HEe},topRight:{points:["br","tr"],overflow:HEe},bottomLeft:{points:["tl","bl"],overflow:HEe},bottomRight:{points:["tr","br"],overflow:HEe},leftTop:{points:["tr","tl"],overflow:HEe},leftBottom:{points:["br","bl"],overflow:HEe},rightTop:{points:["tl","tr"],overflow:HEe},rightBottom:{points:["bl","br"],overflow:HEe}},GEe={topLeft:{points:["bl","tl"],overflow:HEe},topRight:{points:["br","tr"],overflow:HEe},bottomLeft:{points:["tl","bl"],overflow:HEe},bottomRight:{points:["tr","br"],overflow:HEe},rightTop:{points:["tr","tl"],overflow:HEe},rightBottom:{points:["br","bl"],overflow:HEe},leftTop:{points:["tl","tr"],overflow:HEe},leftBottom:{points:["bl","br"],overflow:HEe}};function KEe(e,t,r){return t||(r?r[e]||r.other:void 0)}var qEe={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function YEe(e){var t=e.prefixCls,r=e.visible,n=e.children,i=e.popup,o=e.popupStyle,s=e.popupClassName,l=e.popupOffset,c=e.disabled,u=e.mode,d=e.onVisibleChange,f=a.useContext(QCe),h=f.getPopupContainer,p=f.rtl,g=f.subMenuOpenDelay,m=f.subMenuCloseDelay,v=f.builtinPlacements,y=f.triggerSubMenuAction,b=f.forceSubMenuRender,_=f.rootClassName,w=f.motion,C=f.defaultMotions,E=pK(a.useState(!1),2),S=E[0],k=E[1],x=mK(mK({},p?GEe:WEe),v),O=qEe[u],I=KEe(u,w,C),R=a.useRef(I);"inline"!==u&&(R.current=I);var T=mK(mK({},R.current),{},{leavedClassName:"".concat(t,"-hidden"),removeOnLeave:!1,motionAppear:!0}),A=a.useRef();return a.useEffect((function(){return A.current=aJ((function(){k(r)})),function(){aJ.cancel(A.current)}}),[r]),a.createElement(wCe,{prefixCls:t,popupClassName:qL("".concat(t,"-popup"),cK({},"".concat(t,"-rtl"),p),s,_),stretch:"horizontal"===u?"minWidth":null,getPopupContainer:h,builtinPlacements:x,popupPlacement:O,popupVisible:S,popup:i,popupStyle:o,popupAlign:l&&{offset:l},action:c?[]:[y],mouseEnterDelay:g,mouseLeaveDelay:m,onPopupVisibleChange:d,forceRender:b,popupMotion:T,fresh:!0},n)}function JEe(e){var t=e.id,r=e.open,n=e.keyPath,i=e.children,o="inline",s=a.useContext(QCe),l=s.prefixCls,c=s.forceSubMenuRender,u=s.motion,d=s.defaultMotions,f=s.mode,h=a.useRef(!1);h.current=f===o;var p=pK(a.useState(!h.current),2),g=p[0],m=p[1],v=!!h.current&&r;a.useEffect((function(){h.current&&m(!1)}),[f]);var y=mK({},KEe(o,u,d));n.length>1&&(y.motionAppear=!1);var b=y.onVisibleChanged;return y.onVisibleChanged=function(e){return!h.current&&!e&&m(!0),null==b?void 0:b(e)},g?null:a.createElement(eEe,{mode:o,locked:!h.current},a.createElement(hJ,aK({visible:v},y,{forceRender:c,removeOnLeave:!1,leavedClassName:"".concat(l,"-hidden")}),(function(e){var r=e.className,n=e.style;return a.createElement(UEe,{id:t,className:r,style:n},i)})))}var XEe=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],ZEe=["active"],QEe=function(e){var t,r=e.style,n=e.className,i=e.title,o=e.eventKey,s=e.warnKey,l=e.disabled,c=e.internalPopupClose,u=e.children,d=e.itemIcon,f=e.expandIcon,h=e.popupClassName,p=e.popupOffset,g=e.popupStyle,m=e.onClick,v=e.onMouseEnter,y=e.onMouseLeave,b=e.onTitleClick,_=e.onTitleMouseEnter,w=e.onTitleMouseLeave,C=bK(e,XEe),E=XCe(o),S=a.useContext(QCe),k=S.prefixCls,x=S.mode,O=S.openKeys,I=S.disabled,R=S.overflowDisabled,T=S.activeKey,A=S.selectedKeys,M=S.itemIcon,N=S.expandIcon,D=S.onItemClick,P=S.onOpenChange,j=S.onActive,F=a.useContext(sEe)._internalRenderSubMenuItem,V=a.useContext(aEe).isSubPathKey,L=oEe(),$="".concat(k,"-submenu"),B=I||l,U=a.useRef(),z=a.useRef();"production"!==Ni.exports.env.NODE_ENV&&s&&BK(!1,"SubMenu should not leave undefined `key`.");var H=null!=d?d:M,W=null!=f?f:N,G=O.includes(o),K=!R&&G,q=V(A,o),Y=IEe(o,B,_,w),J=Y.active,X=bK(Y,ZEe),Z=pK(a.useState(!1),2),Q=Z[0],ee=Z[1],te=function(e){B||ee(e)},re=a.useMemo((function(){return J||"inline"!==x&&(Q||V([T],o))}),[x,J,T,Q,o,V]),ne=REe(L.length),ie=kEe((function(e){null==m||m(MEe(e)),D(e)})),oe=E&&"".concat(E,"-popup"),ae=a.createElement("div",aK({role:"menuitem",style:ne,className:"".concat($,"-title"),tabIndex:B?null:-1,ref:U,title:"string"==typeof i?i:null,"data-menu-id":R&&E?null:E,"aria-expanded":K,"aria-haspopup":!0,"aria-controls":oe,"aria-disabled":B,onClick:function(e){B||(null==b||b({key:o,domEvent:e}),"inline"===x&&P(o,!G))},onFocus:function(){j(o)}},X),i,a.createElement(TEe,{icon:"horizontal"!==x?W:void 0,props:mK(mK({},e),{},{isOpen:K,isSubMenu:!0})},a.createElement("i",{className:"".concat($,"-arrow")}))),se=a.useRef(x);if("inline"!==x&&L.length>1?se.current="vertical":se.current=x,!R){var le=se.current;ae=a.createElement(YEe,{mode:le,prefixCls:$,visible:!c&&K&&"inline"!==x,popupClassName:h,popupOffset:p,popupStyle:g,popup:a.createElement(eEe,{mode:"horizontal"===le?"vertical":le},a.createElement(UEe,{id:oe,ref:z},u)),disabled:B,onVisibleChange:function(e){"inline"!==x&&P(o,e)}},ae)}var ce=a.createElement(qCe.Item,aK({role:"none"},C,{component:"li",style:r,className:qL($,"".concat($,"-").concat(x),n,(t={},cK(t,"".concat($,"-open"),K),cK(t,"".concat($,"-active"),re),cK(t,"".concat($,"-selected"),q),cK(t,"".concat($,"-disabled"),B),t)),onMouseEnter:function(e){te(!0),null==v||v({key:o,domEvent:e})},onMouseLeave:function(e){te(!1),null==y||y({key:o,domEvent:e})}}),ae,!R&&a.createElement(JEe,{id:oe,open:K,keyPath:L},u));return F&&(ce=F(ce,e,{selected:q,active:re,open:K,disabled:B})),a.createElement(eEe,{onItemClick:ie,mode:"horizontal"===x?"vertical":x,itemIcon:H,expandIcon:W},ce)};function eSe(e){var t,r=e.eventKey,n=e.children,i=oEe(r),o=zEe(n,i),s=nEe();return a.useEffect((function(){if(s)return s.registerPath(r,i),function(){s.unregisterPath(r,i)}}),[i]),t=s?o:a.createElement(QEe,e,o),a.createElement(iEe.Provider,{value:i},t)}var tSe=["className","title","eventKey","children"],rSe=["children"],nSe=function(e){var t=e.className,r=e.title;e.eventKey;var n=e.children,i=bK(e,tSe),o=a.useContext(QCe).prefixCls,s="".concat(o,"-item-group");return a.createElement("li",aK({role:"presentation"},i,{onClick:function(e){return e.stopPropagation()},className:qL(s,t)}),a.createElement("div",{role:"presentation",className:"".concat(s,"-title"),title:"string"==typeof r?r:void 0},r),a.createElement("ul",{role:"group",className:"".concat(s,"-list")},n))};function iSe(e){var t=e.children,r=bK(e,rSe),n=zEe(t,oEe(r.eventKey));return nEe()?n:a.createElement(nSe,vK(r,["warnKey"]),n)}function oSe(e){var t=e.className,r=e.style,n=a.useContext(QCe).prefixCls;return nEe()?null:a.createElement("li",{role:"separator",className:qL("".concat(n,"-item-divider"),t),style:r})}var aSe=["label","children","key","type"];function sSe(e){return(e||[]).map((function(e,t){if(e&&"object"===sK(e)){var r=e,n=r.label,i=r.children,o=r.key,s=r.type,l=bK(r,aSe),c=null!=o?o:"tmp-".concat(t);return i||"group"===s?"group"===s?a.createElement(iSe,aK({key:c},l,{title:n}),sSe(i)):a.createElement(eSe,aK({key:c},l,{title:n}),sSe(i)):"divider"===s?a.createElement(oSe,aK({key:c},l)):a.createElement(LEe,aK({key:c},l),n)}return null})).filter((function(e){return e}))}function lSe(e,t,r){var n=e;return t&&(n=sSe(t)),zEe(n,r)}var cSe=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],uSe=[],dSe=a.forwardRef((function(e,t){var r,n,i=e,o=i.prefixCls,s=void 0===o?"rc-menu":o,c=i.rootClassName,u=i.style,d=i.className,f=i.tabIndex,h=void 0===f?0:f,p=i.items,g=i.children,m=i.direction,v=i.id,y=i.mode,b=void 0===y?"vertical":y,_=i.inlineCollapsed,w=i.disabled,C=i.disabledOverflow,E=i.subMenuOpenDelay,S=void 0===E?.1:E,k=i.subMenuCloseDelay,x=void 0===k?.1:k,O=i.forceSubMenuRender,I=i.defaultOpenKeys,R=i.openKeys,T=i.activeKey,A=i.defaultActiveFirst,M=i.selectable,N=void 0===M||M,D=i.multiple,P=void 0!==D&&D,j=i.defaultSelectedKeys,F=i.selectedKeys,V=i.onSelect,L=i.onDeselect,$=i.inlineIndent,B=void 0===$?24:$,U=i.motion,z=i.defaultMotions,H=i.triggerSubMenuAction,W=void 0===H?"hover":H,G=i.builtinPlacements,K=i.itemIcon,q=i.expandIcon,Y=i.overflowedIndicator,J=void 0===Y?"...":Y,X=i.overflowedIndicatorPopupClassName,Z=i.getPopupContainer,Q=i.onClick,ee=i.onOpenChange,te=i.onKeyDown,re=i.openAnimation,ne=i.openTransitionName,ie=i._internalRenderMenuItem,oe=i._internalRenderSubMenuItem,ae=bK(i,cSe),se=a.useMemo((function(){return lSe(g,p,uSe)}),[g,p]),le=pK(a.useState(!1),2),ce=le[0],ue=le[1],de=a.useRef(),fe=function(e){var t=pK(k0(e,{value:e}),2),r=t[0],n=t[1];return a.useEffect((function(){OEe+=1;var e="test"===Ni.exports.env.NODE_ENV?"test":"".concat(xEe,"-").concat(OEe);n("rc-menu-uuid-".concat(e))}),[]),r}(v),he="rtl"===m;"production"!==Ni.exports.env.NODE_ENV&&BK(!re&&!ne,"`openAnimation` and `openTransitionName` is removed. Please use `motion` or `defaultMotion` instead.");var pe=pK(k0(I,{value:R,postState:function(e){return e||uSe}}),2),ge=pe[0],me=pe[1],ve=function(e){function t(){me(e),null==ee||ee(e)}arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object(l.flushSync)(t):t()},ye=pK(a.useState(ge),2),be=ye[0],_e=ye[1],we=a.useRef(!1),Ce=pK(a.useMemo((function(){return"inline"!==b&&"vertical"!==b||!_?[b,!1]:["vertical",_]}),[b,_]),2),Ee=Ce[0],Se=Ce[1],ke="inline"===Ee,xe=pK(a.useState(Ee),2),Oe=xe[0],Ie=xe[1],Re=pK(a.useState(Se),2),Te=Re[0],Ae=Re[1];a.useEffect((function(){Ie(Ee),Ae(Se),we.current&&(ke?me(be):ve(uSe))}),[Ee,Se]);var Me=pK(a.useState(0),2),Ne=Me[0],De=Me[1],Pe=Ne>=se.length-1||"horizontal"!==Oe||C;a.useEffect((function(){ke&&_e(ge)}),[ge]),a.useEffect((function(){return we.current=!0,function(){we.current=!1}}),[]);var je=SEe(),Fe=je.registerPath,Ve=je.unregisterPath,Le=je.refreshOverflowKeys,$e=je.isSubPathKey,Be=je.getKeyPath,Ue=je.getKeys,ze=je.getSubPathKeys,He=a.useMemo((function(){return{registerPath:Fe,unregisterPath:Ve}}),[Fe,Ve]),We=a.useMemo((function(){return{isSubPathKey:$e}}),[$e]);a.useEffect((function(){Le(Pe?uSe:se.slice(Ne+1).map((function(e){return e.key})))}),[Ne,Pe]);var Ge=pK(k0(T||A&&(null===(r=se[0])||void 0===r?void 0:r.key),{value:T}),2),Ke=Ge[0],qe=Ge[1],Ye=kEe((function(e){qe(e)})),Je=kEe((function(){qe(void 0)}));Object(a.useImperativeHandle)(t,(function(){return{list:de.current,focus:function(e){var t,r,n,i,o=null!=Ke?Ke:null===(t=se.find((function(e){return!e.props.disabled})))||void 0===t?void 0:t.key;o&&(null===(r=de.current)||void 0===r||null===(n=r.querySelector("li[data-menu-id='".concat(JCe(fe,o),"']")))||void 0===n||null===(i=n.focus)||void 0===i||i.call(n,e))}}}));var Xe=pK(k0(j||[],{value:F,postState:function(e){return Array.isArray(e)?e:null==e?uSe:[e]}}),2),Ze=Xe[0],Qe=Xe[1],et=kEe((function(e){null==Q||Q(MEe(e)),function(e){if(N){var t,r=e.key,n=Ze.includes(r);t=P?n?Ze.filter((function(e){return e!==r})):[].concat(wK(Ze),[r]):[r],Qe(t);var i=mK(mK({},e),{},{selectedKeys:t});n?null==L||L(i):null==V||V(i)}!P&&ge.length&&"inline"!==Oe&&ve(uSe)}(e)})),tt=kEe((function(e,t){var r=ge.filter((function(t){return t!==e}));if(t)r.push(e);else if("inline"!==Oe){var n=ze(e);r=r.filter((function(e){return!n.has(e)}))}l3(ge,r,!0)||ve(r,!0)})),rt=_Ee(Oe,Ke,he,fe,de,Ue,Be,qe,(function(e,t){var r=null!=t?t:!ge.includes(e);tt(e,r)}),te);a.useEffect((function(){ue(!0)}),[]);var nt=a.useMemo((function(){return{_internalRenderMenuItem:ie,_internalRenderSubMenuItem:oe}}),[ie,oe]),it="horizontal"!==Oe||C?se:se.map((function(e,t){return a.createElement(eEe,{key:e.key,overflowDisabled:t>Ne},e)})),ot=a.createElement(qCe,aK({id:v,ref:de,prefixCls:"".concat(s,"-overflow"),component:"ul",itemComponent:LEe,className:qL(s,"".concat(s,"-root"),"".concat(s,"-").concat(Oe),d,(n={},cK(n,"".concat(s,"-inline-collapsed"),Te),cK(n,"".concat(s,"-rtl"),he),n),c),dir:m,style:u,role:"menu",tabIndex:h,data:it,renderRawItem:function(e){return e},renderRawRest:function(e){var t=e.length,r=t?se.slice(-t):null;return a.createElement(eSe,{eventKey:EEe,title:J,disabled:Pe,internalPopupClose:0===t,popupClassName:X},r)},maxCount:"horizontal"!==Oe||C?qCe.INVALIDATE:qCe.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(e){De(e)},onKeyDown:rt},ae));return a.createElement(sEe.Provider,{value:nt},a.createElement(YCe.Provider,{value:fe},a.createElement(eEe,{prefixCls:s,rootClassName:c,mode:Oe,openKeys:ge,rtl:he,disabled:w,motion:ce?U:null,defaultMotions:ce?z:null,activeKey:Ke,onActive:Ye,onInactive:Je,selectedKeys:Ze,inlineIndent:B,subMenuOpenDelay:S,subMenuCloseDelay:x,forceSubMenuRender:O,builtinPlacements:G,triggerSubMenuAction:W,getPopupContainer:Z,itemIcon:K,expandIcon:q,onItemClick:et,onOpenChange:tt},a.createElement(aEe.Provider,{value:We},ot),a.createElement("div",{style:{display:"none"},"aria-hidden":!0},a.createElement(rEe.Provider,{value:He},se)))))})),fSe=dSe;function hSe(e,t){var r=e.prefixCls,n=e.id,i=e.tabs,o=e.locale,s=e.mobile,l=e.moreIcon,c=void 0===l?"More":l,u=e.moreTransitionName,d=e.style,f=e.className,h=e.editable,p=e.tabBarGutter,g=e.rtl,m=e.removeAriaLabel,v=e.onTabClick,y=e.getPopupContainer,b=e.popupClassName,_=pK(Object(a.useState)(!1),2),w=_[0],C=_[1],E=pK(Object(a.useState)(null),2),S=E[0],k=E[1],x="".concat(n,"-more-popup"),O="".concat(r,"-dropdown"),I=null!==S?"".concat(x,"-").concat(S):null,R=null==o?void 0:o.dropdownAriaLabel;var T=a.createElement(fSe,{onClick:function(e){var t=e.key,r=e.domEvent;v(t,r),C(!1)},prefixCls:"".concat(O,"-menu"),id:x,tabIndex:-1,role:"listbox","aria-activedescendant":I,selectedKeys:[S],"aria-label":void 0!==R?R:"expanded dropdown"},i.map((function(e){var t=e.closable,r=e.disabled,i=e.closeIcon,o=e.key,s=e.label,l=jwe(t,i,h,r);return a.createElement(LEe,{key:o,id:"".concat(x,"-").concat(o),role:"option","aria-controls":n&&"".concat(n,"-panel-").concat(o),disabled:r},a.createElement("span",null,s),l&&a.createElement("button",{type:"button","aria-label":m||"remove",tabIndex:0,className:"".concat(O,"-menu-item-remove"),onClick:function(e){e.stopPropagation(),function(e,t){e.preventDefault(),e.stopPropagation(),h.onEdit("remove",{key:t,event:e})}(e,o)}},i||h.removeIcon||"×"))})));function A(e){for(var t=i.filter((function(e){return!e.disabled})),r=t.findIndex((function(e){return e.key===S}))||0,n=t.length,o=0;o<n;o+=1){var a=t[r=(r+e+n)%n];if(!a.disabled)return void k(a.key)}}Object(a.useEffect)((function(){var e=document.getElementById(I);e&&e.scrollIntoView&&e.scrollIntoView(!1)}),[S]),Object(a.useEffect)((function(){w||k(null)}),[w]);var M=cK({},g?"marginRight":"marginLeft",p);i.length||(M.visibility="hidden",M.order=1);var N=qL(cK({},"".concat(O,"-rtl"),g)),D=s?null:a.createElement(TCe,{prefixCls:O,overlay:T,trigger:["hover"],visible:!!i.length&&w,transitionName:u,onVisibleChange:C,overlayClassName:qL(N,b),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:y},a.createElement("button",{type:"button",className:"".concat(r,"-nav-more"),style:M,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":x,id:"".concat(n,"-more"),"aria-expanded":w,onKeyDown:function(e){var t=e.which;if(w)switch(t){case x0.UP:A(-1),e.preventDefault();break;case x0.DOWN:A(1),e.preventDefault();break;case x0.ESC:C(!1);break;case x0.SPACE:case x0.ENTER:null!==S&&v(S,e)}else[x0.DOWN,x0.SPACE,x0.ENTER].includes(t)&&(C(!0),e.preventDefault())}},c));return a.createElement("div",{className:qL("".concat(r,"-nav-operations"),f),style:d,ref:t},D,a.createElement(Vwe,{prefixCls:r,locale:o,editable:h}))}fSe.Item=LEe,fSe.SubMenu=eSe,fSe.ItemGroup=iSe,fSe.Divider=oSe;const pSe=a.memo(a.forwardRef(hSe),(function(e,t){return t.tabMoving}));function gSe(e){var t,r=e.prefixCls,n=e.id,i=e.active,o=e.tab,s=o.key,l=o.label,c=o.disabled,u=o.closeIcon,d=e.closable,f=e.renderWrapper,h=e.removeAriaLabel,p=e.editable,g=e.onClick,m=e.onFocus,v=e.style,y="".concat(r,"-tab"),b=jwe(d,u,p,c);function _(e){c||g(e)}var w=a.createElement("div",{key:s,"data-node-key":Pwe(s),className:qL(y,(t={},cK(t,"".concat(y,"-with-remove"),b),cK(t,"".concat(y,"-active"),i),cK(t,"".concat(y,"-disabled"),c),t)),style:v,onClick:_},a.createElement("div",{role:"tab","aria-selected":i,id:n&&"".concat(n,"-tab-").concat(s),className:"".concat(y,"-btn"),"aria-controls":n&&"".concat(n,"-panel-").concat(s),"aria-disabled":c,tabIndex:c?null:0,onClick:function(e){e.stopPropagation(),_(e)},onKeyDown:function(e){[x0.SPACE,x0.ENTER].includes(e.which)&&(e.preventDefault(),_(e))},onFocus:m},l),b&&a.createElement("button",{type:"button","aria-label":h||"remove",tabIndex:0,className:"".concat(y,"-remove"),onClick:function(e){e.stopPropagation(),function(e){e.preventDefault(),e.stopPropagation(),p.onEdit("remove",{key:s,event:e})}(e)}},u||p.removeIcon||"×"));return f?f(w):w}var mSe=function(e){var t=e.current||{},r=t.offsetWidth,n=void 0===r?0:r,i=t.offsetHeight,o=void 0===i?0:i;if(e.current){var a=e.current.getBoundingClientRect(),s=a.width,l=a.height;if(Math.abs(s-n)<1)return[s,l]}return[n,o]},vSe=function(e,t){return e[t?0:1]};function ySe(e,t){var r,n=a.useContext(hwe),i=n.prefixCls,o=n.tabs,s=e.className,l=e.style,c=e.id,u=e.animated,d=e.activeKey,f=e.rtl,h=e.extra,p=e.editable,g=e.locale,m=e.tabPosition,v=e.tabBarGutter,y=e.children,b=e.onTabClick,_=e.onTabScroll,w=e.indicatorSize,C=Object(a.useRef)(),E=Object(a.useRef)(),S=Object(a.useRef)(),k=Object(a.useRef)(),x=Object(a.useRef)(),O=Object(a.useRef)(),I=Object(a.useRef)(),R="top"===m||"bottom"===m,T=pK(xwe(0,(function(e,t){R&&_&&_({direction:e>t?"left":"right"})})),2),A=T[0],M=T[1],N=pK(xwe(0,(function(e,t){!R&&_&&_({direction:e>t?"top":"bottom"})})),2),D=N[0],P=N[1],j=pK(Object(a.useState)([0,0]),2),F=j[0],V=j[1],L=pK(Object(a.useState)([0,0]),2),$=L[0],B=L[1],U=pK(Object(a.useState)([0,0]),2),z=U[0],H=U[1],W=pK(Object(a.useState)([0,0]),2),G=W[0],K=W[1],q=function(e){var t=Object(a.useRef)([]),r=pK(Object(a.useState)({}),2)[1],n=Object(a.useRef)("function"==typeof e?e():e),i=Awe((function(){var e=n.current;t.current.forEach((function(t){e=t(e)})),t.current=[],n.current=e,r({})}));return[n.current,function(e){t.current.push(e),i()}]}(new Map),Y=pK(q,2),J=Y[0],X=Y[1],Z=function(e,t,r){return Object(a.useMemo)((function(){for(var r,n=new Map,i=t.get(null===(r=e[0])||void 0===r?void 0:r.key)||kwe,o=i.left+i.width,a=0;a<e.length;a+=1){var s,l=e[a].key,c=t.get(l);c||(c=t.get(null===(s=e[a-1])||void 0===s?void 0:s.key)||kwe);var u=n.get(l)||mK({},c);u.right=o-u.left-u.width,n.set(l,u)}return n}),[e.map((function(e){return e.key})).join("_"),t,r])}(o,J,$[0]),Q=vSe(F,R),ee=vSe($,R),te=vSe(z,R),re=vSe(G,R),ne=Q<ee+te,ie=ne?Q-re:Q-te,oe="".concat(i,"-nav-operations-hidden"),ae=0,se=0;function le(e){return e<ae?ae:e>se?se:e}R&&f?(ae=0,se=Math.max(0,ee-ie)):(ae=Math.min(0,ie-ee),se=0);var ce=Object(a.useRef)(),ue=pK(Object(a.useState)(),2),de=ue[0],fe=ue[1];function he(){fe(Date.now())}function pe(){window.clearTimeout(ce.current)}(function(e,t){var r=pK(Object(a.useState)(),2),n=r[0],i=r[1],o=pK(Object(a.useState)(0),2),s=o[0],l=o[1],c=pK(Object(a.useState)(0),2),u=c[0],d=c[1],f=pK(Object(a.useState)(),2),h=f[0],p=f[1],g=Object(a.useRef)(),m=Object(a.useRef)(),v=Object(a.useRef)(null);v.current={onTouchStart:function(e){var t=e.touches[0],r=t.screenX,n=t.screenY;i({x:r,y:n}),window.clearInterval(g.current)},onTouchMove:function(e){if(n){e.preventDefault();var r=e.touches[0],o=r.screenX,a=r.screenY;i({x:o,y:a});var c=o-n.x,u=a-n.y;t(c,u);var f=Date.now();l(f),d(f-s),p({x:c,y:u})}},onTouchEnd:function(){if(n&&(i(null),p(null),h)){var e=h.x/u,r=h.y/u,o=Math.abs(e),a=Math.abs(r);if(Math.max(o,a)<Owe)return;var s=e,l=r;g.current=window.setInterval((function(){Math.abs(s)<Iwe&&Math.abs(l)<Iwe?window.clearInterval(g.current):t((s*=Twe)*Rwe,(l*=Twe)*Rwe)}),Rwe)}},onWheel:function(e){var r=e.deltaX,n=e.deltaY,i=0,o=Math.abs(r),a=Math.abs(n);o===a?i="x"===m.current?r:n:o>a?(i=r,m.current="x"):(i=n,m.current="y"),t(-i,-i)&&e.preventDefault()}},a.useEffect((function(){function t(e){v.current.onTouchMove(e)}function r(e){v.current.onTouchEnd(e)}return document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",r,{passive:!1}),e.current.addEventListener("touchstart",(function(e){v.current.onTouchStart(e)}),{passive:!1}),e.current.addEventListener("wheel",(function(e){v.current.onWheel(e)})),function(){document.removeEventListener("touchmove",t),document.removeEventListener("touchend",r)}}),[])})(k,(function(e,t){function r(e,t){e((function(e){return le(e+t)}))}return!!ne&&(R?r(M,e):r(P,t),pe(),he(),!0)})),Object(a.useEffect)((function(){return pe(),de&&(ce.current=window.setTimeout((function(){fe(0)}),100)),pe}),[de]);var ge=function(e,t,r,n,i,o,s){var l,c,u,d=s.tabs,f=s.tabPosition,h=s.rtl;return["top","bottom"].includes(f)?(l="width",c=h?"right":"left",u=Math.abs(r)):(l="height",c="top",u=-r),Object(a.useMemo)((function(){if(!d.length)return[0,0];for(var r=d.length,n=r,i=0;i<r;i+=1){var o=e.get(d[i].key)||Mwe;if(o[c]+o[l]>u+t){n=i-1;break}}for(var a=0,s=r-1;s>=0;s-=1)if((e.get(d[s].key)||Mwe)[c]<u){a=s+1;break}return a>=n?[0,0]:[a,n]}),[e,t,n,i,o,u,f,d.map((function(e){return e.key})).join("_"),h])}(Z,ie,R?A:D,ee,te,re,mK(mK({},e),{},{tabs:o})),me=pK(ge,2),ve=me[0],ye=me[1],be=_0((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=Z.get(e)||{width:0,height:0,left:0,right:0,top:0};if(R){var r=A;f?t.right<A?r=t.right:t.right+t.width>A+ie&&(r=t.right+t.width-ie):t.left<-A?r=-t.left:t.left+t.width>-A+ie&&(r=-(t.left+t.width-ie)),P(0),M(le(r))}else{var n=D;t.top<-D?n=-t.top:t.top+t.height>-D+ie&&(n=-(t.top+t.height-ie)),M(0),P(le(n))}})),_e={};"top"===m||"bottom"===m?_e[f?"marginRight":"marginLeft"]=v:_e.marginTop=v;var we=o.map((function(e,t){var r=e.key;return a.createElement(gSe,{id:c,prefixCls:i,key:r,tab:e,style:0===t?void 0:_e,closable:e.closable,editable:p,active:r===d,renderWrapper:y,removeAriaLabel:null==g?void 0:g.removeAriaLabel,onClick:function(e){b(r,e)},onFocus:function(){be(r),he(),k.current&&(f||(k.current.scrollLeft=0),k.current.scrollTop=0)}})})),Ce=function(){return X((function(){var e,t=new Map,r=null===(e=x.current)||void 0===e?void 0:e.getBoundingClientRect();return o.forEach((function(e){var n,i=e.key,o=null===(n=x.current)||void 0===n?void 0:n.querySelector('[data-node-key="'.concat(Pwe(i),'"]'));if(o){var a=function(e,t){var r=e.offsetWidth,n=e.offsetHeight,i=e.offsetTop,o=e.offsetLeft,a=e.getBoundingClientRect(),s=a.width,l=a.height,c=a.x,u=a.y;return Math.abs(s-r)<1?[s,l,c-t.x,u-t.y]:[r,n,o,i]}(o,r),s=pK(a,4),l=s[0],c=s[1],u=s[2],d=s[3];t.set(i,{width:l,height:c,left:u,top:d})}})),t}))};Object(a.useEffect)((function(){Ce()}),[o.map((function(e){return e.key})).join("_")]);var Ee=Awe((function(){var e=mSe(C),t=mSe(E),r=mSe(S);V([e[0]-t[0]-r[0],e[1]-t[1]-r[1]]);var n=mSe(I);H(n);var i=mSe(O);K(i);var o=mSe(x);B([o[0]-n[0],o[1]-n[1]]),Ce()})),Se=o.slice(0,ve),ke=o.slice(ye+1),xe=[].concat(wK(Se),wK(ke)),Oe=Z.get(d),Ie=function(e){var t=e.activeTabOffset,r=e.horizontal,n=e.rtl,i=e.indicatorSize,o=pK(Object(a.useState)(),2),s=o[0],l=o[1],c=Object(a.useRef)(),u=function(e){return"function"==typeof i?i(e):"number"==typeof i?i:e};function d(){aJ.cancel(c.current)}return Object(a.useEffect)((function(){var e={};return t&&(r?(n?(e.right=t.right+t.width/2,e.transform="translateX(50%)"):(e.left=t.left+t.width/2,e.transform="translateX(-50%)"),e.width=u(t.width)):(e.top=t.top+t.height/2,e.transform="translateY(-50%)",e.height=u(t.height))),d(),c.current=aJ((function(){l(e)})),d}),[t,r,n,i]),{style:s}}({activeTabOffset:Oe,horizontal:R,rtl:f,indicatorSize:w}),Re=Ie.style;Object(a.useEffect)((function(){be()}),[d,ae,se,Nwe(Oe),Nwe(Z),R]),Object(a.useEffect)((function(){Ee()}),[f]);var Te,Ae,Me,Ne,De=!!xe.length,Pe="".concat(i,"-nav-wrap");return R?f?(Ae=A>0,Te=A!==se):(Te=A<0,Ae=A!==ae):(Me=D<0,Ne=D!==ae),a.createElement(Swe,{onResize:Ee},a.createElement("div",{ref:kY(t,C),role:"tablist",className:qL("".concat(i,"-nav"),s),style:l,onKeyDown:function(){he()}},a.createElement(Lwe,{ref:E,position:"left",extra:h,prefixCls:i}),a.createElement(Swe,{onResize:Ee},a.createElement("div",{className:qL(Pe,(r={},cK(r,"".concat(Pe,"-ping-left"),Te),cK(r,"".concat(Pe,"-ping-right"),Ae),cK(r,"".concat(Pe,"-ping-top"),Me),cK(r,"".concat(Pe,"-ping-bottom"),Ne),r)),ref:k},a.createElement(Swe,{onResize:Ee},a.createElement("div",{ref:x,className:"".concat(i,"-nav-list"),style:{transform:"translate(".concat(A,"px, ").concat(D,"px)"),transition:de?"none":void 0}},we,a.createElement(Vwe,{ref:I,prefixCls:i,locale:g,editable:p,style:mK(mK({},0===we.length?void 0:_e),{},{visibility:De?"hidden":null})}),a.createElement("div",{className:qL("".concat(i,"-ink-bar"),cK({},"".concat(i,"-ink-bar-animated"),u.inkBar)),style:Re}))))),a.createElement(pSe,aK({},e,{removeAriaLabel:null==g?void 0:g.removeAriaLabel,ref:O,prefixCls:i,tabs:xe,className:!De&&oe,tabMoving:!!de})),a.createElement(Lwe,{ref:S,position:"right",extra:h,prefixCls:i})))}const bSe=a.forwardRef(ySe);var _Se=["renderTabBar"],wSe=["label","key"];function CSe(e){var t=e.renderTabBar,r=bK(e,_Se),n=a.useContext(hwe).tabs;return t?t(mK(mK({},r),{},{panes:n.map((function(e){var t=e.label,r=e.key,n=bK(e,wSe);return a.createElement(pwe,aK({tab:t,key:r,tabKey:r},n))}))}),bSe):a.createElement(bSe,r)}var ESe=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","moreIcon","moreTransitionName","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicatorSize"],SSe=0;function kSe(e,t){var r,n=e.id,i=e.prefixCls,o=void 0===i?"rc-tabs":i,s=e.className,l=e.items,c=e.direction,u=e.activeKey,d=e.defaultActiveKey,f=e.editable,h=e.animated,p=e.tabPosition,g=void 0===p?"top":p,m=e.tabBarGutter,v=e.tabBarStyle,y=e.tabBarExtraContent,b=e.locale,_=e.moreIcon,w=e.moreTransitionName,C=e.destroyInactiveTabPane,E=e.renderTabBar,S=e.onChange,k=e.onTabClick,x=e.onTabScroll,O=e.getPopupContainer,I=e.popupClassName,R=e.indicatorSize,T=bK(e,ESe),A=a.useMemo((function(){return(l||[]).filter((function(e){return e&&"object"===sK(e)&&"key"in e}))}),[l]),M="rtl"===c,N=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inkBar:!0,tabPane:!1};return(e=!1===t?{inkBar:!1,tabPane:!1}:!0===t?{inkBar:!0,tabPane:!1}:mK({inkBar:!0},"object"===sK(t)?t:{})).tabPaneMotion&&void 0===e.tabPane&&(e.tabPane=!0),!e.tabPaneMotion&&e.tabPane&&("production"!==Ni.exports.env.NODE_ENV&&BK(!1,"`animated.tabPane` is true but `animated.tabPaneMotion` is not provided. Motion will not work."),e.tabPane=!1),e}(h),D=pK(Object(a.useState)(!1),2),P=D[0],j=D[1];Object(a.useEffect)((function(){j(e2())}),[]);var F=pK(k0((function(){var e;return null===(e=A[0])||void 0===e?void 0:e.key}),{value:u,defaultValue:d}),2),V=F[0],L=F[1],$=pK(Object(a.useState)((function(){return A.findIndex((function(e){return e.key===V}))})),2),B=$[0],U=$[1];Object(a.useEffect)((function(){var e,t=A.findIndex((function(e){return e.key===V}));-1===t&&(t=Math.max(0,Math.min(B,A.length-1)),L(null===(e=A[t])||void 0===e?void 0:e.key));U(t)}),[A.map((function(e){return e.key})).join("_"),V,B]);var z=pK(k0(null,{value:n}),2),H=z[0],W=z[1];Object(a.useEffect)((function(){n||(W("rc-tabs-".concat("test"===Ni.exports.env.NODE_ENV?"test":SSe)),SSe+=1)}),[]);var G={id:H,activeKey:V,animated:N,tabPosition:g,rtl:M,mobile:P},K=mK(mK({},G),{},{editable:f,locale:b,moreIcon:_,moreTransitionName:w,tabBarGutter:m,onTabClick:function(e,t){null==k||k(e,t);var r=e!==V;L(e),r&&(null==S||S(e))},onTabScroll:x,extra:y,style:v,panes:null,getPopupContainer:O,popupClassName:I,indicatorSize:R});return a.createElement(hwe.Provider,{value:{tabs:A,prefixCls:o}},a.createElement("div",aK({ref:t,id:n,className:qL(o,"".concat(o,"-").concat(g),(r={},cK(r,"".concat(o,"-mobile"),P),cK(r,"".concat(o,"-editable"),f),cK(r,"".concat(o,"-rtl"),M),r),s)},T),a.createElement(CSe,aK({},K,{renderTabBar:E})),a.createElement(mwe,aK({destroyInactiveTabPane:C},G,{animated:N}))))}var xSe=a.forwardRef(kSe);"production"!==Ni.exports.env.NODE_ENV&&(xSe.displayName="Tabs");const OSe=({className:e,...t})=>{const{attributes:r,listeners:n,setNodeRef:i,transform:o,transition:a}=HU({id:t["data-node-key"],disabled:t.disabled}),l={...t.style,transform:y$.Transform.toString(o&&{...o,scaleX:1}),transition:a};return s.a.cloneElement(t.children,{ref:i,style:l,...r,...n})},ISe=()=>{const{getChooseConfigs:e,onChooseView:t,onCancelEditing:r,onViewNameChange:n,onHandleSetting:i,editingKey:o,activeView:l,onDragEnd:c,isReadonly:h}=cwe(),g=HL(c8),[m,v]=Object(a.useState)(""),y=(e,t)=>{v(e?t.key:"")},b=M$(A$(OB,{activationConstraint:{distance:8}})),_=(e,t,r)=>{"add"===t&&(e=>{const t=e.currentTarget;null==g||g.open("add-view",{position:{origin:t,placement:"bottom"}})})(e)},w=e=>s.a.createElement("span",{onDoubleClick:()=>{h||i({key:l.get("uuid")},lwe.find((e=>"rename"===e.key)))},className:"lakex-table-viewer-manage-tab-title"},e.title),C=e({unActiveViewColor:!0}).map((e=>e?{key:e.key,label:s.a.createElement("div",{className:"lakex-table-viewer-manage-tab-item"},e.icon,e.key===o&&s.a.createElement(u.a,{className:"lakex-table-menu-configs-input",defaultValue:e.title,autoFocus:!0,onKeyDown:t=>{t.stopPropagation();const i=t.keyCode;27!==i?13===i&&n(t,e):r()},onClick:e=>e.stopPropagation(),onBlur:t=>n(t,e)}),e.key!==o&&e.title.length>10&&s.a.createElement(p.a,{placement:"top",title:e.title,arrow:!0},w(e)),e.key!==o&&e.title.length<=10&&w(e)),closable:!h,closeIcon:e.key===l.get("uuid")?s.a.createElement(f.a,{overlayClassName:"lakex-table-menu-container lakex-table-toolbar-tab-menu",content:s.a.createElement(d.a,{onClick:e=>{i({key:l.get("uuid")},e),y(!1,e)}},lwe.map((e=>s.a.createElement(d.a.Item,{key:e.key},e.title)))),visible:m===e.key,trigger:"click",placement:"bottomLeft",onClick:e=>e.stopPropagation(),onVisibleChange:t=>y(t,e)},s.a.createElement(XU,{type:"MoreHorizontal",size:14})):s.a.createElement("span",null)}:null)).filter((e=>!!e));return s.a.createElement(xSe,{className:"lakex-table-viewer-manage-tab",prefixCls:"ant-tabs",activeKey:null==l?void 0:l.get("uuid"),onChange:e=>t({key:e}),items:C,editable:{onEdit:(e,{key:t,event:r})=>{null==_||_("add"===e?r:t,e)},removeIcon:s.a.createElement("span",null),showAdd:!h,addIcon:s.a.createElement(XU,{type:"Add",size:14})},popupClassName:"lakex-table-viewer-manage-tab-more-popup",moreIcon:s.a.createElement(XU,{type:"MoreHorizontal",size:14}),renderTabBar:(e,t)=>s.a.createElement(lU,{sensors:b,modifiers:[WU,KU],collisionDetection:B$,onDragEnd:c},s.a.createElement(FU,{items:C.map((e=>({id:e.key}))),strategy:AU},s.a.createElement(t,{...e},(e=>s.a.createElement(OSe,{"data-node-key":String(e.key)||"",disabled:!!o},e)))))})};var RSe=Object.defineProperty,TSe=Object.getOwnPropertyDescriptor,ASe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?TSe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RSe(t,r,o),o};let MSe=class{static pluginModule(){return xo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"viewerManage",type:"object",title:"视图管理",properties:{type:{type:"string",description:"组件类型",enum:Object.values(fwe)},viewTypes:{type:"array",description:"可操作的视图列表"}}}),e.registerDefaultValue({"viewerManage.type":fwe.TAB,"viewerManage.viewTypes":[LE.GRID,LE.CARD,LE.KANBAN]})}init(){}registerToolbar(e){const t=this._configuration.getValue("viewerManage.type");e.registerItem({id:"view-manage",RenderComponent:t===fwe.MENU?awe:ISe,onClick:e=>{if(t===fwe.TAB)return;const r={position:{placement:"bottom",origin:e.target}};this._modalService.open("view-manage",r)}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"view-manage",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER&&{placement:"bottom"},scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?dwe:uwe}),e.registerItem({id:"add-view",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:swe})}};MSe.pluginName="workbench-viewer-manage",ASe([ao(c8)],MSe.prototype,"_modalService",2),ASe([ao(lp)],MSe.prototype,"_configuration",2),MSe=ASe([io({contrib:[jL,j4,u8]})],MSe);const NSe=$i.defineToken("AddFieldPluginConfigContribution"),DSe=$i.defineToken("AddFieldPluginColConfigNameContribution");var PSe=Object.defineProperty,jSe=Object.getOwnPropertyDescriptor,FSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jSe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&PSe(t,r,o),o};let VSe=class{constructor(){this.getConfigComponents=()=>{const e=this.addFieldPluginConfigProvider.getContributions({cache:!1});return e.length>0?e.map((e=>e.getConfigComponent())):[]},this.getColConfigNameComponent=()=>{var e,t;const r=this.AddFieldPluginColConfigNameaddFieldPluginConfigProvider.getContributions({cache:!1});return r[0]?null==(t=(e=r[0]).getColConfigNameComponent)?void 0:t.call(e):null}}};FSe([wh(NSe)],VSe.prototype,"addFieldPluginConfigProvider",2),FSe([wh(DSe)],VSe.prototype,"AddFieldPluginColConfigNameaddFieldPluginConfigProvider",2),VSe=FSe([io()],VSe);const LSe=e=>{var t,r;if(!zE.isSelectLike(e.type))return null;const n={type:e.type,options:(null==(t=e.property)?void 0:t.options)||[],color:(null==(r=e.property)?void 0:r.color)||!1};return s.a.createElement("div",{className:"select-input lakex-table-col-options"},s.a.createElement(x4,{title:s.a.createElement("span",{className:"lakex-table-option-config-title"},Ph("选项设置")),onChange:e.onChange,onChangeOrder:e.onChangeOrder,multiple:e.type===pE.MULTI_SELECT,configs:n}))},$Se=({initialState:e})=>{const{fieldId:t,showFieldTypes:r,sourceFieldId:n,direction:i="after"}=e||{},{field:o,fieldName:l,fieldType:c,fieldOptions:d,updateProperty:f}=r7(t||""),h=HL(KO),g=HL(zI),m=HL(bR),v=HL(nH),y=HL(c8),_=HL(KD),w=HL(VSe),C=null==v?void 0:v.getFieldIcon(null==o?void 0:o.type),E=(null==w?void 0:w.getConfigComponents())||[],S=Lo(o),[k,x]=Object(a.useState)(null),O=Object(a.useMemo)((()=>{if(S){return(e=>{let t;const r=[];for(e.forEach((e=>{r.push(e.uuid)}));!t||r.includes(t);)t=To(32);return{id:t,name:wE(pE.TEXT,e),type:pE.TEXT,options:null}})(h.getAllFields().toJSON())}return{id:t,name:l||"",type:c||pE.TEXT,options:(null==d?void 0:d.toJSON())||[]}}),[o]),[I,R]=Object(a.useState)(O.name),[T,A]=Object(a.useState)(O.type),M=Object(a.useRef)(null),[N,D]=Object(a.useState)((()=>zE.isSelectLike(T)?{options:O.options,color:Boolean(null==o?void 0:o.get("color"))}:null)),P=Object(a.useCallback)((()=>{y.close("addOrUpdateField")}),[y]),j=Object(a.useCallback)((e=>{if(!e)return Ph("列名不能为空");return zp(h.getAllFields(),(t=>t.get("uuid")!==O.id&&t.get("name")===e))?Ph("不能与其他列重名"):null}),[]),F=Object(a.useCallback)((e=>{const t=j(e);x(t)}),[]),V=Object(a.useCallback)((e=>{const{ctrlKey:t,metaKey:r}=e;if(13===e.keyCode&&!t&&!r){const t=e.target.value.trim();F(t)}}),[]),L=Object(a.useCallback)((async e=>{const r=j(I);if(x(r),F(I),!r)if(S){const t={field:{uuid:e||To(32),name:I,type:T,color:void 0},sourceFieldId:n,direction:i};N&&(t.field.color=N.color,t.field.options=N.options),null==g||g.execCommand("addField",t),P()}else{const e={uuid:t,name:I,type:T};N&&(e.color=N.color,e.options=N.options),f(e),P()}}),[j,o,S,t,n,i,I,T,F,N]),$=Object(a.useCallback)((e=>af(h.getFieldCells(e.fieldId),"formatValue").filter((e=>!!e.formatValue)).map(((e,t)=>({color:null==_?void 0:_.getByIndex(t),name:e.formatValue,uuid:To(6)})))),[]),B=Object(a.useCallback)((e=>{var r;const n=e.key,i=h.getAllFields();if(new RegExp(`${CE(T)}(\\s\\d)*`).test(I)&&S){const e=wE(n,i.toJSON());R(e),null==(r=M.current)||r.setValue(e)}if(!zE.isSelectLike(T)&&zE.isSelectLike(n)){if(!N||!N.options||0===N.options.length){const e={options:t?$({fieldId:t,type:T,color:!0}):[],color:!0};D(e),y.emitUpdatePosition("addOrUpdateField")}}else zE.isDate(n)||zE.isSystemDate(n);A(n)}),[O,h,T,N,t,S]);if(!S&&!o)return console.warn("FieldId is valid in FieldConfigModal"),null;let U=_E.filter((e=>{if(S){if(zE.isCreateDisable(e.type))return!1}else if(zE.isTransformDisable(e.type))return!1;return!0}));r&&(U=_E.filter((e=>r.includes(e.type))));const z=null==v?void 0:v.getFieldIcon(T),H=[{key:T,title:s.a.createElement("span",null,CE(T)),icon:z?s.a.createElement(z,{size:16}):null,groupBy:"subType",children:U.map((e=>{const t=null==v?void 0:v.getFieldIcon(e.type),r=null==w?void 0:w.getColConfigNameComponent();return{key:e.type,title:r?s.a.createElement(r,{fieldType:e.type,fieldName:e.name}):e.name,icon:t?s.a.createElement(t,{size:16}):null,subType:e.isAdvanced?Ph("高级"):Ph("基础"),showActiveIcon:!0}}))}];return s.a.createElement("div",{className:"lakex-table-col-configs"},s.a.createElement("p",{className:"lakex-table-col-title"},Ph("数据表列名")),s.a.createElement("div",{className:"lakex-table-col-name"},s.a.createElement(u.a,{defaultValue:I,onChange:e=>{const t=e.target.value.trim();R(t)},ref:M,maxLength:128,onKeyDown:V,onBlur:e=>{F(e.target.value.trim())},autoFocus:!0,className:qL({error:k})}),k&&s.a.createElement("div",{className:"lakex-table-col-error"},k)),s.a.createElement("p",{className:"lakex-table-col-title"},Ph("列类型"),s.a.createElement(p.a,{title:Ph("设置该列内容类型，支持文本、日期、数字、单选、多选等")},s.a.createElement(XU,{type:"Question",size:14,style:{marginLeft:4}}))),S||m.can(oR.TRANSFORM,aR.FIELD,o)?s.a.createElement(nz,{key:c,menuKey:c||"",className:"lakex-table-col-types",defaultSelectedKeys:[T],onClick:B,configs:H}):s.a.createElement("div",{className:"lakex-table-col-readonly"},C&&s.a.createElement(C,null),s.a.createElement("span",{className:"lakex-table-col-readonly-text"},CE(null==o?void 0:o.type))),s.a.createElement(LSe,{name:I,type:T,property:N,onChange:e=>{D(e)},onChangeOrder:async(e,t)=>{}}),E.length>0&&E.map((e=>s.a.createElement(e,{key:null,originField:o,fieldType:T,fieldName:I,fieldProperty:N,onFieldSubmitConfirm:L}))),s.a.createElement("div",{className:"lakex-table-col-configs-footer"},s.a.createElement(b.a,{style:{marginRight:12},onClick:P},Ph("取消")),s.a.createElement(b.a,{type:"primary",disabled:k,onClick:()=>L()},Ph("确定"))))};var BSe=Object.defineProperty,USe=Object.getOwnPropertyDescriptor,zSe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?USe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BSe(t,r,o),o};let HSe=class{constructor(){this._toDestroyCollection=new gp}static pluginModule(){return xo().contribution(NSe).contribution(DSe).register(this).register(VSe)}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}init(){this._toDestroyCollection.push(this._renderService.onClickIcon((e=>{"grid-field-config"===e.iconName&&this._handleOpenFieldConfigCreateModal(e.event.currentTarget)}))),this._toDestroyCollection.push(this._renderService.onClickEvent((e=>{if("gridHeader:doubleClick"===e.eventName){const{event:t,fieldId:r}=e.data;this._modalService.open("addOrUpdateField",{position:{origin:t.currentTarget,placement:"bottom"},initialState:{fieldId:r}})}})))}destroy(){this._toDestroyCollection.destroy()}registerModal(e){e.registerItem({id:"addOrUpdateField",hasMask:!1,scrollStrategy:"block",zIndex:"expandRecord",RenderComponent:$Se})}registerContextMenu(e){e.registerItem({key:"updateField",name:Ph("编辑列"),icon:"Edit",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.HEADER,onClick:({initialState:e,position:t})=>{const{recordId:r,fieldId:n}=e;if(!t)return;const i=this._workbenchContext.$root.querySelector(`.lakex-viewer-grid-header-column[data-field-id="${n}"]`);this._modalService.open("addOrUpdateField",{initialState:{recordId:r,fieldId:n},position:{origin:i,placement:"bottom"}}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"insertFieldLeft",name:Ph("向左插入列"),icon:"LeftArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.HEADER,onClick:({initialState:e,position:t})=>{const r=this._readService.getActiveView(),{fieldId:n,originRect:i}=e;if(!t||!r)return;const o=Fp(this._readService.getViewFields(r.get("uuid"))||[],(e=>e.get("field_uuid")===n));this._modalService.open("addOrUpdateField",{position:{origin:i,placement:"bottom"},initialState:{sourceFieldId:null==o?void 0:o.get("field_uuid"),direction:"before"}}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"insertFieldRight",name:Ph("向右插入列"),icon:"RightArrow",hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.HEADER,onClick:({initialState:e,position:t})=>{const r=this._readService.getActiveView(),{fieldId:n,originRect:i}=e;if(!t||!r)return;const o=Fp(this._readService.getViewFields(r.get("uuid"))||[],(e=>e.get("field_uuid")===n));this._modalService.open("addOrUpdateField",{position:{origin:i,placement:"bottom"},initialState:{sourceFieldId:null==o?void 0:o.get("field_uuid"),direction:"after"}}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"removeField",name:Ph("删除列"),icon:"Delete",hotkey:"",visible:({from:e,fieldId:t})=>{if(!t)return!1;const r=this._readService.getField(t);return!this.isReadonly&&e===Xue.HEADER&&!zE.isDeleteDisable(null==r?void 0:r.get("type"))},onClick:({initialState:e})=>{const{fieldId:t,disableDel:r}=e;r||(this._commandService.execCommand("removeField",{fieldId:t}),this._modalService.close("context-menu-modal"))}})}_handleOpenFieldConfigCreateModal(e){this.isReadonly||this._modalService.open("addOrUpdateField",{position:{origin:e,placement:"bottom"}})}};HSe.pluginName="workbench-add-field",zSe([ao(c8)],HSe.prototype,"_modalService",2),zSe([ao(Qz)],HSe.prototype,"_renderService",2),zSe([ao(bR)],HSe.prototype,"_abilityService",2),zSe([ao(BL)],HSe.prototype,"_workbenchContext",2),zSe([ao(KO)],HSe.prototype,"_readService",2),zSe([ao(zI)],HSe.prototype,"_commandService",2),HSe=zSe([io({contrib:[jL,u8,yme]})],HSe);const WSe=()=>{const e=HL(KO),t=HL(zI),r=Vp(null==e?void 0:e.getAllViewFields(),(e=>{var t;return(null==(t=e.get("field"))?void 0:t.get("type"))===pE.IMAGE}))||[],n=null==e?void 0:e.getViewConfig();return{options:[{label:Ph("无封面"),value:null,icon:s.a.createElement(XU,{type:"Clear",size:14})},...Bp(r,(e=>{const t=e.get("field");return{label:null==t?void 0:t.get("name"),value:null==t?void 0:t.get("uuid"),icon:s.a.createElement(XU,{type:"FieldImage"})}}))],defaultValue:(null==n?void 0:n.get("cover_field_uuid"))||null,onCoverSourceChange:r=>{var n;null==t||t.execCommand("updateCoverSource",{viewId:null==(n=null==e?void 0:e.getActiveView())?void 0:n.get("uuid"),coverFieldId:r})}}},GSe=()=>{const{options:e,defaultValue:t,onCoverSourceChange:r}=WSe();return s.a.createElement("div",{className:"lakex-table-view-setting-wrap lakex-table-view-setting-cover-source"},s.a.createElement("span",{className:"lakex-table-view-setting-title"},Ph("封面来源")),s.a.createElement(S.a,{defaultValue:t,dropdownClassName:"lakex-table-menu-container lakex-table-view-setting",onChange:r,suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:14})},e.map((e=>s.a.createElement(S.a.Option,{value:e.value,key:e.value,className:"column-select-option"},e.icon,e.label)))))},KSe=()=>{var e;const t=HL(KO),r=HL(zI);return{options:[{label:Ph("适应"),value:"fit"},{label:Ph("裁剪"),value:"clip"}],coverDisplay:null==(e=null==t?void 0:t.getViewConfig())?void 0:e.get("cover_display"),viewFields:(null==t?void 0:t.getViewFields())||[],onCoverDisplayChange:e=>{var n;null==r||r.execCommand("updateCoverDisplay",{viewId:null==(n=null==t?void 0:t.getActiveView())?void 0:n.get("uuid"),coverDisplay:e})}}},qSe=()=>{const{options:e,onCoverDisplayChange:t,coverDisplay:r}=KSe();return s.a.createElement("div",{className:"lakex-table-view-setting-wrap lakex-table-view-setting-cover-display"},s.a.createElement("span",{className:"lakex-table-view-setting-title"},Ph("封面效果")),s.a.createElement(g.a.Group,{options:e,onChange:e=>t(e.target.value),defaultValue:r,optionType:"button"}))},YSe=()=>{const e=HL(KO),t=HL(zI);return{viewConfig:null==e?void 0:e.getViewConfig(),onShowFieldChange:r=>{var n;null==t||t.execCommand("updateShowFieldName",{viewId:null==(n=null==e?void 0:e.getActiveView())?void 0:n.get("uuid"),showFieldName:r})}}},JSe=()=>{const{viewConfig:e,onShowFieldChange:t}=YSe();return s.a.createElement("div",{className:"lakex-table-view-setting-wrap lakex-table-view-setting-show-name"},s.a.createElement("span",{className:"lakex-table-view-setting-title"},Ph("显示字段名")),s.a.createElement(k.a,{defaultChecked:null==e?void 0:e.get("show_field_name"),onChange:t,size:"small"}))},XSe=()=>{const e=HL(nH),t=HL(zI),r=HL(c8),n=i7();return{readonly:X9(aR.TABLE).isReadonly(),viewFields:n,onFieldHiddenChange:(e,r,n)=>{null==t||t.execCommand("updateFieldHidden",{viewId:e,fieldId:r,hidden:n})},openConfigMenu:(e,t,n)=>{var i;null==r||r.open("view-field-action",{position:{origin:e.target,placement:"right"},initialState:{fieldId:t.get("field_uuid"),fieldName:null==(i=t.get("field"))?void 0:i.get("name"),target:e.target,disableDel:n}})},fieldService:e}},ZSe=({readonly:e,viewField:t,disable:r,OrderDragIcon:n,onFieldHiddenChange:i,openConfigMenu:o})=>{const a=HL(KO),l=HL(nH),c=t.get("field"),u=t.get("hidden"),d=t.get("group_uuid"),f=t.get("field_uuid"),h=t.get("view_uuid"),{attributes:p,listeners:g,setNodeRef:m,transform:v,transition:y,isDragging:b}=HU({id:f}),_=c?null==l?void 0:l.getFieldIcon(c.get("type")):null,w=c?null==l?void 0:l.getFieldTagComponent(c.get("type")):null,C={transform:y$.Transform.toString(v),transition:y,zIndex:b?"100":"auto",opacity:b?.3:1},E=d?Fp(null==a?void 0:a.getViewFieldGroups(h),(e=>e.get("uuid")===d)):null;return c?s.a.createElement("div",{ref:e?void 0:m,className:"lakex-table-view-setting-field-item "+(u?"lakex-table-view-setting-disable":""),...p,style:C},n&&!e&&s.a.createElement("span",{className:"lakex-table-view-setting-drag-icon"},s.a.createElement(n,{listeners:g})),_?s.a.createElement(_,{className:"lakex-table-view-setting-field-icon"}):null,s.a.createElement("div",{className:"lakex-table-view-setting-field-name"},s.a.createElement("span",{className:"lakex-table-view-setting-field-name-content"},E?`${E.get("name")}-${c.get("name")}`:c.get("name")),w?s.a.createElement(w,{field:c,position:"viewerSetting"}):null),s.a.createElement("span",{className:"lakex-table-view-setting-operation-icon"},!r&&s.a.createElement(XU,{type:u?"IconHide":"Preview",onClick:()=>i(h,f,!u)})),!e&&s.a.createElement(XU,{className:"lakex-table-config-container lakex-table-view-setting-operation-icon",type:"MoreHorizontal",onClick:e=>o(e,t,r)})):null},QSe=()=>{const{readonly:e,viewFields:t,onFieldHiddenChange:r,openConfigMenu:n}=XSe(),{onDragEnd:i,OrderDragIcon:o}=(e=>{const t=HL(zde),{OrderDragIcon:r}=t,n=Object(a.useCallback)((async e=>{const{active:r,over:n}=e;r.id!==n.id&&await t.updateFieldOrder(r.id,n.id)}),[t,e]);return{OrderDragIcon:r,onDragEnd:n}})(t),l=M$(A$(OB,{activationConstraint:{distance:8}})),c=Object(a.useMemo)((()=>Bp(t,(e=>({id:e.get("field_uuid")})))),[t]),u=Vp(t,(e=>!e.get("hidden")));let d;return 1===u.length&&(d=u[0]),s.a.createElement("div",{className:"lakex-table-view-setting-fields"},s.a.createElement(lU,{sensors:l,modifiers:[YU,KU],collisionDetection:B$,onDragEnd:i},s.a.createElement(FU,{items:c,strategy:DU},Bp(t,(t=>{const i=t.get("field");let a=(null==d?void 0:d.get("uuid"))===t.get("uuid");return i?(zE.isDeleteDisable(i.get("type"))&&(a=!0),s.a.createElement(ZSe,{key:t.get("field_uuid"),readonly:!!e,viewField:t,disable:a,OrderDragIcon:o,onFieldHiddenChange:r,openConfigMenu:n})):null})))))},eke=({settings:e=["fields"]})=>s.a.createElement("div",{className:"lakex-table-menu-container lakex-table-view-setting"},(null==e?void 0:e.includes("cover"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(GSe,null),s.a.createElement(qSe,null),s.a.createElement("div",{className:"lakex-table-view-setting-hr"})),(null==e?void 0:e.includes("showField"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(JSe,null),s.a.createElement("div",{className:"lakex-table-view-setting-hr"})),e.includes("fields")&&s.a.createElement(QSe,null)),tke=({initialState:e})=>s.a.createElement("div",{className:"lakex-table-view-setting-modal"},s.a.createElement(eke,{settings:e.settings})),rke=({initialState:e})=>{const{items:t}=(({fieldId:e,fieldName:t,target:r,disableDel:n})=>{const i=HL(c8),o=HL(zI);return{items:[{key:"field-edit",icon:"Edit",name:Ph("编辑"),onClick:()=>{null==i||i.close("view-field-action"),null==i||i.open("addOrUpdateField",{position:{origin:r,placement:"right"},initialState:{fieldId:e}})}},{key:"field-del",icon:"Delete",name:Ph("删除"),onClick:()=>{n||(null==o||o.execCommand("removeField",{fieldId:e}),null==i||i.close("view-field-action"))}}]}})({fieldId:e.fieldId,fieldName:e.fieldName,target:e.target,disableDel:e.disableDel});return s.a.createElement(d.a,{mode:"vertical",className:"lakex-table-field-action"},t.map(((t,r)=>s.a.createElement(d.a.Item,{className:qL({disable:"field-del"===t.key&&e.disableDel}),key:t.key,icon:s.a.createElement("span",null,s.a.createElement(XU,{type:t.icon})),onClick:()=>{var e;null==(e=t.onClick)||e.call(t)}},Ph(t.name)))))},nke=()=>{const{options:e,defaultValue:t}=WSe(),r=HL(c8),n=Object(a.useMemo)((()=>[{key:"cover-source",title:Ph("封面来源"),options:e,defaultValue:t}]),[e,t]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(cbe,{list:n,onSelect:e=>{r.open("view-field-cover-source",{position:{placement:"bottom"},initialState:{options:e.options,defaultValue:e.defaultValue}})}}))},ike=()=>{const{options:e,onCoverDisplayChange:t,coverDisplay:r}=KSe(),n=Object(a.useMemo)((()=>[{key:"cover-display",title:Ph("封面效果"),options:e,defaultValue:r||"clip"}]),[e,r]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(lbe,{list:n,onChoose:(e,r)=>{t(r.value)}}))},oke=()=>{const{viewConfig:e,onShowFieldChange:t}=YSe(),r=Object(a.useMemo)((()=>[{key:e.get("uuid"),title:Ph("显示字段名"),checked:!!e.get("show_field_name")}]),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(abe,{list:r,onSwitch:(e,r)=>{t(r)}}))},ake=()=>{const{viewFields:e,onFieldHiddenChange:t,fieldService:r}=XSe(),n=Vp(e,(e=>!e.get("hidden")));let i;1===n.length&&(i=n[0]);const o=Object(a.useMemo)((()=>Bp(e,(e=>{const t=e.get("field");if(!t)return null;const n=(null==r?void 0:r.getFieldIcon(t.get("type")))||null,o=e.get("hidden");let a=(null==i?void 0:i.uuid)===e.get("uuid");return zE.isDeleteDisable(t.get("type"))&&(a=!0),{key:e.get("uuid"),title:t.get("name"),checked:!o,icon:n?s.a.createElement(n,null):null,disabled:a}})).filter((e=>!!e))),[e]);return s.a.createElement("div",{className:"lakex-table-view-setting-fields"},s.a.createElement(abe,{list:o,onSwitch:(r,n)=>{const i=Fp(e,(e=>e.get("uuid")==r.key));i&&t(i.get("view_uuid"),i.get("field_uuid"),!n)}}))},ske=({settings:e=["fields"]})=>s.a.createElement("div",{className:"lakex-table-h5-viewer-setting"},(null==e?void 0:e.includes("cover"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(nke,null),s.a.createElement(ike,null)),(null==e?void 0:e.includes("showField"))&&s.a.createElement(s.a.Fragment,null,s.a.createElement(oke,null)),e.includes("fields")&&s.a.createElement(ake,null)),lke=({initialState:e})=>{const t=HL(c8);return s.a.createElement(s.a.Fragment,null,s.a.createElement(rbe,{title:e.title,onClose:()=>{t.close("view-field-setting")},showCloseIcon:!0},s.a.createElement(ske,{settings:e.settings})))},cke=({initialState:e})=>{const{onCoverSourceChange:t}=WSe(),r=HL(c8),n=()=>{r.close("view-field-cover-source")},i=Object(a.useMemo)((()=>e.options.map((e=>({key:e.value||"",icon:e.icon,title:e.label||""})))),[e.options]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(rbe,{title:Ph("请选择"),onClose:n,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:e.defaultValue||"",list:i,onCheck:e=>{t(e.key),n()}})))};var uke=Object.defineProperty,dke=Object.getOwnPropertyDescriptor,fke=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?dke(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&uke(t,r,o),o};let hke=class{constructor(){this._getTitlte=()=>{const e=this._readService.getActiveView();return(null==e?void 0:e.get("type"))===LE.GRID?Ph("表格配置"):(null==e?void 0:e.get("type"))===LE.CARD?Ph("画册配置"):(null==e?void 0:e.get("type"))===LE.KANBAN?Ph("看板配置"):""}}static pluginModule(){return xo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"view-field-setting",icon:"Setting",tooltip:this._getTitlte,visible:()=>{const e=this._readService.getActiveView();return[LE.GRID,LE.CARD,LE.KANBAN].includes(null==e?void 0:e.get("type"))},onClick:e=>{const t=e.target;this._modalService.open("view-field-setting",{position:{origin:t,placement:"bottom"},initialState:this._getInitstate()})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"view-field-setting",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?lke:tke}),r===jz.MOBILE&&e.registerItem({id:"view-field-cover-source",mode:l8.DRAWER,hasMask:!0,hasAnimation:!0,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:cke}),e.registerItem({id:"view-field-action",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:rke})}_getInitstate(){const e=this._readService.getActiveView();return e.get("type")===LE.GRID?{settings:["fields"],title:this._getTitlte()}:e.get("type")===LE.CARD?{settings:["cover","showField","fields"],title:this._getTitlte()}:e.get("type")===LE.KANBAN?{settings:["showField","fields"],title:this._getTitlte()}:{}}};hke.pluginName="workbench-viewer-field-setting",fke([ao(KO)],hke.prototype,"_readService",2),fke([ao(c8)],hke.prototype,"_modalService",2),fke([ao(lp)],hke.prototype,"_configuration",2),hke=fke([io({contrib:[jL,j4,u8]})],hke);var pke=Object.defineProperty,gke=Object.getOwnPropertyDescriptor,mke=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?gke(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pke(t,r,o),o};let vke=class{static pluginModule(){return xo().register(this)}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}init(){}registerContextMenu(e){e.registerItem({key:"editFieldGroup",name:Ph("修改分组名称"),hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.GROUP_HEADER,onClick:({initialState:e})=>{this._fieldGroupService.emitEdit(e.fieldGroupId),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"removeFieldGroup",name:Ph("取消分组"),hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.GROUP_HEADER,onClick:({initialState:e})=>{this._commandService.execCommand("removeFieldGroup",{fieldGroupId:e.fieldGroupId}),this._modalService.close("context-menu-modal")}}),e.registerItem({key:"addFieldGroup",name:Ph("合并为分组"),hotkey:"",visible:({from:e})=>!this.isReadonly&&e===Xue.MULTI_CELL,onClick:({initialState:e})=>{const{selection:t}=e;if(!t)return;const{start:r,end:n}=t.getRangeAt(0),i=this._readService.getViewFields(),o=null==i?void 0:i.slice(r.column,n.column+1).map((e=>e.field_uuid));this._commandService.execCommand("addFieldGroup",{fieldIds:o}),this._modalService.close("context-menu-modal")}})}};vke.pluginName="workbench-field-group",mke([ao(c8)],vke.prototype,"_modalService",2),mke([ao(zI)],vke.prototype,"_commandService",2),mke([ao(bR)],vke.prototype,"_abilityService",2),mke([ao(KO)],vke.prototype,"_readService",2),mke([ao(cfe)],vke.prototype,"_fieldGroupService",2),vke=mke([io({contrib:[jL,yme]})],vke);const yke=({initialState:e})=>{const t=HL(Wz),r=HL(gre),[n,i]=Object(a.useState)(e.x),[o,l]=Object(a.useState)(0);return Object(a.useEffect)((()=>{const e=r.onResize((({x:e})=>{i(e)}));return()=>{e.destroy()}}),[]),Object(a.useEffect)((()=>{const e=t.$root.getBoundingClientRect().height;l(e||"100%")}),[t]),s.a.createElement("div",{className:"lakex-grid-column-resize-line",style:{transform:`translateX(${n}px)`,height:o}})};var bke=Object.defineProperty,_ke=Object.getOwnPropertyDescriptor,wke=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?_ke(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&bke(t,r,o),o};let Cke=class{constructor(){this._columnControllerModalId="grid-column-controller"}static pluginModule(){return xo().register(this)}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}init(){this._columnControllerService.onResizeStart((({x:e})=>{const{left:t,top:r}=this._renderContext.$root.getBoundingClientRect();this._modalService.open(this._columnControllerModalId,{position:{left:t,top:r},initialState:{x:e}})})),this._columnControllerService.onResizeEnd((()=>{this._modalService.close(this._columnControllerModalId)}))}registerModal(e){e.registerItem({id:this._columnControllerModalId,hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",RenderComponent:yke})}};Cke.pluginName="workbench-viewer-grid",wke([ao(c8)],Cke.prototype,"_modalService",2),wke([ao(gre)],Cke.prototype,"_columnControllerService",2),wke([ao(Wz)],Cke.prototype,"_renderContext",2),wke([ao(bR)],Cke.prototype,"_abilityService",2),Cke=wke([io({contrib:[jL,u8]})],Cke);const Eke=e=>{const t=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e;const r=e=>{e.preventDefault(),e.stopPropagation()};return null==(e=t.current)||e.addEventListener("wheel",r,{passive:!1}),()=>{var e;null==(e=t.current)||e.removeEventListener("wheel",r)}}),[e.visible]);const r=t=>{t.preventDefault(),e.onBeforeEndEdit(t)};return e.visible?s.a.createElement("div",{className:"lakex-mask-in-cell-editor",onClick:r,ref:t,onContextMenu:r}):null},Ske=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{editing:r,style:n,fieldType:i,isMultiText:o,onBlur:l,onChange:c,onSave:u}=e,d=Object(a.useRef)(null),f=HL(bre),h=HL(Ore),p=HL(qte),[g,m]=Object(a.useState)(!1);Object(a.useImperativeHandle)(t,(()=>({focus:()=>{var e;null==(e=d.current)||e.focus()},blur:()=>{var e;null==(e=d.current)||e.blur()},onEndEdit:async e=>{await v(e)},onStartEdit:e=>{b(e)},getValue:()=>{var e;return null==(e=d.current)?void 0:e.getValue()}})));const v=async e=>{var t,r;if(!e){const e=String(null==(t=d.current)?void 0:t.getValue()),n=null==(r=null==e?void 0:e.trim)?void 0:r.call(e);await(null==u?void 0:u(n))}setTimeout((()=>{var e,t;null==(e=d.current)||e.focus(),null==(t=d.current)||t.clearValue()}),30)},y=Object(a.useCallback)((t=>{e.toggleEditing(!1);const r=null==h?void 0:h.getCellIndexesByClientXY(t.clientX,t.clientY);r&&Oo((()=>{const e=null==p?void 0:p.createGridSelectionByIndex(r[0],r[1]);e&&(null==p||p.setSelection(e))}))}),[r]),b=t=>{var r,n,i;if(void 0===t)return;const o=(null==(r=e.getFormattedValue)?void 0:r.call(e,t))||t;null==(n=d.current)||n.setValue(o),null==(i=d.current)||i.setCursorToEnd(),Oo((()=>{null==h||h.updateCellCoordsInViewPort()}))},_=Object(a.useMemo)((()=>{if(!o){const e=null==f?void 0:f.rowHeightSize;return{...n,minHeight:e,height:e}}return n}),[o,n]),w={className:`textarea-cell ${i}`,ref:d,onKeyDown:t=>{var n;const o=t.shiftKey,a=t.key,s=a===xN.ENTER;if(!g){if(s)if(r&&o)document.execCommand("insertText",!1,"\n"),null==(n=d.current)||n.blur(),setTimeout((()=>{var e;null==(e=d.current)||e.focus()}),0);else if(!o){if(i===pE.LINK&&!r)return;e.toggleEditing(!0)}a===xN.TAB&&r&&(t.preventDefault(),e.toggleEditing(!1))}},onCompositionStart:()=>{m(!0)},onCompositionEnd:()=>{m(!1)},onChange:e=>{const t=e.target.value;c&&c(t)},readOnly:!1,onBlur:()=>{l&&l()},maxRows:6};return s.a.createElement(s.a.Fragment,null,s.a.createElement(Eke,{visible:r,onBeforeEndEdit:y}),s.a.createElement("div",{className:"lakex-table-text-editor",style:{..._}},s.a.createElement(XL,{allowEnter:o,...w})))})));function kke(e){const{editing:t}=e,r=HL($8),n=nre(t),i=Object(a.useRef)(null),[o,s,l]=_G();return Object(a.useLayoutEffect)((()=>{t&&i.current?s(i.current):l()}),[i,t]),{editorRelativeLayout:Object(a.useMemo)((()=>{const e={position:"absolute",left:0};if(!n)return e.width=0,e;const t=Math.round((null==o?void 0:o.height)||0),i=Math.floor((null==r?void 0:r.getRenderViewPort().height)||0);return Math.floor(n.top+t+4)>i?e.bottom=0:e.top=n.height+4,e}),[t,o,n]),editorWrapperRef:i}}const xke=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{editing:r,style:n,fieldType:i,inputObserverRef:o}=e,l=o7(e.recordId,e.fieldId),{field:c,fieldOptions:u,updateProperty:d}=r7(e.fieldId),f=X9(aR.FIELD).canUpdate(c),h=Object(a.useMemo)((()=>i===pE.MULTI_SELECT),[i]),p=HL(Qz),g=Object(a.useMemo)((()=>{const e=(null==l?void 0:l.value)||[];return Array.isArray(e)?e:[e]}),[h,null==l?void 0:l.value]),{editorRelativeLayout:m,editorWrapperRef:v}=kke({editing:r});Object(a.useImperativeHandle)(t,(()=>({focus:()=>{var e;null==(e=o.current)||e.focus()},blur:()=>{var e;null==(e=o.current)||e.blur()},onEndEdit:async e=>{var t;null==(t=o.current)||t.focus()}}))),Object(a.useEffect)((()=>{const t=null==p?void 0:p.onClickCellIcon((t=>{"cellSelectIcon"===t.iconName&&e.toggleEditing()}));return()=>{null==t||t.destroy()}}),[]);const y=async e=>{const t=g.includes(e.uuid);if(h){const r=t?g.filter((t=>t!==e.uuid)):g.concat(e.uuid);return await(null==l?void 0:l.setCell(r.map((e=>({value:e})))))}return await(null==l?void 0:l.setCell(t?"":e.uuid))},b=vG((async t=>{!r||(await y(t),h||e.toggleEditing())})),_=vG((e=>{const t=Vp(u,(t=>t.get("uuid")!==e));d({options:t.toJSON()})})),w=vG((async t=>{if(!r)return;const n=u.toJSON().concat(t);await d({options:n}),y(t),h||e.toggleEditing()})),C=vG((e=>{const t=Bp(u,(t=>t.get("uuid")===e.uuid?e:t));d({options:t})}));return c&&zE.isSelectLike(i)?s.a.createElement("div",{className:"lakex-grid-cell-editor-keyboard-input",ref:v,style:{...n,...m,maxWidth:"fit-content"},onKeyDown:t=>{t.key===xN.ENTER&&!t.shiftKey&&!r&&e.toggleEditing(!0)}},s.a.createElement(m4,{inputRef:o,visible:r,focus:!1,colorable:!!c.get("color"),options:u.toJSON(),editable:!0,optionEditable:f,selectedIds:g,onOptionCreate:w,onOptionChange:C,onOptionDelete:_,onOptionSelect:b})):null}))),Oke=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const{editing:r,style:n,inputObserverRef:i}=e,o=e.cellValue||[],l=o7(e.recordId,e.fieldId),c=HL(Qz),{editorRelativeLayout:u,editorWrapperRef:d}=kke({editing:r});Object(a.useImperativeHandle)(t,(()=>({focus:()=>{var e;null==(e=i.current)||e.focus()},blur:()=>{var e;null==(e=i.current)||e.blur()},onEndEdit:async e=>{var t;null==(t=i.current)||t.focus()}})));const f=vG((async e=>{if(r)return await(null==l?void 0:l.setCell(e.map((e=>e))))}));Object(a.useEffect)((()=>{const t=null==c?void 0:c.onClickCellIcon((t=>{"cellMentionIcon"===t.iconName&&e.toggleEditing()}));return()=>{null==t||t.destroy()}}),[]);return s.a.createElement("div",{className:"lakex-grid-cell-editor-keyboard-input",ref:d,style:{...n,...u,maxWidth:"fit-content"},onKeyDown:t=>{t.key===xN.ENTER&&!t.shiftKey&&!r&&e.toggleEditing(!0)}},s.a.createElement(r4,{focus:!1,visible:r,inputRef:i,selected:o,onSelect:e=>{const t=o.concat(e);f(t)},onUnselect:e=>{const t=o.filter((t=>t.uid!==e.uid));f(t)}}))}))),Ike={width:0,height:1,border:"none",padding:0,boxShadow:"none",overflowX:"hidden",overflowY:"hidden"};const Rke=["viewerGridCellEditor","tooltip","ai-writing-autofill-cell"],Tke=(e=>t=>{const r=rre(),n=Yte();return s.a.createElement(e,{selection:n,activeCell:r})})(Object(a.memo)((e=>{const{activeCell:t,selection:r}=e,{field:n,fieldType:i}=r7((null==t?void 0:t.fieldId)||""),o=HL(Qz),l=HL(fz),c=HL(c8),u=HL(lve),d=HL(qte),f=HL(dre),h=HL(pme,{optional:!0}),[p,g]=Object(a.useState)(!1),v=null==t?void 0:t.recordId,y=null==t?void 0:t.fieldId,b=o7(v,y),_=Object(a.useRef)(null),w=null==b?void 0:b.value,C=Object(a.useRef)(null),E=HL(nH),S=HL(z_e),k=HL(KO),x=nre(p),O=function(e){const{editing:t,width:r,height:n}=e;return Object(a.useMemo)((()=>t?r&&n?{width:r,minHeight:n}:{}:Ike),[t,r,n])}({editing:p,width:(null==x?void 0:x.width)||0,height:(null==x?void 0:x.height)||0}),I=Object(a.useMemo)((()=>{const e=(null==c?void 0:c.visibleList)||[];return!((e.length||0)>Rke.length)&&!(e.some((e=>!Rke.includes(e)))||null!=S&&S.isInSearching)}),[null==c?void 0:c.visibleList]),R=Object(a.useCallback)((()=>{var e;const t=_.current;!t||!I||null==(e=t.focus)||e.call(t)}),[I]),T=vG((e=>{(zE.isString(e.fieldType)||zE.isSelectLike(e.fieldType)||zE.isNumber(e.fieldType)||zE.isMention(e.fieldType))&&A(!0)}));Object(a.useEffect)((()=>{const e=null==o?void 0:o.onDoubleClickCell((e=>{T(e)})),t=null==o?void 0:o.onClickEvent((e=>{"activeCellClick"===e.eventName&&R()}));return()=>{null==e||e.destroy(),null==t||t.destroy()}}),[]),Object(a.useEffect)((()=>{null==u||u.emitEditingChange({recordId:v,fieldId:y,editing:p})}),[p]);const A=Object(a.useCallback)(((e=!1)=>{var t;const r=_.current;!r||p||!I||(g(!0),null==(t=r.onStartEdit)||t.call(r,e?w:void 0),R())}),[w,_,R,p,I]),M=vG(((e=!1)=>{var t,r;const n=_.current;if(!p||!n)return;const o=null==(t=null==n?void 0:n.getValue)?void 0:t.call(n);let a="",s=e;if(o){a=E.cellValueChecker(i,o),a&&L(a);const e=E.getFieldIsStrictValidatedValue(i)&&a;s||(s=e)}null==(r=null==n?void 0:n.onEndEdit)||r.call(n,s),g(!1)}));Object(a.useEffect)((()=>{const e=null==o?void 0:o.onScroll((e=>{null==c||c.close("tooltip"),M()}));return()=>{null==e||e.destroy()}}),[M]);const N=Object(a.useCallback)((e=>{var t;if(p)M();else if(e){if(k.getViewGroup()){const e=(null==(t=k.getViewRecordByRecordId(v||""))?void 0:t.get("group_item_key"))||(null==f?void 0:f.UNGROUP_KEY),r=null==h?void 0:h.groupFolding;e&&(null==r?void 0:r.has(e))&&(null==h||h.setGroupFolding(e,!1))}d?null==d||d.scrollToAnchorPosition(d.getSelection(),"start",(()=>{A(!0)})):requestAnimationFrame((()=>{A(!0)}))}else A(!0)}),[p,A,M]);Object(a.useEffect)((()=>{const e=()=>M();return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)}),[M]),Object(a.useEffect)((()=>{const e=setTimeout((()=>{1===(null==r?void 0:r.rangeCount)&&(g(!1),R())}),50);return()=>{clearTimeout(e)}}),[r]);const D=Object(a.useCallback)((e=>i===pE.LINK?(null==e?void 0:e.name)||"":i===pE.DATE?bf(e||"").format("YYYY-MM-DD"):""),[i]),P=Object(a.useCallback)((e=>{p||(e.persist(),null==l||l.fireEventByEditable(e,"copy"))}),[p]),j=Object(a.useCallback)((e=>{p||(e.persist(),null==l||l.fireEventByEditable(e,"paste"))}),[p]),F=Object(a.useCallback)((e=>{p||(e.persist(),null==l||l.fireEventByEditable(e,"cut"))}),[p]),V=Object(a.useCallback)((async e=>{!p||Vd(e,w)||await(null==b?void 0:b.setCell(e))}),[p,w]),L=vG((e=>{!x||null==c||c.showTooltip(e,{origin:x,placement:"top"})}));return t&&n&&i&&y&&v?s.a.createElement("div",{className:"lakex-table-cell-editor-container lakex-grid-cell-editor-keyboard-input",style:{position:"absolute",left:(null==x?void 0:x.left)||0,top:(null==x?void 0:x.top)||0},onKeyDown:async e=>{const t=e.keyCode||e.which;p?(OL(e),e.key==xN.ESC&&M(!1),83===t&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),await M(!1),m.a.success(Ph("文档已保存")))):ON(e)?A():null==l||l.fireEventByEditable(e.nativeEvent)},onMouseDown:OL,onMouseUp:OL,onMouseMove:OL,onCopy:P,onCut:F,onPaste:j},function(){if(!(t&&n&&i&&y&&v))return null;const e={onSave:V,fieldType:i,editing:p,style:O,inputObserverRef:C};switch(i){case pE.TITLE:case pE.TEXT:return s.a.createElement(Ske,{isMultiText:i===pE.TEXT,ref:_,toggleEditing:N,...e});case pE.NUMBER:case pE.PHONE:case pE.EMAIL:return s.a.createElement(Ske,{isMultiText:!1,ref:_,toggleEditing:N,...e});case pE.LINK:return s.a.createElement(Ske,{isMultiText:!1,getFormattedValue:D,ref:_,...e,onSave:async e=>{var t;const r={src:(null==(t=null==b?void 0:b.value)?void 0:t.src)||`http://${e}`,name:e};await V(r)},toggleEditing:N});case pE.SELECT:case pE.MULTI_SELECT:return s.a.createElement(xke,{ref:_,fieldId:y,recordId:v,toggleEditing:N,...e});case pE.MENTION:return s.a.createElement(Oke,{ref:_,fieldId:y,recordId:v,toggleEditing:N,cellValue:w,...e});case pE.DATE:return s.a.createElement(Ske,{isMultiText:!1,getFormattedValue:D,ref:_,...e,onSave:async e=>{const t=Sf(e||"");await V(t)},toggleEditing:N});default:return null}}()):null}))),Ake={[pE.IMAGE]:Y6,[pE.FILE]:q6},Mke=e=>{const t=e.initialState||{},{fieldType:r,recordId:n,fieldId:i}=t,o=HL(c8),l=HL(zI),{fieldUriModel:c}=HL(Ok),u=o7(n,i),d=null==u?void 0:u.value,f=Object(a.useMemo)((()=>r===pE.IMAGE?Ph("图片列表"):r===pE.FILE?Ph("附件列表"):null),[r]),h={style:{width:520},defaultValue:d,onChange:e=>{null==l||l.execCommand("setCell",{...u,value:e})},onOrderChange:({targetUid:e,sourceUid:t})=>{var o,a;const s=null==(o=c.findOne({uid:e}))?void 0:o.get("uuid"),u=null==(a=c.findOne({uid:t}))?void 0:a.get("uuid");null==l||l.execCommand("updateValueOrder",{fieldId:i,fieldType:r,recordId:n,targetValueId:s,sourceValueId:u})}};if(![pE.IMAGE,pE.FILE].includes(r))return null;const p=Ake[r];return s.a.createElement("div",{className:"lakex-table-cell-file-uploader"},s.a.createElement("div",{className:"file-uploader-header"},s.a.createElement("h4",{className:"file-uploader-header-title"},f),s.a.createElement(XU,{type:"Close",className:"file-uploader-close",onClick:e=>{null==o||o.close("fileOrImageManageModal")}})),s.a.createElement(p,{...h}))},Nke=Object(a.memo)(Object(a.forwardRef)(((e,t)=>{const r=rre(),n=o7(null==r?void 0:r.recordId,null==r?void 0:r.fieldId),i=HL(c8),o=Object(a.useRef)(null);Object(a.useImperativeHandle)(t,(()=>({onCloseByClickAwayOrScroll:()=>{var e;const t=null==(e=o.current)?void 0:e.getValues();t&&(null==n||n.setCell(t))}})));const l=()=>{null==i||i.close("cellLinkDropDownEditor")};return(null==n?void 0:n.fieldType)!==pE.LINK?null:s.a.createElement(N4,{ref:o,defaultValue:n.value,onSubmit:e=>{null==n||n.setCell(e),setTimeout((()=>{l()}),100)},onBlur:l})}))),Dke=e=>{const t=rre(),r=nre(!0),n=o7(null==t?void 0:t.recordId,null==t?void 0:t.fieldId),i=HL(c8),[o,l]=Object(a.useState)(null==t?void 0:t.value);return s.a.createElement(r6,{className:"cell-date-dropdown-editor",focus:!0,open:!0,defaultValue:o||"",onChange:async e=>{l(e),await(null==n?void 0:n.setCell(e)),null==i||i.close("cellDateDropDownEditor")},rectStyle:{width:null==r?void 0:r.width,height:null==r?void 0:r.height}})};var Pke=Object.defineProperty,jke=Object.getOwnPropertyDescriptor,Fke=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jke(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pke(t,r,o),o};let Vke=class{constructor(){this._gridCellEditorId="viewerGridCellEditor",this._toDestroyCollection=new gp}static pluginModule(){return xo().register(this)}get isGridView(){return this._readService.getActiveView().get("type")===LE.GRID}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}_hasSelection(){var e;return null==(e=this._selectionService)?void 0:e.hasSelection()}init(){var e;if(this.isReadonly)return;const t=null==(e=this._selectionService)?void 0:e.onChange((()=>{this._hasSelection()&&this.isGridView?this._modalService.isModalVisible(this._gridCellEditorId)||this._modalService.open(this._gridCellEditorId,{position:{left:0,top:0}}):this._modalService.close(this._gridCellEditorId)}));t&&this._toDestroyCollection.push(t),this._toDestroyCollection.push(this._renderService.onClickCellIcon((e=>{var t,r;if("cellLinkIcon"===e.iconName)this._handleOpenCellLinkDropdownEditor();else if("cellImageIcon"===e.iconName){const e=null==(t=this._selectionService)?void 0:t.getFieldValue();this._handleOpenCellFileEditor(pE.IMAGE,null==e?void 0:e.recordId,null==e?void 0:e.fieldId)}else if("cellFileIcon"===e.iconName){const e=null==(r=this._selectionService)?void 0:r.getFieldValue();this._handleOpenCellFileEditor(pE.FILE,null==e?void 0:e.recordId,null==e?void 0:e.fieldId)}}))),this._toDestroyCollection.push(this._renderService.onDoubleClickCell((e=>{var t;if(e.fieldType===pE.LINK)this._handleOpenCellLinkDropdownEditor();else if(e.fieldType===pE.DATE)this._handleOpenCellDateDropdownEditor();else if(e.fieldType===pE.IMAGE||e.fieldType===pE.FILE){const r=null==(t=this._selectionService)?void 0:t.getFieldValue();this._handleOpenCellFileEditor(e.fieldType,null==r?void 0:r.recordId,null==r?void 0:r.fieldId)}})))}registerModal(e){e.registerItem({id:this._gridCellEditorId,hasMask:!1,scrollStrategy:"close",zIndex:"modalRenderBase",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:Tke}),e.registerItem({id:"fileOrImageManageModal",hasMask:!0,hasAnimation:!0,scrollStrategy:"block",zIndex:"modalFromRender",position:{left:"50%",top:"50%"},RenderComponent:Mke}),e.registerItem({id:"cellLinkDropDownEditor",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",RenderComponent:Nke}),e.registerItem({id:"cellDateDropDownEditor",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",RenderComponent:Dke})}registerHotkey(e){e.registerItem({id:"enterToCellEditor",hotkey:"enter",name:"enter进入单元格编辑",enableOnInput:!1,isEnable:()=>!this.isReadonly&&this._hasSelection()&&this.isGridView,onHotKey:e=>{var t,r;e.preventDefault();const n=null==(t=this._selectionService)?void 0:t.getFieldValue(),i=(null==n?void 0:n.fieldId)||"",o=(null==n?void 0:n.recordId)||"",a=this._readService.getField(i).get("type");if(a===pE.CHECKBOX){const e=null==(r=this._readService.getCell(i,o))?void 0:r.value,t={...n,value:!e};(()=>{var e,r,n;const o=this._readService.getActiveView(),a=null==(e=this._refreshEventService)?void 0:e.getRefreshType((null==o?void 0:o.get("uuid"))||"",i);a?null==(r=this._commandService)||r.execDeferCommand("setCell",t,a):null==(n=this._commandService)||n.execCommand("setCell",t)})()}[pE.IMAGE,pE.FILE].includes(a)&&this._handleOpenCellFileEditor(a,null==n?void 0:n.recordId,null==n?void 0:n.fieldId),a===pE.LINK&&this._handleOpenCellLinkDropdownEditor()}}),e.registerItem({id:"deleteCell",hotkey:"del, backspace",name:"清空单元格",enableOnInput:!1,isEnable:()=>this._hasSelection()&&this.isGridView&&!this.isReadonly,onHotKey:e=>{var t,r;e.preventDefault();const n=((null==(t=this._selectionService)?void 0:t.getFieldValues())||[]).map((e=>({...e,value:""})));null==(r=this._commandService)||r.execCommand("removeCells",{cells:n})}}),e.registerItem({id:"openCellLinkEditor",hotkey:"⌘+K",name:"打开单元格链接编辑器",enableOnInput:!0,isEnable:()=>this._hasSelection()&&this.isGridView&&!this.isReadonly,onHotKey:async e=>{var t;e.preventDefault();const r=null==(t=this._selectionService)?void 0:t.getFieldValue(),n=(null==r?void 0:r.fieldId)||"";this._readService.getField(n).get("type")===pE.LINK&&this._handleOpenCellLinkDropdownEditor()}})}_handleOpenCellLinkDropdownEditor(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelectFocusTarget();this._modalService.open("cellLinkDropDownEditor",{position:{origin:t,placement:"bottom"}})}_handleOpenCellFileEditor(e,t,r){this._modalService.open("fileOrImageManageModal",{initialState:{fieldType:e,recordId:t,fieldId:r}})}_handleOpenCellDateDropdownEditor(){var e;const t=null==(e=this._selectionService)?void 0:e.getSelectAnchorTarget();this._modalService.open("cellDateDropDownEditor",{position:{origin:t,placement:"cover"}})}destroy(){this._toDestroyCollection.destroy()}};Vke.pluginName="workbench-viewer-grid-cell-editor",Fke([ao(qte),cN()],Vke.prototype,"_selectionService",2),Fke([ao(KO)],Vke.prototype,"_readService",2),Fke([ao(bR)],Vke.prototype,"_abilityService",2),Fke([ao(c8)],Vke.prototype,"_modalService",2),Fke([ao(Qz)],Vke.prototype,"_renderService",2),Fke([ao(zI)],Vke.prototype,"_commandService",2),Fke([ao(ZO)],Vke.prototype,"_refreshEventService",2),Vke=Fke([io({contrib:[jL,u8,Vte]})],Vke);const Lke=({className:e,defaultValue:t="",onFieldSelect:r=(()=>{})})=>{const{groupFields:n,groupMap:i}=(e=>{const t=HL(KO),r=null==t?void 0:t.getActiveView(),n=Vp(null==t?void 0:t.getViewFields(null==r?void 0:r.get("uuid"),!1),(t=>{var r,n;return!(!e.defaultValue||(null==(r=t.get("field"))?void 0:r.get("uuid"))!==e.defaultValue)||zE.isGroup(null==(n=t.get("field"))?void 0:n.get("type"))})),i=null==t?void 0:t.getViewFieldGroups(null==r?void 0:r.get("uuid"));return{groupFields:n,groupMap:Object(a.useMemo)((()=>{const e={};return null==i||i.forEach((t=>{e[t.get("uuid")]=t})),e}),[i])}})({defaultValue:t}),o=HL(nH);return s.a.createElement(S.a,{className:`lakex-table-group-field-select ${e}`,defaultValue:t,dropdownClassName:"lakex-table-group-field-select-dropdown",suffixIcon:s.a.createElement(XU,{type:"ArrowDown",size:14}),onChange:e=>{var t;const i=Fp(n,(t=>{var r;return(null==(r=t.get("field"))?void 0:r.get("uuid"))===e}));r(null==(t=null==i?void 0:i.get("field"))?void 0:t.toJSON())},bordered:!1},Bp(n,(e=>{var t,r,n,a,l;const c=null==o?void 0:o.getFieldIcon(null==(t=e.get("field"))?void 0:t.get("type"));return s.a.createElement(S.a.Option,{value:null==(r=e.get("field"))?void 0:r.get("uuid"),key:null==(n=e.get("field"))?void 0:n.get("uuid")},c&&s.a.createElement(c,null),s.a.createElement("div",{className:"lakex-table-group-field-select-name"},e.get("group_uuid")?`${i[e.get("group_uuid")].get("name")}-${null==(a=e.get("field"))?void 0:a.get("name")}`:null==(l=e.get("field"))?void 0:l.get("name")))})))},$ke="lakex-table-group-modal-empty",Bke=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:$ke},s.a.createElement("div",{className:`${$ke}-empty-desc`},Ph("还未设置任何分组")),s.a.createElement(Lke,{defaultValue:Ph("选择一列进行分组"),onFieldSelect:e})),Uke=e=>{switch(e){case"select":case"multiSelect":return{asc:Ph("选项顺序"),desc:Ph("选项倒序")};case"number":case"phone":return{asc:Ph("从小到大"),desc:Ph("从大到小")};default:return{asc:Ph("升序"),desc:Ph("降序"),style:{padding:"0 16px"}}}},zke=({group:e,field:t,onUpdateType:r=(()=>{})})=>{if(!t)return null;if(zE.isCheckbox(t.type))return s.a.createElement(g.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(g.a.Button,{value:"asc"},s.a.createElement("span",{className:"lakex-table-group-field-order-radio"},s.a.createElement(h.a,{checked:!1},s.a.createElement(XU,{type:"RightArrow"})),s.a.createElement(h.a,{checked:!0}))),s.a.createElement(g.a.Button,{value:"desc"},s.a.createElement("span",{className:"lakex-table-group-field-order-radio"},s.a.createElement(h.a,{checked:!0},s.a.createElement(XU,{type:"RightArrow"})),s.a.createElement(h.a,{checked:!1}))));const n=Uke(t.type);return s.a.createElement(g.a.Group,{defaultValue:e.type,onChange:e=>{r(e.target.value)}},s.a.createElement(g.a.Button,{value:"asc"},s.a.createElement("span",{style:n.style},n.asc)),s.a.createElement(g.a.Button,{value:"desc"},s.a.createElement("span",{style:n.style},n.desc)))},Hke=({group:e,field:t,onRemove:r=(()=>{}),onChange:n=(()=>{}),onUpdateType:i=(()=>{})})=>{const{state:o,onFieldSelect:l}=(({field:e,onChange:t})=>{const[r,n]=Object(a.useState)(e);return{state:{activeField:r},onFieldSelect(e){t(e),n(e)}}})({field:t,onChange:n});return s.a.createElement("div",{className:"lakex-table-group-item"},s.a.createElement(XU,{type:"Close",onClick:()=>{r(e)}}),s.a.createElement(Lke,{defaultValue:null==t?void 0:t.get("uuid"),onFieldSelect:l,className:"lakex-table-group-item-select"}),s.a.createElement(zke,{group:e,field:o.activeField,onUpdateType:i}))},Wke=()=>{const e=HL(c8),t=HL(zI),r=HL(KO),n=r.getViewGroup(),i=r.getViewConfig(),o=r.getAllFields(),[s,l]=Object(a.useState)(null==n?void 0:n.group.toJSON()),c=e=>e?n?null==t?void 0:t.execCommand("updateGridGroup",{viewId:null==i?void 0:i.get("view_uuid"),group:e}):null==t?void 0:t.execCommand("createGridGroup",{viewId:null==i?void 0:i.get("view_uuid"),group:e}):null==t?void 0:t.execCommand("removeGridGroup",{viewId:null==i?void 0:i.get("view_uuid")});return{state:{group:s},fields:o,onAddOption(e){var t,n;e||(e=null==(n=null==(t=null==r?void 0:r.getViewFields())?void 0:t.get(0).get("field"))?void 0:n.toJSON());const i={field_uuid:null==e?void 0:e.uuid,type:NE.ASC};c(i),l(i)},onRemoveOption(){c(null),l(null)},onUpdateOption(e){const t={field_uuid:null==e?void 0:e.uuid,type:(null==s?void 0:s.type)||NE.ASC};c(t),l(t)},onUpdateType(e){s&&(s.type=e),c(s),l(s)},onClose(){e.close("grid-group")}}},Gke=()=>{const{state:e,fields:t,onAddOption:r,onUpdateOption:n,onRemoveOption:i,onUpdateType:o}=Wke();let a;if(e.group){const r=Fp(t,(t=>{var r;return t.get("uuid")===(null==(r=e.group)?void 0:r.field_uuid)}));a=s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"lakex-table-group-setting"},s.a.createElement("h2",{className:"lakex-table-group-setting-title"},Ph("分组设置"))),s.a.createElement(Hke,{field:r,group:e.group,onRemove:i,onChange:n,onUpdateType:o}))}else a=s.a.createElement(Bke,{onAddOption:r});return s.a.createElement("div",{className:"lakex-table-group-modal"},a)},Kke=({onAddOption:e=(()=>{})})=>s.a.createElement("div",{className:"lakex-table-h5-empty"},s.a.createElement(ube,{desc:Ph("你还未进行任何分组"),className:"no-data"}),s.a.createElement(b.a,{type:"primary",onClick:()=>e(),className:"no-data-btn"},s.a.createElement(XU,{type:"Add"}),Ph("添加分组条件"))),qke=e=>{const{state:t,fields:r,onClose:n,onAddOption:i,onUpdateOption:o,onRemoveOption:l,onUpdateType:c}=Wke(),u=HL(lp),d=HL(c8),f=u.getValue("modal.mode"),h=HL(KO),p=HL(nH),g=Object(a.useMemo)((()=>null==h?void 0:h.getViewFields()),[]);return s.a.createElement(rbe,{title:Ph("分组"),onClose:n,showCloseIcon:!0},(()=>{if(!t.group)return s.a.createElement(Kke,{onAddOption:i});const e=Fp(r,(e=>{var r;return e.get("uuid")===(null==(r=t.group)?void 0:r.field_uuid)})),n=Uke(null==e?void 0:e.get("type")),a=null==p?void 0:p.getFieldIcon(null==e?void 0:e.get("type"));return s.a.createElement("div",{className:"lakex-table-h5-group"},s.a.createElement("div",{className:"lakex-table-h5-group-tip"},Ph("按以下选项进行分组")),s.a.createElement(dbe,{prefixIcon:a,className:"lakex-table-h5-filter-col",text:null==e?void 0:e.get("name"),onClick:()=>{null==d||d.open("group-select",{initialState:{group:t.group}})}}),s.a.createElement(U8,{id:"group-select",mode:f,hasMask:f===l8.DRAWER,hasAnimation:f===l8.DRAWER,position:f===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:({initialState:e})=>{var t;return s.a.createElement(rbe,{title:Ph("请选择"),onClose:()=>{null==d||d.close("group-select")},showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:null==(t=e.group)?void 0:t.field_uuid,list:Bp(g,(e=>{var t;const r=null==p?void 0:p.getFieldIcon(null==(t=e.get("field"))?void 0:t.get("type"));return{key:e.get("field").get("uuid"),title:e.get("field").get("name"),icon:r&&s.a.createElement(r,null)}})),onCheck:e=>{null==d||d.close("group-select"),o({uuid:e.key})}}))}}),s.a.createElement(obe,{className:"lakex-table-h5-group-display-radio",options:[{label:n.asc,value:"asc"},{label:n.desc,value:"desc"}],onChange:e=>c(e.value),defaultValue:t.group.type}),s.a.createElement(b.a,{className:"lakex-table-h5-group-del",onClick:()=>l()},s.a.createElement(XU,{type:"Delete",className:"del-icon"}),Ph("删除该条件")))})())};var Yke=Object.defineProperty,Jke=Object.getOwnPropertyDescriptor,Xke=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Jke(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Yke(t,r,o),o};let Zke=class{constructor(){this._getActive=()=>{const e=this._readService.getActiveView();return!!e&&!!this._readService.getViewGroup(e.get("uuid"))}}static pluginModule(){return xo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"grid-group",icon:"ViewerGroup",tooltip:Ph("分组"),visible:()=>{var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))===LE.GRID},active:this._getActive,onClick:e=>{const t=e.target;this._modalService.open("grid-group",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"grid-group",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?qke:Gke})}};Zke.pluginName="workbench-viewer-grid-group",Xke([ao(c8)],Zke.prototype,"_modalService",2),Xke([ao(KO)],Zke.prototype,"_readService",2),Xke([ao(lp)],Zke.prototype,"_configuration",2),Zke=Xke([io({contrib:[jL,j4,u8]})],Zke);const Qke=()=>{const e=HL(zI),t=HL(c8),r=HL(KO),n=r.getView();return{viewConfig:r.getViewConfig(),onConfirm(r){null==e||e.execCommand("updateGridRecordHeight",{viewId:n.get("uuid"),recordHeight:r.key}),t.close("grid-record-height")},onModalClose(){t.close("grid-record-height")}}},exe=[{type:"low",name:Ph("低")},{type:"middle",name:Ph("中")},{type:"high",name:Ph("高")}],txe="lakex-table-row-height",rxe=()=>{const{viewConfig:e,onConfirm:t}=Qke();return e?s.a.createElement("div",{className:txe},s.a.createElement(d.a,{defaultSelectedKeys:[e.get("record_height")],mode:"vertical",onClick:t},exe.map((t=>s.a.createElement(d.a.Item,{key:t.type,icon:s.a.createElement("span",null,t.type===e.get("record_height")&&s.a.createElement("span",{className:`${txe}-checked`},s.a.createElement(XU,{type:"Check"})),s.a.createElement(XU,{type:`RowHeight${fN(t.type)}`}))},Ph(t.name)))))):null},nxe=e=>{const{viewConfig:t,onConfirm:r,onModalClose:n}=Qke();return t?s.a.createElement(rbe,{title:Ph("行高"),onClose:n,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:t.get("record_height"),list:exe.map((e=>({key:e.type,title:e.name}))),onCheck:e=>r(e)})):null};var ixe=Object.defineProperty,oxe=Object.getOwnPropertyDescriptor,axe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?oxe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ixe(t,r,o),o};let sxe=class{static pluginModule(){return xo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"grid-record-height",icon:"RowHeightLow",tooltip:Ph("行高"),visible:()=>{const e=this._readService.getActiveView();return(null==e?void 0:e.get("type"))===LE.GRID},onClick:e=>{const t=e.target;this._modalService.open("grid-record-height",{position:{origin:t,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"grid-record-height",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER?{placement:"bottom"}:null,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?nxe:rxe})}};sxe.pluginName="workbench-viewer-grid-record-height",axe([ao(c8)],sxe.prototype,"_modalService",2),axe([ao(KO)],sxe.prototype,"_readService",2),axe([ao(lp)],sxe.prototype,"_configuration",2),sxe=axe([io({contrib:[jL,j4,u8]})],sxe);const lxe=({initialState:e})=>{const{groupField:t,groupOption:r}=e,{settings:n}=(({groupField:e,groupOption:t,$title:r})=>{const n=HL(zI),i=HL(c8),o=HL(xte),l=HL(eye);return{settings:Object(a.useMemo)((()=>[{key:"edit",name:zE.isMention(null==e?void 0:e.type)?Ph("修改分组人员"):Ph("修改分组"),icon:s.a.createElement(XU,{type:"Edit"}),onClick:()=>{null==i||i.close("viewKanbanGroupSetting"),null==o||o.showEditGroup(r,e,t)}},{key:"remove",name:Ph("删除分组"),icon:s.a.createElement(XU,{type:"Delete"}),onClick:()=>{null==i||i.close("viewKanbanGroupSetting");const r=null==l?void 0:l.getGroupFieldOption(e,t);!r||(null==i||i.close("viewKanbanGroupSetting"),null==n||n.execCommand("removeFieldOption",{optionId:r.get("uuid")}))}}]),[null==e?void 0:e.type])}})(e);return t&&r?s.a.createElement("div",{className:"lakex-table-kanban-group-setting"},s.a.createElement(d.a,null,n.map((e=>s.a.createElement(d.a.Item,{key:e.key,icon:e.icon,onClick:()=>e.onClick()},e.name))))):null};var cxe=Object.defineProperty,uxe=Object.getOwnPropertyDescriptor,dxe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uxe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cxe(t,r,o),o};let fxe=class{static pluginModule(){return xo().register(this)}init(){this._kanbanGroupActionService.onGroupSettingClick((({target:e,groupField:t,groupOption:r,$title:n})=>{var i;null==(i=this._modalService)||i.open("viewKanbanGroupSetting",{position:{origin:e,placement:"bottom"},initialState:{groupField:t,groupOption:r,$title:n}})}))}registerModal(e){e.registerItem({id:"viewKanbanGroupSetting",hasMask:!1,scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:lxe})}};fxe.pluginName="workbench-viewer-kanban-group",dxe([ao(Iye)],fxe.prototype,"_kanbanGroupActionService",2),dxe([ao(c8)],fxe.prototype,"_modalService",2),fxe=dxe([io({contrib:[jL,u8]})],fxe);const hxe=()=>{const e=HL(nH),t=HL(zI),r=HL(c8),n=HL(KO),i=HL(eye),o=null==n?void 0:n.getActiveView(),[s,l]=Object(a.useState)(null==i?void 0:i.getGroup());return{state:{group:s},fields:null==i?void 0:i.getSupportGroupFields(),onChange(e){l(e);const n={field_uuid:e.uuid};null==t||t.execCommand("updateKanbanGroup",{viewId:null==o?void 0:o.get("uuid"),group:n}),r.close("kanban-group-setting")},onModalClose(){r.close("kanban-group-setting")},fieldService:e}},pxe=()=>{const{state:e,fields:t,onChange:r,fieldService:n}=hxe();return e.group?s.a.createElement("div",{className:"lakex-table-menu-container lakex-table-menu-kanban-group lakex-table-menu-kanban-group-modal"},s.a.createElement("div",{className:"lakex-table-menu-kanban-group-options"},Bp(t,(t=>{var i;const o=null==n?void 0:n.getFieldIcon(t.get("type"));return s.a.createElement("div",{key:t.get("uuid"),className:"lakex-table-menu-kanban-group-option",onClick:()=>{r(t)}},s.a.createElement("span",{className:"lakex-table-menu-kanban-group-option-title"},o?s.a.createElement(o,{className:"lakex-table-icon-col-type"}):null,t.get("name")),t.get("uuid")===(null==(i=e.group)?void 0:i.field.get("uuid"))?s.a.createElement(XU,{type:"Check"}):s.a.createElement("span",{className:"lakex-table-menu-kanban-group-empty"}))})))):null},gxe=({field:e})=>{const t=HL(nH),r=null==t?void 0:t.getFieldIcon(e.get("type"));return s.a.createElement("span",{className:"lakex-table-kanban-group-setting-title"},Ph("按"),r?s.a.createElement(r,{className:"lakex-table-icon-col-type",size:14}):null,e.get("name"),Ph("分组"))},mxe=()=>{var e;const{state:t,fields:r,onChange:n,onModalClose:i,fieldService:o}=hxe();if(!t.group)return null;const a=Bp(r,(e=>{const t=null==o?void 0:o.getFieldIcon(e.get("type"));return{key:e.get("uuid"),icon:t?s.a.createElement(t,{className:"lakex-table-icon-col-type"}):null,title:e.get("name")}}));return s.a.createElement(rbe,{title:Ph("选择分组字段"),onClose:i,showCloseIcon:!0},s.a.createElement(sbe,{defaultValue:null==(e=t.group)?void 0:e.field.get("uuid"),list:a,onCheck:e=>n(Fp(r,(t=>t.get("uuid")===e.key)))}))};var vxe=Object.defineProperty,yxe=Object.getOwnPropertyDescriptor,bxe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yxe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vxe(t,r,o),o};let _xe=class{static pluginModule(){return xo().register(this)}init(){}registerToolbar(e){e.registerItem({id:"kanban-group-setting",tooltip:()=>{const e=this._readService.getActiveView();if(!e)return null;const t=this._readService.getViewGroup(null==e?void 0:e.get("uuid"));return null!=t&&t.field?s.a.createElement(gxe,{field:null==t?void 0:t.field}):null},visible:()=>{const e=this._readService.getActiveView();if(!e||e.get("type")!==LE.KANBAN)return!1;const t=this._readService.getViewGroup(e.get("uuid"));return!(null==t||!t.field)},showTitle:!0,showTooltip:!1,onClick:e=>{this._modalService.open("kanban-group-setting",{position:{origin:e.target,placement:"bottom"}})}})}registerModal(e){const t=this._configuration.getValue("modal.mode"),r=this._configuration.getValue("render.mode");e.registerItem({id:"kanban-group-setting",mode:t,hasMask:t===l8.DRAWER,hasAnimation:t===l8.DRAWER,position:t===l8.DRAWER&&{placement:"bottom"},scrollStrategy:"close",zIndex:"modalFromToolbar",RenderComponent:r===jz.MOBILE?mxe:pxe})}};_xe.pluginName="workbench-viewer-kanban-group-setting",bxe([ao(c8)],_xe.prototype,"_modalService",2),bxe([ao(KO)],_xe.prototype,"_readService",2),bxe([ao(lp)],_xe.prototype,"_configuration",2),_xe=bxe([io({contrib:[jL,j4,u8]})],_xe);const wxe=[Fye,Sbe,Mbe,qbe,Qbe,k_e,R_e,P_e,L_e,ewe,iwe,MSe,HSe,hke,vke,Cke,Vke,Zke,sxe,fxe,_xe],Cxe=({webSdk:e,settings:t})=>({settings:Object.assign({},{"model.frozenTable":["ability","user"],"toolbar.topLeft":["view-manage"],"toolbar.left":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search","|","add-record"],contextMenu:["updateField","|","insertFieldLeft","insertFieldRight","|","groupByField","filterByField","sortByAsc","sortByDesc","|","addFieldGroup","editFieldGroup","removeFieldGroup","|","copy","paste","|","insertRecordUp","insertRecordDown","insertRecordLeft","insertRecordRight","|","copyRecord","expandRecord","removeRecord","removeField"]},t),webSdk:e}),Exe=[],Sxe=J9.filter((e=>!Exe.includes(e.pluginName))),kxe=[],xxe=Nye.filter((e=>!kxe.includes(e.pluginName))),Oxe=["workbench-full-width","workbench-full-screen"],Ixe=wxe.filter((e=>!Oxe.includes(e.pluginName))),Rxe=[],Txe=[],Axe=[],Mxe=e=>{var t;const r=Cxe({webSdk:e.webSdk,settings:e.settings||{}});let n;try{n=new Q8({...e,...r,workbenchPlugins:[...Ixe,...e.workbenchPlugins||[]],renderPlugins:[...xxe,...e.renderPlugins||[]],kernelPlugins:[...Sxe,...e.kernelPlugins||[]],workbenchContribs:[...Rxe,...e.workbenchContribs||[]],renderContribs:[...Txe,...e.renderContribs||[]],kernelContribs:[...Axe,...e.kernelContribs||[]],onDataLoaded(t){var r;null==(r=e.onDataLoaded)||r.call(e,t)}}),e.onCellChange&&n.getService(Bk).onCellChange((t=>{var r;return null==(r=e.onCellChange)?void 0:r.call(e,t.cellValue)}))}catch(r){console.error(r),null==(t=e.onError)||t.call(e,r)}return n},Nxe=["kernel-history","kernel-add-record"],Dxe=J9.filter((e=>!Nxe.includes(e.pluginName))),Pxe=["render-history"],jxe=Nye.filter((e=>!Pxe.includes(e.pluginName))),Fxe=["workbench-add-record","workbench-grid-cell-editor"],Vxe=wxe.filter((e=>!Fxe.includes(e.pluginName))),Lxe=null;function $xe(){return function(e,t,r){yi(e,t,r,new nn(mr,!0))}}const Bxe=e=>new Promise((t=>{setTimeout(t,e)}));var Uxe=NaN;function zxe(e){return"number"==typeof e?e:Pa(e)?Uxe:+e}function Hxe(e,t){return function(r,n){var i;if(void 0===r&&void 0===n)return t;if(void 0!==r&&(i=r),void 0!==n){if(void 0===i)return n;"string"==typeof r||"string"==typeof n?(r=Ba(r),n=Ba(n)):(r=zxe(r),n=zxe(n)),i=e(r,n)}return i}}var Wxe=Hxe((function(e,t){return e+t}),0);const Gxe=Wxe;const Kxe=ws&&new ws;var qxe=Kxe?function(e,t){return Kxe.set(e,t),e}:ns;const Yxe=qxe;function Jxe(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Ss(e.prototype),n=e.apply(r,t);return Ga(n)?n:r}}var Xxe=1;var Zxe=Math.max;function Qxe(e,t,r,n){for(var i=-1,o=e.length,a=r.length,s=-1,l=t.length,c=Zxe(o-a,0),u=Array(l+c),d=!n;++s<l;)u[s]=t[s];for(;++i<a;)(d||i<o)&&(u[r[i]]=e[i]);for(;c--;)u[s++]=e[i++];return u}var eOe=Math.max;function tOe(e,t,r,n){for(var i=-1,o=e.length,a=-1,s=r.length,l=-1,c=t.length,u=eOe(o-s,0),d=Array(u+c),f=!n;++i<u;)d[i]=e[i];for(var h=i;++l<c;)d[h+l]=t[l];for(;++a<s;)(f||i<o)&&(d[h+r[a]]=e[i++]);return d}function rOe(){}var nOe=4294967295;function iOe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=nOe,this.__views__=[]}iOe.prototype=Ss(rOe.prototype),iOe.prototype.constructor=iOe;var oOe=Kxe?function(e){return Kxe.get(e)}:xs;const aOe=oOe;const sOe={};var lOe=Object.prototype.hasOwnProperty;function cOe(e){for(var t=e.name+"",r=sOe[t],n=lOe.call(sOe,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t}function uOe(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function dOe(e){if(e instanceof iOe)return e.clone();var t=new uOe(e.__wrapped__,e.__chain__);return t.__actions__=Os(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}uOe.prototype=Ss(rOe.prototype),uOe.prototype.constructor=uOe;var fOe=Object.prototype.hasOwnProperty;function hOe(e){if(Na(e)&&!Fa(e)&&!(e instanceof iOe)){if(e instanceof uOe)return e;if(fOe.call(e,"__wrapped__"))return dOe(e)}return new uOe(e)}function pOe(e){var t=cOe(e),r=hOe[t];if("function"!=typeof r||!(t in iOe.prototype))return!1;if(e===r)return!0;var n=aOe(r);return!!n&&e===n[0]}hOe.prototype=rOe.prototype,hOe.prototype.constructor=hOe;const gOe=Rs(Yxe);var mOe=/\{\n\/\* \[wrapped with (.+)\] \*/,vOe=/,? & /;var yOe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function bOe(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var _Oe=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function wOe(e,t,r){var n=t+"";return Ds(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(yOe,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return bOe(_Oe,(function(r){var n="_."+r[0];t&r[1]&&!Vs(e,n)&&e.push(n)})),e.sort()}(function(e){var t=e.match(mOe);return t?t[1].split(vOe):[]}(n),r)))}var COe=1,EOe=2,SOe=4,kOe=8,xOe=32,OOe=64;function IOe(e,t,r,n,i,o,a,s,l,c){var u=t&kOe;t|=u?xOe:OOe,(t&=~(u?OOe:xOe))&SOe||(t&=~(COe|EOe));var d=[e,t,i,u?o:void 0,u?a:void 0,u?void 0:o,u?void 0:a,s,l,c],f=r.apply(void 0,d);return pOe(e)&&gOe(f,d),f.placeholder=n,wOe(f,e,t)}function ROe(e){return e.placeholder}var TOe=Math.min;var AOe="__lodash_placeholder__";function MOe(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r];(a===t||a===AOe)&&(e[r]=AOe,o[i++]=r)}return o}var NOe=1,DOe=2,POe=8,jOe=16,FOe=128,VOe=512;function LOe(e,t,r,n,i,o,a,s,l,c){var u=t&FOe,d=t&NOe,f=t&DOe,h=t&(POe|jOe),p=t&VOe,g=f?void 0:Jxe(e);return function m(){for(var v=arguments.length,y=Array(v),b=v;b--;)y[b]=arguments[b];if(h)var _=ROe(m),w=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}(y,_);if(n&&(y=Qxe(y,n,i,h)),o&&(y=tOe(y,o,a,h)),v-=w,h&&v<c){var C=MOe(y,_);return IOe(e,t,LOe,m.placeholder,r,y,C,s,l,c-v)}var E=d?r:this,S=f?E[e]:e;return v=y.length,s?y=function(e,t){for(var r=e.length,n=TOe(t.length,r),i=Os(e);n--;){var o=t[n];e[n]=Bs(o,r)?i[o]:void 0}return e}(y,s):p&&v>1&&y.reverse(),u&&l<v&&(y.length=l),this&&this!==Ca&&this instanceof m&&(S=g||Jxe(S)),S.apply(E,y)}}var $Oe=1;var BOe="__lodash_placeholder__",UOe=1,zOe=2,HOe=4,WOe=8,GOe=128,KOe=256,qOe=Math.min;var YOe="Expected a function",JOe=1,XOe=2,ZOe=8,QOe=16,eIe=32,tIe=64,rIe=Math.max;function nIe(e,t,r,n,i,o,a,s){var l=t&XOe;if(!l&&"function"!=typeof e)throw new TypeError(YOe);var c=n?n.length:0;if(c||(t&=~(eIe|tIe),n=i=void 0),a=void 0===a?a:rIe(rs(a),0),s=void 0===s?s:rs(s),c-=i?i.length:0,t&tIe){var u=n,d=i;n=i=void 0}var f=l?void 0:aOe(e),h=[e,t,r,n,i,u,d,o,a,s];if(f&&function(e,t){var r=e[1],n=t[1],i=r|n,o=i<(UOe|zOe|GOe),a=n==GOe&&r==WOe||n==GOe&&r==KOe&&e[7].length<=t[8]||n==(GOe|KOe)&&t[7].length<=t[8]&&r==WOe;if(!o&&!a)return e;n&UOe&&(e[2]=t[2],i|=r&UOe?0:HOe);var s=t[3];if(s){var l=e[3];e[3]=l?Qxe(l,s,t[4]):s,e[4]=l?MOe(e[3],BOe):t[4]}(s=t[5])&&(l=e[5],e[5]=l?tOe(l,s,t[6]):s,e[6]=l?MOe(e[5],BOe):t[6]),(s=t[7])&&(e[7]=s),n&GOe&&(e[8]=null==e[8]?t[8]:qOe(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(h,f),e=h[0],t=h[1],r=h[2],n=h[3],i=h[4],!(s=h[9]=void 0===h[9]?l?0:e.length:rIe(h[9]-c,0))&&t&(ZOe|QOe)&&(t&=~(ZOe|QOe)),t&&t!=JOe)p=t==ZOe||t==QOe?function(e,t,r){var n=Jxe(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,l=ROe(i);s--;)a[s]=arguments[s];var c=o<3&&a[0]!==l&&a[o-1]!==l?[]:MOe(a,l);return(o-=c.length)<r?IOe(e,t,LOe,i.placeholder,void 0,a,c,void 0,void 0,r-o):ks(this&&this!==Ca&&this instanceof i?n:e,this,a)}}(e,t,s):t!=eIe&&t!=(JOe|eIe)||i.length?LOe.apply(void 0,h):function(e,t,r,n){var i=t&$Oe,o=Jxe(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=n.length,u=Array(c+s),d=this&&this!==Ca&&this instanceof t?o:e;++l<c;)u[l]=n[l];for(;s--;)u[l++]=arguments[++a];return ks(d,i?r:this,u)}}(e,t,r,n);else var p=function(e,t,r){var n=t&Xxe,i=Jxe(e);return function t(){return(this&&this!==Ca&&this instanceof t?i:e).apply(n?r:this,arguments)}}(e,t,r);return wOe((f?Yxe:gOe)(p,h),e,t)}var iIe=128;function oIe(e,t,r){return t=r?void 0:t,t=e&&null==t?e.length:t,nIe(e,iIe,void 0,void 0,void 0,void 0,t)}var aIe=Object.prototype.hasOwnProperty,sIe=el((function(e,t){if(rl(t)||Zs(t))Gs(t,Tl(t),e);else for(var r in t)aIe.call(t,r)&&Ws(e,r,t[r])}));const lIe=sIe;var cIe=el((function(e,t){Gs(t,Nl(t),e)}));const uIe=cIe;var dIe=el((function(e,t,r,n){Gs(t,Nl(t),e,n)}));const fIe=dIe;var hIe=el((function(e,t,r,n){Gs(t,Tl(t),e,n)}));const pIe=hIe;function gIe(e,t){for(var r=-1,n=t.length,i=Array(n),o=null==e;++r<n;)i[r]=o?void 0:ic(e,t[r]);return i}function mIe(e){return Ds(qs(e,void 0,cc),e+"")}const vIe=mIe(gIe);var yIe="[object DOMException]",bIe="[object Error]";function _Ie(e){if(!Na(e))return!1;var t=Ma(e);return t==bIe||t==yIe||"string"==typeof e.message&&"string"==typeof e.name&&!vc(e)}var wIe=Ys((function(e,t){try{return ks(e,void 0,t)}catch(e){return _Ie(e)?e:new Error(e)}}));const CIe=wIe;var EIe="Expected a function";function SIe(e,t){var r;if("function"!=typeof t)throw new TypeError(EIe);return e=rs(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var kIe=Ys((function(e,t,r){var n=1;if(r.length){var i=MOe(r,ROe(kIe));n|=32}return nIe(e,n,t,r,i)}));kIe.placeholder={};const xIe=kIe;var OIe=mIe((function(e,t){return bOe(t,(function(t){t=rc(t),Us(e,t,xIe(e[t],e))})),e}));const IIe=OIe;var RIe=Ys((function(e,t,r){var n=3;if(r.length){var i=MOe(r,ROe(RIe));n|=32}return nIe(t,n,e,r,i)}));RIe.placeholder={};const TIe=RIe;function AIe(e){return fN(Ql(e).toLowerCase())}function MIe(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function NIe(e){return function(t){return null==e?void 0:e[t]}}const DIe=NIe({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"});var PIe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jIe=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function FIe(e){return(e=Ql(e))&&e.replace(PIe,DIe).replace(jIe,"")}var VIe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var LIe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var $Ie="\\ud800-\\udfff",BIe="\\u2700-\\u27bf",UIe="a-z\\xdf-\\xf6\\xf8-\\xff",zIe="A-Z\\xc0-\\xd6\\xd8-\\xde",HIe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",WIe="["+HIe+"]",GIe="\\d+",KIe="["+BIe+"]",qIe="["+UIe+"]",YIe="[^"+$Ie+HIe+GIe+BIe+UIe+zIe+"]",JIe="(?:\\ud83c[\\udde6-\\uddff]){2}",XIe="[\\ud800-\\udbff][\\udc00-\\udfff]",ZIe="["+zIe+"]",QIe="(?:"+qIe+"|"+YIe+")",eRe="(?:"+ZIe+"|"+YIe+")",tRe="(?:['’](?:d|ll|m|re|s|t|ve))?",rRe="(?:['’](?:D|LL|M|RE|S|T|VE))?",nRe="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",iRe="[\\ufe0e\\ufe0f]?",oRe=iRe+nRe+("(?:\\u200d(?:"+["[^"+$Ie+"]",JIe,XIe].join("|")+")"+iRe+nRe+")*"),aRe="(?:"+[KIe,JIe,XIe].join("|")+")"+oRe,sRe=RegExp([ZIe+"?"+qIe+"+"+tRe+"(?="+[WIe,ZIe,"$"].join("|")+")",eRe+"+"+rRe+"(?="+[WIe,ZIe+QIe,"$"].join("|")+")",ZIe+"?"+QIe+"+"+tRe,ZIe+"+"+rRe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",GIe,aRe].join("|"),"g");function lRe(e,t,r){return e=Ql(e),void 0===(t=r?void 0:t)?function(e){return LIe.test(e)}(e)?function(e){return e.match(sRe)||[]}(e):function(e){return e.match(VIe)||[]}(e):e.match(t)||[]}var cRe=RegExp("['’]","g");function uRe(e){return function(t){return MIe(lRe(FIe(t).replace(cRe,"")),e,"")}}var dRe=uRe((function(e,t,r){return t=t.toLowerCase(),e+(r?AIe(t):t)}));const fRe=dRe;var hRe=Ca.isFinite,pRe=Math.min;function gRe(e){var t=Math[e];return function(e,r){if(e=Za(e),(r=null==r?0:pRe(rs(r),292))&&hRe(e)){var n=(Ql(e)+"e").split("e");return+((n=(Ql(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}const mRe=gRe("ceil");function vRe(e){var t=hOe(e);return t.__chain__=!0,t}var yRe=Math.ceil,bRe=Math.max;function _Re(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}function wRe(e,t){return e&&Gs(t,Tl(t),e)}var CRe=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)oc(t,Wc(e)),e=uc(e);return t}:Bc;const ERe=CRe;function SRe(e){return Gc(e,Nl,ERe)}var kRe=Object.prototype.hasOwnProperty;var xRe=/\w*$/;var ORe=Ea?Ea.prototype:void 0,IRe=ORe?ORe.valueOf:void 0;var RRe="[object Boolean]",TRe="[object Date]",ARe="[object Map]",MRe="[object Number]",NRe="[object RegExp]",DRe="[object Set]",PRe="[object String]",jRe="[object Symbol]",FRe="[object ArrayBuffer]",VRe="[object DataView]",LRe="[object Float32Array]",$Re="[object Float64Array]",BRe="[object Int8Array]",URe="[object Int16Array]",zRe="[object Int32Array]",HRe="[object Uint8Array]",WRe="[object Uint8ClampedArray]",GRe="[object Uint16Array]",KRe="[object Uint32Array]";function qRe(e,t,r){var n=e.constructor;switch(t){case FRe:return uu(e);case RRe:case TRe:return new n(+e);case VRe:return function(e,t){var r=t?uu(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case LRe:case $Re:case BRe:case URe:case zRe:case HRe:case WRe:case GRe:case KRe:return du(e,r);case ARe:return new n;case MRe:case PRe:return new n(e);case NRe:return function(e){var t=new e.constructor(e.source,xRe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case DRe:return new n;case jRe:return function(e){return IRe?Object(IRe.call(e)):{}}(e)}}var YRe=_l&&_l.isMap,JRe=YRe?ml(YRe):function(e){return Na(e)&&"[object Map]"==lu(e)};const XRe=JRe;var ZRe=_l&&_l.isSet,QRe=ZRe?ml(ZRe):function(e){return Na(e)&&"[object Set]"==lu(e)};const eTe=QRe;var tTe=1,rTe=2,nTe=4,iTe="[object Arguments]",oTe="[object Function]",aTe="[object GeneratorFunction]",sTe="[object Object]",lTe={};function cTe(e,t,r,n,i,o){var a,s=t&tTe,l=t&rTe,c=t&nTe;if(r&&(a=i?r(e,n,i,o):r(e)),void 0!==a)return a;if(!Ga(e))return e;var u=Fa(e);if(u){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&kRe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!s)return Os(e,a)}else{var d=lu(e),f=d==oTe||d==aTe;if(pl(e))return Lc(e,s);if(d==sTe||d==iTe||f&&!i){if(a=l||f?{}:fu(e),!s)return l?function(e,t){return Gs(e,ERe(e),t)}(e,function(e,t){return e&&Gs(t,Nl(t),e)}(a,e)):function(e,t){return Gs(e,Wc(e),t)}(e,wRe(a,e))}else{if(!lTe[d])return i?e:{};a=qRe(e,d,s)}}o||(o=new Dc);var h=o.get(e);if(h)return h;o.set(e,a),eTe(e)?e.forEach((function(n){a.add(cTe(n,t,r,n,e,o))})):XRe(e)&&e.forEach((function(n,i){a.set(i,cTe(n,t,r,i,e,o))}));var p=u?void 0:(c?l?SRe:Kc:l?Nl:Tl)(e);return bOe(p||e,(function(n,i){p&&(n=e[i=n]),Ws(a,i,cTe(n,t,r,i,e,o))})),a}lTe[iTe]=lTe["[object Array]"]=lTe["[object ArrayBuffer]"]=lTe["[object DataView]"]=lTe["[object Boolean]"]=lTe["[object Date]"]=lTe["[object Float32Array]"]=lTe["[object Float64Array]"]=lTe["[object Int8Array]"]=lTe["[object Int16Array]"]=lTe["[object Int32Array]"]=lTe["[object Map]"]=lTe["[object Number]"]=lTe[sTe]=lTe["[object RegExp]"]=lTe["[object Set]"]=lTe["[object String]"]=lTe["[object Symbol]"]=lTe["[object Uint8Array]"]=lTe["[object Uint8ClampedArray]"]=lTe["[object Uint16Array]"]=lTe["[object Uint32Array]"]=!0,lTe["[object Error]"]=lTe[oTe]=lTe["[object WeakMap]"]=!1;function uTe(e,t,r){var n=r.length;if(null==e)return!n;for(e=Object(e);n--;){var i=r[n],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}var dTe=Object.prototype.hasOwnProperty,fTe=pd((function(e,t,r){dTe.call(e,r)?++e[r]:Us(e,r,1)}));const hTe=fTe;function pTe(e,t,r){var n=nIe(e,8,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=pTe.placeholder,n}pTe.placeholder={};function gTe(e,t,r){var n=nIe(e,16,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=gTe.placeholder,n}gTe.placeholder={};var mTe=Object.prototype,vTe=mTe.hasOwnProperty,yTe=Ys((function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&Qs(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],a=Nl(o),s=-1,l=a.length;++s<l;){var c=a[s],u=e[c];(void 0===u||zs(u,mTe[c])&&!vTe.call(e,c))&&(e[c]=o[c])}return e}));const bTe=yTe;function _Te(e,t,r,n,i,o){return Ga(e)&&Ga(t)&&(o.set(t,e),bd(e,t,void 0,_Te,o),o.delete(t)),e}var wTe=el((function(e,t,r,n){bd(e,t,r,n)}));const CTe=wTe;var ETe=Ys((function(e){return e.push(void 0,_Te),ks(CTe,void 0,e)}));const STe=ETe;function kTe(e,t,r){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,r)}),t)}var xTe=Ys((function(e,t){return kTe(e,1,t)}));const OTe=xTe;var ITe=Ys((function(e,t,r){return kTe(e,Za(t)||0,r)}));const RTe=ITe;var TTe=Ys((function(e,t){var r=kd(t);return md(r)&&(r=void 0),md(e)?Cd(e,lc(t,1,md,!0),ad(r)):[]}));const ATe=TTe;var MTe=Ys((function(e,t){var r=kd(t);return md(r)&&(r=void 0),md(e)?Cd(e,lc(t,1,md,!0),void 0,r):[]}));const NTe=MTe;var DTe=Hxe((function(e,t){return e/t}),1);const PTe=DTe;function jTe(e,t,r,n){for(var i=e.length,o=n?i:-1;(n?o--:++o<i)&&t(e[o],o,e););return r?yc(e,n?0:o,n?o+1:i):yc(e,n?o+1:0,n?i:o)}function FTe(e){return"function"==typeof e?e:ns}function VTe(e,t){return(Fa(e)?bOe:fd)(e,FTe(t))}function LTe(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}const $Te=ld(!0);function BTe(e,t){return e&&$Te(e,t,Tl)}const UTe=dd(BTe,!0);function zTe(e,t){return(Fa(e)?LTe:UTe)(e,FTe(t))}function HTe(e){return function(t){var r=lu(t);return"[object Map]"==r?bu(t):"[object Set]"==r?function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}(t):function(e,t){return ja(t,(function(t){return[t,e[t]]}))}(t,e(t))}}const WTe=HTe(Tl);const GTe=HTe(Nl);const KTe=NIe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});var qTe=/[&<>"']/g,YTe=RegExp(qTe.source);function JTe(e){return(e=Ql(e))&&YTe.test(e)?e.replace(qTe,KTe):e}var XTe=/[\\^$.*+?()[\]{}|]/g,ZTe=RegExp(XTe.source);function QTe(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function eAe(e,t){var r=!0;return fd(e,(function(e,n,i){return r=!!t(e,n,i)})),r}var tAe=4294967295;function rAe(e){return e?_Re(rs(e),0,tAe):0}function nAe(e,t){var r=[];return fd(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}function iAe(e){return function(t,r,n){var i=Object(t);if(!Zs(t)){var o=ad(r);t=Tl(t),r=function(e){return o(i[e],e,i)}}var a=e(t,r,n);return a>-1?i[o?t[a]:a]:void 0}}var oAe=Math.max;function aAe(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:rs(r);return i<0&&(i=oAe(n+i,0)),Ps(e,ad(t),i)}const sAe=iAe(aAe);function lAe(e,t,r){var n;return r(e,(function(e,r,i){if(t(e,r,i))return n=r,!1})),n}var cAe=Math.max,uAe=Math.min;function dAe(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n-1;return void 0!==r&&(i=rs(r),i=r<0?cAe(n+i,0):uAe(i,n-1)),Ps(e,ad(t),i,!0)}const fAe=iAe(dAe);function hAe(e){return e&&e.length?e[0]:void 0}function pAe(e,t){var r=-1,n=Zs(e)?Array(e.length):[];return fd(e,(function(e,i,o){n[++r]=t(e,i,o)})),n}function gAe(e,t){return(Fa(e)?ja:pAe)(e,ad(t))}const mAe=gRe("floor");function vAe(e){return mIe((function(t){var r=t.length,n=r,i=uOe.prototype.thru;for(e&&t.reverse();n--;){var o=t[n];if("function"!=typeof o)throw new TypeError("Expected a function");if(i&&!a&&"wrapper"==cOe(o))var a=new uOe([],!0)}for(n=a?n:r;++n<r;){var s=cOe(o=t[n]),l="wrapper"==s?aOe(o):void 0;a=l&&pOe(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[cOe(l[0])].apply(a,l[3]):1==o.length&&pOe(o)?a[s]():a.thru(o)}return function(){var e=arguments,n=e[0];if(a&&1==e.length&&Fa(n))return a.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}}))}const yAe=vAe();const bAe=vAe(!0);function _Ae(e,t){return $c(t,(function(t){return ls(e[t])}))}function wAe(e,t){return e>t}function CAe(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=Za(t),r=Za(r)),e(t,r)}}const EAe=CAe(wAe);var SAe=CAe((function(e,t){return e>=t}));const kAe=SAe;var xAe=Object.prototype.hasOwnProperty;function OAe(e,t){return null!=e&&xAe.call(e,t)}var IAe=Math.max;var RAe=Math.max;var TAe=Math.min;function AAe(e,t,r){for(var n=r?_d:Vs,i=e[0].length,o=e.length,a=o,s=Array(o),l=1/0,c=[];a--;){var u=e[a];a&&t&&(u=ja(u,ml(t))),l=TAe(u.length,l),s[a]=!r&&(t||i>=120&&u.length>=120)?new hu(a&&u):void 0}u=e[0];var d=-1,f=s[0];e:for(;++d<i&&c.length<l;){var h=u[d],p=t?t(h):h;if(h=r||0!==h?h:0,!(f?gu(f,p):n(c,p,r))){for(a=o;--a;){var g=s[a];if(!(g?gu(g,p):n(e[a],p,r)))continue e}f&&f.push(p),c.push(h)}}return c}function MAe(e){return md(e)?e:[]}var NAe=Ys((function(e){var t=ja(e,MAe);return t.length&&t[0]===e[0]?AAe(t):[]}));const DAe=NAe;var PAe=Ys((function(e){var t=kd(e),r=ja(e,MAe);return t===kd(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?AAe(r,ad(t)):[]}));const jAe=PAe;var FAe=Ys((function(e){var t=kd(e),r=ja(e,MAe);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?AAe(r,void 0,t):[]}));const VAe=FAe;function LAe(e,t){return function(r,n){return function(e,t,r,n){return ud(e,(function(e,i,o){t(n,r(e),i,o)})),n}(r,e,t(n),{})}}var $Ae=Object.prototype.toString,BAe=LAe((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=$Ae.call(t)),e[t]=r}),Ts(ns));const UAe=BAe;var zAe=Object.prototype,HAe=zAe.hasOwnProperty,WAe=zAe.toString,GAe=LAe((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=WAe.call(t)),HAe.call(e,t)?e[t].push(r):e[t]=[r]}),ad);const KAe=GAe;function qAe(e,t,r){var n=null==(e=jd(e,t=ec(t,e)))?e:e[rc(kd(t))];return null==n?void 0:ks(n,e,r)}const YAe=Ys(qAe);var JAe=Ys((function(e,t,r){var n=-1,i="function"==typeof t,o=Zs(e)?Array(e.length):[];return fd(e,(function(e){o[++n]=i?ks(t,e,r):qAe(e,t,r)})),o}));const XAe=JAe;var ZAe=_l&&_l.isArrayBuffer,QAe=ZAe?ml(ZAe):function(e){return Na(e)&&"[object ArrayBuffer]"==Ma(e)};const eMe=QAe;var tMe=_l&&_l.isDate,rMe=tMe?ml(tMe):function(e){return Na(e)&&"[object Date]"==Ma(e)};const nMe=rMe;var iMe=Object.prototype.hasOwnProperty;var oMe=Ca.isFinite;function aMe(e){return"number"==typeof e&&e==rs(e)}const sMe=cs?ls:ul;var lMe=_l&&_l.isRegExp,cMe=lMe?ml(lMe):function(e){return Na(e)&&"[object RegExp]"==Ma(e)};const uMe=cMe;var dMe=9007199254740991;var fMe=Array.prototype.join;var hMe=uRe((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}));const pMe=hMe;var gMe=pd((function(e,t,r){Us(e,r,t)}));const mMe=gMe;var vMe=Math.max,yMe=Math.min;var bMe=uRe((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}));const _Me=bMe;const wMe=dN("toLowerCase");function CMe(e,t){return e<t}const EMe=CAe(CMe);var SMe=CAe((function(e,t){return e<=t}));const kMe=SMe;function xMe(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],a=t(o);if(null!=a&&(void 0===s?a==a&&!Pa(a):r(a,s)))var s=a,l=o}return l}function OMe(e,t){for(var r,n=-1,i=e.length;++n<i;){var o=t(e[n]);void 0!==o&&(r=void 0===r?o:r+o)}return r}var IMe=NaN;function RMe(e,t){var r=null==e?0:e.length;return r?OMe(e,t)/r:IMe}var TMe=Ys((function(e,t){return function(r){return qAe(r,e,t)}}));const AMe=TMe;var MMe=Ys((function(e,t){return function(r){return qAe(e,r,t)}}));const NMe=MMe;function DMe(e,t,r){var n=Tl(t),i=_Ae(t,n),o=!(Ga(r)&&"chain"in r&&!r.chain),a=ls(e);return bOe(i,(function(r){var n=t[r];e[r]=n,a&&(e.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=e(this.__wrapped__);return(r.__actions__=Os(this.__actions__)).push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,oc([this.value()],arguments))})})),e}var PMe=Hxe((function(e,t){return e*t}),1);const jMe=PMe;var FMe="Expected a function";function VMe(e){if("function"!=typeof e)throw new TypeError(FMe);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function LMe(e,t){var r=e.length;if(r)return Bs(t+=t<0?r:0,r)?e[t]:void 0}function $Me(e){return vc(e)?void 0:e}var BMe=mIe((function(e,t){var r={};if(null==e)return r;var n=!1;t=ja(t,(function(t){return t=ec(t,e),n||(n=t.length>1),t})),Gs(e,SRe(e),r),n&&(r=cTe(r,7,$Me));for(var i=t.length;i--;)Gd(r,t[i]);return r}));const UMe=BMe;function zMe(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=nc(e,a);r(s,a)&&Kd(o,ec(a,e),s)}return o}function HMe(e,t){if(null==e)return{};var r=ja(SRe(e),(function(e){return[e]}));return t=ad(t),zMe(e,r,(function(e,r){return t(e,r[0])}))}function WMe(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=Pa(e),a=void 0!==t,s=null===t,l=t==t,c=Pa(t);if(!s&&!c&&!o&&e>t||o&&a&&l&&!s&&!c||n&&a&&l||!r&&l||!i)return 1;if(!n&&!o&&!c&&e<t||c&&r&&i&&!n&&!o||s&&r&&i||!a&&i||!l)return-1}return 0}function GMe(e,t,r){t=t.length?ja(t,(function(e){return Fa(e)?function(t){return nc(t,1===e.length?e[0]:e)}:e})):[ns];var n=-1;return t=ja(t,ml(ad)),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(pAe(e,(function(e,r,i){return{criteria:ja(t,(function(t){return t(e)})),index:++n,value:e}})),(function(e,t){return function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var l=WMe(i[n],o[n]);if(l)return n>=s?l:l*("desc"==r[n]?-1:1)}return e.index-t.index}(e,t,r)}))}function KMe(e){return mIe((function(t){return t=ja(t,ml(ad)),Ys((function(r){var n=this;return e(t,(function(e){return ks(e,n,r)}))}))}))}const qMe=KMe(ja);const YMe=Ys;var JMe=Math.min,XMe=YMe((function(e,t){var r=(t=1==t.length&&Fa(t[0])?ja(t[0],ml(ad)):ja(lc(t,1),ml(ad))).length;return Ys((function(n){for(var i=-1,o=JMe(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return ks(e,this,n)}))}));const ZMe=XMe;const QMe=KMe(QTe);const eNe=KMe(pu);var tNe=9007199254740991,rNe=Math.floor;function nNe(e,t){var r="";if(!e||t<1||t>tNe)return r;do{t%2&&(r+=e),(t=rNe(t/2))&&(e+=e)}while(t);return r}const iNe=id("length");var oNe="\\ud800-\\udfff",aNe="["+oNe+"]",sNe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",lNe="\\ud83c[\\udffb-\\udfff]",cNe="[^"+oNe+"]",uNe="(?:\\ud83c[\\udde6-\\uddff]){2}",dNe="[\\ud800-\\udbff][\\udc00-\\udfff]",fNe="(?:"+sNe+"|"+lNe+")"+"?",hNe="[\\ufe0e\\ufe0f]?",pNe=hNe+fNe+("(?:\\u200d(?:"+[cNe,uNe,dNe].join("|")+")"+hNe+fNe+")*"),gNe="(?:"+[cNe+sNe+"?",sNe,uNe,dNe,aNe].join("|")+")",mNe=RegExp(lNe+"(?="+lNe+")|"+gNe+pNe,"g");function vNe(e){return _c(e)?function(e){for(var t=mNe.lastIndex=0;mNe.test(e);)++t;return t}(e):iNe(e)}var yNe=Math.ceil;function bNe(e,t){var r=(t=void 0===t?" ":Ba(t)).length;if(r<2)return r?nNe(t,e):t;var n=nNe(t,yNe(e/vNe(t)));return _c(t)?uN(Nc(n),0,e).join(""):n.slice(0,e)}var _Ne=Math.ceil,wNe=Math.floor;var CNe=/^\s+/,ENe=Ca.parseInt;var SNe=Ys((function(e,t){return nIe(e,32,void 0,t,MOe(t,ROe(SNe)))}));SNe.placeholder={};const kNe=SNe;var xNe=Ys((function(e,t){return nIe(e,64,void 0,t,MOe(t,ROe(xNe)))}));xNe.placeholder={};const ONe=xNe;var INe=pd((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]}));const RNe=INe;var TNe=mIe((function(e,t){return null==e?{}:function(e,t){return zMe(e,t,(function(t,r){return ed(e,r)}))}(e,t)}));const ANe=TNe;function MNe(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1}var NNe=Array.prototype.splice;function DNe(e,t,r,n){var i=n?MNe:Fs,o=-1,a=t.length,s=e;for(e===t&&(t=Os(t)),r&&(s=ja(e,ml(r)));++o<a;)for(var l=0,c=t[o],u=r?r(c):c;(l=i(s,u,l,n))>-1;)s!==e&&NNe.call(s,l,1),NNe.call(e,l,1);return e}function PNe(e,t){return e&&e.length&&t&&t.length?DNe(e,t):e}const jNe=Ys(PNe);var FNe=mIe((function(e,t){var r=null==e?0:e.length,n=gIe(e,t);return Yd(e,ja(t,(function(e){return Bs(e,r)?+e:e})).sort(WMe)),n}));const VNe=FNe;var LNe=Math.floor,$Ne=Math.random;function BNe(e,t){return e+LNe($Ne()*(t-e+1))}var UNe=parseFloat,zNe=Math.min,HNe=Math.random;var WNe=Math.ceil,GNe=Math.max;function KNe(e){return function(t,r,n){return n&&"number"!=typeof n&&Qs(t,r,n)&&(r=n=void 0),t=ts(t),void 0===r?(r=t,t=0):r=ts(r),function(e,t,r,n){for(var i=-1,o=GNe(WNe((t-e)/(r||1)),0),a=Array(o);o--;)a[n?o:++i]=e,e+=r;return a}(t,r,n=void 0===n?t<r?1:-1:ts(n),e)}}const qNe=KNe();const YNe=KNe(!0);var JNe=mIe((function(e,t){return nIe(e,256,void 0,void 0,void 0,t)}));const XNe=JNe;function ZNe(e,t,r,n,i){return i(e,(function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)})),r}function QNe(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}var eDe=Array.prototype.reverse;function tDe(e){return null==e?e:eDe.call(e)}const rDe=gRe("round");function nDe(e){var t=e.length;return t?e[BNe(0,t-1)]:void 0}function iDe(e){return nDe(Pd(e))}function oDe(e,t){var r=-1,n=e.length,i=n-1;for(t=void 0===t?n:t;++r<t;){var o=BNe(r,i),a=e[o];e[o]=e[r],e[r]=a}return e.length=t,e}function aDe(e,t){return oDe(Os(e),_Re(t,0,e.length))}function sDe(e,t){var r=Pd(e);return oDe(r,_Re(t,0,r.length))}function lDe(e){return oDe(Os(e))}function cDe(e){return oDe(Pd(e))}var uDe=uRe((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}));const dDe=uDe;function fDe(e,t){var r;return fd(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r}var hDe=Ys((function(e,t){if(null==e)return[];var r=t.length;return r>1&&Qs(e,t[0],t[1])?t=[]:r>2&&Qs(t[0],t[1],t[2])&&(t=[t[0]]),GMe(e,lc(t,1),[])}));const pDe=hDe;var gDe=4294967294,mDe=Math.floor,vDe=Math.min;function yDe(e,t,r,n){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=r(t))!=t,s=null===t,l=Pa(t),c=void 0===t;i<o;){var u=mDe((i+o)/2),d=r(e[u]),f=void 0!==d,h=null===d,p=d==d,g=Pa(d);if(a)var m=n||p;else m=c?p&&(n||f):s?p&&f&&(n||!h):l?p&&f&&!h&&(n||!g):!h&&!g&&(n?d<=t:d<t);m?i=u+1:o=u}return vDe(o,gDe)}var bDe=2147483647;function _De(e,t,r){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=bDe){for(;n<i;){var o=n+i>>>1,a=e[o];null!==a&&!Pa(a)&&(r?a<=t:a<t)?n=o+1:i=o}return i}return yDe(e,t,ns,r)}function wDe(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r],s=t?t(a):a;if(!r||!zs(s,l)){var l=s;o[i++]=0===a?0:a}}return o}var CDe=Math.max;var EDe=uRe((function(e,t,r){return e+(r?" ":"")+fN(t)}));const SDe=EDe;var kDe=Hxe((function(e,t){return e-t}),0);const xDe=kDe;var ODe=Object.prototype,IDe=ODe.hasOwnProperty;function RDe(e,t,r,n){return void 0===e||zs(e,ODe[r])&&!IDe.call(n,r)?t:e}var TDe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function ADe(e){return"\\"+TDe[e]}const MDe=/<%=([\s\S]+?)%>/g;const NDe={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:MDe,variable:"",imports:{_:{escape:JTe}}};var DDe=/\b__p \+= '';/g,PDe=/\b(__p \+=) '' \+/g,jDe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,FDe=/[()=,{}\[\]\/\s]/,VDe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,LDe=/($^)/,$De=/['\n\r\u2028\u2029\\]/g,BDe=Object.prototype.hasOwnProperty;function UDe(e,t){return t(e)}var zDe=4294967295,HDe=Math.min;function WDe(e,t){var r=e;return r instanceof iOe&&(r=r.value()),MIe(t,(function(e,t){return t.func.apply(t.thisArg,oc([e],t.args))}),r)}function GDe(){return WDe(this.__wrapped__,this.__actions__)}var KDe=9007199254740991;function qDe(e,t){for(var r=e.length;r--&&Fs(t,e[r],0)>-1;);return r}function YDe(e,t){for(var r=-1,n=e.length;++r<n&&Fs(t,e[r],0)>-1;);return r}var JDe=/^\s+/;var XDe=/\w*$/;const ZDe=NIe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var QDe=/&(?:amp|lt|gt|quot|#39);/g,ePe=RegExp(QDe.source);var tPe=Ys((function(e){return rf(lc(e,1,md,!0))}));const rPe=tPe;var nPe=Ys((function(e){var t=kd(e);return t="function"==typeof t?t:void 0,rf(lc(e,1,md,!0),void 0,t)}));const iPe=nPe;var oPe=0;var aPe=Math.max;function sPe(e){if(!e||!e.length)return[];var t=0;return e=$c(e,(function(e){if(md(e))return t=aPe(e.length,t),!0})),nl(t,(function(t){return ja(e,id(t))}))}function lPe(e,t){if(!e||!e.length)return[];var r=sPe(e);return null==t?r:ja(r,(function(e){return ks(t,void 0,e)}))}function cPe(e,t,r,n){return Kd(e,t,r(nc(e,t)),n)}var uPe=uRe((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}));const dPe=uPe;var fPe=Ys((function(e,t){return md(e)?Cd(e,t):[]}));const hPe=fPe;var pPe=mIe((function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,i=function(t){return gIe(t,e)};return!(t>1||this.__actions__.length)&&n instanceof iOe&&Bs(r)?((n=n.slice(r,+r+(t?1:0))).__actions__.push({func:UDe,args:[i],thisArg:void 0}),new uOe(n,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));const gPe=pPe;function mPe(e,t,r){var n=e.length;if(n<2)return n?rf(e[0]):[];for(var i=-1,o=Array(n);++i<n;)for(var a=e[i],s=-1;++s<n;)s!=i&&(o[i]=Cd(o[i]||a,e[s],t,r));return rf(lc(o,1),t,r)}var vPe=Ys((function(e){return mPe($c(e,md))}));const yPe=vPe;var bPe=Ys((function(e){var t=kd(e);return md(t)&&(t=void 0),mPe($c(e,md),ad(t))}));const _Pe=bPe;var wPe=Ys((function(e){var t=kd(e);return t="function"==typeof t?t:void 0,mPe($c(e,md),void 0,t)}));const CPe=wPe;const EPe=Ys(sPe);function SPe(e,t,r){for(var n=-1,i=e.length,o=t.length,a={};++n<i;){var s=n<o?t[n]:void 0;r(a,e[n],s)}return a}var kPe=Ys((function(e){var t=e.length,r=t>1?e[t-1]:void 0;return r="function"==typeof r?(e.pop(),r):void 0,lPe(e,r)}));const xPe={chunk:function(e,t,r){t=(r?Qs(e,t,r):void 0===t)?1:bRe(rs(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,o=0,a=Array(yRe(n/t));i<n;)a[o++]=yc(e,i,i+=t);return a},compact:function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return oc(Fa(r)?Os(r):[r],lc(t,1))},difference:Sd,differenceBy:ATe,differenceWith:NTe,drop:function(e,t,r){var n=null==e?0:e.length;return n?yc(e,(t=r||void 0===t?1:rs(t))<0?0:t,n):[]},dropRight:function(e,t,r){var n=null==e?0:e.length;return n?yc(e,0,(t=n-(t=r||void 0===t?1:rs(t)))<0?0:t):[]},dropRightWhile:function(e,t){return e&&e.length?jTe(e,ad(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?jTe(e,ad(t),!0):[]},fill:function(e,t,r,n){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&Qs(e,t,r)&&(r=0,n=i),function(e,t,r,n){var i=e.length;for((r=rs(r))<0&&(r=-r>i?0:i+r),(n=void 0===n||n>i?i:rs(n))<0&&(n+=i),n=r>n?0:rAe(n);r<n;)e[r++]=t;return e}(e,t,r,n)):[]},findIndex:aAe,findLastIndex:dAe,first:hAe,flatten:cc,flattenDeep:function(e){return(null==e?0:e.length)?lc(e,Infinity):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?lc(e,t=void 0===t?1:rs(t)):[]},fromPairs:function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},head:hAe,indexOf:function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:rs(r);return i<0&&(i=RAe(n+i,0)),Fs(e,t,i)},initial:function(e){return(null==e?0:e.length)?yc(e,0,-1):[]},intersection:DAe,intersectionBy:jAe,intersectionWith:VAe,join:function(e,t){return null==e?"":fMe.call(e,t)},last:kd,lastIndexOf:function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n;return void 0!==r&&(i=(i=rs(r))<0?vMe(n+i,0):yMe(i,n-1)),t==t?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(e,t,i):Ps(e,js,i,!0)},nth:function(e,t){return e&&e.length?LMe(e,rs(t)):void 0},pull:jNe,pullAll:PNe,pullAllBy:function(e,t,r){return e&&e.length&&t&&t.length?DNe(e,t,ad(r)):e},pullAllWith:function(e,t,r){return e&&e.length&&t&&t.length?DNe(e,t,void 0,r):e},pullAt:VNe,remove:Jd,reverse:tDe,slice:Zd,sortedIndex:function(e,t){return _De(e,t)},sortedIndexBy:function(e,t,r){return yDe(e,t,ad(r))},sortedIndexOf:function(e,t){var r=null==e?0:e.length;if(r){var n=_De(e,t);if(n<r&&zs(e[n],t))return n}return-1},sortedLastIndex:function(e,t){return _De(e,t,!0)},sortedLastIndexBy:function(e,t,r){return yDe(e,t,ad(r),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var r=_De(e,t,!0)-1;if(zs(e[r],t))return r}return-1},sortedUniq:function(e){return e&&e.length?wDe(e):[]},sortedUniqBy:function(e,t){return e&&e.length?wDe(e,ad(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?yc(e,1,t):[]},take:function(e,t,r){return e&&e.length?yc(e,0,(t=r||void 0===t?1:rs(t))<0?0:t):[]},takeRight:function(e,t,r){var n=null==e?0:e.length;return n?yc(e,(t=n-(t=r||void 0===t?1:rs(t)))<0?0:t,n):[]},takeRightWhile:function(e,t){return e&&e.length?jTe(e,ad(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?jTe(e,ad(t)):[]},union:rPe,unionBy:of,unionWith:iPe,uniq:function(e){return e&&e.length?rf(e):[]},uniqBy:af,uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?rf(e,void 0,t):[]},unzip:sPe,unzipWith:lPe,without:hPe,xor:yPe,xorBy:_Pe,xorWith:CPe,zip:EPe,zipObject:function(e,t){return SPe(e||[],t||[],Ws)},zipObjectDeep:function(e,t){return SPe(e||[],t||[],Kd)},zipWith:kPe},OPe={countBy:hTe,each:VTe,eachRight:zTe,every:function(e,t,r){var n=Fa(e)?QTe:eAe;return r&&Qs(e,t,r)&&(t=void 0),n(e,ad(t))},filter:function(e,t){return(Fa(e)?$c:nAe)(e,ad(t))},find:sAe,findLast:fAe,flatMap:function(e,t){return lc(gAe(e,t),1)},flatMapDeep:function(e,t){return lc(gAe(e,t),Infinity)},flatMapDepth:function(e,t,r){return r=void 0===r?1:rs(r),lc(gAe(e,t),r)},forEach:VTe,forEachRight:zTe,groupBy:Id,includes:function(e,t,r,n){e=Zs(e)?e:Pd(e),r=r&&!n?rs(r):0;var i=e.length;return r<0&&(r=IAe(i+r,0)),Nd(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Fs(e,t,r)>-1},invokeMap:XAe,keyBy:mMe,map:gAe,orderBy:function(e,t,r,n){return null==e?[]:(Fa(t)||(t=null==t?[]:[t]),Fa(r=n?void 0:r)||(r=null==r?[]:[r]),GMe(e,t,r))},partition:RNe,reduce:function(e,t,r){var n=Fa(e)?MIe:ZNe,i=arguments.length<3;return n(e,ad(t),r,i,fd)},reduceRight:function(e,t,r){var n=Fa(e)?QNe:ZNe,i=arguments.length<3;return n(e,ad(t),r,i,UTe)},reject:function(e,t){return(Fa(e)?$c:nAe)(e,VMe(ad(t)))},sample:function(e){return(Fa(e)?nDe:iDe)(e)},sampleSize:function(e,t,r){return t=(r?Qs(e,t,r):void 0===t)?1:rs(t),(Fa(e)?aDe:sDe)(e,t)},shuffle:function(e){return(Fa(e)?lDe:cDe)(e)},size:function(e){if(null==e)return 0;if(Zs(e))return Nd(e)?vNe(e):e.length;var t=lu(e);return"[object Map]"==t||"[object Set]"==t?e.size:Rl(e).length},some:function(e,t,r){var n=Fa(e)?pu:fDe;return r&&Qs(e,t,r)&&(t=void 0),n(e,ad(t))},sortBy:pDe},IPe={now:hN},RPe={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=rs(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:oIe,before:SIe,bind:xIe,bindKey:TIe,curry:pTe,curryRight:gTe,debounce:vN,defer:OTe,delay:RTe,flip:function(e){return nIe(e,512)},memoize:ql,negate:VMe,once:function(e){return SIe(2,e)},overArgs:ZMe,partial:kNe,partialRight:ONe,rearg:XNe,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return Ys(e,t=void 0===t?t:rs(t))},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:CDe(rs(t),0),Ys((function(r){var n=r[t],i=uN(r,0,t);return n&&oc(i,n),ks(e,this,i)}))},throttle:EN,unary:function(e){return oIe(e,1)},wrap:function(e,t){return kNe(FTe(t),e)}},TPe={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return Fa(e)?e:[e]},clone:function(e){return cTe(e,4)},cloneDeep:function(e){return cTe(e,5)},cloneDeepWith:function(e,t){return cTe(e,5,t="function"==typeof t?t:void 0)},cloneWith:function(e,t){return cTe(e,4,t="function"==typeof t?t:void 0)},conformsTo:function(e,t){return null==t||uTe(e,t,Tl(t))},eq:zs,gt:EAe,gte:kAe,isArguments:cl,isArray:Fa,isArrayBuffer:eMe,isArrayLike:Zs,isArrayLikeObject:md,isBoolean:Fd,isBuffer:pl,isDate:nMe,isElement:yN,isEmpty:function(e){if(null==e)return!0;if(Zs(e)&&(Fa(e)||"string"==typeof e||"function"==typeof e.splice||pl(e)||El(e)||cl(e)))return!e.length;var t=lu(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(rl(e))return!Rl(e).length;for(var r in e)if(iMe.call(e,r))return!1;return!0},isEqual:Vd,isEqualWith:function(e,t,r){var n=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===n?Hu(e,t,void 0,r):!!n},isError:_Ie,isFinite:function(e){return"number"==typeof e&&oMe(e)},isFunction:ls,isInteger:aMe,isLength:Xs,isMap:XRe,isMatch:function(e,t){return e===t||Ku(e,t,Yu(t))},isMatchWith:function(e,t,r){return r="function"==typeof r?r:void 0,Ku(e,t,Yu(t),r)},isNaN:wN,isNative:function(e){if(sMe(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return bs(e)},isNil:Ld,isNull:function(e){return null===e},isNumber:_N,isObject:Ga,isObjectLike:Na,isPlainObject:vc,isRegExp:uMe,isSafeInteger:function(e){return aMe(e)&&e>=-dMe&&e<=dMe},isSet:eTe,isString:Nd,isSymbol:Pa,isTypedArray:El,isUndefined:CN,isWeakMap:function(e){return Na(e)&&"[object WeakMap]"==lu(e)},isWeakSet:function(e){return Na(e)&&"[object WeakSet]"==Ma(e)},lt:EMe,lte:kMe,toArray:Wd,toFinite:ts,toInteger:rs,toLength:rAe,toNumber:Za,toPlainObject:yd,toSafeInteger:function(e){return e?_Re(rs(e),-KDe,KDe):0===e?e:0},toString:Ql},APe={add:Gxe,ceil:mRe,divide:PTe,floor:mAe,max:function(e){return e&&e.length?xMe(e,ns,wAe):void 0},maxBy:function(e,t){return e&&e.length?xMe(e,ad(t),wAe):void 0},mean:function(e){return RMe(e,ns)},meanBy:function(e,t){return RMe(e,ad(t))},min:function(e){return e&&e.length?xMe(e,ns,CMe):void 0},minBy:function(e,t){return e&&e.length?xMe(e,ad(t),CMe):void 0},multiply:jMe,round:rDe,subtract:xDe,sum:function(e){return e&&e.length?OMe(e,ns):0},sumBy:function(e,t){return e&&e.length?OMe(e,ad(t)):0}},MPe=function(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=Za(r))==r?r:0),void 0!==t&&(t=(t=Za(t))==t?t:0),_Re(Za(e),t,r)},NPe=Ad,DPe=function(e,t,r){if(r&&"boolean"!=typeof r&&Qs(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=ts(e),void 0===t?(t=e,e=0):t=ts(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var i=HNe();return zNe(e+i*(t-e+UNe("1e-"+((i+"").length-1))),t)}return BNe(e,t)},PPe={assign:lIe,assignIn:uIe,assignInWith:fIe,assignWith:pIe,at:vIe,create:function(e,t){var r=Ss(e);return null==t?r:wRe(r,t)},defaults:bTe,defaultsDeep:STe,entries:WTe,entriesIn:GTe,extend:uIe,extendWith:fIe,findKey:function(e,t){return lAe(e,ad(t),ud)},findLastKey:function(e,t){return lAe(e,ad(t),BTe)},forIn:function(e,t){return null==e?e:cd(e,FTe(t),Nl)},forInRight:function(e,t){return null==e?e:$Te(e,FTe(t),Nl)},forOwn:function(e,t){return e&&ud(e,FTe(t))},forOwnRight:function(e,t){return e&&BTe(e,FTe(t))},functions:function(e){return null==e?[]:_Ae(e,Tl(e))},functionsIn:function(e){return null==e?[]:_Ae(e,Nl(e))},get:ic,has:function(e,t){return null!=e&&Qu(e,t,OAe)},hasIn:ed,invert:UAe,invertBy:KAe,invoke:YAe,keys:Tl,keysIn:Nl,mapKeys:function(e,t){var r={};return t=ad(t),ud(e,(function(e,n,i){Us(r,t(e,n,i),e)})),r},mapValues:function(e,t){var r={};return t=ad(t),ud(e,(function(e,n,i){Us(r,n,t(e,n,i))})),r},merge:Bd,mergeWith:CTe,omit:UMe,omitBy:function(e,t){return HMe(e,VMe(ad(t)))},pick:ANe,pickBy:HMe,result:function(e,t,r){var n=-1,i=(t=ec(t,e)).length;for(i||(i=1,e=void 0);++n<i;){var o=null==e?void 0:e[rc(t[n])];void 0===o&&(n=i,o=r),e=ls(o)?o.call(e):o}return e},set:Xd,setWith:function(e,t,r,n){return n="function"==typeof n?n:void 0,null==e?e:Kd(e,t,r,n)},toPairs:WTe,toPairsIn:GTe,transform:function(e,t,r){var n=Fa(e),i=n||pl(e)||El(e);if(t=ad(t),null==r){var o=e&&e.constructor;r=i?n?new o:[]:Ga(e)&&ls(o)?Ss(uc(e)):{}}return(i?bOe:ud)(e,(function(e,n,i){return t(r,e,n,i)})),r},unset:function(e,t){return null==e||Gd(e,t)},update:function(e,t,r){return null==e?e:cPe(e,t,FTe(r))},updateWith:function(e,t,r,n){return n="function"==typeof n?n:void 0,null==e?e:cPe(e,t,FTe(r),n)},values:Pd,valuesIn:function(e){return null==e?[]:Dd(e,Nl(e))}},jPe={at:gPe,chain:vRe,commit:function(){return new uOe(this.value(),this.__chain__)},lodash:hOe,next:function(){void 0===this.__values__&&(this.__values__=Wd(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,r=this;r instanceof rOe;){var n=dOe(r);n.__index__=0,n.__values__=void 0,t?i.__wrapped__=n:t=n;var i=n;r=r.__wrapped__}return i.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof iOe){var t=e;return this.__actions__.length&&(t=new iOe(this)),(t=t.reverse()).__actions__.push({func:UDe,args:[tDe],thisArg:void 0}),new uOe(t,this.__chain__)}return this.thru(tDe)},tap:function(e,t){return t(e),e},thru:UDe,toIterator:function(){return this},toJSON:GDe,value:GDe,valueOf:GDe,wrapperChain:function(){return vRe(this)}},FPe={camelCase:fRe,capitalize:AIe,deburr:FIe,endsWith:function(e,t,r){e=Ql(e),t=Ba(t);var n=e.length,i=r=void 0===r?n:_Re(rs(r),0,n);return(r-=t.length)>=0&&e.slice(r,i)==t},escape:JTe,escapeRegExp:function(e){return(e=Ql(e))&&ZTe.test(e)?e.replace(XTe,"\\$&"):e},kebabCase:pMe,lowerCase:_Me,lowerFirst:wMe,pad:function(e,t,r){e=Ql(e);var n=(t=rs(t))?vNe(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return bNe(wNe(i),r)+e+bNe(_Ne(i),r)},padEnd:function(e,t,r){e=Ql(e);var n=(t=rs(t))?vNe(e):0;return t&&n<t?e+bNe(t-n,r):e},padStart:function(e,t,r){e=Ql(e);var n=(t=rs(t))?vNe(e):0;return t&&n<t?bNe(t-n,r)+e:e},parseInt:function(e,t,r){return r||null==t?t=0:t&&(t=+t),ENe(Ql(e).replace(CNe,""),t||0)},repeat:function(e,t,r){return t=(r?Qs(e,t,r):void 0===t)?1:rs(t),nNe(Ql(e),t)},replace:function(){var e=arguments,t=Ql(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:dDe,split:function(e,t,r){return r&&"number"!=typeof r&&Qs(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=Ql(e))&&("string"==typeof t||null!=t&&!uMe(t))&&(!(t=Ba(t))&&_c(e))?uN(Nc(e),0,r):e.split(t,r):[]},startCase:SDe,startsWith:function(e,t,r){return e=Ql(e),r=null==r?0:_Re(rs(r),0,e.length),t=Ba(t),e.slice(r,r+t.length)==t},template:function(e,t,r){var n=NDe.imports._.templateSettings||NDe;r&&Qs(e,t,r)&&(t=void 0),e=Ql(e),t=fIe({},t,n,RDe);var i,o,a=fIe({},t.imports,n.imports,RDe),s=Tl(a),l=Dd(a,s),c=0,u=t.interpolate||LDe,d="__p += '",f=RegExp((t.escape||LDe).source+"|"+u.source+"|"+(u===MDe?VDe:LDe).source+"|"+(t.evaluate||LDe).source+"|$","g"),h=BDe.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(f,(function(t,r,n,a,s,l){return n||(n=a),d+=e.slice(c,l).replace($De,ADe),r&&(i=!0,d+="' +\n__e("+r+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=l+t.length,t})),d+="';\n";var p=BDe.call(t,"variable")&&t.variable;if(p){if(FDe.test(p))throw new Error("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(DDe,""):d).replace(PDe,"$1").replace(jDe,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=CIe((function(){return Function(s,h+"return "+d).apply(void 0,l)}));if(g.source=d,_Ie(g))throw g;return g},templateSettings:NDe,toLower:function(e){return Ql(e).toLowerCase()},toUpper:function(e){return Ql(e).toUpperCase()},trim:function(e,t,r){if((e=Ql(e))&&(r||void 0===t))return Wa(e);if(!e||!(t=Ba(t)))return e;var n=Nc(e),i=Nc(t);return uN(n,YDe(n,i),qDe(n,i)+1).join("")},trimEnd:function(e,t,r){if((e=Ql(e))&&(r||void 0===t))return e.slice(0,za(e)+1);if(!e||!(t=Ba(t)))return e;var n=Nc(e);return uN(n,0,qDe(n,Nc(t))+1).join("")},trimStart:function(e,t,r){if((e=Ql(e))&&(r||void 0===t))return e.replace(JDe,"");if(!e||!(t=Ba(t)))return e;var n=Nc(e);return uN(n,YDe(n,Nc(t))).join("")},truncate:function(e,t){var r=30,n="...";if(Ga(t)){var i="separator"in t?t.separator:i;r="length"in t?rs(t.length):r,n="omission"in t?Ba(t.omission):n}var o=(e=Ql(e)).length;if(_c(e)){var a=Nc(e);o=a.length}if(r>=o)return e;var s=r-vNe(n);if(s<1)return n;var l=a?uN(a,0,s).join(""):e.slice(0,s);if(void 0===i)return l+n;if(a&&(s+=l.length-s),uMe(i)){if(e.slice(s).search(i)){var c,u=l;for(i.global||(i=RegExp(i.source,Ql(XDe.exec(i))+"g")),i.lastIndex=0;c=i.exec(u);)var d=c.index;l=l.slice(0,void 0===d?s:d)}}else if(e.indexOf(Ba(i),s)!=s){var f=l.lastIndexOf(i);f>-1&&(l=l.slice(0,f))}return l+n},unescape:function(e){return(e=Ql(e))&&ePe.test(e)?e.replace(QDe,ZDe):e},upperCase:dPe,upperFirst:fN,words:lRe},VPe={attempt:CIe,bindAll:IIe,cond:function(e){var t=null==e?0:e.length,r=ad;return e=t?ja(e,(function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[r(e[0]),e[1]]})):[],Ys((function(r){for(var n=-1;++n<t;){var i=e[n];if(ks(i[0],this,r))return ks(i[1],this,r)}}))},conforms:function(e){return function(e){var t=Tl(e);return function(r){return uTe(r,e,t)}}(cTe(e,1))},constant:Ts,defaultTo:function(e,t){return null==e||e!=e?t:e},flow:yAe,flowRight:bAe,identity:ns,iteratee:function(e){return ad("function"==typeof e?e:cTe(e,1))},matches:function(e){return Xu(cTe(e,1))},matchesProperty:function(e,t){return nd(e,cTe(t,1))},method:AMe,methodOf:NMe,mixin:DMe,noop:xs,nthArg:function(e){return e=rs(e),Ys((function(t){return LMe(t,e)}))},over:qMe,overEvery:QMe,overSome:eNe,property:od,propertyOf:function(e){return function(t){return null==e?void 0:nc(e,t)}},range:qNe,rangeRight:YNe,stubArray:Bc,stubFalse:ul,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if((e=rs(e))<1||e>9007199254740991)return[];var r=zDe,n=HDe(e,zDe);t=FTe(t),e-=zDe;for(var i=nl(n,t);++r<e;)t(r);return i},toPath:function(e){return Fa(e)?ja(e,rc):Pa(e)?[e]:Os(Zl(Ql(e)))},uniqueId:function(e){var t=++oPe;return Ql(e)+t}};var LPe=Math.max,$Pe=Math.min;var BPe=Math.min;var UPe=4294967295,zPe=Array.prototype,HPe=Object.prototype.hasOwnProperty,WPe=Ea?Ea.iterator:void 0,GPe=Math.max,KPe=Math.min,qPe=function(e){return function(t,r,n){if(null==n){var i=Ga(r),o=i&&Tl(r),a=o&&o.length&&_Ae(r,o);(a?a.length:i)||(n=r,r=t,t=this)}return e(t,r,n)}}(DMe);hOe.after=RPe.after,hOe.ary=RPe.ary,hOe.assign=PPe.assign,hOe.assignIn=PPe.assignIn,hOe.assignInWith=PPe.assignInWith,hOe.assignWith=PPe.assignWith,hOe.at=PPe.at,hOe.before=RPe.before,hOe.bind=RPe.bind,hOe.bindAll=VPe.bindAll,hOe.bindKey=RPe.bindKey,hOe.castArray=TPe.castArray,hOe.chain=jPe.chain,hOe.chunk=xPe.chunk,hOe.compact=xPe.compact,hOe.concat=xPe.concat,hOe.cond=VPe.cond,hOe.conforms=VPe.conforms,hOe.constant=VPe.constant,hOe.countBy=OPe.countBy,hOe.create=PPe.create,hOe.curry=RPe.curry,hOe.curryRight=RPe.curryRight,hOe.debounce=RPe.debounce,hOe.defaults=PPe.defaults,hOe.defaultsDeep=PPe.defaultsDeep,hOe.defer=RPe.defer,hOe.delay=RPe.delay,hOe.difference=xPe.difference,hOe.differenceBy=xPe.differenceBy,hOe.differenceWith=xPe.differenceWith,hOe.drop=xPe.drop,hOe.dropRight=xPe.dropRight,hOe.dropRightWhile=xPe.dropRightWhile,hOe.dropWhile=xPe.dropWhile,hOe.fill=xPe.fill,hOe.filter=OPe.filter,hOe.flatMap=OPe.flatMap,hOe.flatMapDeep=OPe.flatMapDeep,hOe.flatMapDepth=OPe.flatMapDepth,hOe.flatten=xPe.flatten,hOe.flattenDeep=xPe.flattenDeep,hOe.flattenDepth=xPe.flattenDepth,hOe.flip=RPe.flip,hOe.flow=VPe.flow,hOe.flowRight=VPe.flowRight,hOe.fromPairs=xPe.fromPairs,hOe.functions=PPe.functions,hOe.functionsIn=PPe.functionsIn,hOe.groupBy=OPe.groupBy,hOe.initial=xPe.initial,hOe.intersection=xPe.intersection,hOe.intersectionBy=xPe.intersectionBy,hOe.intersectionWith=xPe.intersectionWith,hOe.invert=PPe.invert,hOe.invertBy=PPe.invertBy,hOe.invokeMap=OPe.invokeMap,hOe.iteratee=VPe.iteratee,hOe.keyBy=OPe.keyBy,hOe.keys=Tl,hOe.keysIn=PPe.keysIn,hOe.map=OPe.map,hOe.mapKeys=PPe.mapKeys,hOe.mapValues=PPe.mapValues,hOe.matches=VPe.matches,hOe.matchesProperty=VPe.matchesProperty,hOe.memoize=RPe.memoize,hOe.merge=PPe.merge,hOe.mergeWith=PPe.mergeWith,hOe.method=VPe.method,hOe.methodOf=VPe.methodOf,hOe.mixin=qPe,hOe.negate=VMe,hOe.nthArg=VPe.nthArg,hOe.omit=PPe.omit,hOe.omitBy=PPe.omitBy,hOe.once=RPe.once,hOe.orderBy=OPe.orderBy,hOe.over=VPe.over,hOe.overArgs=RPe.overArgs,hOe.overEvery=VPe.overEvery,hOe.overSome=VPe.overSome,hOe.partial=RPe.partial,hOe.partialRight=RPe.partialRight,hOe.partition=OPe.partition,hOe.pick=PPe.pick,hOe.pickBy=PPe.pickBy,hOe.property=VPe.property,hOe.propertyOf=VPe.propertyOf,hOe.pull=xPe.pull,hOe.pullAll=xPe.pullAll,hOe.pullAllBy=xPe.pullAllBy,hOe.pullAllWith=xPe.pullAllWith,hOe.pullAt=xPe.pullAt,hOe.range=VPe.range,hOe.rangeRight=VPe.rangeRight,hOe.rearg=RPe.rearg,hOe.reject=OPe.reject,hOe.remove=xPe.remove,hOe.rest=RPe.rest,hOe.reverse=xPe.reverse,hOe.sampleSize=OPe.sampleSize,hOe.set=PPe.set,hOe.setWith=PPe.setWith,hOe.shuffle=OPe.shuffle,hOe.slice=xPe.slice,hOe.sortBy=OPe.sortBy,hOe.sortedUniq=xPe.sortedUniq,hOe.sortedUniqBy=xPe.sortedUniqBy,hOe.split=FPe.split,hOe.spread=RPe.spread,hOe.tail=xPe.tail,hOe.take=xPe.take,hOe.takeRight=xPe.takeRight,hOe.takeRightWhile=xPe.takeRightWhile,hOe.takeWhile=xPe.takeWhile,hOe.tap=jPe.tap,hOe.throttle=RPe.throttle,hOe.thru=UDe,hOe.toArray=TPe.toArray,hOe.toPairs=PPe.toPairs,hOe.toPairsIn=PPe.toPairsIn,hOe.toPath=VPe.toPath,hOe.toPlainObject=TPe.toPlainObject,hOe.transform=PPe.transform,hOe.unary=RPe.unary,hOe.union=xPe.union,hOe.unionBy=xPe.unionBy,hOe.unionWith=xPe.unionWith,hOe.uniq=xPe.uniq,hOe.uniqBy=xPe.uniqBy,hOe.uniqWith=xPe.uniqWith,hOe.unset=PPe.unset,hOe.unzip=xPe.unzip,hOe.unzipWith=xPe.unzipWith,hOe.update=PPe.update,hOe.updateWith=PPe.updateWith,hOe.values=PPe.values,hOe.valuesIn=PPe.valuesIn,hOe.without=xPe.without,hOe.words=FPe.words,hOe.wrap=RPe.wrap,hOe.xor=xPe.xor,hOe.xorBy=xPe.xorBy,hOe.xorWith=xPe.xorWith,hOe.zip=xPe.zip,hOe.zipObject=xPe.zipObject,hOe.zipObjectDeep=xPe.zipObjectDeep,hOe.zipWith=xPe.zipWith,hOe.entries=PPe.toPairs,hOe.entriesIn=PPe.toPairsIn,hOe.extend=PPe.assignIn,hOe.extendWith=PPe.assignInWith,qPe(hOe,hOe),hOe.add=APe.add,hOe.attempt=VPe.attempt,hOe.camelCase=FPe.camelCase,hOe.capitalize=FPe.capitalize,hOe.ceil=APe.ceil,hOe.clamp=MPe,hOe.clone=TPe.clone,hOe.cloneDeep=TPe.cloneDeep,hOe.cloneDeepWith=TPe.cloneDeepWith,hOe.cloneWith=TPe.cloneWith,hOe.conformsTo=TPe.conformsTo,hOe.deburr=FPe.deburr,hOe.defaultTo=VPe.defaultTo,hOe.divide=APe.divide,hOe.endsWith=FPe.endsWith,hOe.eq=TPe.eq,hOe.escape=FPe.escape,hOe.escapeRegExp=FPe.escapeRegExp,hOe.every=OPe.every,hOe.find=OPe.find,hOe.findIndex=xPe.findIndex,hOe.findKey=PPe.findKey,hOe.findLast=OPe.findLast,hOe.findLastIndex=xPe.findLastIndex,hOe.findLastKey=PPe.findLastKey,hOe.floor=APe.floor,hOe.forEach=OPe.forEach,hOe.forEachRight=OPe.forEachRight,hOe.forIn=PPe.forIn,hOe.forInRight=PPe.forInRight,hOe.forOwn=PPe.forOwn,hOe.forOwnRight=PPe.forOwnRight,hOe.get=PPe.get,hOe.gt=TPe.gt,hOe.gte=TPe.gte,hOe.has=PPe.has,hOe.hasIn=PPe.hasIn,hOe.head=xPe.head,hOe.identity=ns,hOe.includes=OPe.includes,hOe.indexOf=xPe.indexOf,hOe.inRange=NPe,hOe.invoke=PPe.invoke,hOe.isArguments=TPe.isArguments,hOe.isArray=Fa,hOe.isArrayBuffer=TPe.isArrayBuffer,hOe.isArrayLike=TPe.isArrayLike,hOe.isArrayLikeObject=TPe.isArrayLikeObject,hOe.isBoolean=TPe.isBoolean,hOe.isBuffer=TPe.isBuffer,hOe.isDate=TPe.isDate,hOe.isElement=TPe.isElement,hOe.isEmpty=TPe.isEmpty,hOe.isEqual=TPe.isEqual,hOe.isEqualWith=TPe.isEqualWith,hOe.isError=TPe.isError,hOe.isFinite=TPe.isFinite,hOe.isFunction=TPe.isFunction,hOe.isInteger=TPe.isInteger,hOe.isLength=TPe.isLength,hOe.isMap=TPe.isMap,hOe.isMatch=TPe.isMatch,hOe.isMatchWith=TPe.isMatchWith,hOe.isNaN=TPe.isNaN,hOe.isNative=TPe.isNative,hOe.isNil=TPe.isNil,hOe.isNull=TPe.isNull,hOe.isNumber=TPe.isNumber,hOe.isObject=Ga,hOe.isObjectLike=TPe.isObjectLike,hOe.isPlainObject=TPe.isPlainObject,hOe.isRegExp=TPe.isRegExp,hOe.isSafeInteger=TPe.isSafeInteger,hOe.isSet=TPe.isSet,hOe.isString=TPe.isString,hOe.isSymbol=TPe.isSymbol,hOe.isTypedArray=TPe.isTypedArray,hOe.isUndefined=TPe.isUndefined,hOe.isWeakMap=TPe.isWeakMap,hOe.isWeakSet=TPe.isWeakSet,hOe.join=xPe.join,hOe.kebabCase=FPe.kebabCase,hOe.last=kd,hOe.lastIndexOf=xPe.lastIndexOf,hOe.lowerCase=FPe.lowerCase,hOe.lowerFirst=FPe.lowerFirst,hOe.lt=TPe.lt,hOe.lte=TPe.lte,hOe.max=APe.max,hOe.maxBy=APe.maxBy,hOe.mean=APe.mean,hOe.meanBy=APe.meanBy,hOe.min=APe.min,hOe.minBy=APe.minBy,hOe.stubArray=VPe.stubArray,hOe.stubFalse=VPe.stubFalse,hOe.stubObject=VPe.stubObject,hOe.stubString=VPe.stubString,hOe.stubTrue=VPe.stubTrue,hOe.multiply=APe.multiply,hOe.nth=xPe.nth,hOe.noop=VPe.noop,hOe.now=IPe.now,hOe.pad=FPe.pad,hOe.padEnd=FPe.padEnd,hOe.padStart=FPe.padStart,hOe.parseInt=FPe.parseInt,hOe.random=DPe,hOe.reduce=OPe.reduce,hOe.reduceRight=OPe.reduceRight,hOe.repeat=FPe.repeat,hOe.replace=FPe.replace,hOe.result=PPe.result,hOe.round=APe.round,hOe.sample=OPe.sample,hOe.size=OPe.size,hOe.snakeCase=FPe.snakeCase,hOe.some=OPe.some,hOe.sortedIndex=xPe.sortedIndex,hOe.sortedIndexBy=xPe.sortedIndexBy,hOe.sortedIndexOf=xPe.sortedIndexOf,hOe.sortedLastIndex=xPe.sortedLastIndex,hOe.sortedLastIndexBy=xPe.sortedLastIndexBy,hOe.sortedLastIndexOf=xPe.sortedLastIndexOf,hOe.startCase=FPe.startCase,hOe.startsWith=FPe.startsWith,hOe.subtract=APe.subtract,hOe.sum=APe.sum,hOe.sumBy=APe.sumBy,hOe.template=FPe.template,hOe.times=VPe.times,hOe.toFinite=TPe.toFinite,hOe.toInteger=rs,hOe.toLength=TPe.toLength,hOe.toLower=FPe.toLower,hOe.toNumber=TPe.toNumber,hOe.toSafeInteger=TPe.toSafeInteger,hOe.toString=TPe.toString,hOe.toUpper=FPe.toUpper,hOe.trim=FPe.trim,hOe.trimEnd=FPe.trimEnd,hOe.trimStart=FPe.trimStart,hOe.truncate=FPe.truncate,hOe.unescape=FPe.unescape,hOe.uniqueId=VPe.uniqueId,hOe.upperCase=FPe.upperCase,hOe.upperFirst=FPe.upperFirst,hOe.each=OPe.forEach,hOe.eachRight=OPe.forEachRight,hOe.first=xPe.head,qPe(hOe,function(){var e={};return ud(hOe,(function(t,r){HPe.call(hOe.prototype,r)||(e[r]=t)})),e}(),{chain:!1}),hOe.VERSION="4.17.21",(hOe.templateSettings=FPe.templateSettings).imports._=hOe,bOe(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){hOe[e].placeholder=hOe})),bOe(["drop","take"],(function(e,t){iOe.prototype[e]=function(r){r=void 0===r?1:GPe(rs(r),0);var n=this.__filtered__&&!t?new iOe(this):this.clone();return n.__filtered__?n.__takeCount__=KPe(r,n.__takeCount__):n.__views__.push({size:KPe(r,UPe),type:e+(n.__dir__<0?"Right":"")}),n},iOe.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),bOe(["filter","map","takeWhile"],(function(e,t){var r=t+1,n=1==r||3==r;iOe.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ad(e),type:r}),t.__filtered__=t.__filtered__||n,t}})),bOe(["head","last"],(function(e,t){var r="take"+(t?"Right":"");iOe.prototype[e]=function(){return this[r](1).value()[0]}})),bOe(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");iOe.prototype[e]=function(){return this.__filtered__?new iOe(this):this[r](1)}})),iOe.prototype.compact=function(){return this.filter(ns)},iOe.prototype.find=function(e){return this.filter(e).head()},iOe.prototype.findLast=function(e){return this.reverse().find(e)},iOe.prototype.invokeMap=Ys((function(e,t){return"function"==typeof e?new iOe(this):this.map((function(r){return qAe(r,e,t)}))})),iOe.prototype.reject=function(e){return this.filter(VMe(ad(e)))},iOe.prototype.slice=function(e,t){e=rs(e);var r=this;return r.__filtered__&&(e>0||t<0)?new iOe(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),void 0!==t&&(r=(t=rs(t))<0?r.dropRight(-t):r.take(t-e)),r)},iOe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},iOe.prototype.toArray=function(){return this.take(UPe)},ud(iOe.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),i=hOe[n?"take"+("last"==t?"Right":""):t],o=n||/^find/.test(t);!i||(hOe.prototype[t]=function(){var t=this.__wrapped__,a=n?[1]:arguments,s=t instanceof iOe,l=a[0],c=s||Fa(t),u=function(e){var t=i.apply(hOe,oc([e],a));return n&&d?t[0]:t};c&&r&&"function"==typeof l&&1!=l.length&&(s=c=!1);var d=this.__chain__,f=!!this.__actions__.length,h=o&&!d,p=s&&!f;if(!o&&c){t=p?t:new iOe(this);var g=e.apply(t,a);return g.__actions__.push({func:UDe,args:[u],thisArg:void 0}),new uOe(g,d)}return h&&p?e.apply(this,a):(g=this.thru(u),h?n?g.value()[0]:g.value():g)})})),bOe(["pop","push","shift","sort","splice","unshift"],(function(e){var t=zPe[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);hOe.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var i=this.value();return t.apply(Fa(i)?i:[],e)}return this[r]((function(r){return t.apply(Fa(r)?r:[],e)}))}})),ud(iOe.prototype,(function(e,t){var r=hOe[t];if(r){var n=r.name+"";HPe.call(sOe,n)||(sOe[n]=[]),sOe[n].push({name:t,func:r})}})),sOe[LOe(void 0,2).name]=[{name:"wrapper",func:void 0}],iOe.prototype.clone=function(){var e=new iOe(this.__wrapped__);return e.__actions__=Os(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Os(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Os(this.__views__),e},iOe.prototype.reverse=function(){if(this.__filtered__){var e=new iOe(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},iOe.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=Fa(e),n=t<0,i=r?e.length:0,o=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=$Pe(t,e+a);break;case"takeRight":e=LPe(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,c=n?s:a-1,u=this.__iteratees__,d=u.length,f=0,h=BPe(l,this.__takeCount__);if(!r||!n&&i==l&&h==l)return WDe(e,this.__actions__);var p=[];e:for(;l--&&f<h;){for(var g=-1,m=e[c+=t];++g<d;){var v=u[g],y=v.iteratee,b=v.type,_=y(m);if(2==b)m=_;else if(!_){if(1==b)continue e;break e}}p[f++]=m}return p},hOe.prototype.at=jPe.at,hOe.prototype.chain=jPe.wrapperChain,hOe.prototype.commit=jPe.commit,hOe.prototype.next=jPe.next,hOe.prototype.plant=jPe.plant,hOe.prototype.reverse=jPe.reverse,hOe.prototype.toJSON=hOe.prototype.valueOf=hOe.prototype.value=jPe.value,hOe.prototype.first=hOe.prototype.head,WPe&&(hOe.prototype[WPe]=jPe.toIterator);const YPe=()=>{};function JPe(e){return function(...t){return new Promise((function(r,n){const i=e.apply(this,t);i?r(i):n(i)}))}}const XPe=null,ZPe=["createdAt","updatedAt"],QPe=null,eje=null,tje=null;class rje{constructor(e){this.modelService=e}handle(e){if(e.isRemote)return;const t=this.copyAnClean(e);switch(console.log("---",t),t.command){case Bh.INSERT:this.insert(t);break;case Bh.UPDATE:this.update(t);break;case Bh.DELETE:this.delete(t);break;case Bh.UPSERT:this.upsert(t);break;case Bh.BULK_INSERT:this.bulkInsert(t);break;case Bh.MOVE_BEFORE:this.moveBefore(t);break;case Bh.MOVE_AFTER:this.moveAfter(t);break;case Bh.INSERT_BEFORE:this.insertBefore(t);break;case Bh.INSERT_AFTER:this.insertAfter(t);break;default:console.error(`Command '${t.command}' not support in spell process`)}}copyAnClean(e){const t=this.modelService.getModel(e.table),r={...e};if(!t)return r;const n=Object.keys(t.Model.columns);return r.sets&&(Array.isArray(r.sets)?r.sets=r.sets.map((e=>hOe.pick(e,n))):r.sets=hOe.pick(r.sets,n)),r}}const nje=null,ije=null,oje=null,aje=null,sje=null;var lje=(e=>(e.COUNT="count",e.SUM="sum",e.AVERAGE="average",e.MAX="max",e.MIN="mix",e.FILLED="filled",e.EMPTY="empty",e.UNIQUE="unique",e.PERCENT_EMPTY="percentEmpty",e.PERCENT_FILLED="percentFilled",e.PERCENT_UNIQUE="percentUnique",e.EARLIEST_DATE="earliestDate",e.LATEST_DATE="latestDate",e.DATE_RANGE="dateRange",e.MONTH_RANGE="monthRange",e.CHECKED="checked",e.UNCHECKED="unchecked",e.PERCENT_CHECKED="percentChecked",e.PERCENT_UNCHECKED="percentUnchecked",e))(lje||{});const cje=null,uje=null,dje=null,fje=null,hje=null,pje=null;var gje={exports:{}},mje={},vje={},yje={},bje={},_je={},wje={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce(((e,t)=>`${e}${t}`),"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce(((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e)),{})}}function i(e,...t){const r=[e[0]];let i=0;for(;i<t.length;)s(r,t[i]),r.push(e[++i]);return new n(r)}e._Code=n,e.nil=new n(""),e._=i;const o=new n("+");function a(e,...t){const r=[c(e[0])];let i=0;for(;i<t.length;)r.push(o),s(r,t[i]),r.push(o,c(e[++i]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===o){const r=l(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new n(r)}function s(e,t){t instanceof n?e.push(...t._items):t instanceof r?e.push(t):e.push(function(e){return"number"==typeof e||"boolean"==typeof e||null===e?e:c(Array.isArray(e)?e.join(","):e)}(t))}function l(e,t){return'""'===t?e:'""'===e?t:"string"==typeof e?t instanceof r||'"'!==e[e.length-1]?void 0:"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0:"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function c(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=a,e.addCodeArg=s,e.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:a`${e}${t}`},e.stringify=function(e){return new n(c(e))},e.safeStringify=c,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new n(`.${t}`):i`[${t}]`},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new n(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)},e.regexpCode=function(e){return new n(e.toString())}}(wje);var Cje={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=wje;class r extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var n,i;(i=n=e.UsedValueState||(e.UsedValueState={}))[i.Started=0]="Started",i[i.Completed=1]="Completed",e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof t.Name?e:this.name(e)}name(e){return new t.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}e.Scope=o;class a extends t.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=t._`.${new t.Name(r)}[${n}]`}}e.ValueScopeName=a;const s=t._`\n`;e.ValueScope=class extends o{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?s:t.nil}}get(){return this._scope}name(e){return new a(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:i}=n,o=null!==(r=t.key)&&void 0!==r?r:t.ref;let a=this._values[i];if(a){const e=a.get(o);if(e)return e}else a=this._values[i]=new Map;a.set(o,n);const s=this._scope[i]||(this._scope[i]=[]),l=s.length;return s[l]=t.ref,n.setValue(t,{property:i,itemIndex:l}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,r=this._values){return this._reduceValues(r,(r=>{if(void 0===r.scopePath)throw new Error(`CodeGen: name "${r}" has no value`);return t._`${e}${r.scopePath}`}))}scopeCode(e=this._values,t,r){return this._reduceValues(e,(e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code}),t,r)}_reduceValues(i,o,a={},s){let l=t.nil;for(const c in i){const u=i[c];if(!u)continue;const d=a[c]=a[c]||new Map;u.forEach((i=>{if(d.has(i))return;d.set(i,n.Started);let a=o(i);if(a){const r=this.opts.es5?e.varKinds.var:e.varKinds.const;l=t._`${l}${r} ${i} = ${a};${this.opts._n}`}else{if(!(a=null==s?void 0:s(i)))throw new r(i);l=t._`${l}${a}${this.opts._n}`}d.set(i,n.Completed)}))}return l}}}(Cje),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=wje,r=Cje;var n=wje;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var i=Cje;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(e,t){return this}}class a extends o{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const n=e?r.varKinds.var:this.varKind,i=void 0===this.rhs?"":` = ${this.rhs}`;return`${n} ${this.name}${i};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=R(this.rhs,e,t)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class s extends o{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=R(this.rhs,e,r),this}get names(){return I(this.lhs instanceof t.Name?{}:{...this.lhs.names},this.rhs)}}class l extends s{constructor(e,t,r,n){super(e,r,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class c extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class u extends o{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}}class d extends o{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class f extends o{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=R(this.code,e,t),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class h extends o{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce(((t,r)=>t+r.render(e)),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const i=r[n];i.optimizeNames(e,t)||(T(e,i.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce(((e,t)=>O(e,t.names)),{})}}class p extends h{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class g extends h{}class m extends p{}m.kind="else";class v extends p{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new m(e):e}return t?!1===e?t instanceof v?t:t.nodes:this.nodes.length?this:new v(A(e),t instanceof v?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=R(this.condition,e,t),this}get names(){const e=super.names;return I(e,this.condition),this.else&&O(e,this.else.names),e}}v.kind="if";class y extends p{}y.kind="for";class b extends y{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=R(this.iteration,e,t),this}get names(){return O(super.names,this.iteration.names)}}class _ extends y{constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?r.varKinds.var:this.varKind,{name:n,from:i,to:o}=this;return`for(${t} ${n}=${i}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){const e=I(super.names,this.from);return I(e,this.to)}}class w extends y{constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=R(this.iterable,e,t),this}get names(){return O(super.names,this.iterable.names)}}class C extends p{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}C.kind="func";class E extends h{render(e){return"return "+super.render(e)}}E.kind="return";class S extends p{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&O(e,this.catch.names),this.finally&&O(e,this.finally.names),e}}class k extends p{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}k.kind="catch";class x extends p{render(e){return"finally"+super.render(e)}}x.kind="finally";function O(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function I(e,r){return r instanceof t._CodeOrName?O(e,r.names):e}function R(e,r,n){return e instanceof t.Name?o(e):(i=e)instanceof t._Code&&i._items.some((e=>e instanceof t.Name&&1===r[e.str]&&void 0!==n[e.str]))?new t._Code(e._items.reduce(((e,r)=>(r instanceof t.Name&&(r=o(r)),r instanceof t._Code?e.push(...r._items):e.push(r),e)),[])):e;var i;function o(e){const t=n[e.str];return void 0===t||1!==r[e.str]?e:(delete r[e.str],t)}}function T(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function A(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:t._`!${P(e)}`}e.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new g]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const i=this._scope.toName(t);return void 0!==r&&n&&(this._constants[i.str]=r),this._leafNode(new a(e,i,r)),i}const(e,t,n){return this._def(r.varKinds.const,e,t,n)}let(e,t,n){return this._def(r.varKinds.let,e,t,n)}var(e,t,n){return this._def(r.varKinds.var,e,t,n)}assign(e,t,r){return this._leafNode(new s(e,t,r))}add(t,r){return this._leafNode(new l(t,e.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==t.nil&&this._leafNode(new f(e)),this}object(...e){const r=["{"];for(const[n,i]of e)r.length>1&&r.push(","),r.push(n),(n!==i||this.opts.es5)&&(r.push(":"),(0,t.addCodeArg)(r,i));return r.push("}"),new t._Code(r)}if(e,t,r){if(this._blockNode(new v(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new v(e))}else(){return this._elseNode(new m)}endIf(){return this._endBlockNode(v,m)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new b(e),t)}forRange(e,t,n,i,o=(this.opts.es5?r.varKinds.var:r.varKinds.let)){const a=this._scope.toName(e);return this._for(new _(o,a,t,n),(()=>i(a)))}forOf(e,n,i,o=r.varKinds.const){const a=this._scope.toName(e);if(this.opts.es5){const e=n instanceof t.Name?n:this.var("_arr",n);return this.forRange("_i",0,t._`${e}.length`,(r=>{this.var(a,t._`${e}[${r}]`),i(a)}))}return this._for(new w("of",o,a,n),(()=>i(a)))}forIn(e,n,i,o=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,t._`Object.keys(${n})`,i);const a=this._scope.toName(e);return this._for(new w("in",o,a,n),(()=>i(a)))}endFor(){return this._endBlockNode(y)}label(e){return this._leafNode(new c(e))}break(e){return this._leafNode(new u(e))}return(e){const t=new E;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(E)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new S;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new k(e),t(e)}return r&&(this._currNode=n.finally=new x,this.code(r)),this._endBlockNode(k,x)}throw(e){return this._leafNode(new d(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,r=t.nil,n,i){return this._blockNode(new C(e,r,n)),i&&this.code(i).endFunc(),this}endFunc(){return this._endBlockNode(C)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof v))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},e.not=A;const M=D(e.operators.AND);e.and=function(...e){return e.reduce(M)};const N=D(e.operators.OR);function D(e){return(r,n)=>r===t.nil?n:n===t.nil?r:t._`${P(r)} ${e} ${P(n)}`}function P(e){return e instanceof t.Name?e:t._`(${e})`}e.or=function(...e){return e.reduce(N)}}(_je);var Eje={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=_je,r=wje;function n(e,t=e.schema){const{opts:r,self:n}=e;if(!r.strictSchema||"boolean"==typeof t)return;const i=n.RULES.keywords;for(const r in t)i[r]||h(e,`unknown keyword: "${r}"`)}function i(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function o(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function a(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function s({mergeNames:e,mergeToName:r,mergeValues:n,resultToName:i}){return(o,a,s,l)=>{const c=void 0===s?a:s instanceof t.Name?(a instanceof t.Name?e(o,a,s):r(o,a,s),s):a instanceof t.Name?(r(o,s,a),a):n(a,s);return l!==t.Name||c instanceof t.Name?c:i(o,c)}}function l(e,r){if(!0===r)return e.var("props",!0);const n=e.var("props",t._`{}`);return void 0!==r&&c(e,n,r),n}function c(e,r,n){Object.keys(n).forEach((n=>e.assign(t._`${r}${(0,t.getProperty)(n)}`,!0)))}e.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},e.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(n(e,t),!i(t,e.self.RULES.all))},e.checkUnknownRules=n,e.schemaHasRules=i,e.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},e.schemaRefOrVal=function({topSchemaRef:e,schemaPath:r},n,i,o){if(!o){if("number"==typeof n||"boolean"==typeof n)return n;if("string"==typeof n)return t._`${n}`}return t._`${e}${r}${(0,t.getProperty)(i)}`},e.unescapeFragment=function(e){return a(decodeURIComponent(e))},e.escapeFragment=function(e){return encodeURIComponent(o(e))},e.escapeJsonPointer=o,e.unescapeJsonPointer=a,e.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},e.mergeEvaluated={props:s({mergeNames:(e,r,n)=>e.if(t._`${n} !== true && ${r} !== undefined`,(()=>{e.if(t._`${r} === true`,(()=>e.assign(n,!0)),(()=>e.assign(n,t._`${n} || {}`).code(t._`Object.assign(${n}, ${r})`)))})),mergeToName:(e,r,n)=>e.if(t._`${n} !== true`,(()=>{!0===r?e.assign(n,!0):(e.assign(n,t._`${n} || {}`),c(e,n,r))})),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:l}),items:s({mergeNames:(e,r,n)=>e.if(t._`${n} !== true && ${r} !== undefined`,(()=>e.assign(n,t._`${r} === true ? true : ${n} > ${r} ? ${n} : ${r}`))),mergeToName:(e,r,n)=>e.if(t._`${n} !== true`,(()=>e.assign(n,!0===r||t._`${n} > ${r} ? ${n} : ${r}`))),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},e.evaluatedPropsToName=l,e.setEvaluated=c;const u={};var d,f;function h(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}e.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:u[t.code]||(u[t.code]=new r._Code(t.code))})},(f=d=e.Type||(e.Type={}))[f.Num=0]="Num",f[f.Str=1]="Str",e.getErrorPath=function(e,r,n){if(e instanceof t.Name){const i=r===d.Num;return n?i?t._`"[" + ${e} + "]"`:t._`"['" + ${e} + "']"`:i?t._`"/" + ${e}`:t._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return n?(0,t.getProperty)(e).toString():"/"+o(e)},e.checkStrictMode=h}(Eje);var Sje={};Object.defineProperty(Sje,"__esModule",{value:!0});const kje=_je,xje={data:new kje.Name("data"),valCxt:new kje.Name("valCxt"),instancePath:new kje.Name("instancePath"),parentData:new kje.Name("parentData"),parentDataProperty:new kje.Name("parentDataProperty"),rootData:new kje.Name("rootData"),dynamicAnchors:new kje.Name("dynamicAnchors"),vErrors:new kje.Name("vErrors"),errors:new kje.Name("errors"),this:new kje.Name("this"),self:new kje.Name("self"),scope:new kje.Name("scope"),json:new kje.Name("json"),jsonPos:new kje.Name("jsonPos"),jsonLen:new kje.Name("jsonLen"),jsonPart:new kje.Name("jsonPart")};Sje.default=xje,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=_je,r=Eje,n=Sje;function i(e,r){const i=e.const("err",r);e.if(t._`${n.default.vErrors} === null`,(()=>e.assign(n.default.vErrors,t._`[${i}]`)),t._`${n.default.vErrors}.push(${i})`),e.code(t._`${n.default.errors}++`)}function o(e,r){const{gen:n,validateName:i,schemaEnv:o}=e;o.$async?n.throw(t._`new ${e.ValidationError}(${r})`):(n.assign(t._`${i}.errors`,r),n.return(!1))}e.keywordError={message:({keyword:e})=>t.str`must pass "${e}" keyword validation`},e.keyword$DataError={message:({keyword:e,schemaType:r})=>r?t.str`"${e}" keyword must be ${r} ($data)`:t.str`"${e}" keyword is invalid ($data)`},e.reportError=function(r,n=e.keywordError,a,l){const{it:c}=r,{gen:u,compositeRule:d,allErrors:f}=c,h=s(r,n,a);(null!=l?l:d||f)?i(u,h):o(c,t._`[${h}]`)},e.reportExtraError=function(t,r=e.keywordError,a){const{it:l}=t,{gen:c,compositeRule:u,allErrors:d}=l;i(c,s(t,r,a)),u||d||o(l,n.default.vErrors)},e.resetErrorsCount=function(e,r){e.assign(n.default.errors,r),e.if(t._`${n.default.vErrors} !== null`,(()=>e.if(r,(()=>e.assign(t._`${n.default.vErrors}.length`,r)),(()=>e.assign(n.default.vErrors,null)))))},e.extendErrors=function({gen:e,keyword:r,schemaValue:i,data:o,errsCount:a,it:s}){if(void 0===a)throw new Error("ajv implementation error");const l=e.name("err");e.forRange("i",a,n.default.errors,(a=>{e.const(l,t._`${n.default.vErrors}[${a}]`),e.if(t._`${l}.instancePath === undefined`,(()=>e.assign(t._`${l}.instancePath`,(0,t.strConcat)(n.default.instancePath,s.errorPath)))),e.assign(t._`${l}.schemaPath`,t.str`${s.errSchemaPath}/${r}`),s.opts.verbose&&(e.assign(t._`${l}.schema`,i),e.assign(t._`${l}.data`,o))}))};const a={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function s(e,r,i){const{createErrors:o}=e.it;return!1===o?t._`{}`:function(e,r,i={}){const{gen:o,it:s}=e,u=[l(s,i),c(e,i)];return function(e,{params:r,message:i},o){const{keyword:s,data:l,schemaValue:c,it:u}=e,{opts:d,propertyName:f,topSchemaRef:h,schemaPath:p}=u;o.push([a.keyword,s],[a.params,"function"==typeof r?r(e):r||t._`{}`]),d.messages&&o.push([a.message,"function"==typeof i?i(e):i]),d.verbose&&o.push([a.schema,c],[a.parentSchema,t._`${h}${p}`],[n.default.data,l]),f&&o.push([a.propertyName,f])}(e,r,u),o.object(...u)}(e,r,i)}function l({errorPath:e},{instancePath:i}){const o=i?t.str`${e}${(0,r.getErrorPath)(i,r.Type.Str)}`:e;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,o)]}function c({keyword:e,it:{errSchemaPath:n}},{schemaPath:i,parentSchema:o}){let s=o?n:t.str`${n}/${e}`;return i&&(s=t.str`${s}${(0,r.getErrorPath)(i,r.Type.Str)}`),[a.schemaPath,s]}}(bje),Object.defineProperty(yje,"__esModule",{value:!0}),yje.boolOrEmptySchema=yje.topBoolOrEmptySchema=void 0;const Oje=bje,Ije=_je,Rje=Sje,Tje={message:"boolean schema is false"};function Aje(e,t){const{gen:r,data:n}=e,i={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,Oje.reportError)(i,Tje,void 0,t)}yje.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?Aje(e,!1):"object"==typeof r&&!0===r.$async?t.return(Rje.default.data):(t.assign(Ije._`${n}.errors`,null),t.return(!0))},yje.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),Aje(e)):r.var(t,!0)};var Mje={},Nje={};Object.defineProperty(Nje,"__esModule",{value:!0}),Nje.getRules=Nje.isJSONType=void 0;const Dje=new Set(["string","number","integer","boolean","null","object","array"]);Nje.isJSONType=function(e){return"string"==typeof e&&Dje.has(e)},Nje.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var Pje={};function jje(e,t){return t.rules.some((t=>Fje(e,t)))}function Fje(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some((t=>void 0!==e[t])))}Object.defineProperty(Pje,"__esModule",{value:!0}),Pje.shouldUseRule=Pje.shouldUseGroup=Pje.schemaHasRulesForType=void 0,Pje.schemaHasRulesForType=function({schema:e,self:t},r){const n=t.RULES.types[r];return n&&!0!==n&&jje(e,n)},Pje.shouldUseGroup=jje,Pje.shouldUseRule=Fje,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=Nje,r=Pje,n=bje,i=_je,o=Eje;var a,s;function l(e){const r=Array.isArray(e)?e:e?[e]:[];if(r.every(t.isJSONType))return r;throw new Error("type must be JSONType or JSONType[]: "+r.join(","))}(s=a=e.DataType||(e.DataType={}))[s.Correct=0]="Correct",s[s.Wrong=1]="Wrong",e.getSchemaTypes=function(e){const t=l(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},e.getJSONTypes=l,e.coerceAndCheckDataType=function(e,t){const{gen:n,data:o,opts:s}=e,l=function(e,t){return t?e.filter((e=>c.has(e)||"array"===t&&"array"===e)):[]}(t,s.coerceTypes),u=t.length>0&&!(0===l.length&&1===t.length&&(0,r.schemaHasRulesForType)(e,t[0]));if(u){const r=d(t,o,s.strictNumbers,a.Wrong);n.if(r,(()=>{l.length?function(e,t,r){const{gen:n,data:o,opts:a}=e,s=n.let("dataType",i._`typeof ${o}`),l=n.let("coerced",i._`undefined`);"array"===a.coerceTypes&&n.if(i._`${s} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,(()=>n.assign(o,i._`${o}[0]`).assign(s,i._`typeof ${o}`).if(d(t,o,a.strictNumbers),(()=>n.assign(l,o))))),n.if(i._`${l} !== undefined`);for(const e of r)(c.has(e)||"array"===e&&"array"===a.coerceTypes)&&u(e);function u(e){switch(e){case"string":return void n.elseIf(i._`${s} == "number" || ${s} == "boolean"`).assign(l,i._`"" + ${o}`).elseIf(i._`${o} === null`).assign(l,i._`""`);case"number":return void n.elseIf(i._`${s} == "boolean" || ${o} === null
              || (${s} == "string" && ${o} && ${o} == +${o})`).assign(l,i._`+${o}`);case"integer":return void n.elseIf(i._`${s} === "boolean" || ${o} === null
              || (${s} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(l,i._`+${o}`);case"boolean":return void n.elseIf(i._`${o} === "false" || ${o} === 0 || ${o} === null`).assign(l,!1).elseIf(i._`${o} === "true" || ${o} === 1`).assign(l,!0);case"null":return n.elseIf(i._`${o} === "" || ${o} === 0 || ${o} === false`),void n.assign(l,null);case"array":n.elseIf(i._`${s} === "string" || ${s} === "number"
              || ${s} === "boolean" || ${o} === null`).assign(l,i._`[${o}]`)}}n.else(),h(e),n.endIf(),n.if(i._`${l} !== undefined`,(()=>{n.assign(o,l),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(i._`${t} !== undefined`,(()=>e.assign(i._`${t}[${r}]`,n)))}(e,l)}))}(e,t,l):h(e)}))}return u};const c=new Set(["string","number","integer","boolean","null"]);function u(e,t,r,n=a.Correct){const o=n===a.Correct?i.operators.EQ:i.operators.NEQ;let s;switch(e){case"null":return i._`${t} ${o} null`;case"array":s=i._`Array.isArray(${t})`;break;case"object":s=i._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":s=l(i._`!(${t} % 1) && !isNaN(${t})`);break;case"number":s=l();break;default:return i._`typeof ${t} ${o} ${e}`}return n===a.Correct?s:(0,i.not)(s);function l(e=i.nil){return(0,i.and)(i._`typeof ${t} == "number"`,e,r?i._`isFinite(${t})`:i.nil)}}function d(e,t,r,n){if(1===e.length)return u(e[0],t,r,n);let a;const s=(0,o.toHash)(e);if(s.array&&s.object){const e=i._`typeof ${t} != "object"`;a=s.null?e:i._`!${t} || ${e}`,delete s.null,delete s.array,delete s.object}else a=i.nil;s.number&&delete s.integer;for(const e in s)a=(0,i.and)(a,u(e,t,r,n));return a}e.checkDataType=u,e.checkDataTypes=d;const f={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?i._`{type: ${e}}`:i._`{type: ${t}}`};function h(e){const t=function(e){const{gen:t,data:r,schema:n}=e,i=(0,o.schemaRefOrVal)(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:i,schemaValue:i,parentSchema:n,params:{},it:e}}(e);(0,n.reportError)(t,f)}e.reportTypeError=h}(Mje);var Vje={};Object.defineProperty(Vje,"__esModule",{value:!0}),Vje.assignDefaults=void 0;const Lje=_je,$je=Eje;function Bje(e,t,r){const{gen:n,compositeRule:i,data:o,opts:a}=e;if(void 0===r)return;const s=Lje._`${o}${(0,Lje.getProperty)(t)}`;if(i)return void(0,$je.checkStrictMode)(e,`default is ignored for: ${s}`);let l=Lje._`${s} === undefined`;"empty"===a.useDefaults&&(l=Lje._`${l} || ${s} === null || ${s} === ""`),n.if(l,Lje._`${s} = ${(0,Lje.stringify)(r)}`)}Vje.assignDefaults=function(e,t){const{properties:r,items:n}=e.schema;if("object"===t&&r)for(const t in r)Bje(e,t,r[t].default);else"array"===t&&Array.isArray(n)&&n.forEach(((t,r)=>Bje(e,r,t.default)))};var Uje={},zje={};Object.defineProperty(zje,"__esModule",{value:!0}),zje.validateUnion=zje.validateArray=zje.usePattern=zje.callValidateCode=zje.schemaProperties=zje.allSchemaProperties=zje.noPropertyInData=zje.propertyInData=zje.isOwnProperty=zje.hasPropFunc=zje.reportMissingProp=zje.checkMissingProp=zje.checkReportMissingProp=void 0;const Hje=_je,Wje=Eje,Gje=Sje,Kje=Eje;function qje(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:Hje._`Object.prototype.hasOwnProperty`})}function Yje(e,t,r){return Hje._`${qje(e)}.call(${t}, ${r})`}function Jje(e,t,r,n){const i=Hje._`${t}${(0,Hje.getProperty)(r)} === undefined`;return n?(0,Hje.or)(i,(0,Hje.not)(Yje(e,t,r))):i}function Xje(e){return e?Object.keys(e).filter((e=>"__proto__"!==e)):[]}zje.checkReportMissingProp=function(e,t){const{gen:r,data:n,it:i}=e;r.if(Jje(r,n,t,i.opts.ownProperties),(()=>{e.setParams({missingProperty:Hje._`${t}`},!0),e.error()}))},zje.checkMissingProp=function({gen:e,data:t,it:{opts:r}},n,i){return(0,Hje.or)(...n.map((n=>(0,Hje.and)(Jje(e,t,n,r.ownProperties),Hje._`${i} = ${n}`))))},zje.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},zje.hasPropFunc=qje,zje.isOwnProperty=Yje,zje.propertyInData=function(e,t,r,n){const i=Hje._`${t}${(0,Hje.getProperty)(r)} !== undefined`;return n?Hje._`${i} && ${Yje(e,t,r)}`:i},zje.noPropertyInData=Jje,zje.allSchemaProperties=Xje,zje.schemaProperties=function(e,t){return Xje(t).filter((r=>!(0,Wje.alwaysValidSchema)(e,t[r])))},zje.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:i,errorPath:o},it:a},s,l,c){const u=c?Hje._`${e}, ${t}, ${n}${i}`:t,d=[[Gje.default.instancePath,(0,Hje.strConcat)(Gje.default.instancePath,o)],[Gje.default.parentData,a.parentData],[Gje.default.parentDataProperty,a.parentDataProperty],[Gje.default.rootData,Gje.default.rootData]];a.opts.dynamicRef&&d.push([Gje.default.dynamicAnchors,Gje.default.dynamicAnchors]);const f=Hje._`${u}, ${r.object(...d)}`;return l!==Hje.nil?Hje._`${s}.call(${l}, ${f})`:Hje._`${s}(${f})`};const Zje=Hje._`new RegExp`;zje.usePattern=function({gen:e,it:{opts:t}},r){const n=t.unicodeRegExp?"u":"",{regExp:i}=t.code,o=i(r,n);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:Hje._`${"new RegExp"===i.code?Zje:(0,Kje.useFunc)(e,i)}(${r}, ${n})`})},zje.validateArray=function(e){const{gen:t,data:r,keyword:n,it:i}=e,o=t.name("valid");if(i.allErrors){const e=t.let("valid",!0);return a((()=>t.assign(e,!1))),e}return t.var(o,!0),a((()=>t.break())),o;function a(i){const a=t.const("len",Hje._`${r}.length`);t.forRange("i",0,a,(r=>{e.subschema({keyword:n,dataProp:r,dataPropType:Wje.Type.Num},o),t.if((0,Hje.not)(o),i)}))}},zje.validateUnion=function(e){const{gen:t,schema:r,keyword:n,it:i}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some((e=>(0,Wje.alwaysValidSchema)(i,e)))&&!i.opts.unevaluated)return;const o=t.let("valid",!1),a=t.name("_valid");t.block((()=>r.forEach(((r,i)=>{const s=e.subschema({keyword:n,schemaProp:i,compositeRule:!0},a);t.assign(o,Hje._`${o} || ${a}`),e.mergeValidEvaluated(s,a)||t.if((0,Hje.not)(o))})))),e.result(o,(()=>e.reset()),(()=>e.error(!0)))},Object.defineProperty(Uje,"__esModule",{value:!0}),Uje.validateKeywordUsage=Uje.validSchemaType=Uje.funcKeywordCode=Uje.macroKeywordCode=void 0;const Qje=_je,eFe=Sje,tFe=zje,rFe=bje;function nFe(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,(()=>t.assign(r,Qje._`${n.parentData}[${n.parentDataProperty}]`)))}function iFe(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,Qje.stringify)(r)})}Uje.macroKeywordCode=function(e,t){const{gen:r,keyword:n,schema:i,parentSchema:o,it:a}=e,s=t.macro.call(a.self,i,o,a),l=iFe(r,n,s);!1!==a.opts.validateSchema&&a.self.validateSchema(s,!0);const c=r.name("valid");e.subschema({schema:s,schemaPath:Qje.nil,errSchemaPath:`${a.errSchemaPath}/${n}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,(()=>e.error(!0)))},Uje.funcKeywordCode=function(e,t){var r;const{gen:n,keyword:i,schema:o,parentSchema:a,$data:s,it:l}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(l,t);const c=!s&&t.compile?t.compile.call(l.self,o,a,l):t.validate,u=iFe(n,i,c),d=n.let("valid");function f(r=(t.async?Qje._`await `:Qje.nil)){const i=l.opts.passContext?eFe.default.this:eFe.default.self,o=!("compile"in t&&!s||!1===t.schema);n.assign(d,Qje._`${r}${(0,tFe.callValidateCode)(e,u,i,o)}`,t.modifying)}function h(e){var r;n.if((0,Qje.not)(null!==(r=t.valid)&&void 0!==r?r:d),e)}e.block$data(d,(function(){if(!1===t.errors)f(),t.modifying&&nFe(e),h((()=>e.error()));else{const r=t.async?function(){const e=n.let("ruleErrs",null);return n.try((()=>f(Qje._`await `)),(t=>n.assign(d,!1).if(Qje._`${t} instanceof ${l.ValidationError}`,(()=>n.assign(e,Qje._`${t}.errors`)),(()=>n.throw(t))))),e}():function(){const e=Qje._`${u}.errors`;return n.assign(e,null),f(Qje.nil),e}();t.modifying&&nFe(e),h((()=>function(e,t){const{gen:r}=e;r.if(Qje._`Array.isArray(${t})`,(()=>{r.assign(eFe.default.vErrors,Qje._`${eFe.default.vErrors} === null ? ${t} : ${eFe.default.vErrors}.concat(${t})`).assign(eFe.default.errors,Qje._`${eFe.default.vErrors}.length`),(0,rFe.extendErrors)(e)}),(()=>e.error()))}(e,r)))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:d)},Uje.validSchemaType=function(e,t,r=!1){return!t.length||t.some((t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&typeof e>"u"))},Uje.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:n},i,o){if(Array.isArray(i.keyword)?!i.keyword.includes(o):i.keyword!==o)throw new Error("ajv implementation error");const a=i.dependencies;if(null!=a&&a.some((t=>!Object.prototype.hasOwnProperty.call(e,t))))throw new Error(`parent schema must have dependencies of ${o}: ${a.join(",")}`);if(i.validateSchema&&!i.validateSchema(e[o])){const e=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(i.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}};var oFe={};Object.defineProperty(oFe,"__esModule",{value:!0}),oFe.extendSubschemaMode=oFe.extendSubschemaData=oFe.getSubschema=void 0;const aFe=_je,sFe=Eje;oFe.getSubschema=function(e,{keyword:t,schemaProp:r,schema:n,schemaPath:i,errSchemaPath:o,topSchemaRef:a}){if(void 0!==t&&void 0!==n)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const n=e.schema[t];return void 0===r?{schema:n,schemaPath:aFe._`${e.schemaPath}${(0,aFe.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:n[r],schemaPath:aFe._`${e.schemaPath}${(0,aFe.getProperty)(t)}${(0,aFe.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,sFe.escapeFragment)(r)}`}}if(void 0!==n){if(void 0===i||void 0===o||void 0===a)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:i,topSchemaRef:a,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')},oFe.extendSubschemaData=function(e,t,{dataProp:r,dataPropType:n,data:i,dataTypes:o,propertyName:a}){if(void 0!==i&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:s}=t;if(void 0!==r){const{errorPath:i,dataPathArr:o,opts:a}=t;l(s.let("data",aFe._`${t.data}${(0,aFe.getProperty)(r)}`,!0)),e.errorPath=aFe.str`${i}${(0,sFe.getErrorPath)(r,n,a.jsPropertySyntax)}`,e.parentDataProperty=aFe._`${r}`,e.dataPathArr=[...o,e.parentDataProperty]}if(void 0!==i){l(i instanceof aFe.Name?i:s.let("data",i,!0)),void 0!==a&&(e.propertyName=a)}function l(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}o&&(e.dataTypes=o)},oFe.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:i,allErrors:o}){void 0!==n&&(e.compositeRule=n),void 0!==i&&(e.createErrors=i),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r};var lFe={},cFe=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var a=o[i];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r},uFe={exports:{}},dFe=uFe.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),fFe(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function fFe(e,t,r,n,i,o,a,s,l,c){if(n&&"object"==typeof n&&!Array.isArray(n)){for(var u in t(n,i,o,a,s,l,c),n){var d=n[u];if(Array.isArray(d)){if(u in dFe.arrayKeywords)for(var f=0;f<d.length;f++)fFe(e,t,r,d[f],i+"/"+u+"/"+f,o,i,u,n,f)}else if(u in dFe.propsKeywords){if(d&&"object"==typeof d)for(var h in d)fFe(e,t,r,d[h],i+"/"+u+"/"+hFe(h),o,i,u,n,h)}else(u in dFe.keywords||e.allKeys&&!(u in dFe.skipKeywords))&&fFe(e,t,r,d,i+"/"+u,o,i,u,n)}r(n,i,o,a,s,l,c)}}function hFe(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}dFe.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},dFe.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},dFe.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},dFe.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0},Object.defineProperty(lFe,"__esModule",{value:!0}),lFe.getSchemaRefs=lFe.resolveUrl=lFe.normalizeId=lFe._getFullPath=lFe.getFullPath=lFe.inlineRef=void 0;const pFe=Eje,gFe=cFe,mFe=uFe.exports,vFe=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);lFe.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!bFe(e):!!t&&_Fe(e)<=t)};const yFe=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function bFe(e){for(const t in e){if(yFe.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(bFe)||"object"==typeof r&&bFe(r))return!0}return!1}function _Fe(e){let t=0;for(const r in e)if("$ref"===r||(t++,!vFe.has(r)&&("object"==typeof e[r]&&(0,pFe.eachItem)(e[r],(e=>t+=_Fe(e))),t===1/0)))return 1/0;return t}function wFe(e,t="",r){!1!==r&&(t=SFe(t));const n=e.parse(t);return CFe(e,n)}function CFe(e,t){return e.serialize(t).split("#")[0]+"#"}lFe.getFullPath=wFe,lFe._getFullPath=CFe;const EFe=/#\/?$/;function SFe(e){return e?e.replace(EFe,""):""}lFe.normalizeId=SFe,lFe.resolveUrl=function(e,t,r){return r=SFe(r),e.resolve(t,r)};const kFe=/^[a-z_][-a-z0-9._]*$/i;lFe.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:r,uriResolver:n}=this.opts,i=SFe(e[r]||t),o={"":i},a=wFe(n,i,!1),s={},l=new Set;return mFe(e,{allKeys:!0},((e,t,n,i)=>{if(void 0===i)return;const d=a+t;let f=o[i];function h(t){const r=this.opts.uriResolver.resolve;if(t=SFe(f?r(f,t):t),l.has(t))throw u(t);l.add(t);let n=this.refs[t];return"string"==typeof n&&(n=this.refs[n]),"object"==typeof n?c(e,n.schema,t):t!==SFe(d)&&("#"===t[0]?(c(e,s[t],t),s[t]=e):this.refs[t]=d),t}function p(e){if("string"==typeof e){if(!kFe.test(e))throw new Error(`invalid anchor "${e}"`);h.call(this,`#${e}`)}}"string"==typeof e[r]&&(f=h.call(this,e[r])),p.call(this,e.$anchor),p.call(this,e.$dynamicAnchor),o[t]=f})),s;function c(e,t,r){if(void 0!==t&&!gFe(e,t))throw u(r)}function u(e){return new Error(`reference "${e}" resolves to more than one schema`)}},Object.defineProperty(vje,"__esModule",{value:!0}),vje.getData=vje.KeywordCxt=vje.validateFunctionCode=void 0;const xFe=yje,OFe=Mje,IFe=Pje,RFe=Mje,TFe=Vje,AFe=Uje,MFe=oFe,NFe=_je,DFe=Sje,PFe=lFe,jFe=Eje,FFe=bje;function VFe({gen:e,validateName:t,schema:r,schemaEnv:n,opts:i},o){i.code.es5?e.func(t,NFe._`${DFe.default.data}, ${DFe.default.valCxt}`,n.$async,(()=>{e.code(NFe._`"use strict"; ${LFe(r,i)}`),function(e,t){e.if(DFe.default.valCxt,(()=>{e.var(DFe.default.instancePath,NFe._`${DFe.default.valCxt}.${DFe.default.instancePath}`),e.var(DFe.default.parentData,NFe._`${DFe.default.valCxt}.${DFe.default.parentData}`),e.var(DFe.default.parentDataProperty,NFe._`${DFe.default.valCxt}.${DFe.default.parentDataProperty}`),e.var(DFe.default.rootData,NFe._`${DFe.default.valCxt}.${DFe.default.rootData}`),t.dynamicRef&&e.var(DFe.default.dynamicAnchors,NFe._`${DFe.default.valCxt}.${DFe.default.dynamicAnchors}`)}),(()=>{e.var(DFe.default.instancePath,NFe._`""`),e.var(DFe.default.parentData,NFe._`undefined`),e.var(DFe.default.parentDataProperty,NFe._`undefined`),e.var(DFe.default.rootData,DFe.default.data),t.dynamicRef&&e.var(DFe.default.dynamicAnchors,NFe._`{}`)}))}(e,i),e.code(o)})):e.func(t,NFe._`${DFe.default.data}, ${function(e){return NFe._`{${DFe.default.instancePath}="", ${DFe.default.parentData}, ${DFe.default.parentDataProperty}, ${DFe.default.rootData}=${DFe.default.data}${e.dynamicRef?NFe._`, ${DFe.default.dynamicAnchors}={}`:NFe.nil}}={}`}(i)}`,n.$async,(()=>e.code(LFe(r,i)).code(o)))}function LFe(e,t){const r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?NFe._`/*# sourceURL=${r} */`:NFe.nil}function $Fe(e,t){UFe(e)&&(zFe(e),BFe(e))?function(e,t){const{schema:r,gen:n,opts:i}=e;i.$comment&&r.$comment&&WFe(e),function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,PFe.resolveUrl)(e.opts.uriResolver,e.baseId,t))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=n.const("_errs",DFe.default.errors);HFe(e,o),n.var(t,NFe._`${o} === ${DFe.default.errors}`)}(e,t):(0,xFe.boolOrEmptySchema)(e,t)}function BFe({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function UFe(e){return"boolean"!=typeof e.schema}function zFe(e){(0,jFe.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:i}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,jFe.schemaHasRulesButRef)(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function HFe(e,t){if(e.opts.jtd)return GFe(e,[],!1,t);const r=(0,OFe.getSchemaTypes)(e.schema);GFe(e,r,!(0,OFe.coerceAndCheckDataType)(e,r),t)}function WFe({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:i}){const o=r.$comment;if(!0===i.$comment)e.code(NFe._`${DFe.default.self}.logger.log(${o})`);else if("function"==typeof i.$comment){const r=NFe.str`${n}/$comment`,i=e.scopeValue("root",{ref:t.root});e.code(NFe._`${DFe.default.self}.opts.$comment(${o}, ${r}, ${i}.schema)`)}}function GFe(e,t,r,n){const{gen:i,schema:o,data:a,allErrors:s,opts:l,self:c}=e,{RULES:u}=c;function d(c){!(0,IFe.shouldUseGroup)(o,c)||(c.type?(i.if((0,RFe.checkDataType)(c.type,a,l.strictNumbers)),KFe(e,c),1===t.length&&t[0]===c.type&&r&&(i.else(),(0,RFe.reportTypeError)(e)),i.endIf()):KFe(e,c),s||i.if(NFe._`${DFe.default.errors} === ${n||0}`))}!o.$ref||!l.ignoreKeywordsWithRef&&(0,jFe.schemaHasRulesButRef)(o,u)?(l.jtd||function(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(function(e,t){if(t.length){if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach((t=>{YFe(e.dataTypes,t)||JFe(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)})),function(e,t){const r=[];for(const n of e.dataTypes)YFe(t,n)?r.push(n):t.includes("integer")&&"number"===n&&r.push("integer");e.dataTypes=r}(e,t)}}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&JFe(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){const r=e.self.RULES.all;for(const n in r){const i=r[n];if("object"==typeof i&&(0,IFe.shouldUseRule)(e.schema,i)){const{type:r}=i.definition;r.length&&!r.some((e=>qFe(t,e)))&&JFe(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),i.block((()=>{for(const e of u.rules)d(e);d(u.post)}))):i.block((()=>ZFe(e,"$ref",u.all.$ref.definition)))}function KFe(e,t){const{gen:r,schema:n,opts:{useDefaults:i}}=e;i&&(0,TFe.assignDefaults)(e,t.type),r.block((()=>{for(const r of t.rules)(0,IFe.shouldUseRule)(n,r)&&ZFe(e,r.keyword,r.definition,t.type)}))}function qFe(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function YFe(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function JFe(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,jFe.checkStrictMode)(e,t,e.opts.strictTypes)}vje.validateFunctionCode=function(e){UFe(e)&&(zFe(e),BFe(e))?function(e){const{schema:t,opts:r,gen:n}=e;VFe(e,(()=>{r.$comment&&t.$comment&&WFe(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,jFe.checkStrictMode)(e,"default is ignored in the schema root")}(e),n.let(DFe.default.vErrors,null),n.let(DFe.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",NFe._`${r}.evaluated`),t.if(NFe._`${e.evaluated}.dynamicProps`,(()=>t.assign(NFe._`${e.evaluated}.props`,NFe._`undefined`))),t.if(NFe._`${e.evaluated}.dynamicItems`,(()=>t.assign(NFe._`${e.evaluated}.items`,NFe._`undefined`)))}(e),HFe(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:i,opts:o}=e;r.$async?t.if(NFe._`${DFe.default.errors} === 0`,(()=>t.return(DFe.default.data)),(()=>t.throw(NFe._`new ${i}(${DFe.default.vErrors})`))):(t.assign(NFe._`${n}.errors`,DFe.default.vErrors),o.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof NFe.Name&&e.assign(NFe._`${t}.props`,r),n instanceof NFe.Name&&e.assign(NFe._`${t}.items`,n)}(e),t.return(NFe._`${DFe.default.errors} === 0`))}(e)}))}(e):VFe(e,(()=>(0,xFe.topBoolOrEmptySchema)(e)))};class XFe{constructor(e,t,r){if((0,AFe.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,jFe.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",tVe(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,AFe.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",DFe.default.errors))}result(e,t,r){this.failResult((0,NFe.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,NFe.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(NFe._`${t} !== undefined && (${(0,NFe.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?FFe.reportExtraError:FFe.reportError)(this,this.def.error,t)}$dataError(){(0,FFe.reportError)(this,this.def.$dataError||FFe.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,FFe.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=NFe.nil){this.gen.block((()=>{this.check$data(e,r),t()}))}check$data(e=NFe.nil,t=NFe.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:i,def:o}=this;r.if((0,NFe.or)(NFe._`${n} === undefined`,t)),e!==NFe.nil&&r.assign(e,!0),(i.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==NFe.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:n,it:i}=this;return(0,NFe.or)(function(){if(r.length){if(!(t instanceof NFe.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return NFe._`${(0,RFe.checkDataTypes)(e,t,i.opts.strictNumbers,RFe.DataType.Wrong)}`}return NFe.nil}(),function(){if(n.validateSchema){const r=e.scopeValue("validate$data",{ref:n.validateSchema});return NFe._`!${r}(${t})`}return NFe.nil}())}subschema(e,t){const r=(0,MFe.getSubschema)(this.it,e);(0,MFe.extendSubschemaData)(r,this.it,e),(0,MFe.extendSubschemaMode)(r,e);const n={...this.it,...r,items:void 0,props:void 0};return $Fe(n,t),n}mergeEvaluated(e,t){const{it:r,gen:n}=this;!r.opts.unevaluated||(!0!==r.props&&void 0!==e.props&&(r.props=jFe.mergeEvaluated.props(n,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=jFe.mergeEvaluated.items(n,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,(()=>this.mergeEvaluated(e,NFe.Name))),!0}}function ZFe(e,t,r,n){const i=new XFe(e,r,t);"code"in r?r.code(i,n):i.$data&&r.validate?(0,AFe.funcKeywordCode)(i,r):"macro"in r?(0,AFe.macroKeywordCode)(i,r):(r.compile||r.validate)&&(0,AFe.funcKeywordCode)(i,r)}vje.KeywordCxt=XFe;const QFe=/^\/(?:[^~]|~0|~1)*$/,eVe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function tVe(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let i,o;if(""===e)return DFe.default.rootData;if("/"===e[0]){if(!QFe.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);i=e,o=DFe.default.rootData}else{const a=eVe.exec(e);if(!a)throw new Error(`Invalid JSON-pointer: ${e}`);const s=+a[1];if(i=a[2],"#"===i){if(s>=t)throw new Error(l("property/index",s));return n[t-s]}if(s>t)throw new Error(l("data",s));if(o=r[t-s],!i)return o}let a=o;const s=i.split("/");for(const e of s)e&&(o=NFe._`${o}${(0,NFe.getProperty)((0,jFe.unescapeJsonPointer)(e))}`,a=NFe._`${a} && ${o}`);return a;function l(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}vje.getData=tVe;var rVe={};Object.defineProperty(rVe,"__esModule",{value:!0});class nVe extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}rVe.default=nVe;var iVe={};Object.defineProperty(iVe,"__esModule",{value:!0});const oVe=lFe;class aVe extends Error{constructor(e,t,r,n){super(n||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,oVe.resolveUrl)(e,t,r),this.missingSchema=(0,oVe.normalizeId)((0,oVe.getFullPath)(e,this.missingRef))}}iVe.default=aVe;var sVe={};Object.defineProperty(sVe,"__esModule",{value:!0}),sVe.resolveSchema=sVe.getCompilingSchema=sVe.resolveRef=sVe.compileSchema=sVe.SchemaEnv=void 0;const lVe=_je,cVe=rVe,uVe=Sje,dVe=lFe,fVe=Eje,hVe=vje;class pVe{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,dVe.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function gVe(e){const t=vVe.call(this,e);if(t)return t;const r=(0,dVe.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:i}=this.opts.code,{ownProperties:o}=this.opts,a=new lVe.CodeGen(this.scope,{es5:n,lines:i,ownProperties:o});let s;e.$async&&(s=a.scopeValue("Error",{ref:cVe.default,code:lVe._`require("ajv/dist/runtime/validation_error").default`}));const l=a.scopeName("validate");e.validateName=l;const c={gen:a,allErrors:this.opts.allErrors,data:uVe.default.data,parentData:uVe.default.parentData,parentDataProperty:uVe.default.parentDataProperty,dataNames:[uVe.default.data],dataPathArr:[lVe.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:a.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,lVe.stringify)(e.schema)}:{ref:e.schema}),validateName:l,ValidationError:s,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:lVe.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:lVe._`""`,opts:this.opts,self:this};let u;try{this._compilations.add(e),(0,hVe.validateFunctionCode)(c),a.optimize(this.opts.code.optimize);const t=a.toString();u=`${a.scopeRefs(uVe.default.scope)}return ${t}`,this.opts.code.process&&(u=this.opts.code.process(u,e));const r=new Function(`${uVe.default.self}`,`${uVe.default.scope}`,u)(this,this.scope.get());if(this.scope.value(l,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:l,validateCode:t,scopeValues:a._values}),this.opts.unevaluated){const{props:e,items:t}=c;r.evaluated={props:e instanceof lVe.Name?void 0:e,items:t instanceof lVe.Name?void 0:t,dynamicProps:e instanceof lVe.Name,dynamicItems:t instanceof lVe.Name},r.source&&(r.source.evaluated=(0,lVe.stringify)(r.evaluated))}return e.validate=r,e}catch(t){throw delete e.validate,delete e.validateName,u&&this.logger.error("Error compiling schema, function code:",u),t}finally{this._compilations.delete(e)}}function mVe(e){return(0,dVe.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:gVe.call(this,e)}function vVe(e){for(const t of this._compilations)if(yVe(t,e))return t}function yVe(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function bVe(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||_Ve.call(this,e,t)}function _Ve(e,t){const r=this.opts.uriResolver.parse(t),n=(0,dVe._getFullPath)(this.opts.uriResolver,r);let i=(0,dVe.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===i)return CVe.call(this,r,e);const o=(0,dVe.normalizeId)(n),a=this.refs[o]||this.schemas[o];if("string"==typeof a){const t=_Ve.call(this,e,a);return"object"!=typeof(null==t?void 0:t.schema)?void 0:CVe.call(this,r,t)}if("object"==typeof(null==a?void 0:a.schema)){if(a.validate||gVe.call(this,a),o===(0,dVe.normalizeId)(t)){const{schema:t}=a,{schemaId:r}=this.opts,n=t[r];return n&&(i=(0,dVe.resolveUrl)(this.opts.uriResolver,i,n)),new pVe({schema:t,schemaId:r,root:e,baseId:i})}return CVe.call(this,r,a)}}sVe.SchemaEnv=pVe,sVe.compileSchema=gVe,sVe.resolveRef=function(e,t,r){var n;r=(0,dVe.resolveUrl)(this.opts.uriResolver,t,r);const i=e.refs[r];if(i)return i;let o=bVe.call(this,e,r);if(void 0===o){const i=null===(n=e.localRefs)||void 0===n?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new pVe({schema:i,schemaId:a,root:e,baseId:t}))}return void 0!==o?e.refs[r]=mVe.call(this,o):void 0},sVe.getCompilingSchema=vVe,sVe.resolveSchema=_Ve;const wVe=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function CVe(e,{baseId:t,schema:r,root:n}){var i;if("/"!==(null===(i=e.fragment)||void 0===i?void 0:i[0]))return;for(const n of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;const e=r[(0,fVe.unescapeFragment)(n)];if(void 0===e)return;const i="object"==typeof(r=e)&&r[this.opts.schemaId];!wVe.has(n)&&i&&(t=(0,dVe.resolveUrl)(this.opts.uriResolver,t,i))}let o;if("boolean"!=typeof r&&r.$ref&&!(0,fVe.schemaHasRulesButRef)(r,this.RULES)){const e=(0,dVe.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=_Ve.call(this,n,e)}const{schemaId:a}=this.opts;return o=o||new pVe({schema:r,schemaId:a,root:n,baseId:t}),o.schema!==o.root.schema?o:void 0}const EVe={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var SVe={},kVe={exports:{}};(function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function o(e){return null!=e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function a(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}function s(e){var n="[A-Za-z]",i="[0-9]",o=t(i,"[A-Fa-f]"),a=r(r("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+r("%[89A-Fa-f]"+o+"%"+o+o)+"|"+r("%"+o+o)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=t("[\\:\\/\\?\\#\\[\\]\\@]",s),c=e?"[\\uE000-\\uF8FF]":"[]",u=t(n,i,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");r(n+t(n,i,"[\\+\\-\\.]")+"*"),r(r(a+"|"+t(u,s,"[\\:]"))+"*");var d=r(r("25[0-5]")+"|"+r("2[0-4]"+i)+"|"+r("1"+i+i)+"|"+r("0?[1-9]"+i)+"|0?0?"+i),f=r(d+"\\."+d+"\\."+d+"\\."+d),h=r(o+"{1,4}"),p=r(r(h+"\\:"+h)+"|"+f),g=r(r(h+"\\:")+"{6}"+p),m=r("\\:\\:"+r(h+"\\:")+"{5}"+p),v=r(r(h)+"?\\:\\:"+r(h+"\\:")+"{4}"+p),y=r(r(r(h+"\\:")+"{0,1}"+h)+"?\\:\\:"+r(h+"\\:")+"{3}"+p),b=r(r(r(h+"\\:")+"{0,2}"+h)+"?\\:\\:"+r(h+"\\:")+"{2}"+p),_=r(r(r(h+"\\:")+"{0,3}"+h)+"?\\:\\:"+h+"\\:"+p),w=r(r(r(h+"\\:")+"{0,4}"+h)+"?\\:\\:"+p),C=r(r(r(h+"\\:")+"{0,5}"+h)+"?\\:\\:"+h),E=r(r(r(h+"\\:")+"{0,6}"+h)+"?\\:\\:"),S=r([g,m,v,y,b,_,w,C,E].join("|")),k=r(r(u+"|"+a)+"+");r("[vV]"+o+"+\\."+t(u,s,"[\\:]")+"+"),r(r(a+"|"+t(u,s))+"*");var x=r(a+"|"+t(u,s,"[\\:\\@]"));return r(r(a+"|"+t(u,s,"[\\@]"))+"+"),r(r(x+"|"+t("[\\/\\?]",c))+"*"),{NOT_SCHEME:new RegExp(t("[^]",n,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,s),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,l),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+f+")$"),IPV6ADDRESS:new RegExp("^\\[?("+S+")"+r(r("\\%25|\\%(?!"+o+"{2})")+"("+k+")")+"?\\]?$")}}var l=s(!1),c=s(!0),u=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},f=2147483647,h=36,p=1,g=26,m=38,v=700,y=72,b=128,_="-",w=/^xn--/,C=/[^\0-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=h-p,x=Math.floor,O=String.fromCharCode;function I(e){throw new RangeError(S[e])}function R(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}function T(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+R((e=e.replace(E,".")).split("."),t).join(".")}function A(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),r--)}else t.push(i)}return t}var M=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:h},N=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},D=function(e,t,r){var n=0;for(e=r?x(e/v):e>>1,e+=x(e/t);e>k*g>>1;n+=h)e=x(e/k);return x(n+(k+1)*e/(e+m))},P=function(e){var t=[],r=e.length,n=0,i=b,o=y,a=e.lastIndexOf(_);a<0&&(a=0);for(var s=0;s<a;++s)e.charCodeAt(s)>=128&&I("not-basic"),t.push(e.charCodeAt(s));for(var l=a>0?a+1:0;l<r;){for(var c=n,u=1,d=h;;d+=h){l>=r&&I("invalid-input");var m=M(e.charCodeAt(l++));(m>=h||m>x((f-n)/u))&&I("overflow"),n+=m*u;var v=d<=o?p:d>=o+g?g:d-o;if(m<v)break;var w=h-v;u>x(f/w)&&I("overflow"),u*=w}var C=t.length+1;o=D(n-c,C,0==c),x(n/C)>f-i&&I("overflow"),i+=x(n/C),n%=C,t.splice(n++,0,i)}return String.fromCodePoint.apply(String,t)},j=function(e){var t=[],r=(e=A(e)).length,n=b,i=0,o=y,a=!0,s=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;d<128&&t.push(O(d))}}catch(e){s=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(s)throw l}}var m=t.length,v=m;for(m&&t.push(_);v<r;){var w=f,C=!0,E=!1,S=void 0;try{for(var k,R=e[Symbol.iterator]();!(C=(k=R.next()).done);C=!0){var T=k.value;T>=n&&T<w&&(w=T)}}catch(e){E=!0,S=e}finally{try{!C&&R.return&&R.return()}finally{if(E)throw S}}var M=v+1;w-n>x((f-i)/M)&&I("overflow"),i+=(w-n)*M,n=w;var P=!0,j=!1,F=void 0;try{for(var V,L=e[Symbol.iterator]();!(P=(V=L.next()).done);P=!0){var $=V.value;if($<n&&++i>f&&I("overflow"),$==n){for(var B=i,U=h;;U+=h){var z=U<=o?p:U>=o+g?g:U-o;if(B<z)break;var H=B-z,W=h-z;t.push(O(N(z+H%W,0))),B=x(H/W)}t.push(O(N(B,0))),o=D(i,M,v==m),i=0,++v}}}catch(e){j=!0,F=e}finally{try{!P&&L.return&&L.return()}finally{if(j)throw F}}++i,++n}return t.join("")},F=function(e){return T(e,(function(e){return w.test(e)?P(e.slice(4).toLowerCase()):e}))},V=function(e){return T(e,(function(e){return C.test(e)?"xn--"+j(e):e}))},L={version:"2.1.0",ucs2:{decode:A,encode:function(e){return String.fromCodePoint.apply(String,d(e))}},decode:P,encode:j,toASCII:V,toUnicode:F},$={};function B(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function U(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var a=parseInt(e.substr(r+4,2),16),s=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function z(e,t){function r(e){var r=U(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,B).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,B).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,B).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,B).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,B).replace(t.PCT_ENCODED,i)),e}function H(e){return e.replace(/^0*(.*)/,"$1")||"0"}function W(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=u(r,2)[1];return n?n.split(".").map(H).join("."):e}function G(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=u(r,3),i=n[1],o=n[2];if(i){for(var a=i.toLowerCase().split("::").reverse(),s=u(a,2),l=s[0],c=s[1],d=c?c.split(":").map(H):[],f=l.split(":").map(H),h=t.IPV4ADDRESS.test(f[f.length-1]),p=h?7:8,g=f.length-p,m=Array(p),v=0;v<p;++v)m[v]=d[v]||f[g+v]||"";h&&(m[p-1]=W(m[p-1],t));var y=m.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(y&&y.length>1){var _=m.slice(0,y.index),w=m.slice(y.index+y.length);b=_.join(":")+"::"+w.join(":")}else b=m.join(":");return o&&(b+="%"+o),b}return e}var K=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,q=void 0==="".match(/(){0}/)[1];function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?c:l;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(K);if(i){q?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=G(W(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=$[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)z(r,n);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=L.toASCII(r.host.replace(n.PCT_ENCODED,U).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}z(r,l)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function J(e,t){var r=!1!==t.iri?c:l,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(G(W(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),("number"==typeof e.port||"string"==typeof e.port)&&(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var X=/^\.\.?\//,Z=/^\/\.(\/|$)/,Q=/^\/\.\.(\/|$)/,ee=/^\/?(?:.|\n)*?(?=\/|$)/;function te(e){for(var t=[];e.length;)if(e.match(X))e=e.replace(X,"");else if(e.match(Z))e=e.replace(Z,"/");else if(e.match(Q))e=e.replace(Q,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(ee);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?c:l,n=[],i=$[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host&&!r.IPV6ADDRESS.test(e.host)&&(t.domainHost||i&&i.domainHost))try{e.host=t.iri?L.toUnicode(e.host):L.toASCII(e.host.replace(r.PCT_ENCODED,U).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}z(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var o=J(e,t);if(void 0!==o&&("suffix"!==t.reference&&n.push("//"),n.push(o),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var a=e.path;!t.absolutePath&&(!i||!i.absolutePath)&&(a=te(a)),void 0===o&&(a=a.replace(/^\/\//,"/%2F")),n.push(a)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function ne(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(e=Y(re(e,r),r),t=Y(re(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(n.scheme=t.scheme,n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(t.path?("/"===t.path.charAt(0)?n.path=te(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?n.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:n.path=t.path:n.path="/"+t.path,n.path=te(n.path)),n.query=t.query):(n.path=e.path,void 0!==t.query?n.query=t.query:n.query=e.query),n.userinfo=e.userinfo,n.host=e.host,n.port=e.port),n.scheme=e.scheme),n.fragment=t.fragment,n}function ie(e,t,r){var n=a({scheme:"null"},r);return re(ne(Y(e,n),Y(t,n),n,!0),n)}function oe(e,t){return"string"==typeof e?e=re(Y(e,t),t):"object"===n(e)&&(e=Y(re(e,t),t)),e}function ae(e,t,r){return"string"==typeof e?e=re(Y(e,r),r):"object"===n(e)&&(e=re(e,r)),"string"==typeof t?t=re(Y(t,r),r):"object"===n(t)&&(t=re(t,r)),e===t}function se(e,t){return e&&e.toString().replace(t&&t.iri?c.ESCAPE:l.ESCAPE,B)}function le(e,t){return e&&e.toString().replace(t&&t.iri?c.PCT_ENCODED:l.PCT_ENCODED,U)}var ce={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return(e.port===(r?443:80)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}},ue={scheme:"https",domainHost:ce.domainHost,parse:ce.parse,serialize:ce.serialize};function de(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var fe={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=de(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if((e.port===(de(e)?443:80)||""===e.port)&&(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=u(r,2),i=n[0],o=n[1];e.path=i&&"/"!==i?i:void 0,e.query=o,e.resourceName=void 0}return e.fragment=void 0,e}},he={scheme:"wss",domainHost:fe.domainHost,parse:fe.parse,serialize:fe.serialize},pe={},ge="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",me="[0-9A-Fa-f]",ve=r(r("%[EFef]"+me+"%"+me+me+"%"+me+me)+"|"+r("%[89A-Fa-f]"+me+"%"+me+me)+"|"+r("%"+me+me)),ye="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",be=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),_e="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",we=new RegExp(ge,"g"),Ce=new RegExp(ve,"g"),Ee=new RegExp(t("[^]",ye,"[\\.]",'[\\"]',be),"g"),Se=new RegExp(t("[^]",ge,_e),"g"),ke=Se;function xe(e){var t=U(e);return t.match(we)?t:e}var Oe={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,o={},a=r.query.split("&"),s=0,l=a.length;s<l;++s){var c=a[s].split("=");switch(c[0]){case"to":for(var u=c[1].split(","),d=0,f=u.length;d<f;++d)n.push(u[d]);break;case"subject":r.subject=le(c[1],t);break;case"body":r.body=le(c[1],t);break;default:i=!0,o[le(c[0],t)]=le(c[1],t)}}i&&(r.headers=o)}r.query=void 0;for(var h=0,p=n.length;h<p;++h){var g=n[h].split("@");if(g[0]=le(g[0]),t.unicodeSupport)g[1]=le(g[1],t).toLowerCase();else try{g[1]=L.toASCII(le(g[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}n[h]=g.join("@")}return r},serialize:function(e,t){var r=e,n=o(e.to);if(n){for(var a=0,s=n.length;a<s;++a){var l=String(n[a]),c=l.lastIndexOf("@"),u=l.slice(0,c).replace(Ce,xe).replace(Ce,i).replace(Ee,B),d=l.slice(c+1);try{d=t.iri?L.toUnicode(d):L.toASCII(le(d,t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}n[a]=u+"@"+d}r.path=n.join(",")}var f=e.headers=e.headers||{};e.subject&&(f.subject=e.subject),e.body&&(f.body=e.body);var h=[];for(var p in f)f[p]!==pe[p]&&h.push(p.replace(Ce,xe).replace(Ce,i).replace(Se,B)+"="+f[p].replace(Ce,xe).replace(Ce,i).replace(ke,B));return h.length&&(r.query=h.join("&")),r}},Ie=/^([^\:]+)\:(.*)/,Re={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(Ie),n=e;if(r){var i=t.scheme||n.scheme||"urn",o=r[1].toLowerCase(),a=r[2],s=i+":"+(t.nid||o),l=$[s];n.nid=o,n.nss=a,n.path=void 0,l&&(n=l.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),o=$[i];o&&(e=o.serialize(e,t));var a=e,s=e.nss;return a.path=(n||t.nid)+":"+s,a}},Te=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ae={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,!t.tolerant&&(!r.uuid||!r.uuid.match(Te))&&(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};$[ce.scheme]=ce,$[ue.scheme]=ue,$[fe.scheme]=fe,$[he.scheme]=he,$[Oe.scheme]=Oe,$[Re.scheme]=Re,$[Ae.scheme]=Ae,e.SCHEMES=$,e.pctEncChar=B,e.pctDecChars=U,e.parse=Y,e.removeDotSegments=te,e.serialize=re,e.resolveComponents=ne,e.resolve=ie,e.normalize=oe,e.equal=ae,e.escapeComponent=se,e.unescapeComponent=le,Object.defineProperty(e,"__esModule",{value:!0})})(kVe.exports),Object.defineProperty(SVe,"__esModule",{value:!0});const xVe=kVe.exports;xVe.code='require("ajv/dist/runtime/uri").default',SVe.default=xVe,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=vje;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=_je;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=rVe,i=iVe,o=Nje,a=sVe,s=_je,l=lFe,c=Mje,u=Eje,d=EVe,f=SVe,h=(e,t)=>new RegExp(e,t);h.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],g=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),m={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},v={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function y(e){var t,r,n,i,o,a,s,l,c,u,d,p,g,m,v,y,b,_,w,C,E,S,k,x,O;const I=e.strict,R=null===(t=e.code)||void 0===t?void 0:t.optimize,T=!0===R||void 0===R?1:R||0,A=null!==(n=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==n?n:h,M=null!==(i=e.uriResolver)&&void 0!==i?i:f.default;return{strictSchema:null===(a=null!==(o=e.strictSchema)&&void 0!==o?o:I)||void 0===a||a,strictNumbers:null===(l=null!==(s=e.strictNumbers)&&void 0!==s?s:I)||void 0===l||l,strictTypes:null!==(u=null!==(c=e.strictTypes)&&void 0!==c?c:I)&&void 0!==u?u:"log",strictTuples:null!==(p=null!==(d=e.strictTuples)&&void 0!==d?d:I)&&void 0!==p?p:"log",strictRequired:null!==(m=null!==(g=e.strictRequired)&&void 0!==g?g:I)&&void 0!==m&&m,code:e.code?{...e.code,optimize:T,regExp:A}:{optimize:T,regExp:A},loopRequired:null!==(v=e.loopRequired)&&void 0!==v?v:200,loopEnum:null!==(y=e.loopEnum)&&void 0!==y?y:200,meta:null===(b=e.meta)||void 0===b||b,messages:null===(_=e.messages)||void 0===_||_,inlineRefs:null===(w=e.inlineRefs)||void 0===w||w,schemaId:null!==(C=e.schemaId)&&void 0!==C?C:"$id",addUsedSchema:null===(E=e.addUsedSchema)||void 0===E||E,validateSchema:null===(S=e.validateSchema)||void 0===S||S,validateFormats:null===(k=e.validateFormats)||void 0===k||k,unicodeRegExp:null===(x=e.unicodeRegExp)||void 0===x||x,int32range:null===(O=e.int32range)||void 0===O||O,uriResolver:M}}class b{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...y(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new s.ValueScope({scope:{},prefixes:g,es5:t,lines:r}),this.logger=function(e){if(!1===e)return x;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=(0,o.getRules)(),_.call(this,m,e,"NOT SUPPORTED"),_.call(this,v,e,"DEPRECATED","warn"),this._metaOpts=k.call(this),e.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&S.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),C.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:r}=this.opts;let n=d;"id"===r&&(n={...d},n.id=n.$id,delete n.$id),t&&e&&this.addMetaSchema(n,n[r],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,t){await o.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||a.call(this,r)}async function o(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}async function a(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof i.default))throw t;return s.call(this,t),await l.call(this,t.missingSchema),a.call(this,e)}}function s({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function l(e){const r=await c.call(this,e);this.refs[e]||await o.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function c(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let i;if("object"==typeof e){const{schemaId:t}=this.opts;if(i=e[t],void 0!==i&&"string"!=typeof i)throw new Error(`schema ${t} must be string`)}return t=(0,l.normalizeId)(t||i),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=w.call(this,e));)e=t;if(void 0===t){const{schemaId:r}=this.opts,n=new a.SchemaEnv({schema:{},schemaId:r});if(t=a.resolveSchema.call(this,n,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=w.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e[this.opts.schemaId];return r&&(r=(0,l.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(I.call(this,r,t),!t)return(0,u.eachItem)(r,(e=>R.call(this,e))),this;A.call(this,t);const n={...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)};return(0,u.eachItem)(r,0===n.type.length?e=>R.call(this,e,n):e=>n.type.forEach((t=>R.call(this,e,n,t)))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex((t=>t.keyword===e));t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map((e=>`${r}${e.instancePath} ${e.message}`)).reduce(((e,r)=>e+t+r)):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let i=e;for(const e of t)i=i[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,o=i[e];n&&o&&(i[e]=N(o))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];(!t||t.test(r))&&("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r,n=this.opts.validateSchema,i=this.opts.addUsedSchema){let o;const{schemaId:s}=this.opts;if("object"==typeof e)o=e[s];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(void 0!==c)return c;r=(0,l.normalizeId)(o||r);const u=l.getSchemaRefs.call(this,e,r);return c=new a.SchemaEnv({schema:e,schemaId:s,meta:t,baseId:r,localRefs:u}),this._cache.set(c.schema,c),i&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=c),n&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):a.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,e)}finally{this.opts=t}}}function _(e,t,r,n="error"){for(const i in e){const o=i;o in t&&this.logger[n](`${r}: option ${i}. ${e[o]}`)}}function w(e){return e=(0,l.normalizeId)(e),this.schemas[e]||this.refs[e]}function C(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function E(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function S(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function k(){const e={...this.opts};for(const t of p)delete e[t];return e}e.default=b,b.ValidationError=n.default,b.MissingRefError=i.default;const x={log(){},warn(){},error(){}};const O=/^[a-z_$][a-z0-9_$:-]*$/i;function I(e,t){const{RULES:r}=this;if((0,u.eachItem)(e,(e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!O.test(e))throw new Error(`Keyword ${e} has invalid name`)})),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function R(e,t,r){var n;const i=null==t?void 0:t.post;if(r&&i)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let a=i?o.post:o.rules.find((({type:e})=>e===r));if(a||(a={type:r,rules:[]},o.rules.push(a)),o.keywords[e]=!0,!t)return;const s={keyword:e,definition:{...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)}};t.before?T.call(this,a,s,t.before):a.rules.push(s),o.all[e]=s,null===(n=t.implements)||void 0===n||n.forEach((e=>this.addKeyword(e)))}function T(e,t,r){const n=e.rules.findIndex((e=>e.keyword===r));n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function A(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=N(t)),e.validateSchema=this.compile(t,!0))}const M={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function N(e){return{anyOf:[e,M]}}}(mje);var OVe={},IVe={},RVe={};Object.defineProperty(RVe,"__esModule",{value:!0});const TVe={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};RVe.default=TVe;var AVe={};Object.defineProperty(AVe,"__esModule",{value:!0}),AVe.callRef=AVe.getValidate=void 0;const MVe=iVe,NVe=zje,DVe=_je,PVe=Sje,jVe=sVe,FVe=Eje,VVe={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:i,schemaEnv:o,validateName:a,opts:s,self:l}=n,{root:c}=o;if(("#"===r||"#/"===r)&&i===c.baseId)return function(){if(o===c)return $Ve(e,a,o,o.$async);const r=t.scopeValue("root",{ref:c});return $Ve(e,DVe._`${r}.validate`,c,c.$async)}();const u=jVe.resolveRef.call(l,c,i,r);if(void 0===u)throw new MVe.default(n.opts.uriResolver,i,r);return u instanceof jVe.SchemaEnv?function(t){const r=LVe(e,t);$Ve(e,r,t,t.$async)}(u):function(n){const i=t.scopeValue("schema",!0===s.code.source?{ref:n,code:(0,DVe.stringify)(n)}:{ref:n}),o=t.name("valid"),a=e.subschema({schema:n,dataTypes:[],schemaPath:DVe.nil,topSchemaRef:i,errSchemaPath:r},o);e.mergeEvaluated(a),e.ok(o)}(u)}};function LVe(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):DVe._`${r.scopeValue("wrapper",{ref:t})}.validate`}function $Ve(e,t,r,n){const{gen:i,it:o}=e,{allErrors:a,schemaEnv:s,opts:l}=o,c=l.passContext?PVe.default.this:DVe.nil;function u(e){const t=DVe._`${e}.errors`;i.assign(PVe.default.vErrors,DVe._`${PVe.default.vErrors} === null ? ${t} : ${PVe.default.vErrors}.concat(${t})`),i.assign(PVe.default.errors,DVe._`${PVe.default.vErrors}.length`)}function d(e){var t;if(!o.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==o.props)if(n&&!n.dynamicProps)void 0!==n.props&&(o.props=FVe.mergeEvaluated.props(i,n.props,o.props));else{const t=i.var("props",DVe._`${e}.evaluated.props`);o.props=FVe.mergeEvaluated.props(i,t,o.props,DVe.Name)}if(!0!==o.items)if(n&&!n.dynamicItems)void 0!==n.items&&(o.items=FVe.mergeEvaluated.items(i,n.items,o.items));else{const t=i.var("items",DVe._`${e}.evaluated.items`);o.items=FVe.mergeEvaluated.items(i,t,o.items,DVe.Name)}}n?function(){if(!s.$async)throw new Error("async schema referenced by sync schema");const r=i.let("valid");i.try((()=>{i.code(DVe._`await ${(0,NVe.callValidateCode)(e,t,c)}`),d(t),a||i.assign(r,!0)}),(e=>{i.if(DVe._`!(${e} instanceof ${o.ValidationError})`,(()=>i.throw(e))),u(e),a||i.assign(r,!1)})),e.ok(r)}():e.result((0,NVe.callValidateCode)(e,t,c),(()=>d(t)),(()=>u(t)))}AVe.getValidate=LVe,AVe.callRef=$Ve,AVe.default=VVe,Object.defineProperty(IVe,"__esModule",{value:!0});const BVe=AVe,UVe=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",RVe.default,BVe.default];IVe.default=UVe;var zVe={},HVe={};Object.defineProperty(HVe,"__esModule",{value:!0});const WVe=_je,GVe=WVe.operators,KVe={maximum:{okStr:"<=",ok:GVe.LTE,fail:GVe.GT},minimum:{okStr:">=",ok:GVe.GTE,fail:GVe.LT},exclusiveMaximum:{okStr:"<",ok:GVe.LT,fail:GVe.GTE},exclusiveMinimum:{okStr:">",ok:GVe.GT,fail:GVe.LTE}},qVe={message:({keyword:e,schemaCode:t})=>WVe.str`must be ${KVe[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>WVe._`{comparison: ${KVe[e].okStr}, limit: ${t}}`},YVe={keyword:Object.keys(KVe),type:"number",schemaType:"number",$data:!0,error:qVe,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data(WVe._`${r} ${KVe[t].fail} ${n} || isNaN(${r})`)}};HVe.default=YVe;var JVe={};Object.defineProperty(JVe,"__esModule",{value:!0});const XVe=_je,ZVe={message:({schemaCode:e})=>XVe.str`must be multiple of ${e}`,params:({schemaCode:e})=>XVe._`{multipleOf: ${e}}`},QVe={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:ZVe,code(e){const{gen:t,data:r,schemaCode:n,it:i}=e,o=i.opts.multipleOfPrecision,a=t.let("res"),s=o?XVe._`Math.abs(Math.round(${a}) - ${a}) > 1e-${o}`:XVe._`${a} !== parseInt(${a})`;e.fail$data(XVe._`(${n} === 0 || (${a} = ${r}/${n}, ${s}))`)}};JVe.default=QVe;var eLe={},tLe={};function rLe(e){const t=e.length;let r,n=0,i=0;for(;i<t;)n++,r=e.charCodeAt(i++),r>=55296&&r<=56319&&i<t&&(r=e.charCodeAt(i),56320==(64512&r)&&i++);return n}Object.defineProperty(tLe,"__esModule",{value:!0}),tLe.default=rLe,rLe.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(eLe,"__esModule",{value:!0});const nLe=_je,iLe=Eje,oLe=tLe,aLe={message:({keyword:e,schemaCode:t})=>nLe.str`must NOT have ${"maxLength"===e?"more":"fewer"} than ${t} characters`,params:({schemaCode:e})=>nLe._`{limit: ${e}}`},sLe={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:aLe,code(e){const{keyword:t,data:r,schemaCode:n,it:i}=e,o="maxLength"===t?nLe.operators.GT:nLe.operators.LT,a=!1===i.opts.unicode?nLe._`${r}.length`:nLe._`${(0,iLe.useFunc)(e.gen,oLe.default)}(${r})`;e.fail$data(nLe._`${a} ${o} ${n}`)}};eLe.default=sLe;var lLe={};Object.defineProperty(lLe,"__esModule",{value:!0});const cLe=zje,uLe=_je,dLe={message:({schemaCode:e})=>uLe.str`must match pattern "${e}"`,params:({schemaCode:e})=>uLe._`{pattern: ${e}}`},fLe={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:dLe,code(e){const{data:t,$data:r,schema:n,schemaCode:i,it:o}=e,a=o.opts.unicodeRegExp?"u":"",s=r?uLe._`(new RegExp(${i}, ${a}))`:(0,cLe.usePattern)(e,n);e.fail$data(uLe._`!${s}.test(${t})`)}};lLe.default=fLe;var hLe={};Object.defineProperty(hLe,"__esModule",{value:!0});const pLe=_je,gLe={message:({keyword:e,schemaCode:t})=>pLe.str`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${t} properties`,params:({schemaCode:e})=>pLe._`{limit: ${e}}`},mLe={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:gLe,code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxProperties"===t?pLe.operators.GT:pLe.operators.LT;e.fail$data(pLe._`Object.keys(${r}).length ${i} ${n}`)}};hLe.default=mLe;var vLe={};Object.defineProperty(vLe,"__esModule",{value:!0});const yLe=zje,bLe=_je,_Le=Eje,wLe={message:({params:{missingProperty:e}})=>bLe.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>bLe._`{missingProperty: ${e}}`},CLe={keyword:"required",type:"object",schemaType:"array",$data:!0,error:wLe,code(e){const{gen:t,schema:r,schemaCode:n,data:i,$data:o,it:a}=e,{opts:s}=a;if(!o&&0===r.length)return;const l=r.length>=s.loopRequired;if(a.allErrors?function(){if(l||o)e.block$data(bLe.nil,c);else for(const t of r)(0,yLe.checkReportMissingProp)(e,t)}():function(){const a=t.let("missing");if(l||o){const r=t.let("valid",!0);e.block$data(r,(()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,n,(()=>{t.assign(o,(0,yLe.propertyInData)(t,i,r,s.ownProperties)),t.if((0,bLe.not)(o),(()=>{e.error(),t.break()}))}),bLe.nil)}(a,r))),e.ok(r)}else t.if((0,yLe.checkMissingProp)(e,r,a)),(0,yLe.reportMissingProp)(e,a),t.else()}(),s.strictRequired){const t=e.parentSchema.properties,{definedProperties:n}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!n.has(e)){const t=a.schemaEnv.baseId+a.errSchemaPath;(0,_Le.checkStrictMode)(a,`required property "${e}" is not defined at "${t}" (strictRequired)`,a.opts.strictRequired)}}function c(){t.forOf("prop",n,(r=>{e.setParams({missingProperty:r}),t.if((0,yLe.noPropertyInData)(t,i,r,s.ownProperties),(()=>e.error()))}))}}};vLe.default=CLe;var ELe={};Object.defineProperty(ELe,"__esModule",{value:!0});const SLe=_je,kLe={message:({keyword:e,schemaCode:t})=>SLe.str`must NOT have ${"maxItems"===e?"more":"fewer"} than ${t} items`,params:({schemaCode:e})=>SLe._`{limit: ${e}}`},xLe={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:kLe,code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxItems"===t?SLe.operators.GT:SLe.operators.LT;e.fail$data(SLe._`${r}.length ${i} ${n}`)}};ELe.default=xLe;var OLe={},ILe={};Object.defineProperty(ILe,"__esModule",{value:!0});const RLe=cFe;RLe.code='require("ajv/dist/runtime/equal").default',ILe.default=RLe,Object.defineProperty(OLe,"__esModule",{value:!0});const TLe=Mje,ALe=_je,MLe=Eje,NLe=ILe,DLe={message:({params:{i:e,j:t}})=>ALe.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>ALe._`{i: ${e}, j: ${t}}`},PLe={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:DLe,code(e){const{gen:t,data:r,$data:n,schema:i,parentSchema:o,schemaCode:a,it:s}=e;if(!n&&!i)return;const l=t.let("valid"),c=o.items?(0,TLe.getSchemaTypes)(o.items):[];function u(n,i){const o=t.name("item"),a=(0,TLe.checkDataTypes)(c,o,s.opts.strictNumbers,TLe.DataType.Wrong),u=t.const("indices",ALe._`{}`);t.for(ALe._`;${n}--;`,(()=>{t.let(o,ALe._`${r}[${n}]`),t.if(a,ALe._`continue`),c.length>1&&t.if(ALe._`typeof ${o} == "string"`,ALe._`${o} += "_"`),t.if(ALe._`typeof ${u}[${o}] == "number"`,(()=>{t.assign(i,ALe._`${u}[${o}]`),e.error(),t.assign(l,!1).break()})).code(ALe._`${u}[${o}] = ${n}`)}))}function d(n,i){const o=(0,MLe.useFunc)(t,NLe.default),a=t.name("outer");t.label(a).for(ALe._`;${n}--;`,(()=>t.for(ALe._`${i} = ${n}; ${i}--;`,(()=>t.if(ALe._`${o}(${r}[${n}], ${r}[${i}])`,(()=>{e.error(),t.assign(l,!1).break(a)}))))))}e.block$data(l,(function(){const n=t.let("i",ALe._`${r}.length`),i=t.let("j");e.setParams({i:n,j:i}),t.assign(l,!0),t.if(ALe._`${n} > 1`,(()=>(c.length>0&&!c.some((e=>"object"===e||"array"===e))?u:d)(n,i)))}),ALe._`${a} === false`),e.ok(l)}};OLe.default=PLe;var jLe={};Object.defineProperty(jLe,"__esModule",{value:!0});const FLe=_je,VLe=Eje,LLe=ILe,$Le={message:"must be equal to constant",params:({schemaCode:e})=>FLe._`{allowedValue: ${e}}`},BLe={keyword:"const",$data:!0,error:$Le,code(e){const{gen:t,data:r,$data:n,schemaCode:i,schema:o}=e;n||o&&"object"==typeof o?e.fail$data(FLe._`!${(0,VLe.useFunc)(t,LLe.default)}(${r}, ${i})`):e.fail(FLe._`${o} !== ${r}`)}};jLe.default=BLe;var ULe={};Object.defineProperty(ULe,"__esModule",{value:!0});const zLe=_je,HLe=Eje,WLe=ILe,GLe={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>zLe._`{allowedValues: ${e}}`},KLe={keyword:"enum",schemaType:"array",$data:!0,error:GLe,code(e){const{gen:t,data:r,$data:n,schema:i,schemaCode:o,it:a}=e;if(!n&&0===i.length)throw new Error("enum must have non-empty array");const s=i.length>=a.opts.loopEnum;let l;const c=()=>null!=l?l:l=(0,HLe.useFunc)(t,WLe.default);let u;if(s||n)u=t.let("valid"),e.block$data(u,(function(){t.assign(u,!1),t.forOf("v",o,(e=>t.if(zLe._`${c()}(${r}, ${e})`,(()=>t.assign(u,!0).break()))))}));else{if(!Array.isArray(i))throw new Error("ajv implementation error");const e=t.const("vSchema",o);u=(0,zLe.or)(...i.map(((t,n)=>function(e,t){const n=i[t];return"object"==typeof n&&null!==n?zLe._`${c()}(${r}, ${e}[${t}])`:zLe._`${r} === ${n}`}(e,n))))}e.pass(u)}};ULe.default=KLe,Object.defineProperty(zVe,"__esModule",{value:!0});const qLe=JVe,YLe=eLe,JLe=lLe,XLe=hLe,ZLe=vLe,QLe=ELe,e$e=OLe,t$e=jLe,r$e=ULe,n$e=[HVe.default,qLe.default,YLe.default,JLe.default,XLe.default,ZLe.default,QLe.default,e$e.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},t$e.default,r$e.default];zVe.default=n$e;var i$e={},o$e={};Object.defineProperty(o$e,"__esModule",{value:!0}),o$e.validateAdditionalItems=void 0;const a$e=_je,s$e=Eje,l$e={message:({params:{len:e}})=>a$e.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>a$e._`{limit: ${e}}`},c$e={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:l$e,code(e){const{parentSchema:t,it:r}=e,{items:n}=t;Array.isArray(n)?u$e(e,n):(0,s$e.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas')}};function u$e(e,t){const{gen:r,schema:n,data:i,keyword:o,it:a}=e;a.items=!0;const s=r.const("len",a$e._`${i}.length`);if(!1===n)e.setParams({len:t.length}),e.pass(a$e._`${s} <= ${t.length}`);else if("object"==typeof n&&!(0,s$e.alwaysValidSchema)(a,n)){const n=r.var("valid",a$e._`${s} <= ${t.length}`);r.if((0,a$e.not)(n),(()=>function(n){r.forRange("i",t.length,s,(t=>{e.subschema({keyword:o,dataProp:t,dataPropType:s$e.Type.Num},n),a.allErrors||r.if((0,a$e.not)(n),(()=>r.break()))}))}(n))),e.ok(n)}}o$e.validateAdditionalItems=u$e,o$e.default=c$e;var d$e={},f$e={};Object.defineProperty(f$e,"__esModule",{value:!0}),f$e.validateTuple=void 0;const h$e=_je,p$e=Eje,g$e=zje,m$e={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return v$e(e,"additionalItems",t);r.items=!0,!(0,p$e.alwaysValidSchema)(r,t)&&e.ok((0,g$e.validateArray)(e))}};function v$e(e,t,r=e.schema){const{gen:n,parentSchema:i,data:o,keyword:a,it:s}=e;(function(e){const{opts:n,errSchemaPath:i}=s,o=r.length,l=o===e.minItems&&(o===e.maxItems||!1===e[t]);if(n.strictTuples&&!l){const e=`"${a}" is ${o}-tuple, but minItems or maxItems/${t} are not specified or different at path "${i}"`;(0,p$e.checkStrictMode)(s,e,n.strictTuples)}})(i),s.opts.unevaluated&&r.length&&!0!==s.items&&(s.items=p$e.mergeEvaluated.items(n,r.length,s.items));const l=n.name("valid"),c=n.const("len",h$e._`${o}.length`);r.forEach(((t,r)=>{(0,p$e.alwaysValidSchema)(s,t)||(n.if(h$e._`${c} > ${r}`,(()=>e.subschema({keyword:a,schemaProp:r,dataProp:r},l))),e.ok(l))}))}f$e.validateTuple=v$e,f$e.default=m$e,Object.defineProperty(d$e,"__esModule",{value:!0});const y$e=f$e,b$e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,y$e.validateTuple)(e,"items")};d$e.default=b$e;var _$e={};Object.defineProperty(_$e,"__esModule",{value:!0});const w$e=_je,C$e=Eje,E$e=zje,S$e=o$e,k$e={message:({params:{len:e}})=>w$e.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>w$e._`{limit: ${e}}`},x$e={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:k$e,code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:i}=r;n.items=!0,!(0,C$e.alwaysValidSchema)(n,t)&&(i?(0,S$e.validateAdditionalItems)(e,i):e.ok((0,E$e.validateArray)(e)))}};_$e.default=x$e;var O$e={};Object.defineProperty(O$e,"__esModule",{value:!0});const I$e=_je,R$e=Eje,T$e={message:({params:{min:e,max:t}})=>void 0===t?I$e.str`must contain at least ${e} valid item(s)`:I$e.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?I$e._`{minContains: ${e}}`:I$e._`{minContains: ${e}, maxContains: ${t}}`},A$e={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:T$e,code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:o}=e;let a,s;const{minContains:l,maxContains:c}=n;o.opts.next?(a=void 0===l?1:l,s=c):a=1;const u=t.const("len",I$e._`${i}.length`);if(e.setParams({min:a,max:s}),void 0===s&&0===a)return void(0,R$e.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==s&&a>s)return(0,R$e.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,R$e.alwaysValidSchema)(o,r)){let t=I$e._`${u} >= ${a}`;return void 0!==s&&(t=I$e._`${t} && ${u} <= ${s}`),void e.pass(t)}o.items=!0;const d=t.name("valid");function f(){const e=t.name("_valid"),r=t.let("count",0);h(e,(()=>t.if(e,(()=>function(e){t.code(I$e._`${e}++`),void 0===s?t.if(I$e._`${e} >= ${a}`,(()=>t.assign(d,!0).break())):(t.if(I$e._`${e} > ${s}`,(()=>t.assign(d,!1).break())),1===a?t.assign(d,!0):t.if(I$e._`${e} >= ${a}`,(()=>t.assign(d,!0))))}(r)))))}function h(r,n){t.forRange("i",0,u,(t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:R$e.Type.Num,compositeRule:!0},r),n()}))}void 0===s&&1===a?h(d,(()=>t.if(d,(()=>t.break())))):0===a?(t.let(d,!0),void 0!==s&&t.if(I$e._`${i}.length > 0`,f)):(t.let(d,!1),f()),e.result(d,(()=>e.reset()))}};O$e.default=A$e;var M$e={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=_je,r=Eje,n=zje;e.error={message:({params:{property:e,depsCount:r,deps:n}})=>t.str`must have ${1===r?"property":"properties"} ${n} when property ${e} is present`,params:({params:{property:e,depsCount:r,deps:n,missingProperty:i}})=>t._`{property: ${e},
    missingProperty: ${i},
    depsCount: ${r},
    deps: ${n}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e){if("__proto__"===n)continue;(Array.isArray(e[n])?t:r)[n]=e[n]}return[t,r]}(e);o(e,t),a(e,r)}};function o(e,r=e.schema){const{gen:i,data:o,it:a}=e;if(0===Object.keys(r).length)return;const s=i.let("missing");for(const l in r){const c=r[l];if(0===c.length)continue;const u=(0,n.propertyInData)(i,o,l,a.opts.ownProperties);e.setParams({property:l,depsCount:c.length,deps:c.join(", ")}),a.allErrors?i.if(u,(()=>{for(const t of c)(0,n.checkReportMissingProp)(e,t)})):(i.if(t._`${u} && (${(0,n.checkMissingProp)(e,c,s)})`),(0,n.reportMissingProp)(e,s),i.else())}}function a(e,t=e.schema){const{gen:i,data:o,keyword:a,it:s}=e,l=i.name("valid");for(const c in t)(0,r.alwaysValidSchema)(s,t[c])||(i.if((0,n.propertyInData)(i,o,c,s.opts.ownProperties),(()=>{const t=e.subschema({keyword:a,schemaProp:c},l);e.mergeValidEvaluated(t,l)}),(()=>i.var(l,!0))),e.ok(l))}e.validatePropertyDeps=o,e.validateSchemaDeps=a,e.default=i}(M$e);var N$e={};Object.defineProperty(N$e,"__esModule",{value:!0});const D$e=_je,P$e=Eje,j$e={message:"property name must be valid",params:({params:e})=>D$e._`{propertyName: ${e.propertyName}}`},F$e={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:j$e,code(e){const{gen:t,schema:r,data:n,it:i}=e;if((0,P$e.alwaysValidSchema)(i,r))return;const o=t.name("valid");t.forIn("key",n,(r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},o),t.if((0,D$e.not)(o),(()=>{e.error(!0),i.allErrors||t.break()}))})),e.ok(o)}};N$e.default=F$e;var V$e={};Object.defineProperty(V$e,"__esModule",{value:!0});const L$e=zje,$$e=_je,B$e=Sje,U$e=Eje,z$e={message:"must NOT have additional properties",params:({params:e})=>$$e._`{additionalProperty: ${e.additionalProperty}}`},H$e={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:z$e,code(e){const{gen:t,schema:r,parentSchema:n,data:i,errsCount:o,it:a}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:s,opts:l}=a;if(a.props=!0,"all"!==l.removeAdditional&&(0,U$e.alwaysValidSchema)(a,r))return;const c=(0,L$e.allSchemaProperties)(n.properties),u=(0,L$e.allSchemaProperties)(n.patternProperties);function d(e){t.code($$e._`delete ${i}[${e}]`)}function f(n){if("all"===l.removeAdditional||l.removeAdditional&&!1===r)d(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(s||t.break());if("object"==typeof r&&!(0,U$e.alwaysValidSchema)(a,r)){const r=t.name("valid");"failing"===l.removeAdditional?(h(n,r,!1),t.if((0,$$e.not)(r),(()=>{e.reset(),d(n)}))):(h(n,r),s||t.if((0,$$e.not)(r),(()=>t.break())))}}}function h(t,r,n){const i={keyword:"additionalProperties",dataProp:t,dataPropType:U$e.Type.Str};!1===n&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,r)}t.forIn("key",i,(r=>{c.length||u.length?t.if(function(r){let i;if(c.length>8){const e=(0,U$e.schemaRefOrVal)(a,n.properties,"properties");i=(0,L$e.isOwnProperty)(t,e,r)}else i=c.length?(0,$$e.or)(...c.map((e=>$$e._`${r} === ${e}`))):$$e.nil;return u.length&&(i=(0,$$e.or)(i,...u.map((t=>$$e._`${(0,L$e.usePattern)(e,t)}.test(${r})`)))),(0,$$e.not)(i)}(r),(()=>f(r))):f(r)})),e.ok($$e._`${o} === ${B$e.default.errors}`)}};V$e.default=H$e;var W$e={};Object.defineProperty(W$e,"__esModule",{value:!0});const G$e=vje,K$e=zje,q$e=Eje,Y$e=V$e,J$e={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:o}=e;"all"===o.opts.removeAdditional&&void 0===n.additionalProperties&&Y$e.default.code(new G$e.KeywordCxt(o,Y$e.default,"additionalProperties"));const a=(0,K$e.allSchemaProperties)(r);for(const e of a)o.definedProperties.add(e);o.opts.unevaluated&&a.length&&!0!==o.props&&(o.props=q$e.mergeEvaluated.props(t,(0,q$e.toHash)(a),o.props));const s=a.filter((e=>!(0,q$e.alwaysValidSchema)(o,r[e])));if(0===s.length)return;const l=t.name("valid");for(const r of s)c(r)?u(r):(t.if((0,K$e.propertyInData)(t,i,r,o.opts.ownProperties)),u(r),o.allErrors||t.else().var(l,!0),t.endIf()),e.it.definedProperties.add(r),e.ok(l);function c(e){return o.opts.useDefaults&&!o.compositeRule&&void 0!==r[e].default}function u(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},l)}}};W$e.default=J$e;var X$e={};Object.defineProperty(X$e,"__esModule",{value:!0});const Z$e=zje,Q$e=_je,eBe=Eje,tBe=Eje,rBe={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:i,it:o}=e,{opts:a}=o,s=(0,Z$e.allSchemaProperties)(r),l=s.filter((e=>(0,eBe.alwaysValidSchema)(o,r[e])));if(0===s.length||l.length===s.length&&(!o.opts.unevaluated||!0===o.props))return;const c=a.strictSchema&&!a.allowMatchingProperties&&i.properties,u=t.name("valid");!0!==o.props&&!(o.props instanceof Q$e.Name)&&(o.props=(0,tBe.evaluatedPropsToName)(t,o.props));const{props:d}=o;function f(e){for(const t in c)new RegExp(e).test(t)&&(0,eBe.checkStrictMode)(o,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function h(r){t.forIn("key",n,(n=>{t.if(Q$e._`${(0,Z$e.usePattern)(e,r)}.test(${n})`,(()=>{const i=l.includes(r);i||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:n,dataPropType:tBe.Type.Str},u),o.opts.unevaluated&&!0!==d?t.assign(Q$e._`${d}[${n}]`,!0):!i&&!o.allErrors&&t.if((0,Q$e.not)(u),(()=>t.break()))}))}))}!function(){for(const e of s)c&&f(e),o.allErrors?h(e):(t.var(u,!0),h(e),t.if(u))}()}};X$e.default=rBe;var nBe={};Object.defineProperty(nBe,"__esModule",{value:!0});const iBe=Eje,oBe={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if((0,iBe.alwaysValidSchema)(n,r))return void e.fail();const i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.failResult(i,(()=>e.reset()),(()=>e.error()))},error:{message:"must NOT be valid"}};nBe.default=oBe;var aBe={};Object.defineProperty(aBe,"__esModule",{value:!0});const sBe={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:zje.validateUnion,error:{message:"must match a schema in anyOf"}};aBe.default=sBe;var lBe={};Object.defineProperty(lBe,"__esModule",{value:!0});const cBe=_je,uBe=Eje,dBe={message:"must match exactly one schema in oneOf",params:({params:e})=>cBe._`{passingSchemas: ${e.passing}}`},fBe={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:dBe,code(e){const{gen:t,schema:r,parentSchema:n,it:i}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(i.opts.discriminator&&n.discriminator)return;const o=r,a=t.let("valid",!1),s=t.let("passing",null),l=t.name("_valid");e.setParams({passing:s}),t.block((function(){o.forEach(((r,n)=>{let o;(0,uBe.alwaysValidSchema)(i,r)?t.var(l,!0):o=e.subschema({keyword:"oneOf",schemaProp:n,compositeRule:!0},l),n>0&&t.if(cBe._`${l} && ${a}`).assign(a,!1).assign(s,cBe._`[${s}, ${n}]`).else(),t.if(l,(()=>{t.assign(a,!0),t.assign(s,n),o&&e.mergeEvaluated(o,cBe.Name)}))}))})),e.result(a,(()=>e.reset()),(()=>e.error(!0)))}};lBe.default=fBe;var hBe={};Object.defineProperty(hBe,"__esModule",{value:!0});const pBe=Eje,gBe={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const i=t.name("valid");r.forEach(((t,r)=>{if((0,pBe.alwaysValidSchema)(n,t))return;const o=e.subschema({keyword:"allOf",schemaProp:r},i);e.ok(i),e.mergeEvaluated(o)}))}};hBe.default=gBe;var mBe={};Object.defineProperty(mBe,"__esModule",{value:!0});const vBe=_je,yBe=Eje,bBe={message:({params:e})=>vBe.str`must match "${e.ifClause}" schema`,params:({params:e})=>vBe._`{failingKeyword: ${e.ifClause}}`},_Be={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:bBe,code(e){const{gen:t,parentSchema:r,it:n}=e;void 0===r.then&&void 0===r.else&&(0,yBe.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const i=wBe(n,"then"),o=wBe(n,"else");if(!i&&!o)return;const a=t.let("valid",!0),s=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},s);e.mergeEvaluated(t)}(),e.reset(),i&&o){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(s,l("then",r),l("else",r))}else i?t.if(s,l("then")):t.if((0,vBe.not)(s),l("else"));function l(r,n){return()=>{const i=e.subschema({keyword:r},s);t.assign(a,s),e.mergeValidEvaluated(i,a),n?t.assign(n,vBe._`${r}`):e.setParams({ifClause:r})}}e.pass(a,(()=>e.error(!0)))}};function wBe(e,t){const r=e.schema[t];return void 0!==r&&!(0,yBe.alwaysValidSchema)(e,r)}mBe.default=_Be;var CBe={};Object.defineProperty(CBe,"__esModule",{value:!0});const EBe=Eje,SBe={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,EBe.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};CBe.default=SBe,Object.defineProperty(i$e,"__esModule",{value:!0});const kBe=o$e,xBe=d$e,OBe=f$e,IBe=_$e,RBe=O$e,TBe=M$e,ABe=N$e,MBe=V$e,NBe=W$e,DBe=X$e,PBe=nBe,jBe=aBe,FBe=lBe,VBe=hBe,LBe=mBe,$Be=CBe;i$e.default=function(e=!1){const t=[PBe.default,jBe.default,FBe.default,VBe.default,LBe.default,$Be.default,ABe.default,MBe.default,TBe.default,NBe.default,DBe.default];return e?t.push(xBe.default,IBe.default):t.push(kBe.default,OBe.default),t.push(RBe.default),t};var BBe={},UBe={};Object.defineProperty(UBe,"__esModule",{value:!0});const zBe=_je,HBe={message:({schemaCode:e})=>zBe.str`must match format "${e}"`,params:({schemaCode:e})=>zBe._`{format: ${e}}`},WBe={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:HBe,code(e,t){const{gen:r,data:n,$data:i,schema:o,schemaCode:a,it:s}=e,{opts:l,errSchemaPath:c,schemaEnv:u,self:d}=s;l.validateFormats&&(i?function(){const i=r.scopeValue("formats",{ref:d.formats,code:l.code.formats}),o=r.const("fDef",zBe._`${i}[${a}]`),s=r.let("fType"),c=r.let("format");r.if(zBe._`typeof ${o} == "object" && !(${o} instanceof RegExp)`,(()=>r.assign(s,zBe._`${o}.type || "string"`).assign(c,zBe._`${o}.validate`)),(()=>r.assign(s,zBe._`"string"`).assign(c,o))),e.fail$data((0,zBe.or)(!1===l.strictSchema?zBe.nil:zBe._`${a} && !${c}`,function(){const e=u.$async?zBe._`(${o}.async ? await ${c}(${n}) : ${c}(${n}))`:zBe._`${c}(${n})`,r=zBe._`(typeof ${c} == "function" ? ${e} : ${c}.test(${n}))`;return zBe._`${c} && ${c} !== true && ${s} === ${t} && !${r}`}()))}():function(){const i=d.formats[o];if(!i)return void function(){if(!1===l.strictSchema)return void d.logger.warn(e());throw new Error(e());function e(){return`unknown format "${o}" ignored in schema at path "${c}"`}}();if(!0===i)return;const[a,s,f]=function(e){const t=e instanceof RegExp?(0,zBe.regexpCode)(e):l.code.formats?zBe._`${l.code.formats}${(0,zBe.getProperty)(o)}`:void 0,n=r.scopeValue("formats",{key:o,ref:e,code:t});return"object"!=typeof e||e instanceof RegExp?["string",e,n]:[e.type||"string",e.validate,zBe._`${n}.validate`]}(i);a===t&&e.pass(function(){if("object"==typeof i&&!(i instanceof RegExp)&&i.async){if(!u.$async)throw new Error("async format in sync schema");return zBe._`await ${f}(${n})`}return"function"==typeof s?zBe._`${f}(${n})`:zBe._`${f}.test(${n})`}())}())}};UBe.default=WBe,Object.defineProperty(BBe,"__esModule",{value:!0});const GBe=[UBe.default];BBe.default=GBe;var KBe={};Object.defineProperty(KBe,"__esModule",{value:!0}),KBe.contentVocabulary=KBe.metadataVocabulary=void 0,KBe.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],KBe.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(OVe,"__esModule",{value:!0});const qBe=zVe,YBe=i$e,JBe=BBe,XBe=KBe,ZBe=[IVe.default,qBe.default,(0,YBe.default)(),JBe.default,XBe.metadataVocabulary,XBe.contentVocabulary];OVe.default=ZBe;var QBe={},eUe={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))}(eUe),Object.defineProperty(QBe,"__esModule",{value:!0});const tUe=_je,rUe=eUe,nUe=sVe,iUe=Eje,oUe={message:({params:{discrError:e,tagName:t}})=>e===rUe.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>tUe._`{error: ${e}, tag: ${r}, tagValue: ${t}}`},aUe={keyword:"discriminator",type:"object",schemaType:"object",error:oUe,code(e){const{gen:t,data:r,schema:n,parentSchema:i,it:o}=e,{oneOf:a}=i;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const s=n.propertyName;if("string"!=typeof s)throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!a)throw new Error("discriminator: requires oneOf keyword");const l=t.let("valid",!1),c=t.const("tag",tUe._`${r}${(0,tUe.getProperty)(s)}`);function u(r){const n=t.name("valid"),i=e.subschema({keyword:"oneOf",schemaProp:r},n);return e.mergeEvaluated(i,tUe.Name),n}t.if(tUe._`typeof ${c} == "string"`,(()=>function(){const r=function(){var e;const t={},r=l(i);let n=!0;for(let t=0;t<a.length;t++){let i=a[t];(null==i?void 0:i.$ref)&&!(0,iUe.schemaHasRulesButRef)(i,o.self.RULES)&&(i=nUe.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,null==i?void 0:i.$ref),i instanceof nUe.SchemaEnv&&(i=i.schema));const u=null===(e=null==i?void 0:i.properties)||void 0===e?void 0:e[s];if("object"!=typeof u)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${s}"`);n=n&&(r||l(i)),c(u,t)}if(!n)throw new Error(`discriminator: "${s}" must be required`);return t;function l({required:e}){return Array.isArray(e)&&e.includes(s)}function c(e,t){if(e.const)u(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${s}" must have "const" or "enum"`);for(const r of e.enum)u(r,t)}}function u(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${s}" values must be unique strings`);t[e]=r}}();t.if(!1);for(const e in r)t.elseIf(tUe._`${c} === ${e}`),t.assign(l,u(r[e]));t.else(),e.error(!1,{discrError:rUe.DiscrError.Mapping,tag:c,tagName:s}),t.endIf()}()),(()=>e.error(!1,{discrError:rUe.DiscrError.Tag,tag:c,tagName:s}))),e.ok(l)}};QBe.default=aUe;const sUe={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=mje,n=OVe,i=QBe,o=sUe,a=["/properties"],s="http://json-schema.org/draft-07/schema";class l extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach((e=>this.addVocabulary(e))),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(o,a):o;this.addMetaSchema(e,s,!1),this.refs["http://json-schema.org/schema"]=s}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(s)?s:void 0)}}e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var c=vje;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=_je;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=rVe;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return d.default}});var f=iVe;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return f.default}})}(gje,gje.exports);const lUe=Ti(gje.exports);var cUe={exports:{}},uUe={exports:{}},dUe={exports:{}},fUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=_je,n=["undefined","string","number","object","function","boolean","symbol"];function i(){return{keyword:"typeof",schemaType:["string","array"],code(e){const{data:t,schema:n,schemaValue:i}=e;e.fail("string"==typeof n?r._`typeof ${t} != ${n}`:r._`${i}.indexOf(typeof ${t}) < 0`)},metaSchema:{anyOf:[{type:"string",enum:n},{type:"array",items:{type:"string",enum:n}}]}}}t.default=i,e.exports=i}(fUe,fUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(fUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(dUe,dUe.exports);var hUe={exports:{}},pUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r={Object:Object,Array:Array,Function:Function,Number:Number,String:String,Date:Date,RegExp:RegExp};typeof Im.Buffer<"u"&&(r.Buffer=Im.Buffer),typeof Promise<"u"&&(r.Promise=Promise);const n=Object.assign((function(){return{keyword:"instanceof",schemaType:["string","array"],compile(e){if("string"==typeof e){const t=i(e);return e=>e instanceof t}if(Array.isArray(e)){const t=e.map(i);return e=>{for(const r of t)if(e instanceof r)return!0;return!1}}throw new Error("ajv implementation error")},metaSchema:{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}]}}}),{CONSTRUCTORS:r});function i(e){const t=r[e];if(t)return t;throw new Error(`invalid "instanceof" keyword value ${e}`)}t.default=n,e.exports=n}(pUe,pUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(pUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(hUe,hUe.exports);var gUe={exports:{}},mUe={exports:{}},vUe={};Object.defineProperty(vUe,"__esModule",{value:!0}),vUe.default=function(e){return()=>({keyword:e,type:"number",schemaType:"array",macro:function([t,r]){return function(t,r){if(t>r||"exclusiveRange"===e&&t===r)throw new Error("There are no numbers in range")}(t,r),"range"===e?{minimum:t,maximum:r}:{exclusiveMinimum:t,exclusiveMaximum:r}},metaSchema:{type:"array",minItems:2,maxItems:2,items:{type:"number"}}})},function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(vUe).default)("range");t.default=n,e.exports=n}(mUe,mUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(mUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(gUe,gUe.exports);var yUe={exports:{}},bUe={exports:{}};!function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(vUe).default)("exclusiveRange");t.default=n,e.exports=n}(bUe,bUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(bUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(yUe,yUe.exports);var _Ue={exports:{}},wUe={exports:{}},CUe={};Object.defineProperty(CUe,"__esModule",{value:!0}),CUe.usePattern=CUe.metaSchemaRef=void 0;const EUe=_je;CUe.metaSchemaRef=function({defaultMeta:e}={}){return!1===e?{}:{$ref:e||"http://json-schema.org/schema"}},CUe.usePattern=function({gen:e,it:{opts:t}},r,n=(t.unicodeRegExp?"u":"")){const i=new RegExp(r,n);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:EUe._`new RegExp(${r}, ${n})`})},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=_je,n=CUe,i={type:"object",properties:{pattern:{type:"string"},flags:{type:"string",nullable:!0}},required:["pattern"],additionalProperties:!1},o=/^\/(.*)\/([gimuy]*)$/;function a(){return{keyword:"regexp",type:"string",schemaType:["string","object"],code(e){const{data:t,schema:i}=e,a=function(t){if("object"==typeof t)return(0,n.usePattern)(e,t.pattern,t.flags);const r=o.exec(t);if(r)return(0,n.usePattern)(e,r[1],r[2]);throw new Error("cannot parse string into RegExp")}(i);e.pass(r._`${a}.test(${t})`)},metaSchema:{anyOf:[{type:"string"},i]}}}t.default=a,e.exports=a}(wUe,wUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(wUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(_Ue,_Ue.exports);var SUe={exports:{}},kUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=_je,n={trimStart:e=>e.trimStart(),trimEnd:e=>e.trimEnd(),trimLeft:e=>e.trimStart(),trimRight:e=>e.trimEnd(),trim:e=>e.trim(),toLowerCase:e=>e.toLowerCase(),toUpperCase:e=>e.toUpperCase(),toEnumCase:(e,t)=>(null==t?void 0:t.hash[o(e)])||e},i=Object.assign((function(){return{keyword:"transform",schemaType:"array",before:"enum",code(e){const{gen:t,data:i,schema:a,parentSchema:s,it:l}=e,{parentData:c,parentDataProperty:u}=l,d=a;if(!d.length)return;let f;if(d.includes("toEnumCase")){const e=function(e){const t={hash:{}};if(!e.enum)throw new Error('transform: "toEnumCase" requires "enum"');for(const r of e.enum){if("string"!=typeof r)continue;const e=o(r);if(t.hash[e])throw new Error('transform: "toEnumCase" requires all lowercased "enum" values to be unique');t.hash[e]=r}return t}(s);f=t.scopeValue("obj",{ref:e,code:(0,r.stringify)(e)})}function h(e){if(!e.length)return i;const o=e.pop();if(!(o in n))throw new Error(`transform: unknown transformation ${o}`);const a=t.scopeValue("func",{ref:n[o],code:r._`require("ajv-keywords/dist/definitions/transform").transform${(0,r.getProperty)(o)}`}),s=h(e);return f&&"toEnumCase"===o?r._`${a}(${s}, ${f})`:r._`${a}(${s})`}t.if(r._`typeof ${i} == "string" && ${c} !== undefined`,(()=>{t.assign(i,h(d.slice())),t.assign(r._`${c}[${u}]`,i)}))},metaSchema:{type:"array",items:{type:"string",enum:Object.keys(n)}}}}),{transform:n});function o(e){return e.toLowerCase()}t.default=i,e.exports=i}(kUe,kUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(kUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(SUe,SUe.exports);var xUe={exports:{}},OUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=cFe,n=["number","integer","string","boolean","null"];function i(){return{keyword:"uniqueItemProperties",type:"array",schemaType:"array",compile(e,t){const i=function(e,t){return e.map((e=>{var r,i,o;const a=null===(o=null===(i=null===(r=t.items)||void 0===r?void 0:r.properties)||void 0===i?void 0:i[e])||void 0===o?void 0:o.type;return Array.isArray(a)?!a.includes("object")&&!a.includes("array"):n.includes(a)}))}(e,t);return t=>{if(t.length<=1)return!0;for(let n=0;n<e.length;n++){const o=e[n];if(i[n]){const e={};for(const r of t){if(!r||"object"!=typeof r)continue;let t=r[o];if(!t||"object"!=typeof t){if("string"==typeof t&&(t='"'+t),e[t])return!1;e[t]=!0}}}else for(let e=t.length;e--;){const n=t[e];if(n&&"object"==typeof n)for(let i=e;i--;){const e=t[i];if(e&&"object"==typeof e&&r(n[o],e[o]))return!1}}}return!0}},metaSchema:{type:"array",items:{type:"string"}}}}t.default=i,e.exports=i}(OUe,OUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(OUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(xUe,xUe.exports);var IUe={exports:{}},RUe={exports:{}};!function(e,t){function r(){return{keyword:"allRequired",type:"object",schemaType:"boolean",macro(e,t){if(!e)return!0;const r=Object.keys(t.properties);return 0===r.length||{required:r}},dependencies:["properties"]}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=r}(RUe,RUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(RUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(IUe,IUe.exports);var TUe={exports:{}},AUe={exports:{}},MUe={};Object.defineProperty(MUe,"__esModule",{value:!0}),MUe.default=function(e){return()=>({keyword:e,type:"object",schemaType:"array",macro:t=>0===t.length||(1===t.length?{required:t}:{["anyRequired"===e?"anyOf":"oneOf"]:t.map((e=>({required:[e]})))}),metaSchema:{type:"array",items:{type:"string"}}})},function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(MUe).default)("anyRequired");t.default=n,e.exports=n}(AUe,AUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(AUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(TUe,TUe.exports);var NUe={exports:{}},DUe={exports:{}};!function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=(0,r(MUe).default)("oneRequired");t.default=n,e.exports=n}(DUe,DUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(DUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(NUe,NUe.exports);var PUe={exports:{}},jUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=_je,n=CUe,i={message:({params:{missingPattern:e}})=>r.str`should have property matching pattern '${e}'`,params:({params:{missingPattern:e}})=>r._`{missingPattern: ${e}}`};function o(){return{keyword:"patternRequired",type:"object",schemaType:"array",error:i,code(e){const{gen:t,schema:i,data:o}=e;if(0===i.length)return;const a=t.let("valid",!0);for(const e of i)s(e);function s(i){const s=t.let("matched",!1);t.forIn("key",o,(o=>{t.assign(s,r._`${(0,n.usePattern)(e,i)}.test(${o})`),t.if(s,(()=>t.break()))})),e.setParams({missingPattern:i}),t.assign(a,(0,r.and)(a,s)),e.pass(a)}},metaSchema:{type:"array",items:{type:"string",format:"regex"},uniqueItems:!0}}}t.default=o,e.exports=o}(jUe,jUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(jUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(PUe,PUe.exports);var FUe={exports:{}},VUe={exports:{}};!function(e,t){function r(){return{keyword:"prohibited",type:"object",schemaType:"array",macro:function(e){return 0===e.length||(1===e.length?{not:{required:e}}:{not:{anyOf:e.map((e=>({required:[e]})))}})},metaSchema:{type:"array",items:{type:"string"}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=r}(VUe,VUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(VUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(FUe,FUe.exports);var LUe={exports:{}},$Ue={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=CUe;function n(e){return{keyword:"deepProperties",type:"object",schemaType:"object",macro:function(e){const t=[];for(const r in e)t.push(i(r,e[r]));return{allOf:t}},metaSchema:{type:"object",propertyNames:{type:"string",format:"json-pointer"},additionalProperties:(0,r.metaSchemaRef)(e)}}}function i(e,t){const r=e.split("/"),n={};let i=n;for(let e=1;e<r.length;e++){let n=r[e];const a=e===r.length-1;n=o(n);const s=i.properties={};let l;if(/[0-9]+/.test(n)){let e=+n;for(l=i.items=[],i.type=["object","array"];e--;)l.push({})}else i.type="object";i=a?t:{},s[n]=i,l&&l.push(i)}return n}function o(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}t.default=n,e.exports=n}($Ue,$Ue.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r($Ue.exports),i=(e,t)=>e.addKeyword((0,n.default)(t));t.default=i,e.exports=i}(LUe,LUe.exports);var BUe={exports:{}},UUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=_je;function n(){return{keyword:"deepRequired",type:"object",schemaType:"array",code(e){const{schema:t,data:n}=e,i=t.map((e=>r._`(${function(e){if(""===e)throw new Error("empty JSON pointer not allowed");const t=e.split("/");let i=n;const o=t.map(((e,t)=>t?i=r._`${i}${(0,r.getProperty)(function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}(e))}`:i));return(0,r.and)(...o)}(e)}) === undefined`));e.fail((0,r.or)(...i))},metaSchema:{type:"array",items:{type:"string",format:"json-pointer"}}}}t.default=n,e.exports=n}(UUe,UUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(UUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(BUe,BUe.exports);var zUe={exports:{}},HUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r={},n={timestamp:()=>()=>Date.now(),datetime:()=>()=>(new Date).toISOString(),date:()=>()=>(new Date).toISOString().slice(0,10),time:()=>()=>(new Date).toISOString().slice(11),random:()=>()=>Math.random(),randomint:e=>{var t;const r=null!==(t=null==e?void 0:e.max)&&void 0!==t?t:2;return()=>Math.floor(Math.random()*r)},seq:e=>{var t;const n=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"";return r[n]||(r[n]=0),()=>r[n]++}},i=Object.assign((function(){return{keyword:"dynamicDefaults",type:"object",schemaType:["string","object"],modifying:!0,valid:!0,compile(e,t,r){if(!r.opts.useDefaults||r.compositeRule)return()=>!0;const n={};for(const t in e)n[t]=o(e[t]);const i="empty"===r.opts.useDefaults;return t=>{for(const r in e)(void 0===t[r]||i&&(null===t[r]||""===t[r]))&&(t[r]=n[r]());return!0}},metaSchema:{type:"object",additionalProperties:{anyOf:[{type:"string"},{type:"object",additionalProperties:!1,required:["func","args"],properties:{func:{type:"string"},args:{type:"object"}}}]}}}}),{DEFAULTS:n});function o(e){return"object"==typeof e?function({func:e,args:t}){const r=n[e];return a(e,r),r(t)}(e):function(e=""){const t=n[e];return a(e,t),t()}(e)}function a(e,t){if(!t)throw new Error(`invalid "dynamicDefaults" keyword property value: ${e}`)}t.default=i,e.exports=i}(HUe,HUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(HUe.exports),i=e=>e.addKeyword((0,n.default)());t.default=i,e.exports=i}(zUe,zUe.exports);var WUe={exports:{}},GUe={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=_je,n=CUe,i={message:({params:{schemaProp:e}})=>e?r.str`should match case "${e}" schema`:r.str`should match default case schema`,params:({params:{schemaProp:e}})=>e?r._`{failingCase: ${e}}`:r._`{failingDefault: true}`};function o(e){const t=(0,n.metaSchemaRef)(e);return[{keyword:"select",schemaType:["string","number","boolean","null"],$data:!0,error:i,dependencies:["selectCases"],code(e){const{gen:t,schemaCode:n,parentSchema:i}=e;e.block$data(r.nil,(()=>{const o=t.let("valid",!0),a=t.name("_valid"),s=t.const("value",r._`${n} === null ? "null" : ${n}`);t.if(!1);for(const n in i.selectCases){e.setParams({schemaProp:n}),t.elseIf(r._`"" + ${s} == ${n}`);const i=e.subschema({keyword:"selectCases",schemaProp:n},a);e.mergeEvaluated(i,r.Name),t.assign(o,a)}if(t.else(),void 0!==i.selectDefault){e.setParams({schemaProp:void 0});const n=e.subschema({keyword:"selectDefault"},a);e.mergeEvaluated(n,r.Name),t.assign(o,a)}t.endIf(),e.pass(o)}))}},{keyword:"selectCases",dependencies:["select"],metaSchema:{type:"object",additionalProperties:t}},{keyword:"selectDefault",dependencies:["select","selectCases"],metaSchema:t}]}t.default=o,e.exports=o}(GUe,GUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(GUe.exports),i=(e,t)=>((0,n.default)(t).forEach((t=>e.addKeyword(t))),e);t.default=i,e.exports=i}(WUe,WUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(dUe.exports),i=r(hUe.exports),o=r(gUe.exports),a=r(yUe.exports),s=r(_Ue.exports),l=r(SUe.exports),c=r(xUe.exports),u=r(IUe.exports),d=r(TUe.exports),f=r(NUe.exports),h=r(PUe.exports),p=r(FUe.exports),g=r(LUe.exports),m=r(BUe.exports),v=r(zUe.exports),y=r(WUe.exports),b={typeof:n.default,instanceof:i.default,range:o.default,exclusiveRange:a.default,regexp:s.default,transform:l.default,uniqueItemProperties:c.default,allRequired:u.default,anyRequired:d.default,oneRequired:f.default,patternRequired:h.default,prohibited:p.default,deepProperties:g.default,deepRequired:m.default,dynamicDefaults:v.default,select:y.default};t.default=b,e.exports=b}(uUe,uUe.exports),function(e,t){var r=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(uUe.exports),i=(e,t)=>{if(Array.isArray(t)){for(const r of t)o(r)(e);return e}if(t)return o(t)(e),e;for(t in n.default)o(t)(e);return e};function o(e){const t=n.default[e];if(!t)throw new Error("Unknown keyword "+e);return t}i.get=o,t.default=i,e.exports=i,e.exports.default=i}(cUe,cUe.exports);const KUe=Ti(cUe.exports);class qUe{constructor(e){this._ajv=new lUe(e),KUe(this._ajv)}validateSchema(e){return this._ajv.validateSchema(e)}validate(e,t){return this._ajv.validate(e,t)}}const YUe=null,JUe=$i.defineToken("ContentEditorContribution"),XUe=$i.defineToken("ContentViewerContribution"),ZUe=$i.defineToken("ContentDatasourceContribution"),QUe=$i.defineToken("ContentDatasourceServiceToken"),eze=$i.defineToken("ContentServiceToken"),tze=$i.defineToken("ContentEditorServiceToken"),rze=$i.defineToken("ContentViewerServiceToken");var nze=(e=>(e[e.FULL_SCREEN=0]="FULL_SCREEN",e[e.NORMAL=1]="NORMAL",e))(nze||{}),ize=Object.defineProperty,oze=Object.getOwnPropertyDescriptor,aze=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?oze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&ize(t,r,o),o};let sze=class{constructor(){this._onStatusChange=new _p,this.onStatusChange=this._onStatusChange.event,this.status=nze.NORMAL}get isFullScreen(){return this.status===nze.FULL_SCREEN}emitStatusChange(){this.status===nze.NORMAL?this.status=nze.FULL_SCREEN:this.status=nze.NORMAL,this._onStatusChange.emit(this.status)}enterFullScreen(e){var t;let r=["view-manage","|","kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search"];this.status=nze.FULL_SCREEN,e&&(r=r.concat(["|","add-record"])),this._configuration.setValue("toolbar.left",r),this._configuration.setValue("toolbar.right",[]),this._configuration.setValue("toolbar.mode",V4.NORMAL),this._configuration.setValue("view.customScrollParent",void 0),this._configuration.setValue("view.useWindowScroll",!1),this._configuration.setValue("render.autoActive",!0),null==(t=this._activeTableService)||t.active(),this._toolbarService.rerender()}exitFullScreen(e,t){var r;let n=["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","full-width","full-screen","search"];this.status=nze.NORMAL,e&&(n=n.concat(["|","add-record"])),this._configuration.setValue("toolbar.left",["view-manage"]),this._configuration.setValue("toolbar.right",n),this._configuration.setValue("toolbar.mode",V4.LITE),this._configuration.setValue("view.customScrollParent",t),this._configuration.setValue("view.useWindowScroll",!0),this._configuration.setValue("render.autoActive",!1),null==(r=this._activeTableService)||r.active(),this._toolbarService.rerender()}};aze([ao(lp)],sze.prototype,"_configuration",2),aze([ao(Bz)],sze.prototype,"_activeTableService",2),aze([ao(P4)],sze.prototype,"_toolbarService",2),sze=aze([io()],sze);var lze=(e=>(e.NORMAL="normal",e.CONTAIN="contain",e))(lze||{}),cze=Object.defineProperty,uze=Object.getOwnPropertyDescriptor,dze=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cze(t,r,o),o};const fze=750;let hze=class{constructor(){this._cardWidthMode=null,this._getMaxWidth=null,this._$card=null,this._onModeUIChange=new _p,this.onModeUIChange=this._onModeUIChange.event,this._onModeChange=new _p,this.onModeChange=this._onModeChange.event,this._onCardWidthChange=new _p,this.onCardWidthChange=this._onCardWidthChange.event,this.initCardWidth=e=>{if(this._getMaxWidth&&this._$card){if(this._fullScreenService.isFullScreen)this._setCardWidth("100%");else{const t=Math.min(this._getMaxWidth(),e);this._updateCardWidth(t)}e>fze?this.syncWidthMode(lze.CONTAIN):this.syncWidthMode(lze.NORMAL),this.bindEvent()}else console.error("[lakex-table-next] FullWidthService.initCardWidth is not ready, please apply getMaxWidtFunction and cardRef.")},this._updateCardWidth=e=>{var t;null==(t=this._setCardWidth)||t.call(this,e),this._onCardWidthChange.emit(e)},this._setCardWidth=e=>{this._$card&&(this._$card.style.width="string"==typeof e?e:`${e}px`)},this._addCardShadow=()=>{this._$card&&this._$card.classList.add("right-shadow")},this._removeCardShadow=()=>{this._$card&&this._$card.classList.remove("right-shadow")},this._handleCardViewWidth=()=>{if(!this._getMaxWidth)return;const e=this._getMaxWidth();this.isNormalMode&&this._updateCardWidth(Math.min(fze,e)),this.isContainMode&&this._updateCardWidth(e),this._removeCardShadow(),this._viewerCardLayoutService.refresh()},this._handleKanbanViewWidth=()=>{if(!this._getMaxWidth)return;const e=this._readService.getViewGroup(),t=this._getMaxWidth();if(!e)return this._updateCardWidth(Math.min(fze,t)),void this._removeCardShadow();const r=this._renderContextService.$root.querySelector(".lakex-viewer-kanban-content");if(r){const e=r.getBoundingClientRect().width,n=Math.max(e,fze),i=t<fze?t:Math.min(n,t);this._updateCardWidth(i),e>i?this._addCardShadow():this._removeCardShadow()}},this._handleGridViewWidth=()=>{if(!this._getMaxWidth)return;const e=this._renderContextService.$root.querySelector("table");if(e){const t=e.getBoundingClientRect().width,r=Math.max(t,fze),n=this._getMaxWidth(),i=n<fze?n:Math.min(r,n);this._updateCardWidth(i),t>i?this._addCardShadow():this._removeCardShadow()}}}get isDisable(){return this._fullScreenService.status===nze.FULL_SCREEN}get isNormalMode(){return this._cardWidthMode===lze.NORMAL}get isContainMode(){return this._cardWidthMode===lze.CONTAIN}get cardWidthMode(){return this._cardWidthMode}setWidthMode(e){this.syncWidthMode(e),this._onModeChange.emit(e)}applyGetMaxWidthFunction(e){this._getMaxWidth=e}applyCardRef(e){this._$card=e}resetWidth(){this._handleUpdateWidth()}setCardWidth(e){var t;null==(t=this._setCardWidth)||t.call(this,e)}syncWidthMode(e){this._cardWidthMode=e,this._onModeUIChange.emit(e)}_handleUpdateWidth(){if(this._getMaxWidth){if(fa.isMobile)return void this._updateCardWidth(this._getMaxWidth());if(this.isDisable)return null;requestAnimationFrame((()=>{switch(this._readService.getActiveViewType()){case LE.KANBAN:this._handleKanbanViewWidth();break;case LE.GRID:this._handleGridViewWidth();break;case LE.CARD:this._handleCardViewWidth();break;default:return}}))}}bindEvent(){this._commandService.onDidExecuteCommand((({context:e})=>{const{commandName:t}=e;if(this.isDisable)return null;("addView"===t||"removeView"===t||"switchView"===t||"changeColWidth"===t||"updateFieldHidden"===t||"addField"===t||"removeField"===t)&&this.resetWidth()})),this._commandService.onDidRedoCommand((()=>{this.resetWidth()})),this._commandService.onDidUndoCommand((()=>{this.resetWidth()}))}};dze([ao(sze)],hze.prototype,"_fullScreenService",2),dze([ao(KO)],hze.prototype,"_readService",2),dze([ao(Wz)],hze.prototype,"_renderContextService",2),dze([ao(kve)],hze.prototype,"_viewerCardLayoutService",2),dze([ao(zI)],hze.prototype,"_commandService",2),hze=dze([io()],hze);const pze=null,gze=$i.defineToken("CommentContribution"),mze={"AI 智能填写":"AI autofill","上传失败":"Upload failure","下拉":"Dropdown","为必填项":"Is required","今天":"Today","使用钉钉扫码$1":"Use Dingding to scan the code to $1","停止收集":"Stop collection","像问卷一样收集信息":"collect information like a questionnaire","全宽":"Full width","全屏":"Full screen","关闭":"Off","其他数据更新时同步更新":"Update when data changes","内容总结":"Summary","内容规则：":"Prompt type:","分享":"Share","列表":"List","单选":"Select","取消":"Cancel","取消添加":"remove","可用于问卷调查、活动组织、登记报名等信息收集与整理场景。":"The data table is a new type of table for more convenient multi-person collaboration and data management through multiple views.","向上移动":"Move up","向下移动":"Move down","回复":"","复制填写链接":"Copy and fill in the link","复制成功":"Copy successfully","复制表单项":"Clone this item","多选":"Multi-select","将自动对每条记录进行总结":"Summarize each record automatically","已停止填写":"Autofill Stopped","已重新填写":"Autofill Done","布局方式":"Layout","开启收集":"Start form collect","开始自动填写":"Start autofill","当前文档中此文件类型不支持预览和下载":"This file is not supported for preview and download","必填":"Required","所有列":"all the columns","打开":"Open","提交":"Submit","收集中":"Collecting","数据表中所有列":"All the columns in table","明天":"Tomorrow","昨天":"Yesterday","智能填写":"Autofill","未命名问题":"Untitled question","查看表单视图需要编辑权限":"Viewing form view requires edit permission","标宽":"Standard width","正在填写中...":"Autofilling...","此处由填写者输入":"This field is for form user","添加":"Add","点击「开启收集」按钮获得表单填写链接":"Click「Start form collect」button to get then form link","点击修改字段":"Click and change field","点击左侧列表添加已有列 或 点击下方按钮添加新表单项":"Click a field or the button above to add an item","生成新表单":"Create new form","移除表单项":"Remove this item","自定义":"Custom","获得链接的所有人，可填写并提交表单":"Anyone who gets the link can fill out and submit the form","表单为空":"This form is empty","表单提交失败，请稍后重试":"Form submission failed, please try again later","表单提交成功":"Form submitted successfully","表单收集未开启":"Form collection is not turned on","表单视图":"Form view","要点提取":"Extract","规则不能为空":"Rules can't be null","规则最长支持255字符":"Rules maximun length limit 255","评论":"Comment","请输入必填项":"Please enter required fields","请输入表单描述":"please input form descriptor","请输入表单标题":"please input form title","请输入问题":"Enter a question","输入智能填写规则\n如：为每个商品生成 50 字的宣传文案":"Please input autofill rules\n","输入要点提取规则\n如：提取每天记录中出现的人名":"Please input extract rules\n","重新填写":"Re-autofill","重新填写本列内容":"Re-autofill current col"};function vze(e,t){const r=globalThis.appData;return r&&void 0!==r[e]?r[e]:t}Dh.setData(mze);const yze=Lo(navigator)?"":navigator.userAgent,bze=/yuque-desktop\/[\d.]+/i.test(yze),_ze=/YuqueMobileApp\/[\d.]+/i.test(yze);class wze{static get locale(){return vze("locale","zh-cn")}static get isYuque(){return vze("isYuque",!1)}static get isEnterprise(){return vze("isEnterprise",!1)}static get isPublicCloud(){return vze("isPublicCloud",!1)}static get isOrganization(){return!!vze("organization")}static get isUIATest(){const e=Lo(navigator)?"":navigator.userAgent;return/Macaca UI Robot/.test(e)}static get isYuqueMobile(){return _ze}static get isDesktop(){return bze||vze("isDesktopApp",!1)}static get isYuqueMobileApp(){return vze("isYuqueMobileApp",!1)}static get imageServiceDomains(){return vze("imageServiceDomains",[])}static get docId(){return zt()(globalThis.appData||{},"doc.id")}static get group(){return vze("group",void 0)}static get me(){return vze("me",void 0)}static get doc(){return vze("doc",void 0)}static get organization(){return vze("organization",void 0)}static get env(){return vze("env","prod")}static get settings(){return vze("settings",{})}static get isOfficialTemplate(){return vze("isOfficialTemplate",!1)}static get themeManager(){return vze("themeManager")}}const Cze=({webSdk:e})=>({"record.maxCount":5e3,"view.maxCount":1e3,"toolbar.topLeft":["view-manage"],"toolbar.left":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search","|","add-record","expandRecord"],contextMenu:["updateField","autofillField","|","insertFieldLeft","insertFieldRight","|","groupByField","filterByField","sortByAsc","sortByDesc","|","copy","paste","|","insertRecordUp","insertRecordDown","insertRecordLeft","insertRecordRight","|","copyRecord","expandRecord","removeRecord","removeField"],"comment.actions":["reply","emoji","edit","delete"],"monitor.startAt":+new Date,"server.webSdk":e,"clipboard.clipboardApi.disable":wze.isUIATest,"collab.enable":!1,"collab.skipTable":["table","ability"],"expandRecord.fieldRenderMode":"lite","expandRecord.fieldLayoutMode":"lite","expandRecord.modalDrawerModeViews":["GRID"],"viewerManage.type":"tab","viewerManage.viewTypes":["GRID","CARD","KANBAN","FORM"]});class Eze extends PI{destroy(){}execute(e){return!0}}class Sze extends PI{destroy(){}execute(e){return this.writeService.upsertViewShare(e.viewId,{src:e.src,status:e.status}),!0}}class kze extends PI{destroy(){}execute(e){return this.writeService.removeViewField(e.viewId,e.fieldId),!0}}class xze extends PI{destroy(){}execute(e){return this.writeService.insertViewField(e.viewId,e.fieldId),!0}}class Oze extends PI{destroy(){}execute(e){return this.writeService.updateView(e.viewId,{desc:e.desc}),!0}}Oze.commandName="updateViewDesc";class Ize extends PI{destroy(){}execute(e){return this.writeService.updateViewField(e.viewId,e.fieldId,{display_type:e.displayType}),!0}}Ize.commandName="updateViewFieldDisplayType";class Rze extends PI{destroy(){}execute(e){return this.writeService.updateViewField(e.viewId,e.fieldId,{required:e.required}),!0}}Rze.commandName="updateViewFieldRequired";class Tze extends PI{destroy(){}execute(e){return this.writeService.updateViewField(e.viewId,e.fieldId,{name:e.name}),!0}}Tze.commandName="updateViewFieldName";class Aze extends PI{destroy(){}beforeExecute(e){return e.newFieldId||(e.newFieldId=To(32)),e}execute(e){return this.writeService.cloneViewField(e.viewId,e.fieldId,e.newFieldId),!0}}Aze.commandName="cloneViewField";const Mze=$i.defineToken("ViewerFormContribution");var Nze=(e=>(e.PENDING="pending",e.COLLECTING="collecting",e))(Nze||{});const Dze=$i.defineToken("ViewerFormKernelPluginContribution");var Pze=Object.defineProperty,jze=Object.getOwnPropertyDescriptor,Fze=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?jze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Pze(t,r,o),o};let Vze=class{getProvider(){const e=this.formProvider.getContributions();return e[e.length-1].registerForm()}getForm(e){return this.getProvider().getForm(e)}};Fze([wh(Mze)],Vze.prototype,"formProvider",2),Vze=Fze([io()],Vze);var Lze=Object.defineProperty,$ze=Object.getOwnPropertyDescriptor,Bze=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?$ze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Lze(t,r,o),o};let Uze=class{async initForm(e){const t=this._readService.getView(e);if(!t||this.getShare(e))return;const r=await this._formRegistry.getForm(t.get("id"));return r&&this._writeService.upsertViewShare(t.get("uuid"),r),r}getShare(e){if(e)return this._readService.getViewShare(e)}getForm(e){return this._readService.getView(e)}getFormEditData(e){const t=this._readService.getViewFields(e),r=this._readService.getAllFields();return{view:this._readService.getView(e),viewConfig:this._readService.getViewConfig(e),fields:Vp(r,(e=>!zE.isSystemType(e.get("type")))),viewFields:t&&Vp(t,(e=>{var t;return!zE.isSystemType(null==(t=e.get("field"))?void 0:t.get("type"))}))}}};Bze([ao(KO)],Uze.prototype,"_readService",2),Bze([ao(nI)],Uze.prototype,"_writeService",2),Bze([ao(Vze)],Uze.prototype,"_formRegistry",2),Uze=Bze([io()],Uze);var zze=Object.defineProperty,Hze=Object.getOwnPropertyDescriptor,Wze=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Hze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&zze(t,r,o),o};let Gze=class{static pluginModule(){return xo().contribution(Dze).register(Uze).contribution(Mze).register(Vze).register(Uze).register(this)}init(e){this.commandService.registerCommand("addFormRecord",Eze),this.commandService.registerCommand("removeViewField",kze),this.commandService.registerCommand("insertViewField",xze),this.commandService.registerCommand(Oze.commandName,Oze),this.commandService.registerCommand(Ize.commandName,Ize),this.commandService.registerCommand(Rze.commandName,Rze),this.commandService.registerCommand(Tze.commandName,Tze),this.commandService.registerCommand(Aze.commandName,Aze),this.commandService.registerCommand("upsertViewShare",Sze)}};Gze.pluginName="kernel-viewer-form",Wze([ao(zI)],Gze.prototype,"commandService",2),Gze=Wze([io({contrib:nR})],Gze);var Kze=Object.defineProperty,qze=Object.getOwnPropertyDescriptor;let Yze=class{constructor(){this._onCommandHook=new _p,this.onCommandHook=this._onCommandHook.event}emitHook(e){this._onCommandHook.emit(e)}};Yze=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?qze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Kze(t,r,o),o})([io()],Yze);var Jze=Object.defineProperty,Xze=Object.getOwnPropertyDescriptor,Zze=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Xze(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&Jze(t,r,o),o};const Qze=Jo.Plugin("monitor");let eHe=class{constructor(){this._commandLogs=[],this._startTaskWithDebounce=Wt()((async()=>{const e=this._commandLogs;0!==this._commandLogs.length&&(this._queueTask.addJob((async t=>{try{await this._startTask(e)}catch(e){return console.error(e),t.onError(e)}t.onSuccess()})),this._commandLogs=[])}),3e3)}startMainPerfLog(){const e={};e.startAt=this._configuration.getValue("monitor.startAt"),e.initAt=this._lifeCycleService.getStatusChangedAt(kh.Inited),e.initAt||this._lifeCycleService.when(kh.Inited,(()=>{e.initAt=this._lifeCycleService.getStatusChangedAt(kh.Inited)})),e.readyAt=this._lifeCycleService.getStatusChangedAt(kh.Ready),e.readyAt||this._lifeCycleService.when(kh.Ready,(()=>{e.readyAt=this._lifeCycleService.getStatusChangedAt(kh.Ready)})),e.recordInitAt=this._lifeCycleService.getStatusChangedAt(kh.RecordInit),e.recordInitAt||this._lifeCycleService.when(kh.RecordInit,(()=>{e.recordInitAt=this._lifeCycleService.getStatusChangedAt(kh.RecordInit)})),e.recordReadyAt=this._lifeCycleService.getStatusChangedAt(kh.RecordReady),e.recordReadyAt||this._lifeCycleService.when(kh.RecordReady,(()=>{e.recordReadyAt=this._lifeCycleService.getStatusChangedAt(kh.RecordReady)})),e.renderAt=this._lifeCycleService.getStatusChangedAt(kh.Rendered),e.renderAt?this._sendMainPerfLog(e):this._lifeCycleService.when(kh.Rendered,(()=>{e.renderAt=this._lifeCycleService.getStatusChangedAt(kh.Rendered),this._sendMainPerfLog(e)}))}_sendMainPerfLog(e){const t=this._configuration.getValue("monitor.sendLog"),r={msg:"新数据表性能上报",m1:e.initAt-e.startAt,m2:e.readyAt-e.initAt,m3:e.recordInitAt-e.readyAt,m4:e.recordReadyAt-e.recordInitAt,m5:e.renderAt-e.recordReadyAt,m6:e.renderAt-e.startAt,c1:this._readService.getRecords().length,c2:this._readService.getAllFields().length};r.m5>5e3||r.m6>2e4||(Qze("main perf: %j",r),null==t||t(59,r))}startCommandPerfLog(){this._queueTask=new bI({name:"指令性能同步任务",parallel:1}),this._commandHook.onCommandHook((e=>{this._logCommandPerf(e)}))}async _logCommandPerf(e){this._commandLogs.push(e),this._startTaskWithDebounce()}_getCommandPerfData(e){const t={msg:"新数据表指令性能上报"},r={m1:0,m2:0,m3:0,m4:0,m5:0,m6:0,m7:0};for(const n of e)"setCell"===n.commandName?(t.m1=t.m1||0,r.m1+=1,t.m1=(t.m1+n.time)/r.m1):"switchView"===n.commandName?(t.m2=t.m2||0,r.m2+=1,t.m2=(t.m2+n.time)/r.m2):"addView"===n.commandName?(t.m3=t.m3||0,r.m3+=1,t.m3=(t.m3+n.time)/r.m3):"createFilter"===n.commandName||"updateFilter"===n.commandName||"removeFilter"===n.commandName?(t.m4=t.m4||0,r.m4+=1,t.m4=(t.m4+n.time)/r.m4):"createGridGroup"===n.commandName||"updateGridGroup"===n.commandName||"removeGridGroup"===n.commandName?(t.m5=t.m5||0,r.m5+=1,t.m5=(t.m5+n.time)/r.m5):"createSort"===n.commandName||"updateSort"===n.commandName||"removeSort"===n.commandName?(t.m6=t.m6||0,r.m6+=1,t.m6=(t.m6+n.time)/r.m6):"addEmptyRecord"===n.commandName&&(t.m7=t.m7||0,r.m7+=1,t.m7=(t.m7+n.time)/r.m7);return t.m1||t.m2||t.m3||t.m4||t.m5||t.m6||t.m7?(t.c1=this._readService.getRecords().length,t.c2=this._readService.getAllFields().length,t):null}_startTask(e){const t=this._configuration.getValue("monitor.sendLog"),r=this._getCommandPerfData(e);!r||(Qze("command perf: %j",r),null==t||t(61,r))}};Zze([ao(lp)],eHe.prototype,"_configuration",2),Zze([ao(xh)],eHe.prototype,"_lifeCycleService",2),Zze([ao(KO)],eHe.prototype,"_readService",2),Zze([ao(Yze)],eHe.prototype,"_commandHook",2),eHe=Zze([io()],eHe);var tHe="named",rHe="name",nHe="unmanaged",iHe="optional",oHe="inject",aHe="multi_inject",sHe="inversify:paramtypes",lHe="design:paramtypes",cHe="post_construct";var uHe=[oHe,aHe,rHe,nHe,tHe,iHe],dHe="Request",fHe="Singleton",hHe="Transient",pHe={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},gHe={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},mHe=0;function vHe(){return mHe++}var yHe=function(){function e(e,t){this.id=vHe(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=pHe.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===fHe&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}(),bHe="Cannot apply @injectable decorator multiple times.",_He="NULL argument",wHe="Key Not Found",CHe="Ambiguous match found for serviceIdentifier:",EHe="No matching bindings found for serviceIdentifier:",SHe="Missing required @injectable annotation in:",kHe="Missing required @inject or @multiInject annotation in:",xHe="Circular dependency found:",OHe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},IHe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},RHe="Maximum call stack size exceeded",THe=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(sHe,e),userGeneratedMetadata:Reflect.getMetadata("inversify:tagged",e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata("inversify:tagged_props",e)||[]},e}(),AHe={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function MHe(e){return e instanceof RangeError||e.message===RHe}function NHe(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function DHe(e,t,r){var n="",i=r(e,t);return 0!==i.length&&(n="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=FHe(e.implementationType)),n=n+"\n "+t,e.constraint.metaData&&(n=n+" - "+e.constraint.metaData)}))),n}function PHe(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||PHe(e.parentRequest,t))}function jHe(e){e.childRequests.forEach((function(e){if(PHe(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,r){void 0===r&&(r=[]);var n=NHe(t.serviceIdentifier);return r.push(n),null!==t.parentRequest?e(t.parentRequest,r):r}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(xHe+" "+t)}jHe(e)}))}function FHe(e){if(e.name)return e.name;var t=e.toString(),r=t.match(/^function\s*([^\s(]+)/);return r?r[1]:"Anonymous function: "+t}var VHe=function(){function e(e){this.id=vHe(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),LHe=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===tHe?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}(),$He=function(e,t){this.parentContext=e,this.rootRequest=t},BHe=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),UHe=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,r=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},r)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),zHe=function(){function e(e,t,r,n){this.id=vHe(),this.type=e,this.serviceIdentifier=r,this.name=new UHe(t||""),this.metadata=new Array;var i=null;"string"==typeof n?i=new LHe(tHe,n):n instanceof LHe&&(i=n),null!==i&&this.metadata.push(i)}return e.prototype.hasTag=function(e){for(var t=0,r=this.metadata;t<r.length;t++){if(r[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(aHe)},e.prototype.matchesArray=function(e){return this.matchesTag(aHe)(e)},e.prototype.isNamed=function(){return this.hasTag(tHe)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return uHe.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(iHe)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===tHe}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return uHe.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(tHe)(e)},e.prototype.matchesTag=function(e){var t=this;return function(r){for(var n=0,i=t.metadata;n<i.length;n++){var o=i[n];if(o.key===e&&o.value===r)return!0}return!1}},e}(),HHe=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};function WHe(e,t,r,n){var i=e.getConstructorMetadata(r),o=i.compilerGeneratedMetadata;if(void 0===o)throw new Error(SHe+" "+t+".");var a=i.userGeneratedMetadata,s=Object.keys(a),l=0===r.length&&s.length>0,c=s.length>r.length,u=function(e,t,r,n,i){for(var o=[],a=0;a<i;a++){var s=GHe(a,e,t,r,n);null!==s&&o.push(s)}return o}(n,t,o,a,l||c?s.length:r.length),d=KHe(e,r);return HHe(HHe([],u),d)}function GHe(e,t,r,n,i){var o=i[e.toString()]||[],a=YHe(o),s=!0!==a.unmanaged,l=n[e];if((l=a.inject||a.multiInject||l)instanceof BHe&&(l=l.unwrap()),s){if(!t&&(l===Object||l===Function||void 0===l))throw new Error(kHe+" argument "+e+" in class "+r+".");var c=new zHe(gHe.ConstructorArgument,a.targetName,l);return c.metadata=o,c}return null}function KHe(e,t){for(var r=e.getPropertiesMetadata(t),n=[],i=0,o=Object.keys(r);i<o.length;i++){var a=o[i],s=r[a],l=YHe(r[a]),c=l.targetName||a,u=l.inject||l.multiInject,d=new zHe(gHe.ClassProperty,c,u);d.metadata=s,n.push(d)}var f=Object.getPrototypeOf(t.prototype).constructor;if(f!==Object){var h=KHe(e,f);n=HHe(HHe([],n),h)}return n}function qHe(e,t){var r=Object.getPrototypeOf(t.prototype).constructor;if(r!==Object){var n=WHe(e,FHe(r),r,!0),i=n.map((function(e){return e.metadata.filter((function(e){return e.key===nHe}))})),o=[].concat.apply([],i).length,a=n.length-o;return a>0?a:qHe(e,r)}return 0}function YHe(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[oHe],multiInject:t[aHe],targetName:t[rHe],unmanaged:t[nHe]}}var JHe=function(){function e(e,t,r,n,i){this.id=vHe(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=r,this.target=i,this.childRequests=[],this.bindings=Array.isArray(n)?n:[n],this.requestScope=null===r?new Map:null}return e.prototype.addChildRequest=function(t,r,n){var i=new e(t,this.parentContext,this,r,n);return this.childRequests.push(i),i},e}();function XHe(e){return e._bindingDictionary}function ZHe(e,t,r,n,i){var o=eWe(r.container,i.serviceIdentifier),a=[];return o.length===AHe.NoBindingsAvailable&&r.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(i.serviceIdentifier).toSelf(),o=eWe(r.container,i.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new JHe(e.serviceIdentifier,r,n,e,i);return e.constraint(t)})),function(e,t,r,n){switch(t.length){case AHe.NoBindingsAvailable:if(r.isOptional())return t;var i=NHe(e),o=EHe;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var r="",n=t.getNamedTag(),i=t.getCustomTags();return null!==n&&(r+=n.toString()+"\n"),null!==i&&i.forEach((function(e){r+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+r}return" "+e}(i,r),o+=DHe(n,i,eWe),new Error(o);case AHe.OnlyOneBindingAvailable:if(!r.isArray())return t;case AHe.MultipleBindingsAvailable:default:if(r.isArray())return t;i=NHe(e),o=CHe+" "+i;throw o+=DHe(n,i,eWe),new Error(o)}}(i.serviceIdentifier,a,i,r.container),a}function QHe(e,t,r,n,i,o){var a,s;if(null===i){a=ZHe(e,t,n,null,o),s=new JHe(r,n,null,a,o);var l=new $He(n,s);n.addPlan(l)}else a=ZHe(e,t,n,i,o),s=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(t){var r=null;if(o.isArray())r=s.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;r=s}if(t.type===pHe.Instance&&null!==t.implementationType){var i=function(e,t){return WHe(e,FHe(t),t,!1)}(e,t.implementationType);if(!n.container.options.skipBaseClassChecks){var a=qHe(e,t.implementationType);if(i.length<a){var l=OHe(FHe(t.implementationType));throw new Error(l)}}i.forEach((function(t){QHe(e,!1,t.serviceIdentifier,n,r,t)}))}}))}function eWe(e,t){var r=[],n=XHe(e);return n.hasKey(t)?r=n.get(t):null!==e.parent&&(r=eWe(e.parent,t)),r}function tWe(e,t,r,n,i,o,a,s){void 0===s&&(s=!1);var l=new VHe(t),c=function(e,t,r,n,i,o){var a=new LHe(e?aHe:oHe,r),s=new zHe(t,n,r,a);if(void 0!==i){var l=new LHe(i,o);s.metadata.push(l)}return s}(r,n,i,"",o,a);try{return QHe(e,s,i,l,null,c),l}catch(e){throw MHe(e)&&l.plan&&jHe(l.plan.rootRequest),e}}var rWe=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e};function nWe(e,t,r){var n=null;t.length>0?(n=function(e,t){return new(e.bind.apply(e,rWe([void 0],t)))}(e,t.filter((function(e){return null!==e.target&&e.target.type===gHe.ConstructorArgument})).map(r)),n=function(e,t,r){var n=t.filter((function(e){return null!==e.target&&e.target.type===gHe.ClassProperty})),i=n.map(r);return n.forEach((function(t,r){var n;n=t.target.name.value();var o=i[r];e[n]=o})),e}(n,t,r)):n=new e;return function(e,t){if(Reflect.hasMetadata(cHe,e)){var r=Reflect.getMetadata(cHe,e);try{t[r.value]()}catch(t){throw new Error(IHe(e.name,t.message))}}}(e,n),n}var iWe=function(e,t,r){try{return r()}catch(r){throw MHe(r)?new Error(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."}(e,t.toString())):r}},oWe=function(e){return function(t){t.parentContext.setCurrentRequest(t);var r=t.bindings,n=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return n.map((function(t){return oWe(e)(t)}));var a=null;if(!t.target.isOptional()||0!==r.length){var s=r[0],l=s.scope===fHe,c=s.scope===dHe;if(l&&s.activated)return s.cache;if(c&&null!==e&&e.has(s.id))return e.get(s.id);if(s.type===pHe.ConstantValue)a=s.cache,s.activated=!0;else if(s.type===pHe.Function)a=s.cache,s.activated=!0;else if(s.type===pHe.Constructor)a=s.implementationType;else if(s.type===pHe.DynamicValue&&null!==s.dynamicValue)a=iWe("toDynamicValue",s.serviceIdentifier,(function(){return s.dynamicValue(t.parentContext)}));else if(s.type===pHe.Factory&&null!==s.factory)a=iWe("toFactory",s.serviceIdentifier,(function(){return s.factory(t.parentContext)}));else if(s.type===pHe.Provider&&null!==s.provider)a=iWe("toProvider",s.serviceIdentifier,(function(){return s.provider(t.parentContext)}));else{if(s.type!==pHe.Instance||null===s.implementationType){var u=NHe(t.serviceIdentifier);throw new Error("Invalid binding type: "+u)}a=nWe(s.implementationType,n,oWe(e))}return"function"==typeof s.onActivation&&(a=s.onActivation(t.parentContext,a)),l&&(s.cache=a,s.activated=!0),c&&null!==e&&!e.has(s.id)&&e.set(s.id,a),a}}};var aWe,sWe,lWe,cWe=function(e,t){var r=e.parentRequest;return null!==r&&(!!t(r)||cWe(r,t))},uWe=function(e){return function(t){var r=function(r){return null!==r&&null!==r.target&&r.target.matchesTag(e)(t)};return r.metaData=new LHe(e,t),r}},dWe=uWe(tHe),fWe=function(e){return function(t){var r=null;if(null!==t){if(r=t.bindings[0],"string"==typeof e)return r.serviceIdentifier===e;var n=t.bindings[0].implementationType;return e===n}return!1}},hWe=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new pWe(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=dWe(e),new pWe(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new pWe(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=uWe(e)(t),new pWe(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return fWe(e)(t.parentRequest)},new pWe(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return dWe(e)(t.parentRequest)},new pWe(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(r){return uWe(e)(t)(r.parentRequest)},new pWe(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return cWe(t,fWe(e))},new pWe(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!cWe(t,fWe(e))},new pWe(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return cWe(t,dWe(e))},new pWe(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!cWe(t,dWe(e))},new pWe(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(r){return cWe(r,uWe(e)(t))},new pWe(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(r){return!cWe(r,uWe(e)(t))},new pWe(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return cWe(t,e)},new pWe(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!cWe(t,e)},new pWe(this._binding)},e}(),pWe=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new hWe(this._binding)},e}(),gWe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new hWe(this._binding),this._bindingOnSyntax=new pWe(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),mWe=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=dHe,new gWe(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=fHe,new gWe(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=hHe,new gWe(this._binding)},e}(),vWe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new hWe(this._binding),this._bindingOnSyntax=new pWe(this._binding),this._bindingInSyntax=new mWe(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),yWe=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=pHe.Instance,this._binding.implementationType=e,new vWe(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=pHe.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=fHe,new gWe(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=pHe.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new vWe(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=pHe.Constructor,this._binding.implementationType=e,this._binding.scope=fHe,new gWe(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=pHe.Factory,this._binding.factory=e,this._binding.scope=fHe,new gWe(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error("Value provided to function binding must be a function!");var t=this.toConstantValue(e);return this._binding.type=pHe.Function,this._binding.scope=fHe,t},e.prototype.toAutoFactory=function(e){return this._binding.type=pHe.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=fHe,new gWe(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=pHe.Provider,this._binding.provider=e,this._binding.scope=fHe,new gWe(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),bWe=function(){function e(){}return e.of=function(t,r){var n=new e;return n.bindings=t,n.middleware=r,n},e}(),_We=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(_He);if(null==t)throw new Error(_He);var r=this._map.get(e);void 0!==r?(r.push(t),this._map.set(e,r)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(_He);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(wHe)},e.prototype.remove=function(e){if(null==e)throw new Error(_He);if(!this._map.delete(e))throw new Error(wHe)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(r,n){var i=r.filter((function(t){return!e(t)}));i.length>0?t._map.set(n,i):t._map.delete(n)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(_He);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,r){e.forEach((function(e){return t.add(r,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,r){e(r,t)}))},e}(),wWe=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))},CWe=globalThis&&globalThis.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},EWe=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},SWe=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===t.defaultScope)t.defaultScope=hHe;else if(t.defaultScope!==fHe&&t.defaultScope!==hHe&&t.defaultScope!==dHe)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=vHe(),this._bindingDictionary=new _We,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new THe}return e.merge=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new e,a=EWe([t,r],n).map((function(e){return XHe(e)})),s=XHe(o);return a.forEach((function(e){!function(e,t){e.traverse((function(e,r){r.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}(e,s)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._getContainerModuleHelpersFactory(),n=0,i=e;n<i.length;n++){var o=i[n],a=r(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return wWe(this,void 0,void 0,(function(){var t,r,n,i,o;return CWe(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),r=0,n=e,a.label=1;case 1:return r<n.length?(i=n[r],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){var r=function(e){return function(t){return t.moduleId===e}}(t.id);e._bindingDictionary.removeByCondition(r)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||hHe,r=new yHe(e,t);return this._bindingDictionary.add(e,r),new yWe(r)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error("Could not unbind serviceIdentifier: "+NHe(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new _We},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,tHe,t)},e.prototype.isBoundTagged=function(e,t,r){var n=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=function(e,t,r,n){var i=new zHe(gHe.Variable,"",t,new LHe(r,n)),o=new VHe(e);return new JHe(t,o,null,[],i)}(this,e,t,r);n=i.some((function(e){return e.constraint(o)}))}return!n&&this.parent&&(n=this.parent.isBoundTagged(e,t,r)),n},e.prototype.snapshot=function(){this._snapshots.push(bWe.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var r=new e(t||this.options);return r.parent=this,r},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),r)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,gHe.Variable,e)},e.prototype.getTagged=function(e,t,r){return this._get(!1,!1,gHe.Variable,e,t,r)},e.prototype.getNamed=function(e,t){return this.getTagged(e,tHe,t)},e.prototype.getAll=function(e){return this._get(!0,!0,gHe.Variable,e)},e.prototype.getAllTagged=function(e,t,r){return this._get(!1,!0,gHe.Variable,e,t,r)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,tHe,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},r=function(r){return function(n){var i=e.bind.bind(e)(n);return t(i,r),i}},n=function(r){return function(n){var i=e.rebind.bind(e)(n);return t(i,r),i}};return function(t){return{bindFunction:r(t),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(t),unbindFunction:function(t){e.unbind.bind(e)(t)}}}},e.prototype._get=function(e,t,r,n,i,o){var a=null,s={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:n,targetType:r,value:o};if(this._middleware){if(null==(a=this._middleware(s)))throw new Error("Invalid return type in middleware. Middleware must return!")}else a=this._planAndResolve()(s);return a},e.prototype._planAndResolve=function(){var e=this;return function(t){var r=tWe(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints),n=function(e){return oWe(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(r=t.contextInterceptor(r));return n}},e}();function kWe(e){return kWe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kWe(e)}function xWe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function OWe(e,t,r){return t&&xWe(e.prototype,t),r&&xWe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IWe(e){return IWe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},IWe(e)}function RWe(e,t){return t.lifecycle===sWe.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function TWe(e,t){e.whenTargetNamed(NWe(t))}function AWe(e,t){return t.bind(DWe(e))}function MWe(e,t){if(t.isBound(DWe(e)))try{return t.rebind(DWe(e))}catch{return t.bind(DWe(e))}return t.bind(DWe(e))}function NWe(e){return lWe.isDefinedToken(e)?e.symbol:e}function DWe(e){return lWe.isDefinedToken(e)?e.symbol:e}!function(e){!function(t){var r="object"==typeof Qt?Qt:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(e);function i(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}typeof r.Reflect>"u"?r.Reflect=e:n=i(r.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",i=r&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,l={create:o?function(){return ne(Object.create(null))}:a?function(){return ne({__proto__:null})}:function(){return ne({})},has:s?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:s?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof er.exports&&er.exports.env&&"true"===er.exports.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,f=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,h=new(u||"function"!=typeof WeakMap?re():WeakMap);function p(e,t,r,n){if(P(r)){if(!H(e))throw new TypeError;if(!G(t))throw new TypeError;return S(e,t)}if(!H(e))throw new TypeError;if(!V(t))throw new TypeError;if(!V(n)&&!P(n)&&!j(n))throw new TypeError;return j(n)&&(n=void 0),k(e,t,r=z(r),n)}function g(e,t){function r(r,n){if(!V(r))throw new TypeError;if(!P(n)&&!K(n))throw new TypeError;A(e,t,r,n)}return r}function m(e,t,r,n){if(!V(r))throw new TypeError;return P(n)||(n=z(n)),A(e,t,r,n)}function v(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),O(e,t,r)}function y(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),I(e,t,r)}function b(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),R(e,t,r)}function _(e,t,r){if(!V(t))throw new TypeError;return P(r)||(r=z(r)),T(e,t,r)}function w(e,t){if(!V(e))throw new TypeError;return P(t)||(t=z(t)),M(e,t)}function C(e,t){if(!V(e))throw new TypeError;return P(t)||(t=z(t)),N(e,t)}function E(e,t,r){if(!V(t))throw new TypeError;P(r)||(r=z(r));var n=x(t,r,!1);if(P(n)||!n.delete(e))return!1;if(n.size>0)return!0;var i=h.get(t);return i.delete(r),i.size>0||h.delete(t),!0}function S(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!P(n)&&!j(n)){if(!G(n))throw new TypeError;t=n}}return t}function k(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!P(o)&&!j(o)){if(!V(o))throw new TypeError;n=o}}return n}function x(e,t,r){var n=h.get(e);if(P(n)){if(!r)return;n=new d,h.set(e,n)}var i=n.get(t);if(P(i)){if(!r)return;i=new d,n.set(t,i)}return i}function O(e,t,r){if(I(e,t,r))return!0;var n=Q(t);return!j(n)&&O(e,n,r)}function I(e,t,r){var n=x(t,r,!1);return!P(n)&&B(n.has(e))}function R(e,t,r){if(I(e,t,r))return T(e,t,r);var n=Q(t);return j(n)?void 0:R(e,n,r)}function T(e,t,r){var n=x(t,r,!1);if(!P(n))return n.get(e)}function A(e,t,r,n){x(r,n,!0).set(e,t)}function M(e,t){var r=N(e,t),n=Q(e);if(null===n)return r;var i=M(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new f,a=[],s=0,l=r;s<l.length;s++){var c=l[s];o.has(c)||(o.add(c),a.push(c))}for(var u=0,d=i;u<d.length;u++){c=d[u];o.has(c)||(o.add(c),a.push(c))}return a}function N(e,t){var r=[],n=x(e,t,!1);if(P(n))return r;for(var i=Y(n.keys()),o=0;;){var a=X(i);if(!a)return r.length=o,r;var s=J(a);try{r[o]=s}catch(e){try{Z(i)}finally{throw e}}o++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function P(e){return void 0===e}function j(e){return null===e}function F(e){return"symbol"==typeof e}function V(e){return"object"==typeof e?null!==e:"function"==typeof e}function L(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=q(e,n);if(void 0!==i){var o=i.call(e,r);if(V(o))throw new TypeError;return o}return $(e,"default"===r?"number":r)}function $(e,t){if("string"===t){var r=e.toString;if(W(r))if(!V(i=r.call(e)))return i;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i}else{var n;if(W(n=e.valueOf))if(!V(i=n.call(e)))return i;var i,o=e.toString;if(W(o))if(!V(i=o.call(e)))return i}throw new TypeError}function B(e){return!!e}function U(e){return""+e}function z(e){var t=L(e,3);return F(t)?t:U(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function G(e){return"function"==typeof e}function K(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function q(e,t){var r=e[t];if(null!=r){if(!W(r))throw new TypeError;return r}}function Y(e){var t=q(e,i);if(!W(t))throw new TypeError;var r=t.call(e);if(!V(r))throw new TypeError;return r}function J(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c||t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=l.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(l.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:l.create()})}return e[n]}function a(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(e)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];(4===n||6===n||8===n)&&(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",m),e("hasMetadata",v),e("hasOwnMetadata",y),e("getMetadata",b),e("getOwnMetadata",_),e("getMetadataKeys",w),e("getOwnMetadataKeys",C),e("deleteMetadata",E)}(n)}()}(aWe||(aWe={})),function(e){e.defineToken=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new e.DefinedToken(t,r)};var t,r=OWe((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var n=r.multiple,i=void 0!==n&&n;this.name=t,this.symbol=Symbol(this.name),this.multiple=i}));e.DefinedToken=r,e.isModule=function(e){return!!e&&"object"===kWe(e)&&"id"in e},function(e){e.singleton="singleton",e.transient="transient"}(t=e.Lifecycle||(e.Lifecycle={})),e.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),e.DefaultOption={lifecycle:t.transient}}(sWe||(sWe={})),function(e){e.toArray=function(e){return Array.isArray(e)?e:void 0===e?[]:[e]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"===kWe(e)&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!==kWe(e)||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"===kWe(e)&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}}(lWe||(lWe={}));var PWe=new SWe;function jWe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function FWe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jWe(Object(r),!0).forEach((function(t){VWe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jWe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function VWe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var LWe=Symbol("SyringeOptionSymbol");function $We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function BWe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$We(Object(r),!0).forEach((function(t){UWe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$We(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function UWe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zWe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var HWe=function(){function e(t,r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.register=void 0,this.mutiple=void 0,this.register=t,this.token=r,this.option=n,this.rawToken=lWe.isNamedToken(r)?r.token:r,this.named=lWe.isNamedToken(r)?r.named:void 0,this.mutiple=!!this.named||lWe.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return function(e,t,r){t&&zWe(e.prototype,t),r&&zWe(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"resolve",value:function(){var e=this,t=this.register;!function(e){return e&&"object"===IWe(e)&&"bind"in e&&"unbind"in e&&"rebind"in e&&"isBound"in e}(t)||(this.mutiple?this.resolveMutilple(t):(this.resolveMono(t),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(r){lWe.isMultipleEnabled(r)?AWe(r,t).toService(e.generalToken):MWe(r,t).toService(e.generalToken)}))))}},{key:"resolveMono",value:function(e){if("useValue"in this.option)return MWe(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var t=this.option.useDynamic[this.option.useDynamic.length-1];return RWe(MWe(this.generalToken,e).toDynamicValue((function(e){var r=iGe.getContainer(e.container);return t({container:r})})),this.option)}if(this.option.useFactory.length>0){var r=this.option.useFactory[this.option.useFactory.length-1];return MWe(this.generalToken,e).toFactory((function(e){var t=iGe.getContainer(e.container);return r({container:t})}))}if(this.option.useClass.length>0){var n=this.option.useClass[this.option.useClass.length-1];return RWe(MWe(this.generalToken,e).to(n),this.option)}}},{key:"resolveMutilple",value:function(e){var t=this,r=this.option.useClass.map((function(r){return RWe(AWe(t.generalToken,e).to(r),t.option)})),n=this.option.useDynamic.map((function(r){return RWe(AWe(t.generalToken,e).toDynamicValue((function(e){var t=iGe.getContainer(e.container);return r({container:t})})),t.option)})),i=this.option.useFactory.map((function(r){return AWe(t.generalToken,e).toFactory((function(e){var t=iGe.getContainer(e.container);return r({container:t})}))})),o="useValue"in this.option?AWe(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(r.forEach((function(e){return t.named&&TWe(e,t.named)})),n.forEach((function(e){return t.named&&TWe(e,t.named)})),i.forEach((function(e){return t.named&&TWe(e,t.named)})),o&&TWe(o,this.named))}}],[{key:"resolveTarget",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var i=Reflect.getMetadata(LWe,r);i&&e.resolveOption(t,i)}catch{}if(lWe.isClass(r))if(n.useClass){var o=lWe.toArray(n.useClass);o.unshift(r),n.useClass=o}else n.useClass=[r];var a;try{a=Reflect.getMetadata(sWe.ClassOptionSymbol,r)}catch{}if((a=BWe(BWe({},a||{}),n)).token){var s=lWe.toArray(a.token);s.unshift(r),a.token=s}else a.token=[r];e.resolveOption(t,a)}catch{}}},{key:"resolveOption",value:function(t,r){var n=function(e){var t=lWe.toArray(e.token),r=lWe.toArray(e.useClass),n=lWe.toArray(e.useDynamic),i=lWe.toArray(e.useFactory),o=lWe.toArray(e.contrib),a=e.lifecycle||sWe.Lifecycle.transient,s={token:t,useClass:r,lifecycle:o.length>0?sWe.Lifecycle.singleton:a,contrib:o,useDynamic:n,useFactory:i};return"useValue"in e&&(s.useValue=e.useValue),s}(BWe(BWe({},e.globalConfig),r));0===n.useClass.length&&0===n.useDynamic.length&&0===n.useFactory.length&&!("useValue"in n)||n.token.forEach((function(r){new e(t,r,BWe({},n)).resolve()}))}}]),e}();HWe.globalConfig=sWe.DefaultOption;var WWe=sWe.defineToken("ContributionProvider");function GWe(e){return function(e){if(Array.isArray(e))return KWe(e)}(e)||function(e){if(typeof Symbol<"u"&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return KWe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KWe(e,t)}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KWe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qWe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function YWe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qWe(Object(r),!0).forEach((function(t){JWe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qWe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function JWe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XWe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ZWe=function(){function e(t,r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=r,this.serviceIdentifier=t,n&&(this.option=YWe(YWe({},this.option),n))}return function(e,t,r){t&&XWe(e.prototype,t),r&&XWe(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"setServices",value:function(e){for(var t=[],r=this.container;r;){if(r.isBound(this.serviceIdentifier)){var n=r.getAll(this.serviceIdentifier);t.push.apply(t,GWe(n))}r=e?r.parent:void 0}return t}},{key:"getContributions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=YWe(YWe({},this.option),e),r=t.cache,n=t.recursive;return(!r||void 0===this.services)&&(this.services=this.setServices(!!n)),this.services}}]),e}();function QWe(e,t,r){e({token:{token:WWe,named:t},useDynamic:function(e){return new ZWe(t,e.container,r)},lifecycle:sWe.Lifecycle.singleton})}function eGe(e){return e&&"inversifyModule"in e}function tGe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var rGe,nGe=new Map,iGe=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new SWe,e.setContainer(this.container,this)}return function(e,t,r){t&&tGe(e.prototype,t),r&&tGe(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"load",value:function(e,t){var r=this;return t||!this.loadedModules.includes(e.id)?(eGe(e)?this.container.load(e.inversifyModule):console.warn("Unsupported module.",e),this.loadedModules.push(e.id),{dispose:function(){r.unload(e)}}):{dispose:function(){}}}},{key:"unload",value:function(e){eGe(e)&&(this.container.unload(e.inversifyModule),this.loadedModules=this.loadedModules.filter((function(t){return t!==e.id})))}},{key:"remove",value:function(e){return this.container.unbind(DWe(e))}},{key:"get",value:function(e){return this.container.get(DWe(e))}},{key:"getNamed",value:function(e,t){return this.container.getNamed(DWe(e),NWe(t))}},{key:"getAll",value:function(e){return this.container.getAll(DWe(e))}},{key:"getAllNamed",value:function(e,t){return this.container.getAllNamed(DWe(e),NWe(t))}},{key:"isBound",value:function(e){return this.container.isBound(DWe(e))}},{key:"isBoundNamed",value:function(e,t){return this.container.isBoundNamed(DWe(e),NWe(t))}},{key:"createChild",value:function(){var t=new e(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};lWe.isInjectOption(e)?HWe.resolveOption(this.container,e):HWe.resolveTarget(this.container,e,t)}}],[{key:"setContainer",value:function(e,t){return nGe.set(e.id,t)}},{key:"getContainer",value:function(t){var r=nGe.get(t.id);if(!r){var n=new e(t);return e.setContainer(t,n),n}return r}},{key:"config",value:function(e){HWe.globalConfig=e}}]),e}(),oGe=new iGe(PWe);oGe.register.bind(oGe),function(e){e.Provider=WWe,e.register=QWe}(rGe||(rGe={}));var aGe=Object.defineProperty,sGe=Object.getOwnPropertyDescriptor;let lGe=class{constructor(){this.commandName=""}beforeExecute(e){return e._executeAt=TN(),e}afterExecute(e,t){this.commandHook.emitHook({commandName:this.commandName,time:AN(t._executeAt,TN())})}};lGe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?sGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&aGe(t,r,o),o})([function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(e){if(Reflect.hasOwnMetadata(sHe,e))throw new Error(bHe);var t=Reflect.getMetadata(lHe,e)||[];return Reflect.defineMetadata(sHe,t,e),e};return function(r){Reflect.defineMetadata(sWe.ClassOptionSymbol,FWe(FWe({},e),{},{target:r}),r),t(r)}}()],lGe);var cGe=Object.defineProperty,uGe=Object.getOwnPropertyDescriptor,dGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cGe(t,r,o),o};let fGe=class extends lGe{constructor(){super(...arguments),this.commandName="setCell"}};dGe([ao(Yze)],fGe.prototype,"commandHook",2),fGe=dGe([io()],fGe);var hGe=Object.defineProperty,pGe=Object.getOwnPropertyDescriptor,gGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?pGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hGe(t,r,o),o};let mGe=class extends lGe{constructor(){super(...arguments),this.commandName="switchView"}};gGe([ao(Yze)],mGe.prototype,"commandHook",2),mGe=gGe([io()],mGe);var vGe=Object.defineProperty,yGe=Object.getOwnPropertyDescriptor,bGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?yGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&vGe(t,r,o),o};let _Ge=class extends lGe{constructor(){super(...arguments),this.commandName="createFilter"}};bGe([ao(Yze)],_Ge.prototype,"commandHook",2),_Ge=bGe([io()],_Ge);var wGe=Object.defineProperty,CGe=Object.getOwnPropertyDescriptor,EGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?CGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wGe(t,r,o),o};let SGe=class extends lGe{constructor(){super(...arguments),this.commandName="removeFilter"}};EGe([ao(Yze)],SGe.prototype,"commandHook",2),SGe=EGe([io()],SGe);var kGe=Object.defineProperty,xGe=Object.getOwnPropertyDescriptor,OGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?xGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&kGe(t,r,o),o};let IGe=class extends lGe{constructor(){super(...arguments),this.commandName="updateFilter"}};OGe([ao(Yze)],IGe.prototype,"commandHook",2),IGe=OGe([io()],IGe);var RGe=Object.defineProperty,TGe=Object.getOwnPropertyDescriptor,AGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?TGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&RGe(t,r,o),o};let MGe=class extends lGe{constructor(){super(...arguments),this.commandName="createGridGroup"}};AGe([ao(Yze)],MGe.prototype,"commandHook",2),MGe=AGe([io()],MGe);var NGe=Object.defineProperty,DGe=Object.getOwnPropertyDescriptor,PGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?DGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&NGe(t,r,o),o};let jGe=class extends lGe{constructor(){super(...arguments),this.commandName="removeGridGroup"}};PGe([ao(Yze)],jGe.prototype,"commandHook",2),jGe=PGe([io()],jGe);var FGe=Object.defineProperty,VGe=Object.getOwnPropertyDescriptor,LGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?VGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&FGe(t,r,o),o};let $Ge=class extends lGe{constructor(){super(...arguments),this.commandName="updateGridGroup"}};LGe([ao(Yze)],$Ge.prototype,"commandHook",2),$Ge=LGe([io()],$Ge);var BGe=Object.defineProperty,UGe=Object.getOwnPropertyDescriptor,zGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?UGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BGe(t,r,o),o};let HGe=class extends lGe{constructor(){super(...arguments),this.commandName="createSort"}};zGe([ao(Yze)],HGe.prototype,"commandHook",2),HGe=zGe([io()],HGe);var WGe=Object.defineProperty,GGe=Object.getOwnPropertyDescriptor,KGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?GGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WGe(t,r,o),o};let qGe=class extends lGe{constructor(){super(...arguments),this.commandName="removeSort"}};KGe([ao(Yze)],qGe.prototype,"commandHook",2),qGe=KGe([io()],qGe);var YGe=Object.defineProperty,JGe=Object.getOwnPropertyDescriptor,XGe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?JGe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&YGe(t,r,o),o};let ZGe=class extends lGe{constructor(){super(...arguments),this.commandName="updateSort"}};XGe([ao(Yze)],ZGe.prototype,"commandHook",2),ZGe=XGe([io()],ZGe);var QGe=Object.defineProperty,eKe=Object.getOwnPropertyDescriptor,tKe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?eKe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&QGe(t,r,o),o};let rKe=class extends lGe{constructor(){super(...arguments),this.commandName="addView"}};tKe([ao(Yze)],rKe.prototype,"commandHook",2),rKe=tKe([io()],rKe);var nKe=Object.defineProperty,iKe=Object.getOwnPropertyDescriptor,oKe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iKe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nKe(t,r,o),o};let aKe=class extends lGe{constructor(){super(...arguments),this.commandName="addEmptyRecord"}};oKe([ao(Yze)],aKe.prototype,"commandHook",2),aKe=oKe([io()],aKe);var sKe=Object.defineProperty,lKe=Object.getOwnPropertyDescriptor,cKe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?lKe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&sKe(t,r,o),o};let uKe=class{static pluginModule(){return xo().register(eHe).register(Yze).register(fGe).register(rKe).register(mGe).register(_Ge).register(SGe).register(IGe).register(MGe).register(jGe).register($Ge).register(HGe).register(qGe).register(ZGe).register(aKe).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"monitor",type:"object",properties:{sendLog:{typeof:"function",description:"外部传入的日志处理对象"},startAt:{type:"number",description:"编辑器开始加载时间"}}})}init(){this._initHooks(),this._monitorService.startMainPerfLog(),this._monitorService.startCommandPerfLog()}_initHooks(){this._commandRegistry.registerCommandHook(this._setCellCommandHook.commandName,this._setCellCommandHook),this._commandRegistry.registerCommandHook(this._switchViewCommandHook.commandName,this._switchViewCommandHook),this._commandRegistry.registerCommandHook(this._addViewCommandHook.commandName,this._addViewCommandHook),this._commandRegistry.registerCommandHook(this._createFilterCellCommandHook.commandName,this._createFilterCellCommandHook),this._commandRegistry.registerCommandHook(this._removeFilterCellCommandHook.commandName,this._removeFilterCellCommandHook),this._commandRegistry.registerCommandHook(this._updateFilterCellCommandHook.commandName,this._updateFilterCellCommandHook),this._commandRegistry.registerCommandHook(this._createGroupCellCommandHook.commandName,this._createGroupCellCommandHook),this._commandRegistry.registerCommandHook(this._removeGroupCellCommandHook.commandName,this._removeGroupCellCommandHook),this._commandRegistry.registerCommandHook(this._updateGroupCellCommandHook.commandName,this._updateGroupCellCommandHook),this._commandRegistry.registerCommandHook(this._createSortCellCommandHook.commandName,this._createSortCellCommandHook),this._commandRegistry.registerCommandHook(this._removeSortCellCommandHook.commandName,this._removeSortCellCommandHook),this._commandRegistry.registerCommandHook(this._updateSortCellCommandHook.commandName,this._updateSortCellCommandHook),this._commandRegistry.registerCommandHook(this._addEmptyRecordCommandHook.commandName,this._addEmptyRecordCommandHook)}};uKe.pluginName="kernel-monitor",cKe([ao(eHe)],uKe.prototype,"_monitorService",2),cKe([ao(jI)],uKe.prototype,"_commandRegistry",2),cKe([ao(fGe)],uKe.prototype,"_setCellCommandHook",2),cKe([ao(mGe)],uKe.prototype,"_switchViewCommandHook",2),cKe([ao(rKe)],uKe.prototype,"_addViewCommandHook",2),cKe([ao(_Ge)],uKe.prototype,"_createFilterCellCommandHook",2),cKe([ao(SGe)],uKe.prototype,"_removeFilterCellCommandHook",2),cKe([ao(IGe)],uKe.prototype,"_updateFilterCellCommandHook",2),cKe([ao(MGe)],uKe.prototype,"_createGroupCellCommandHook",2),cKe([ao(jGe)],uKe.prototype,"_removeGroupCellCommandHook",2),cKe([ao($Ge)],uKe.prototype,"_updateGroupCellCommandHook",2),cKe([ao(HGe)],uKe.prototype,"_createSortCellCommandHook",2),cKe([ao(qGe)],uKe.prototype,"_removeSortCellCommandHook",2),cKe([ao(ZGe)],uKe.prototype,"_updateSortCellCommandHook",2),cKe([ao(aKe)],uKe.prototype,"_addEmptyRecordCommandHook",2),uKe=cKe([io({contrib:[nR]})],uKe);const dKe=$i.defineToken("ServerContribution"),fKe=$i.defineToken("SyncQueueToken");var hKe=(e=>(e.RUNNING="running",e.SUCCESS="success",e))(hKe||{});const pKe="object"==typeof hr&&hr&&hr.Object===Object&&hr;var gKe="object"==typeof self&&self&&self.Object===Object&&self;const mKe=pKe||gKe||Function("return this")();const vKe=mKe.Symbol;var yKe=Object.prototype,bKe=yKe.hasOwnProperty,_Ke=yKe.toString,wKe=vKe?vKe.toStringTag:void 0;var CKe=Object.prototype.toString;var EKe="[object Null]",SKe="[object Undefined]",kKe=vKe?vKe.toStringTag:void 0;function xKe(e){return null==e?void 0===e?SKe:EKe:kKe&&kKe in Object(e)?function(e){var t=bKe.call(e,wKe),r=e[wKe];try{e[wKe]=void 0;var n=!0}catch{}var i=_Ke.call(e);return n&&(t?e[wKe]=r:delete e[wKe]),i}(e):function(e){return CKe.call(e)}(e)}function OKe(e){return null!=e&&"object"==typeof e}var IKe="[object Symbol]";function RKe(e){return"symbol"==typeof e||OKe(e)&&xKe(e)==IKe}const TKe=Array.isArray;var AKe=1/0,MKe=vKe?vKe.prototype:void 0,NKe=MKe?MKe.toString:void 0;function DKe(e){if("string"==typeof e)return e;if(TKe(e))return function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(e,DKe)+"";if(RKe(e))return NKe?NKe.call(e):"";var t=e+"";return"0"==t&&1/e==-AKe?"-0":t}var PKe=/\s/;var jKe=/^\s+/;function FKe(e){return e&&e.slice(0,function(e){for(var t=e.length;t--&&PKe.test(e.charAt(t)););return t}(e)+1).replace(jKe,"")}function VKe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var LKe=NaN,$Ke=/^[-+]0x[0-9a-f]+$/i,BKe=/^0b[01]+$/i,UKe=/^0o[0-7]+$/i,zKe=parseInt;function HKe(e){if("number"==typeof e)return e;if(RKe(e))return LKe;if(VKe(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=VKe(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=FKe(e);var r=BKe.test(e);return r||UKe.test(e)?zKe(e.slice(2),r?2:8):$Ke.test(e)?LKe:+e}function WKe(e){return e}var GKe="[object AsyncFunction]",KKe="[object Function]",qKe="[object GeneratorFunction]",YKe="[object Proxy]";function JKe(e){if(!VKe(e))return!1;var t=xKe(e);return t==KKe||t==qKe||t==GKe||t==YKe}const XKe=mKe["__core-js_shared__"];var ZKe=function(){var e=/[^.]+$/.exec(XKe&&XKe.keys&&XKe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var QKe=Function.prototype.toString;function eqe(e){if(null!=e){try{return QKe.call(e)}catch{}try{return e+""}catch{}}return""}var tqe=/^\[object .+?Constructor\]$/,rqe=Function.prototype,nqe=Object.prototype,iqe=rqe.toString,oqe=nqe.hasOwnProperty,aqe=RegExp("^"+iqe.call(oqe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function sqe(e){return!(!VKe(e)||function(e){return!!ZKe&&ZKe in e}(e))&&(JKe(e)?aqe:tqe).test(eqe(e))}function lqe(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return sqe(r)?r:void 0}const cqe=lqe(mKe,"WeakMap");function uqe(e){return e!=e}function dqe(e,t){return!!(null==e?0:e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,uqe,r)}(e,t,0)>-1}var fqe=9007199254740991,hqe=/^(?:0|[1-9]\d*)$/;function pqe(e,t){var r=typeof e;return!!(t=null==t?fqe:t)&&("number"==r||"symbol"!=r&&hqe.test(e))&&e>-1&&e%1==0&&e<t}function gqe(e,t){return e===t||e!=e&&t!=t}var mqe=9007199254740991;function vqe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=mqe}var yqe=Object.prototype;function bqe(e){return OKe(e)&&"[object Arguments]"==xKe(e)}var _qe=Object.prototype,wqe=_qe.hasOwnProperty,Cqe=_qe.propertyIsEnumerable,Eqe=bqe(function(){return arguments}())?bqe:function(e){return OKe(e)&&wqe.call(e,"callee")&&!Cqe.call(e,"callee")};const Sqe=Eqe;var kqe="object"==typeof exports&&exports&&!exports.nodeType&&exports,xqe=kqe&&"object"==typeof n&&n&&!n.nodeType&&n,Oqe=xqe&&xqe.exports===kqe?mKe.Buffer:void 0;const Iqe=(Oqe?Oqe.isBuffer:void 0)||function(){return!1};var Rqe={};Rqe["[object Float32Array]"]=Rqe["[object Float64Array]"]=Rqe["[object Int8Array]"]=Rqe["[object Int16Array]"]=Rqe["[object Int32Array]"]=Rqe["[object Uint8Array]"]=Rqe["[object Uint8ClampedArray]"]=Rqe["[object Uint16Array]"]=Rqe["[object Uint32Array]"]=!0,Rqe["[object Arguments]"]=Rqe["[object Array]"]=Rqe["[object ArrayBuffer]"]=Rqe["[object Boolean]"]=Rqe["[object DataView]"]=Rqe["[object Date]"]=Rqe["[object Error]"]=Rqe["[object Function]"]=Rqe["[object Map]"]=Rqe["[object Number]"]=Rqe["[object Object]"]=Rqe["[object RegExp]"]=Rqe["[object Set]"]=Rqe["[object String]"]=Rqe["[object WeakMap]"]=!1;var Tqe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Aqe=Tqe&&"object"==typeof n&&n&&!n.nodeType&&n,Mqe=Aqe&&Aqe.exports===Tqe&&pKe.process,Nqe=function(){try{return Aqe&&Aqe.require&&Aqe.require("util").types||Mqe&&Mqe.binding&&Mqe.binding("util")}catch{}}();var Dqe=Nqe&&Nqe.isTypedArray,Pqe=Dqe?function(e){return function(t){return e(t)}}(Dqe):function(e){return OKe(e)&&vqe(e.length)&&!!Rqe[xKe(e)]};const jqe=Pqe;var Fqe=Object.prototype.hasOwnProperty;function Vqe(e,t){var r=TKe(e),n=!r&&Sqe(e),i=!r&&!n&&Iqe(e),o=!r&&!n&&!i&&jqe(e),a=r||n||i||o,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=s.length;for(var c in e)(t||Fqe.call(e,c))&&(!a||!("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||pqe(c,l)))&&s.push(c);return s}var Lqe=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object);const $qe=Lqe;var Bqe=Object.prototype.hasOwnProperty;function Uqe(e){if(!function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||yqe)}(e))return $qe(e);var t=[];for(var r in Object(e))Bqe.call(e,r)&&"constructor"!=r&&t.push(r);return t}function zqe(e){return function(e){return null!=e&&vqe(e.length)&&!JKe(e)}(e)?Vqe(e):Uqe(e)}var Hqe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wqe=/^\w*$/;function Gqe(e,t){if(TKe(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!RKe(e))||(Wqe.test(e)||!Hqe.test(e)||null!=t&&e in Object(t))}const Kqe=lqe(Object,"create");var qqe=Object.prototype.hasOwnProperty;var Yqe=Object.prototype.hasOwnProperty;function Jqe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Xqe(e,t){for(var r=e.length;r--;)if(gqe(e[r][0],t))return r;return-1}Jqe.prototype.clear=function(){this.__data__=Kqe?Kqe(null):{},this.size=0},Jqe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Jqe.prototype.get=function(e){var t=this.__data__;if(Kqe){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return qqe.call(t,e)?t[e]:void 0},Jqe.prototype.has=function(e){var t=this.__data__;return Kqe?void 0!==t[e]:Yqe.call(t,e)},Jqe.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Kqe&&void 0===t?"__lodash_hash_undefined__":t,this};var Zqe=Array.prototype.splice;function Qqe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Qqe.prototype.clear=function(){this.__data__=[],this.size=0},Qqe.prototype.delete=function(e){var t=this.__data__,r=Xqe(t,e);return!(r<0)&&(r==t.length-1?t.pop():Zqe.call(t,r,1),--this.size,!0)},Qqe.prototype.get=function(e){var t=this.__data__,r=Xqe(t,e);return r<0?void 0:t[r][1]},Qqe.prototype.has=function(e){return Xqe(this.__data__,e)>-1},Qqe.prototype.set=function(e,t){var r=this.__data__,n=Xqe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};const eYe=lqe(mKe,"Map");function tYe(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function rYe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}rYe.prototype.clear=function(){this.size=0,this.__data__={hash:new Jqe,map:new(eYe||Qqe),string:new Jqe}},rYe.prototype.delete=function(e){var t=tYe(this,e).delete(e);return this.size-=t?1:0,t},rYe.prototype.get=function(e){return tYe(this,e).get(e)},rYe.prototype.has=function(e){return tYe(this,e).has(e)},rYe.prototype.set=function(e,t){var r=tYe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var nYe="Expected a function";function iYe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(nYe);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(iYe.Cache||rYe),r}iYe.Cache=rYe;var oYe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,aYe=/\\(\\)?/g,sYe=function(e){var t=iYe(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(oYe,(function(e,r,n,i){t.push(n?i.replace(aYe,"$1"):r||e)})),t}));const lYe=sYe;function cYe(e,t){return TKe(e)?e:Gqe(e,t)?[e]:lYe(function(e){return null==e?"":DKe(e)}(e))}var uYe=1/0;function dYe(e){if("string"==typeof e||RKe(e))return e;var t=e+"";return"0"==t&&1/e==-uYe?"-0":t}function fYe(e,t){for(var r=0,n=(t=cYe(t,e)).length;null!=e&&r<n;)e=e[dYe(t[r++])];return r&&r==n?e:void 0}function hYe(e){var t=this.__data__=new Qqe(e);this.size=t.size}hYe.prototype.clear=function(){this.__data__=new Qqe,this.size=0},hYe.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},hYe.prototype.get=function(e){return this.__data__.get(e)},hYe.prototype.has=function(e){return this.__data__.has(e)},hYe.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Qqe){var n=r.__data__;if(!eYe||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new rYe(n)}return r.set(e,t),this.size=r.size,this};var pYe=Object.prototype.propertyIsEnumerable,gYe=Object.getOwnPropertySymbols,mYe=gYe?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}(gYe(e),(function(t){return pYe.call(e,t)})))}:function(){return[]};const vYe=mYe;function yYe(e){return function(e,t,r){var n=t(e);return TKe(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,zqe,vYe)}const bYe=lqe(mKe,"DataView");const _Ye=lqe(mKe,"Promise");const wYe=lqe(mKe,"Set");var CYe="[object Map]",EYe="[object Promise]",SYe="[object Set]",kYe="[object WeakMap]",xYe="[object DataView]",OYe=eqe(bYe),IYe=eqe(eYe),RYe=eqe(_Ye),TYe=eqe(wYe),AYe=eqe(cqe),MYe=xKe;(bYe&&MYe(new bYe(new ArrayBuffer(1)))!=xYe||eYe&&MYe(new eYe)!=CYe||_Ye&&MYe(_Ye.resolve())!=EYe||wYe&&MYe(new wYe)!=SYe||cqe&&MYe(new cqe)!=kYe)&&(MYe=function(e){var t=xKe(e),r="[object Object]"==t?e.constructor:void 0,n=r?eqe(r):"";if(n)switch(n){case OYe:return xYe;case IYe:return CYe;case RYe:return EYe;case TYe:return SYe;case AYe:return kYe}return t});const NYe=MYe;const DYe=mKe.Uint8Array;function PYe(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new rYe;++t<r;)this.add(e[t])}function jYe(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function FYe(e,t){return e.has(t)}PYe.prototype.add=PYe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},PYe.prototype.has=function(e){return this.__data__.has(e)};var VYe=1,LYe=2;function $Ye(e,t,r,n,i,o){var a=r&VYe,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,h=r&LYe?new PYe:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],g=t[d];if(n)var m=a?n(g,p,d,t,e,o):n(p,g,d,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!jYe(t,(function(e,t){if(!FYe(h,t)&&(p===e||i(p,e,r,n,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function BYe(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function UYe(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var zYe=1,HYe=2,WYe="[object Boolean]",GYe="[object Date]",KYe="[object Error]",qYe="[object Map]",YYe="[object Number]",JYe="[object RegExp]",XYe="[object Set]",ZYe="[object String]",QYe="[object Symbol]",eJe="[object ArrayBuffer]",tJe="[object DataView]",rJe=vKe?vKe.prototype:void 0,nJe=rJe?rJe.valueOf:void 0;var iJe=1,oJe=Object.prototype.hasOwnProperty;var aJe=1,sJe="[object Arguments]",lJe="[object Array]",cJe="[object Object]",uJe=Object.prototype.hasOwnProperty;function dJe(e,t,r,n,i,o){var a=TKe(e),s=TKe(t),l=a?lJe:NYe(e),c=s?lJe:NYe(t),u=(l=l==sJe?cJe:l)==cJe,d=(c=c==sJe?cJe:c)==cJe,f=l==c;if(f&&Iqe(e)){if(!Iqe(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new hYe),a||jqe(e)?$Ye(e,t,r,n,i,o):function(e,t,r,n,i,o,a){switch(r){case tJe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case eJe:return!(e.byteLength!=t.byteLength||!o(new DYe(e),new DYe(t)));case WYe:case GYe:case YYe:return gqe(+e,+t);case KYe:return e.name==t.name&&e.message==t.message;case JYe:case ZYe:return e==t+"";case qYe:var s=BYe;case XYe:var l=n&zYe;if(s||(s=UYe),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=HYe,a.set(e,t);var u=$Ye(s(e),s(t),n,i,o,a);return a.delete(e),u;case QYe:if(nJe)return nJe.call(e)==nJe.call(t)}return!1}(e,t,l,r,n,i,o);if(!(r&aJe)){var h=u&&uJe.call(e,"__wrapped__"),p=d&&uJe.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return o||(o=new hYe),i(g,m,r,n,o)}}return!!f&&(o||(o=new hYe),function(e,t,r,n,i,o){var a=r&iJe,s=yYe(e),l=s.length;if(l!=yYe(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:oJe.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<l;){var g=e[u=s[c]],m=t[u];if(n)var v=a?n(m,g,u,t,e,o):n(g,m,u,e,t,o);if(!(void 0===v?g===m||i(g,m,r,n,o):v)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(h=!1)}return o.delete(e),o.delete(t),h}(e,t,r,n,i,o))}function fJe(e,t,r,n,i){return e===t||(null==e||null==t||!OKe(e)&&!OKe(t)?e!=e&&t!=t:dJe(e,t,r,n,fJe,i))}var hJe=1,pJe=2;function gJe(e){return e==e&&!VKe(e)}function mJe(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function vJe(e){var t=function(e){for(var t=zqe(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,gJe(i)]}return t}(e);return 1==t.length&&t[0][2]?mJe(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new hYe;if(n)var f=n(c,u,l,e,t,d);if(!(void 0===f?fJe(u,c,hJe|pJe,n,d):f))return!1}}return!0}(r,e,t)}}function yJe(e,t){return null!=e&&t in Object(e)}function bJe(e,t){return null!=e&&function(e,t,r){for(var n=-1,i=(t=cYe(t,e)).length,o=!1;++n<i;){var a=dYe(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&vqe(i)&&pqe(a,i)&&(TKe(e)||Sqe(e))}(e,t,yJe)}var _Je=1,wJe=2;function CJe(e,t){return Gqe(e)&&gJe(t)?mJe(dYe(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:fYe(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?bJe(r,e):fJe(t,n,_Je|wJe)}}function EJe(e){return Gqe(e)?function(e){return function(t){return null==t?void 0:t[e]}}(dYe(e)):function(e){return function(t){return fYe(t,e)}}(e)}const SJe=function(){return mKe.Date.now()};var kJe=Math.max,xJe=Math.min;function OJe(e,t,r){var n,i,o,a,s,l,c=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function p(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=o}function g(){var e=SJe();if(p(e))return m(e);s=setTimeout(g,function(e){var r=t-(e-l);return d?xJe(r,o-(e-c)):r}(e))}function m(e){return s=void 0,f&&n?h(e):(n=i=void 0,a)}function v(){var e=SJe(),r=p(e);if(n=arguments,i=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),u?h(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),h(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=HKe(t)||0,VKe(r)&&(u=!!r.leading,o=(d="maxWait"in r)?kJe(HKe(r.maxWait)||0,t):o,f="trailing"in r?!!r.trailing:f),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=i=s=void 0},v.flush=function(){return void 0===s?a:m(SJe())},v}function IJe(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var RJe=wYe&&1/UYe(new wYe([,-0]))[1]==1/0?function(e){return new wYe(e)}:function(){};const TJe=RJe;var AJe=200;function MJe(e,t){return e&&e.length?function(e,t,r){var n=-1,i=dqe,o=e.length,a=!0,s=[],l=s;if(r)a=!1,i=IJe;else if(o>=AJe){var c=t?null:TJe(e);if(c)return UYe(c);a=!1,i=FYe,l=new PYe}else l=t?[]:s;e:for(;++n<o;){var u=e[n],d=t?t(u):u;if(u=r||0!==u?u:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(u)}else i(l,d,r)||(l!==s&&l.push(d),s.push(u))}return s}(e,function(e){return"function"==typeof e?e:null==e?WKe:"object"==typeof e?TKe(e)?CJe(e[0],e[1]):vJe(e):EJe(e)}(t)):[]}var NJe=(e=>(e.SUMMARY="summary",e.EXTRACT="extract",e.CUSTOM="custom",e))(NJe||{});const DJe=$i.defineToken("AiWritingServiceToken"),PJe=$i.defineToken("AiWritingTaskServiceToken"),jJe=$i.defineToken("AiWritingDatasourceContribution"),FJe=$i.defineToken("AiWritingDatasourceToken");var VJe=Object.defineProperty,LJe=Object.getOwnPropertyDescriptor;let $Je=class{constructor(){this._onAiWritingStatusChange=new _p,this.onAiWritingStatusChange=this._onAiWritingStatusChange.event,this.queueTask=null,this.taskListener=null,this.isGenerating=!1,this.generateFieldId=null}init(e){this.queueTask=e,this.bindEvent()}destroy(){var e;null==(e=this.taskListener)||e.destroy()}bindEvent(){this.queueTask&&(this.taskListener=this.queueTask.onDidStatusChange((({status:e})=>{var t,r;e===mI.WAITING&&(null==(t=this.queueTask)||!t.hasPenddingJob())&&(null==(r=this.queueTask)||!r.hasRuningJob())&&(this.isGenerating=!1,this._onAiWritingStatusChange.emit({isGenerating:this.isGenerating,fieldId:this.generateFieldId,type:"auto"}),this.generateFieldId=null,m.a.success(Ph("已重新填写")))})))}emitStartAiWritingTask(e){this.isGenerating=!0,this.generateFieldId=e,this._onAiWritingStatusChange.emit({isGenerating:this.isGenerating,fieldId:this.generateFieldId,type:"manual"})}emitStopAiWritingTask(e){this.isGenerating=!1,this.generateFieldId=null,this._onAiWritingStatusChange.emit({isGenerating:this.isGenerating,fieldId:e,type:"manual"})}isFieldGenerating(e){return this.isGenerating&&e===this.generateFieldId}};$Je=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?LJe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&VJe(t,r,o),o})([io({token:PJe})],$Je);var BJe=Object.defineProperty,UJe=Object.getOwnPropertyDescriptor,zJe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?UJe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BJe(t,r,o),o};let HJe=class{constructor(){this._queueTask=null}init(){this._queueTask=new bI({name:"智能填写任务队列",parallel:3}),this.aiWritingTaskService.init(this._queueTask)}getAiWritingConfig(e){const t=this._modelService.getModel("ai_writing").findOne({field_uuid:e}),r=this._readService.getField(e||"");return(null==t?void 0:t.get("open"))&&r&&r.get("type")!==pE.TEXT?{open:!1,type:NJe.SUMMARY,prompt:"",auto:!1}:null==t?void 0:t.toJSON()}_generatePrompt(e,t,r){let n="",i="";switch(t.forEach(((e,n)=>{i+=`${r.get(e.fieldId)||""}是${e.formatValue||""}`,n<t.length-1&&(i+="，")})),e.type){case NJe.SUMMARY:n=`帮我给以下内容生成摘要，尽可能简洁：${i}`;break;case NJe.EXTRACT:n=`帮我总结出以下内容里的${e.prompt}：${i}`;break;case NJe.CUSTOM:n=`帮我给以下内容${e.prompt}：${i}`}return n}async _getAiWritingData(e,t,r,n){var i;try{const o=this._generatePrompt(e,Vp(n,(e=>e.fieldId!==t)),r),a=await(null==(i=this.aiWritingDatasource)?void 0:i.handlePost({content:o,type:"custom"}));return(null==a?void 0:a.data.result)||"2222"}catch(e){return console.error(e),""}}async autofillCell(e,t,r,n){var i;const o=this._readService.getViewRecordCells(r),a=Fp(o,(e=>e.fieldId===t)),s=await this._getAiWritingData(e,t,n,o);if(!s||!a)return;const l={...a,value:s};null==(i=this._commandService)||i.execCommand("setCell",l)}async startAiWriting(e,t){var r,n;if(!e)return!1;const i=this._readService.getField(e),o=this.getAiWritingConfig(e);if((null==i?void 0:i.get("type"))!==pE.TEXT||null==o||!o.open)return!1;const a=this._readService.getAllFields(),s=new Map;if(null==a||a.forEach((e=>{s.set(e.get("uuid"),e.get("name"))})),t)await this.autofillCell(o,e,t,s);else{const t=this._readService.getRecords();null==(r=this.aiWritingTaskService)||r.emitStartAiWritingTask(e),null==(n=this._queueTask)||n.destroy(),t.forEach((t=>{var r;const n=`${e}-${t.get("uuid")}`;null==(r=this._queueTask)||r.addJob(n,(async r=>{var i;try{await this.autofillCell(o,e,t.get("uuid"),s)}catch(e){return console.error(e),r.onError(e)}r.onSuccess(),null==(i=this._queueTask)||i.removeSuccessJob(n)}))}))}}async stopAiWriting(e){var t,r;!e||(null==(t=this._queueTask)||t.destroy(),null==(r=this.aiWritingTaskService)||r.emitStopAiWritingTask(e))}destroy(){var e;null==(e=this._queueTask)||e.destroy()}};zJe([ao(_w)],HJe.prototype,"_modelService",2),zJe([ao(KO)],HJe.prototype,"_readService",2),zJe([ao(zI)],HJe.prototype,"_commandService",2),zJe([ao($Je)],HJe.prototype,"aiWritingTaskService",2),zJe([ao(FJe)],HJe.prototype,"aiWritingDatasource",2),zJe([Oi()],HJe.prototype,"init",1),zJe([Ii()],HJe.prototype,"destroy",1),HJe=zJe([io({token:DJe})],HJe);const WJe=[{uuid:NJe.SUMMARY,name:Ph("内容总结"),placeholder:Ph("将自动对每条记录进行总结")},{uuid:NJe.CUSTOM,name:Ph("自定义"),placeholder:Ph("输入智能填写规则\n如：为每个商品生成 50 字的宣传文案")}];var GJe=Object.defineProperty,KJe=Object.getOwnPropertyDescriptor,qJe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?KJe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&GJe(t,r,o),o};let YJe=class{getProvider(){const e=this.serverProvider.getContributions(),t=e[e.length-1];return null==t?void 0:t.registerServer()}hasProvider(){return this.serverProvider.getContributions().length>0}};qJe([wh(dKe)],YJe.prototype,"serverProvider",2),YJe=qJe([io()],YJe);var JJe=Object.defineProperty,XJe=Object.getOwnPropertyDescriptor,ZJe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?XJe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&JJe(t,r,o),o};let QJe=class{getCommonParams(e){var t;const r=e?this._readService.getView(e):this._readService.getActiveView();let n={sheetId:this._readService.getTable().get("uuid"),type:null==r?void 0:r.get("type"),viewId:(null==r?void 0:r.get("uuid"))||e};const i=null==(t=this._serverRegistry.getProvider())?void 0:t.processParams;return i&&(n=i(n)),n}getSdk(){var e;return null==(e=this._serverRegistry.getProvider())?void 0:e.apiSdk}setActiveView(){const e=this._readService.getTable(),t=this.getCommonParams(e.get("active_view_uuid"));this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.setActive(t)}))}updateCell(e){const t=this.getCommonParams();t.records=[];const r=MJe(e,"recordId");for(const e of r){const r=this._readService.getOriginRecord(e.recordId),n=this._readService.getCell(e.fieldId,e.recordId);!n||t.records.push({data:this._toProcess.toValue(n),fieldId:n.fieldId,recordId:n.recordId,record:this._toProcess.toRecord(r)})}0!==t.records.length&&this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordValueController.bulkUpdate(t)}))}addRecord(e){const t=this.getCommonParams();t.data=e.map((e=>({id:e}))),this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordController.create(t)}))}removeRecord(e){const t=this.getCommonParams();t.recordIds=e,this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordController.remove(t)}))}addField(e){const t=this.getCommonParams();t.fields=e.map((e=>this._toProcess.toColumn(new Kp(e)))),this._syncQueue.addJob((async()=>{await this.getSdk().TableFieldController.create(t)}))}updateField(e,t){const r=this._readService.getField(e),n=this._aiWritingService.getAiWritingConfig(e),i=this.getCommonParams();i.field=this._toProcess.toColumn(r),n&&(i.field.enableAI=n.open,i.field.aiWritingType=n.type,i.field.aiPrompt=n.prompt,i.field.enableAutoAIGC=n.auto),this._syncQueue.addJob((async()=>{await this.getSdk().TableFieldController.update(i)})),t&&this._updateFieldRecord()}_updateFieldRecord(){const e=this.getCommonParams(),t=this._readService.getRecords();e.data=Bp(t,(e=>{const t=this._readService.getOriginRecord(e.get("uuid"));return{id:e.get("uuid"),data:JSON.stringify(this._toProcess.toRecord(t))}})),this._syncQueue.addJob((async()=>{await this.getSdk().TableRecordController.update(e)}))}removeField(e){const t=this.getCommonParams();t.fieldIds=e,this._syncQueue.addJob((async()=>{await this.getSdk().TableFieldController.remove(t)}))}addView(e){const t=this._getViewData(e);if(!t)return;const r=this.getCommonParams(e);r.data=this._toProcess.toView(t),this._syncQueue.addJob((async()=>{var e,t;const n=await this.getSdk().TableViewController.create(r);!n||this._model.viewModel.upsert({uuid:null==(e=n.data)?void 0:e.view_id},{id:null==(t=n.data)?void 0:t.data.iid},{slient:!0})}))}updateView(e){const t=this._getViewData(e);if(!t)return;const r=this.getCommonParams(e);r.data=this._toProcess.toView(t),this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.update(r)}))}updateViewOrder(e,t){const r=this.getCommonParams(e);r.targetViewId=t,this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.moveAfter(r)}))}removeView(e){const t=this.getCommonParams(e);this._syncQueue.addJob((async()=>{await this.getSdk().TableViewController.remove(t)}))}updateForm(e,t){this._syncQueue.addJob((async()=>{var r;const n=this._model.viewModel.findOne({uuid:e});let i={type:"form",status:t,viewId:e,target_id:null==n?void 0:n.get("id"),target_type:"Skythings.View"};const o=null==(r=this._serverRegistry.getProvider())?void 0:r.processParams;o&&(i=o(i)),await this.getSdk().TableShareController.update(i)}))}updateContent(e,t){const r=this._readService.getTable().get("uuid");this._syncQueue.addJob((async()=>{await this._contentDatasource.handlePut(e,r,t)}))}_getViewData(e){var t;const r={},n=this._readService.getView(e);return n?(r.view=this._readService.getView(n.get("uuid")),r.sort=this._readService.getViewSort(n.get("uuid")),r.stats=this._readService.getViewStats(n.get("uuid")),r.viewGroup=this._readService.getViewGroup(n.get("uuid")),r.fieldGroups=this._readService.getViewFieldGroups(n.get("uuid")),r.filters=this._readService.getViewFilters(n.get("uuid")),r.groupViewRecords=null!=(t=r.viewGroup)&&t.group?this._readService.getGroupViewRecords(n.get("uuid")):null,r.viewConfig=this._readService.getViewConfig(n.get("uuid")),r):null}};ZJe([ao(KO)],QJe.prototype,"_readService",2),ZJe([ao(UR)],QJe.prototype,"_toProcess",2),ZJe([ao(YJe)],QJe.prototype,"_serverRegistry",2),ZJe([ao(fKe)],QJe.prototype,"_syncQueue",2),ZJe([ao(DJe)],QJe.prototype,"_aiWritingService",2),ZJe([ao(QUe)],QJe.prototype,"_contentDatasource",2),ZJe([ao(Ok)],QJe.prototype,"_model",2),QJe=ZJe([io()],QJe);var eXe=Object.defineProperty,tXe=Object.getOwnPropertyDescriptor,rXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?tXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&eXe(t,r,o),o};const nXe=Jo.Plugin("sync-spell");let iXe=class{constructor(){this._spells=[],this.isSync=!1,this.startTaskWithDebounce=OJe((()=>{const e=this._spells;this.startTask(e),this._spells=[]}),300)}start(){this._modelEvent.onChange((({spell:e})=>{e.isRemote||!this._abilityService.canUpdate(aR.TABLE)||(nXe("spell %j",e),this.syncSpell(e))}))}syncSpell(e){if(this._spells.push(e),this.isSync)return this.startTask(this._spells),void(this._spells=[]);this.startTaskWithDebounce()}startTask(e){if(e.length>0){this.addField(e),this.updateField(e),this.removeField(e),this.addRecord(e);const t=this.removeRecord(e);this.updateCell(e,t),this.addView(e),this.updateView(e),this.removeView(e),this.updateContent(e),this.updateForm(e),this.updateTable(e)}}updateTable(e){let t=!1;for(const r of e)["table"].includes(r.table)&&(t=!0);t&&this._syncHelper.setActiveView()}updateCell(e,t){const r=[];for(const n of e)if(["field_boolean","field_date","field_number","field_select","field_string","field_uri"].includes(n.table))if(n.command===Bh.UPSERT||n.command===Bh.DELETE){let e=this._getValueByKey(n,"record_uuid");if(!e){e=Bp(this._readService.getRecords(),(e=>e.get("uuid")))}Array.isArray(e)||(e=[e]);for(const i of e){if(null!=t&&t.includes(i))continue;const e=this._getValueByKey(n,"field_uuid");r.push({fieldId:e,recordId:i})}}else n.command===Bh.BULK_INSERT&&n.sets.forEach((e=>{null!=t&&t.includes(e.record_uuid)||r.push({fieldId:e.field_uuid,recordId:e.record_uuid})}));r.length>0&&this._syncHelper.updateCell(MJe(r,(e=>e.fieldId+":"+e.recordId)))}addRecord(e){let t=[];for(const r of e)"record"===r.table&&(r.command===Bh.INSERT||r.command===Bh.INSERT_AFTER||r.command===Bh.INSERT_BEFORE?t.push(r.sets.uuid):r.command===Bh.BULK_INSERT&&(t=t.concat(r.sets.map((e=>e.uuid)))));t.length>0&&this._syncHelper.addRecord(t)}removeRecord(e){let t=[];for(const r of e)if("record"===r.table&&r.command===Bh.DELETE){const e=this._getValueByKey(r,"uuid");t=t.concat(e||[])}return t.length>0&&this._syncHelper.removeRecord(t),t}addField(e){const t=[];for(const r of e)"field"===r.table&&(r.command===Bh.INSERT||r.command===Bh.INSERT_AFTER||r.command===Bh.INSERT_BEFORE)&&t.push(r.sets);t.length>0&&this._syncHelper.addField(t)}updateField(e){const t={};for(const r of e)if("field"===r.table&&(r.command===Bh.DELETE||r.command===Bh.INSERT||r.command===Bh.INSERT_AFTER||r.command===Bh.INSERT_BEFORE)){t[this._getValueByKey(r,"uuid")]=!0}const r={};for(const n of e){let e;"field"===n.table&&n.command===Bh.UPDATE?e=this._getValueByKey(n,"uuid"):("field_option"===n.table||"ai_writing"===n.table)&&(e=this._getValueByKey(n,"field_uuid")),!t[e]&&e&&(r[e]||(r[e]=n),r[e].sets.type||(r[e]=n))}const n=Object.keys(r);for(const e of n)r[e].sets.type?this._syncHelper.updateField(e,!0):this._syncHelper.updateField(e)}async removeField(e){let t=[];for(const r of e)if("field"===r.table&&r.command===Bh.DELETE){const e=this._getValueByKey(r,"uuid");TKe(e)?t=t.concat(e):t.push(e)}t.length>0&&this._syncHelper.removeField(t)}async addView(e){for(const t of e)"view"===t.table&&(t.command===Bh.INSERT||t.command===Bh.INSERT_AFTER||t.command===Bh.INSERT_BEFORE)&&this._syncHelper.addView(t.sets.uuid)}async updateContent(e){for(const t of e)if("content"===t.table&&t.command===Bh.UPSERT){const e=t.where.target_uuid;if("record"!==t.where.target_type)continue;this._syncHelper.updateContent(e,{format:t.sets.format,html:t.sets.html,source:t.sets.source})}}async updateView(e){const t={},r={};for(const n of e){if("view"===n.table&&(n.command===Bh.DELETE||n.command===Bh.INSERT||n.command===Bh.INSERT_AFTER||n.command===Bh.INSERT_BEFORE)){const e=this._getValueByKey(n,"uuid");r[e]=!0,delete t[e]}if("view"===n.table&&n.command===Bh.UPDATE){const e=this._getValueByKey(n,"uuid");if(r[e])continue;t[e]=!0}else if(["view_config","view_field","view_record","sort","group","filter","stat"].includes(n.table)){const e=this._getValueByKey(n,"view_uuid");if(r[e])continue;t[e]=!0}if("view"===n.table&&(n.command===Bh.MOVE_AFTER||n.command===Bh.MOVE_BEFORE)){const e=n.sets.uuid,t=this._readService.getViews(),r=Lp(t,(t=>t.get("uuid")===e));let i;return r>0&&(i=t.get(r-1).get("uuid")),void await this._syncHelper.updateViewOrder(e,i)}}const n=Object.keys(t);for(const e of n)await this._syncHelper.updateView(e)}async removeView(e){for(const t of e)if("view"===t.table&&t.command===Bh.DELETE){const e=this._getValueByKey(t,"uuid");this._syncHelper.removeView(e)}}async updateForm(e){for(const t of e)if("view_share"===t.table&&t.command===Bh.UPSERT){if(t.sets.status===kE.ACTIVE)return;this._syncHelper.updateForm(t.sets.view_uuid,t.sets.status)}}_getValueByKey(e,t,r){var n;let i;return e.command===Bh.INSERT||e.command===Bh.INSERT_AFTER||e.command===Bh.INSERT_BEFORE||e.command===Bh.UPSERT?(i=e.sets[t],r&&(i=e.sets.uuid)):e.command===Bh.BULK_INSERT?i=e.sets[0][t]:(e.command===Bh.DELETE||e.command===Bh.UPDATE||e.command===Bh.MOVE_AFTER||e.command===Bh.MOVE_BEFORE)&&(i=null==(n=e.where)?void 0:n[t],i||(i=e.sets[t])),i}};rXe([ao(Lh)],iXe.prototype,"_modelEvent",2),rXe([ao(KO)],iXe.prototype,"_readService",2),rXe([ao(QJe)],iXe.prototype,"_syncHelper",2),rXe([ao(bR)],iXe.prototype,"_abilityService",2),iXe=rXe([io()],iXe);var oXe=Object.defineProperty,aXe=Object.getOwnPropertyDescriptor,sXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?aXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&oXe(t,r,o),o};let lXe=class{constructor(){this._events=[],this.isSync=!1,this.handleEvents=e=>{if(this._abilityService.canUpdate(aR.TABLE))for(const t of e){if(!this._isCurrentOrigin(t.transaction))continue;const e=t.path[0],r=t.path.slice(1,t.path.length),n=this._getTrustDeleted(t)||[],i=this._getTruestAdded(t)||[];if("view"===e&&1===t.changes.deleted.size&&1===t.changes.added.size&&0===n.length&&0===i.length){const n=Array.from(t.changes.added)[0].content.type,i=this._readService.getViews(),o=Lp(i,(e=>e.get("uuid")===n.get("uuid")))-1;let a;o>-1&&(a=i.get(o)),this.syncEvents({table:e,command:"moveAfter",path:r,item:n,targetItem:a});continue}let o=!1;if(t.changes.deleted.size>0)for(const t of n)this.syncEvents({table:e,command:"delete",path:r,item:t}),o=!0;if(t.changes.added.size>0)for(const t of i)this.syncEvents({table:e,command:"insert",path:r,item:t}),o=!0;if(!o)if(t.target instanceof G_.Array)for(const n of t.target)this.syncEvents({table:e,command:"update",path:r,item:n});else this.syncEvents({table:e,command:"update",path:r,item:t.target,keysChanged:t.keysChanged})}},this.startTaskWithDebounce=OJe((()=>{const e=this._events;this.startTask(e),this._events=[]}),300)}start(){!this._storage.root||!this._storage.root.observeDeep||this._storage.root.observeDeep(this.handleEvents)}_isCurrentOrigin(e){const t=e.origin;if(null!=t&&t.trackedOrigins){for(const e of t.trackedOrigins)if(e===this._struct.ystruct)return!0;return!1}return t===this._struct.ystruct}_getTrustDeleted(e){const t=Array.from(e.changes.deleted),r=Array.from(e.changes.added).reduce(((e,t)=>(e[t.content.type._map.get("uuid").content.arr[0]]=!0,e)),{}),n=[];for(const e of t){const t=e.content.type._map;if(r[t.get("uuid").content.arr[0]])continue;const i=t.keys(),o=new Kp;for(const e of i)o.set(e,t.get(e).content.arr[0]);n.push(o)}return n}_getTruestAdded(e){const t=Array.from(e.changes.deleted),r=Array.from(e.changes.added),n=t.reduce(((e,t)=>(e[t.content.type._map.get("uuid").content.arr[0]]=!0,e)),{}),i=[];for(const e of r){const t=e.content.type;n[t.get("uuid")]||i.push(t)}return i}syncEvents(e){if(this._events.push(e),this.isSync)return this.startTask(this._events),void(this._events=[]);this.startTaskWithDebounce()}startTask(e){if(e.length>0){this.addField(e),this.updateField(e),this.removeField(e),this.addRecord(e);const t=this.removeRecord(e);this.updateCell(e,t),this.addView(e),this.updateView(e),this.removeView(e),this.updateContent(e),this.updateForm(e),this.updateTable(e)}}addField(e){var t,r;const n=[];for(const i of e)if("field"===i.table&&"insert"===i.command){const e=null==(r=this._readService.getField(null==(t=i.item)?void 0:t.get("uuid")))?void 0:r.toJSON();n.push(e)}n.length>0&&this._syncHelper.addField(n)}updateField(e){var t,r,n,i,o,a,s,l,c,u;const d={};for(const r of e)if("field"===r.table&&("delete"===r.command||"insert"===r.command)){d[null==(t=r.item)?void 0:t.get("uuid")]=!0}const f={};for(const t of e){let e;if("field"===t.table&&"update"===t.command)e=null==(r=t.item)?void 0:r.get("uuid");else if("field_option"===t.table)if(1===t.path.length&&t.keysChanged){const r=Array.from(t.keysChanged)[0];e=null==(o=null==(i=null==(n=t.item)?void 0:n.get(r))?void 0:i.get(0))?void 0:o.get("field_uuid")}else e=null==(a=t.item)?void 0:a.get("field_uuid");else if("ai_writing"===t.table)if(1===t.path.length&&t.keysChanged){const r=Array.from(t.keysChanged)[0];e=null==(l=null==(s=t.item)?void 0:s.get(r))?void 0:l.get(0).get("field_uuid")}else e=null==(c=t.item)?void 0:c.get("field_uuid");d[e]||e&&(f[e]||(f[e]=t))}const h=Object.keys(f);for(const e of h){const t=f[e];this._syncHelper.updateField(e,null==(u=t.keysChanged)?void 0:u.has("type"))}}async removeField(e){var t;const r=[];for(const n of e)"field"===n.table&&"delete"===n.command&&r.push(null==(t=n.item)?void 0:t.get("uuid"));r.length>0&&this._syncHelper.removeField(r)}async addView(e){var t;for(const r of e)"view"===r.table&&"insert"===r.command&&this._syncHelper.addView(null==(t=r.item)?void 0:t.get("uuid"))}addRecord(e){var t;const r=[];for(const n of e)"record"===n.table&&"insert"===n.command&&r.push(null==(t=n.item)?void 0:t.get("uuid"));r.length>0&&this._syncHelper.addRecord(r)}removeRecord(e){var t;let r=[];for(const n of e)if("record"===n.table&&"delete"===n.command){const e=[null==(t=n.item)?void 0:t.get("uuid")];r=r.concat(e||[])}return r.length>0&&this._syncHelper.removeRecord(r),r}updateCell(e,t=[]){var r,n,i;const o=[];for(const a of e)if(["field_boolean","field_date","field_number","field_select","field_string","field_uri","cell"].includes(a.table)){let e,s;if(1===a.path.length){const s=null==(r=a.item)?void 0:r.keys();if(!s)return;for(const r of s){e=r;const s=null==(i=null==(n=a.item)?void 0:n.get(r))?void 0:i.keys();if(!s)return;for(const r of s)null!=t&&t.includes(r)||o.push({fieldId:e,recordId:r})}}else if(2===a.path.length&&(e=a.path[1],a.keysChanged)){const r=Array.from(a.keysChanged);for(const n of r)null!=t&&t.includes(n)||o.push({fieldId:e,recordId:n})}if(e=a.path[1],s=a.path[2],!s&&a.keysChanged&&(s=Array.from(a.keysChanged)[0]),!e||!s||null!=t&&t.includes(s))continue;o.push({fieldId:e,recordId:s})}o.length>0&&this._syncHelper.updateCell(MJe(o,(e=>e.fieldId+":"+e.recordId)))}async updateView(e){var t,r,n,i,o,a,s,l;const c={},u={};for(const d of e){if("view"===d.table&&("delete"===d.command||"insert"===d.command)){const e=null==(t=d.item)?void 0:t.get("uuid");u[e]=!0,delete c[e]}if("view"===d.table&&"update"===d.command){const e=null==(r=d.item)?void 0:r.get("uuid");if(u[e])continue;c[e]=!0}else if(["view_config","view_field","view_record","sort","group","filter","stat"].includes(d.table)){let e;if(1===d.path.length&&d.keysChanged)e=Array.from(d.keysChanged)[0];else if(2===d.path.length&&d.keysChanged){const t=Array.from(d.keysChanged)[0];e=null==(o=null==(i=null==(n=d.item)?void 0:n.get(t))?void 0:i.get(0))?void 0:o.get("view_uuid")}else e=null==(a=d.item)?void 0:a.get("view_uuid");if(u[e]||!e)continue;c[e]=!0}if("view"===d.table&&"moveAfter"===d.command){const e=null==(s=d.item)?void 0:s.get("uuid"),t=null==(l=d.targetItem)?void 0:l.get("uuid");this._syncHelper.updateViewOrder(e,t)}}const d=Object.keys(c);for(const e of d)await this._syncHelper.updateView(e)}async removeView(e){var t;for(const r of e)if("view"===r.table&&"delete"===r.command){const e=null==(t=r.item)?void 0:t.get("uuid");this._syncHelper.removeView(e)}}updateContent(e){var t,r,n,i,o,a,s;const l={};for(const i of e)if("content"===i.table&&("update"===i.command||"insert"===i.command)){const e=null==(t=i.item)?void 0:t.get("target_uuid"),o=null==(r=i.item)?void 0:r.get("target_type"),a=null==(n=i.item)?void 0:n.get("status");if("record"!==o||0===a)continue;l[e]=i}const c=Object.keys(l);for(const e of c){const t=l[e];this._syncHelper.updateContent(null==(i=t.item)?void 0:i.get("target_uuid"),{format:null==(o=t.item)?void 0:o.get("format"),html:null==(a=t.item)?void 0:a.get("html"),source:null==(s=t.item)?void 0:s.get("source")})}}updateForm(e){var t,r,n,i;for(const o of e)if("view_share"===o.table&&("update"===o.command||"insert"===o.command)){let e;if(0===o.path.length){const n=null==(t=o.item)?void 0:t.get("data"),i=Array.from(n.keys())[0];e=null==(r=n.get(i))?void 0:r.get(0)}else if(1===o.path.length){const t=Array.from(o.keysChanged)[0];e=null==(i=null==(n=o.item)?void 0:n.get(t))?void 0:i.get(0)}else e=o.item;const a=null==e?void 0:e.get("status"),s=null==e?void 0:e.get("view_uuid");if(a===kE.ACTIVE)return;this._syncHelper.updateForm(s,a)}}updateTable(e){let t=!1;for(const r of e)["table"].includes(r.table)&&(t=!0);t&&this._syncHelper.setActiveView()}destroy(){this._storage.root.unobserveDeep(this.handleEvents)}};sXe([ao(zh)],lXe.prototype,"_storage",2),sXe([ao(KO)],lXe.prototype,"_readService",2),sXe([ao(bR)],lXe.prototype,"_abilityService",2),sXe([ao(Pp)],lXe.prototype,"_struct",2),sXe([ao(QJe)],lXe.prototype,"_syncHelper",2),lXe=sXe([io()],lXe);var cXe=Object.defineProperty,uXe=Object.getOwnPropertyDescriptor,dXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?uXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&cXe(t,r,o),o};let fXe=class{init(){this._syncQueue.init(),this._kernelService.onDataLoaded((e=>{"loadedRecords"===e&&setTimeout((()=>{this._hasInited||(this._syncYjs.start(),this._hasInited=!0)}),1e3)}))}destroy(){this._syncQueue.destroy()}};dXe([ao(jR)],fXe.prototype,"_kernelService",2),dXe([ao(iXe)],fXe.prototype,"_syncSpell",2),dXe([ao(lXe)],fXe.prototype,"_syncYjs",2),dXe([ao(fKe)],fXe.prototype,"_syncQueue",2),fXe=dXe([io()],fXe);var hXe=Object.defineProperty,pXe=Object.getOwnPropertyDescriptor;let gXe=class{constructor(){this._onSyncChange=new _p,this.onSyncChange=this._onSyncChange.event}init(){this._queueTask=new bI({name:"服务端接口同步任务队列",parallel:1}),this._queueTask.onDidStatusChange((e=>{e.status===mI.PENDING?this._onSyncChange.emit({status:hKe.RUNNING}):e.status===mI.WAITING&&this._onSyncChange.emit({status:hKe.SUCCESS})})),this.timerId=setInterval((()=>{var e;null==(e=this._queueTask)||e.resume()}),1e3)}destroy(){var e;null==(e=this._queueTask)||e.destroy(),this._queueTask=null,clearInterval(this.timerId),this.timerId=null}addJob(e){var t;null==(t=this._queueTask)||t.addJob((async t=>{try{await e()}catch(e){return console.error(e),t.onError(e)}t.onSuccess()}))}};gXe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?pXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&hXe(t,r,o),o})([io({token:fKe})],gXe);var mXe=Object.defineProperty,vXe=Object.getOwnPropertyDescriptor,yXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mXe(t,r,o),o};let bXe=class{static pluginModule(){return xo().contribution(dKe).register(YJe).register(QJe).register(fXe).register(gXe).register(iXe).register(lXe).register(this)}init(){!this._serverRegistry.hasProvider()||this._syncServer.init()}destroy(){this._syncServer.destroy()}};bXe.pluginName="kernel-server",yXe([ao(fXe)],bXe.prototype,"_syncServer",2),yXe([ao(YJe)],bXe.prototype,"_serverRegistry",2),bXe=yXe([io({contrib:nR})],bXe);class _Xe extends PI{destroy(){}execute(e){return this.modelService.getModel("ai_writing").upsert({field_uuid:e.fieldId},{field_uuid:e.fieldId,open:e.open,type:NJe.SUMMARY,prompt:"",auto:!1}),!0}}_Xe.commandName="updateAiWritingOpen";class wXe extends PI{destroy(){}execute(e){const t=this.modelService.getModel("ai_writing"),r={field_uuid:e.fieldId,type:e.type};return e.type!==NJe.SUMMARY&&(r.prompt=""),t.upsert({field_uuid:e.fieldId},r),!0}}wXe.commandName="updateAiWritingType";class CXe extends PI{destroy(){}execute(e){return this.modelService.getModel("ai_writing").upsert({field_uuid:e.fieldId},{field_uuid:e.fieldId,prompt:e.prompt}),!0}}CXe.commandName="updateAiWritingPrompt";class EXe extends PI{destroy(){}execute(e){return this.modelService.getModel("ai_writing").upsert({field_uuid:e.fieldId},{field_uuid:e.fieldId,auto:e.auto}),!0}}EXe.commandName="updateAiWritingAuto";var SXe=Object.defineProperty,kXe=Object.getOwnPropertyDescriptor,xXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?kXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&SXe(t,r,o),o};class OXe extends Ow{}OXe.table="ai_writing",OXe.indexes=["field_uuid"],xXe([xw()],OXe.prototype,"field_uuid",2),xXe([xw()],OXe.prototype,"open",2),xXe([xw()],OXe.prototype,"type",2),xXe([xw()],OXe.prototype,"prompt",2),xXe([xw()],OXe.prototype,"auto",2);var IXe=Object.defineProperty,RXe=Object.getOwnPropertyDescriptor,TXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?RXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&IXe(t,r,o),o};let AXe=class{init(){var e;const t=this.aiWritingDatasourceProvider.getContributions();for(const r of t){const t=null==(e=r.registerAiWritingDatasourcePost)?void 0:e.call(r);t&&(this._datasourcePost=t)}}get Post(){return this._datasourcePost}};TXe([wh(jJe),cN()],AXe.prototype,"aiWritingDatasourceProvider",2),AXe=TXe([io()],AXe);var MXe=Object.defineProperty,NXe=Object.getOwnPropertyDescriptor,DXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?NXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&MXe(t,r,o),o};let PXe=class{handlePost(e){return this._aiWritingDatasourceRegistry.Post(e)}};DXe([ao(AXe)],PXe.prototype,"_aiWritingDatasourceRegistry",2),PXe=DXe([io({token:FJe})],PXe);var jXe=Object.defineProperty,FXe=Object.getOwnPropertyDescriptor,VXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?FXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&jXe(t,r,o),o};let LXe=class{constructor(){this._listener=null}static pluginModule(){return xo().contribution(jJe).register(AXe).register(PXe).register(HJe).register($Je).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"aiWriting",type:"object",properties:{disable:{type:"boolean"}}}),e.registerDefaultValue({"aiWriting.disable":!0})}get isAiWritingEnable(){return!!this._configurationService.getValue("aiWriting.enable")}init(){this.commandService.registerCommand(_Xe.commandName,_Xe),this.commandService.registerCommand(wXe.commandName,wXe),this.commandService.registerCommand(CXe.commandName,CXe),this.commandService.registerCommand(EXe.commandName,EXe),this.aiWritingDatasourceRegistry.init(),this.isAiWritingEnable&&(this._listener=this.commandService.onDidExecuteCommand((async({context:e})=>{if("updateField"===e.commandName){const t=e.argArray[0],{field:r,newFieldProperty:n}=t,i=r.get("uuid");n.type!==pE.TEXT&&await this.commandService.execCommand("updateAiWritingOpen",{fieldId:i,open:!1})}})))}destroy(){var e;null==(e=this._listener)||e.destroy()}registerModel(){return OXe}registerProcessTableMiddleware(){return(e,t)=>{const r=e.sheet.columns;if(r&&r.length>0){const e=r.map((e=>({uuid:To(32),field_uuid:e.uuid||e.id,open:e.enableAI||!1,type:e.aiWritingType||NJe.SUMMARY,prompt:e.aiPrompt||"",auto:e.enableAutoAIGC||!1})));t.setData("ai_writing",e)}return e}}};LXe.pluginName="kernel-ai-writing",VXe([ao(zI)],LXe.prototype,"commandService",2),VXe([ao(AXe)],LXe.prototype,"aiWritingDatasourceRegistry",2),VXe([ao(HJe)],LXe.prototype,"aiWritingService",2),VXe([ao(lp)],LXe.prototype,"_configurationService",2),LXe=VXe([io({contrib:[nR,eg,ZM]})],LXe);class $Xe extends PI{destroy(){}execute(e){return this.modelService.getModel("content").upsert({target_uuid:e.recordId,target_type:"record"},{format:e.content.format,html:e.content.html,source:e.content.source,target_uuid:e.recordId,target_type:"record",status:1}),!0}}$Xe.commandName="updateContent";var BXe=Object.defineProperty,UXe=Object.getOwnPropertyDescriptor,zXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?UXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&BXe(t,r,o),o};class HXe extends Ow{}HXe.table="content",HXe.indexes=["target_type","target_uuid"],zXe([xw()],HXe.prototype,"target_uuid",2),zXe([xw()],HXe.prototype,"target_type",2),zXe([xw()],HXe.prototype,"format",2),zXe([xw()],HXe.prototype,"html",2),zXe([xw()],HXe.prototype,"source",2),zXe([xw()],HXe.prototype,"status",2);var WXe=Object.defineProperty,GXe=Object.getOwnPropertyDescriptor,KXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?GXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&WXe(t,r,o),o};let qXe=class{init(){var e,t;const r=this.contentDatasourceProvider.getContributions();for(const n of r){const r=null==(e=n.registerContentDatasourceGet)?void 0:e.call(n);r&&(this._datasourceGet=r);const i=null==(t=n.registerContentDatasourcePut)?void 0:t.call(n);i&&(this._datasourcePut=i)}}get Get(){return this._datasourceGet}get Put(){return this._datasourcePut}};KXe([wh(ZUe),cN()],qXe.prototype,"contentDatasourceProvider",2),qXe=KXe([io()],qXe);var YXe=Object.defineProperty,JXe=Object.getOwnPropertyDescriptor,XXe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?JXe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&YXe(t,r,o),o};let ZXe=class{getContent(e,t){return this._modelService.getModel("content").findOne({target_uuid:e,target_type:t})}setContentWithSlient(e,t,r){this._modelService.getModel("content").upsert({target_uuid:e,target_type:t},{format:r.format,html:r.html,source:r.source,target_uuid:e,target_type:t,status:0},{slient:!0})}};XXe([ao(_w)],ZXe.prototype,"_modelService",2),ZXe=XXe([io({token:eze})],ZXe);var QXe=Object.defineProperty,eZe=Object.getOwnPropertyDescriptor,tZe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?eZe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&QXe(t,r,o),o};let rZe=class{handleGet(e,t){return this._contentDatasourceRegistry.Get(e,t)}handlePut(e,t,r){return this._contentDatasourceRegistry.Put(e,t,r)}};tZe([ao(qXe)],rZe.prototype,"_contentDatasourceRegistry",2),rZe=tZe([io({token:QUe})],rZe);var nZe=Object.defineProperty,iZe=Object.getOwnPropertyDescriptor,oZe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?iZe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&nZe(t,r,o),o};let aZe=class{static pluginModule(){return xo().contribution(ZUe).register(qXe).register(rZe).register(ZXe).register(this)}init(){this.commandService.registerCommand($Xe.commandName,$Xe),this.contentDatasourceRegistry.init()}registerModel(){return HXe}registerProcessTableMiddleware(){return e=>{const t=e.records;if(t)for(const e of t)!e.content||this.contentService.setContentWithSlient(e.uuid,"record",e.content);return e}}};aZe.pluginName="kernel-content",oZe([ao(zI)],aZe.prototype,"commandService",2),oZe([ao(qXe)],aZe.prototype,"contentDatasourceRegistry",2),oZe([ao(ZXe)],aZe.prototype,"contentService",2),aZe=oZe([io({contrib:[nR,eg,ZM]})],aZe);const sZe=[uKe,Gze,bXe,LXe,aZe],lZe=({docId:e,docType:t,webSdk:r})=>({token:ZUe,useValue:{registerContentDatasourceGet:()=>async(n,i)=>{var o,a;const s={docId:e,docType:t,sheetId:i,recordId:n};let l=(await(null==(a=(o=r.TableRecordController).getContent)?void 0:a.call(o,s))).content;return l||(l={format:"lake",html:"",source:""}),l},registerContentDatasourcePut:()=>async(n,i,o)=>{const a={docId:e,docType:t,sheetId:i,recordId:n,content:o};await r.TableRecordController.putContent(a)}}});function cZe(e,t){if(void 0===e||!t)return"";let r=""+e,n="";const i=r.indexOf(".")>=0;if("-"===r[0]&&(r=r.substr(1),n="-"),r.length>=t)return n+r;let o=t-r.length;for(;o--;)r=i?r+"0":"0"+r;return n+r}const uZe="1899-12-30",dZe="YYYY-MM-DD";qt.a.extend(Jt.a),function(e){qt.a.utc(e)}(uZe);const fZe=[/^([1-9]\d{3,4})(.{1})(0?[1-9]|1[0-2])(.{1})(0?[1-9]|[1-2][0-9]|3[0-1])(日?)$/,/^(0?[1-9]|1[0-2])(.{1})(0?[1-9]|[1-2][0-9]|3[0-1])(.{1})([1-9]\d{3,4})$/],hZe=/^(20|21|22|23|[0-1]\d):[0-5]\d$/,pZe=/^(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,gZe=/^([A-Za-z]{3,8})\s(0?[1-9]|[1-2][0-9]|3[0-1]),(([1-9]\d{3,4}))$/,mZe={zh:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],zhNum:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],enShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]},vZe={mmdd:/^(0?[1-9]|1[0-2])(\-|\/|月)(0?[1-9]|[1-2][0-9]|3[0-1])(日?)$/,ddmm:/^(0?[1-9]|[1-2][0-9]|3[0-1])(\-|\/)(0?[1-9]|1[0-2])$/,yymm:/^(\d{2})(\-|\/)(0?[1-9]|1[0-2])$/,yymmdd:/^(\d{2})(\-|\/)(0?[1-9]|1[0-2])(\-|\/)(0?[1-9]|[1-2][0-9]|3[0-1])$/,yyyymm:/^([1-9]\d{3,4})(\-|\/|年)(0?[1-9]|1[0-2])(月?)$/};function yZe(e){const t=function(e){let t,r,n,i="";if(function(e){return pZe.test(e)||hZe.test(e)}(e))return function(e){return qt()(`${uZe} ${e}`).diff(qt.a.utc(uZe),"seconds")}(e);let o=e.match(/ (20|21|22|23|[0-1]\d):[0-5]\d(:([0-5]\d))?$/);return o&&(i=o[0],e=e.slice(0,-i.length)),o=e.match(fZe[0]),o?(t=o[1],r=o[3],n=o[5]):(o=e.match(fZe[1]),o?(t=o[5],r=o[1],n=o[3]):(o=e.match(gZe),o&&(t=o[3],r=mZe.en.indexOf(o[1])+1,r=0===r?NaN:r,n=o[2]))),isNaN(t)||isNaN(r)||isNaN(n)?(e+=i,function(e){if(!e)return!1;let t,r,n,i="sheet-en";for(const n in vZe){const i=e.match(vZe[n]);if(i){t=n,r=i[2];break}}if(!t||["年","月","-","/"].indexOf(r)<0)return!1;switch(t){case"mmdd":"月"===r?(i="sheet-cn",n="M月D日"):n="MM/DD";break;case"ddmm":n="MM/DD";break;case"yymm":n="YYYY-MM";break;case"yymmdd":n=`YYYY${r}MM${r}DD`;break;case"yyyymm":"年"===r?(n="YYYY年M月",i="sheet-cn"):n="YYYY-MM"}return{name:"date",formatter:n,lang:i}}(e)?function(e){const t=qt()(),r=1*+t.format("YY"),n=t.format("YYYY");for(const t in vZe){const i=e.match(vZe[t]);if(i){let o="";switch(t){case"yymm":o=(1*i[1]>r?"19":"20")+cZe(i[1],2)+"-"+cZe(i[3],2)+"-01";break;case"yyyymm":o=i[1]+"-"+cZe(i[3],2)+"-01";break;case"mmdd":o=n+"-"+cZe(i[1],2)+"-"+cZe(i[3],2);break;case"ddmm":o=n+"-"+cZe(i[3],2)+"-"+cZe(i[1],2);break;case"yymmdd":o=(1*i[1]>r?"19":"20")+i[1]+"-"+cZe(i[3],2)+"-"+cZe(i[5],2);break;default:o=e}return qt.a.utc(o).diff(qt.a.utc(uZe),"seconds")}}return 0}(e):e):CZe(`${t}-${cZe(r,2)}-${cZe(n,2)}${i}`)}(e);return isNaN(t)?"":{seconds:t,text:bZe({seconds:t})}}function bZe(e){const t=qt.a.utc(uZe).add(e.seconds,"seconds");return"Invalid date"!==t.toString()?(e.text=t.format(dZe),e.text):(e.text="","")}function _Ze(e){const t=qt()(e.time);return"Invalid date"!==t.toString()?(e.text=t.format("YYYY-MM-DD HH:mm:ss"),e.text):(e.text="","")}function wZe(e){if(e>=31708800){e+=qt()("1901-01-01").diff("1900-12-31 23:59:59","seconds")-1}return qt()(uZe).add(e,"seconds").format("YYYY-MM-DDTHH:mm:ssZ")}function CZe(e){return qt.a.utc(e).diff(qt.a.utc(uZe),"seconds")}class EZe{toFieldModel(e,t){const r=e.type,n=e.options;return r===pE.TEXTAREA||r===pE.INPUT||r===pE.TEXT?this.toTextareaModel(t):r===pE.CHECKBOX?this.toCheckboxModel(t):r===pE.DATE?this.toDate(t):r===pE.EMAIL?this.toEmailModel(t):r===pE.FILE?this.toFileModel(t):r===pE.IMAGE?this.toImageModel(t):r===pE.LINK?this.toLinkModel(t):r===pE.MENTION?this.toMentionModel(t):r===pE.SELECT?this.toSelectModel(t,n):r===pE.MULTI_SELECT?this.toMultiSelectModel(t,n):r===pE.NUMBER?this.toNumberModel(t):r===pE.PHONE?this.toPhoneModel(t):t}toTextareaModel(e){return e&&"boolean"!=typeof e?Array.isArray(e)?e.map((e=>e?e.name?e.name:e:"")).join(","):e.seconds?bZe(e):e.time?_Ze(e):e.name?e.name:e+"":""}toCheckboxModel(e){return!(!e||!["1","true","是","yes","✅"].includes(String(e).toLowerCase()))}toDate(e){if(!e||"boolean"==typeof e)return"";if(Array.isArray(e)&&(e=e[0]),void 0!==e.time||void 0!==e.seconds){const t={seconds:e.seconds||CZe(e.time),time:e.time||wZe(e.seconds)};return t.text=bZe(t),"Invalid Date"===t.text?"":t}return!isNaN(e)||"string"==typeof e&&-1!==e.indexOf("\n")?"":(e.name&&(e=e.name),yZe(e))}toEmailModel(e){return!e||"boolean"==typeof e||Array.isArray(e)&&!(e=e[0])||(e.name&&(e=e.name),"string"!=typeof e)?"":e=e.replace(/\n/g,"")}toFileModel(e){if(!e)return[];Array.isArray(e)||(e=[e]);return e.map((e=>(e=>"error"===e.status||"progress"===e.status?e:void 0!==e.src&&e.uid&&(e.fileKey=Gt.FileUtils.getFileKey(e.src),e.fileKey)?(e.name||(e.name=e.src),e.src=Af(e.src),e):"")(e)))}toImageModel(e){if(!e)return[];Array.isArray(e)||(e=[e]);const t=e=>e?(e.login&&(e.src=e.avatar_url),"error"===e.status||"progress"===e.status?e:void 0!==e.src&&(e=>{try{const t=new URL(e);return Gt.FileUtils.isImage(t.origin+t.pathname)}catch{return!1}})(e.src)?(e.name||(e.name=e.src),e.src=Af(e.src),e):""):"";return e.map((e=>t(e)))}toLinkModel(e){if(!e||e.seconds||e.time||"boolean"==typeof e)return"";if(e.src)return e.src=String(Af(e.src)),e.name=String(e.name)||"",e;if(Array.isArray(e)&&!(e=e[0]))return"";if(e.login)return{name:e.name,src:`/${e.login}`};e.name&&(e=e.name);let t=Af(e=(e=String(e)).replace(/\n/gi,""));return pf(e)&&(t="mailto:"+e),t?{src:t,name:e}:{name:e,src:"http://"+e}}toMentionModel(e){var t,r;return Array.isArray(e)&&0!==e.length&&null!=(t=e[0])&&t.login&&null!=(r=e[0])&&r.name?e.map((e=>(e.work_id&&!e.avatar_url&&(e.avatar_url=`/__workers/r/avatar_buc/${e.work_id}`),e))):""}toSelectModel(e,t){if(!e)return"";let r=e;if(Array.isArray(e))r=e[0];else if(void 0!==e.seconds)r=e.text||bZe(e);else if(void 0!==e.time)r=e.text||_Ze(e);else{if(e&&"boolean"==typeof e)return"";isNaN(e)||(r=e+"")}if(!r)return"";r.name&&(r=r.name);const n=t.find((e=>e.uuid===r||e.name===r));return n?[n.uuid]:null}toMultiSelectModel(e,t){if(!e)return"";let r=e;if(Array.isArray(e)){const r=[];return e.forEach((e=>{if(!e)return;e=e.name||e;const n=t.find((t=>t.uuid===e||t.name===e));n&&r.push(n.uuid)})),0!==r.length?r:""}if(void 0!==e.seconds)r=e.text||bZe(e);else if(void 0!==e.time)r=e.text||_Ze(e);else{if("boolean"==typeof e)return"";isNaN(e)||(r=e+"")}e.name&&(r=e.name);const n=t.find((e=>e.uuid===r||e.name===r));return n?[n.uuid]:null}toNumberModel(e){return e?"boolean"==typeof e?Df(e?"1":"0"):Array.isArray(e)&&!(e=e[0])?"":(e.name&&(e=e.name),Df(e)):""}toPhoneModel(e){return!e||"boolean"==typeof e||Array.isArray(e)&&!(e=e[0])||(e.name&&(e=e.name),"string"!=typeof e&&"number"!=typeof e)?"":e=(e=String(e)).replace(/\n/g,"")}}const SZe={token:ZM,useValue:{registerProcess(){const e=new EZe;return{processFieldModel:(t,r)=>e.toFieldModel(t,r)}}}},kZe=({docId:e,docType:t,webSdk:r,webProxy:n})=>({token:dKe,useValue:{registerServer:()=>(r.TableShareController={update:async e=>await n.shares.update(e)},{apiSdk:r,processParams:r=>(r.docId=e,r.docType=t,r)})}}),xZe=({docId:e,docType:t,webProxy:r,currentUser:n})=>({token:kI,useValue:{registerUser:()=>({searchUser:async e=>(await r.users.complete({q:e})).map((e=>({uid:String(e.id||e.uid),name:e.name,login:e.login,icon:e.avatar||e.avatar_url||e.icon,work_id:e.work_id}))),async contextUsers(){if("Doc"!==t)return[];let n=await r.users.listDocContextUsers({id:e})||[];const i=this.getCurrentUser();return i&&n.push(i),n=Zt()(n.map((e=>({uid:String(e.id||e.uid),name:e.membership?e.membership.name:e.name,login:e.login,icon:e.membership&&e.membership.avatar||e.avatar_url||e.icon,work_id:e.work_id}))),"uid"),n},getCurrentUser:()=>n?{uid:n.uid||String(n.id),work_id:n.work_id,login:n.login,name:n.name,icon:n.icon||n.avatar_url}:wze.me?{uid:String(wze.me.id),work_id:wze.me.work_id,login:wze.me.login,name:wze.me.name,icon:wze.me.avatar_url}:null})}});const OZe=({docId:e,webSdk:t})=>({token:jJe,useValue:{registerAiWritingDatasourcePost:()=>async({content:r,type:n})=>await async function(e,t,r={}){return e.post("/api/ai/table/completion",t,r)}(t.req,{content:r,type:n,context_id:e})}}),IZe=({docId:e,docType:t,webProxy:r})=>({token:Mze,useValue:{registerForm:()=>({async getForm(e){if("Doclet"===t)return;const n=await r.shares.findOne({target_id:e,target_type:"Skythings.View",type:"form"});return n&&n.token?{src:`/forms/share/${n.token}`,status:n.status}:void 0}})}}),RZe=({docId:e,docType:t,webSdk:r,webProxy:n,currentUser:i})=>[SZe,kZe({docId:e,docType:t,webSdk:r,webProxy:n}),xZe({docId:e,docType:t,webProxy:n,currentUser:i}),IZe({docId:e,docType:t,webProxy:n}),lZe({docId:e,docType:t,webSdk:r}),OZe({docId:e,webSdk:r})],TZe="ctoken",AZe="yuque_ctoken",MZe=Array.isArray;function NZe(e,t,r,n){let i,o,a;const s=/\[\]$/;if(MZe(t))for(o=0;t&&o<t.length;o++)a=t[o],r||s.test(e)?n(e,a):NZe(e+"["+("object"==typeof a?o:"")+"]",a,r,n);else if(t&&"[object Object]"===t.toString())for(i in t)t.hasOwnProperty(i)&&NZe(e+"["+i+"]",t[i],r,n);else n(e,t)}function DZe(e,t){return e+(/\?/.test(e)?"&":"?")+t}function PZe(e,t){let r,n;const i=t||!1,o=[],a=encodeURIComponent;function s(e,t){let r=t;"function"==typeof t?r=t():null==t&&(r=""),o[o.length]=a(e)+"="+a(r)}if(MZe(e))for(n=0;e&&n<e.length;n++)s(e[n].name,e[n].value);else for(r in e)e.hasOwnProperty(r)&&NZe(r,e[r],i,s);return o.join("&").replace(/%20/g,"+")}function jZe(e){return typeof FormData<"u"&&e instanceof FormData}const FZe=window,VZe=document,{head:LZe}=document,$Ze=/^http/,BZe=/(^\w+):\/\//,UZe=/^20\d$/,zZe="readyState",HZe="Content-Type",WZe="X-Requested-With",GZe="reqwest_"+ +new Date;let KZe,qZe=0;function YZe(){}const JZe={traditional:!1,contentType:"application/x-www-form-urlencoded",requestedWith:"XMLHttpRequest",accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},dataFilter:e=>e};function XZe(e,t,r){return()=>e._aborted?r("Request is aborted",e.request):e._timedOut?r("Request is aborted: timeout",e.request):void(e.request&&4===e.request[zZe]&&(e.request.onreadystatechange=YZe,function(e){const t=BZe.exec(e.url);let r="";return t&&(r=t[1]),r||(r=(e.o.context||FZe).location.protocol),$Ze.test(r)?UZe.test(e.request.status):!!e.request.response}(e)?t(e.request):r(e.request.statusText,e.request)))}function ZZe(e){KZe=e}function QZe(e,t,r,n){let i=n;const o=qZe++,a=e.jsonpCallback||"callback";let s=e.jsonpCallbackName||function(e){return GZe+"_"+e}(o);const l=new RegExp("((^|\\?|&)"+a+")=([^&]+)"),c=i.match(l),u=VZe.createElement("script");let d=0;return c?"?"===c[3]?i=i.replace(l,"$1="+s):s=c[3]:i=DZe(i,a+"="+s),FZe[s]=ZZe,u.type="text/javascript",u.src=i,u.async=!0,u.onload=u.onreadystatechange=()=>{if(u[zZe]&&"complete"!==u[zZe]&&"loaded"!==u[zZe]||d)return!1;u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),t(KZe),KZe=void 0,LZe.removeChild(u),d=1},LZe.appendChild(u),{abort(){u.onload=u.onreadystatechange=null,r("Request is aborted: timeout"),KZe=void 0,LZe.removeChild(u),d=1}}}function eQe(e,t){const r=this.o,n=(r.method||"GET").toUpperCase();let i="string"==typeof r?r:r.url,o=!1!==r.processData&&r.data&&"string"!=typeof r.data&&!jZe(r.data)?PZe(r.data,r.traditional||JZe.traditional):r.data||null;if(("jsonp"===r.type||"GET"===n)&&o&&(i=DZe(i,o),o=null),"jsonp"===r.type)return QZe(r,e,t,i);const a=r.xhr&&r.xhr(r)||function(e){const t=new XMLHttpRequest;if(!0===e.crossOrigin&&!("withCredentials"in t))throw new Error("Browser does not support cross-origin requests");return t}(r);return a.open(n,i,!1!==r.async),function(e,t){const r=t.headers||{};let n;for(n in r.Accept=r.Accept||JZe.accept[t.type]||JZe.accept["*"],!t.crossOrigin&&!r[WZe]&&(r[WZe]=JZe.requestedWith),!r[HZe]&&!jZe(t.data)&&(r[HZe]=t.contentType||JZe.contentType),r)r.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,r[n])}(a,r),function(e,t){typeof t.withCredentials<"u"&&typeof e.withCredentials<"u"&&(e.withCredentials=!!t.withCredentials)}(a,r),a.onreadystatechange=XZe(this,e,t),r.before&&r.before(a),a.send(o),a}function tQe(){this.initPromise()}function rQe(){return new tQe}function nQe(e){const t=this;this.url="string"==typeof e?e:e.url,this.timeout&&clearTimeout(this.timeout),this.timeout=null,e.timeout&&(this.timeout=setTimeout((function(){t._timedOut=!0,t.request.abort()}),e.timeout)),this.request=eQe.call(this,(function(e){t.triggerSuccess(e)}),(function(e,r){t.triggerError(e,r)}))}tQe.prototype={triggerSuccess(e){const t=this.o;let r=t.type;const n=(t.dataFilter||JZe.dataFilter)(e.responseText,r);if(r||(r=e&&function(e){if(e){if(e.match("json"))return"json";if(e.match("javascript"))return"js";if(e.match("text"))return"html";if(e.match("xml"))return"xml"}}(e.getResponseHeader("Content-Type"))),e="jsonp"!==r?this.request:e,n)switch(r){case"json":try{e=FZe.JSON.parse(n)}catch{return this.triggerError("Could not parse JSON in response",e)}break;case"html":e=n;break;case"xml":e=e.responseXML&&e.responseXML.parseError&&e.responseXML.parseError.errorCode&&e.responseXML.parseError.reason?null:e.responseXML}t.success&&t.success(e),this.triggerComplete(e),this.__resolve(e)},triggerError(e,t){const r=this.o,n=new Error(e);n.xhr=t,r.error&&r.error(n),this.triggerComplete(n),this.__reject(n)},triggerComplete(e){const t=this.o;t.timeout&&clearTimeout(this.timeout),this.timeout=null,t.complete&&t.complete(e)},initPromise(){const e=this;e.promise=new Promise(((t,r)=>{e.__resolve=t,e.__reject=r}))},abort(){this._aborted=!0,this.request.abort()},retry(){this.initPromise(),nQe.call(this,this.o)},then(e,t){return this.promise.then(e,t)},always(e){return this.promise.then(e,e)},fail(e){return this.promise.then(void 0,e)},catch(e){return this.fail(e)},setup(e){this.o={...JZe,...e}},start(e){this.setup(e),nQe.call(this,this.o)}},rQe.ajaxSetup=(e={})=>{for(const t in e)e.hasOwnProperty(t)&&JZe.hasOwnProperty(t)&&(JZe[t]=e[t])};const iQe="_ts",oQe="_input_charset",aQe="utf-8",sQe={withCToken:!0,withInputCharset:!0,cache:!0};function lQe(e,t=window){const r={...sQe,...e},n=sQe.cache||"post"===r.method,i=function(e){const t=e.document.cookie.split(/;\s/g);for(let e=0,r=t.length;e<r;e++){const r=t[e].match(/([^=]+)=/i);if(r&&r[1]===AZe)return t[e].substring(r[1].length+1)}}(t),{withCToken:o,withInputCharset:a}=r;let s;return r.data=r.data||{},Array.isArray(r.data)?(s=[],o&&i&&s.push({name:TZe,value:encodeURIComponent(i)}),a&&s.push({name:oQe,value:aQe}),n||s.push({name:iQe,value:Date.now()}),r.data=r.data.concat(s)):"string"==typeof r.data?(a&&-1===r.data.indexOf(oQe)&&(r.data+="&"+oQe+"="+aQe),o&&i&&-1===r.data.indexOf(TZe)&&(r.data+="&"+TZe+"="+encodeURIComponent(i)),n||(r.data+="&"+iQe+"="+Date.now())):jZe(r.data)?(a&&!r.data.get(oQe)&&r.data.append(oQe,aQe),r.url&&o&&i&&(r.url=DZe(r.url,PZe({[TZe]:i})))):(a&&(r.data[oQe]=aQe),n||(r.data[iQe]=Date.now()),o&&i&&!r.data[TZe]&&(r.data[TZe]=i)),r}function cQe(e,t){let r;r="string"==typeof e?{url:e,success:t}:e,e=r.url;const n=rQe();return e.startsWith("//")&&(e=location.protocol+e),function(e){return!/^https?:\/\/\w+\.alipayobjects\.com\//g.test(e)}(e)&&(r=lQe(r)),n.start(r),n}cQe.ajaxSetup=e=>{for(const t in e)e.hasOwnProperty(t)&&sQe.hasOwnProperty(t)&&(sQe[t]=e[t]);rQe.ajaxSetup(e)},cQe.ajaxSetup({withInputCharset:!1});const uQe=new class{constructor(e={}){this.options={ajaxOptions:{progress(){},error(){},success(){},data:{},method:"post",url:""},...e}}ajax(e){(e={...this.options.ajaxOptions,...e}).url=function(e){var t,r,n,i;if(e.startsWith("http"))return e;const o=(null==(r=null==(t=globalThis.nebulaMobileApp)?void 0:t.envInfo)?void 0:r.origin)||(null==(i=null==(n=globalThis.yqWebApp)?void 0:n.globalServiceEnv)?void 0:i.host);return o?`${o}${e}`:e}(e.url);const t=e.success,r=e.error,n=new Promise((n=>{e.success=e=>{t(e),n(e)},e.error=e=>{r(e),n(e)}}));return{xhr:cQe(e),promise:n}}},dQe=e=>{if(globalThis.__ajaxProxy){const t=globalThis.__ajaxProxy(e);if(t)return t}return uQe.ajax(e)};var fQe=Object.defineProperty,hQe=Object.getOwnPropertyDescriptor,pQe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?hQe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fQe(t,r,o),o};let gQe=class{getConfig(e){return this._configuration.getValue(`upload.${e}`)}async tryQuickUpload(e,t){const r=this.getConfig(t);if(!r.quickUrl)return!1;const n=await Object(Gt.fileMd5)(e),i=e.size,o=e.name,a=e.type;let s;return await dQe({xhr:()=>new window.XMLHttpRequest,url:r.quickUrl,data:{md5:n,filesize:i,filename:o,filetype:a,type:t},dataType:"json",success:e=>{e&&!1===e.data.success||(s=e)},error:e=>{console.error(e)},method:"POST",processData:!0}).xhr.promise,!(!s||!1===s.success)&&s}async uploadFile(e,t,r){const n=this.getConfig(t),i=new FormData;i.append("file",e,e.name);const o=(n.url||"").replace(/ctoken=[^&]+&/,"");dQe({xhr:()=>{const t=new window.XMLHttpRequest;return t.upload.addEventListener("progress",(t=>{t.lengthComputable&&r({id:e.uid,status:"running",file:e,percent:parseInt(String(t.loaded/t.total*100),10)})}),!1),t},url:o,data:i,dataType:"json",success:({data:t})=>{t?(e.src=t.url,r({id:e.uid,status:"success",file:e})):r({id:e.uid,status:"error",message:Ph("上传失败"),file:e})},error:t=>{let n,i="";if(t&&t.xhr&&t.xhr.response)try{n=JSON.parse(t.xhr.response),i=n.message||""}catch{i=""}else i=t.message;i||(i=Ph("上传失败")),r({id:e.uid,status:"error",file:e,message:i})},method:"POST",processData:!0})}async upload(e,t,r){try{const n=await this.tryQuickUpload(e,t);n?(e.src=n.data.url,r({id:e.uid,status:"success",file:e})):await this.uploadFile(e,t,r)}catch(n){console.error(n),await this.uploadFile(e,t,r)}}};pQe([ao(lp)],gQe.prototype,"_configuration",2),gQe=pQe([io()],gQe);var mQe=Object.defineProperty,vQe=Object.getOwnPropertyDescriptor,yQe=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?vQe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&mQe(t,r,o),o};let bQe=class{static pluginModule(){return xo().register(gQe).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"upload",type:"object",properties:{image:{type:"object",properties:{url:{type:"string",description:"图片上传接口"},quickUrl:{type:"string",description:"图片秒传接口"}}},file:{type:"object",properties:{url:{type:"string",description:"文件上传接口"},quickUrl:{type:"string",description:"文件秒传接口"}}}}}),e.registerDefaultValue({"upload.image.url":"/api/upload/attach?&type=image","upload.image.quickUrl":"/api/upload/upload_by_digset?&type=image","upload.file.url":"/api/upload/attach?&type=attach","upload.file.quickUrl":"/api/upload/upload_by_digset?&type=attach"})}init(){}registerUpload(){return{upload:(e,t,r)=>this._uploadService.upload(e,t,r),checkSize:(e,t)=>{try{if(window.__member_message_ref){const{msg:r,alwaysOpen:n,level:i,callback:o}=window.__member_message_ref.current.getMessageWithFile({filesize:e.size},t)||{};if(r)return o(m.a[i||"error"](r,n?0:void 0)),!1}}catch(e){return console.error(e),!1}return!0}}}};bQe.pluginName="render-upload",yQe([ao(gQe)],bQe.prototype,"_uploadService",2),bQe=yQe([io({contrib:[Dz,b6]})],bQe);const _Qe=({field:e,position:t})=>{const r=HL(HJe),n=HL($Je),i=HL(lp),o=null==r?void 0:r.getAiWritingConfig(e.get("uuid")),l=null==i?void 0:i.getValue("aiWriting.enable"),[c,u]=Object(a.useState)((null==n?void 0:n.isFieldGenerating(e.get("uuid")))||!1),d=(null==o?void 0:o.open)&&l;return Object(a.useLayoutEffect)((()=>{if(!d||"gridHeader"!==t)return void u(!1);const r=null==n?void 0:n.onAiWritingStatusChange((({isGenerating:t,fieldId:r})=>{r===e.get("uuid")&&t?u(!0):u(!1)}));return()=>{null==r||r.destroy()}}),[n,d,t,e.get("uuid")]),d?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ft.default,{className:"lakex-table-grid-header-ai-writing-icon",width:16,height:16}),c&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon","data-no-dnd":"true",width:16,height:16,onClick:async()=>{await(null==r?void 0:r.stopAiWriting(e.get("uuid"))),m.a.success(Ph("已停止填写"))}})):null};var wQe=Object.defineProperty,CQe=Object.getOwnPropertyDescriptor;let EQe=class{static pluginModule(){return xo().register(this)}init(){}getTextFieldTagComponent(){return _Qe}};EQe.pluginName="render-ai-writing",EQe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?CQe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&wQe(t,r,o),o})([io({contrib:[Dz,u7]})],EQe);const SQe=({fields:e,view:t,viewFields:r})=>{const{viewFieldIds:n,onInsert:i,onRemove:o}=(({view:e,viewFields:t})=>{const r=HL(zI);return{viewFieldIds:Object(a.useMemo)((()=>Bp(t,(e=>{var t;return null==(t=e.get("field"))?void 0:t.get("uuid")}))),[t]),onInsert:t=>{null==r||r.execCommand("insertViewField",{viewId:e.get("uuid"),fieldId:t.uuid})},onRemove:t=>{null==r||r.execCommand("removeViewField",{viewId:e.get("uuid"),fieldId:t.uuid})}}})({view:t,viewFields:r}),l=HL(nH);return s.a.createElement("div",{className:"lakex-form-col-container"},s.a.createElement("div",{className:"lakex-form-col-intro"},Ph("所有列"),s.a.createElement(p.a,{title:Ph("数据表中所有列")},s.a.createElement(XU,{type:"Question"}))),s.a.createElement("div",{className:"lakex-form-col-items"},Bp(e,((e,t)=>{const r=n.includes(e.get("uuid")),a=n.findIndex((t=>t===e.get("uuid"))),c=l.getFieldIcon(e.get("type"));return s.a.createElement("div",{className:"lakex-form-col "+(r?"active":"deactive"),key:e.get("uuid"),onClick:()=>{i(e)}},s.a.createElement("div",{className:"lakex-form-col-name"},c&&s.a.createElement(c,null),e.get("name")),r&&s.a.createElement("span",{className:"lakex-form-col-state"},Ph("添加")),r&&s.a.createElement("span",{className:"lakex-form-col-state-remove",onClick:t=>{t.stopPropagation(),t.preventDefault(),o(e)}},Ph("取消添加")),!r&&s.a.createElement("span",{className:"lakex-form-col-state add"},Ph("添加")," ",s.a.createElement(XU,{type:"ArrowRight",style:{marginLeft:4}})),s.a.createElement("div",{className:"lakex-form-col-fields"},function(e,t){return e?s.a.createElement("span",null,null!=t?`${t+1}.`:"",e.get("name")):s.a.createElement("span",{className:"lakex-form-col-untitled"},Ph("未命名问题"))}(e,a)))}))))},kQe=({view:e,defaultValue:t})=>{const r=HL(zI),n=HL(Lh),i=Object(a.useRef)(null);return Object(a.useEffect)((()=>{null==n||n.onChange((({spell:t})=>{var r;"view"===t.table&&t.command===Bh.UPDATE&&e.get("uuid")===t.where.uuid&&null!=t.sets.name&&(null==(r=i.current)||r.setValue(t.sets.name))}))}),[]),s.a.createElement(u.a,{ref:i,className:"lakex-form-title",autoFocus:""===t,autoSize:!0,defaultValue:t,onBlur:t=>{null==r||r.execCommand("updateViewName",{viewId:null==e?void 0:e.get("uuid"),name:t.target.value})},onClick:e=>{e.stopPropagation()},placeholder:Ph("请输入表单标题")})},xQe=({view:e,defaultValue:t,maxLength:r=255})=>{const n=HL(zI);return s.a.createElement(u.a.TextArea,{autoSize:!0,className:"lakex-form-desc",maxLength:r,defaultValue:t,onBlur:t=>{null==n||n.execCommand("updateViewDesc",{viewId:null==e?void 0:e.get("uuid"),desc:t.target.value})},size:"small",onClick:e=>{e.stopPropagation()},placeholder:Ph("请输入表单描述")})},OQe=({view:e})=>{const t=HL(KO),r=HL(zI);return s.a.createElement("div",{className:"lakex-form-empty-field"},s.a.createElement("img",{className:"lakex-form-empty-field-img",src:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*oG_ZTrK2ylsAAAAAAAAAAAAADvuFAQ/original"}),s.a.createElement("p",null,Ph("表单为空")),s.a.createElement("span",{className:"lakex-form-empty-field-tip"},Ph("点击左侧列表添加已有列 或 点击下方按钮添加新表单项")),s.a.createElement("br",null),s.a.createElement(b.a,{type:"primary",onClick:()=>{const n=t.getAllFields(),i=wE(pE.TEXT,Bp(n,(e=>({name:e.get("name"),type:e.get("type")}))));r.execCommand("addField",{viewId:e.get("uuid"),field:{uuid:To(32),name:i,type:pE.TEXT}})}},s.a.createElement(XU,{type:"Add"}),Ph("添加")))},IQe=e=>{const{defaultValue:t}=e,r=!t;return s.a.createElement("div",{className:"lake-form-item-ui-container "+(r?"lake-form-item-ui-show-tooltip":"")},s.a.createElement(u.a,{autoFocus:!0,placeholder:Ph("请输入问题"),...e,maxLength:128}),r&&s.a.createElement(p.a,{title:Ph("当问题为空时，会使用列名作为问题；如未重命名列，所填写的问题会自动同步给列名。")},s.a.createElement(XU,{className:"lake-form-item-input-tooltip",type:"Question"})))},RQe=({viewField:e})=>{const{getFormComponent:t}=(()=>{const e=HL(nH);return{getFormComponent:t=>e.getFieldFormComponent(t)}})();if(!e||!e.get("field"))return null;const r=t(e.get("field").get("type"));return r?s.a.createElement(p.a,{placement:"bottom",title:Ph("此处由填写者输入")},s.a.createElement("div",{className:"lakex-form-item-field"},s.a.createElement("div",{className:"lakex-form-item-field-mask"}),s.a.createElement(r,{viewField:e}))):null},TQe=({viewField:e})=>{var t,r;const{getFormComponent:n,onChange:i,onChangeOrder:o}=(({viewField:e})=>{const t=HL(nH),r=HL(zI),n=HL(zde);return{getFormComponent:e=>t.getFieldFormComponent(e),onChange(t){null==r||r.execCommand("updateFieldProperty",{uuid:e.field.uuid,...t})},onChangeOrder(t,r){null==n||n.updateFieldOptionOrder(e.field.uuid,t,r)}}})({viewField:e});if(!e||!e.get("field"))return null;const a=e.get("field").get("type"),l=n(a);if(!l)return null;const c=l.OptionEditable;return c?s.a.createElement("div",{className:"lakex-table-form-designer-option-wrap"},s.a.createElement(c,{type:a,options:null==(t=e.get("field"))?void 0:t.get("options"),color:null==(r=e.get("field"))?void 0:r.get("color"),onChange:i,onChangeOrder:o,autoFocus:!1})):null},AQe=({view:e,viewField:t,viewFields:r})=>{const{onMoveUp:n,onMoveDown:i,onClone:o,onRemove:a,onChangeRequired:l,onChangeName:c,onCreateAfter:u,onChangeDisplayType:d,openFieldConfigModal:f,Icon:g}=(({view:e,viewField:t,viewFields:r})=>{const n=HL(KO),i=HL(zI),o=HL(Qz),a=HL(nH);return{onMoveUp:t=>{var n;const o=Lp(r,(e=>e.get("uuid")===t.get("uuid")));if(0===o)return;const a=null==(n=r.get(o-1))?void 0:n.get("field_uuid");null==i||i.execCommand("changeFieldOrder",{viewId:e.get("uuid"),sourceFieldId:t.get("field_uuid"),targetFieldId:a})},onMoveDown:t=>{var n;const o=Lp(r,(e=>e.get("uuid")===t.get("uuid"))),a=null==(n=r.get(o+1))?void 0:n.get("field_uuid");!a||null==i||i.execCommand("changeFieldOrder",{viewId:e.get("uuid"),sourceFieldId:t.get("field_uuid"),targetFieldId:a})},onClone:t=>{null==i||i.execCommand(Aze.commandName,{viewId:e.get("uuid"),fieldId:t.get("field_uuid")})},onRemove:e=>{null==i||i.execCommand("removeViewField",{viewId:e.get("view_uuid"),fieldId:e.get("field").get("uuid")})},onChangeRequired:(t,r)=>{null==i||i.execCommand(Rze.commandName,{viewId:e.get("uuid"),fieldId:t.get("field_uuid"),required:r.target.checked})},onChangeDisplayType:(t,r)=>{null==i||i.execCommand(Ize.commandName,{viewId:e.get("uuid"),fieldId:t.get("field_uuid"),displayType:r})},onChangeName:Wt()(((t,r)=>{(t.get("name")||t.get("field").get("name"))!==r&&(null==i||i.execCommand(Tze.commandName,{viewId:e.get("uuid"),fieldId:t.get("field_uuid"),name:r}))}),1e3),onCreateAfter:t=>{const r=n.getAllFields(),o=wE(pE.TEXT,Bp(r,(e=>({name:e.get("name"),type:e.get("type")}))));null==i||i.execCommand("addField",{viewId:e.get("uuid"),field:{uuid:To(32),name:o,type:pE.TEXT},sourceFieldId:t.get("field_uuid")})},openFieldConfigModal(e,t){null==o||o.emitClickEvent({eventName:"fieldConfigClick",data:{viewField:e,e:t}})},Icon:({type:e})=>{const t=null==a?void 0:a.getFieldIcon(e);return t?s.a.createElement(t,{size:16}):null}}})({view:e,viewField:t,viewFields:r});if(!t.get("field"))return null;const m=t.get("field").get("type");return s.a.createElement("div",{className:"lakex-form-item active"},s.a.createElement("div",{className:"lakex-form-item-inner"},s.a.createElement("div",{className:"lakex-form-item-inner-sidebar",onClick:e=>{e.stopPropagation()}},s.a.createElement(p.a,{placement:"left",title:Ph("向上移动")},s.a.createElement(XU,{type:"ArrowUp",onClick:()=>{n(t)}})),s.a.createElement(p.a,{placement:"left",title:Ph("向下移动")},s.a.createElement(XU,{type:"ArrowDown",onClick:()=>{i(t)}})),s.a.createElement(p.a,{placement:"left",title:Ph("复制表单项")},s.a.createElement(XU,{type:"Copy",onClick:()=>{o(t)}})),s.a.createElement(p.a,{placement:"left",title:Ph("移除表单项")},s.a.createElement(XU,{type:"Clear",onClick:()=>{a(t)}}))),s.a.createElement("div",{className:"lakex-form-item-inner-container"},s.a.createElement("div",{className:"lakex-form-item-inner-column-configs"},s.a.createElement("div",{className:"lakex-form-item-inner-column-name"},s.a.createElement(p.a,{placement:"top",title:Ph("点击修改字段")},s.a.createElement("span",{className:"lakex-form-item-inner-column-content",onClick:e=>f(t,e)},s.a.createElement(g,{type:m}),null==t?void 0:t.get("field").get("name"),s.a.createElement(XU,{type:"Edit"})))),s.a.createElement("div",{className:"lakex-form-item-inner-type"},s.a.createElement("div",{className:"lakex-form-item-inner-validation"},s.a.createElement(h.a,{defaultChecked:t.get("required"),onChange:e=>l(t,e)},Ph("必填"))))),s.a.createElement("div",{className:"lakex-form-item-inner-field-configs"},s.a.createElement(IQe,{defaultValue:t.get("name")||t.get("field").get("name"),onChange:e=>{c(t,e.target.value)},onBlur:e=>{c(t,e.target.value)}}),s.a.createElement(RQe,{viewField:t}),s.a.createElement(TQe,{viewField:t}),zE.isSelectLike(m)&&s.a.createElement("div",{className:"lakex-form-item-option-layout"},s.a.createElement("span",{style:{color:"#8c8c8c"}},Ph("布局方式"),":"),s.a.createElement(S.a,{defaultValue:t.get("display_type")||"list",bordered:!1,onChange:e=>{d(t,e)},dropdownClassName:"lakex-form-item-dropdown"},s.a.createElement(S.a.Option,{value:"list"},Ph("列表")),s.a.createElement(S.a.Option,{value:"dropdown"},Ph("下拉")))))),t.get("required")&&""===t.get("name")?s.a.createElement("div",{className:"lakex-form-item-inner-error"},Ph("请输入问题")):null),s.a.createElement("div",{className:"lakex-form-item-inner-add"},s.a.createElement(b.a,{onClick:e=>{u(t)},onMouseDown:e=>{e.stopPropagation()}},s.a.createElement(XU,{type:"Add"}),Ph("添加"))))},MQe=({viewField:e,onClick:t=(()=>{}),index:r})=>{var n;return s.a.createElement("div",{className:"lakex-form-item lakex-form-item-normal",onClick:t},s.a.createElement("div",{className:"lakex-form-item-normal-preview"},s.a.createElement("div",{className:e.get("required")?"lakex-form-item-normal-preview-required":""},`${r+1}. ${e.get("name")||(null==(n=e.get("field"))?void 0:n.get("name"))}`),s.a.createElement("div",{className:"lakex-form-item-normal-comp"},s.a.createElement(RQe,{viewField:e}))),e.get("required")&&""===e.get("name")?s.a.createElement("div",{className:"lakex-form-item-error"},Ph("请输入问题")):null)},NQe=({index:e,active:t,view:r,viewField:n,viewFields:i,onClick:o=(()=>{})})=>t?s.a.createElement(AQe,{view:r,viewField:n,viewFields:i}):s.a.createElement(MQe,{onClick:o,index:e,viewField:n}),DQe=({view:e,viewFields:t})=>{const{state:r,forceUpdate:n,setActiveId:i,onCreate:o}=(({view:e,viewFields:t})=>{const[r,n]=Object(a.useState)(),i=HL(KO),o=HL(zI),s=dz();return Object(a.useEffect)((()=>{const e=e=>{let t=e.target;if("INPUT"!==t.tagName){for(;t&&t.classList&&t!==document.body;){if(t.classList.contains("lakex-form-item")||t.classList.contains("lakex-form-item-dropdown")||t.classList.contains("lakex-table-col-configs")||t.classList.contains("lakex-table-colorpicker")||t.classList.contains("lakex-table-menu-configs-submenu")||t.classList.contains("lakex-table-ai-writing-config-modal"))return;t=t.parentNode}n(void 0),s()}};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}}),[]),{state:{activeId:r},forceUpdate:s,setActiveId:n,onCreate(){var r;const n=i.getAllFields(),a=wE(pE.TEXT,Bp(n,(e=>({name:e.get("name"),type:e.get("type")}))));null==o||o.execCommand("addField",{viewId:e.uuid,field:{uuid:To(32),name:a,type:pE.TEXT},sourceFieldId:null==(r=t[t.length-1])?void 0:r.field_uuid})}}})({view:e,viewFields:t});return s.a.createElement("div",{className:"lakex-form-list"},Bp(t,((o,a)=>{const l=o.get("field");return l?s.a.createElement(NQe,{view:e,viewField:o,viewFields:t,index:a,active:o.get("uuid")===r.activeId,key:l.get("uuid"),onClick:()=>{i(o.get("uuid")),n()}}):null})),s.a.createElement("div",{className:"lakex-form-list-footer"},s.a.createElement(b.a,{type:"primary",onClick:e=>{o()}},s.a.createElement(XU,{type:"Add"}),Ph("添加"))))},PQe=({viewId:e})=>{const t=HL(Uze),r=HL(jR),[n,i]=Object(a.useState)(null==t?void 0:t.getFormEditData(e));return Object(a.useEffect)((()=>{const n=r.onDataChanged((()=>{(()=>{const r=null==t?void 0:t.getFormEditData(e);i(r)})()}));return()=>{n.destroy()}}),[]),{formData:n}},jQe=e=>{var t,r,n,i;const{formData:o}=PQe({viewId:e.viewId});return o?s.a.createElement("div",{className:"lakex-form-container"},(null==o?void 0:o.fields)&&s.a.createElement(SQe,{view:o.view,fields:o.fields,viewFields:o.viewFields}),s.a.createElement("div",{className:"lakex-form-configs"},s.a.createElement("div",{className:"lakex-form-configs-bg"},0!==(null==(t=o.viewFields)?void 0:t.length)&&s.a.createElement("div",{className:"lakex-form-configs-title"},s.a.createElement(kQe,{view:o.view,defaultValue:null==(r=o.view)?void 0:r.get("name")}),s.a.createElement(xQe,{view:o.view,defaultValue:null==(n=o.view)?void 0:n.get("desc")})),0===(null==(i=o.viewFields)?void 0:i.length)?s.a.createElement(OQe,{view:o.view}):s.a.createElement(DQe,{view:o.view,viewFields:o.viewFields})))):null},FQe=s.a.forwardRef(((e,t)=>{const{status:r,onOpenManage:n,viewId:i,canUpdate:o}=(()=>{const e=e7(),t=X9(aR.TABLE),r=HL(Uze),n=HL(Qz),i=HL(Lh),[o,s]=Object(a.useState)(Nze.PENDING),l=e.view.get("id"),c=e.view.get("uuid"),u=Object(a.useCallback)((e=>{const t=null==r?void 0:r.getShare(e);(null==t?void 0:t.get("status"))===kE.ACTIVE?s(Nze.COLLECTING):s(Nze.PENDING)}),[c]);return Object(a.useEffect)((()=>{if(l){const e=null==r?void 0:r.getShare(c);e?e.get("status")===kE.ACTIVE?s(Nze.COLLECTING):s(Nze.PENDING):null==r||r.initForm(c).then((()=>{u(c)})),null==i||i.onChange((({spell:e})=>{"view_share"===e.table&&e.command===Bh.UPSERT&&u(c)}))}else s(Nze.PENDING)}),[l,c]),{status:o,viewId:c,canUpdate:t.canUpdate(),onOpenManage(t){var r;n.emitClickEvent({eventName:"clickFormManageButton",data:{target:t.currentTarget,viewId:null==(r=null==e?void 0:e.view)?void 0:r.get("uuid"),status:o}})}}})();if(!o)return s.a.createElement(lz,{type:az.Unauthorized,desc:Ph("查看表单视图需要编辑权限")});let l=Ph("开启收集");return r===Nze.COLLECTING&&(l=Ph("收集中")),s.a.createElement("div",{className:"lakex-table-form",ref:t,key:i},s.a.createElement(jQe,{viewId:i}),s.a.createElement(b.a,{className:"lakex-table-form-manage",type:"primary",onClick:n},l))}));class VQe extends iG{constructor(){super(...arguments),this.viewType=LE.FORM,this.title=Ph("表单视图"),this.desc=Ph("像问卷一样收集信息"),this.icon=e=>s.a.createElement(XU,{type:"FormView",...e}),this.colorCls="yuque-color-orange-5",this.Component=FQe}}var LQe=Object.defineProperty,$Qe=Object.getOwnPropertyDescriptor;let BQe=class{static pluginModule(){return xo().register(this)}init(){}registerViewer(e){e.registerItem(new VQe({onError:e.onError}))}};BQe.pluginName="render-viewer-form",BQe=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?$Qe(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&LQe(t,r,o),o})([io({contrib:[Dz,Lz]})],BQe);const UQe=[bQe,EQe,BQe],zQe=(e,t,r)=>{if(t&&t>16383||r&&r>16383)return e;if(function(){if(SL)return kL;const e=document.createElement("canvas");return kL=!(!e.getContext||!e.getContext("2d"))&&(ha.isChrome||ha.isFirefox||0===e.toDataURL("image/webp").indexOf("data:image/webp")),SL=!0,kL}()&&Gt.OssUtil.isURLInOSS(e)){const t=new URL(e);if(!t.pathname)return e;const r=t.pathname.toLowerCase(),n=[".webp",".svg"],i=r.substring(r.lastIndexOf("."));n.includes(i)||(e=Gt.OssUtil.addImageProcess(t,"format","webp"))}return e};const HQe={token:o6,useValue:{registerImage:()=>({getExts:()=>Gt.FileUtils.EXTS.IMAGE_EXT_STR,tryGetWebp:zQe,getThumbnailUrl(e,t,r,n){e=zQe(e,t,r);const i=t||n,o=Gt.DeviceUtil.getDevicePixelRatio();return i<=parseInt(n)*Number(o)?e:function(e,t,r,n){if(!r.width||!r.originWidth||!r.originHeight||!t||!t.startsWith("http")||r.originWidth>3e4||r.originHeight>3e4)return null;let i=parseInt(r.width,10);i>e&&(i=e),i*=Gt.DeviceUtil.getDevicePixelRatio();const o=t.toLowerCase();if(!Gt.OssUtil.isURLInOSS(o))return null;const a=i*(r.originHeight/r.originWidth);return i>0&&i*a<16777216&&i<4096&&a<4096&&i<r.originWidth&&!/^https?:\/\/\w+\.alipayobjects\.com\//i.test(o)&&!o.endsWith(".gif")&&!o.endsWith(".svg")?Gt.OssUtil.addImageProcess(t,"resize",`w_${i}`):null}(n,e,{width:n,originWidth:i,originHeight:r})||e}})}};function WQe(e,t){const r=Gt.FileUtils.getFileExtname(e);return Gt.FileUtils.isFileCanPreview(r,t)?Gt.FileUtils.getPreviewUrl(e):e}const GQe={token:HH,useValue:{registerFile:()=>({getExts:()=>Gt.FileUtils.EXTS.FILE_EXT_STR,getFileKey:e=>Gt.FileUtils.getFileKey(e),getPreviewUrl:e=>Gt.FileUtils.getPreviewUrl(e),getPreviewOrDownloadUrl:WQe})}},KQe={token:ED,useValue:{registerTheme:()=>({getThemeManager(){let e=wze.themeManager;return e||(e=new T.DefaultThemeManager),e}})}};class qQe{static openExternalLink(e){if(!globalThis.openExternalLink)return window.open(e,"_blank","noopener,noreferrer");globalThis.openExternalLink(e,!0)}}class YQe{constructor(e){this.openerName="file-previewer-opener",this.canPreview=e=>!0,"function"==typeof e&&(this.canPreview=e)}open(e,t){const r=Gt.FileUtils.getFileExtname(e);if(!this.canPreview(r))return void m.a.warning(s.a.createElement("span",{},[Ph("当前文档中此文件类型不支持预览和下载"),s.a.createElement("a",{style:{marginLeft:5},rel:"noreferrer",href:Gt.disableExtLink,target:"_blank",onClick:e=>{e.preventDefault(),qQe.openExternalLink(Gt.disableExtLink)}},[s.a.createElement(Lt.default)])]));let n=e;Gt.FileUtils.isFileCanPreview(r,t)&&(n=Gt.FileUtils.getPreviewUrl(e)),n&&qQe.openExternalLink(n)}}class JQe{constructor(){this.openerName="window-new-opener"}open(e){qQe.openExternalLink(e)}}const XQe=e=>[new JQe,new YQe(e.canFilePreview)];const ZQe=[new class{constructor(){this.openerName="image-viewer-opener",this.apps=["image"]}open(e,t={}){var r;let n=t.list,i=t.index||0;n||(i=0,n=[{src:e,msrc:e,width:t.width,height:t.height}]),null==(r=globalThis.NativeBridges)||r.previewImage({images:n.map((e=>({url:e.src,thumbnailUrl:e.msrc||e.src,width:e.width,height:e.height}))),index:i})}}];class QQe{constructor(e){this.openerName="file-previewer-opener",this.apps=["file"],this.canPreview=e=>!0,"function"==typeof e&&(this.canPreview=e)}open(e,t){const r=Gt.FileUtils.getFileExtname(e);if(!this.canPreview(r))return void m.a.warning(s.a.createElement("span",{},[Ph("当前文档中此文件类型不支持预览和下载"),s.a.createElement("a",{style:{marginLeft:5},rel:"noreferrer",href:Gt.disableExtLink,target:"_blank",onClick:e=>{e.preventDefault(),window.open(Gt.disableExtLink,"_blank","noopener,noreferrer")}},[s.a.createElement(Lt.default)])]));const n=WQe(e,t.size);!n||window.open(n,"_blank","noopener,noreferrer")}}const e0e=e=>({src:e.src,msrc:e.src,w:null==e?void 0:e.width,h:null==e?void 0:e.height});class t0e{constructor(){this.openerName="image-viewer-opener",this.apps=["image"]}open(e,t={}){let r=t.list,n=t.index||0;r||(n=0,r=[{src:e,width:t.width,height:t.height}]),function(e,t){const r=Object(Gt.getImageBrowser)(),n=Array.isArray(e)?e.map((e=>e0e(e))):[e].map((e=>e0e(e)));r.open(n,t||0)}(r,n)}}const r0e=e=>({token:lH,useValue:{registerOpener(){const t=[new QQe(e.canFilePreview),new t0e];return wze.isDesktop?[...t,...XQe(e)]:wze.isYuqueMobileApp?[...t,...ZQe]:t}}}),n0e=e=>{const t=e["opener.filePreview.canPreview"];return[GQe,HQe,KQe,r0e({canFilePreview:t})]},i0e=$i.defineToken("ViewerFormManageContribution");var o0e=Object.defineProperty,a0e=Object.getOwnPropertyDescriptor,s0e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?a0e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&o0e(t,r,o),o};let l0e=class{getProvider(){const e=this.formManageProvider.getContributions();return e[e.length-1].registerFormManage()}enableForm(e,t){return this.getProvider().enableForm(e,t)}};s0e([wh(i0e)],l0e.prototype,"formManageProvider",2),l0e=s0e([io()],l0e);var c0e=Object.defineProperty,u0e=Object.getOwnPropertyDescriptor,d0e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?u0e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&c0e(t,r,o),o};let f0e=class{getShare(e){if(e)return this._readService.getViewShare(e)}reOpenModal(){this._modalService.close("form-manange"),setTimeout((()=>{this._modalService.open("form-manage",{position:this._position})}),100)}setModalPosition(e){this._position=e}async createForm(e){this._readService.getView(e)||await this._commandService.execCommand("addView",{uuid:To(32),type:LE.FORM,noSwitchView:!0},!0),this._modalService.close("form-create-modal"),this._modalService.open("form-disabled-modal",{position:this._position}),this._modalService.open("form-editor",{position:{left:0,top:0}})}async removeForm(e,t){const r=this._readService.getView(e);!r||(this._commandService.execCommand("removeView",{viewId:r.get("uuid")}),this._modalService.close(t))}async disableForm(e){const t=this._readService.getView(e);!t||(this._commandService.execCommand("upsertViewShare",{viewId:t.get("uuid"),status:kE.INACTIVE}),this._modalService.close("form-enabled-modal"))}async enableForm(e){const t=this._readService.getView(e);if(!t)return;let r="create";this._readService.getViewShare(t.get("uuid"))&&(r="update");const n=await this._formManageRegistry.enableForm(t.get("id"),r);this._commandService.execCommand("upsertViewShare",{viewId:t.get("uuid"),status:kE.ACTIVE,src:n.src}),this._modalService.close("form-disabled-modal"),this._modalService.open("form-enabled-modal",{position:this._position})}isEnableManage(){return!this._configuration.getValue("form.manage.disable")}};d0e([ao(KO)],f0e.prototype,"_readService",2),d0e([ao(zI)],f0e.prototype,"_commandService",2),d0e([ao(c8)],f0e.prototype,"_modalService",2),d0e([ao(lp)],f0e.prototype,"_configuration",2),d0e([ao(l0e)],f0e.prototype,"_formManageRegistry",2),f0e=d0e([io()],f0e);const h0e=({onCreate:e})=>s.a.createElement("div",{className:"lakex-table-form-create-container"},s.a.createElement("div",null,s.a.createElement("img",{src:"https://gw.alipayobjects.com/mdn/rms_740edc/afts/img/A*fH-gQbQajwgAAAAAAAAAAAAAARQnAQ",width:"142",height:"92"})),s.a.createElement("p",{className:"lakex-table-form-create-add-desc"},Ph("可用于问卷调查、活动组织、登记报名等信息收集与整理场景。")),s.a.createElement("div",{className:"lakex-table-form-create-add"},s.a.createElement(b.a,{type:"primary",onClick:e},Ph("生成新表单")))),p0e=()=>{const{onCreate:e}=(()=>{const e=Z9(),t=HL(f0e);return{onCreate(){t.createForm(e.get("uuid"))}}})();return s.a.createElement("div",{className:"lakex-table-form-modal"},s.a.createElement(h0e,{onCreate:e}))};var g0e={},m0e={},v0e={};let y0e;const b0e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];v0e.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},v0e.getSymbolTotalCodewords=function(e){return b0e[e]},v0e.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},v0e.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');y0e=e},v0e.isKanjiModeEnabled=function(){return typeof y0e<"u"},v0e.toSJIS=function(e){return y0e(e)};var _0e={};function w0e(){this.buffer=[],this.length=0}!function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(e){return e&&typeof e.bit<"u"&&e.bit>=0&&e.bit<4},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch{return r}}}(_0e),w0e.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var C0e=w0e;function E0e(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}E0e.prototype.set=function(e,t,r,n){const i=e*this.size+t;this.data[i]=r,n&&(this.reservedBit[i]=!0)},E0e.prototype.get=function(e,t){return this.data[e*this.size+t]},E0e.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r},E0e.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var S0e=E0e,k0e={};!function(e){const t=v0e.getSymbolSize;e.getRowColCoords=function(e){if(1===e)return[];const r=Math.floor(e/7)+2,n=t(e),i=145===n?26:2*Math.ceil((n-13)/(2*r-2)),o=[n-7];for(let e=1;e<r-1;e++)o[e]=o[e-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){const r=[],n=e.getRowColCoords(t),i=n.length;for(let e=0;e<i;e++)for(let t=0;t<i;t++)0===e&&0===t||0===e&&t===i-1||e===i-1&&0===t||r.push([n[e],n[t]]);return r}}(k0e);var x0e={};const O0e=v0e.getSymbolSize;x0e.getPositions=function(e){const t=O0e(e);return[[0,0],[t-7,0],[0,t-7]]};var I0e={};!function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t=3,r=3,n=40,i=10;function o(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(e){const r=e.size;let n=0,i=0,o=0,a=null,s=null;for(let l=0;l<r;l++){i=o=0,a=s=null;for(let c=0;c<r;c++){let r=e.get(l,c);r===a?i++:(i>=5&&(n+=t+(i-5)),a=r,i=1),r=e.get(c,l),r===s?o++:(o>=5&&(n+=t+(o-5)),s=r,o=1)}i>=5&&(n+=t+(i-5)),o>=5&&(n+=t+(o-5))}return n},e.getPenaltyN2=function(e){const t=e.size;let n=0;for(let r=0;r<t-1;r++)for(let i=0;i<t-1;i++){const t=e.get(r,i)+e.get(r,i+1)+e.get(r+1,i)+e.get(r+1,i+1);(4===t||0===t)&&n++}return n*r},e.getPenaltyN3=function(e){const t=e.size;let r=0,i=0,o=0;for(let n=0;n<t;n++){i=o=0;for(let a=0;a<t;a++)i=i<<1&2047|e.get(n,a),a>=10&&(1488===i||93===i)&&r++,o=o<<1&2047|e.get(a,n),a>=10&&(1488===o||93===o)&&r++}return r*n},e.getPenaltyN4=function(e){let t=0;const r=e.data.length;for(let n=0;n<r;n++)t+=e.data[n];return Math.abs(Math.ceil(100*t/r/5)-10)*i},e.applyMask=function(e,t){const r=t.size;for(let n=0;n<r;n++)for(let i=0;i<r;i++)t.isReserved(i,n)||t.xor(i,n,o(e,i,n))},e.getBestMask=function(t,r){const n=Object.keys(e.Patterns).length;let i=0,o=1/0;for(let a=0;a<n;a++){r(a),e.applyMask(a,t);const n=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(a,t),n<o&&(o=n,i=a)}return i}}(I0e);var R0e={};const T0e=_0e,A0e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],M0e=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];R0e.getBlocksCount=function(e,t){switch(t){case T0e.L:return A0e[4*(e-1)+0];case T0e.M:return A0e[4*(e-1)+1];case T0e.Q:return A0e[4*(e-1)+2];case T0e.H:return A0e[4*(e-1)+3];default:return}},R0e.getTotalCodewordsCount=function(e,t){switch(t){case T0e.L:return M0e[4*(e-1)+0];case T0e.M:return M0e[4*(e-1)+1];case T0e.Q:return M0e[4*(e-1)+2];case T0e.H:return M0e[4*(e-1)+3];default:return}};var N0e={},D0e={};const P0e=new Uint8Array(512),j0e=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)P0e[t]=e,j0e[e]=t,e<<=1,256&e&&(e^=285);for(let e=255;e<512;e++)P0e[e]=P0e[e-255]}(),D0e.log=function(e){if(e<1)throw new Error("log("+e+")");return j0e[e]},D0e.exp=function(e){return P0e[e]},D0e.mul=function(e,t){return 0===e||0===t?0:P0e[j0e[e]+j0e[t]]},function(e){const t=D0e;e.mul=function(e,r){const n=new Uint8Array(e.length+r.length-1);for(let i=0;i<e.length;i++)for(let o=0;o<r.length;o++)n[i+o]^=t.mul(e[i],r[o]);return n},e.mod=function(e,r){let n=new Uint8Array(e);for(;n.length-r.length>=0;){const e=n[0];for(let i=0;i<r.length;i++)n[i]^=t.mul(r[i],e);let i=0;for(;i<n.length&&0===n[i];)i++;n=n.slice(i)}return n},e.generateECPolynomial=function(r){let n=new Uint8Array([1]);for(let i=0;i<r;i++)n=e.mul(n,new Uint8Array([1,t.exp(i)]));return n}}(N0e);const F0e=N0e;function V0e(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}V0e.prototype.initialize=function(e){this.degree=e,this.genPoly=F0e.generateECPolynomial(this.degree)},V0e.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const r=F0e.mod(t,this.genPoly),n=this.degree-r.length;if(n>0){const e=new Uint8Array(this.degree);return e.set(r,n),e}return r};var L0e=V0e,$0e={},B0e={},U0e={isValid:function(e){return!isNaN(e)&&e>=1&&e<=40}},z0e={};const H0e="[0-9]+";let W0e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";W0e=W0e.replace(/u/g,"\\u");const G0e="(?:(?![A-Z0-9 $%*+\\-./:]|"+W0e+")(?:.|[\r\n]))+";z0e.KANJI=new RegExp(W0e,"g"),z0e.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),z0e.BYTE=new RegExp(G0e,"g"),z0e.NUMERIC=new RegExp(H0e,"g"),z0e.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const K0e=new RegExp("^"+W0e+"$"),q0e=new RegExp("^"+H0e+"$"),Y0e=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");z0e.testKanji=function(e){return K0e.test(e)},z0e.testNumeric=function(e){return q0e.test(e)},z0e.testAlphanumeric=function(e){return Y0e.test(e)},function(e){const t=U0e,r=z0e;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(e,r){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!t.isValid(r))throw new Error("Invalid version: "+r);return r>=1&&r<10?e.ccBits[0]:r<27?e.ccBits[1]:e.ccBits[2]},e.getBestModeForData=function(t){return r.testNumeric(t)?e.NUMERIC:r.testAlphanumeric(t)?e.ALPHANUMERIC:r.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},e.isValid=function(e){return e&&e.bit&&e.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch{return r}}}(B0e),function(e){const t=v0e,r=R0e,n=_0e,i=B0e,o=U0e,a=t.getBCHDigit(7973);function s(e,t){return i.getCharCountIndicator(e,t)+4}function l(e,t){let r=0;return e.forEach((function(e){const n=s(e.mode,t);r+=n+e.getBitsLength()})),r}e.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},e.getCapacity=function(e,n,a){if(!o.isValid(e))throw new Error("Invalid QR Code version");typeof a>"u"&&(a=i.BYTE);const l=8*(t.getSymbolTotalCodewords(e)-r.getTotalCodewordsCount(e,n));if(a===i.MIXED)return l;const c=l-s(a,e);switch(a){case i.NUMERIC:return Math.floor(c/10*3);case i.ALPHANUMERIC:return Math.floor(c/11*2);case i.KANJI:return Math.floor(c/13);case i.BYTE:default:return Math.floor(c/8)}},e.getBestVersionForData=function(t,r){let o;const a=n.from(r,n.M);if(Array.isArray(t)){if(t.length>1)return function(t,r){for(let n=1;n<=40;n++)if(l(t,n)<=e.getCapacity(n,r,i.MIXED))return n}(t,a);if(0===t.length)return 1;o=t[0]}else o=t;return function(t,r,n){for(let i=1;i<=40;i++)if(r<=e.getCapacity(i,n,t))return i}(o.mode,o.getLength(),a)},e.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw new Error("Invalid QR Code version");let r=e<<12;for(;t.getBCHDigit(r)-a>=0;)r^=7973<<t.getBCHDigit(r)-a;return e<<12|r}}($0e);var J0e={};const X0e=v0e,Z0e=X0e.getBCHDigit(1335);J0e.getEncodedBits=function(e,t){const r=e.bit<<3|t;let n=r<<10;for(;X0e.getBCHDigit(n)-Z0e>=0;)n^=1335<<X0e.getBCHDigit(n)-Z0e;return 21522^(r<<10|n)};var Q0e={};const e1e=B0e;function t1e(e){this.mode=e1e.NUMERIC,this.data=e.toString()}t1e.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},t1e.prototype.getLength=function(){return this.data.length},t1e.prototype.getBitsLength=function(){return t1e.getBitsLength(this.data.length)},t1e.prototype.write=function(e){let t,r,n;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),n=parseInt(r,10),e.put(n,10);const i=this.data.length-t;i>0&&(r=this.data.substr(t),n=parseInt(r,10),e.put(n,3*i+1))};var r1e=t1e;const n1e=B0e,i1e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function o1e(e){this.mode=n1e.ALPHANUMERIC,this.data=e}o1e.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},o1e.prototype.getLength=function(){return this.data.length},o1e.prototype.getBitsLength=function(){return o1e.getBitsLength(this.data.length)},o1e.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=45*i1e.indexOf(this.data[t]);r+=i1e.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(i1e.indexOf(this.data[t]),6)};var a1e=o1e;const s1e=function(e){for(var t=[],r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&r>n+1){var o=e.charCodeAt(n+1);o>=56320&&o<=57343&&(i=1024*(i-55296)+o-56320+65536,n+=1)}i<128?t.push(i):i<2048?(t.push(i>>6|192),t.push(63&i|128)):i<55296||i>=57344&&i<65536?(t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128)):i>=65536&&i<=1114111?(t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128)):t.push(239,191,189)}return new Uint8Array(t).buffer},l1e=B0e;function c1e(e){this.mode=l1e.BYTE,"string"==typeof e&&(e=s1e(e)),this.data=new Uint8Array(e)}c1e.getBitsLength=function(e){return 8*e},c1e.prototype.getLength=function(){return this.data.length},c1e.prototype.getBitsLength=function(){return c1e.getBitsLength(this.data.length)},c1e.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var u1e=c1e;const d1e=B0e,f1e=v0e;function h1e(e){this.mode=d1e.KANJI,this.data=e}h1e.getBitsLength=function(e){return 13*e},h1e.prototype.getLength=function(){return this.data.length},h1e.prototype.getBitsLength=function(){return h1e.getBitsLength(this.data.length)},h1e.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=f1e.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),e.put(r,13)}};var p1e=h1e,g1e={exports:{}};!function(e){var t={single_source_shortest_paths:function(e,r,n){var i={},o={};o[r]=0;var a,s,l,c,u,d,f,h=t.PriorityQueue.make();for(h.push(r,0);!h.empty();)for(l in s=(a=h.pop()).value,c=a.cost,u=e[s]||{})u.hasOwnProperty(l)&&(d=c+u[l],f=o[l],(typeof o[l]>"u"||f>d)&&(o[l]=d,h.push(l,d),i[l]=s));if(typeof n<"u"&&typeof o[n]>"u"){var p=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(p)}return i},extract_shortest_path_from_predecessor_list:function(e,t){for(var r=[],n=t;n;)r.push(n),e[n],n=e[n];return r.reverse(),r},find_path:function(e,r,n){var i=t.single_source_shortest_paths(e,r,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(e){var r,n=t.PriorityQueue,i={};for(r in e=e||{},n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.queue=[],i.sorter=e.sorter||n.default_sorter,i},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var r={value:e,cost:t};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t}(g1e),function(e){const t=B0e,r=r1e,n=a1e,i=u1e,o=p1e,a=z0e,s=v0e,l=g1e.exports;function c(e){return unescape(encodeURIComponent(e)).length}function u(e,t,r){const n=[];let i;for(;null!==(i=e.exec(r));)n.push({data:i[0],index:i.index,mode:t,length:i[0].length});return n}function d(e){const r=u(a.NUMERIC,t.NUMERIC,e),n=u(a.ALPHANUMERIC,t.ALPHANUMERIC,e);let i,o;return s.isKanjiModeEnabled()?(i=u(a.BYTE,t.BYTE,e),o=u(a.KANJI,t.KANJI,e)):(i=u(a.BYTE_KANJI,t.BYTE,e),o=[]),r.concat(n,i,o).sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function f(e,a){switch(a){case t.NUMERIC:return r.getBitsLength(e);case t.ALPHANUMERIC:return n.getBitsLength(e);case t.KANJI:return o.getBitsLength(e);case t.BYTE:return i.getBitsLength(e)}}function h(e,a){let l;const c=t.getBestModeForData(e);if(l=t.from(a,c),l!==t.BYTE&&l.bit<c.bit)throw new Error('"'+e+'" cannot be encoded with mode '+t.toString(l)+".\n Suggested mode is: "+t.toString(c));switch(l===t.KANJI&&!s.isKanjiModeEnabled()&&(l=t.BYTE),l){case t.NUMERIC:return new r(e);case t.ALPHANUMERIC:return new n(e);case t.KANJI:return new o(e);case t.BYTE:return new i(e)}}e.fromArray=function(e){return e.reduce((function(e,t){return"string"==typeof t?e.push(h(t,null)):t.data&&e.push(h(t.data,t.mode)),e}),[])},e.fromString=function(r,n){const i=function(e){const r=[];for(let n=0;n<e.length;n++){const i=e[n];switch(i.mode){case t.NUMERIC:r.push([i,{data:i.data,mode:t.ALPHANUMERIC,length:i.length},{data:i.data,mode:t.BYTE,length:i.length}]);break;case t.ALPHANUMERIC:r.push([i,{data:i.data,mode:t.BYTE,length:i.length}]);break;case t.KANJI:r.push([i,{data:i.data,mode:t.BYTE,length:c(i.data)}]);break;case t.BYTE:r.push([{data:i.data,mode:t.BYTE,length:c(i.data)}])}}return r}(d(r,s.isKanjiModeEnabled())),o=function(e,r){const n={},i={start:{}};let o=["start"];for(let a=0;a<e.length;a++){const s=e[a],l=[];for(let e=0;e<s.length;e++){const c=s[e],u=""+a+e;l.push(u),n[u]={node:c,lastCount:0},i[u]={};for(let e=0;e<o.length;e++){const a=o[e];n[a]&&n[a].node.mode===c.mode?(i[a][u]=f(n[a].lastCount+c.length,c.mode)-f(n[a].lastCount,c.mode),n[a].lastCount+=c.length):(n[a]&&(n[a].lastCount=c.length),i[a][u]=f(c.length,c.mode)+4+t.getCharCountIndicator(c.mode,r))}}o=l}for(let e=0;e<o.length;e++)i[o[e]].end=0;return{map:i,table:n}}(i,n),a=l.find_path(o.map,"start","end"),u=[];for(let e=1;e<a.length-1;e++)u.push(o.table[a[e]].node);return e.fromArray(u.reduce((function(e,t){const r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[]))},e.rawSplit=function(t){return e.fromArray(d(t,s.isKanjiModeEnabled()))}}(Q0e);const m1e=v0e,v1e=_0e,y1e=C0e,b1e=S0e,_1e=k0e,w1e=x0e,C1e=I0e,E1e=R0e,S1e=L0e,k1e=$0e,x1e=J0e,O1e=B0e,I1e=Q0e;function R1e(e,t,r){const n=e.size,i=x1e.getEncodedBits(t,r);let o,a;for(o=0;o<15;o++)a=1==(i>>o&1),o<6?e.set(o,8,a,!0):o<8?e.set(o+1,8,a,!0):e.set(n-15+o,8,a,!0),o<8?e.set(8,n-o-1,a,!0):o<9?e.set(8,15-o-1+1,a,!0):e.set(8,15-o-1,a,!0);e.set(n-8,8,1,!0)}function T1e(e,t,r){const n=new y1e;r.forEach((function(t){n.put(t.mode.bit,4),n.put(t.getLength(),O1e.getCharCountIndicator(t.mode,e)),t.write(n)}));const i=8*(m1e.getSymbolTotalCodewords(e)-E1e.getTotalCodewordsCount(e,t));for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);const o=(i-n.getLengthInBits())/8;for(let e=0;e<o;e++)n.put(e%2?17:236,8);return function(e,t,r){const n=m1e.getSymbolTotalCodewords(t),i=E1e.getTotalCodewordsCount(t,r),o=n-i,a=E1e.getBlocksCount(t,r),s=n%a,l=a-s,c=Math.floor(n/a),u=Math.floor(o/a),d=u+1,f=c-u,h=new S1e(f);let p=0;const g=new Array(a),m=new Array(a);let v=0;const y=new Uint8Array(e.buffer);for(let e=0;e<a;e++){const t=e<l?u:d;g[e]=y.slice(p,p+t),m[e]=h.encode(g[e]),p+=t,v=Math.max(v,t)}const b=new Uint8Array(n);let _,w,C=0;for(_=0;_<v;_++)for(w=0;w<a;w++)_<g[w].length&&(b[C++]=g[w][_]);for(_=0;_<f;_++)for(w=0;w<a;w++)b[C++]=m[w][_];return b}(n,e,t)}function A1e(e,t,r,n){let i;if(Array.isArray(e))i=I1e.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let n=t;if(!n){const t=I1e.rawSplit(e);n=k1e.getBestVersionForData(t,r)}i=I1e.fromString(e,n||40)}}const o=k1e.getBestVersionForData(i,r);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<o)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+o+".\n")}else t=o;const a=T1e(t,r,i),s=m1e.getSymbolSize(t),l=new b1e(s);return function(e,t){const r=e.size,n=w1e.getPositions(t);for(let t=0;t<n.length;t++){const i=n[t][0],o=n[t][1];for(let t=-1;t<=7;t++)if(!(i+t<=-1||r<=i+t))for(let n=-1;n<=7;n++)o+n<=-1||r<=o+n||(t>=0&&t<=6&&(0===n||6===n)||n>=0&&n<=6&&(0===t||6===t)||t>=2&&t<=4&&n>=2&&n<=4?e.set(i+t,o+n,!0,!0):e.set(i+t,o+n,!1,!0))}}(l,t),function(e){const t=e.size;for(let r=8;r<t-8;r++){const t=r%2==0;e.set(r,6,t,!0),e.set(6,r,t,!0)}}(l),function(e,t){const r=_1e.getPositions(t);for(let t=0;t<r.length;t++){const n=r[t][0],i=r[t][1];for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)-2===t||2===t||-2===r||2===r||0===t&&0===r?e.set(n+t,i+r,!0,!0):e.set(n+t,i+r,!1,!0)}}(l,t),R1e(l,r,0),t>=7&&function(e,t){const r=e.size,n=k1e.getEncodedBits(t);let i,o,a;for(let t=0;t<18;t++)i=Math.floor(t/3),o=t%3+r-8-3,a=1==(n>>t&1),e.set(i,o,a,!0),e.set(o,i,a,!0)}(l,t),function(e,t){const r=e.size;let n=-1,i=r-1,o=7,a=0;for(let s=r-1;s>0;s-=2)for(6===s&&s--;;){for(let r=0;r<2;r++)if(!e.isReserved(i,s-r)){let n=!1;a<t.length&&(n=1==(t[a]>>>o&1)),e.set(i,s-r,n),o--,-1===o&&(a++,o=7)}if(i+=n,i<0||r<=i){i-=n,n=-n;break}}}(l,a),isNaN(n)&&(n=C1e.getBestMask(l,R1e.bind(null,l,r))),C1e.applyMask(n,l),R1e(l,r,n),{modules:l,version:t,errorCorrectionLevel:r,maskPattern:n,segments:i}}m0e.create=function(e,t){if(typeof e>"u"||""===e)throw new Error("No input text");let r,n,i=v1e.M;return typeof t<"u"&&(i=v1e.from(t.errorCorrectionLevel,v1e.M),r=k1e.from(t.version),n=C1e.from(t.maskPattern),t.toSJISFunc&&m1e.setToSJISFunction(t.toSJISFunc)),A1e(e,r,i,n)};var M1e={},N1e={};!function(e){function t(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");const r=parseInt(t.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+t.slice(0,6).join("")}}e.getOptions=function(e){e||(e={}),e.color||(e.color={});const r=typeof e.margin>"u"||null===e.margin||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:n,scale:n?4:i,margin:r,color:{dark:t(e.color.dark||"#000000ff"),light:t(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},e.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},e.getImageWidth=function(t,r){const n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){const i=r.modules.size,o=r.modules.data,a=e.getScale(i,n),s=Math.floor((i+2*n.margin)*a),l=n.margin*a,c=[n.color.light,n.color.dark];for(let e=0;e<s;e++)for(let r=0;r<s;r++){let u=4*(e*s+r),d=n.color.light;if(e>=l&&r>=l&&e<s-l&&r<s-l){d=c[o[Math.floor((e-l)/a)*i+Math.floor((r-l)/a)]?1:0]}t[u++]=d.r,t[u++]=d.g,t[u++]=d.b,t[u]=d.a}}}(N1e),function(e){const t=N1e;e.render=function(e,r,n){let i=n,o=r;typeof i>"u"&&(!r||!r.getContext)&&(i=r,r=void 0),r||(o=function(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),i=t.getOptions(i);const a=t.getImageWidth(e.modules.size,i),s=o.getContext("2d"),l=s.createImageData(a,a);return t.qrToImageData(l.data,e,i),function(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}(s,o,a),s.putImageData(l,0,0),o},e.renderToDataURL=function(t,r,n){let i=n;typeof i>"u"&&(!r||!r.getContext)&&(i=r,r=void 0),i||(i={});const o=e.render(t,r,i),a=i.type||"image/png",s=i.rendererOpts||{};return o.toDataURL(a,s.quality)}}(M1e);var D1e={};const P1e=N1e;function j1e(e,t){const r=e.a/255,n=t+'="'+e.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function F1e(e,t,r){let n=e+t;return typeof r<"u"&&(n+=" "+r),n}D1e.render=function(e,t,r){const n=P1e.getOptions(t),i=e.modules.size,o=e.modules.data,a=i+2*n.margin,s=n.color.light.a?"<path "+j1e(n.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",l="<path "+j1e(n.color.dark,"stroke")+' d="'+function(e,t,r){let n="",i=0,o=!1,a=0;for(let s=0;s<e.length;s++){const l=Math.floor(s%t),c=Math.floor(s/t);!l&&!o&&(o=!0),e[s]?(a++,s>0&&l>0&&e[s-1]||(n+=o?F1e("M",l+r,.5+c+r):F1e("m",i,0),i=0,o=!1),l+1<t&&e[s+1]||(n+=F1e("h",a),a=0)):i++}return n}(o,i,n.margin)+'"/>',c='viewBox="0 0 '+a+" "+a+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+c+' shape-rendering="crispEdges">'+s+l+"</svg>\n";return"function"==typeof r&&r(null,u),u};const V1e=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},L1e=m0e,$1e=M1e,B1e=D1e;function U1e(e,t,r,n,i){const o=[].slice.call(arguments,1),a=o.length,s="function"==typeof o[a-1];if(!s&&!V1e())throw new Error("Callback required as last argument");if(!s){if(a<1)throw new Error("Too few arguments provided");return 1===a?(r=t,t=n=void 0):2===a&&!t.getContext&&(n=r,r=t,t=void 0),new Promise((function(i,o){try{const o=L1e.create(r,n);i(e(o,t,n))}catch(e){o(e)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(i=r,r=t,t=n=void 0):3===a&&(t.getContext&&typeof i>"u"?(i=n,n=void 0):(i=n,n=r,r=t,t=void 0));try{const o=L1e.create(r,n);i(null,e(o,t,n))}catch(e){i(e)}}g0e.create=L1e.create,g0e.toCanvas=U1e.bind(null,$1e.render),g0e.toDataURL=U1e.bind(null,$1e.renderToDataURL),g0e.toString=U1e.bind(null,(function(e,t,r){return B1e.render(e,r)}));var z1e=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}},H1e={"text/plain":"Text","text/html":"Url",default:"Text"};var W1e=function(e,t){var r,n,i,o,a,s,l=!1;t||(t={}),r=t.debug||!1;try{if(i=z1e(),o=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=e,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),typeof n.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=H1e[t.format]||H1e.default;window.clipboardData.setData(i,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(s),o.selectNodeContents(s),a.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(i){r&&console.error("unable to copy using execCommand: ",i),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(i){r&&console.error("unable to copy using clipboardData: ",i),r&&console.error("falling back to prompt"),n=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(n,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(o):a.removeAllRanges()),s&&document.body.removeChild(s),i()}return l};const G1e=e=>{const{state:t,shareUrl:r,copyLink:n,canUpdate:i,onDisable:o}=(e=>{var t;const r=X9(aR.TABLE).canUpdate(),n=HL(f0e),i=null==(t=null==n?void 0:n.getShare(e.form.get("uuid")))?void 0:t.get("src"),[o,s]=Object(a.useState)(),l=`${location.origin}${i}`;return Object(a.useEffect)((()=>{g0e.toDataURL(l,{margin:0},((e,t)=>{s(t)}))}),[]),{state:{qrcode:o},shareUrl:l,copyLink:e=>{e.preventDefault(),W1e(l),m.a.success({content:Ph("复制成功"),style:{zIndex:1050}})},canUpdate:r,onDisable(){var t;null==(t=e.onDisable)||t.call(e)}}})(e);return s.a.createElement("div",{className:"lakex-table-form-share-link"},i?s.a.createElement("div",{className:"lakex-table-form-share-link-title"},s.a.createElement("div",null,Ph("获得链接的所有人，可填写并提交表单")),s.a.createElement("span",{className:"lakex-table-form-share-link-unlink"},Ph("停止收集"),s.a.createElement(k.a,{defaultChecked:!0,onChange:o}))):null,s.a.createElement("div",{className:"lakex-table-form-share-link-content"},s.a.createElement(b.a.Group,null,s.a.createElement(u.a,{value:r,disabled:!0,className:"lakex-table-form-share-link-input"}),s.a.createElement(b.a,{type:"primary",onClick:n,className:"lakex-table-form-share-link-btn"},Ph("复制填写链接"))),s.a.createElement("div",{className:"lakex-table-form-share-link-qrcode"},t.qrcode?s.a.createElement("img",{src:t.qrcode}):s.a.createElement("span",null),s.a.createElement("span",null,Ph("使用钉钉扫码$1",Ph(i?"分享":"打开"))))))},K1e=e=>s.a.createElement("div",{className:"lakex-table-form-enabled-centered"},s.a.createElement(G1e,{form:e.form,onDisable:e.onDisable})),q1e=()=>{const{form:e,onDisable:t,isEnableManage:r}=(()=>{const e=Z9(),t=HL(Uze),r=HL(f0e),[n]=Object(a.useState)(null==t?void 0:t.getForm(e.get("uuid")));return{form:n,onDisable(){r.disableForm(e.get("uuid"))},isEnableManage:r.isEnableManage()}})();return s.a.createElement("div",{className:"lakex-table-form-modal"},s.a.createElement("div",{className:"lakex-table-form-model-content"},r&&s.a.createElement(K1e,{form:e,onDisable:t})))},Y1e=({onEnable:e})=>s.a.createElement("div",{className:"lakex-table-form-disabled-centered"},s.a.createElement(oz,{src:"https://gw.alipayobjects.com/mdn/rms_740edc/afts/img/A*5bdXSJkjvI0AAAAAAAAAAAAAARQnAQ",darkSrc:"https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*eBesTrDkSP8AAAAAAAAAAAAAARQnAQ"}),s.a.createElement("div",{className:"lakex-table-form-disabled-title"},Ph("表单收集未开启")),s.a.createElement("p",{className:"lakex-table-form-disabled-desc"},Ph("点击「开启收集」按钮获得表单填写链接")),s.a.createElement("div",{className:"lakex-table-form-disabled-button"},s.a.createElement(b.a,{onClick:e,type:"primary"},Ph("开启收集")))),J1e=()=>{const{form:e,onEnable:t,isEnableManage:r}=(()=>{const e=Z9(),t=HL(Uze),r=HL(f0e),[n]=Object(a.useState)(null==t?void 0:t.getForm(e.get("uuid")));return{form:n,onEnable(){r.enableForm(e.get("uuid"))},isEnableManage:r.isEnableManage()}})();return s.a.createElement("div",{className:"lakex-table-form-modal"},s.a.createElement("div",{className:"lakex-table-form-model-content"},r&&s.a.createElement(Y1e,{form:e,onEnable:t})))};var X1e=Object.defineProperty,Z1e=Object.getOwnPropertyDescriptor,Q1e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?Z1e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&X1e(t,r,o),o};let e2e=class{constructor(){this._toDestroyCollection=new gp}static pluginModule(){return xo().contribution(i0e).register(this).register(f0e).register(l0e)}static registerConfiguration(e){e.registerConfiguration({id:"form",type:"object",properties:{manage:{type:"object",properties:{disable:{type:"boolean"}}}}})}init(){this._toDestroyCollection.push(this._renderService.onClickEvent((e=>{if("clickFormManageButton"===e.eventName){const t=e.data.target,r=e.data.status,n={origin:t,placement:"bottomRight"};if(this._viewerFormManageService.setModalPosition(n),r!==Nze.COLLECTING)return void this._modalService.open("form-disabled-modal",{position:n});this._modalService.open("form-enabled-modal",{position:n})}})))}destroy(){this._toDestroyCollection.destroy()}registerModal(e){e.registerItem({id:"form-create-modal",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:p0e}),e.registerItem({id:"form-enabled-modal",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:q1e}),e.registerItem({id:"form-disabled-modal",hasMask:!1,scrollStrategy:"block",zIndex:"modalFromToolbar",RenderComponent:J1e})}};e2e.pluginName="workbench-viewer-form-manage",Q1e([ao(Qz)],e2e.prototype,"_renderService",2),Q1e([ao(c8)],e2e.prototype,"_modalService",2),Q1e([ao(f0e)],e2e.prototype,"_viewerFormManageService",2),e2e=Q1e([io({contrib:[jL,j4,u8]})],e2e);var t2e=Object.defineProperty,r2e=Object.getOwnPropertyDescriptor,n2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?r2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&t2e(t,r,o),o};let i2e=class{static pluginModule(){return xo().register(this)}init(){this._renderService.onClickEvent((e=>{var t;if("fieldConfigClick"===e.eventName){const r=e.data,n=r.e,i=r.viewField;this._modalService.open("addOrUpdateField",{position:{origin:n.target,placement:"bottom"},initialState:{fieldId:i.get("field_uuid"),showFieldTypes:null==(t=_E)?void 0:t.filter((e=>{var t;return!(zE.isSystemType(e.type)||e.type===(null==(t=i.get("field"))?void 0:t.get("type")))})).map((e=>e.type))}})}}))}destroy(){}};i2e.pluginName="workbench-viewer-form",n2e([ao(c8)],i2e.prototype,"_modalService",2),n2e([ao(Qz)],i2e.prototype,"_renderService",2),i2e=n2e([io({contrib:[jL]})],i2e);var o2e=Object.defineProperty,a2e=Object.getOwnPropertyDescriptor,s2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?a2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&o2e(t,r,o),o};let l2e=class{static pluginModule(){return xo().register(this).register(sze)}init(){}registerToolbar(e){e.registerItem({id:"full-screen",icon:"Fullscreen",tooltip:Ph("全屏"),visible:()=>{var e;return!((null==(e=this._readService.getActiveView())?void 0:e.get("type"))===LE.FORM)&&this._fullScreenService.status!==nze.FULL_SCREEN},onClick:()=>{this._fullScreenService.emitStatusChange()}})}};l2e.pluginName="workbench-full-screen",s2e([ao(KO)],l2e.prototype,"_readService",2),s2e([ao(sze)],l2e.prototype,"_fullScreenService",2),l2e=s2e([io({contrib:[jL,j4]})],l2e);const c2e=()=>{var e;const t=HL(hze),r=HL(KO),[n,i]=Object(a.useState)(t.cardWidthMode),o=n===lze.NORMAL,l=(null==(e=r.getActiveView())?void 0:e.get("type"))===LE.CARD;return Object(a.useEffect)((()=>{const e=t.onModeUIChange((e=>{i(e)}));return()=>{null==e||e.destroy()}}),[t]),l?s.a.createElement(p.a,{title:Ph(o?"全宽":"标宽")},s.a.createElement("button",{className:"lakex-workbench-toolbar-button",onClick:()=>{const e=n===lze.NORMAL?lze.CONTAIN:lze.NORMAL;i(e),null==t||t.setWidthMode(e)},tabIndex:-1},s.a.createElement(XU,{type:o?"FullWidth":"NormalWidth"}))):null};var u2e=Object.defineProperty,d2e=Object.getOwnPropertyDescriptor;let f2e=class{static pluginModule(){return xo().register(this).register(hze)}init(){}destroy(){}registerToolbar(e){e.registerItem({id:"full-width",RenderComponent:c2e})}};f2e.pluginName="workbench-full-width",f2e=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?d2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&u2e(t,r,o),o})([io({contrib:[jL,j4]})],f2e);const h2e=({originField:e,fieldType:t,onFieldSubmitConfirm:r})=>{var n;const i=!e,o=e&&e.get("type")!==pE.TEXT,a=i?To(32):e.get("uuid"),l=HL(c8),c=HL(lp),u=HL(DJe).getAiWritingConfig(a),f=(null==u?void 0:u.open)?null==(n=WJe.find((e=>e.uuid===(null==u?void 0:u.type))))?void 0:n.name:Ph("关闭"),h=!!c.getValue("aiWriting.enable");return t===pE.TEXT&&h?s.a.createElement(d.a,{className:"lakex-table-ai-writing-config"},s.a.createElement(d.a.Item,{className:"lakex-table-ai-writing-config-item",onClick:()=>{const e=l.getModalProps("addOrUpdateField");null==l||l.open("ai-writing-config-modal",{initialState:{fieldId:a,isCreateNewCol:i,isChangedFieldType:o,onFieldSubmitConfirm:r},position:e.position}),null==l||l.close("addOrUpdateField")}},s.a.createElement($t.default,{className:"tag",width:14,height:14}),Ph("AI 智能填写"),s.a.createElement("div",{className:"right"},s.a.createElement("span",{className:"status"},f),s.a.createElement(XU,{type:"ArrowRight",size:14})))):null};var p2e={exports:{}};!function(e){!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i)){if(i.length){var a=r.apply(null,i);a&&e.push(a)}}else if("object"===o){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var s in i)t.call(i,s)&&i[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()}(p2e);const g2e=p2e.exports,m2e=({initialState:e})=>{const{fieldId:t,isCreateNewCol:r,isChangedFieldType:n,onFieldSubmitConfirm:i}=e,[o,l]=Object(a.useState)(!1),c=HL(c8),f=HL(zI),h=HL(DJe),p=h.getAiWritingConfig(t),[g,v]=Object(a.useState)((null==p?void 0:p.open)||!1),[y,w]=Object(a.useState)((null==p?void 0:p.type)||NJe.SUMMARY),[C,E]=Object(a.useState)((null==p?void 0:p.prompt)||""),[S,x]=Object(a.useState)((null==p?void 0:p.auto)||!1),O=Object(a.useMemo)((()=>WJe.find((e=>e.uuid===y))||WJe[0]),[y]),I=Object(a.useCallback)((()=>{const e=c.getModalProps("ai-writing-config-modal");null==c||c.open("addOrUpdateField",{initialState:{fieldId:t},position:e.position}),c.close("ai-writing-config-modal")}),[c]),R=Object(a.useCallback)((e=>{v(e),f.execCommand("updateAiWritingOpen",{fieldId:t,open:e})}),[f,t]),T=Object(a.useCallback)((e=>{w(e),f.execCommand("updateAiWritingType",{fieldId:t,type:e})}),[f,t,g]),A=Object(a.useCallback)((e=>{const t=e.target.value.trim();t.length>255?m.a.error(Ph("规则最长支持255字符")):E(t)}),[]);Object(a.useCallback)((e=>{x(e),f.execCommand("updateAiWritingAuto",{fieldId:t,auto:e})}),[f,t]);const M=Object(a.useCallback)((async()=>{y===NJe.SUMMARY||C?(r?await i(t):n&&await i(),await f.execCommand("updateAiWritingPrompt",{fieldId:t,prompt:C}),l(!0),await h.startAiWriting(t),null==c||c.close("ai-writing-config-modal"),m.a.success(Ph("正在填写中..."))):m.a.error(Ph("规则不能为空"))}),[c,f,t,y,C,r,n]),N=Object(a.useCallback)((()=>{null==c||c.close("ai-writing-config-modal")}),[c]);return s.a.createElement("div",{className:g2e("lakex-table-ai-writing-config-modal",{disabled:!g})},s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-header"},s.a.createElement("div",{className:"left",onClick:I},s.a.createElement(B.default,{className:"lakex-table-ai-writing-config-modal-back",width:16,height:16}),Ph("智能填写"),s.a.createElement(Ft.default,{className:"tag",width:16,height:16})),s.a.createElement("div",{className:"right"},s.a.createElement(k.a,{size:"small",checked:g,onChange:R}))),s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-content"},s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-type"},s.a.createElement("span",null,Ph("内容规则：")),s.a.createElement(_.a,{trigger:["click"],placement:"bottomRight",disabled:!g,overlay:s.a.createElement(d.a,{className:"lakex-table-ai-writing-config-menu",mode:"vertical",selectedKeys:[`${y}`]},WJe.map(((e,t)=>s.a.createElement(d.a.Item,{key:t,onClick:()=>{T(e.uuid)}},e.name,s.a.createElement(Bt.default,{width:16,height:16,style:{display:y===e.uuid?"inline":"none"}})))))},s.a.createElement("span",{className:g2e("lakex-table-ai-writing-config-modal-select",{disabled:!g})},O.name,s.a.createElement(V.default,{width:14,height:14,style:{marginLeft:"4px"}})))),y===NJe.SUMMARY?s.a.createElement(u.a.TextArea,{disabled:!0,defaultValue:"",autoSize:{minRows:1},placeholder:O.placeholder}):s.a.createElement(u.a.TextArea,{disabled:!g,defaultValue:"",value:C,autoSize:{minRows:3},placeholder:O.placeholder,onChange:A})),s.a.createElement("div",{className:"lakex-table-ai-writing-config-modal-footer"},s.a.createElement("div",{className:"lakex-table-ai-writing-config-buttons"},s.a.createElement(b.a,{className:"lakex-table-ai-writing-config-cancel",disabled:!g,onClick:N},Ph("取消")),s.a.createElement(b.a,{className:"lakex-table-ai-writing-config-start",disabled:!g,onClick:M,type:"primary"},Ph("开始自动填写"),o&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon",width:16,height:16})))))},v2e=({initialState:e})=>{const{fieldId:t,recordId:r}=e,[n,i]=Object(a.useState)(!1),o=HL(DJe),l=Object(a.useCallback)((async()=>{i(!0),await o.startAiWriting(t,r),i(!1),m.a.success(Ph("已重新填写"))}),[t,r]);return s.a.createElement("div",{className:"lakex-table-aotufill-cell-modal",onClick:l},s.a.createElement($t.default,{width:16,height:16,style:{marginRight:"6px"}}),Ph("重新填写"),n&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon",width:16,height:16}))},y2e=({fieldType:e,fieldName:t})=>{const r=HL(lp);return(null==r?void 0:r.getValue("aiWriting.enable"))&&e===pE.TEXT?s.a.createElement("span",null,t,s.a.createElement(Ft.default,{className:"lakex-table-grid-header-ai-writing-icon",width:14,height:14})):s.a.createElement(s.a.Fragment,null,t)},b2e=({cell:e,field:t,children:r})=>{const n=HL(lp),i=(null==n?void 0:n.getValue("aiWriting.enable"))||!1,o=HL(DJe),l=o.getAiWritingConfig(t.uuid),[c,u]=Object(a.useState)(!1),d=Object(a.useCallback)((async()=>{u(!0),await o.startAiWriting(e.fieldId,e.recordId),u(!1),m.a.success(Ph("已重新填写"))}),[]);return i&&(null==l?void 0:l.open)?s.a.createElement(f.a,{overlayClassName:"lakex-table-expand-record-ai-writing-popover",content:s.a.createElement("div",{className:"content",onClick:d},s.a.createElement($t.default,{width:16,height:16,style:{marginRight:"6px"}}),Ph("重新填写"),c&&s.a.createElement(Vt.default,{className:"lakex-table-ai-writing-loading-icon",width:16,height:16})),placement:"topRight",noArrow:!0,hideWhenInactive:!0},s.a.createElement("div",null,r)):s.a.createElement(s.a.Fragment,null,r)};var _2e=Object.defineProperty,w2e=Object.getOwnPropertyDescriptor,C2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?w2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&_2e(t,r,o),o};let E2e=class{constructor(){this._modalId="ai-writing-autofill-cell",this._toDestroyCollection=new gp}static pluginModule(){return xo().register(this)}static registerConfiguration(e){e.registerConfiguration({id:"aiWriting",type:"object",properties:{enable:{type:"boolean",description:"是否允许使用文本 AI 助手"}}}),e.registerDefaultValue({"aiWriting.enable":!1})}get isGridView(){var e;return(null==(e=this._readService.getActiveView())?void 0:e.get("type"))===LE.GRID}get isReadonly(){return this._abilityService.isReadonly(aR.TABLE)}get isAiWritingEnable(){return!!this._configurationService.getValue("aiWriting.enable")}showAutofill(){var e;if(!this.isGridView)return;const t=this._selectionService.hasSelection(),r=this._selectionService.isSelectOneCell(),n=this._selectionService.getFieldValue(),i=null==(e=this._aiWritingService.getAiWritingConfig((null==n?void 0:n.fieldId)||""))?void 0:e.open;if(t&&r&&i){const e=this._renderContext.$root.querySelector(`.lakex-viewer-grid-cell[data-field-uuid="${null==n?void 0:n.fieldId}"][data-record-uuid="${null==n?void 0:n.recordId}"]`);e&&this._modalService.open(this._modalId,{position:{origin:e,placement:"top"},initialState:{fieldId:null==n?void 0:n.fieldId,recordId:null==n?void 0:n.recordId}})}else this._modalService.close(this._modalId)}init(){var e;if(this.isReadonly||!this.isAiWritingEnable||!this._selectionService)return;const t=this._selectionService.onChange((()=>{this.showAutofill()})),r=null==(e=this._gridCellEditService)?void 0:e.onEditingChange((({editing:e})=>{e?this._modalService.close(this._modalId):this.showAutofill()}));t&&this._toDestroyCollection.push(t),r&&this._toDestroyCollection.push(r)}destroy(){this._toDestroyCollection.destroy()}getConfigComponent(){return h2e}getColConfigNameComponent(){return y2e}registerContextMenu(e){e.registerItem({key:"autofillField",name:Ph("重新填写本列内容"),icon:()=>s.a.createElement($t.default,{width:16,height:16}),hotkey:"",visible:({from:e,fieldId:t})=>{var r;const n=null==(r=this._aiWritingService.getAiWritingConfig(t||""))?void 0:r.open;return!this.isReadonly&&e===Xue.HEADER&&this.isAiWritingEnable&&!!n},onClick:async({initialState:e,position:t})=>{const{fieldId:r}=e;!t||(this._modalService.close("context-menu-modal"),await this._aiWritingService.startAiWriting(r||""),m.a.success(Ph("正在填写中...")))}})}registerModal(e){e.registerItem({id:"ai-writing-config-modal",hasMask:!1,scrollStrategy:"block",zIndex:"expandRecord",RenderComponent:m2e}),e.registerItem({id:this._modalId,hasMask:!1,scrollStrategy:"close",zIndex:"modalFromRender",disableClickAwayClose:!0,disableEscClose:!0,RenderComponent:v2e})}registerExpandRecord(e){e.registerRecordTooltip(b2e)}};E2e.pluginName="workbench-ai-writing",C2e([ao(c8)],E2e.prototype,"_modalService",2),C2e([ao(bR)],E2e.prototype,"_abilityService",2),C2e([ao(lp)],E2e.prototype,"_configurationService",2),C2e([ao(DJe)],E2e.prototype,"_aiWritingService",2),C2e([ao(KO)],E2e.prototype,"_readService",2),C2e([ao(Wz)],E2e.prototype,"_renderContext",2),C2e([ao(qte),cN()],E2e.prototype,"_selectionService",2),C2e([ao(lve),cN()],E2e.prototype,"_gridCellEditService",2),E2e=C2e([io({contrib:[jL,u8,yme,NSe,DSe,n_e]})],E2e);class S2e{constructor(e,t){this._ref=s.a.createRef(),this.el=e,this.options=t,this.render()}setContent(e){var t;null!=(t=this._ref)&&t.current&&this._ref.current.setValue(e.source)}getDefault(){return{format:"plain",source:""}}getContent(){var e,t;return{format:"plain",source:(null==(t=null==(e=this._ref)?void 0:e.current)?void 0:t.getValue())||""}}onFocus(e=(e=>{})){this._focusCallback=e}render(){c.a.render(s.a.createElement(XL,{ref:this._ref,allowEnter:!0,autoFocus:!!this.options.autoFocus,rows:4,defaultValue:this.options.defaultValue,autoComplete:"off",placeholder:this.options.placeholder,onChange:()=>{var e,t;null==(t=(e=this.options).onChange)||t.call(e)},onFocus:()=>{var e;null==(e=this._focusCallback)||e.call(this,!0)},onBlur:()=>{var e;null==(e=this._focusCallback)||e.call(this,!1)}}),this.el,(()=>{var e,t;null==(t=(e=this.options).onLoad)||t.call(e,this)}))}destroy(){c.a.unmountComponentAtNode(this.el)}}class k2e{constructor(e,t){this.el=e,this.options=t,this.render()}setContent(){}render(){c.a.render(s.a.createElement("div",null,this.options.defaultValue),this.el,(()=>{var e,t;null==(t=(e=this.options).onLoad)||t.call(e,this)}))}destroy(){c.a.unmountComponentAtNode(this.el)}}var x2e=Object.defineProperty,O2e=Object.getOwnPropertyDescriptor,I2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?O2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&x2e(t,r,o),o};let R2e=class{constructor(){this._editor=new Map,this._viewer=new Map}init(){const e=this.contentEditorProvider.getContributions();for(const t of e){const e=t.registerContentEditor();this._editor.has(e.format)||this._editor.set(e.format,e.Editor)}const t=this.contentViewerProvider.getContributions();for(const e of t){const t=e.registerContentViewer();this._viewer.has(t.format)||this._viewer.set(t.format,t.Viewer)}}getEditor(e){return this._editor.get(e)}getViewer(e){return this._viewer.get(e)}};I2e([wh(JUe)],R2e.prototype,"contentEditorProvider",2),I2e([wh(XUe)],R2e.prototype,"contentViewerProvider",2),R2e=I2e([io()],R2e);var T2e=Object.defineProperty,A2e=Object.getOwnPropertyDescriptor,M2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?A2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&T2e(t,r,o),o};let N2e=class{create(e,t){const r=this._configuration.getValue("content.defaultFormat"),n=this._contentRegistry.getEditor(r);return t.currentUser=this._contextService.currentUser,new n(e,t)}};M2e([ao(Tk)],N2e.prototype,"_contextService",2),M2e([ao(R2e)],N2e.prototype,"_contentRegistry",2),M2e([ao(lp)],N2e.prototype,"_configuration",2),N2e=M2e([io({token:tze})],N2e);var D2e=Object.defineProperty,P2e=Object.getOwnPropertyDescriptor,j2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?P2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&D2e(t,r,o),o};let F2e=class{create(e,t){const r=this._configuration.getValue("content.defaultFormat"),n=this._contentRegistry.getViewer(r);if(n)return new n(e,t)}};j2e([ao(R2e)],F2e.prototype,"_contentRegistry",2),j2e([ao(lp)],F2e.prototype,"_configuration",2),F2e=j2e([io({token:rze})],F2e);var V2e=Object.defineProperty,L2e=Object.getOwnPropertyDescriptor,$2e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?L2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&V2e(t,r,o),o};let B2e=class{static pluginModule(){return xo().contribution(JUe).contribution(XUe).register(N2e).register(F2e).register(R2e).register(this)}static registerConfiguration(e){e.registerConfiguration({id:"content",type:"object",properties:{defaultFormat:{type:"string"},disableDatasource:{type:"boolean",description:"禁用 datasource"}}}),e.registerDefaultValue({"content.defaultFormat":"plain","content.disableDatasource":!1})}init(){this._contentRegistry.init()}registerContentEditor(){return{format:"plain",Editor:S2e}}registerContentViewer(){return{format:"plain",Viweer:k2e}}};B2e.pluginName="workbench-content",$2e([ao(R2e)],B2e.prototype,"_contentRegistry",2),B2e=$2e([io({contrib:[jL,JUe,XUe]})],B2e);const U2e=({recordId:e,isReadonly:t,isNewRecord:r})=>{const[n,i]=Object(a.useState)(!1),o=Object(a.useRef)(null),l=Object(a.useRef)(!1),c=Object(a.useRef)(),u=Object(a.useRef)(),d=HL(lp),f=HL(tze,{optional:!0}),h=HL(rze,{optional:!0}),p=HL(eze),g=HL(zI),m=HL(KO),v=HL(QUe),y=bG((()=>{var t;const r=null==(t=c.current)?void 0:t.getContent();!r||null==g||g.execCommand("updateContent",{recordId:e,content:r})}),1e3),b=Object(a.useCallback)((e=>{var t;null==(t=c.current)||t.setContent(e),setTimeout((()=>{l.current=!0}),100)}),[]),_=Object(a.useCallback)((e=>{!l.current||i(!!e)}),[]);Object(a.useEffect)((()=>{var t;const n=m.getTable();!(null==d?void 0:d.getValue("content.disableDatasource"))&&!r&&(null==(t=null==v?void 0:v.handleGet)||t.call(v,e,n.get("uuid")).then((t=>{if(t){if(p.setContentWithSlient(e,"record",t),u.current)return void u.current.setContent(t);b(t)}})))}),[e]),Object(a.useEffect)((()=>{var n;if(o.current){if(t){const t=null==h?void 0:h.create(o.current,{defaultValue:(null==(n=p.getContent(e,"record"))?void 0:n.get("source"))||""});if(!t)return;return void(u.current=t)}c.current=null==f?void 0:f.create(o.current,{onLoad:()=>{var t,n,i;null==(t=c.current)||t.onFocus((e=>{_(e)}));try{let t=null==(n=p.getContent(e,"record"))?void 0:n.toJSON();if(!t&&r&&(t=null==(i=c.current)?void 0:i.getDefault()),!t)return;b(t)}catch(e){console.error("set text editor content error",e)}},onChange(){y()}})}return()=>{}}),[]);const w=n?"lakex-table-record-desc-active":"lakex-table-record-desc-noactive";return s.a.createElement("div",{className:`lakex-table-record-desc ${w}`},s.a.createElement("div",{ref:o}))};var z2e=Object.defineProperty,H2e=Object.getOwnPropertyDescriptor;let W2e=class{static pluginModule(){return xo().register(this)}init(){}registerExpandRecord(e){e.registerRecordProvider({RenderComponent:U2e})}};W2e.pluginName="workbench-record-desc",W2e=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?H2e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&z2e(t,r,o),o})([io({contrib:[jL,n_e]})],W2e);const G2e=[l2e,f2e,e2e,i2e,E2e,B2e,W2e],K2e={token:gze,useValue:{registerComment(e){e.registerCommentDatasource({fetchComments:async e=>[]})}}},q2e=({webProxy:e})=>({token:i0e,useValue:{registerFormManage:()=>({async enableForm(t,r){let n;const i={scope:0,status:0,target_id:t,target_type:"Skythings.View",type:"form"};return n="create"===r?await e.shares.create(i):await e.shares.update(i),{src:`/forms/share/${n.token}`}}})}}),Y2e=({webProxy:e})=>[K2e,q2e({webProxy:e})],J2e=({docId:e,docType:t,webProxy:r,webSdk:n,settings:i})=>({settings:Object.assign({},Cze({webSdk:n}),i),webSdk:n,webProxy:r}),X2e=[],Z2e=sZe.filter((e=>!X2e.includes(e.pluginName))),Q2e=[],e3e=UQe.filter((e=>!Q2e.includes(e.pluginName))),t3e=["workbench-full-width","workbench-full-screen","workbench-field-group"],r3e=G2e.filter((e=>!t3e.includes(e.pluginName))),n3e=[],i3e=[],o3e=[],a3e=e=>{var t;const r=J2e({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:e.settings}),n=null==(t=e.data)?void 0:t.records,i=Mxe({...e,...r,workbenchPlugins:r3e,renderPlugins:e3e,kernelPlugins:Z2e,workbenchContribs:[...n3e,...Y2e({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...i3e,...n0e(r.settings),...e.renderContribs||[]],kernelContribs:[...o3e,...RZe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onRendered:()=>{e.onSyncChange&&i.getService(fKe).onSyncChange(e.onSyncChange)},onCollabUsersChange:e.onCollabUsersChange,onDataLoaded:async t=>{var o,a;if(n)return!1;if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:i.tableId});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i},s3e=["kernel-history","kernel-collaboration","kernel-add-record","kernel-add-field","kernel-viewer-form"],l3e=sZe.filter((e=>!s3e.includes(e.pluginName))),c3e=["render-history","render-refresh","render-upload"],u3e=UQe.filter((e=>!c3e.includes(e.pluginName))),d3e=["workbench-add-record","workbench-add-field","workbench-viewer-form","workbench-viewer-form-manage","workbench-grid-cell-editor","workbench-full-width","workbench-full-screen","workbench-field-group"],f3e=G2e.filter((e=>!d3e.includes(e.pluginName))),h3e=e=>{var t;const r=J2e({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:e.settings}),n=null==(t=e.data)?void 0:t.records,i=(e=>{var t;const r=Cxe({webSdk:e.webSdk,settings:e.settings||{}});let n;try{n=new Q8({...e,...r,workbenchPlugins:[...Vxe,...e.workbenchPlugins||[]],renderPlugins:[...jxe,...e.renderPlugins||[]],kernelPlugins:[...Dxe,...e.kernelPlugins||[]],workbenchContribs:[...e.workbenchContribs||[]],renderContribs:[...e.renderContribs||[]],kernelContribs:[...e.kernelContribs||[]]})}catch(r){console.error(r),null==(t=e.onError)||t.call(e,r)}return n})({...e,...r,kernelPlugins:l3e,renderPlugins:u3e,workbenchPlugins:f3e,renderContribs:[...n0e(r.settings)],kernelContribs:[...RZe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,currentUser:e.currentUser})],onDataLoaded:async t=>{var o,a;if(!n)if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:i.tableId});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i},p3e=["kernel-statistics","kernel-selection","kernel-context-menu","kernel-history","kernel-collaboration","kernel-clipboard","kernel-add-record","kernel-add-field","kernel-viewer-form"],g3e=sZe.filter((e=>!p3e.includes(e.pluginName))),m3e=["render-hotkey","render-selection","render-statistics","render-context-menu","render-history","render-group","render-clipboard","render-refresh","render-upload"],v3e=UQe.filter((e=>!m3e.includes(e.pluginName))),y3e=["workbench-hotkey","workbench-context-menu","workbench-statistics","workbench-add-record","workbench-add-field","workbench-viewer-form","workbench-viewer-form-manage","workbench-grid-cell-editor","workbench-full-width","workbench-full-screen","workbench-field-group"],b3e=G2e.filter((e=>!y3e.includes(e.pluginName))),_3e=[],w3e=[],C3e=[],E3e=e=>{const t=J2e({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{...e.settings,"ability.table.update":!1,"ability.table.delete":!1,"ability.record.create":!1,"ability.record.update":!1,"ability.field.create":!1,"toolbar.mode":V4.LITE,"toolbar.topLeft":[],"toolbar.left":["view-manage"],"toolbar.right":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search"],"viewerManage.type":"menu","modal.mode":l8.DRAWER,"render.mode":jz.MOBILE,"viewerGrid.stickyColNum":0,"expandRecord.modalDrawerModeViews":[]}}),r=Mxe({...e,...t,workbenchPlugins:b3e,renderPlugins:v3e,kernelPlugins:g3e,workbenchContribs:[..._3e,...Y2e({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...w3e,...n0e(t.settings),...e.renderContribs||[]],kernelContribs:[...C3e,...RZe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onDataLoaded:async n=>{var i,o;if("loadedData"===n)try{const n=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:t.settings["record.maxCount"],offset:0,sheetId:r.tableId});null!=n&&n.users&&r.setUsers(n.users),null!=n&&n.records&&r.setRecords(n.records)}catch{null==(i=e.onRecordLoaded)||i.call(e)}else"loadedRecords"===n&&(null==(o=e.onRecordLoaded)||o.call(e))}});return r},S3e=[...J9.filter((e=>["kernel-field-text","kernel-field-select","kernel-field-multi-select","kernel-field-number","kernel-field-mention","kernel-field-date","kernel-field-checkbox","kernel-field-image","kernel-field-file","kernel-field-link","kernel-field-email","kernel-field-phone","kernel-field-title","kernel-process","kernel-user"].includes(e.pluginName))),Gze],k3e=$i.defineToken("ViewerFormShareContribution"),x3e=({viewField:e,rules:t,FieldComponent:r,validateTrigger:n=["onBlur","onChange"]})=>{var i,o;const a=`lakex-form-form-viewer-${null==(i=e.get("field"))?void 0:i.get("type")}`;return s.a.createElement("div",{className:`${a} ${fa.isMobile?a+"-h5":""}`},s.a.createElement(w.a.Item,{name:null==(o=e.get("field"))?void 0:o.get("uuid"),rules:t,validateTrigger:n,noStyle:!0},s.a.createElement(r,{viewField:e})))};var O3e=Object.defineProperty,I3e=Object.getOwnPropertyDescriptor,R3e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?I3e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&O3e(t,r,o),o};let T3e=class{getProvider(){const e=this.formManageProvider.getContributions();return e[e.length-1].registerFormShare()}submitForm(e){return this.getProvider().submitForm(e)}};R3e([wh(k3e)],T3e.prototype,"formManageProvider",2),T3e=R3e([io()],T3e);var A3e=Object.defineProperty,M3e=Object.getOwnPropertyDescriptor,N3e=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?M3e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&A3e(t,r,o),o};let D3e=class{constructor(){this.getFormComponent=e=>this._fieldService.getFieldFormComponent(e),this.getFormFieldRules=e=>{var t,r;const n=null==(r=(t=this._fieldService).getFieldRules)?void 0:r.call(t,e),i=[];return n&&Array.isArray(n)&&n.forEach((e=>{i.push({validator:JPe(e.validator),message:e.errorMsg})})),i}}async submit(e){const t=e.reduce(((e,t)=>(e[t.fieldId]=this._toProcess.toValue(t),e)),{});await this._viewerFormShareRegistry.getProvider().submitForm(t)}};N3e([ao(UR)],D3e.prototype,"_toProcess",2),N3e([ao(nH)],D3e.prototype,"_fieldService",2),N3e([ao(T3e)],D3e.prototype,"_viewerFormShareRegistry",2),D3e=N3e([io()],D3e);const P3e=s.a.forwardRef(((e,t)=>{const{state:r,view:n,viewFields:i,handleSubmit:o,getFormComponent:l,getFormFieldRules:c}=(()=>{const e=Z9(),t=HL(Uze),r=HL(D3e),n=null==t?void 0:t.getFormEditData(e.get("uuid")),[i]=w.a.useForm(),[o,s]=Object(a.useState)(!1),[l,c]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{function e(e){const t=i.getFieldsValue();Object.values(t).some((e=>void 0!==e))&&!l&&(e.preventDefault(),e.returnValue="")}return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)}),[l]),{state:{loading:o,formState:i},viewFields:(null==n?void 0:n.viewFields)||[],view:null==n?void 0:n.view,handleSubmit:e=>{if(o)return!1;s(!0),c(!0);const t=Object.keys(e),n=[];for(const r of t)n.push({fieldId:r,value:e[r]});null==r||r.submit(n).then((()=>{s(!1)})).catch((e=>{s(!1)}))},getFormComponent:e=>null==r?void 0:r.getFormComponent(e),getFormFieldRules:e=>null==r?void 0:r.getFormFieldRules(e)}})(),u="lakex-viewer-form";return s.a.createElement("div",{ref:t,className:`${u} ${fa.isMobile?u+"-h5":""}`},s.a.createElement("h1",{className:`${u}-title`},null==n?void 0:n.get("name")),s.a.createElement("div",null,s.a.createElement("div",{className:`${u}-desc`},null==n?void 0:n.get("desc")),s.a.createElement("div",{className:`${u}-rule`},s.a.createElement("span",{className:`${u}-required`},"*"),Ph("为必填项"))),s.a.createElement(w.a,{form:r.formState,layout:"vertical",className:`${u}-list`,onFinish:o,scrollToFirstError:!0},Bp(i,((e,t)=>{var r;const n=null==(r=e.get("field"))?void 0:r.get("type");if(!n)return null;const i=l(n);if(!i)return null;const o=e.get("required");let a=`${t+1}.${e.get("name")}`;const d=c(n)||[];if(o&&d.push({required:o,message:Ph("请输入必填项")}),zE.isSelectLike(n)){const e=zE.isSelect(n)?Ph("单选"):Ph("多选");a=s.a.createElement("span",null,a,s.a.createElement("span",{className:`${u}-lable`},"(",e,")"))}return s.a.createElement(w.a.Item,{key:e.get("uuid"),label:a,required:o},s.a.createElement(x3e,{viewField:e,rules:d,FieldComponent:i}))})),s.a.createElement(w.a.Item,null,s.a.createElement(b.a,{type:"primary",htmlType:"submit",size:"large",disabled:r.loading},Ph("提交")))))}));class j3e extends iG{constructor(){super(...arguments),this.viewType=LE.FORM,this.title=Ph("表单视图"),this.desc="",this.icon=e=>s.a.createElement(XU,{type:"FormView",...e}),this.colorCls="yuque-color-orange-5",this.Component=P3e}}var F3e=Object.defineProperty,V3e=Object.getOwnPropertyDescriptor;let L3e=class{static pluginModule(){return xo().contribution(k3e).register(D3e).register(T3e).register(this)}init(){}registerViewer(e){e.registerItem(new j3e({onError:e.onError}))}};L3e.pluginName="render-viewer-form-share",L3e=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?V3e(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&F3e(t,r,o),o})([io({contrib:[Dz,Lz]})],L3e);const $3e=[...Nye.filter((e=>["render-field-text","render-field-select","render-field-multi-select","render-field-number","render-field-mention","render-field-date","render-field-checkbox","render-field-image","render-field-file","render-field-link","render-field-email","render-field-phone","render-field-title","render-opener"].includes(e.pluginName))),L3e,bQe],B3e=[e2e],U3e=()=>{var e,t;return{"render.noRecord":!0,"upload.image.url":`/api/tables/upload?type=image&token=${null==(e=vze("share"))?void 0:e.token}`,"upload.image.quickUrl":"","upload.file.url":`/api/tables/upload?type=attachment&token=${null==(t=vze("share"))?void 0:t.token}`,"upload.file.quickUrl":""}},z3e=({webProxy:e})=>({token:k3e,useValue:{registerFormShare:()=>({async submitForm(t){var r;try{await e.tables.submitRecord({token:null==(r=vze("share"))?void 0:r.token,type:"FORM",data:[{data:JSON.stringify(t)}]},{ignoreGlobalMessage:!0}),m.a.success(Ph("表单提交成功"),.8),m.a.destroy(),window.location.href+="/success"}catch(e){console.error(e),m.a.error(Ph("表单提交失败，请稍后重试"))}}})}}),H3e=e=>{const t=J2e({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{...U3e(),...e.settings,"ability.table.update":!1,"ability.table.delete":!1}});return new Q8({...e,...t,renderPlugins:$3e,kernelPlugins:S3e,workbenchPlugins:B3e,renderContribs:[...n0e(t.settings),z3e({webProxy:e.webProxy})],kernelContribs:[...RZe({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,currentUser:wze.me})]})},W3e=[],G3e=sZe.filter((e=>!W3e.includes(e.pluginName))),K3e=[],q3e=UQe.filter((e=>!K3e.includes(e.pluginName))),Y3e=["workbench-field-group"],J3e=G2e.filter((e=>!Y3e.includes(e.pluginName))),X3e=[],Z3e=[],Q3e=[],e5e=e=>{var t;const r=J2e({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{"opener.useHash":!1,"view.useWindowScroll":!0,"toolbar.topLeft":[],"toolbar.left":["view-manage"],"toolbar.right":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","full-width","full-screen","search","|","add-record"],"toolbar.mode":V4.LITE,"modal.mode":l8.MODAL,"viewerManage.type":"menu","viewerManage.viewTypes":[LE.GRID,LE.CARD,LE.KANBAN],"expandRecord.modalDrawerModeViews":[],"render.autoActive":!1,...e.settings}}),n=null==(t=e.data)?void 0:t.records,i=Mxe({...e,...r,renderPlugins:q3e,kernelPlugins:G3e,workbenchPlugins:J3e,workbenchContribs:[...X3e,...Y2e({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...Z3e,...n0e(r.settings),...e.renderContribs||[]],kernelContribs:[...Q3e,...RZe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onDataLoaded:async t=>{var o,a;if(n)return!1;if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:e.data.sheet[0].id});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i},t5e=[],r5e=sZe.filter((e=>!t5e.includes(e.pluginName))),n5e=[],i5e=UQe.filter((e=>!n5e.includes(e.pluginName))),o5e=["workbench-field-group"],a5e=G2e.filter((e=>!o5e.includes(e.pluginName))),s5e=[],l5e=[],c5e=[],u5e=e=>{var t;const r=J2e({docId:e.docId,docType:e.docType,webProxy:e.webProxy,webSdk:e.webSdk,settings:{...e.settings,"ability.table.create":!1,"ability.table.delete":!1,"ability.table.read":!0,"ability.table.update":!1,"opener.useHash":!1,"view.useWindowScroll":!0,"toolbar.topLeft":[],"toolbar.left":["view-manage"],"toolbar.right":["kanban-group-setting","view-field-setting","filter","grid-group","sort","grid-record-height","search"],"toolbar.mode":V4.LITE,"modal.mode":l8.DRAWER,"render.mode":jz.MOBILE,"viewerManage.type":"menu","viewerManage.viewTypes":[LE.GRID,LE.CARD,LE.KANBAN],"expandRecord.modalDrawerModeViews":[],"render.autoActive":!1,"viewerGrid.stickyColNum":0}}),n=null==(t=e.data)?void 0:t.records,i=Mxe({...e,...r,renderPlugins:i5e,kernelPlugins:r5e,workbenchPlugins:a5e,workbenchContribs:[...s5e,...Y2e({webProxy:e.webProxy}),...e.workbenchContribs||[]],renderContribs:[...l5e,...n0e(r.settings),...e.renderContribs||[]],kernelContribs:[...c5e,...RZe({docId:e.docId,docType:e.docType,webSdk:e.webSdk,webProxy:e.webProxy,currentUser:e.currentUser}),...e.kernelContribs||[]],onDataLoaded:async t=>{var o,a;if(n)return!1;if("loadedData"===t)try{const t=await e.webSdk.TableRecordController.show({docId:e.docId,docType:e.docType,limit:r.settings["record.maxCount"],offset:0,sheetId:e.data.sheet[0].id});null!=t&&t.users&&i.setUsers(t.users),null!=t&&t.records&&i.setRecords(t.records)}catch{null==(o=e.onRecordLoaded)||o.call(e)}else"loadedRecords"===t&&(null==(a=e.onRecordLoaded)||a.call(e))}});return i}}.call(this,r(93),r(3714)(e))}}]);