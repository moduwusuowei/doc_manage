(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{4578:function(e,t,n){"use strict";n.d(t,"a",(function(){return Fo})),n.d(t,"b",(function(){return gn})),n.d(t,"c",(function(){return Kl})),n.d(t,"d",(function(){return QC})),n.d(t,"e",(function(){return As})),n.d(t,"f",(function(){return jc})),n.d(t,"g",(function(){return lc})),n.d(t,"h",(function(){return Rt})),n.d(t,"i",(function(){return BC})),n.d(t,"j",(function(){return _r})),n.d(t,"k",(function(){return Bo})),n.d(t,"l",(function(){return Hi})),n.d(t,"m",(function(){return zs})),n.d(t,"n",(function(){return Cs})),n.d(t,"o",(function(){return ni})),n.d(t,"p",(function(){return td})),n.d(t,"q",(function(){return xi})),n.d(t,"r",(function(){return Ci})),n.d(t,"s",(function(){return wl})),n.d(t,"t",(function(){return mn})),n.d(t,"u",(function(){return Xg})),n.d(t,"v",(function(){return qs}));var r=n(4e3),a=n(126),i=n.n(a),o=n(81),c=n.n(o),l=n(496),s=n.n(l),u=n(793),d=n.n(u),f=n(3667),h=n.n(f),p=n(498),m=n.n(p),y=n(559),v=n.n(y),g=n(182),b=n.n(g),x=n(3252),k=n.n(x),w=n(3608),C=n(96),A=n.n(C),O=n(811),E=n.n(O),P=n(590),S=n.n(P),j=n(1017),R=n.n(j),M=n(591),L=n.n(M),B=n(1018),D=n.n(B),N=n(3251),I=n.n(N),T=n(72),_=n.n(T),F=n(3757),z=n(4723),q=n(722),Y=n.n(q),H=n(1206),G=n.n(H),X=n(132),V=n.n(X),W=n(4622),Z=n.n(W),U=n(67),K=n(4623),Q=n.n(K),J=n(4624),$=n.n(J),ee=n(3484),te=n.n(ee),ne=(n(41),n(10)),re=n(1508),ae=n.n(re),ie=n(468),oe=n.n(ie),ce=n(4625),le=n.n(ce),se=n(4626),ue=n.n(se),de=n(502),fe=n.n(de),he=n(1378),pe=n.n(he),me=n(491),ye=n.n(me),ve=n(4627),ge=n.n(ve),be=n(955),xe=n.n(be),ke=n(825),we=n.n(ke),Ce=n(721),Ae=n.n(Ce),Oe=n(4579),Ee=n.n(Oe),Pe=n(3698),Se=n.n(Pe),je=n(4628),Re=n(4717),Me=n(2950),Le=n.n(Me),Be=n(58),De=n.n(Be),Ne=n(0),Ie=n.n(Ne),Te=n(2),_e=n.n(Te),Fe=n(5),ze=n.n(Fe),qe=(n(151),n(66)),Ye=(n(42),n(9)),He=n(86),Ge=n.n(He),Xe=(n(581),n(301)),Ve=(n(489),n(98)),We=(n(56),n(12)),Ze=(n(790),n(281)),Ue=(n(3214),n(3709)),Ke=(n(782),n(379)),Qe=(n(163),n(37)),Je=(n(599),n(232)),$e=(n(552),n(186)),et=(n(3194),n(3529)),tt=(n(71),n(31)),nt=(n(1001),n(583));function rt(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-viewport-container *::selection {\n  background-color: rgba(52, 155, 249, 0.15) !important;\n  color: inherit !important;\n}\n.lake-user-select-none {\n  user-select: none;\n}\n.lake-diagram-mindmap-root::selection {\n  background-color: var(--yq-blue-1) !important;\n}\n.selection-transparent::selection {\n  background-color: transparent !important;\n  color: inherit !important;\n}\n.selection-transparent *::selection {\n  background-color: transparent !important;\n  color: inherit !important;\n}\n");var at=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children};if(!1!==n(t,arguments.length>3?arguments[3]:void 0,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)){var a=r(t);if(a)for(var i=0;i<a.length;i++)e(a[i],n,r,t,i)}},it=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=r(t);if(i)for(var o=0;o<i.length;o++)!1!==n(i[o],t,a)&&e(i[o],n,r,o)};function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function st(e,t){var n,r=-1/0;if(void 0===t){var a,i=ct(e);try{for(i.s();!(a=i.n()).done;)null!=(n=a.value)&&r<n&&(r=n)}catch(e){i.e(e)}finally{i.f()}}else{var o,c=-1,l=ct(e);try{for(l.s();!(o=l.n()).done;)null!=(n=t(n=o.value,++c,e))&&r<n&&(r=n)}catch(e){l.e(e)}finally{l.f()}}return r}function ut(e,t,n){return e<t?t:e>n?n:e}function dt(e,t){for(var n,r=-1/0,a=0;a<e.length;a++){var i=e[a],o=t?i[t]:i;o>r&&(r=o,n=i)}return n}function ft(e,t){var n=t(e);return e.children&&(n.children=[],e.children.forEach((function(e){n.children&&n.children.push(ft(e,t))}))),n}function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return e<t?t:e>n?n:e}function pt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5;return e>=t[0]-n&&e<=t[1]+n}function mt(e,t){return Object.values(e.reduce((function(e,n){return(e[n[t]]=e[n[t]]||[]).push(n),e}),{}))}function yt(e){return e.filter((function(e,t,n){return n.indexOf(e,0)===t}))}function vt(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function gt(e,t,n){if(n>=e.length)for(var r=n-e.length+1;r--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}function bt(e){for(var t,n,r=arguments.length<=1?0:arguments.length-1;r>=1&&e.length;){var a;for(t=(a=1+--r)<1||arguments.length<=a?void 0:arguments[a];-1!==(n=e.indexOf(t));)e.splice(n,1)}return t}function xt(e,t){t.sort();for(var n=t.length-1;n>=0;n--)e.splice(t[n],1)}function kt(e,t){e.indexOf(t)<0&&e.push(t)}function wt(e,t){e.children?e.children.push(t):e.children=[t]}function Ct(e,t,n,r){for(var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return void 0===e};e&&e!==n&&i(a);)a=t(e),e=r(e);return a}function At(e,t){Object.keys(t).forEach((function(n){var r,a=t[n];if("font-size"===n&&null!==(r=t["font-family"])&&void 0!==r&&r.includes("shouxie")){var i=parseInt(a);i<92&&(a=i+2+"px")}e.style[n]=a}))}function Ot(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(t){var n=t.query,r=t.css;"self"!==n?e.querySelectorAll(n).forEach((function(e){At(e,r)})):At(e,r)}))}function Et(e,t){var n={};return Object.keys(t).forEach((function(r){var a=t[r];!0===a?n[r]=s()(e[r]):d()(t[r])&&d()(e[r])&&a&&(n[r]=Et(e[r],a))})),n}function Pt(e,t,n){var r={};return e&&n?t?(n.forEach((function(n){e[n]!==t[n]&&(r[n]=e[n])})),r):function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e):r}function St(e,t){return h()(e,t,(function(e,t){return void 0!==e||d()(t)?e:null}))}function jt(e,t){var n="object"===i()(e)?e:c()({},e,t),r={},a=function(e){e.split(".").reduce((function(t,r,a,i){return t[r]=a+1===i.length?n[e]:{}}),r)};for(var o in n)a(o);return r}var Rt=Object.freeze({__proto__:null,max:st,min:function(e,t){var n,r=1/0;if(void 0===t){var a,i=ct(e);try{for(i.s();!(a=i.n()).done;)null!=(n=a.value)&&r>n&&(r=n)}catch(e){i.e(e)}finally{i.f()}}else{var o,c=-1,l=ct(e);try{for(l.s();!(o=l.n()).done;)null!=(n=t(n=o.value,++c,e))&&r>n&&(r=n)}catch(e){l.e(e)}finally{l.f()}}return r},limitValue:ut,findMaxObjBy:dt,buildTree:ft,getValue:ht,between:pt,groupBy:mt,arrayUnique:yt,arrayEqual:vt,arrayMove:gt,removeArray:bt,removeMultiple:xt,push:kt,append:wt,closest:Ct,setStyleSheets:Ot,pick:Et,diff:Pt,mergeUndefinedToNull:St,makeChangeModel:jt});function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bt=function(e,t){var n=["x","y"].map((function(n){return e[n]+2*(t[n]-e[n])})),r=b()(n,2);return{x:r[0],y:r[1]}},Dt=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},Nt=function(e,t){var n=Qi(t),r=Math.sin(n),a=Math.cos(n),i=e.x,o=e.y;return{x:i*a-o*r,y:i*r+o*a}},It=function(e,t,n){var r={x:e.x-t.x,y:e.y-t.y},a=Nt(r,n);return{x:a.x+t.x,y:a.y+t.y}},Tt=function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)},_t=function(e){var t=e.x,n=e.y;return{x:t+e.w/2,y:n+e.h/2}},Ft=function(e){var t=e.x,n=e.y;return 180*Math.atan2(n,t)/Math.PI},zt=function(e,t,n){var r={x:t.x-e.x,y:t.y-e.y},a={x:n.x-e.x,y:n.y-e.y},i=Ft(r);return Ft(a)-i},qt=function(e,t){var n=t.x,r=t.y,a=b()(e,2),i=a[0],o=a[1];if(Ji(i.x,o.x))return{x:i.x,y:r};if(Ji(i.y,o.y))return{x:n,y:i.y};var c=no(i.x,i.y,o.x,o.y),l=-1/c,s=(c*i.x+r-i.y-l*n)/(c-l);return{x:s,y:i.y-c*(i.x-s)}},Yt=function(){function e(t){m()(this,e),c()(this,"rect",void 0),c()(this,"_tl",void 0),c()(this,"_tr",void 0),c()(this,"_br",void 0),c()(this,"_bl",void 0),c()(this,"_tc",void 0),c()(this,"_bc",void 0),c()(this,"_rc",void 0),c()(this,"_lc",void 0),c()(this,"_center",void 0),this.rect=t,this._tl=null,this._tr=null,this._br=null,this._bl=null,this._tc=null,this._bc=null,this._rc=null,this._lc=null,this._center=null}return v()(e,[{key:"center",get:function(){return this._center||(this._center=_t(this.rect)),this._center}},{key:"tl",get:function(){if(!this._tl){var e=this.rect,t=e.x,n=e.y,r=e.r;this._tl=It({x:t,y:n},this.center,r)}return this._tl}},{key:"tr",get:function(){if(!this._tr){var e=this.rect,t=e.x,n=e.y,r=e.w,a=e.r;this._tr=It({x:t+r,y:n},this.center,a)}return this._tr}},{key:"br",get:function(){return this._br||(this._br=Bt(this.tl,this.center)),this._br}},{key:"bl",get:function(){return this._bl||(this._bl=Bt(this.tr,this.center)),this._bl}},{key:"tc",get:function(){return this._tc||(this._tc=Dt(this.tl,this.tr)),this._tc}},{key:"bc",get:function(){return this._bc||(this._bc=Dt(this.br,this.bl)),this._bc}},{key:"rc",get:function(){return this._rc||(this._rc=Dt(this.tr,this.br)),this._rc}},{key:"lc",get:function(){return this._lc||(this._lc=Dt(this.tl,this.bl)),this._lc}}]),e}();function Ht(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return 0!==t?[1/t*e[0],1/t*e[1]]:t}function Gt(e,t){return(t-e)/3}function Xt(e,t){var n=0,r=0;return function(e,t){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)}(e,t)?n=Gt(e.x,t.x):r=Gt(e.y,t.y),{x:e.x+n,y:e.y+r}}function Vt(e,t){var n=Xt(e,t),r=Xt(t,e);return["C",n.x,n.y,r.x,r.y,t.x,t.y]}function Wt(e,t){var n={x:-1,y:-1},r=t.connection;return r&&("string"===i()(r)?n=e.anchors.filter((function(e){return e.name===r}))[0]:Array.isArray(r)&&(n={x:r[0],y:r[1]})),{width:e.width,height:e.height,theta:e.rotate,port:n}}function Zt(e,t,n,r){var a,i,o=e.width,c=e.height,l=e.port,s=e.theta,u=l.x,d=l.y;if(0===u&&0===d||1===u&&1===d||0===u&&1===d||1===u&&0===d)return a=[n.x-t.x,n.y-t.y],i=Math.sqrt(Math.pow(o,2)+Math.pow(c,2))/3,{direction:Ht(a),offset:Math.max(i,36)};var f=Ht([n.x-t.x,n.y-t.y]);return 0===u&&d>0&&d<1?(a=0===s?[-1,0]:f,i=Math.abs(Math.abs(n.x)-Math.abs(r.x))):1===u&&d>0&&d<1?(a=0===s?[1,0]:f,i=Math.abs(Math.abs(n.x)-Math.abs(r.x))):0===d&&u>0&&u<1?(a=0===s?[0,-1]:f,i=Math.abs(Math.abs(n.y)-Math.abs(r.y))):1===d&&u>0&&u<1?(a=0===s?[0,1]:f,i=Math.abs(Math.abs(n.y)-Math.abs(r.y))):(a=f,i=Math.abs(n.y-r.y)),i/=2,{direction:a,offset:Math.max(i,32)}}function Ut(e){var t=e.source,n=e.target,r=e.diagram,a=[],i=r.find(t.id),o=r.find(n.id),c=e.getPoints(),l=c[0],s=c[1];if(!i&&!o){var u=Vt(c[0],c[1]);return a.push(u),a}if(i&&o){var d=Wt(i,t),f=Wt(o,n),h=i.percentage2Canvas({x:.5,y:.5}),p=o.percentage2Canvas({x:.5,y:.5}),m=Zt(d,h,l,s),y=Zt(f,p,s,l),v=[l.x+m.direction[0]*m.offset,l.y+m.direction[1]*m.offset],g=[s.x+y.direction[0]*y.offset,s.y+y.direction[1]*y.offset];return[["C",v[0],v[1],g[0],g[1],s.x,s.y]]}if(!i&&o){var b=Zt(Wt(o,n),o.percentage2Canvas({x:.5,y:.5}),s,l),x=Vt(c[0],c[1]);return x[3]=s.x+b.direction[0]*b.offset,x[4]=s.y+b.direction[1]*b.offset,a.push(x),a}var k=Zt(Wt(i,t),i.percentage2Canvas({x:.5,y:.5}),l,s),w=Vt(c[0],c[1]);return w[1]=l.x+k.direction[0]*k.offset,w[2]=l.y+k.direction[1]*k.offset,a.push(w),a}function Kt(e){for(var t=[],n=[0,.25,.5,.75],r=0;r<e.length-1;r++){var a=e[r-1],i=e[r],o=e[r+1],c=e[r+2];void 0===a&&(a={x:2*i.x-o.x,y:2*i.y-o.y}),void 0===c&&(c={x:2*o.x-i.x,y:2*o.y-i.y}),n[1]=Math.pow(ro(a.x,a.y,i.x,i.y),1)+n[0],n[2]=Math.pow(ro(i.x,i.y,o.x,o.y),1)+n[1],n[3]=Math.pow(ro(o.x,o.y,c.x,c.y),1)+n[2];var l=[(n[2]-n[1])/(n[2]-n[0]),(n[1]-n[0])/(n[2]-n[0]),(n[3]-n[2])/(n[3]-n[1]),(n[2]-n[1])/(n[3]-n[1])],s=[(n[2]-n[1])*(l[0]*(i.x-a.x)/(n[1]-n[0])+l[1]*(o.x-i.x)/(n[2]-n[1])),(n[2]-n[1])*(l[0]*(i.y-a.y)/(n[1]-n[0])+l[1]*(o.y-i.y)/(n[2]-n[1]))],u=[(n[2]-n[1])*(l[2]*(o.x-i.x)/(n[2]-n[1])+l[3]*(c.x-o.x)/(n[3]-n[2])),(n[2]-n[1])*(l[2]*(o.y-i.y)/(n[2]-n[1])+l[3]*(c.y-o.y)/(n[3]-n[2]))];t.push(["C",i.x+s[0]/3,i.y+s[1]/3,o.x-u[0]/3,o.y-u[1]/3,o.x,o.y])}return t}function Qt(e){if(Array.isArray(e)){var t=k()(e);return[t[0],t.slice(1).join()].join("")}var n=e.name,r=e.x,a=e.y;switch(n.toLowerCase()){case"m":case"l":return n+[r,a].join();case"h":case"v":return n+r;case"z":return n;case"a":var i=e.xAxisRotation,o=e.largeArcFlag,c=e.sweepFlag;return n+[e.rx,e.ry,i,o,c,r,a].join();case"c":return n+[e.x1,e.y1,e.x2,e.y2,e.x,e.y].join();case"q":return n+[e.x1,e.y1,e.x,e.y].join();default:throw new Error("unknown path command: ".concat(n))}}function Jt(e){return e.map(Qt).join("")}function $t(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return Jt([["M",e-n,t],["a",n,r,0,1,0,2*n,0],["a",n,r,0,1,0,-2*n,0],["Z"]])}function en(e,t,n){return $t(e,t,n)}function tn(e,t,n){var r=[],a=t[0],i=t[t.length-1],o=e[0],c=e[e.length-1];if(!o&&!o)return[];"V"===o[o.length-1]?r.push(["L",a.x,o[1]]):r.push(["L",o[0],a.y]);for(var l=1;l<e.length;l++){var s=e[l-1],u=e[l];"V"===u[u.length-1]?r.push(["L",s[0],u[1]]):r.push(["L",u[0],s[1]])}"V"===c[c.length-1]?r.push(["L",i.x,c[1]]):r.push(["L",c[0],i.y]);var d=r;n&&(d=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=e[n+1];r&&a&&$i(r.slice(1),a.slice(1),2)?n+=1:t.push(r)}return t}(r)),d.unshift(["M",a.x,a.y]);var f=d[d.length-1];if(Ji(f[1],t[t.length-1].x,.65)&&Ji(f[f.length-1],t[t.length-1].y,.65)?d[d.length-1]=["L",t[t.length-1].x,t[t.length-1].y]:Ji(f[1],t[t.length-1].x)&&Ji(f[f.length-1],t[t.length-1].y)||d.push(["L",t[t.length-1].x,t[t.length-1].y]),d.length>1){var h=d[0],p=d[1];Ji(h[1],p[1],.65)&&Ji(h[h.length-1],p[p.length-1],.65)&&d.splice(1,1)}return d}function nn(e,t,n,r,a,i,o,c){return Jt([["M",e,t],["L",n,t],["L",n,r],["L",e,r],["Z"],["M",a,i],["L",a,c],["L",o,c],["L",o,i],["Z"]])}function rn(e,t,n,r){return Jt([["M",e,t],["L",n,r]])}var an="\t\n\v\f\r   ᠎             　\u2028\u2029",on=new RegExp("([a-z])["+an+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+an+"]*,?["+an+"]*)+)","ig"),cn=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+an+"]*,?["+an+"]*","ig");function ln(e){if(!e)return null;if(Array.isArray(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return(e=String(e)).replace(on,(function(e,r,a){var i=[],o=r.toLowerCase();if(a.replace(cn,(function(e,t){t&&i.push(+t)})),"m"===o&&i.length>2&&(n.push([r].concat(i.splice(0,2))),o="l",r="m"===r?"l":"L"),"o"===o&&1===i.length&&n.push([r,i[0]]),"r"===o)n.push([r].concat(i));else for(;i.length>=t[o]&&(n.push([r].concat(i.splice(0,t[o]))),t[o]););return""})),n}function sn(e){return Jt(e.map((function(e,t){return[0===t?"M":"L",e.x,e.y]})))}function un(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:a;return Jt(a?[["M",+e+ +a,t],["l",n-2*a,0],["a",a,i,0,0,1,a,i],["l",0,r-2*i],["a",a,i,0,0,1,-a,i],["l",2*a-n,0],["a",a,i,0,0,1,-a,-i],["l",0,2*i-r],["a",a,i,0,0,1,a,-i],["z"]]:[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]])}function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hn(e){for(var t,n=/([mlhvcsqtaz])/gi,r=e.replace(n," $1 ").trim().split(/[ ,]+/),a=[],i=0;i<r.length;i++){var o=r[i];n.test(o)?(t&&a.push(t),t=[o]):t.push(parseFloat(o))}return a}function pn(e,t,n){return"string"==typeof e&&(e=hn(e)),e.map((function(e){return function(e,t,n){switch(Array.isArray(e)&&(e=function(e){var t=k()(e),n=t[0],r=t.slice(1);switch(n.toLowerCase()){case"m":case"l":var a=b()(r,2);return{name:n,x:a[0],y:a[1]};case"a":var i=b()(r,7);return{name:n,rx:i[0],ry:i[1],xAxisRotation:i[2],largeArcFlag:i[3],sweepFlag:i[4],x:i[5],y:i[6]};case"c":var o=b()(r,6);return{name:n,x1:o[0],y1:o[1],x2:o[2],y2:o[3],x:o[4],y:o[5]};case"q":var c=b()(r,4);return{name:n,x1:c[0],y1:c[1],x:c[2],y:c[3]};default:return{name:n}}}(e)),e.name.toLowerCase()){case"m":case"l":var r=e,a=r.x,i=r.y;return fn(fn({},e),{},{x:a*t,y:i*n});case"a":var o=e,c=o.x,l=o.y,s=o.rx,u=o.ry;return fn(fn({},e),{},{x:c*t,y:l*n,rx:s*t,ry:u*n});case"c":var d=e,f=d.x1,h=d.y1,p=d.x2,m=d.y2,y=d.x,v=d.y;return fn(fn({},e),{},{x1:f*t,y1:h*n,x2:p*t,y2:m*n,x:y*t,y:v*n});case"q":var g=e,x=g.x1,w=g.y1,C=g.x,A=g.y;return fn(fn({},e),{},{x1:x*t,y1:w*n,x:C*t,y:A*n});default:return e}}(e,t,n)}))}var mn=Object.freeze({__proto__:null,parsePathString:ln,formatPath:Jt,rectPath:un,polylinePath:sn,ellipsePath:$t,circlePath:en,catmullRomPath:Kt,elbowPath:tn,bezierPath:Ut,huiPath:nn,linePath:rn,inflatePath:hn,scalePath:pn});function yn(){var e=[],t=arguments.length<=0?void 0:arguments[0];Array.isArray(t)?e.push(t):e.push([t]);for(var n=1;n<arguments.length;n++)if(t=n<0||arguments.length<=n?void 0:arguments[n],Array.isArray(t))e.push(t);else{for(var r=[],a=0;a<e[0].length;a++)r.push(t);e.push(r)}return e}var vn,gn=Object.freeze({__proto__:null,convertBatch:yn}),bn=function(e){return null==e?void 0:e.isText},xn=function(e){return null==e?void 0:e.isLine},kn=function(e){return null==e?void 0:e.isVertex},wn=function(e){return null==e?void 0:e.isDsl},Cn=function(e){return null==e?void 0:e.isDslCell},An=function(e){return null==e?void 0:e.isGroup},On=function(e){return null==e?void 0:e.isBoardCell},En=function(e){return null==e?void 0:e.isMindmap},Pn=function(e){return null==e?void 0:e.isGeometry},Sn=function(e){return null==e?void 0:e.isSwimlane},jn=function(e){return null==e?void 0:e.isSwimlaneCell},Rn=function(e){return null==e?void 0:e.isStack},Mn=function(e){return null==e?void 0:e.isStackCell},Ln=function(e){return null==e?void 0:e.isFreeHand},Bn=function(e){return null==e?void 0:e.isPen},Dn=function(e){return null==e?void 0:e.isPoints},Nn=function(e){return{minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height}},In=function(e){var t=new Yt(e),n=t.tl,r=t.tr,a=t.bl,i=t.br;return{minX:Math.min(n.x,r.x,a.x,i.x),minY:Math.min(n.y,r.y,a.y,i.y),maxX:Math.max(n.x,r.x,a.x,i.x),maxY:Math.max(n.y,r.y,a.y,i.y)}};function Tn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e.getBBox()},n=e.reduce((function(e,n){var r=t(n),a=[r.x,r.y],i=[[a[0],a[1]],[a[0]+r.width,a[1]+r.height]];return e.push.apply(e,i),e}),[]),r=n.reduce((function(e,t){return t[0]>e?t[0]:e}),n[0][0]),a=n.reduce((function(e,t){return t[0]<e?t[0]:e}),n[0][0]),i=n.reduce((function(e,t){return t[1]>e?t[1]:e}),n[0][1]),o=n.reduce((function(e,t){return t[1]<e?t[1]:e}),n[0][1]);return{minX:a,minY:o,maxX:r,maxY:i}}var _n=(c()(vn={"离线状态该功能不可用":"Offline status, this function is not available","无法导出手绘字体，可能导致图片失真":"Hand-drawn fonts cannot be exported, which may cause image distortion","画布尺寸过大，导出图片失败":"The canvas size is too large, and the image export fails","未命名":"unnamed","与编辑一致":"Same as Edition","阅读页配置":"Setting","默认视口":"Default Viewport"," 粘贴":" paste",ER:"ER",UML:"UML","三角形":"Triangle","上下居中":"Align vertically","上传素材中":"Uploading Material","上传素材图片失败":"Failed to upload material image","上移":"Forward","上移一层":"Bring Forward","下移":"Backward","下移一层":"Bring Backward","不透明度":"Opacity"},"与编辑一致","WYSIWYG"),c()(vn,"云","cloud"),c()(vn,"五角星","star"),c()(vn,"五边形","Polygon"),c()(vn,"五边箭头","pentagon-arrow"),c()(vn,"位置","Position"),c()(vn,"使用","Use"),c()(vn,"使用说明","Instructions"),c()(vn,"保存","Save"),c()(vn,"保持宽高比","Constrain proportions"),c()(vn,"全局","Global"),c()(vn,"全部概化","Total generalization"),c()(vn,"关系","Relationship"),c()(vn,"内部存储","Internal Storage"),c()(vn,"决策","Decision"),c()(vn,"准备","Preparation"),c()(vn,"分支","Choice"),c()(vn,"分支类型","Branch type"),c()(vn,"分支粗细","Branch thickness"),c()(vn,"分支线条宽度逐渐变细","Tapered line"),c()(vn,"分支颜色","Line Color"),c()(vn,"删除","Delete"),c()(vn,"删除单个节点","Delete a single node"),c()(vn,"删除泳道","Delete Lane"),c()(vn,"前进","Forward"),c()(vn,"剪切","Cut"),c()(vn,"剪切失败","Cut failed"),c()(vn,"剪切成功","Cut successfully"),c()(vn,"副标题","Subtitle"),c()(vn,"加粗","Bold"),c()(vn,"包","Package"),c()(vn,"十字","Cross"),c()(vn,"卡片","Card"),c()(vn,"历史","Histroy Pseudostate"),c()(vn,"原始大小","Original size"),c()(vn,"双击画布快速添加","Double click to directly add"),c()(vn,"双向箭头","Arrow 3"),c()(vn,"发送信号","Send Signal"),c()(vn,"取消成组","Ungroup"),c()(vn,"另存为图片","Save as picture"),c()(vn,"可设置颜色、布局、文字等样式","Can set color, layout, text and other styles"),c()(vn,"右对齐","Right"),c()(vn,"右箭头","Arrow 2"),c()(vn,"合并","Merge"),c()(vn,"同步","Fork"),c()(vn,"同级","same level"),c()(vn,"后退","Backward"),c()(vn,"回到中心","Fit Page"),c()(vn,"图形","Shape"),c()(vn,"图片","Picture"),c()(vn,"图片上传中，请稍候","Picture uploading, please wait"),c()(vn,"圆形","Circle"),c()(vn,"圆角半径","Corner radius"),c()(vn,"圆角矩形","Rounded Rectangle"),c()(vn,"垂直均分","Distribute vertically"),c()(vn,"垂直居中","Align vertically"),c()(vn,"基础图形","Basic"),c()(vn,"基础格式","Basic Format"),c()(vn,"填充","Fill"),c()(vn,"填充颜色","Fill"),c()(vn,"备注","Note"),c()(vn,"复制","Copy"),c()(vn,"复制为其它格式","Copy to other formats"),c()(vn,"复制失败","Copy failed"),c()(vn,"复制成功","Copy successfully"),c()(vn,"多个值","multiValue"),c()(vn,"多值属性",""),c()(vn,"多文档","Multi Document"),c()(vn,"多类例","Multiplicity"),c()(vn,"大小","Size"),c()(vn,"大标题","Title"),c()(vn,"子级","Child"),c()(vn,"字号","Font size"),c()(vn,"字色","Font Color"),c()(vn,"存储数据","Stored Data"),c()(vn,"实体","Entity"),c()(vn,"实际尺寸","Actual size"),c()(vn,"宽","Widht"),c()(vn,"宽度","Width"),c()(vn,"对象","Object"),c()(vn,"对齐","Alignment"),c()(vn,"对齐方式","Alignment"),c()(vn,"导出素材图片失败","Failed to export stock image"),c()(vn,"小标题","Title small"),c()(vn,"层级","Level"),c()(vn,"展开","Expand"),c()(vn,"展开工具栏","Expand Toolbar"),c()(vn,"展开节点","Expand topic"),c()(vn,"属性","Attributes"),c()(vn,"左右居中","Align horizontally"),c()(vn,"左对齐","Left"),c()(vn,"左箭头","Arrow 1"),c()(vn,"已粘贴当前页面复制的内容，如需粘贴页面外内容请使用 ","The copied content of the current page has been pasted. If you need to paste the content outside the page, please use"),c()(vn,"布局","Layout"),c()(vn,"平行四边形","Parallelogram"),c()(vn,"并行模式","Parallel"),c()(vn,"幻灯片布局","Slide layout"),c()(vn,"底对齐","Bottom"),c()(vn,"底部对齐","Bottom"),c()(vn,"延迟","Delay"),c()(vn,"开始","Start"),c()(vn,"弱关系","Weak Relationship"),c()(vn,"弱实体","Weak Entity"),c()(vn,"形状","Shape"),c()(vn,"彩虹分支","Multi-colored lines"),c()(vn,"循环起止符","Loop Limit"),c()(vn,"思维导图","Mindmap"),c()(vn,"成组","Group"),c()(vn,"或者","Or"),c()(vn,"所有 icon 素材均来自 iconfont 平台，仅供广大用户交流学习使用，未经 iconfont 或其关联公司书面授权许可，不得用于任何商业用途。","All icon materials come from the iconfont platform and are only for the communication and learning of the majority of users, and may not be used for any commercial purposes without the written authorization of iconfont or its affiliates."),c()(vn,"手动循环","Manual loop"),c()(vn,"手动设置节点宽度","Fixed size"),c()(vn,"手动设置节点尺寸","Custom size"),c()(vn,"手动输入","Manual Input"),c()(vn,"打开设置","Setting"),c()(vn,"批注","Annotation"),c()(vn,"折叠","Collapse"),c()(vn,"折叠节点","Collapse topic"),c()(vn,"拖拽","Drag"),c()(vn,"排列","Arrange"),c()(vn,"排序","Sort"),c()(vn,"接口","Interface"),c()(vn,"接收信号","Receive Signal"),c()(vn,"控制","Control"),c()(vn,"推荐素材","Recommended material"),c()(vn,"描边","Stroke"),c()(vn,"插入","Insert"),c()(vn,"插入 Iconfont","Insert Iconfont"),c()(vn,"插入主节点","Insert root topic"),c()(vn,"插入同级","Insert sibling"),c()(vn,"插入同级节点","Insert topic"),c()(vn,"插入图片","Insert image"),c()(vn,"插入子级","Insert child"),c()(vn,"插入子节点","Insert subtopic"),c()(vn,"插入父级","Insert parent"),c()(vn,"插入连线","Inset line"),c()(vn,"插入链接","Insert link"),c()(vn,"搜索结果为空","Search results are empty"),c()(vn,"撤销","Undo"),c()(vn,"数据","Data"),c()(vn,"数据库","Storage"),c()(vn,"整理","Collate"),c()(vn,"文字样式","Text Style"),c()(vn,"文本","Text"),c()(vn,"文本颜色","Font color"),c()(vn,"文档","Document"),c()(vn,"新建节点","New Node"),c()(vn,"旋转","Rotate"),c()(vn,"旋转角度","Rotate angle"),c()(vn,"无颜色","No color"),c()(vn,"时间信号","Frequency"),c()(vn,"星形","Star"),c()(vn,"显示","Display"),c()(vn,"暂时无法从 iconfont 获取资源","Temporarily unable to get resources from iconfont"),c()(vn,"更多 >","More >"),c()(vn,"最近使用","Recently Used"),c()(vn,"条带","Paper Tape"),c()(vn,"标注","Comment"),c()(vn,"标注 2","Annotation 2"),c()(vn,"样式","Styles"),c()(vn,"格式","Format"),c()(vn,"格式面板","Format panel"),c()(vn,"框选后，右键添加到素材库","After frame selection, right click and add to material library"),c()(vn,"梯形","Trapezoid"),c()(vn,"概化","Generalization"),c()(vn,"正文","Text"),c()(vn,"步骤一：框选需要添加的内容","Step 1: Box to select the content to be added"),c()(vn,"步骤二：右键打开面板，选择“添加到素材库”","Step 2: Right-click to open the panel and select 'Add to Material Library'"),c()(vn,"水平均分","Distribute horizontally"),c()(vn,"水平对齐","Horizontal Alignment"),c()(vn,"汇总连接","Summing Junction"),c()(vn,"注释","Annotation"),c()(vn,"泳道","Swimlane"),c()(vn,"泳道垂直","Vertical Swimlane"),c()(vn,"泳道水平","horizontal Swimlane"),c()(vn,"泳道数","Lane Number"),c()(vn,"活动","Activity"),c()(vn,"活动类","Activity Class"),c()(vn,"派生属性","Derived Attribute"),c()(vn,"流程图","Flowchart"),c()(vn,"流程图图形","Flowchart Graphics"),c()(vn,"流程箭头","process-arrow"),c()(vn,"流终止","Termination Pseudostate"),c()(vn,"添加到素材库","Add to material library"),c()(vn,"添加图形","Insert Geometry"),c()(vn,"添加思维导图","Insert Mindmap"),c()(vn,"添加文字","Insert Text"),c()(vn,"添加自定义素材","Add custom material"),c()(vn,"添加连线","Insert Line"),c()(vn,"添加链接","Insert Link"),c()(vn,"激活","Activation"),c()(vn,"点击选中元素","Click on the selected element"),c()(vn,"父级","Parent"),c()(vn,"版权说明","Copyright statement"),c()(vn,"状态","State"),c()(vn,"用例","Use Case"),c()(vn,"矩形","Rectangle"),c()(vn,"硬盘","Hard Disk"),c()(vn,"竖直对齐","Vertical Alignment"),c()(vn,"端点","End Point"),c()(vn,"简单类","Simple Class"),c()(vn,"类","Class"),c()(vn,"类型","Type"),c()(vn,"粗细","Line Width"),c()(vn,"粘贴","Paste"),c()(vn,"粘贴失败","Paste failed"),c()(vn,"素材库","Material Lib"),c()(vn,"素材版权说明","Material copyright statement"),c()(vn,"约束","Constraint"),c()(vn,"线条","Line"),c()(vn,"线条/边框","Line/Border"),c()(vn,"线条样式","Line style"),c()(vn,"线条端点","Line Endpoint"),c()(vn,"线条类型","Line Shape"),c()(vn,"线条粗细","Line Width"),c()(vn,"线条颜色","Line Color"),c()(vn,"直线","Straight"),c()(vn,"曲线","Curve"),c()(vn,"折线","Elbow"),c()(vn,"组件","Component"),c()(vn,"组合片段","Frame"),c()(vn,"终点","End"),c()(vn,"绑定","Boundary"),c()(vn,"结束","Finish"),c()(vn,"结构","Structure"),c()(vn,"编辑文本","Edit text"),c()(vn,"置底","Back"),c()(vn,"置顶","Front"),c()(vn,"背景","Background"),c()(vn,"背景颜色","Background color"),c()(vn,"自动适配","Adaption"),c()(vn,"自定义素材","Custom material"),c()(vn,"节点","Node"),c()(vn,"节点填充","Fill"),c()(vn,"节点形状","Topic shape"),c()(vn,"节点描边","Stroke"),c()(vn,"菱形","Diamond"),c()(vn,"角度","Angle"),c()(vn,"角色","Actor"),c()(vn,"设置","Setting"),c()(vn,"设置面板","Properties"),c()(vn,"语雀文档","Yuque document"),c()(vn,"语雀表格","Yuque table"),c()(vn,"请搜索","Please search"),c()(vn,"起止符","Terminator"),c()(vn,"起点","Start"),c()(vn,"转换","Swap"),c()(vn,"边框","Border"),c()(vn,"边框粗细","Border thickness"),c()(vn,"边框颜色","Border color"),c()(vn,"过程","Process"),c()(vn,"连接器","Connector"),c()(vn,"连接线","Line"),c()(vn,"连线","Insert Line"),c()(vn,"适应画布","Reset View"),c()(vn,"重做","Redo"),c()(vn,"链接","Link"),c()(vn,"隐藏工具栏","Hide Toolbar"),c()(vn,"页外连接符","Off-page Connector"),c()(vn,"顶对齐","Top"),c()(vn,"顶部对齐","Top"),c()(vn,"预定义流程","Predefined Process"),c()(vn,"颜色","Color"),c()(vn,"高","Height"),c()(vn,"高度","Height"),c()(vn,"概要","Abstract"),c()(vn,"添加概要","Insert Abstract"),c()(vn,"选择","Select"),c()(vn,"画笔","Pencil"),c()(vn,"铅笔","Pencil"),c()(vn,"马克笔","Mark Pencil"),c()(vn,"橡皮","Eraser"),c()(vn,"添加标记","Insert Icon"),c()(vn,"进度","Progress"),c()(vn,"优先级","Priority"),c()(vn,"旗帜","Flag"),c()(vn,"矢量绘图","Vector Drawing"),c()(vn,"确定","confirm"),vn),Fn={locale:r.LocaleUtil.getLocale(),translations:{"en-us":_n}};function zn(e,t){if(!e)return e;var n=Fn.locale,r=Fn.translations[n]||{};return"zh-cn"!==n&&(e=r[e]||e),e.replace(/\{([^\}]+)\}/g,(function(e,n){return t[n]||n}))}var qn="#959EA6",Yn=["#A287E1","#E48484","#69B1E4","#DE81C6","#77C386","#DFB85D","#8169BF"],Hn="rgba(52, 155, 249, .2)",Gn={html:"".concat(zn("思维导图")),type:"mindmap"},Xn=["priority","progress","flag"],Vn=["优先级","进度","旗帜"],Wn=[7,7,7],Zn=[["https://gw.alipayobjects.com/zos/bmw-prod/bf9b8e4b-b1d4-45b1-bafc-f22c905b7b4e.svg","https://gw.alipayobjects.com/zos/bmw-prod/bbb05404-6149-4cd6-b234-e330d412ceff.svg","https://gw.alipayobjects.com/zos/bmw-prod/1ef71652-d5a3-48b7-9e57-de90c7aa835b.svg","https://gw.alipayobjects.com/zos/bmw-prod/4119993f-c9b6-4c2d-8a65-907840a47202.svg","https://gw.alipayobjects.com/zos/bmw-prod/61ae2c45-7c6d-40fe-a772-873e34aecc6f.svg","https://gw.alipayobjects.com/zos/bmw-prod/f9e31950-3daa-457b-a429-6da0c6f8fee0.svg","https://gw.alipayobjects.com/zos/bmw-prod/cf26510b-6d9a-43dc-9bba-67839b11c05b.svg"],["https://gw.alipayobjects.com/zos/bmw-prod/8b4c2bef-649d-40ac-b43b-f33fd456284d.svg","https://gw.alipayobjects.com/zos/bmw-prod/3a513a92-a334-4469-98ae-3c5825d8864e.svg","https://gw.alipayobjects.com/zos/bmw-prod/bd0e81dc-34e8-4b6f-9221-9d33371f53b9.svg","https://gw.alipayobjects.com/zos/bmw-prod/aad5a7c4-8f72-47c0-805b-6b0d239a51d5.svg","https://gw.alipayobjects.com/zos/bmw-prod/5489b9dd-20bc-464a-a064-2593db39d1df.svg","https://gw.alipayobjects.com/zos/bmw-prod/8d2d4df2-f1f0-48c6-875d-c694d01fcfad.svg","https://gw.alipayobjects.com/zos/bmw-prod/d07956ae-58ad-479a-b59d-310646dd5f37.svg"],["https://gw.alipayobjects.com/zos/bmw-prod/01e45248-e9d6-4ac1-9018-f64b82050155.svg","https://gw.alipayobjects.com/zos/bmw-prod/ddb1da7b-5481-4d40-a9f0-d6aea06c0011.svg","https://gw.alipayobjects.com/zos/bmw-prod/566d145a-bffa-4b19-b9fd-14315c9d2fd3.svg","https://gw.alipayobjects.com/zos/bmw-prod/ba0e8dee-7014-4213-84d0-6aee48c37248.svg","https://gw.alipayobjects.com/zos/bmw-prod/d3e16f31-34bd-4269-9ef7-d04005303024.svg","https://gw.alipayobjects.com/zos/bmw-prod/ca82f31a-a2d9-4751-a8d0-d4f87771b913.svg","https://gw.alipayobjects.com/zos/bmw-prod/1a24ad93-ccd5-4fe5-a42e-f8777b933e47.svg"]],Un=function(e,t){var n=Xn.findIndex((function(t){return t===e}));if(-1===n||t>Wn[n])throw new Error("mindmap icon type ".concat(e," or index ").concat(t," is not valid."));return Zn[n][t]},Kn="https://gw.alipayobjects.com/zos/bmw-prod/3f937c7f-4274-4765-8b4c-c0321ab89d83.svg",Qn="https://gw.alipayobjects.com/zos/bmw-prod/4c2a5221-e479-4805-b4e9-f170c9edfad2.svg",Jn="Chinese Quote,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif",$n={"line-height":!0,"font-size":!0,"text-decoration-line":!0,"font-weight":!0,"font-style":!0,"text-align":!0,"text-decoration":!0,color:!0},er="&#8203;",tr="rgb(38, 38, 38)",nr="rgba(9, 109, 217, .05)",rr="lake_diagram_clipboard_data",ar="lake_diagram_custom_colors",ir="lake_diagram_graphic_latest_used",or="lake_diagram_external_font",cr=[{name:"shouxie",fontURL:{woff2:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2"},fontWeight:"normal"},{name:"shouxie",fontURL:{woff2:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2"},fontWeight:"bold"}],lr="middle",sr=[{key:"top",icon:"top",title:"顶部对齐"},{key:"middle",icon:"middle",title:"垂直居中"},{key:"bottom",icon:"bottom",title:"底部对齐"}],ur=sr.map((function(e){return e.key})),dr="#1672F3",fr="rgba(88, 90, 90, 0.7)",hr="#FFFFFF",pr="#3384F5",mr="rgba(255,255,255,0.15)",yr="rgba(51, 132, 245, 0.3)",vr="rgba(95, 159, 246, 0.6)",gr="rgba(255,255,255,0.8)",br="#3384F5",xr="#3384F5",kr="rgba(192,217,252,0.2)",wr="#3384F5",Cr="#C0D9FC",Ar="#595959",Or="edit",Er="read",Pr="pen",Sr="free-hand",jr="eraser",Rr="beginInsertVertex",Mr="pencil",Lr="mark-pencil",Br="a385.b4693.c124035",Dr="a385.b4693.c121188.d251467",Nr="a385.b4693.c121188.d251468",Ir={background:"#ffffff",hover:"#e7e9e8",text:"#595959",roughIconHachurefill:"#585A5A",roughIconCrossHatchfill:"#585A5A",roughIconSolidfill:"#BEC0BF",roughIconHachureDisablefill:"#BEC0BF",roughIconCrossHatchDisablefill:"#BEC0BF",roughIconSolidDisablefill:"#EFF0F0"},Tr={background:"#292929",hover:"rgba(255, 255, 255, 0.12)",text:"#d0d0d0",roughIconHachurefill:"#EFF0F0",roughIconCrossHatchfill:"#EFF0F0",roughIconSolidfill:"#BEC0BF",roughIconHachureDisablefill:"#BEC0BF",roughIconCrossHatchDisablefill:"#8A8F8D",roughIconSolidDisablefill:"#585A5A"},_r=Object.freeze({__proto__:null,BTM_HREF:Kn,BTN_HOVER_HREF:Qn,DEFAULT_FONT_FAMILY:Jn,INLINE_STYLE:$n,EMPTY_TEXT:er,LOCKED_STROKE_COLOR:"#979797",DEFAULT_FONT_COLOR:tr,MULTI_SELECTED_FRAME_FILL:nr,LOCAL_STORAGE_CLIPBOARD_DATA_KEY:rr,LOCAL_STORAGE_CUSTOM_COLORS_KEY:ar,LOCAL_STORAGE_GRAPHIC_LATEST_USED:ir,GLOBAL_VARIABLE_EXTERNAL_FONT_KEY:or,EXTERNAL_FONTS:cr,MINIMUM_STACK_CELL_HEIGHT:30,STACK_CELL_VERTICAL_PADDING:12,MAXIMUM_LINE_TEXT_DISTANCE:60,VERTICAL_TEXT_ALIGN_DEFAULT_VALUE:lr,VERTICAL_TEXT_ALIGN_ALIGN_DATA:sr,VERTICAL_TEXT_ALIGN_VAILD_VALUES:ur,REF_LINE_STROKE:dr,RESIZE_STROKE:fr,RESIZE_FILL:hr,RESIZE_LINE_STROKE:pr,RESIZE_BUTTON_RADIUS:4,ANCHOR_STORE:mr,ANCHOR_FILL:yr,ANCHOR_HOVER_FILL:vr,CONTROL_STROKE:gr,CONTROL_FILL:br,ANTIANCHOR_STROKE:xr,ANTIANCHOR_FILL:"rgba(192,217,252,0.2)",CONNECT_FILL:kr,SELECTED_STROKE_COLOR:wr,LINE_DOCK_TIME:1500,DRAG_DISTANCE_THRESHOLD:8,SWIMLANE_SINGLE_LANE_WIDTH:150,PEN_ACTIVE_BUTTON_FILL:Cr,MAX_LANE_NUMBER:50,MIN_LANE_NUMBER:1,DEFAULT_FREE_HAND_COLOR:Ar,EDIT_MODE:Or,READ_MODE:Er,PEN_MODE:Pr,DRAG_MODE:"dragCanvas",FREE_HAND_MODE:Sr,ERASER_MODE:jr,BEGIN_INSERT_VERTEX_MODE:Rr,FREE_HAND_PENCIL:Mr,FREE_HAND_MARK_PENCIL:Lr,PEN_SPMID:Br,PENCIL_SPMID:Dr,MARK_PENCIL_SPMID:Nr,UI_THEME_COLORS_LIGHT:Ir,UI_THEME_COLORS_DARK:Tr,MINDMAP_ROOT_TEMPLATE:Gn}),Fr="http://www.w3.org/2000/svg",zr="http://www.w3.org/1999/xlink",qr="1.1";function Yr(e){e=e||document.body;var t=document.createElementNS(Fr,"svg");return t.setAttribute("version",qr),t.setAttribute("xmlns",Fr),t.setAttribute("xmlns:xlink",zr),t.style.opacity=0,t.style.width="0px",t.style.height="0px",t.style.position="absolute",t.style["z-index"]=-1,e.appendChild(t),t}function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xr=Yr(),Vr=function(e){S()(n,_.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this),c()(E()(r),"options",void 0),c()(E()(r),"matrix",void 0),c()(E()(r),"rendererElement",void 0),c()(E()(r),"destroyed",void 0),c()(E()(r),"styles",void 0),c()(E()(r),"attrs",void 0),c()(E()(r),"parent",void 0);var a=Gr({matrix:[1,0,0,0,1,0,0,0,1]},e);if(!a.name)throw new Error("Should set name for Graphics Element!");return r.options=a,r.matrix=a.matrix,r.attrs={},r.styles={},r.rendererElement=r.create(a.name),r.update(a),r}return v()(n,[{key:"hide",value:function(){this.update({visibility:"hidden"})}},{key:"show",value:function(){this.update({visibility:"visible"})}},{key:"on",value:function(e,t){return"string"==typeof e&&-1!==this.passthroughEventKeys().indexOf(e)&&this.rendererElement.addEventListener(e,t),I()(L()(n.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return"string"==typeof e&&-1!==this.passthroughEventKeys().indexOf(e)&&this.rendererElement.removeEventListener(e,t),I()(L()(n.prototype),"off",this).call(this,e,t)}},{key:"passthroughEventKeys",value:function(){return["mousedown","mouseenter","mouseleave","mousemove","mouseover","click"]}},{key:"passthroughAttributeKeys",value:function(){return["id","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin","stroke-miterlimit","clip-path","visibility","pointer-events","opacity","stroke-dasharray","class"]}},{key:"_getPassthroughData",value:function(e,t){var n={},r=Object.keys(t),a=this["passthrough".concat(e,"Keys")]();return r.filter((function(e){return a.includes(e)})).forEach((function(e){var r=t[e];void 0!==r&&(n[e]=r)})),n}},{key:"dataset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.rendererElement;t.dataset?Object.assign(t.dataset,e):Object.keys(e).forEach((function(n){t.setAttribute("data-".concat(n),e[n])}))}},{key:"update",value:function(e){var t=this._getPassthroughData("Attribute",e),n=e.matrix;n&&(t.transform="matrix(".concat(n[0],", ").concat(n[1],", ").concat(n[3],", ").concat(n[4],", ").concat(n[6],", ").concat(n[7],")"),this.matrix=n),this.attr(t)}},{key:"setAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rendererElement;Object.keys(e).forEach((function(n){var r=e[n];if(null==r)t.removeAttribute(n);else try{t.setAttribute(n,r)}catch(e){}}))}},{key:"_setStyles",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.rendererElement.style[n]=e[n]}))}},{key:"create",value:function(e){return document.createElementNS(Fr,e)}},{key:"css",value:function(e){if("object"===i()(e))this.styles=Gr(Gr({},this.styles),e),this._setStyles(e);else if("string"==typeof e)return this.styles[e]}},{key:"attr",value:function(e){if("object"===i()(e))this.attrs=Gr(Gr({},this.attrs),e),this.setAttrs(e);else if("string"==typeof e)return this.attrs[e]}},{key:"getBBox",value:function(){var e,t=this.rendererElement,n=this.canvas,r=n&&n.calculateCanvas||Xr;if(document.contains(t))e=t.getBBox();else{var a=t.cloneNode(!0);r.appendChild(a),e=a.getBBox(),r.removeChild(a)}return{x:e.x,y:e.y,width:e.width,height:e.height}}},{key:"capture",value:function(e){!0===e?this.css({"pointer-events":"auto"}):!1===e&&this.css({"pointer-events":"none"})}},{key:"getBoundingClientRect",value:function(){return this.rendererElement.getBoundingClientRect()}},{key:"getZIndex",value:function(){return this.parent?this.parent.children.indexOf(this):null}},{key:"getSiblingRendererElement",value:function(){return this.rendererElement.nextSibling?["before",this.rendererElement.nextSibling]:this.rendererElement.previousSibling?["after",this.rendererElement.previousSibling]:null}},{key:"remove",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"previousSibling",get:function(){if(!this.parent)return null;var e=this.parent.children,t=e.indexOf(this);return t>=1?e[t-1]:null}},{key:"nextSibling",get:function(){var e=this.parent.children,t=e.indexOf(this);return t>=0?e[t+1]:null}},{key:"before",value:function(e){if(!this.parent)return null;this.parent.insertBefore(e,this)}},{key:"after",value:function(e){var t;if(!this.parent)return null;null===(t=this.parent)||void 0===t||t.insertAfter(e,this)}},{key:"toBack",value:function(){if(!this.destroyed){var e=this.parent;e&&e.insertBefore(this,e.children[0])}}},{key:"toFront",value:function(){if(!this.destroyed){var e=this.parent;e&&e.insertBefore(this,null)}}},{key:"forward",value:function(){if(!this.destroyed){var e=this.parent,t=this.nextSibling;e&&t&&e.insertBefore(t,this)}}},{key:"backward",value:function(){if(!this.destroyed){var e=this.parent,t=this.previousSibling;e&&t&&e.insertBefore(this,t)}}},{key:"destroy",value:function(){this.destroyed=!0,this.options=null,this.remove()}}]),n}();function Wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Zr=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"g"},e);return r=t.call(this,a),c()(E()(r),"children",void 0),r.children=[],r}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this)}},{key:"deepEach",value:function(e){at(this,e)}},{key:"add",value:function(e){this.children.includes(e)||(e.parent=this,this.children.push(e),this.rendererElement.appendChild(e.rendererElement))}},{key:"append",value:function(e){this.insertAfter(e,null)}},{key:"prepend",value:function(e){this.insertBefore(e,this.children[0])}},{key:"insertBefore",value:function(e,t){var n=this.children,r=this.rendererElement,a=n.indexOf(e);a>=0&&n.splice(a,1),e.parent=this;var i=n.indexOf(t);i>=0?(n.splice(i,0,e),r.insertBefore(e.rendererElement,t.rendererElement)):(n.push(e),r.insertBefore(e.rendererElement,null))}},{key:"insertAfter",value:function(e,t){t?this.insertBefore(e,t.nextSibling):this.insertBefore(e,null)}},{key:"removeChild",value:function(e){if(e.parent===this){var t=this.children,n=t.indexOf(e);n>-1&&t.splice(n,1),e.parent=void 0,this.rendererElement.removeChild(e.rendererElement)}}},{key:"clear",value:function(){D()(this.children).forEach((function(e){e.remove()}))}}]),n}();function Ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Kr=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(m()(this,n),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({container:null,calculatedContainer:null,name:"svg"},r),!r.container)throw new Error("Please set container for canvas!");e=t.call(this,r),c()(E()(e),"calculateCanvas",void 0),e.options=r;var a=r.container,i=E()(e).rendererElement;return i.setAttribute("version",qr),i.setAttribute("xmlns",Fr),i.setAttribute("xmlns:xlink",zr),a.appendChild(i),e.createCalculateCanvas(),e.container=a,e.canvas=E()(e),e}return v()(n,[{key:"createCalculateCanvas",value:function(){var e=this.options;this.calculateCanvas=Yr(e.calculatedContainer)}},{key:"remove",value:function(){this.container&&this.container.removeChild(this.rendererElement),this.calculateCanvas&&this.calculateCanvas.parentElement.removeChild(this.calculateCanvas)}}]),n}();function Qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Jr=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({x:0,y:0,scale:1,rotate:0},e))}return v()(n,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.options,e);var t=this.options,r=t.x,a=t.y,i=t.scale,o=t.rotate,c=i,l=Math.cos(o),s=Math.sin(o);e.matrix=[l*c,s*c,0,-s*c,l*c,0,r,a,1],I()(L()(n.prototype),"update",this).call(this,e)}}]),n}();var $r=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=t.call(this,r),c()(E()(e),"isShape",!0),e}return v()(n)}();var ea=function(e){S()(n,$r);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e={name:"avatar",matrix:e.element.matrix,element:e.element},t.call(this,e)}return v()(n,[{key:"create",value:function(){return this.options.element.rendererElement.cloneNode(!0)}}]),n}();function ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function na(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ra(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?na(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):na(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var aa=function(e){S()(n,$r);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),r=ra(ra({},r),{},{name:"path"}),e=t.call(this,r),c()(E()(e),"isPath",!0),e}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["d","marker-start","marker-end","fill-rule","clip-rule"])}},{key:"update",value:function(e){var t=e.d;Array.isArray(t)?I()(L()(n.prototype),"update",this).call(this,ra(ra({},e),{},{d:Jt(t)})):I()(L()(n.prototype),"update",this).call(this,e)}},{key:"getPath",value:function(e,t){var n;return pn(null===(n=this.options)||void 0===n?void 0:n.d,e,t)}},{key:"getClosestPoint",value:function(e,t){if("number"==typeof e&&"number"==typeof t){var n=e,r=t,a=_o(this.rendererElement,(function(e,t){var a=e-n,i=t-r;return a*a+i*i})),i=a.point,o=a.percentage;return{point:[i.x,i.y],percentage:o}}if("number"!=typeof e&&t&&"number"!=typeof t){var c,l=e,s=t,u=Nn(this.rendererElement.getBBox()),d=z.a.from(s).voronoi([u.minX-10,u.minY-10,u.maxX+10,u.maxY+10]),f=0,h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ta(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ta(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(d.cellPolygons());try{for(h.s();!(c=h.n()).done;){if(c.value,d.contains(f,l.x,l.y))return f;f++}}catch(e){h.e(e)}finally{h.f()}return 0}}},{key:"getIntersectionPoint",value:function(e,t,n,r){return _o(this.rendererElement,(function(a,i){var o=a-e,c=i-t,l=a-n,s=i-r;return Math.sqrt(o*o+c*c)+Math.sqrt(l*l+s*s)})).point}}]),n}();function ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ia(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}["getPointAtLength","getTotalLength","isPointInFill","isPointInStroke"].forEach((function(e){Object.defineProperty(aa.prototype,e,{value:function(){var t=this.rendererElement;return t[e].apply(t,arguments)}})}));var ca=function(e){S()(n,aa);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.cx,a=e.cy,i=e.rx,o=e.ry;return t.call(this,oa(oa({},e),{},{d:$t(r,a,i,o)}))}return v()(n,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.options;return $t(n.cx*e,n.cy*t,n.rx*e,n.ry*t)}}]),n}();function la(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var sa=function(e){S()(n,$r);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?la(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"html",html:"",x:0,y:0,width:0,height:0,styleSheets:[]},e),t.call(this,e)}return v()(n,[{key:"addClass",value:function(e){this.htmlContainer.classList.add(e)}},{key:"removeClass",value:function(e){this.htmlContainer.classList.remove(e)}},{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["x","y","width","height"])}},{key:"create",value:function(){var e=document.createElement("div"),t=I()(L()(n.prototype),"create",this).call(this,"foreignObject");return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),t.appendChild(e),this.htmlContainer=e,Ot(this.htmlContainer,this.options.styleSheets),t}},{key:"update",value:function(e){e.html&&this.htmlContainer.innerHTML!==e.html&&(this.html=e.html,this.htmlContainer.innerHTML=e.html,Ot(this.htmlContainer,this.options.styleSheets)),I()(L()(n.prototype),"update",this).call(this,e)}}]),n}();function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var da=function(e){S()(n,$r);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"image",crossorigin:"anonymous",preserveAspectRatio:"none"},e))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["href","x","y","width","height","crossorigin","preserveAspectRatio"])}}]),n}();function fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pa=function(e){S()(n,aa);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.points;return t.call(this,ha(ha({},e),{},{d:sn(r).concat("z")}))}return v()(n,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return sn(this.options.points.map((function(n){return{x:n.x*e,y:n.y*t}}))).concat("z")}}]),n}();function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ya(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var va=function(e){S()(n,aa);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.x,a=e.y,i=e.width,o=e.height,c=e.rx,l=e.ry;return t.call(this,ya(ya({},e),{},{d:un(r,a,i,o,c,l)}))}return v()(n,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.options,r=n.x,a=n.y,i=n.width,o=n.height,c=n.rx,l=n.ry;return un(r*e,a*t,i*e,o*t,Math.min(c*e,c),Math.min(l*e,l))}}]),n}();function ga(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ba(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ga(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ga(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xa=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,ba(ba({},e),{},{name:"text"}))}return v()(n,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I()(L()(n.prototype),"update",this).call(this,e);var t=(e||{}).text;null!=t&&(this.rendererElement.innerHTML=t)}},{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["dominant-baseline","x","y","textLength"])}}]),n}();function ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ca=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,wa(wa({},e),{},{name:"title"}))}return v()(n,[{key:"update",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).title;null!=e&&(this.rendererElement.innerHTML=e)}}]),n}();function Aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Oa=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"use"},e),t.call(this,e)}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["x","y","width","height","href"])}}]),n}();function Ea(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Pa=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ea(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ea(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"defs",matrix:null},r),(e=t.call(this,r)).isDefs=!0,e}return v()(n)}();function Sa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ja(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ra=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,ja(ja({},e),{},{matrix:null,name:"clipPath"}))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["id","clipPathUnits"])}}]),n}();function Ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function La(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ma(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ba=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,La(La({},e),{},{name:"feDropShadow"}))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["dx","dy","stdDeviation","flood-color"])}}]),n}();function Da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Na(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Da(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ia=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),(e=t.call(this,Na(Na({},r),{},{name:"filter"}))).children=[],e}return v()(n,[{key:"add",value:function(e){e.parent=this,this.children.push(e),this.rendererElement.appendChild(e.rendererElement)}},{key:"destroy",value:function(){this.children.forEach((function(e){return e.destroy()})),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var Ta=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,_a=function(e){S()(n,Vr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),(e=t.call(this,{name:"linearGradient",matrix:null})).id=Object(F.a)(),e.rendererElement.setAttribute("id",e.id),e}return v()(n,[{key:"update",value:function(e){if("string"==typeof e){var t,n,r,a,i=this.rendererElement,o=Ta.exec(e),c=(n=parseFloat(o[1]),(Math.PI/180*n%(t=2*Math.PI)+t)%t),l=o[2];c>=0&&c<.5*Math.PI?(r={x:0,y:0},a={x:1,y:1}):.5*Math.PI<=c&&c<Math.PI?(r={x:1,y:0},a={x:0,y:1}):Math.PI<=c&&c<1.5*Math.PI?(r={x:1,y:1},a={x:0,y:0}):(r={x:0,y:1},a={x:1,y:0});var s=Math.tan(c),u=s*s,d=(a.x-r.x+s*(a.y-r.y))/(u+1)+r.x,f=s*(a.x-r.x+s*(a.y-r.y))/(u+1)+r.y;i.setAttribute("x1",r.x),i.setAttribute("y1",r.y),i.setAttribute("x2",d),i.setAttribute("y2",f),i.innerHTML=function(e){var t=e.match(/[\d.]+:(#[^\s]+|[^\)]+\))/gi);if(!t)return"";var n="";return t.sort((function(e,t){return e=e.split(":"),t=t.split(":"),Number(e[0])-Number(t[0])})),t.forEach((function(e){e=e.split(":"),n+='<stop offset="'.concat(e[0],'" stop-color="').concat(e[1],'"></stop>')})),n}(l)}}}]),n}();function Fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qa=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,za(za({},e),{},{name:"marker"}))}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["id","markerWidth","markerHeight","viewBox","orient","refX","refY"])}}]),n}();function Ya(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ga(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ha(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ha(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xa=Yr(),Va=function(e){S()(n,$r);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=Ga(Ga({},e),{},{name:"roughPath"}),t.call(this,e)}return v()(n,[{key:"passthroughAttributeKeys",value:function(){return I()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["d","roughFillStyle","disableMultiStroke"])}},{key:"create",value:function(e){var t=I()(L()(n.prototype),"create",this).call(this,"g"),r=I()(L()(n.prototype),"create",this).call(this,"path"),a=I()(L()(n.prototype),"create",this).call(this,"g"),i=I()(L()(n.prototype),"create",this).call(this,"svg");i.setAttribute("version",qr),i.setAttribute("xmlns",Fr),i.setAttribute("xmlns:xlink",zr);var o=$.a.svg(i);return t.appendChild(a),t.appendChild(r),r.setAttribute("fill","rgba(0,0,0,0)"),r.setAttribute("stroke","rgba(0,0,0,0)"),this.roughSVGContainer=i,this.roughSVG=o,this.roughGroup=a,this.calculatePath=r,t}},{key:"setAttrs",value:function(e){var t=this.roughSVG,n=this.calculatePath,r=this.roughGroup,a=this.rendererElement,i=["d","stroke-width"],o=["d","stroke","stroke-width","fill","stroke-dasharray","roughFillWeight","disableMultiStroke"],c={},l={},s={};if(Object.keys(e).forEach((function(t){var n=o.includes(t),r=i.includes(t);n&&(c[t]=e[t]),r&&(l[t]=e[t]),n||r||(s[t]=e[t])})),Object.keys(c).length>0){var u=this.attrs.d,d=t.path(u,function(e){var t=["stroke","fill"],n={seed:75,roughness:.4},r=e.roughFillStyle;return Object.keys(e).forEach((function(a){var i=e[a];t.includes(a)?n[a]=i:"stroke-dasharray"===a&&"string"==typeof i&&"none"!==i?n.strokeLineDash=i.split(" ").map((function(e){return Number(e)})):"stroke-width"===a&&"number"==typeof i?(n.strokeWidth=i,["hachure","default"].includes(r)&&(n.hachureGap=2.5*i,n.fillWeight=.8*i,n.bowing=1.2*(i-1)+4)):"roughFillStyle"===a&&"string"==typeof i?("solid"===i&&(n.roughness=1),n.fillStyle=i):"disableMultiStroke"===a&&"boolean"==typeof i&&(n.disableMultiStroke=i)})),n}(this.attrs));!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(r),r.appendChild(d)}Object.keys(s).forEach((function(e){var t=s[e];null==t?a.removeAttribute(e):a.setAttribute(e,t)})),Object.keys(l).forEach((function(e){var t=l[e];null==t?n.removeAttribute(e):n.setAttribute(e,t)}))}},{key:"update",value:function(e){var t=e.d;Array.isArray(t)?I()(L()(n.prototype),"update",this).call(this,Ga(Ga({},e),{},{d:Jt(t)})):I()(L()(n.prototype),"update",this).call(this,e)}},{key:"getPath",value:function(e,t){var n;return pn(null===(n=this.options)||void 0===n?void 0:n.d,e,t)}},{key:"getClosestPoint",value:function(e,t){if("number"==typeof e&&"number"==typeof t){var n=e,r=t,a=_o(this.calculatePath,(function(e,t){var a=e-n,i=t-r;return a*a+i*i})),i=a.point,o=a.percentage;return{point:[i.x,i.y],percentage:o}}if("number"!=typeof e&&t&&"number"!=typeof t){var c,l=e,s=t,u=Nn(this.calculatePath.getBBox()),d=z.a.from(s).voronoi([u.minX-10,u.minY-10,u.maxX+10,u.maxY+10]),f=0,h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ya(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ya(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(d.cellPolygons());try{for(h.s();!(c=h.n()).done;){if(c.value,d.contains(f,l.x,l.y))return f;f++}}catch(e){h.e(e)}finally{h.f()}return 0}}},{key:"getIntersectionPoint",value:function(e,t,n,r){return _o(this.calculatePath,(function(a,i){var o=a-e,c=i-t,l=a-n,s=i-r;return Math.sqrt(o*o+c*c)+Math.sqrt(l*l+s*s)})).point}},{key:"getBBox",value:function(){var e,t=this.calculatePath,n=this.canvas,r=n&&n.calculateCanvas||Xa;if(document.contains(t))e=t.getBBox();else{var a=t.cloneNode(!0);r.appendChild(a),e=a.getBBox(),r.removeChild(a)}return{x:e.x,y:e.y,width:e.width,height:e.height}}}]),n}();function Wa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wa(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}["getPointAtLength","getTotalLength","isPointInFill","isPointInStroke"].forEach((function(e){Object.defineProperty(Va.prototype,e,{value:function(){var t=this.calculatePath;return t[e].apply(t,arguments)}})}));var Ua=function(e){S()(n,Va);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.cx,a=e.cy,i=e.rx,o=e.ry;return t.call(this,Za(Za({},e),{},{d:$t(r,a,i,o)}))}return v()(n,[{key:"getPath",value:function(e,t){var n=this.options;return $t(n.cx*e,n.cy*t,n.rx*e,n.ry*t)}}]),n}();function Ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ka(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ja=function(e){S()(n,Va);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){m()(this,n);var r=e.points;return t.call(this,Qa(Qa({},e),{},{d:sn(r).concat("z")}))}return v()(n,[{key:"getPath",value:function(e,t){return sn(this.options.points.map((function(n){return{x:n.x*e,y:n.y*t}}))).concat("z")}}]),n}();function $a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$a(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ti=function(e){S()(n,Va);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n);var r=e.x,a=e.y,i=e.width,o=e.height,c=e.rx,l=e.ry;return t.call(this,ei(ei({},e),{},{d:un(r,a,i,o,c,l)}))}return v()(n,[{key:"getPath",value:function(e,t){var n=this.options,r=n.x,a=n.y,i=n.width,o=n.height,c=n.rx,l=n.ry;return un(r*e,a*t,i*e,o*t,Math.min(c*e,c),Math.min(l*e,l))}}]),n}(),ni=Object.freeze({__proto__:null,Canvas:Kr,Group:Zr,FixedGroup:Jr,Shape:$r,Path:aa,Html:sa,Avatar:ea,Image:da,Defs:Pa,LinearGradient:_a,Rect:va,Ellipse:ca,Marker:qa,Use:Oa,Filter:Ia,FeDropShadow:Ba,ClipPath:Ra,Title:Ca,Text:xa,Polygon:pa,RoughPath:Va,RoughRect:ti,RoughPolygon:Ja,RoughEllipse:Ua});function ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ii(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Jr,r=new aa({d:en(0,0,4),stroke:fr,fill:hr,"stroke-width":1});return n.add(r),r.dataset(ai(ai({},t),{},{type:"point",cursor:e})),{group:n,shape:r,name:e}}function oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Zr,r=new aa({stroke:"rgba(255,255,255,0)"}),a=new aa({stroke:pr});return r.dataset(ai(ai({},t),{},{type:"line",cursor:e})),n.add(a),n.add(r),{visShape:a,shape:r,name:e,group:n}}function ci(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Jr,r=new da({href:"https://gw.alipayobjects.com/zos/bmw-prod/d07101fb-046a-474e-a8f7-5bfa2d2d920d.svg",x:-8,y:-8,width:16,height:16});return n.add(r),r.dataset(ai({lake_prevent_click_unselect:"true",rotate_button:"true"},t)),n.css({cursor:"pointer"}),{group:n,shape:r,name:e}}var li=function(e){for(var t=e;null!==(n=t)&&void 0!==n&&n.parent&&An(null===(r=t)||void 0===r?void 0:r.parent);){var n,r,a;t=null===(a=t)||void 0===a?void 0:a.parent}return t},si="#8C8C8C";function ui(e){var t=Y()(e).toRgb(),n=t.r,r=t.g,a=t.b;return t.a<.5||.299*n+.587*r+.114*a>=210?si:"#fff"}try{JSON.parse(r.LocalStorageUtil.getItem(ar))}catch(e){}function di(e,t){var n=[],r={};return e.forEach((function(e){at(e,(function(e){var a=Object(F.a)();r[e.id]=a,t&&(t[a]=t[e.id]),e.id=a,"line"!==e.type&&"edge"!==e.type||n.push(e)}))})),n.forEach((function(e){e.source&&e.source.id&&r[e.source.id]&&(e.source.id=r[e.source.id]),e.target&&e.target.id&&r[e.target.id]&&(e.target.id=r[e.target.id])})),r}function fi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[t.x+t.width/2,t.y+t.height/2],a=Math.cos(n),i=Math.sin(n),o=xo(8,r,[r[0]+a,r[1]+i]);return o(e,0)||o(e,4)?"ew-resize":o(e,1)||o(e,5)?"nesw-resize":o(e,2)||o(e,6)?"ns-resize":"nwse-resize"}function hi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[t.x+t.width/2,t.y+t.height/2],a=Math.cos(n),i=Math.sin(n),o=xo(4,r,[r[0]+a,r[1]+i]);return o(e,0)||o(e,2)?"nesw-resize":"nwse-resize"}function pi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yi(e){var t=new Image;return new Promise((function(n,r){t.onload=function(){n(t)},t.onerror=function(){r(new Error("unable to load url ".concat(e)))},t.crossOrigin="anonymous",t.src=e}))}function vi(e,t,n,r,a,i,o,c,l,s,u){var d=document.createElement("canvas"),f=d.getContext("2d");d.width=s,d.height=u,f&&f.drawImage(t,r,a,i,o,c,l,s,u),e.push({canvas:d,fy:a*n,fHeight:u})}function gi(e){return bi.apply(this,arguments)}function bi(){return bi=G()(V.a.mark((function e(t){var n,r,a,i,o,c,l,s,u,d,f,h,p,m,y,v,g,b,x,k=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=k.length>1&&void 0!==k[1]?k[1]:{},e.next=3,yi(t);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(a=document.createElement("canvas"),i=mi({width:r.naturalWidth,height:r.naturalHeight,fLimit:1e4,ratio:1},n),o=i.width,c=i.height,l=i.fLimit,s=i.backgroundColor,u=i.ratio,d=o*u,f=c*u,a.width=d,a.height=f,h=a.getContext("2d")){e.next=15;break}return e.abrupt("return");case 15:if(s&&(h.fillStyle=s,h.fillRect(0,0,d,f)),f>l){for(p=parseInt(f/l),m=f%l,y=o,v=d,g=[],b=0,x=0;x<p;x++)vi(g,r,u,0,b,y,l/u,0,0,v,l),b+=l/u;vi(g,r,u,0,b,y,m/u,0,0,v,m),g.forEach((function(e){var t=e.canvas,n=e.fy,r=e.fHeight;h.drawImage(t,0,n,d,r)}))}else h.drawImage(r,0,0,d,f);return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e)}))),bi.apply(this,arguments)}var xi=Object.freeze({__proto__:null,loadImage:yi,loadCanvas:gi});function ki(e){return U.ua.macos?e.metaKey:e.ctrlKey}function wi(e,t){return e.key===t||e.key===Z()(t)}var Ci=Object.freeze({__proto__:null,isMod:ki,isKey:wi}),Ai=[{key:"standard-h",directions:[[1,0],[-1,0]]},{key:"standard-r",directions:[[1,0]]},{key:"standard-l",directions:[[-1,0]]},{key:"standard-t",directions:[[0,-1]]},{key:"standard-b",directions:[[0,1]]},{key:"indent-br",directions:[[1,1]]},{key:"indent-bl",directions:[[-1,1]]},{key:"indent-tr",directions:[[1,-1]]},{key:"indent-tl",directions:[[-1,-1]]},{key:"timeline-r",directions:[[1,0]]},{key:"timeline-l",directions:[[-1,0]]}];function Oi(e,t){if(0!==e.length){var n=[];return e.forEach((function(e){var r=t.get([e],"downDirection");if(r){var a=t.get([e],"downLayoutType"),i=t.get([e],"layoutQuadrantConstraint"),o=r.map((function(e){return Math.sign(e)})).join(","),c=(1===i.length?{"0,-1":"t","0,1":"b","-1,0":"l","1,0":"r","1,1":"br","-1,1":"bl","1,-1":"tr","-1,-1":"tl"}:{"-1,0":"h","1,0":"h","0,1":"v","0,-1":"v"})[o];n.push("".concat(a,"-").concat(c))}})),n.every((function(e){return e===n[0]}))?n[0]:"multiValue"}}function Ei(e){var t,n,r=e.split("-"),a=b()(r,2),i=a[0],o=a[1];return"indent"===i?(t=[1,1],n={br:[1],bl:[2],tl:[3],tr:[4]}[o]):"standard"===i?"h"===o?(t=[1,0],n=null):"v"===o?(t=[0,1],n=null):"r"===o?(t=[1,0],n=[1]):"l"===o?(t=[1,0],n=[2]):"t"===o?(t=[0,1],n=[2]):"b"===o&&(t=[0,1],n=[1]):"timeline"===i&&("r"===o?(t=[1,0],n=[1]):"l"===o&&(t=[1,0],n=[2])),{type:i,direction:t,quadrantConstraint:n}}function Pi(e,t){var n=t.some((function(t,n){return Math.sign(t)===Math.sign(e[n])})),r=t.every((function(t,n){return Math.sign(t)!==-Math.sign(e[n])||0===Math.sign(t)}));return n&&r}function Si(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"standard"!==t:"timeline"===e&&"indent"!==t}var ji=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a=function(e,t){var n=new Jr,r=new ca({cx:0,cy:0,rx:4,ry:4,width:8,height:8,stroke:t?"rgba(255,255,255,0.40)":fr,strokeWidth:"2px",fill:t?"rgba(9,109,217,0.40)":hr});return r.dataset({isControlPoint:"".concat(!t),isUIPoints:"".concat(t),index:"".concat(e),test_id:"line-control-point_".concat(e)}),n.add(r),n.dataset({lake_prevent_click_unselect:"true",test_id:"line-control-point_".concat(e),isControlPoint:"".concat(!t),isUIPoints:"".concat(t),index:"".concat(e)}),{group:n,shape:r,index:e,isUIPoints:t,isControlPoints:!t}}(e,t);return n&&r&&(a.shape.css({cursor:"V"===r[r.length-1]?"row-resize":"col-resize"}),a.group.dataset({test_id:"elbow_".concat(t?"ui_point":"control_point","_").concat(e)})),a},Ri=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=new Jr,r=new ca({cx:0,cy:0,rx:t,ry:t,stroke:fr,fill:hr});return n.add(r),n.dataset({lake_prevent_click_unselect:"true",test_id:"line_endpoint_".concat(e)}),{group:n,shape:r,name:e}};function Mi(e,t){for(var n=e.getPoints(),r=tn(e.controlPoints,n,t),a=[],i=0;i<r.length-1;i++){var o=r[i],c=r[i+1],l=[.5*(o[1]+c[1]),.5*(o[2]+c[2]),Ji(o[1],c[1],2)?"H":"V"];a.push(l)}return a.length>2?a.slice(1,a.length-1):a}function Li(e){var t=e.cell,n=e.uiPoints,r=e.uiPointIndex;return"elbow"===t.shape?function(e,t,n){return t.length<=1?t:0===n?t.splice(0,t.length-1):n===t.length-1?t.splice(1):t.slice(1,t.length-1)}(0,n,r):function(e,t,n){var r=t[n],a=s()(e.controlPoints);return a.splice(n,0,r),a}(t,n,r)}function Bi(e,t){var n=[];return"straight"===e.shape?n=function(e){var t,n=[],r=e.getPoints(),a=r.length;for(t=0;t<a-1;t++){var i=[.5*(r[t].x+r[t+1].x),.5*(r[t].y+r[t+1].y)];n.push(i)}return n}(e):"curve"===e.shape?n=function(e){var t=[],n=e.getPoints().length,r=e.wireElement;if(2===n){var a=r.getPointAtLength(.5*r.getTotalLength());t.push([a.x,a.y])}else if(3===n){var i=Oo(r.attrs.d);t.push(i[0]),t.push(i[1])}else{var o,c=ln(e.d);for(o=0;o<c.length-1;o++){var l=[];if("M"===c[o][0])l.push(c[o]),l.push(c[o+1]);else{var s=c[o];l.push(["M",s[s.length-2],s[s.length-1]]),l.push(c[o+1])}var u=Jt(l),d=new aa({d:u}),f=d.getPointAtLength(.5*d.getTotalLength());d.destroy(),t.push([f.x,f.y])}}return t}(e):"elbow"===e.shape&&(n=function(e,t){if(e.controlPoints.length>0||e.isLoop)return function(e,t){var n=e.getPoints(),r=e.controlPoints,a=n[0],i=r[0],o=n[n.length-1],c=r[r.length-1],l=s()(Mi(e,t)),u=tn(r,n,t);return l.length<=2&&u.length<=3||(Ji(i[0],a.x)||Ji(i[1],a.y)||("V"===i[i.length-1]?l.unshift([a.x,.5*(i[1]+a.y),"H"]):l.unshift([.5*(i[0]+a.x),a.y,"V"])),Ji(c[0],o.x)||Ji(c[1],o.y)||("V"===c[c.length-1]?l.push([o.x,.5*(c[1]+o.y),"H"]):l.push([.5*(c[0]+o.x),o.y,"V"]))),l}(e,t);var n=e.source,r=e.target,a=e.diagram,i=a.find(n.id),o=a.find(r.id),c=e.getPoints(),l=[];if(!i&&!o&&2===c.length){var u=c[0],d=c[1],f=.5*(u.x+d.x),h=.5*(u.y+d.y);return Ji(u.x,d.x)||Ji(u.y,d.y)?l.push([f,h,0]):(l.push([.5*(u.x+f),u.y,"V"]),l.push([f,h,"H"]),l.push([.5*(f+d.x),d.y,"V"])),l}for(var p=ln(e.d),m=1;m<p.length;m++){var y=p[m-1],v=p[m];Ji(y[1],v[1])?l.push([y[1],.5*(y[2]+v[2]),"H"]):Ji(y[2],v[2])&&l.push([.5*(y[1]+v[1]),y[2],"V"])}return l}(e,t)),n}var Di=function(e){return Array.isArray(e)?{x:e[0],y:e[1]}:e},Ni=document.createElementNS(Fr,"svg"),Ii=function(e){var t,n;if(Array.isArray(e)){var r=b()(e,2);t=r[0],n=r[1]}else t=e.x,n=e.y;var a=Ni.createSVGPoint();return a.x=t,a.y=n,a},Ti=function(e){return!!(A()(e)&&e.hasOwnProperty("x")&&e.hasOwnProperty("y"))},_i=function(e){if(!e.length)return"";var t=e.reduce((function(e,t,n,r){var a=b()(t,2),i=a[0],o=a[1],c=b()(r[(n+1)%r.length],2),l=c[0],s=c[1];return e.push(i,o,(i+l)/2,(o+s)/2),e}),["M"].concat(D()(e[0]),["Q"]));return t.push("Z"),t.join(" ")};function Fi(e,t){var n=e;if("number"!=typeof e&&(n=oo(e.x,e.y,t.x,t.y)),n>=5*Math.PI/4&&n<7*Math.PI/4)return"N";if(n>=7*Math.PI/4||n<Math.PI/4)return"E";if(n>=Math.PI/4&&n<3*Math.PI/4)return"S";if(n>=3*Math.PI/4&&n<5*Math.PI/4)return"W";throw new Error("unexpected radian ".concat(n))}var zi=["penetratedKeys","Subcells"],qi=function(e,t){return h()(e,t,(function(e,t,n){if(zi.indexOf(n)>-1)return[].concat(D()(e||[]),D()(t||[]))}))},Yi=function(e){return Q()(e,(function(e){if("object"===i()(e)&&!d()(e))return e}))},Hi=Object.freeze({__proto__:null,mergeDefalutProps:qi,cloneDeepDefaultProps:Yi});function Gi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(!e.rendererElement.closest("svg"))return null;var r=Ii(t),a=e.attr("stroke-width");e.attr({"stroke-width":2*n});var i=e.isPointInStroke(r);return e.attr({"stroke-width":a}),i?e.getClosestPoint(t[0],t[1]).point:null}var Xi=function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=a?a/180*Math.PI:0,c=Math.sin(o),l=Math.cos(o),s=n/2,u=r/2;return[l*i,c*i,0,-c*i,l*i,0,e+(-s*l+u*c+s),t+(-s*c-u*l+u),1]};function Vi(e,t){return{minX:-1.5*e,minY:t+10,maxX:2.5*e,maxY:t+30}}function Wi(e,t,n){var r=e/2,a=t/2,i=r<n?r:n,o=a<n?a:n;return[["M",+(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)+ +i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0],["l",e-2*i,0],["a",i,o,0,0,1,i,o],["l",0,t-2*o],["a",i,o,0,0,1,-i,o],["l",2*i-e,0],["a",i,o,0,0,1,-i,-o],["l",0,2*o-t],["a",i,o,0,0,1,i,-o],["z"]]}var Zi=1e-4;function Ui(e){return e>=180&&(e-=360),e<=-180&&(e+=360),e}function Ki(e){return 180*e/Math.PI}function Qi(e){return Math.PI/180*e}function Ji(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zi;return Math.abs(e-t)<=n}function $i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zi;return e.length===t.length&&e.every((function(e,r){return Ji(e,t[r],n)}))}function eo(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&e.maxX>=t.maxX&&e.maxY>=t.maxY}function to(e,t){return!(t.maxX<e.minX||t.minX>e.maxX||t.maxY<e.minY||t.minY>e.maxY)}function no(e,t,n,r){var a;return a=(r-t)/(n-e),isNaN(a)?1/0:a=Number(a.toFixed(2))}function ro(e,t,n,r){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r){var a=e,i=t;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-i,2))}if("number"!=typeof e&&"number"!=typeof t){var o=Di(e),c=Di(t);return Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2))}return 0}function ao(e,t,n,r,a){var i=no(e,t,n,r),o=Math.atan(i),c=n<e,l=a*Math.cos(o),s=a*Math.sin(o);return c&&(l*=-1,s*=-1),{offsetX:l,offsetY:s}}function io(e,t,n,r,a){if(ro(e,t,n,r)<a)return{x:e,y:t};var i=ao(e,t,n,r,a);return{x:n-i.offsetX,y:r-i.offsetY}}function oo(e,t,n,r){var a=no(e,t,n,r),i=Math.atan(a);return n<e?i+Math.PI:r<t?i+2*Math.PI:i}function co(e,t,n,r){var a;return a=Ji(e,n)?1/0:Ji(t,r)?0:(a=(r-t)/(n-e)).toFixed(2),Number(a)}function lo(e,t,n,r,a,i,o,c){if(co(e,t,n,r)===co(a,i,o,c))return!1;var l=((e*r-n*t)*(a-o)-(e-n)*(a*c-i*o))/((e-n)*(i-c)-(t-r)*(a-o)),s=((e*r-n*t)*(i-c)-(t-r)*(a*c-i*o))/((e-n)*(i-c)-(t-r)*(a-o));return{x:-0===l?0:l,y:-0===s?0:s}}function so(e,t,n,r){return Math.abs(e-n)+Math.abs(t-r)}function uo(e,t,n){return e>=t&&e<=n}function fo(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Zi;return Ji(e,n,a)&&Ji(t,r,a)}function ho(e,t,n,r,a,i,o,c){var l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],s=a-e,u=i-t,d=n-e,f=r-t,h=o-a,p=c-i,m=d*p-f*h,y=null;if(m*m>Zi*(d*d+f*f)*(h*h+p*p)){var v=(s*p-u*h)/m,g=(s*f-u*d)/m;uo(v,0,1)&&uo(g,0,1)&&(y={x:e+v*d,y:t+v*f})}return y&&!l&&(fo(e,t,y.x,y.y,.1)||fo(n,r,y.x,y.y,.1)||fo(a,i,y.x,y.y,.1)||fo(o,c,y.x,y.y,.1))?null:y}function po(e,t,n,r){if(e===n)return{f:function(){return null},fy:function(){return e},string:"x=".concat(e.toFixed(3))};if(t===r)return{f:function(){return t},fy:function(){return null},string:"y=".concat(t.toFixed(3))};var a=(r-t)/(n-e),i=-e/(n-e)*(r-t)+t;return{f:function(e){return a*e+i},fy:function(e){return(e-i)/a},string:"y=".concat(a.toFixed(3),"x+").concat(i.toFixed(3))}}function mo(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!!(ho(e.x1,e.y1,e.x2,e.y2,t.minX,t.minY,t.minX,t.maxY,n)||ho(e.x1,e.y1,e.x2,e.y2,t.minX,t.minY,t.maxX,t.minY,n)||ho(e.x1,e.y1,e.x2,e.y2,t.maxX,t.minY,t.maxX,t.maxY,n)||ho(e.x1,e.y1,e.x2,e.y2,t.minX,t.maxY,t.maxX,t.maxY,n))}function yo(e,t){return co(e.x,e.y,t.x1,t.y1)===co(e.x,e.y,t.x2,t.y2)}function vo(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}function go(e,t){if(e.k===1/0){if(e.y1<e.y2&&t.y<e.y1)return!1;if(e.y1>e.y2&&t.y>e.y1)return!1}else{if(e.x1<e.x2&&t.x<e.x1)return!1;if(e.x1>e.x2&&t.x>e.x1)return!1}return!0}function bo(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e[0]*t[0]+e[1]*t[1],a=e[0]*t[1]-e[1]*t[0],i=Math.atan2(a,r);return i<0&&(i=2*Math.PI-Math.abs(i)),n?2*Math.PI-i:i}function xo(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0],r=[],a=2*Math.PI/e,i=0;i<e;i++)r.push([a*i,a*(i+1)]);var o=[n[0]-t[0],n[1]-t[1]];return function(e,n){var a=[e[0]-t[0],e[1]-t[1]],i=r[n];return pt(bo(a,o,!1),i)}}var ko=function(e,t,n){return(n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y)>0};function wo(e,t){var n=new Yt(t),r=n.tl,a=n.tr,i=n.bl,o=n.br;return ko(e,r,a)&&ko(e,a,o)&&ko(e,o,i)&&ko(e,i,r)}var Co=function(e,t){var n="x"in e?Nn(e):e,r="x"in t?Nn(t):t;return Math.max(0,Math.min(n.maxX,r.maxX)-Math.max(n.minX,r.minX))*Math.max(0,Math.min(n.maxY,r.maxY)-Math.max(n.minY,r.minY))},Ao=function(e,t,n){var r=Di(e);return n.map((function(e){var n=Ui(e.r+t),a=_t(e),i=[0,0],o=[0,0];w.vec2.rotate(i,[e.x-r.x,e.y-r.y],[0,0],Qi(t)),i[0]+=r.x,i[1]+=r.y,w.vec2.rotate(o,[a.x-r.x,a.y-r.y],[0,0],Qi(t)),o[0]+=r.x,o[1]+=r.y;var c=[0,0];return w.vec2.rotate(c,[i[0]-o[0],i[1]-o[1]],[0,0],Qi(360-t)),c[0]+=o[0],c[1]+=o[1],{x:c[0],y:c[1],r:n}}))},Oo=function(e){var t=e.split(/Q|M/).slice(1).map((function(e){return e.split(",").map((function(e){return parseFloat(e)}))})),n=t[0],r=n[0],a=n[1],i=t[1][0],o=t[1][1],c=t[1][2],l=t[1][3];return[Eo(.25,r,a,i,o,c,l),Eo(.75,r,a,i,o,c,l)]};function Eo(e,t,n,r,a,i,o){return[Math.pow(1-e,2)*t+2*(1-e)*e*r+Math.pow(e,2)*i,Math.pow(1-e,2)*n+2*(1-e)*e*a+Math.pow(e,2)*o]}var Po=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m()(this,e),this.vertices={},this.edges={},this.isDirected=t}return v()(e,[{key:"snap",value:function(e){for(var t={vertex:void 0,distance:1/0},n=this.getAllVertices(),r=0;r<n.length;r++){var a=n[r];if(a.x===e.x&&a.y===e.y)return a;var i=Math.abs(a.x-e.x)+Math.abs(a.y-e.y);i<t.distance&&(t.vertex=a,t.distance=i)}return t.vertex}},{key:"addVertex",value:function(e){return this.vertices[e.getKey()]=e,this}},{key:"getVertexByKey",value:function(e){return this.vertices[e]}},{key:"getNeighbors",value:function(e){return e.getNeighbors()}},{key:"getAllVertices",value:function(){return Object.values(this.vertices)}},{key:"getAllEdges",value:function(){return Object.values(this.edges)}},{key:"addEdge",value:function(e){var t=this.getVertexByKey(e.startVertex.getKey()),n=this.getVertexByKey(e.endVertex.getKey());if(t||(this.addVertex(e.startVertex),t=this.getVertexByKey(e.startVertex.getKey())),n||(this.addVertex(e.endVertex),n=this.getVertexByKey(e.endVertex.getKey())),this.edges[e.getKey()])throw new Error("Edge has already been added before");return this.edges[e.getKey()]=e,this.isDirected?t.addEdge(e):(t.addEdge(e),n.addEdge(e)),this}},{key:"deleteEdge",value:function(e){if(!this.edges[e.getKey()])throw new Error("Edge not found in graph");delete this.edges[e.getKey()];var t=this.getVertexByKey(e.startVertex.getKey()),n=this.getVertexByKey(e.endVertex.getKey());t.deleteEdge(e),n.deleteEdge(e)}},{key:"findEdge",value:function(e,t){return this.getVertexByKey(e.getKey()).findEdge(t)}},{key:"findVertexByKey",value:function(e){return this.vertices[e]?this.vertices[e]:null}},{key:"getWeight",value:function(){return this.getAllEdges().reduce((function(e,t){return e+t.weight}),0)}},{key:"reverse",value:function(){var e=this;return this.getAllEdges().forEach((function(t){e.deleteEdge(t),t.reverse(),e.addEdge(t)})),this}},{key:"getVerticesIndices",value:function(){var e={};return this.getAllVertices().forEach((function(t,n){e[t.getKey()]=n})),e}},{key:"getAdjacencyMatrix",value:function(){var e=this,t=this.getAllVertices(),n=this.getVerticesIndices(),r=Array(t.length).fill(null).map((function(){return Array(t.length).fill(1/0)}));return t.forEach((function(t,a){t.getNeighbors().forEach((function(i){var o=n[i.getKey()];r[a][o]=e.findEdge(t,i).weight}))})),r}},{key:"toString",value:function(){return Object.keys(this.vertices).toString()}}]),e}(),So=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;m()(this,e),this.value=t,this.next=n}return v()(e,[{key:"toString",value:function(e){return e?e(this.value):"".concat(this.value)}}]),e}(),jo=function(){function e(t){m()(this,e),this.compare=t||e.defaultCompareFunction}return v()(e,[{key:"equal",value:function(e,t){return 0===this.compare(e,t)}},{key:"lessThan",value:function(e,t){return this.compare(e,t)<0}},{key:"greaterThan",value:function(e,t){return this.compare(e,t)>0}},{key:"lessThanOrEqual",value:function(e,t){return this.lessThan(e,t)||this.equal(e,t)}},{key:"greaterThanOrEqual",value:function(e,t){return this.greaterThan(e,t)||this.equal(e,t)}},{key:"reverse",value:function(){var e=this.compare;this.compare=function(t,n){return e(n,t)}}}],[{key:"defaultCompareFunction",value:function(e,t){return e===t?0:e<t?-1:1}}]),e}(),Ro=function(){function e(t){m()(this,e),this.head=null,this.tail=null,this.compare=new jo(t)}return v()(e,[{key:"prepend",value:function(e){return this.head=new So(e,this.head),this}},{key:"append",value:function(e){var t=new So(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)}},{key:"delete",value:function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare.equal(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare.equal(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare.equal(this.tail.value,e)&&(this.tail=n),t}},{key:"find",value:function(e){var t=e.value,n=void 0===t?void 0:t,r=e.callback,a=void 0===r?void 0:r;if(!this.head)return null;for(var i=this.head;i;){if(a&&a(i.value))return i;if(void 0!==n&&this.compare.equal(i.value,n))return i;i=i.next}return null}},{key:"deleteTail",value:function(){if(this.head===this.tail){var e=this.tail;return this.head=null,this.tail=null,e}for(var t=this.tail,n=this.head;n.next;)n.next.next?n=n.next:n.next=null;return this.tail=n,t}},{key:"deleteHead",value:function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e}},{key:"toArray",value:function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e}},{key:"toString",value:function(e){return this.toArray().map((function(t){return t.toString(e)})).toString()}}]),e}(),Mo=function(){function e(t){if(m()(this,e),void 0===t)throw new Error("Graph vertex must have a value");this.value=t,this.edges=new Ro((function(e,t){return e.getKey()===t.getKey()?0:e.getKey()<t.getKey()?-1:1}))}return v()(e,[{key:"addEdge",value:function(e){return this.edges.append(e),this}},{key:"deleteEdge",value:function(e){this.edges.delete(e)}},{key:"getNeighbors",value:function(){var e=this;return this.edges.toArray().map((function(t){return t.value.startVertex===e?t.value.endVertex:t.value.startVertex}))}},{key:"getEdges",value:function(){return this.edges.toArray().map((function(e){return e.value}))}},{key:"getDegree",value:function(){return this.edges.toArray().length}},{key:"hasEdge",value:function(e){return!!this.edges.find({callback:function(t){return t===e}})}},{key:"hasNeighbor",value:function(e){return!!this.edges.find({callback:function(t){return t.startVertex===e||t.endVertex===e}})}},{key:"findEdge",value:function(e){var t=this.edges.find({callback:function(t){return t.startVertex===e||t.endVertex===e}});return t?t.value:null}},{key:"getKey",value:function(){return this.value}},{key:"deleteAllEdges",value:function(){var e=this;return this.getEdges().forEach((function(t){return e.deleteEdge(t)})),this}},{key:"toString",value:function(e){return e?e(this.value):"".concat(this.value)}}]),e}(),Lo=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;m()(this,e),this.startVertex=t,this.endVertex=n,this.weight=r}return v()(e,[{key:"getKey",value:function(){var e=this.startVertex.getKey(),t=this.endVertex.getKey();return"".concat(e,"_").concat(t)}},{key:"reverse",value:function(){var e=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=e,this}},{key:"toString",value:function(){return this.getKey()}}]),e}(),Bo=Object.freeze({__proto__:null,Graph:Po,Vertex:Mo,Edge:Lo,LinkedList:Ro});function Do(e){return e.getNeighbors().filter((function(e){return!0!==e.visited}))}function No(e){var t,n={};for(t=0;t<e.length;t++){var r=e[t],a=po(r.x1,r.y1,r.x2,r.y2).string;if(n[a])"ray"===r.type&&(n[a].type="straight"),e[t]=null;else{n[a]=r;var i,o=co(r.x1,r.y1,r.x2,r.y2);i=r.x1===r.x2?r.x1:r.y1===r.y2?r.y1:r.y1-(r.y2-r.y1)/(r.x2-r.x1)*r.x1,r.k=o,r.b=i,r.intersections=[]}}return(e=e.filter((function(e){return e}))).sort((function(e,t){return e.b-t.b})),e}function Io(e){var t,n,r=mt(e=No(e),"k"),a=[];for(t=0;t<r.length;t++){var i=r[t],o=function(){var e=r[n];i.forEach((function(t){e.forEach((function(e){var n=lo(t.x1,t.y1,t.x2,t.y2,e.x1,e.y1,e.x2,e.y2);("ray"!==t.type||go(t,n))&&("ray"!==e.type||go(e,n))&&(t.intersections.push(n),e.intersections.push(n),n.index=a.length,a.push(n))}))}))};for(n=t+1;n<r.length;n++)o()}var c=new Po,l=a.map((function(e,t){var n=new Mo(t);return Object.assign(n,e),n})),s=[];for(t=0;t<e.length;t++){var u=e[t];for(n=0;n<u.intersections.length;n++){var d=u.intersections[n],f=u.intersections[n+1];f&&s.push(new Lo(l[d.index],l[f.index]))}}return l.forEach((function(e){c.addVertex(e)})),s.forEach((function(e){c.addEdge(e)})),c}function To(e,t,n,r){t=e.snap(t),n=e.snap(n);var a,i,o=t,c=Do(o),l=[o];for(o.visited=!0,o.distance=0;c.length>0;){a=-1/0,i=void 0;for(var s=0;s<c.length;s++){var u=c[s];if(u.from=o,!u.visited){u.distance=vo(o.x,o.y,u.x,u.y)+o.distance;var d=r(u,t,n);d>a&&(i=u,a=d)}}if(i&&(c=Do(o=i),l.push(o),o.visited=!0,o===n))break}return l}function _o(e,t){var n,r,a=e.getTotalLength();if(0===a)return{point:{x:0,y:0},percentage:0};var i,o,c,l,s=8,u=0,d=1/0;for(c=0;c<=a;c+=s)(l=t((o=e.getPointAtLength(c)).x,o.y))<d&&(d=l,u=c,i=o);for(s/=2;s>.5;){var f=u-s,h=e.getPointAtLength(f),p=t(h.x,h.y);if(f>=0&&p<d)i=h,u=f,d=p;else{var m=u+s,y=e.getPointAtLength(m),v=t(y.x,y.y);v>=0&&v<d?(i=y,u=m,d=v):s/=2}}return{point:{x:(null===(n=i)||void 0===n?void 0:n.x)||0,y:(null===(r=i)||void 0===r?void 0:r.y)||0},percentage:u/a}}var Fo=Object.freeze({__proto__:null,deepTreeTraversal:at,deepTreeTraversalWithoutSelf:it,breadthTreeTraversal:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children},r=[];for(r.unshift(e);0!==r.length;){var a=r.shift();if(a){t(a);var i=n(a);if(i)for(var o=0;o<i.length;o++)r.push(i[o])}}},normolizeR:Ui,toDegree:Ki,centerPoint:function(e,t){return e=Di(e),t=Di(t),{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},toRadian:Qi,pointRotateByPoint:function(e,t,n){e=Di(e),t=Di(t);var r=[e.x-t.x,e.y-t.y],a=[0,0];return w.vec2.rotate(a,r,[0,0],Qi(n)),{x:a[0]+t.x,y:a[1]+t.y}},computeWidthByHW:function(e,t){var n=Qi(Ui(e.r));return(t-e.h*Math.abs(Math.cos(Math.PI/2-n)))/Math.abs(Math.cos(n))},roughlyEqual:Ji,roughlyArrayEqual:$i,roughlyDeepEqual:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zi;if(Array.isArray(t)&&Array.isArray(n))return t.length===n.length&&t.every((function(t,a){return e(t,n[a],r)}));if(A()(t)&&A()(n)){for(var a=0,i=Object.keys(t);a<i.length;a++){var o=i[a];if(!e(t[o],n[o],r))return!1}return!0}return Ji(t,n,r)},rectContainRect:eo,rectIntersectRect:to,lineSlope:no,lineDistance:ro,computeXYOffset:ao,findThridPoint:io,lineRadian:oo,lineIntercept:co,lineIntersection:lo,manhattanDistance:so,isBetween:uo,isEqlPoint:fo,lineSegmentIntersect:ho,getLineEquation:po,lineSegmentIntersectRect:mo,pointInLine:yo,pointToPointDistance:vo,isInRay:go,clockwiseAngle:bo,radialQuadrantSegmentationGenerator:xo,normalize2D:function(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return[1/t*e[0],1/t*e[1]]},getOffset:function(e,t){return Math.max(Math.max(Math.abs(Math.abs(e[0])-Math.abs(t[0])),Math.abs(Math.abs(e[1])-Math.abs(t[1])))/3,4)},isPointLiesLineRight:ko,isPointInRect:wo,intersectingAreaOfTwoRects:Co,rotateByPoint:Ao,getMidPointsFromQuadraticBezierPath:Oo,calculateLine:No,linesToGraph:Io,snapPoint:function(e,t){for(var n={vertex:void 0,distance:1/0},r=e.getAllVertices(),a=0;a<r.length;a++){var i=r[a];if(i.x===t.x&&i.y===t.y)return i;var o=so(i.x,i.y,t.x,t.y);o<n.distance&&(n.vertex=i,n.distance=o)}return n.vertex},pathFinding:To,binaryFindPoint:_o});function zo(e,t,n,r){var a=t.split(".");if(!a.reduce((function(e,t){return e&&e[t]}),e)||r)for(var i=a.length,o=0;o<i;o++){var c=a[o];o===i-1?e[c]=n:(d()(e[c])||(e[c]={}),e=e[c])}}var qo=function(e){return!!e.type&&"line"===e.type},Yo=function(e){return!!e.type&&("freehand"===e.type||"pen"===e.type)},Ho=function(e){return!!e.type&&"dsl"===e.type},Go=function(e){return!!e.type&&"geometry"===e.type},Xo=function(e){return!!e.type&&"stack"===e.type},Vo=function(e){return!!e.type&&"swimlane"===e.type},Wo=function(e){return!!e.type&&"text"===e.type},Zo=[{name:"rect",category:"basic",width:100,height:100,outline:{name:"polygon",points:[{x:0,y:0},{x:100,y:0},{x:100,y:100},{x:0,y:100}]},scene:[],thumb:[{d:[["M",8.4,8],["L",23.6,8],["C",23.8209139,8,24,8.1790861,24,8.4],["L",24,23.6],["C",24,23.8209139,23.8209139,24,23.6,24],["L",8.4,24],["C",8.1790861,24,8,23.8209139,8,23.6],["L",8,8.4],["C",8,8.1790861,8.1790861,8,8.4,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"rounded-rect",category:"basic",width:100,height:100,round:10,outline:{path:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e/2,i=t/2,o=Math.min(e,t);r>=o/2&&(r=o/2);var c=a<r?a:r,l=i<r?i:r;return[["M",+c+0,0],["l",e-2*c,0],["a",c,l,0,0,1,c,l],["l",0,t-2*l],["a",c,l,0,0,1,-c,l],["l",2*c-e,0],["a",c,l,0,0,1,-c,-l],["l",0,2*l-t],["a",c,l,0,0,1,c,-l],["z"]]}},scene:[],thumb:[{d:[["M",11,8],["L",21,8],["C",22.6568542,8,24,9.3431458,24,11],["L",24,21],["C",24,22.6568542,22.6568542,24,21,24],["L",11,24],["C",9.3431458,24,8,22.6568542,8,21],["L",8,11],["C",8,9.3431458,9.3431458,8,11,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"triangle",category:"basic",width:100,height:87,outline:{name:"polygon",points:[{x:50,y:0},{x:100,y:87},{x:-141931921e-23,y:87}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:8},{x:25,y:24},{x:7,y:24}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:1},{x:1,y:1}]},{name:"cross",category:"basic",width:80,height:80,outline:{d:[["M",56,0],["C",57.1045695,-0,58,.8954305,58,2],["L",58,22],["L",78,22],["C",79.1045695,22,80,22.8954305,80,24],["L",80,56],["C",80,57.1045695,79.1045695,58,78,58],["L",58,58],["L",58,78],["C",58,79.1045695,57.1045695,80,56,80],["L",24,80],["C",22.8954305,80,22,79.1045695,22,78],["L",22,57.999],["L",2,58],["C",.8954305,58,0,57.1045695,0,56],["L",0,24],["C",0,22.8954305,.8954305,22,2,22],["L",22,21.999],["L",22,2],["C",22,.8954305,22.8954305,0,24,0],["L",56,0],["Z"]]},scene:[],thumb:[{d:[["M",18.8909091,7],["C",19.5536508,7,20.0909091,7.5372583,20.0909091,8.2],["L",20.09,11.909],["L",23.8,11.9090909],["C",24.4627417,11.9090909,25,12.4463492,25,13.1090909],["L",25,18.8909091],["C",25,19.5536508,24.4627417,20.0909091,23.8,20.0909091],["L",20.09,20.09],["L",20.0909091,23.8],["C",20.0909091,24.4627417,19.5536508,25,18.8909091,25],["L",13.1090909,25],["C",12.4463492,25,11.9090909,24.4627417,11.9090909,23.8],["L",11.909,20.09],["L",8.2,20.0909091],["C",7.5372583,20.0909091,7,19.5536508,7,18.8909091],["L",7,13.1090909],["C",7,12.4463492,7.5372583,11.9090909,8.2,11.9090909],["L",11.909,11.909],["L",11.9090909,8.2],["C",11.9090909,7.5372583,12.4463492,7,13.1090909,7],["L",18.8909091,7],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"cloud",category:"basic",width:112,height:80,outline:{d:[["M",20.6665465,28.3657378],["C",9.0184823,12.0418488,29.8104362,1.5251218,41.8853768,16.5362653],["C",41.1592489,-4.3380418,87.3193529,-8.1490155,88.6486324,20.930009],["C",103.875914,12.7155897,116.726702,29.8609474,101.339386,39.434501],["C",122.97831,47.5058532,108.447103,73.4138921,86.4692273,64.7475232],["C",86.3334719,64.958338,86.1921896,65.1661294,86.0455508,65.3708699],["C",81.9792975,83.9250756,49.2991196,84.5216854,42.2982472,68.9125048],["C",27.3426857,79.041314,7.4780067,68.88778,15.843504,56.1252668],["C",-8.1440256,55.1167183,-3.5710215,23.0030303,20.6665465,28.3657378],["Z"]]},scene:[],thumb:[{d:[["M",9.0595002,13.6731476],["C",6.7714876,10.4083698,10.8556214,8.3050244,13.2274847,11.3072531],["C",13.0848525,7.1323916,22.1520157,6.3701969,22.4131242,12.1860018],["C",25.4041974,10.5431179,27.9284594,13.9721895,24.9059508,15.8869002],["C",29.1564537,17.5011706,26.3021096,22.6827784,21.9850268,20.9495046],["C",21.9583605,20.9916676,21.9306087,21.0332259,21.9018046,21.074174],["C",21.1030763,24.7850151,14.6837556,24.9043371,13.3085843,21.782501],["C",10.3708847,23.8082628,6.4688942,21.777556,8.1121169,19.2250534],["C",3.4002807,19.0233437,4.2985494,12.6006061,9.0595002,13.6731476],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"pentagon-arrow",category:"basic",width:120,height:50,textarea:{region:function(e,t){var n=t/50*25;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:4,minY:4,maxX:e-n/2-4,maxY:t-4}}},outline:{path:function(e,t){var n=t/50*25;return n>=e?[["M",0,0],["L",e,t/2],["L",0,t],["Z"]]:[["M",0,0],["L",e-n,0],["L",e,t/2],["L",e-n,t],["L",0,t],["Z"]]}},scene:[],thumb:[{d:[["M",7.4,10],["L",18.8343146,10],["C",18.9404012,10,19.0421427,10.0421427,19.1171573,10.1171573],["L",25,16],["L",25,16],["L",19.1171573,21.8828427],["C",19.0421427,21.9578573,18.9404012,22,18.8343146,22],["L",7.4,22],["C",7.1790861,22,7,21.8209139,7,21.6],["L",7,10.4],["C",7,10.1790861,7.1790861,10,7.4,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"process-arrow",category:"basic",width:120,height:50,textarea:{region:function(e,t){var n=t/50*25;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:n+4,minY:4,maxX:e-n/2-4,maxY:t-4}}},outline:{path:function(e,t){var n=t/50;return 25*n>=e?[["M",0,0],["L",e,t/2],["L",0,t]]:[["M",0,0],["L",e-25*n,0],["L",e,t/2],["L",e-25*n,t],["L",0,t],["L",25*n,t/2],["L",0,0],["Z"]]}},scene:[],thumb:[{d:[["M",19.9439083,10],["C",20.0481092,10,20.1480423,10.0421427,20.2217235,10.1171573],["L",26,16],["L",20.2217235,21.8828427],["C",20.1480423,21.9578573,20.0481092,22,19.9439083,22],["L",6.3928901,22],["C",6.1759029,22,6,21.8209139,6,21.6],["C",6,21.4939134,6.0413937,21.3921718,6.1150748,21.3171573],["L",11.3377208,16],["L",6.1150748,10.6828427],["C",5.9616417,10.526633,5.9616417,10.273367,6.1150748,10.1171573],["C",6.188756,10.0421427,6.2886892,10,6.3928901,10],["L",19.9439083,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-1",category:"basic",width:100,height:80,textarea:{region:function(e,t){var n=t/80*50;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:n/2,minY:.25*t+4,maxX:e-4,maxY:.75*t-4}}},outline:{path:function(e,t){var n=t/80*50;return n>=e?[["M",e,0],["L",0,t/2],["L",e,t],["Z"]]:[["M",n,t/4],["L",n,0],["L",0,t/2],["L",n,t],["L",n,3*t/4],["L",e,3*t/4],["L",e,t/4],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:16.2620321,y:7.99867328},{x:7,y:15.9997347},{x:16.2620321,y:23.9986733},{x:16.2620321,y:19.9277347},{x:25.7357163,y:19.9277347},{x:25.7357163,y:12.1917347},{x:16.2620321,y:12.1917347}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-2",category:"basic",width:100,height:80,textarea:{region:function(e,t){var n=t/80*50;return n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:4,minY:.25*t+4,maxX:e-n/2,maxY:.75*t-4}}},outline:{path:function(e,t){var n=t/80;return 50*n>=e?[["M",0,0],["L",e,t/2],["L",0,t],["Z"]]:[["M",e-50*n,t/4],["L",e-50*n,0],["L",e,t/2],["L",e-50*n,t],["L",e-50*n,3*t/4],["L",0,3*t/4],["L",0,t/4],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:16.4736842,y:7.99867328},{x:25.7357163,y:15.9997347},{x:16.4736842,y:23.9986733},{x:16.4736842,y:19.9277347},{x:7,y:19.9277347},{x:7,y:12.1917347},{x:16.4736842,y:12.1917347}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-3",category:"basic",width:138,height:80,textarea:{region:function(e,t){var n=t/80*46;return 2*n>=e?{minX:4,minY:4,maxX:e-4,maxY:t-4}:{minX:n/2,minY:.3125*t+4,maxX:e-4-n/2,maxY:.6875*t-4}}},outline:{path:function(e,t){var n=.3125,r=.6875,a=t/80*46;return 2*a>=e?[["M",e/2,0],["L",0,t/2],["L",e/2,t],["L",e,t/2],["Z"],["M",e/2,0],["L",e/2,t*n],["M",e/2,t],["L",e/2,t*r]]:[["M",e-a,n*t],["L",e-a,0],["L",e,t/2],["L",e-a,t],["L",e-a,t*r],["L",a,t*r],["L",a,t],["L",0,t/2],["L",a,0],["L",a,t*n],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:19.8639344,y:8},{x:27.109397,y:16},{x:19.8639344,y:24},{x:19.8639344,y:19.1800649},{x:12.5968509,y:19.1800649},{x:12.5968509,y:24},{x:5.10939702,y:16.0010614},{x:12.5968509,y:8},{x:12.5968509,y:12.9324943},{x:19.8639344,y:12.9324943}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"circle",category:"basic",width:100,height:100,outline:{name:"ellipse",cx:50,cy:50,rx:50,ry:50},scene:[],thumb:[{name:"ellipse",cx:16,cy:16.5333333,rx:9,ry:9}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"comment-2",category:"basic",width:120,height:100,controlPoints:[[.25,.75],[.25,1],[.5,.75]],controlPointsConfig:[{x:{proportional:["2"]},y:{proportional:["2"]}},{x:{},y:{limit:!0}},{x:{limit:["0",1]},y:{limit:!0}}],textarea:{region:function(e,t,n){return{minX:4,minY:4,maxX:e-4,maxY:ut(n[0][1],0,1)*t-4}}},outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.25,.75],[.25,1],[.5,.75]]).map((function(n){return[ut(n[0],0,1)*e,ut(n[1],0,1)*t]})),r=Math.min(e/2,t/2,8,n[0][1]/2,n[0][0]/2,(e-n[2][0])/2);return[["M",r,0],["l",e-2*r,0],["a",r,r,0,0,1,r,r],["l",0,n[0][1]-2*r],["a",r,r,0,0,1,-r,r],["L",n[2][0],n[2][1]],["L",n[1][0],n[1][1]],["L",n[0][0],n[0][1]],["l",r-n[0][0],0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-n[0][1]],["a",r,r,0,0,1,r,-r],["Z"]]}},scene:[],thumb:[{d:[["M",10,9],["L",22,9],["C",23.6568542,9,25,10.3431458,25,12],["L",25,18.700459],["C",25,20.3573132,23.6568542,21.700459,22,21.700459],["L",15.4989962,21.700459],["L",15.4989962,21.700459],["L",10.5156524,25.2421473],["L",10.5156524,21.7],["L",10,21.7],["C",8.3431458,21.7,7,20.3568542,7,18.7],["L",7,12],["C",7,10.3431458,8.3431458,9,10,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"comment",category:"basic",width:120,height:100,controlPoints:[[.4,.75],[.5,1],[.6,.75]],controlPointsConfig:[{x:{proportional:["2"]},y:{proportional:["2"]}},{x:{},y:{limit:!0}},{x:{limit:["0",1]},y:{limit:!0}}],outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.4,.75],[.5,1],[.6,.75]]).map((function(n){return[ut(n[0],0,1)*e,ut(n[1],0,1)*t]}));return[["M",0,0],["L",0,n[0][1]],["L",n[0][0],n[0][1]],["L",n[1][0],n[1][1]],["L",n[2][0],n[2][1]],["L",e,n[2][1]],["L",e,0],["Z"]]}},scene:[],thumb:[{d:[["M",7,22],["C",6.4477153,22,6,21.5522847,6,21],["L",6,10],["C",6,9.4477153,6.4477153,9,7,9],["L",25,9],["C",25.5522847,9,26,9.4477153,26,10],["L",26,21],["C",26,21.5522847,25.5522847,22,25,22],["L",18,22],["L",16,25],["L",14,22],["L",7,22],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],textarea:{region:function(e,t,n){return{minX:4,minY:4,maxX:e-4,maxY:ut(n[0][1],0,1)*t-4}}}},{name:"diamond",category:"basic",width:100,height:100,outline:{d:[["M",50.5029462,.2083271],["L",99.7916729,49.4970538],["C",100.069442,49.7748233,100.069442,50.2251767,99.7916729,50.5029462],["L",50.5029462,99.7916729],["C",50.2251767,100.069442,49.7748233,100.069442,49.4970538,99.7916729],["L",.2083271,50.5029462],["C",-.0694424,50.2251767,-.0694424,49.7748233,.2083271,49.4970538],["L",49.4970538,.2083271],["C",49.7748233,-.0694424,50.2251767,-.0694424,50.5029462,.2083271],["Z"]]},scene:[],thumb:[{d:[["M",16.2852309,7.0928427],["L",24.9119336,15.7195454],["C",25.0681433,15.8757552,25.0681433,16.1290212,24.9119336,16.2852309],["L",16.2852309,24.9119336],["C",16.1290212,25.0681433,15.8757552,25.0681433,15.7195454,24.9119336],["L",7.0928427,16.2852309],["C",6.936633,16.1290212,6.936633,15.8757552,7.0928427,15.7195454],["L",15.7195454,7.0928427],["C",15.8757552,6.936633,16.1290212,6.936633,16.2852309,7.0928427],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"parallelogram",category:"basic",width:160,height:80,controlPoints:[[.1875,.25]],controlPointsConfig:[{x:{limit:[0,.75]},y:{limit:!0}}],outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.1875,.25]]).map((function(n){return[ut(n[0],0,1)*e,ut(n[1],0,1)*t]}));return[["M",4*n[0][0]/3,0],["L",0,t],["L",e-4*n[0][0]/3,t],["L",e,0],["Z"]]}},scene:[],thumb:[{d:[["M",11.2637585,9],["L",26.3933844,9],["C",26.6142983,9,26.7933844,9.1790861,26.7933844,9.4],["C",26.7933844,9.4541707,26.7823813,9.507777,26.7610424,9.5575677],["L",21.1038995,22.7575677],["C",21.040868,22.9046413,20.8962528,23,20.7362415,23],["L",5.6066156,23],["C",5.3857017,23,5.2066156,22.8209139,5.2066156,22.6],["C",5.2066156,22.5458293,5.2176187,22.492223,5.2389576,22.4424323],["L",10.8961005,9.2424323],["C",10.959132,9.0953587,11.1037472,9,11.2637585,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"star",category:"basic",width:96,height:91,outline:{name:"polygon",points:[{x:48,y:75},{x:18.6107374,y:91},{x:24.2235871,y:57.7254249},{x:0,y:34.5491503},{x:33.3053687,y:29.7745751},{x:48,y:0},{x:62.6946313,y:29.7745751},{x:96,y:34.5491503},{x:71.7764129,y:57.7254249},{x:77.3892626,y:91}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:21},{x:10.1221475,y:24.0901699},{x:11.2447174,y:17.545085},{x:6.48943484,y:12.9098301},{x:13.0610737,y:11.954915},{x:16,y:6},{x:18.9389263,y:11.954915},{x:25.5105652,y:12.9098301},{x:20.7552826,y:17.545085},{x:21.8778525,y:24.0901699}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0},{x:0,y:.38},{x:1,y:.38},{x:18.6107374/96,y:1},{x:77.3892626/96,y:1}]},{name:"trapezoid",category:"basic",width:140,height:80,controlPoints:[[.75,0]],controlPointsConfig:[{x:{limit:[.5,1]},y:{limit:!0}}],outline:{path:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.75,0]]).map((function(n){return[ut(n[0],0,1)*e,ut(n[1],0,1)*t]}));return[["M",e-n[0][0],0],["L",n[0][0],0],["L",e,t],["L",0,t],["Z"]]}},scene:[],thumb:[{d:[["M",6.4000995,22],["L",25.3553854,22],["C",25.5762993,22,25.7553854,21.8209139,25.7553854,21.6],["C",25.7553854,21.5646094,25.7506887,21.5293754,25.7414182,21.4952206],["L",22.7014434,10.2952206],["C",22.6541459,10.120965,22.4959711,10,22.3154107,10],["L",9.4095965,10],["C",9.228659,10,9.0702525,10.1214609,9.0232992,10.2962],["L",6.0138022,21.4962],["C",5.956475,21.709546,6.0829534,21.9289701,6.2962994,21.9862972],["C",6.3301496,21.995393,6.3650485,22,6.4000995,22],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]}],Uo=[{name:"collate",category:"flowchart",width:42,height:36,textarea:{region:Vi},outline:{d:[["M",40.3837262,0],["C",40.6808145,0,40.9625216,.132096,41.1525116,.3604931],["C",41.478533,.7524209,41.4542938,1.3198118,41.1146853,1.6825771],["L",41.0232331,1.7687854],["L",20.9996243,18.0064637],["L",41.0232331,34.2312146],["C",41.2190021,34.3940632,41.3440192,34.6242958,41.3757431,34.8738407],["L",41.3837518,35],["C",41.3837518,35.5128358,40.997686,35.9355072,40.5003473,35.9932723],["L",40.3837262,36],["L",1.9253140000000002,36],["C",1.6282257999999992,36,1.3465187000000007,35.867904,1.1565287000000009,35.6395069],["C",.8305071999999996,35.2475791,.8547464999999992,34.6801882,1.1943549999999998,34.317423],["L",1.2858070999999995,34.2312146],["L",20.9996243,18.0064637],["L",1.2858070999999995,1.7687854],["C",1.0900382000000004,1.6059368,.9650210999999995,1.3757042,.9332972000000002,1.1261593],["L",.9252885000000006,1],["C",.9252885000000006,.4871642,1.3113542000000002,.0644928,1.8086929000000005,.0067277],["L",1.9253140000000002,0],["L",40.3837262,0],["Z"]]},scene:[],thumb:[{d:[["M",23.6671476,9],["C",23.787916,9,23.9022194,9.0545637,23.9781629,9.1484658],["C",24.1170814,9.3202349,24.0904508,9.5720969,23.9186817,9.7110154],["L",23.9186817,9.7110154],["L",16.142839,16],["L",23.9186817,22.2889846],["C",23.9938034,22.3497394,24.0437485,22.4350446,24.0607217,22.5285699],["L",24.0671476,22.6],["C",24.0671476,22.8209139,23.8880615,23,23.6671476,23],["L",23.6671476,23],["L",8.3328524,23],["C",8.212084,23,8.0977806,22.9454363,8.0218371,22.8515342],["C",7.8829186,22.6797651,7.9095492,22.4279031,8.0813183,22.2889846],["L",8.0813183,22.2889846],["L",15.856839,16],["L",8.0813183,9.7110154],["C",8.0061966,9.6502606,7.9562515,9.5649554,7.9392783,9.4714301],["L",7.9328524,9.4],["C",7.9328524,9.1790861,8.1119385,9,8.3328524,9],["L",8.3328524,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.02,name:"NW"},{x:0,y:.98,name:"SW"},{x:1,y:.02,name:"NE"},{x:1,y:.98,name:"SE"}],antiAnchors:[{x:.5,y:0},{x:.5,y:1}]},{name:"connector",category:"flowchart",width:44,height:44,textarea:{region:Vi},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:9,ry:9}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"data",category:"flowchart",width:124,height:60,textarea:{region:function(e,t){return{minX:.15*e,minY:4,maxX:e-.15*e-4,maxY:t-4}}},outline:{d:[["M",17.1403103,0],["L",122.687657,0],["C",123.239942,-0,123.687657,.4477153,123.687657,1],["C",123.687657,1.0896438,123.675604,1.1788806,123.65182,1.2653118],["L",107.823852,58.7853118],["C",107.704434,59.2192873,107.309796,59.52,106.85969,59.52],["L",1.3123427,59.52],["C",.7600579,59.52,.3123427,59.0722847,.3123427,58.52],["C",.3123427,58.4303562,.3243965,58.3411194,.34818,58.2546882],["L",16.1761477,.7346882],["C",16.2955661,.3007127,16.6902043,-0,17.1403103,0],["Z"]]},scene:[],thumb:[{d:[["M",7.6068779,10],["L",27.4750629,10],["C",27.6959768,10,27.8750629,10.1790861,27.8750629,10.4],["C",27.8750629,10.4358575,27.8702414,10.4715522,27.860728,10.5061247],["L",24.7787871,21.7061247],["C",24.7310198,21.8797149,24.5731645,22,24.3931221,22],["L",4.5249371,22],["C",4.3040232,22,4.1249371,21.8209139,4.1249371,21.6],["C",4.1249371,21.5641425,4.1297586,21.5284478,4.139272,21.4938753],["L",7.2212129,10.2938753],["C",7.2689802,10.1202851,7.4268355,10,7.6068779,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:.095,y:.5,name:"W"},{x:.905,y:.5,name:"E"},{x:.23,y:.02,name:"NW"},{x:.015,y:.98,name:"SW"},{x:.985,y:.02,name:"NE"},{x:.77,y:.98,name:"SE"}]},{name:"database",category:"flowchart",width:70,height:80,textarea:{region:function(e,t){return{minX:4,minY:4+.2*t,maxX:e-4,maxY:t-4}}},outline:{d:[["M",35,0],["C",53.9753466,0,69.4238162,5.273994,69.9842524,11.8539517],["L",69.995311,11.8537712],["L",69.995311,12.022052],["L",70,12.2242015],["C",70,12.2917139,69.998433,12.3590985,69.995311,12.426351],["L",69.995311,67.977948],["C",69.6862333,74.6359505,54.1366666,80,35,80],["C",16.0547001,80,.6251167,74.7426951,.0185218,68.1772958],["L",.004689,67.977948],["L",0,11.8537712],["L",.0157476,11.8539517],["C",.5761838,5.273994,16.0246534,0,35,0],["Z"]]},scene:[{d:[["M",70,13],["C",70,19.0751322,54.3299662,24,35,24],["C",15.8633334,24,.3137667,19.1731371,.004689,13.1819051],["L",0,13]],attr:{fill:"transparent"}}],thumb:[{d:[["M",16,7],["C",20.337222099999998,7,23.8683009,8.1866487,23.9964006,9.6671391],["L",23.9989282,9.6670985],["L",23.9989282,9.7049617],["L",24,9.750445299999999],["C",24,9.7656356,23.9996418,9.7807972,23.9989282,9.795929000000001],["L",23.9989282,22.2950383],["C",23.9282819,23.7930889,20.3740952,25,16,25],["C",11.6696457,25,8.1428838,23.8171064,8.0042336,22.3398916],["L",8.0010718,22.2950383],["L",8,9.6670985],["L",8.0035994,9.6671391],["C",8.1316991,8.1866487,11.6627779,7,16,7],["Z"]]},{d:[["M",24,10],["C",24,11.1045695,20.418278,12,16,12],["C",11.6259048,12,8.0717181,11.1223886,8.0010718,10.0330737],["L",8,10]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:.15,name:"NW"},{x:0,y:.85,name:"SW"},{x:1,y:.15,name:"NE"},{x:1,y:.85,name:"SE"}]},{name:"decision",category:"flowchart",width:140,height:70,textarea:{region:function(e,t){return{minX:24,minY:1/8*t,maxX:e-24,maxY:7/8*t}}},outline:{name:"polygon",points:[{x:70,y:0},{x:140,y:35},{x:70,y:70},{x:0,y:35}]},scene:[],thumb:[{d:[["M",5.5303015,15.6625354],["L",15.7852498,9.1366592],["C",15.9162764,9.0532787,16.0837236,9.0532787,16.2147502,9.1366592],["L",26.4696985,15.6625354],["C",26.656075,15.7811387,26.7110162,16.0283736,26.5924129,16.2147502],["C",26.5609814,16.2641425,26.5190908,16.3060331,26.4696985,16.3374646],["L",16.2147502,22.8633408],["C",16.0837236,22.9467213,15.9162764,22.9467213,15.7852498,22.8633408],["L",5.5303015,16.3374646],["C",5.343925,16.2188613,5.2889839,15.9716264,5.4075871,15.7852498],["C",5.4390186,15.7358575,5.4809092,15.6939669,5.5303015,15.6625354],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"delay",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:4,minY:4,maxX:.81*e,maxY:t-4}}},outline:{d:[["M",1,0],["L",90,0],["C",106.568542,-0,120,13.4314575,120,30],["C",120,46.5685425,106.568542,60,90,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6.4,11.0666667],["L",20,11.0666667],["C",23.3137085,11.0666667,26,13.7529582,26,17.0666667],["C",26,20.3803752,23.3137085,23.0666667,20,23.0666667],["L",6.4,23.0666667],["C",6.1790861,23.0666667,6,22.8875806,6,22.6666667],["L",6,11.4666667],["C",6,11.2457528,6.1790861,11.0666667,6.4,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.81,y:0,name:"NE"},{x:.81,y:1,name:"SE"}]},{name:"display",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:.15*e+4,minY:4,maxX:.9*e,maxY:t-4}}},outline:{d:[["M",18.559242,0],["L",108.388294,0],["C",108.593661,-124e-7,108.794047,.0632157,108.962224,.18108],["C",116.320741,5.3381999,120,15.2778399,120,30],["C",120,43.9124351,116.326183,53.8383306,108.978548,59.7776865],["C",108.800609,59.9215337,108.578719,60,108.349908,60],["L",18.559242,60],["C",18.2079174,60,17.8823628,59.8156369,17.70166,59.5143473],["L",.3084873,30.5143473],["C",.1185966,30.1977386,.1185966,29.8022614,.3084873,29.4856527],["L",17.70166,.4856527],["C",17.8823628,.1843631,18.2079174,0,18.559242,0],["Z"]]},scene:[],thumb:[{d:[["M",8.7974767,10],["L",24.1863956,10],["L",24.1863956,10],["C",25.6811795,11.0207233,26.4285714,13.0207233,26.4285714,16],["C",26.4285714,18.8174994,25.6811795,20.8174994,24.1863956,22],["L",8.7974767,22],["C",8.6564465,22,8.525838,21.9257329,8.4537242,21.8045343],["L",5.1216988,16.2045343],["C",5.0467021,16.0784903,5.0467021,15.9215097,5.1216988,15.7954657],["L",8.4537242,10.1954657],["C",8.525838,10.0742671,8.6564465,10,8.7974767,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.2,y:.14,name:"NW"},{x:.2,y:.86,name:"SW"},{x:.92,y:.14,name:"NE"},{x:.92,y:.86,name:"SE"}]},{name:"document",category:"flowchart",width:120,height:72,outline:{d:[["M",1,0],["L",119,0],["C",119.552285,-0,120,.4477153,120,1],["L",120,63.2943312],["C",119.999975,63.8466024,119.552271,64.2943066,119,64.2943066],["C",118.874051,64.2943066,118.749236,64.2705132,118.63212,64.2241781],["C",108.562735,60.240377,99.0186463,58.2432881,89.9998549,58.2329113],["C",75.8605271,58.216643,73.9215376,58.9595768,59.9999032,65.0379103],["C",46.0782688,71.1162438,44.1653018,71.9832913,29.9999516,72],["C",20.7325008,72.010162,10.9291929,69.6914094,.590028,65.0437423],["C",.2309588,64.882365,-0,64.5253236,0,64.1316572],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6,10],["L",26,10],["L",26,23.0414063],["C",24.237687,22.2996937,22.5710122,21.9279131,20.9999758,21.9260644],["C",18.6434212,21.9232914,18.3202563,22.0499279,15.9999839,23.0860074],["C",13.6797115,24.122087,13.3608836,24.2698792,11,24.2726331],["C",9.4260668,24.274461,7.7594002,23.864052,6,23.0414063],["L",6,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:.9,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:0,y:.9,name:"SW"},{x:.98,y:.015,name:"NE"},{x:1,y:.9,name:"SE"}]},{name:"internal-storage",category:"flowchart",width:80,height:80,textarea:{region:function(e,t){return{minX:.1*e+4,minY:1/8*t+4,maxX:e-4,maxY:t-4}}},outline:{name:"rect",x:0,y:0,width:80,height:80,rx:0,ry:0},scene:[{d:[{name:"M",x:0,y:8},{name:"L",x:80,y:8}]},{d:[{name:"M",x:8,y:0},{name:"L",x:8,y:80}]}],thumb:[{name:"rect",x:8,y:8,width:17,height:17,rx:.4,ry:.4},{d:[{name:"M",x:8.5,y:12.5},{name:"L",x:24.5,y:12.5}]},{d:[{name:"M",x:12.5,y:8.5},{name:"L",x:12.5,y:24.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"loop-limit",category:"flowchart",width:120,height:60,outline:{d:[["M",17.5871195,0],["L",102.429999,0],["C",102.7204,-0,102.996458,.1262398,103.186409,.3459021],["L",119.75641,19.5077312],["C",119.913532,19.6894304,120,19.9216166,120,20.1618291],["L",120,59],["C",120,59.5522847,119.552285,60,119,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,20.1621158],["C",0,19.92173,.0865921,19.6893882,.2439196,19.5076371],["L",16.831039,.3455213],["C",17.0209853,.1260876,17.2968941,0,17.5871195,0],["Z"]]},scene:[],thumb:[{d:[["M",9.5170283,11.0666667],["L",22.4862374,11.0666667],["C",22.6043417,11.0666667,22.7164089,11.1188597,22.7924108,11.2092607],["L",25.9061734,14.9129485],["C",25.9667743,14.9850307,26,15.0761829,26,15.1703545],["L",26,22.6666667],["C",26,22.8875806,25.8209139,23.0666667,25.6,23.0666667],["L",6.4,23.0666667],["C",6.1790861,23.0666667,6,22.8875806,6,22.6666667],["L",6,15.1704681],["C",6,15.0762275,6.0332743,14.9850132,6.0939556,14.9129087],["L",9.210984,11.2091073],["C",9.286986,11.118798,9.3989942,11.0666667,9.5170283,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.1,y:.15,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.9,y:.15,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"manual-input",category:"flowchart",width:118,height:60,textarea:{region:function(e,t){return{minX:4,minY:t*(2/7)+4,maxX:e-4,maxY:t-4}}},outline:{d:[["M",.8676336,15.6420323],["L",116.867634,.1512179],["C",117.415059,.0781139,117.918097,.4626272,117.991201,1.0100523],["C",117.99706,1.0539311,118,1.0981505,118,1.1424188],["L",118,59],["C",118,59.5522847,117.552285,60,117,60],["L",1,60],["C",.4477152,60,0,59.5522847,0,59],["L",0,16.6332332],["C",0,16.1321084,.3709182,15.7083644,.8676336,15.6420323],["Z"]]},scene:[],thumb:[{d:[["M",6.3471791,12.618128],["L",25.5471791,10.0603243],["C",25.7661584,10.0311521,25.9673249,10.1850212,25.9964971,10.4040005],["C",25.9988298,10.4215108,26,10.4391564,26,10.4568214],["L",26,21.2666667],["C",26,21.4875806,25.8209139,21.6666667,25.6,21.6666667],["L",6.4,21.6666667],["C",6.1790861,21.6666667,6,21.4875806,6,21.2666667],["L",6,13.0146251],["C",6,12.8141269,6.1484367,12.6446042,6.3471791,12.618128],["Z"]]}],anchors:[{x:.5,y:.195,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"manual-loop",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){var n=.14*e;return{minX:n,minY:4,maxX:e-n,maxY:t-4}}},outline:{d:[["M",1.3143594,0],["L",118.682087,0],["C",119.234371,-0,119.682087,.4477153,119.682087,1],["C",119.682087,1.0910107,119.669662,1.1815953,119.645158,1.2692451],["L",103.43015,59.2692451],["C",103.309369,59.7012703,102.915669,60,102.467078,60],["L",17.3668015,60],["C",16.917245,60,16.5229467,59.7000072,16.4030326,59.2667387],["L",.3505905,1.2667387],["C",.2032748,.7344638,.5153458,.1835468,1.0476207,.0362311],["C",1.1344943,.0121874,1.2242199,-0,1.3143594,0],["Z"]]},scene:[],thumb:[{d:[["M",6.5216709,11.0666667],["L",25.4769568,11.0666667],["C",25.6978707,11.0666667,25.8769568,11.2457528,25.8769568,11.4666667],["C",25.8769568,11.5020572,25.8722601,11.5372913,25.8629896,11.5714461],["L",22.8230148,22.7714461],["C",22.7757173,22.9457017,22.6175425,23.0666667,22.4369821,23.0666667],["L",9.5311679,23.0666667],["C",9.3502305,23.0666667,9.1918239,22.9452058,9.1448706,22.7704667],["L",6.1353736,11.5704667],["C",6.0780465,11.3571206,6.2045248,11.1376966,6.4178708,11.0803694],["C",6.451721,11.0712737,6.4866199,11.0666667,6.5216709,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:.1,y:.5,name:"W"},{x:.9,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.22,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.78,y:.985,name:"SE"}]},{name:"merge",category:"flowchart",width:50,height:36,textarea:{region:Vi},outline:{d:[["M",48.9094474,1.5703958],["L",25.82137,34.8172272],["C",25.5063491,35.2708574,24.883234299999998,35.3832223,24.4296042,35.0682014],["C",24.3316502,35.0001778,24.246653600000002,34.9151812,24.17863,34.8172272],["L",1.0905526000000005,1.5703958],["C",.7755317000000002,1.1167657,.8878967000000006,.4936509,1.3415268000000005,.17863],["C",1.5090014000000007,.0623282,1.7080259000000009,0,1.9119226000000005,0],["L",48.0880774,0],["C",48.6403621,0,49.0880774,.4477153,49.0880774,1],["C",49.0880774,1.2038967,49.0257492,1.4029212,48.9094474,1.5703958],["Z"]]},scene:[],thumb:[{d:[["M",25.5482177,9.6324953],["L",16.3254934,22.5443093],["C",16.1970898,22.7240743,15.9472698,22.765711,15.7675047,22.6373074],["C",15.7315865,22.6116515,15.7001625,22.5802275,15.6745066,22.5443093],["L",6.4517823,9.6324953],["C",6.3233787,9.4527302,6.3650154,9.2029102,6.5447805,9.0745066],["C",6.6126207,9.0260493,6.6939065,9,6.7772757,9],["L",25.2227243,9],["C",25.4436382,9,25.6227243,9.1790861,25.6227243,9.4],["C",25.6227243,9.4833692,25.596675,9.564655,25.5482177,9.6324953],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:0,name:"NW"},{x:0,y:1,name:"SW"},{x:1,y:0,name:"NE"},{x:1,y:1,name:"SE"}]},{name:"multi-document",category:"flowchart",isClip:!1,width:120,height:80,textarea:{region:function(e,t){return{minX:4,minY:.2*t,maxX:11/12*e-4,maxY:.8*t}}},outline:{d:[["M",119,-0],["C",119.552285,-0,120,.4477153,120,1],["L",120,57.6634711],["C",120.00004,58.2157781,119.552307,58.6635113,119,58.6635113],["C",118.846121,58.6635113,118.694318,58.6280008,118.556406,58.5597438],["C",117.079303,57.8286782,115.893834,57.3066398,115,56.9936286],["L",114.744,56.868],["L",114.744526,63.1694166],["C",114.744553,63.7217167,114.296826,64.1694445,113.744526,64.1694445],["C",113.610972,64.1694445,113.478771,64.1426929,113.355724,64.0907684],["C",111.834645,63.4488877,110.620494,62.9604303,109.71327,62.6253962],["L",109.714286,71.1461039],["C",109.714249,71.6983687,109.26655,72.1460677,108.714286,72.1460677],["C",108.59377,72.1460677,108.474247,72.1242823,108.361482,72.0817624],["C",98.4971172,68.3622546,89.1471649,66.4976545,80.3116246,66.4879622],["C",66.4538962,66.4727606,64.5535237,67.1669765,50.9091531,72.8467226],["C",37.2647825,78.5264687,35.3899142,79.3366596,21.5066816,79.351889],["C",12.4628087,79.3615937,5.4112062,77.2136321,.351874,72.9080041],["C",.1286374,72.7179927,0,72.4396044,0,72.1464509],["L",0,11.7804604],["C",0,11.2281757,.4477153,10.7804604,1,10.7804604],["L",5.255,10.78],["L",5.2554745,6.3902302],["C",5.2554745,5.8379455,5.7031897,5.3902302,6.2554745,5.3902302],["L",10.51,5.39],["L",10.5109489,1],["C",10.5109489,.4477153,10.9586642,-0,11.5109489,-0],["L",119,-0],["Z"]]},scene:[{d:[["M",10,5.3902302],["L",113.744526,5.3902302],["C",114.29681,5.3902302,114.744526,5.8379455,114.744526,6.3902302],["L",114.744526,61.6827625],["L",114.744526,61.6827625]],attr:{fill:"transparent"}},{d:[["M",3,10.7804604],["L",108.714286,10.7804604],["C",109.26657,10.7804604,109.714286,11.2281757,109.714286,11.7804604],["L",109.714286,69.602221],["L",109.714286,69.602221]],attr:{fill:"transparent"}}],thumb:[{d:[["M",8.4444444,10.4296499],["L",8.4444444,8],["L",28.4444444,8],["L",28.4444444,19.5606936],["C",28.0673004,19.4077004,26.2625497,18.3360173,25.8924529,18.2092979]]},{d:[["M",6.2222222,13.090719],["L",6.2222222,10.7555556],["L",25.4444444,10.7555556],["L",25.4444444,21.8666667],["C",25.0819671,21.7196232,23.3557041,21.1217914,23,21]]},{d:[["M",4.3333333,13.5111111],["L",22.3333333,13.5111111],["L",22.3333333,23.8011738],["C",20.6331063,23.1515551,19.0251483,22.8259361,17.5094592,22.824317],["C",15.2359257,22.8218883,14.9241458,22.9328011,12.6856163,23.8402371],["C",10.4470867,24.7476731,10.1394911,24.8771148,7.8617733,24.8795322],["C",6.3432947,24.8811295,5.1671481,24.5216767,4.3333333,23.8011738],["L",4.3333333,13.5111111],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:.88,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.08,y:.1,name:"NW"},{x:0,y:.91,name:"SW"},{x:.98,y:.02,name:"NE"},{x:.885,y:.91,name:"SE"}]},{name:"off-page",category:"flowchart",width:38,height:38,textarea:{region:Vi},outline:{d:[["M",.3999999999999986,0],["L",37.6,0],["C",37.8209139,0,38,.1790861,38,.4],["L",38,19.0323398],["C",38,19.1391572,37.9572763,19.2415374,37.8813478,19.3166695],["L",19.2813478,37.7216028],["C",19.125486199999997,37.8758298,18.874513800000003,37.8758298,18.7186522,37.7216028],["L",.11865219999999965,19.3166695],["C",.04272369999999981,19.2415374,0,19.1391572,0,19.0323398],["L",0,.4],["C",0,.1790861,.17908609999999925,0,.3999999999999986,0],["Z"]]},scene:[],thumb:[{d:[["M",8.4,8],["L",23.6,8],["C",23.8209139,8,24,8.1790861,24,8.4],["L",24,15.9169777],["C",24,16.0237952,23.9572763,16.1261753,23.8813478,16.2013075],["L",16.2813478,23.7216028],["C",16.1254862,23.8758298,15.8745138,23.8758298,15.7186522,23.7216028],["L",8.1186522,16.2013075],["C",8.0427237,16.1261753,8,16.0237952,8,15.9169777],["L",8,8.4],["C",8,8.1790861,8.1790861,8,8.4,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:0,name:"NW"},{x:1,y:0,name:"NE"}]},{name:"or",category:"flowchart",width:44,height:44,textarea:{region:Vi},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[{d:[{name:"M",x:0,y:21.5},{name:"L",x:44,y:21.5}]},{d:[{name:"M",x:21.5,y:0},{name:"L",x:21.5,y:44}]}],thumb:[{name:"ellipse",cx:16,cy:17,rx:9,ry:9},{d:[["M",7,17],["L",25,17],["M",16,8],["L",16,26]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"parallel",category:"flowchart",width:120,height:40,outline:{name:"rect",x:0,y:0,width:120,height:40,rx:0,ry:0,style:{visibility:"hidden"}},open:!0,scene:[{d:[{name:"M",x:120,y:40},{name:"L",x:0,y:40}]},{d:[{name:"M",x:0,y:0},{name:"L",x:120,y:0}]}],thumb:[{d:[["M",26,21],["L",6,21],["M",6,11],["L",26,11]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"polygon",width:96,height:91,outline:{name:"polygon",points:[{x:48,y:0},{x:95.5528258,y:34.5491503},{x:77.3892626,y:90.4508497},{x:18.6107374,y:90.4508497},{x:.44717419000000014,y:34.5491503}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:7},{x:24.5595086,y:13.2188471},{x:21.2900673,y:23.2811529},{x:10.7099327,y:23.2811529},{x:7.44049135,y:13.2188471}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"preparation",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:1/6*e,minY:4,maxX:5/6*e,maxY:t-4}}},outline:{d:[["M",19.9840694,0],["L",99.6873184,0],["C",100.023525,-0,100.33723,.1689467,100.522259,.4496594],["L",119.639798,29.4535248],["C",119.858585,29.7854538,119.859975,30.2154564,119.64334,30.5487937],["L",100.798808,59.5449283],["C",100.614349,59.8287556,100.298826,60,99.960325,60],["L",20.1720063,60],["C",19.83462,60,19.5199796,59.8298739,19.3352402,59.5475604],["L",.3565669,30.5448953],["C",.1398092,30.2136523,.1388534,29.7857253,.3541294,29.4535175],["L",19.1448658,.4561827],["C",19.3292042,.1717169,19.6450984,0,19.9840694,0],["Z"]]},scene:[],thumb:[{d:[["M",9.1753609,10],["L",22.7586938,10],["C",22.8919773,10,23.016505,10.0663866,23.0907953,10.1770457],["L",26.8513724,15.7786117],["C",26.9413749,15.912675,26.9419451,16.0877051,26.8528179,16.2223519],["L",23.1470284,21.8207859],["C",23.072951,21.9326965,22.9476882,22,22.8134814,22],["L",9.2130739,22],["C",9.0793157,22,8.9544098,21.9331428,8.8802274,21.8218405],["L",5.1471359,16.2207607],["C",5.057961,16.0869638,5.0575691,15.9127763,5.1461411,15.7785795],["L",8.8415196,10.1796593],["C",8.9155518,10.067492,9.0409649,10,9.1753609,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.26,y:.02,name:"NW"},{x:.26,y:.98,name:"SW"},{x:.74,y:.02,name:"NE"},{x:.74,y:.98,name:"SE"}]},{name:"process",category:"flowchart",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,10.5],["L",25.6,10.5],["C",25.8209139,10.5,26,10.6790861,26,10.9],["L",26,22.1],["C",26,22.3209139,25.8209139,22.5,25.6,22.5],["L",6.4,22.5],["C",6.1790861,22.5,6,22.3209139,6,22.1],["L",6,10.9],["C",6,10.6790861,6.1790861,10.5,6.4,10.5],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"sort",category:"flowchart",width:44,height:44,textarea:{region:Vi},outline:{d:[["M",22.707552999999997,.7084468],["L",43.2664758,21.2933397],["C",43.6564052,21.6837616,43.6564052,22.3162384,43.2664758,22.7066603],["L",22.707552999999997,43.2915532],["C",22.3172753,43.682324,21.6841104,43.6827236,21.293339699999997,43.2924459],["C",21.2930419,43.2921485,21.292744399999997,43.291851,21.292447000000003,43.2915532],["L",.7335241999999997,22.7066603],["C",.3435948,22.3162384,.3435948,21.6837616,.7335241999999997,21.2933397],["L",21.292447000000003,.7084468],["C",21.6827247,.317676,22.3158896,.3172764,22.706660300000003,.7075541],["C",22.7069581,.7078515,22.707255600000003,.708149,22.707552999999997,.7084468],["Z"]]},scene:[{d:[{name:"M",x:.1242938,y:22},{name:"L",x:43.8757062,y:22}]}],thumb:[{d:[["M",16.2830212,7.2833787],["L",24.706338,15.7173359],["C",24.8623098,15.8735046,24.8623098,16.1264954,24.706338,16.2826641],["L",16.2830212,24.7166213],["C",16.1269101,24.8729296,15.8736442,24.8730894,15.7173359,24.7169784],["C",15.7172168,24.7168594,15.7170978,24.7167404,15.7169788,24.7166213],["L",7.293662,16.2826641],["C",7.1376902,16.1264954,7.1376902,15.8735046,7.293662,15.7173359],["L",15.7169788,7.2833787],["C",15.8730899,7.1270704,16.1263558,7.1269106,16.2826641,7.2830216],["C",16.2827832,7.2831406,16.2829022,7.2832596,16.2830212,7.2833787],["Z"],["M",7.3175141,15.7333333],["L",25.2158192,15.7333333]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"start-end",category:"flowchart",width:120,height:60,outline:{path:function(e,t){return Wi(e,t,Math.min(e,t)/2)}},scene:[],thumb:[{d:[["M",11,10],["L",21,10],["C",24.3137085,10,27,12.6862915,27,16],["C",27,19.3137085,24.3137085,22,21,22],["L",11,22],["C",7.6862915,22,5,19.3137085,5,16],["C",5,12.6862915,7.6862915,10,11,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.11,y:.11,name:"NW"},{x:.11,y:.89,name:"SW"},{x:.89,y:.11,name:"NE"},{x:.89,y:.89,name:"SE"}]},{name:"stored-data",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:1/12*e,minY:4,maxX:e-1*e/8,maxY:t-4}}},outline:{d:[["M",13.7777709,0],["L",120,0],["C",111.115006,4.7754794,106.672509,14.7754794,106.672509,30],["C",106.672509,44.2961128,111.115006,54.2961128,120,60],["L",13.7777709,60],["C",4.2600422,53.6223342,-.3265282,43.6223342,.0180598,30],["C",.4106176,14.4813071,4.997188,4.4813072,13.7777709,0],["Z"]]},scene:[],thumb:[{d:[["M",7.7592332,10],["L",26.7592332,10],["C",24.3123052,10.9550959,23.0888412,12.9550959,23.0888412,16],["C",23.0888412,18.8592226,24.3123052,20.8592226,26.7592332,22],["L",7.7592332,22],["C",5.853146,20.7244668,4.9346072,18.7244668,5.0036168,16],["C",5.0822332,12.8962614,6.000772,10.8962614,7.7592332,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:.93,y:.5,name:"E"},{x:.1,y:0,name:"NW"},{x:.1,y:1,name:"SW"},{x:.995,y:.01,name:"NE"},{x:.995,y:.99,name:"SE"}]},{name:"subroutine",category:"flowchart",width:120,height:60,textarea:{region:function(e,t){return{minX:.08*e+4,minY:4,maxX:.92*e-4,maxY:t-4}}},outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[{d:[{name:"M",x:8,y:-0},{name:"L",x:8,y:60}]},{d:[{name:"M",x:112,y:-0},{name:"L",x:112,y:60}]}],thumb:[{d:[["M",6.4,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,10.4],["C",6,10.1790861,6.1790861,10,6.4,10],["Z"],["M",10,10],["L",10,22],["M",22,10],["L",22,22]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"summing-junction",category:"flowchart",width:44,height:44,textarea:{region:Vi},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[{d:[["M",6.44365,6.44365],["l",31.1127,31.1127],["m",-31.1127,0],["l",31.1127,-31.1127]]}],thumb:[{name:"ellipse",cx:16,cy:17,rx:9,ry:9},{d:[["M",9.636,10.636],["l",12.727922,12.727922],["m",0,-12.727922],["l",-12.727922,12.727922]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"hard-disk",category:"flowchart",width:120,height:60,outline:{d:[["M",15,60],["L",14.7519476,59.9959809],["C",9.2781402,59.818482,4.5170854,53.7768783,1.9708869,44.875377],["L",1.7488298,44.0706625],["L",1.7488298,44.0706625],["L",1.538854,43.2511373],["C",.5535534,39.2550784,0,34.7568286,0,30],["C",0,27.0176624,.2175896,24.1369663,.6227504,21.4179485],["L",.76471,20.5176797],["C",.9879463,19.1765057,1.2572417,17.8774189,1.5688436,16.627924],["L",1.7828048,15.8023567],["C",1.892878,15.3933289,2.0075593,14.9899966,2.1267097,14.5926377],["L",2.3709282,13.805967],["C",4.9969253,5.6312819,9.5529446,.172607,14.7519476,.0040191],["L",15.0621025,0],["L",15.0621025,0],["L",105,0],["L",105.248052,.0040191],["C",110.72186,.181518,115.482915,6.2231217,118.029113,15.124623],["L",118.25117,15.9293375],["L",118.25117,15.9293375],["L",118.461146,16.7488627],["C",119.446447,20.7449216,120,25.2431714,120,30],["C",120,32.9823376,119.78241,35.8630337,119.37725,38.5820515],["L",119.23529,39.4823203],["C",119.012054,40.8234943,118.742758,42.1225811,118.431156,43.372076],["L",118.217195,44.1976433],["C",118.107122,44.6066711,117.992441,45.0100034,117.87329,45.4073623],["L",117.629072,46.194033],["C",115.003075,54.3687181,110.447055,59.827393,105.248052,59.9959809],["L",105,60],["L",15,60],["Z"]]},scene:[{d:[["M",105,0],["C",96.7157288,0,90,13.4314575,90,30],["C",90,46.5685425,96.7157288,60,105,60]],attr:{fill:"transparent"}}],thumb:[{d:[["M",26,16],["C",26,19.7950693,24.6815015,22.8847632,23.0365121,22.9968505],["L",23.0365572,22.9990622],["L",9.005513,22.9990622],["C",7.3410124,22.9372467,6,19.8273333,6,16],["C",6,12.21094,7.3143262,9.1250233,8.955676,9.0037044],["L",9.005513,9.0009378],["L",23.0365572,9],["L",23.0365121,9.0031495],["C",24.6815015,9.1152368,26,12.2049307,26,16],["Z"]]},{d:[["M",22.6666667,23],["C",21.4393672,23,20.4444444,19.8659932,20.4444444,16],["C",20.4444444,12.1726667,21.4195683,9.0627533,22.6299182,9.0009378],["L",22.6666667,9]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"annotation",category:"flowchart",width:160,height:100,outline:{name:"rect",x:0,y:0,width:160,height:100,rx:0,ry:0,style:{visibility:"hidden"}},open:!0,scene:[{d:[["M",12,0],["L",2,0],["C",.8954305,0,0,.8954305,0,2],["L",0,98],["C",0,99.1045695,1.8954305,100,2,100],["L",12,100],["L",12,100]],attr:{fill:"transparent"}}],thumb:[{d:[["M",14,25],["L",8.4,25],["C",8.1790861,25,8,24.8209139,8,24.6],["L",8,7.4],["C",8,7.1790861,8.1790861,7,8.4,7],["L",14,7]],attr:{fill:"transparent"}},{d:[["M",15,12.4],["L",23,12.4],["M",15,19.6],["L",20,19.6],["M",15,16],["L",25,16]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"paper-tape",category:"flowchart",width:120,height:60,outline:{d:[["M",1.5222953,.9815615],["C",9.1503953,5.6605205,18.6431804,8,30.0006506,8],["C",48.1891811,8,72,0,90,0],["C",101.772949,0,111.620866,2.5667099,119.54375,7.7001296],["C",119.827781,7.8834886,119.999272,8.1983049,120,8.536377],["L",120,58.1813965],["C",119.99868,58.7336797,119.549899,59.1803262,118.997616,59.1790094],["C",118.81486,59.1785736,118.635719,59.1280638,118.479584,59.0330812],["C",110.744659,54.3443604,101.251465,52,90,52],["C",72,52,47.9802124,60,30.0006506,60],["C",18.2410691,60,8.3931965,57.4332901,.4570327,52.2998704],["C",.1725566,52.1168331,7995e-7,51.8018948,0,51.463623],["L",0,1.8312988],["C",.0011011,1.2790152,.4497064,.8321918,1.0019901,.8332909],["C",1.1858393,.8336568,1.3660294,.8846988,1.5222953,.9815615],["Z"]]},scene:[],thumb:[{d:[["M",6.6474214,9.5811114],["C",7.8470102,10.5270371,9.2979179,11,11.0001446,11],["C",14.0315882,11,18.0555691,9,21.0153944,9],["C",22.9279117,9,24.5476734,9.6262819,25.8746796,10.8788457],["C",25.9544319,10.953493,25.9996109,11.0577585,26.0001446,11.1669922],["L",26.0001446,22.1123047],["C",25.9985502,22.3332128,25.8181845,22.5110102,25.5972763,22.5094261],["C",25.5080849,22.5087865,25.421666,22.4783549,25.3523768,22.4221807],["C",24.1466821,21.4740602,22.7041694,21,21.0248386,21],["C",18.037633,21,13.9967599,23,11.0001446,23],["C",9.0638551,23,7.4385415,22.3737181,6.1242038,21.1211543],["C",6.0451563,21.0461214,6.0003506,20.9419953,6,20.8330078],["L",6,9.8935547],["C",6.000786,9.6726422,6.1805061,9.4941923,6.4014186,9.4949758],["C",6.4907774,9.4952927,6.5774568,9.5255221,6.6474214,9.5811114],["Z"]]}],anchors:[{x:.5,y:.09,name:"N"},{x:.5,y:.91,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:.09,name:"NW"},{x:0,y:.91,name:"SW"},{x:1,y:.09,name:"NE"},{x:1,y:.91,name:"SE"}]},{name:"card",category:"flowchart",width:120,height:60,outline:{d:[["M",17.119717,0],["L",119,0],["C",119.552285,-0,120,.4477153,120,1],["L",120,59],["C",120,59.5522847,119.552285,60,119,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,20.1542151],["C",0,19.9186136,.0831857,19.6905777,.2348891,19.5103165],["L",16.3546062,.3561015],["C",16.5446112,.1303284,16.8246316,-0,17.119717,0],["Z"]]},scene:[],thumb:[{d:[["M",9.5170283,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,14.1038014],["C",6,14.0095609,6.0332743,13.9183465,6.0939556,13.846242],["L",9.210984,10.1424406],["C",9.286986,10.0521313,9.3989942,10,9.5170283,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.1,y:.16,name:"NW"},{x:.015,y:.98,name:"SW"},{x:.985,y:.02,name:"NE"},{x:.985,y:.98,name:"SE"}]}],Ko=1/6*Math.PI,Qo=20*Math.tan(Ko),Jo=12;function $o(e,t){return{d:Qo>e?0:Qo,titleHeight:20>t?t:20}}var ec=[{name:"frame",width:500,height:400,html:'<div style="text-align:left;">&nbsp;</div>',textarea:{region:function(e,t){return{minX:4,minY:4,maxX:.4*e-(10<e?10:0),maxY:(30<t?30:t)-4}}},outline:{path:function(e,t){return Wi(e,t,4)}},scene:[{path:function(e,t){var n,r,a=.4*e,i=10<e?10:0;return 30<t?(n=30,r=16):(n=t,r=0),[["M",0,n],["l",a-i,0],["l",i,-r],["L",a,0]]},attr:{fill:"none"}}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",6,12],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["L",16.5337171,9],["C",16.697486400000003,9,16.8447125,9.0998297,16.9053186,9.251971900000001],["L",18,12],["L",18,12],["L",6,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"package",category:"UML",isClip:!1,width:120,height:80,textarea:{region:function(e,t){return{minX:4,minY:$o(e,t).titleHeight+4,maxX:e-4,maxY:t-4}}},outline:{path:function(e,t){var n=.6*e,r=$o(e,t),a=r.d,i=r.titleHeight,o=e/2,c=t>i?t/2:0,l=o<4?o:4,s=c<4?c:4;return[["M",l,0],["l",n,0],["l",a-l,i],["L",e-l,i],["a",l,s,0,0,1,l,s],["L",e,t-s],["a",l,s,0,0,1,-l,s],["L",l,t],["a",l,s,0,0,1,-l,-s],["L",0,s],["a",l,s,0,0,1,l,-s],["Z"]]}},scene:[{path:function(e,t){var n=.6*e,r=$o(e,t),a=r.d;return[["M",0,r.titleHeight],["l",n+a,0]]}}],thumb:[{d:[["M",6,11],["L",25.6,11],["C",25.8209139,11,26,11.1790861,26,11.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,11],["L",6,11],["Z"]]},{d:[["M",6,11],["L",6,8.9],["C",6,8.6790861,6.1790861,8.5,6.4,8.5],["L",14.7328929,8.5],["C",14.8966622,8.5,15.0438883,8.5998297,15.1044944,8.751971900000001],["L",16,11],["L",16,11],["L",6,11],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"activation",category:"UML",width:20,height:80,textarea:{region:Vi},outline:{name:"rect",x:0,y:0,width:20,height:80,rx:4,ry:4},scene:[],thumb:[{d:[["M",19,6.4],["L",19,25.6],["C",19,25.8209139,18.8209139,26,18.6,26],["L",13.4,26],["C",13.1790861,26,13,25.8209139,13,25.6],["L",13,6.4],["C",13,6.1790861,13.1790861,6,13.4,6],["L",18.6,6],["C",18.8209139,6,19,6.1790861,19,6.4],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"actor",category:"UML",width:40,height:80,isClip:!1,closed:!1,textarea:{region:Vi},outline:{d:[["M",20,20],["C",25.5228475,20,30,15.5228475,30,10],["C",30,4.4771525,25.5228475,0,20,0],["C",14.4771525,0,10,4.4771525,10,10],["C",10,15.5228475,14.4771525,20,20,20],["Z"],["M",0,35],["L",40,35],["M",20,20],["L",20,52],["M",20,52],["L",0,80],["M",20,52],["L",40,80]]},scene:[{name:"rect",x:0,y:0,width:40,height:80,attr:{fill:"transparent",stroke:"transparent"}}],thumb:[{d:[["M",16,13],["C",17.9329966,13,19.5,11.4329966,19.5,9.5],["C",19.5,7.5670034,17.9329966,6,16,6],["C",14.0670034,6,12.5,7.5670034,12.5,9.5],["C",12.5,11.4329966,14.0670034,13,16,13],["Z"],["M",11,16],["L",21,16],["M",16,19],["L",11,26],["M",16,19],["L",21,26],["M",16,13],["L",16,19]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.4375,name:"W"},{x:1,y:.4375,name:"E"}]},{name:"annotation",category:"UML",width:159,height:100,outline:{name:"rect",x:0,y:0,width:160,height:100,rx:0,ry:0},scene:[{d:[["M",2,0],["L",10,0],["C",11.1045695,-0,12,.8954305,12,2],["L",12,98],["C",12,99.1045695,11.1045695,100,10,100],["L",0,100],["L",0,100]]}],thumb:[{d:[["M",14,25],["L",8.4,25],["C",8.1790861,25,8,24.8209139,8,24.6],["L",8,7.4],["C",8,7.1790861,8.1790861,7,8.4,7],["L",14,7]]},{d:[["M",20.6,18.8],["C",20.8209139,18.8,21,18.9790861,21,19.2],["L",21,20],["C",21,20.2209139,20.8209139,20.4,20.6,20.4],["L",15.4,20.4],["C",15.1790861,20.4,15,20.2209139,15,20],["L",15,19.2],["C",15,18.9790861,15.1790861,18.8,15.4,18.8],["L",20.6,18.8],["Z"],["M",25.6,15.2],["C",25.8209139,15.2,26,15.3790861,26,15.6],["L",26,16.4],["C",26,16.6209139,25.8209139,16.8,25.6,16.8],["L",15.4,16.8],["C",15.1790861,16.8,15,16.6209139,15,16.4],["L",15,15.6],["C",15,15.3790861,15.1790861,15.2,15.4,15.2],["L",25.6,15.2],["Z"],["M",23.6,11.6],["C",23.8209139,11.6,24,11.7790861,24,12],["L",24,12.8],["C",24,13.0209139,23.8209139,13.2,23.6,13.2],["L",15.4,13.2],["C",15.1790861,13.2,15,13.0209139,15,12.8],["L",15,12],["C",15,11.7790861,15.1790861,11.6,15.4,11.6],["L",23.6,11.6],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"boundary",category:"UML",width:70,height:50,isClip:!1,textarea:{region:Vi},outline:{d:[["M",45,50],["C",58.8071187,50,70,38.8071187,70,25],["C",70,11.1928813,58.8071187,0,45,0],["C",31.1928813,0,20,11.1928813,20,25],["C",20,38.8071187,31.1928813,50,45,50],["Z"],["M",-0,0],["L",0,50],["M",0,25],["L",20,25]]},scene:[],thumb:[{d:[["M",19,22],["C",22.3137085,22,25,19.3137085,25,16],["C",25,12.6862915,22.3137085,10,19,10],["C",15.6862915,10,13,12.6862915,13,16],["C",13,19.3137085,15.6862915,22,19,22],["Z"],["M",8,16],["L",13,16],["M",7.5,10],["L",7.5,22]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"choice",width:40,height:40,textarea:{region:Vi},outline:{d:[["M",22.1213203,.9081169],["L",39.0918831,17.8786797],["C",40.263456,19.0502525,40.263456,20.9497475,39.0918831,22.1213203],["L",22.1213203,39.0918831],["C",20.9497475,40.263456,19.0502525,40.263456,17.8786797,39.0918831],["L",.9081169,22.1213203],["C",-.263456,20.9497475,-.263456,19.0502525,.9081169,17.8786797],["L",17.8786797,.9081169],["C",19.0502525,-.263456,20.9497475,-.263456,22.1213203,.9081169],["Z"]]},scene:[],thumb:[{d:[["M",16.219338,9.0908528],["L",22.9091472,15.780662],["C",23.0302843,15.901799,23.0302843,16.098201,22.9091472,16.219338],["L",16.219338,22.9091472],["C",16.098201,23.0302843,15.901799,23.0302843,15.780662,22.9091472],["L",9.0908528,16.219338],["C",8.9697157,16.098201,8.9697157,15.901799,9.0908528,15.780662],["L",15.780662,9.0908528],["C",15.901799,8.9697157,16.098201,8.9697157,16.219338,9.0908528],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"control",category:"UML",width:50,height:55,isClip:!1,textarea:{region:Vi},outline:{d:[["M",25,55],["C",38.8071187,55,50,43.8071187,50,30],["C",50,16.1928813,38.8071187,5,25,5],["C",11.1928813,5,0,16.1928813,0,30],["C",0,43.8071187,11.1928813,55,25,55],["Z"],["M",24,4.9497475],["L",28.9497475,0]]},scene:[{d:[{name:"M",x:28.9497475,y:9.8994949},{name:"L",x:24,y:4.9497475}]}],thumb:[{d:[["M",16,22],["C",19.3137085,22,22,19.3137085,22,16],["C",22,12.6862915,19.3137085,10,16,10],["C",12.6862915,10,10,12.6862915,10,16],["C",10,19.3137085,12.6862915,22,16,22],["Z"],["M",15,10.1213203],["L",17.1213203,8],["M",17.1213203,12.2426407],["L",15,10.1213203]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"deletion",category:"UML",width:40,height:40,isClip:!1,closed:!1,textarea:{region:Vi},outline:{d:[["M",0,0],["L",40,40],["M",40,0],["L",0,40]],attr:{stroke:{width:4}}},scene:[],thumb:[{d:[["M",9.3534503,9.3534503],["L",22.6465497,22.6465497],["M",22.6465497,9.3534503],["L",9.3534503,22.6465497]],attr:{"stroke-width":2}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"finish",category:"UML",width:42,height:42,textarea:{region:Vi},outline:{name:"ellipse",cx:21,cy:21,rx:21,ry:21,attr:{stroke:{color:"#595959",width:4.2}}},scene:[{name:"ellipse",cx:21,cy:21,rx:12,ry:12,attr:{fill:"#595959"}}],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7,attr:{stroke:"#595959","stroke-width":1.2}},{name:"ellipse",cx:16,cy:16,rx:5,ry:5,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"fork",category:"UML",width:120,height:20,outline:{name:"rect",x:0,y:0,width:120,height:20,rx:4,ry:4,attr:{fill:{color:"#595959"}}},scene:[],thumb:[{name:"rect",x:6,y:14,width:20,height:4,rx:1,ry:1,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"frequency",category:"UML",textarea:{region:Vi},width:44,height:36,outline:{d:[["M",42.7122245,0],["C",42.8304828,0,42.9426798,.0523287,43.0186811,.1429312],["C",43.1606563,.3121825,43.1385446,.5644814,42.9692933,.7064566],["L",42.9692933,.7064566],["L",22.353,18],["L",42.9692933,35.2935434],["C",43.0417753,35.3543444,43.0897621,35.4383107,43.1060575,35.5300135],["L",43.1122245,35.6],["C",43.1122245,35.8209139,42.9331384,36,42.7122245,36],["L",42.7122245,36],["L",1.2877755,36],["C",1.1695172,36,1.0573202,35.9476713,.9813189,35.8570688],["C",.8393436999999999,35.6878175,.8614554000000001,35.4355186,1.0307067,35.2935434],["L",1.0307067,35.2935434],["L",21.646,17.999],["L",1.0307067,.7064566],["C",.9582246999999999,.6456556,.9102379,.5616893,.8939425000000001,.4699865],["L",.8877755,.4],["C",.8877755,.1790861,1.0668616,0,1.2877755,0],["L",1.2877755,0],["Z"]]},scene:[],thumb:[{d:[["M",23.6012174,9],["C",23.7214126,9,23.8352365,9.0540492,23.9112011,9.1471955],["C",24.0508212,9.3183948,24.0252212,9.5703637,23.8540219,9.7099837],["L",23.8540219,9.7099837],["L",16.142,16],["L",23.8540219,22.2900163],["C",23.928539,22.350788,23.9780339,22.4357897,23.9948511,22.5288994],["L",24.0012174,22.6],["C",24.0012174,22.8209139,23.8221313,23,23.6012174,23],["L",23.6012174,23],["L",8.3987826,23],["C",8.2785874,23,8.1647635,22.9459508,8.0887989,22.8528045],["C",7.9491788,22.6816052,7.9747788,22.4296364,8.1459781,22.2900163],["L",8.1459781,22.2900163],["L",15.858,16],["L",8.1459781,9.7099837],["C",8.071461,9.649212,8.0219661,9.5642103,8.0051489,9.4711006],["L",7.9987826,9.4],["C",7.9987826,9.1790861,8.1778687,9,8.3987826,9],["L",8.3987826,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0},{x:.5,y:1}]},{name:"node",category:"UML",width:240,height:240,textarea:{region:function(e,t){return{minX:4,minY:1/11*t+4,maxX:10/11*e-4,maxY:t-4}}},outline:{d:[["M",0,239],["L",0,20.4142136],["C",0,20.1489971,.1053568,19.8946432,.2928932,19.7071068],["L",19.7071068,.2928932],["C",19.8946432,.1053568,20.1489971,0,20.4142136,0],["L",239,0],["C",239.552285,-0,240,.4477153,240,1],["L",240,219.585786],["C",240,219.851003,239.894643,220.105357,239.707107,220.292893],["L",220.292893,239.707107],["C",220.105357,239.894643,219.851003,240,219.585786,240],["L",1,240],["C",.4477153,240,0,239.552285,0,239],["Z"]]},scene:[{name:"polygon",points:[{x:20,y:0},{x:240,y:0},{x:220,y:20},{x:0,y:20}],attr:{fill:"rgba(0,0,0,0.1)"}},{name:"polygon",points:[{x:220,y:20},{x:220,y:240},{x:240,y:220},{x:240,y:6123234e-22}],attr:{fill:"rgba(0,0,0,0.1)"}}],thumb:[{d:[["M",8,10],["L",22,10],["L",22,24],["L",8.4,24],["C",8.1790861,24,8,23.8209139,8,23.6],["L",8,10],["L",8,10],["Z"]]},{d:[["M",8,10],["L",9.9481766,8.1127039],["C",10.0227934,8.0404189,10.122606300000001,8,10.2264947,8],["L",24,8],["L",24,8],["L",22.4516129,10]]},{d:[["M",22,24],["L",23.8872961,22.0518234],["C",23.9595811,21.977206600000002,24,21.8773937,24,21.7735053],["L",24,8],["L",24,8]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"object",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,10.4],["C",6,10.1790861,6.1790861,10,6.4,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"receive-signal",category:"UML",width:139,height:60,textarea:{region:function(e,t){return{minX:.18*e+4,minY:4,maxX:e-4,maxY:t-4}}},outline:{d:[["M",138,0],["L",1.1350416,0],["C",.5827568999999999,0,.1350416000000001,.4477153,.1350416000000001,1],["C",.1350416000000001,1.2339365,.21705780000000008,1.4604694,.3668203000000001,1.6401844],["L",23.466513,29.3598156],["C",23.7755513,29.7306616,23.7755513,30.2693384,23.466513,30.6401844],["L",.3668203000000001,58.3598156],["C",.01325630000000011,58.7840925,.07058030000000004,59.4146572,.4948572,59.7682213],["C",.6745722000000001,59.9179838,.9011051000000001,60,1.1350416,60],["L",138,60],["C",138.552285,60,139,59.5522847,139,59],["L",139,1],["C",139,.4477153,138.552285,0,138,0],["Z"]]},scene:[],thumb:[{d:[["M",25.6,20],["L",6.9656854,20],["C",6.7447715,20,6.5656854,19.8209139,6.5656854,19.6],["C",6.5656854,19.4939134,6.6078282,19.3921718,6.6828427,19.3171573],["L",9.7171573,16.2828427],["C",9.873367,16.126633,9.873367,15.873367,9.7171573,15.7171573],["L",6.6828427,12.6828427],["C",6.526633,12.526633,6.526633,12.273367,6.6828427,12.1171573],["C",6.7578573,12.0421427,6.8595988,12,6.9656854,12],["L",25.6,12],["C",25.8209139,12,26,12.1790861,26,12.4],["L",26,19.6],["C",26,19.8209139,25.8209139,20,25.6,20],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"send-signal",category:"UML",width:140,height:60,textarea:{region:function(e,t){return{minX:4,minY:4,maxX:e-.18*e-4,maxY:t-4}}},outline:{d:[["M",1,0],["L",114.531625,0],["C",114.828405,0,115.109853,.131823,115.299846,.3598156],["L",139.466513,29.3598156],["C",139.775551,29.7306616,139.775551,30.2693384,139.466513,30.6401844],["L",115.299846,59.6401844],["C",115.109853,59.868177,114.828405,60,114.531625,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6.4,12],["L",21.8343146,12],["C",21.9404012,12,22.0421427,12.0421427,22.1171573,12.1171573],["L",26,16],["L",26,16],["L",22.1171573,19.8828427],["C",22.0421427,19.9578573,21.9404012,20,21.8343146,20],["L",6.4,20],["C",6.1790861,20,6,19.8209139,6,19.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"simple-class",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:4,ry:4},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"start",width:40,height:40,textarea:{region:Vi},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20,attr:{fill:{color:"#595959"}}},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"state",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:12,ry:12},scene:[],thumb:[{d:[["M",8,10],["L",24,10],["C",25.1045695,10,26,10.8954305,26,12],["L",26,20],["C",26,21.1045695,25.1045695,22,24,22],["L",8,22],["C",6.8954305,22,6,21.1045695,6,20],["L",6,12],["C",6,10.8954305,6.8954305,10,8,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"termination-pseudostate",category:"UML",width:40,height:40,textarea:{region:Vi},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20},scene:[{d:[["M",5.7142857,5.7142857],["C",5.7142857,5.7142857,15.2380952,15.2380952,34.2857143,34.2857143],["M",34.2857143,5.7142857],["L",5.7142857,34.2857143]]}],thumb:[{d:[["M",16,23],["C",19.8659932,23,23,19.8659932,23,16],["C",23,12.1340068,19.8659932,9,16,9],["C",12.1340068,9,9,12.1340068,9,16],["C",9,19.8659932,12.1340068,23,16,23],["Z"],["M",11,11],["C",11,11,14.3333333,14.3333333,21,21],["M",21,11],["L",11,21]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"use-case",category:"UML",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"class",category:"UML",type:"stack",width:280,height:200,row:3,heights:[40,80,80],outline:{path:function(e,t){return Wi(e,t,8)}},scene:[{d:[["M",0,40],["L",280,40]],height:40},{d:[["M",0,120],["L",280,120]],height:120}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:6,y:12},{name:"L",x:26,y:12}]},{d:[{name:"M",x:6,y:17.5},{name:"L",x:26,y:17.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Class</span></div>','<div style="text-align:left;">+ attribute1:type = defaultValue</div>\n      <div style="text-align:left;">+ attribute2:type</div>\n      <div style="text-align:left;">- attribute3:type</div>','<div style="text-align:left;">+ operation1(params):returnType</div>\n      <div style="text-align:left;">- operation2(params)</div>\n      <div style="text-align:left;">- operation3()</div>']},{name:"interface",type:"stack",width:280,height:200,row:2,heights:[64,90],outline:{path:function(e,t){return Wi(e,t,8)}},scene:[{d:[["M",0,64],["L",280,64]],height:64}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:6,y:16},{name:"L",x:26,y:16}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],htmls:['<div style="text-align:center;"><span style="font-weight:bold;">&lt;&lt;interface&gt;&gt;</span></div>\n      <div style="text-align:center;">Interface</div>','<div style="text-align:left;">+ operation1(params):returnType</div>\n      <div style="text-align:left;">- operation2(params)</div>\n      <div style="text-align:left;">- operation3()</div>'],category:"UML"},{name:"constraint",width:120,height:50,textarea:{region:function(e,t){var n=.1*e,r=16/380*t;return{minX:n+4,minY:r,maxX:e-n-4,maxY:t-r}}},outline:{name:"rect",x:0,y:0,width:120,height:50,rx:0,ry:0,style:{visibility:"hidden"}},scene:[{d:[["M",11,2],["L",10,2],["C",7.790861,2,6,3.790861,6,6],["L",6,19.9098301],["C",6,21.8036903,4.9299881,23.5350059,3.236068,24.381966],["L",1,25],["L",3.236068,25.618034],["C",4.9299881,26.4649941,6,28.1963097,6,30.0901699],["L",6,44],["C",6,46.209139,7.790861,48,10,48],["L",11,48]],attr:{fill:"transparent"}},{d:[["M",109,2],["L",110,2],["C",112.209139,2,114,3.790861,114,6],["L",114,19.9098301],["C",114,21.8036903,115.070012,23.5350059,116.763932,24.381966],["L",119,25],["L",116.763932,25.618034],["C",115.070012,26.4649941,114,28.1963097,114,30.0901699],["L",114,44],["C",114,46.209139,112.209139,48,110,48],["L",109,48]],attr:{fill:"transparent"}}],thumb:[{d:[["M",11,8],["L",11,9.0792291],["L",10.0378007,9.0792291],["L",9.9004779,9.0841809],["C",9.2360127,9.1336991,8.9037801,9.5546039,8.9037801,10.3468951],["L",8.9037801,10.3468951],["L",8.9037801,13.9100642],["L",8.8982764,14.0989026],["C",8.8432399,15.0236884,8.3754296,15.6573876,7.4948454,16],["C",8.4341352,16.3768737,8.9037801,17.0735189,8.9037801,18.0899358],["L",8.9037801,18.0899358],["L",8.9037801,21.6702355],["L",8.9082098,21.8216676],["C",8.9525075,22.5544031,9.3290378,22.9207709,10.0378007,22.9207709],["L",10.0378007,22.9207709],["L",11,22.9207709],["L",11,24],["L",9.814433,24],["L",9.6063574,23.9933191],["C",8.997079,23.9532334,8.5223368,23.7327623,8.1821306,23.3319058],["C",7.8155785,22.9321913,7.6323024,22.3668808,7.6323024,21.6359743],["L",7.6323024,21.6359743],["L",7.6323024,18.1413276],["L",7.6272015,17.9587794],["C",7.6033971,17.5465739,7.4962772,17.2305496,7.3058419,17.0107066],["C",7.0652921,16.7366167,6.6300114,16.5881513,6,16.5653105],["L",6,16.5653105],["L",6,15.4346895],["L",6.2061856,15.4190393],["C",6.7356497,15.366026,7.1022019,15.2227774,7.3058419,14.9892934],["C",7.5234823,14.7380443,7.6323024,14.3611706,7.6323024,13.8586724],["L",7.6323024,13.8586724],["L",7.6323024,10.3811563],["L",7.6378007,10.1635974],["C",7.6707904,9.5263383,7.8522337,9.0278373,8.1821306,8.6680942],["C",8.5601375,8.2226981,9.1042383,8,9.814433,8],["L",9.814433,8],["L",11,8],["Z"],["M",22.185567,8],["C",22.8957617,8,23.4398625,8.2226981,23.8178694,8.6680942],["C",24.1477663,9.0278373,24.3292096,9.5263383,24.3621993,10.1635974],["L",24.3676976,10.3811563],["L",24.3676976,13.8586724],["C",24.3676976,14.3611706,24.4765178,14.7380443,24.6941581,14.9892934],["C",24.8977981,15.2227774,25.2643503,15.366026,25.7938144,15.4190393],["L",26,15.4346895],["L",26,16.5653105],["C",25.3699885,16.5881513,24.9347079,16.7366167,24.6941581,17.0107066],["C",24.5037228,17.2305496,24.3966029,17.5465739,24.3727985,17.9587794],["L",24.3676976,18.1413276],["L",24.3676976,21.6359743],["C",24.3676976,22.3668808,24.1844215,22.9321913,23.8178694,23.3319058],["C",23.4776632,23.7327623,23.002921,23.9532334,22.3936426,23.9933191],["L",22.185567,24],["L",21,24],["L",21,22.9207709],["L",21.9621993,22.9207709],["C",22.6709622,22.9207709,23.0474925,22.5544031,23.0917902,21.8216676],["L",23.0962199,21.6702355],["L",23.0962199,18.0899358],["C",23.0962199,17.0735189,23.5658648,16.3768737,24.5051546,16],["C",23.6245704,15.6573876,23.1567601,15.0236884,23.1017236,14.0989026],["L",23.0962199,13.9100642],["L",23.0962199,10.3468951],["C",23.0962199,9.5546039,22.7639873,9.1336991,22.0995221,9.0841809],["L",21.9621993,9.0792291],["L",21,9.0792291],["L",21,8],["L",22.185567,8],["Z"]],attr:{fill:"#595959","stroke-width":0}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"activity-class",width:120,height:60,textarea:{region:function(e,t){var n=.128*e;return{minX:n+4,minY:4,maxX:e-n-4,maxY:t-4}}},outline:{name:"rect",x:0,y:0,width:120,height:60,rx:4,ry:4},scene:[{d:[["M",105,0],["L",105,60],["M",15,60],["L",15,0]]}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:9,y:9},{name:"L",x:9,y:23}]},{d:[{name:"M",x:23,y:9},{name:"L",x:23,y:23}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"component",width:120,height:80,isClip:!1,textarea:{region:function(e,t){return{minX:28,minY:4,maxX:e-4,maxY:t-4}}},outline:{path:function(e,t){var n=e-12,r=(n-12)/2,a=t/2,i=r<4?r:4,o=a<4?a:4,c=2,l=14;if(t<80){var s=t/80;return[["M",+i+12,0],["l",n-2*i,0],["a",i,o,0,0,1,i,o],["l",0,t-2*o],["a",i,o,0,0,1,-i,o],["l",2*i-n,0],["a",i,o,0,0,1,-i,-o],["l",0,o-(l*=s)],["l",(c*=s)-Jo,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",Jo-c,0],["l",0,-24*s],["l",c-Jo,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",Jo-c,0],["l",0,o-l],["a",i,o,0,0,1,i,-o],["z"]]}return[["M",+i+12,0],["l",n-2*i,0],["a",i,o,0,0,1,i,o],["l",0,t-2*o],["a",i,o,0,0,1,-i,o],["l",2*i-n,0],["a",i,o,0,0,1,-i,-o],["l",0,-(t-o-(80-l))],["l",c-Jo,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",Jo-c,0],["l",0,-(80-4*l)],["l",c-Jo,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",Jo-c,0],["l",0,o-l],["a",i,o,0,0,1,i,-o],["z"]]}},scene:[{path:function(e,t){var n=2,r=14;if(t<80){var a=t/80;return[["M",12,r*=a],["l",Jo-(n*=a),0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-Jo,0],["M",12,t-2*r],["l",Jo-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-Jo,0]]}return[["M",12,r],["l",Jo-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-Jo,0],["M",12,80-2*r],["l",Jo-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-Jo,0]]},attr:{fill:"transparent"}}],thumb:[{d:[["M",8.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",8.4,23],["C",8.1790861,23,8,22.8209139,8,22.6],["L",8,9.4],["C",8,9.1790861,8.1790861,9,8.4,9],["Z"]]},{d:[["M",6.4,12],["L",11.6,12],["C",11.8209139,12,12,12.1790861,12,12.4],["L",12,13.6],["C",12,13.8209139,11.8209139,14,11.6,14],["L",6.4,14],["C",6.1790861,14,6,13.8209139,6,13.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]},{d:[["M",6.4,18],["L",11.6,18],["C",11.8209139,18,12,18.1790861,12,18.4],["L",12,19.6],["C",12,19.8209139,11.8209139,20,11.6,20],["L",6.4,20],["C",6.1790861,20,6,19.8209139,6,19.6],["L",6,18.4],["C",6,18.1790861,6.1790861,18,6.4,18],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"multiplicity",width:110,height:70,isClip:!1,textarea:{region:function(e,t){return{minX:4,minY:.15*t+4,maxX:e-.1*e-4,maxY:t-4}}},outline:{d:[["M",106,0],["C",108.209139,-0,110,1.790861,110,4],["L",110,56],["C",110,58.209139,108.209139,60,106,60],["L",100,60],["L",100,66],["C",100,68.209139,98.209139,70,96,70],["L",4,70],["C",1.790861,70,0,68.209139,0,66],["L",0,14],["C",-0,11.790861,1.790861,10,4,10],["L",10,10],["L",10,4],["C",10,1.790861,11.790861,0,14,0],["L",106,0],["Z"]]},scene:[{d:[["M",10,10],["L",96,10],["C",98.209139,10,100,11.790861,100,14],["L",100,60]],attr:{fill:"transparent"}}],thumb:[{d:[["M",9.4,9],["L",26.6,9],["C",26.8209139,9,27,9.1790861,27,9.4],["L",27,19.6],["C",27,19.8209139,26.8209139,20,26.6,20],["L",9.4,20],["C",9.1790861,20,9,19.8209139,9,19.6],["L",9,9.4],["C",9,9.1790861,9.1790861,9,9.4,9],["Z"]]},{d:[["M",6.4,12],["L",23.6,12],["C",23.8209139,12,24,12.1790861,24,12.4],["L",24,22.6],["C",24,22.8209139,23.8209139,23,23.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"note",width:120,height:80,outline:{d:[["M",120,79],["C",120,79.5522847,119.552285,80,119,80],["L",1,80],["C",.4477153,80,0,79.5522847,0,79],["L",0,1],["C",0,.4477153,.4477153,0,1,0],["L",100,0],["L",120,20],["L",120,79],["Z"]]},scene:[{d:[["M",120,20],["L",100.5,20],["C",100.223858,20,100,19.7761424,100,19.5],["L",100,0],["L",100,0]],attr:{fill:"transparent"}}],thumb:[{d:[["M",6.4,9],["L",21,9],["L",21,9],["L",25.8828427,13.8828427],["C",25.9578573,13.9578573,26,14.0595988,26,14.1656854],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",21,9],["L",21,13.6],["C",21,13.8209139,21.1790861,14,21.4,14],["L",26,14],["L",26,14]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"history-pseudostate",width:40,height:40,textarea:{region:Vi},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20},scene:[{d:[["M",12,20],["L",28,20],["M",12,11],["L",12,29],["M",28,11],["L",28,29]]}],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7},{d:[["M",18.319148900000002,19.9993969],["C",18.567375900000002,19.991959100000003,18.742907799999998,19.930596899999998,18.845744699999997,19.8153104],["C",18.9485816,19.700023899999998,19,19.568002200000002,19,19.4192454],["L",19,19.4192454],["L",19,12.5801515],["C",19,12.4313947,18.9450355,12.2975136,18.8351064,12.1785082],["C",18.7251773,12.0595027,18.5460993,12,18.2978723,12],["C",18.035460999999998,12,17.856383,12.0632216,17.7606383,12.1896649],["C",17.6648936,12.3161082,17.617021299999998,12.4462704,17.617021299999998,12.5801515],["L",17.617021299999998,12.5801515],["L",17.617021299999998,15.2689307],["L",14.382978699999999,15.2689307],["L",14.382978699999999,12.5801515],["C",14.382978699999999,12.4313947,14.3315603,12.2975136,14.2287234,12.1785082],["C",14.1258865,12.0595027,13.9503546,12,13.7021277,12],["C",13.4539007,12,13.2748227,12.0632216,13.1648936,12.1896649],["C",13.0549645,12.3161082,13,12.4462704,13,12.5801515],["L",13,12.5801515],["L",13,19.4192454],["C",13,19.553126499999998,13.0549645,19.6851482,13.1648936,19.8153104],["C",13.2748227,19.945472600000002,13.4539007,20.0068348,13.7021277,19.9993969],["C",13.9503546,19.991959100000003,14.1258865,19.930596899999998,14.2287234,19.8153104],["C",14.3315603,19.700023899999998,14.382978699999999,19.568002200000002,14.382978699999999,19.4192454],["L",14.382978699999999,19.4192454],["L",14.382978699999999,16.5184878],["L",17.617021299999998,16.5184878],["L",17.617021299999998,19.4192454],["C",17.617021299999998,19.553126499999998,17.6719858,19.6851482,17.7819149,19.8153104],["C",17.891844,19.945472600000002,18.070922,20.0068348,18.319148900000002,19.9993969],["Z"]],attr:{fill:"#595959","stroke-width":0}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"entity",category:"UML",width:50,height:50,isClip:!1,textarea:{region:Vi},outline:{name:"ellipse",cx:25,cy:25,rx:25,ry:25},scene:[{d:[{name:"M",x:0,y:50},{name:"L",x:50,y:50}]}],thumb:[{d:[{name:"M",x:8,y:22},{name:"L",x:24,y:22}]},{name:"ellipse",cx:16,cy:16,rx:6,ry:6}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"activity",category:"UML",width:120,height:60,outline:{path:function(e,t){return Wi(e,t,Math.min(e,t)/2)}},scene:[],thumb:[{d:[["M",11,10],["L",21,10],["C",24.3137085,10,27,12.6862915,27,16],["C",27,19.3137085,24.3137085,22,21,22],["L",11,22],["C",7.6862915,22,5,19.3137085,5,16],["C",5,12.6862915,7.6862915,10,11,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.11,y:.11,name:"NW"},{x:.11,y:.89,name:"SW"},{x:.89,y:.11,name:"NE"},{x:.89,y:.89,name:"SE"}]}],tc=[{name:"swimlane-vertical",category:"swimlane",type:"swimlane",number:3,htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Lane 1</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 2</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 3</span></div>'],width:450,widths:[1/3,2/3],height:600,heights:[.1],outline:{path:function(e,t){return Wi(e,t,0)}},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:12.5,y:9},{name:"L",x:12.5,y:23}]},{d:[{name:"M",x:19.5,y:9},{name:"L",x:19.5,y:23}]},{d:[{name:"M",x:6,y:12.5},{name:"L",x:26,y:12.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"swimlane-horizontal",category:"swimlane",type:"swimlane",number:3,htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Lane 1</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 2</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 3</span></div>'],width:600,widths:[.1],height:400,heights:[1/3,2/3],outline:{path:function(e,t){return Wi(e,t,0)}},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:9.5,y:9},{name:"L",x:9.5,y:23}]},{d:[{name:"M",x:6,y:13.5},{name:"L",x:26,y:13.5}]},{d:[{name:"M",x:6,y:18.5},{name:"L",x:26,y:18.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]}],nc=function e(t,n){Array.from(t).forEach((function(t){"#text"===t.nodeName?n(t):e(t.childNodes,n)}))},rc=function(e,t){var n=(new DOMParser).parseFromString(t.join(""),"text/html"),r=0,a=[];nc(n.body.childNodes,(function(t){r>=e.length||(t.nodeValue=e[r++],a.push(function(e){for(;"BODY"!==(null===(t=e.parentNode)||void 0===t?void 0:t.nodeName);){var t;e=e.parentNode}return e}(t).outerHTML))}));for(var i=r;i<e.length;i++)a.push("<div>".concat(e[i],"</div>"));return a},ac=function(e){return Array.from(e).map((function(e){return e.innerText}))},ic=[{name:"pyramid",category:"DSL",type:"dsl",htmls:["<div>第一层</div>","<div>第二层</div>","<div>第三层</div>"],width:450,height:450,outline:{path:function(e,t){return[["M",0,t],["L",e/2,0],["L",e,t],["Z"]]}},scene:[],thumb:[{d:[["M",16.438108,6.7965599],["L",24.9424723,22.2590406],["C",25.0755505,22.501001,24.9872841,22.8050298,24.7453238,22.938108],["C",24.6715013,22.9787103,24.5886159,23,24.5043644,23],["L",7.4956356,23],["C",7.2194932,23,6.9956356,22.7761424,6.9956356,22.5],["C",6.9956356,22.4157485,7.0169253,22.3328631,7.0575277,22.2590406],["L",15.561892,6.7965599],["C",15.6949702,6.5545996,15.998999,6.4663332,16.2409594,6.5994113],["C",16.3240392,6.6451053,16.392414,6.7134801,16.438108,6.7965599],["Z"]]},{d:[{name:"M",x:12.3,y:12.5},{name:"L",x:19.5,y:12.5}]},{d:[{name:"M",x:9.5,y:18},{name:"L",x:22.6,y:18}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var e=[],t=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){t.push({html:n}),e.push(1)})),{models:t,info:e}},toText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(new DOMParser).parseFromString(e.join(""),"text/html");return ac(t.body.childNodes).join("\n")},toHtmls:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return rc((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),e)}},{name:"stage",category:"DSL",type:"dsl",htmls:["<div>阶段一</div>","<div>阶段二</div>","<div>阶段三</div>"],width:450,height:50,outline:{path:function(e,t){return[["M",0,0],["L",e-25,0],["L",e,t/2],["L",e-25,t],["L",0,t],["Z"]]}},scene:[],thumb:[{d:[["M",6.7,10.5],["L",22.9466615,10.5],["C",23.0746361,10.5,23.1948849,10.5612336,23.270156,10.6647313],["L",27.1503514,16],["L",27.1503514,16],["L",23.270156,21.3352687],["C",23.1948849,21.4387664,23.0746361,21.5,22.9466615,21.5],["L",6.7,21.5],["C",6.4790861,21.5,6.3,21.3209139,6.3,21.1],["L",6.3,10.9],["C",6.3,10.6790861,6.4790861,10.5,6.7,10.5],["Z"]]},{d:[["M",13.6,10.5],["L",17.6,16],["L",13.6,21.5]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var e=[],t=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){t.push({html:n}),e.push(1)})),{models:t,info:e}},toText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(new DOMParser).parseFromString(e.join(""),"text/html");return ac(t.body.childNodes).join(",")},toHtmls:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return rc((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(","),e)}},{name:"segmented pyramid",category:"DSL",type:"dsl",htmls:["<div>观点一</div>","<div>观点二</div>","<div>观点三</div>","<div>观点四</div>"],width:450,height:450,outline:{path:function(e,t){return[["M",0,t],["L",e/2,0],["L",e,t],["Z"]]}},scene:[],thumb:[{d:[["M",16.438108,6.7965599],["L",24.9424723,22.2590406],["C",25.0755505,22.501001,24.9872841,22.8050298,24.7453238,22.938108],["C",24.6715013,22.9787103,24.5886159,23,24.5043644,23],["L",7.4956356,23],["C",7.2194932,23,6.9956356,22.7761424,6.9956356,22.5],["C",6.9956356,22.4157485,7.0169253,22.3328631,7.0575277,22.2590406],["L",15.561892,6.7965599],["C",15.6949702,6.5545996,15.998999,6.4663332,16.2409594,6.5994113],["C",16.3240392,6.6451053,16.392414,6.7134801,16.438108,6.7965599],["Z"]]},{d:[{name:"M",x:20.5511187,y:14.4004187},{name:"L",x:11.0329065,y:14.5869445}]},{d:[{name:"M",x:15.8351703,y:22.8219869},{name:"L",x:11.2505579,y:14.370259}]},{d:[{name:"M",x:15.8351703,y:22.8219869},{name:"L",x:20.5511187,y:14.370259}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var e=[],t=[];(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){t.push({html:n}),e.push(1)}));var n=Math.ceil(Math.sqrt(t.length));return{models:t,info:e,otherInfo:{rows:n}}},toText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(new DOMParser).parseFromString(e.join(""),"text/html");return ac(t.body.childNodes).join("\n")},toHtmls:function(){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=rc((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),e),n=Math.ceil(Math.sqrt(t.length)),r=n*n,a=t.length;a<r;a++)t.push("");return t}},{name:"architecture",category:"DSL",type:"dsl",htmls:[["<div>模块1.1</div>","<div>模块1.2</div>"],["<div>模块2</div>"],["<div>模块3.1</div>","<div>模块3.2</div>"]],width:450,height:450,outline:{path:function(e,t){return Wi(e,t,4)}},scene:[],thumb:[{d:[["M",7,8.5],["L",25,8.5],["C",25.5522847,8.5,26,8.9477153,26,9.5],["L",26,22],["C",26,22.5522847,25.5522847,23,25,23],["L",7,23],["C",6.4477153,23,6,22.5522847,6,22],["L",6,9.5],["C",6,8.9477153,6.4477153,8.5,7,8.5],["Z"]]},{d:[["M",9.1,17],["L",14.15,17],["C",14.4813708,17,14.75,17.2686292,14.75,17.6],["L",14.75,19.9],["C",14.75,20.2313708,14.4813708,20.5,14.15,20.5],["L",9.1,20.5],["C",8.7686292,20.5,8.5,20.2313708,8.5,19.9],["L",8.5,17.6],["C",8.5,17.2686292,8.7686292,17,9.1,17],["Z"]]},{d:[["M",9.1,11],["L",22.9,11],["C",23.2313708,11,23.5,11.2686292,23.5,11.6],["L",23.5,13.9],["C",23.5,14.2313708,23.2313708,14.5,22.9,14.5],["L",9.1,14.5],["C",8.7686292,14.5,8.5,14.2313708,8.5,13.9],["L",8.5,11.6],["C",8.5,11.2686292,8.7686292,11,9.1,11],["Z"]]},{d:[["M",17.85,17],["L",22.9,17],["C",23.2313708,17,23.5,17.2686292,23.5,17.6],["L",23.5,19.9],["C",23.5,20.2313708,23.2313708,20.5,22.9,20.5],["L",17.85,20.5],["C",17.5186292,20.5,17.25,20.2313708,17.25,19.9],["L",17.25,17.6],["C",17.25,17.2686292,17.5186292,17,17.85,17],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(e){var t=[],n=[];return e.forEach((function(e){e.forEach((function(e){n.push({html:e})})),t.push(e.length)})),{models:n,info:t}},toText:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e){var t=(new DOMParser).parseFromString(e.join(""),"text/html");return ac(t.body.childNodes).join(",")})).join("\n")},toHtmls:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n").map((function(t,n){return rc(t.split(","),e[n]||[])}))}}],oc=[].concat(D()(Zo),D()(Uo),D()(ec),D()([{name:"er-entity",width:120,height:70,outline:{name:"rect",x:0,y:0,width:120,height:70,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"weak-entity",width:120,height:70,outline:{name:"rect",x:0,y:0,width:120,height:70,rx:1,ry:1},scene:[{name:"rect",x:5,y:5,width:110,height:60,rx:1,ry:1,attr:{fill:"transparent"}}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",8.4,11],["L",23.6,11],["C",23.8209139,11,24,11.1790861,24,11.4],["L",24,20.6],["C",24,20.8209139,23.8209139,21,23.6,21],["L",8.4,21],["C",8.1790861,21,8,20.8209139,8,20.6],["L",8,11.4],["C",8,11.1790861,8.1790861,11,8.4,11],["Z"]],attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"derived-attribute",width:120,height:70,outline:{d:[["M",60,70],["C",93.137085,70,120,54.3299662,120,35],["C",120,15.6700338,93.137085,0,60,0],["C",26.862915,0,0,15.6700338,0,35],["C",0,54.3299662,26.862915,70,60,70],["Z"]],attr:{stroke:{style:"dash"}}},scene:[],thumb:[{d:[["M",16,24],["C",22.0751322,24,27,20.418278,27,16],["C",27,11.581722,22.0751322,8,16,8],["C",9.9248678,8,5,11.581722,5,16],["C",5,20.418278,9.9248678,24,16,24],["Z"]],attr:{"stroke-dasharray":"2"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"attribute",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"multivalued-attribute",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[{name:"ellipse",cx:60,cy:35,rx:55,ry:30,attr:{fill:"transparent"}}],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8},{name:"ellipse",cx:16,cy:16,rx:9,ry:6,attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"relationship",width:120,height:70,outline:{name:"polygon",points:[{x:60,y:0},{x:120,y:35},{x:60,y:70},{x:0,y:35}]},scene:[],thumb:[{d:[["M",16.2309401,8.1632993],["L",26.8518283,15.6734014],["C",27.0322037,15.8009461,27.0750315,16.0505647,26.9474868,16.2309401],["C",26.921263,16.2680261,26.8889143,16.3003748,26.8518283,16.3265986],["L",16.2309401,23.8367007],["C",16.0925332,23.9345692,15.9074668,23.9345692,15.7690599,23.8367007],["L",5.1481717,16.3265986],["C",4.9677963,16.1990539,4.9249685,15.9494353,5.0525132,15.7690599],["C",5.078737,15.7319739,5.1110857,15.6996252,5.1481717,15.6734014],["L",15.7690599,8.1632993],["C",15.9074668,8.0654308,16.0925332,8.0654308,16.2309401,8.1632993],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"weak-relationship",width:120,height:70,outline:{name:"polygon",points:[{x:60,y:0},{x:120,y:35},{x:60,y:70},{x:0,y:35}]},scene:[{name:"polygon",points:[{x:60.4285714,y:5},{x:111.857143,y:35},{x:60.4285714,y:65},{x:9,y:35}],attr:{fill:"transparent"}}],thumb:[{d:[["M",16.2309401,10.1632993],["L",24.0234012,15.6734014],["C",24.2037766,15.8009461,24.2466044,16.0505647,24.1190597,16.2309401],["C",24.0928359,16.2680261,24.0604872,16.3003748,24.0234012,16.3265986],["L",16.2309401,21.8367007],["C",16.0925332,21.9345692,15.9074668,21.9345692,15.7690599,21.8367007],["L",7.9765988,16.3265986],["C",7.7962234,16.1990539,7.7533956,15.9494353,7.8809403,15.7690599],["C",7.9071641,15.7319739,7.9395128,15.6996252,7.9765988,15.6734014],["L",15.7690599,10.1632993],["C",15.9074668,10.0654308,16.0925332,10.0654308,16.2309401,10.1632993],["Z"]]},{d:[["M",16.2309401,8.1632993],["L",26.8518283,15.6734014],["C",27.0322037,15.8009461,27.0750315,16.0505647,26.9474868,16.2309401],["C",26.921263,16.2680261,26.8889143,16.3003748,26.8518283,16.3265986],["L",16.2309401,23.8367007],["C",16.0925332,23.9345692,15.9074668,23.9345692,15.7690599,23.8367007],["L",5.1481717,16.3265986],["C",4.9677963,16.1990539,4.9249685,15.9494353,5.0525132,15.7690599],["C",5.078737,15.7319739,5.1110857,15.6996252,5.1481717,15.6734014],["L",15.7690599,8.1632993],["C",15.9074668,8.0654308,16.0925332,8.0654308,16.2309401,8.1632993],["Z"]],attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"generalization",width:66,height:68,isClip:!1,outline:{d:[["M",33,54],["L",1,14],["L",65,14],["L",33,54],["Z"],["M",33,54],["L",33,68],["M",33,0],["L",33,14]]},scene:[],thumb:[{d:[["M",16.5,22],["L",7,11],["L",26,11],["L",16.5,22],["Z"],["M",16.5,22],["L",16.5,26],["M",16.5,7],["L",16.5,11]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"total-generalization",width:66,height:68,isClip:!1,outline:{d:[["M",33,54],["L",1,14],["L",65,14],["L",33,54],["Z"],["M",33,54],["L",33,68],["M",23,0],["L",23,14],["M",43,0],["L",43,14]]},scene:[],thumb:[{d:[["M",16.5,22],["L",7,11],["L",26,11],["L",16.5,22],["Z"],["M",11.5,7],["L",11.5,11],["M",20.5,7],["L",20.5,11],["M",16.5,22],["L",16.5,26]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"}]),D()(tc),D()(ic));function cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var lc=function(){function e(t){m()(this,e),c()(this,"autoSelect",!0),c()(this,"diagram",void 0),this.diagram=null==t?void 0:t.diagram,Object.assign(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t))}return v()(e,[{key:"commandName",get:function(){return this.constructor.className}},{key:"execute",value:function(e){}},{key:"forward",value:function(){}},{key:"backward",value:function(){}},{key:"select",value:function(e){var t=this.diagram;this.autoSelect&&(e&&e.length>0?t.selector.select(e):(t.selector.clear(),t.tryFocus()))}}],[{key:"enable",value:function(e){return!0}}]),e}();c()(lc,"className","Command"),c()(lc,"isModelChange",!0),c()(lc,"Update",void 0),c()(lc,"Add",void 0);var sc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"map",new Map),e}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.model,n=void 0===t?{}:t,r=this.cellOptions,a=yn(n,void 0===r?{}:r);a[0].forEach((function(e){e.id||(e.id=Object(F.a)())}));var i=e.add.apply(e,D()(a));i.forEach((function(t,n){Object.assign(a[1][n],e.getCellOptions(t))})),this.changeArguments=a,this.select(i)}},{key:"forward",value:function(){var e=this.diagram,t=this.changeArguments,n=e.add.apply(e,D()(t));this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.changeArguments,n=e.find(t[0][0].id).parent;e.remove(t[0].map((function(e){return e.id}))),this.select(n&&n.model.id)}}]),n}();c()(sc,"className","Add");var uc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getCells",value:function(){var e=this.changeArguments,t=this.diagram,n=e[0].map((function(e){return t.find(e)}));if(n.some((function(e){return!e})))throw new Error("can not find the cell");return n}},{key:"execute",value:function(){var e=this.diagram,t=this.model,n=this.cellOptions,r=void 0===n?{}:n,a=this.originModels,o=this.notSelect,c=this.id;Array.isArray(c)||(c=[c]),"object"===i()(c[0])&&(c=c.map((function(e){return e.model.id})));var l=yn(c,t,r);this.changeArguments=l;var s=this.getCells(),u=l[1];this.originModels=a||s.map((function(e,t){var n=u[t];return Object.keys(n).reduce((function(e,r){if("children"===r)return e;var a=n[r],i=s[t].model[r];return d()(a)?e[r]=Object.keys(a).reduce((function(e,t){var n=i&&i[t];return e[t]=null==n?null:n,e}),{}):e[r]=null==i?null:i,e}),{})})),this.originCellOptions=s.map((function(t){return e.getCellOptions(t)}));for(var f=0;f<u.length;f++)St(this.originModels[f],u[f]);e.update(s,u,l[2]),o||this.select(s)}},{key:"forward",value:function(){var e=this.diagram,t=this.changeArguments,n=this.getCells(),r=t[1];e.update(n,r,t[2]),this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.originModels,n=this.originCellOptions,r=this.getCells();e.update(r,t,n),this.select(r)}}]),n}();c()(uc,"className","Update");var dc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"commands",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.commands,t=e.length;e.forEach((function(e,n){e.autoSelect=n===t-1,e.execute()}))}},{key:"forward",value:function(){var e=this.commands,t=e.length;e.forEach((function(e,n){e.autoSelect=n===t-1,e.forward()}))}},{key:"backward",value:function(){for(var e=this.commands,t=e.length-1;t>=0;t--){var n=e[t];n.autoSelect=0===t,n.backward()}}}]),n}();c()(dc,"className","Compound");var fc=function(e){S()(n,dc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){}}]),n}();c()(fc,"className","NoneExecuteCompound");var hc=function(e){return e.reduce((function(e,t){return t.isStem?e.concat(t.getChildren()):e.concat(t)}),[])};var pc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.onlyCell,n=t?[t]:e.selector.selections,r=hc(e.deduplicate(n)).filter((function(e){return e.canCollapse()}));e.update(r,{collapsed:!0}),e.selector.select(r),this.cells=r.map((function(e){return e.model.id}))}},{key:"backward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:null}),e.selector.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:!0}),e.selector.select(t)}}]),n}();c()(pc,"className","Collapse"),c()(pc,"enable",(function(e){var t=e.selector.selections;return hc(e.deduplicate(t)).some((function(e){return e.canCollapse()}))}));var mc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.onlyCell,n=t?[t]:e.selector.selections,r=hc(e.deduplicate(n)).filter((function(e){return!e.canCollapse()&&e.canExpand()}));e.update(r,{collapsed:null}),e.selector.select(r),this.cells=r.map((function(e){return e.model.id}))}},{key:"backward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:!0}),e.selector.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.cells;e.update(t,{collapsed:null}),e.selector.select(t)}}]),n}();c()(mc,"className","Expand"),c()(mc,"enable",(function(e){var t=e.selector.selections;return hc(e.deduplicate(t)).some((function(e){return!e.canCollapse()&&e.canExpand()}))}));var yc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.command.undo()}}]),n}();c()(yc,"className","Undo"),c()(yc,"enable",(function(e){return e.command.index>=0}));var vc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.command.redo()}}]),n}();c()(vc,"className","Redo"),c()(vc,"enable",(function(e){var t=e.command;return t.index<t.commands.length-1}));var gc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram.viewport;e.setViewport(e.zoom+.2)}}]),n}();c()(gc,"className","ZoomIn"),c()(gc,"isModelChange",!1),c()(gc,"enable",(function(e){var t=e.viewport;return t.zoom+.2<=t.maxZoom}));var bc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram.viewport;e.setViewport(e.zoom-.2)}}]),n}();c()(bc,"className","ZoomOut"),c()(bc,"isModelChange",!1),c()(bc,"enable",(function(e){var t=e.viewport;return t.zoom-.2>=t.minZoom}));var xc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this,e);var a=E()(r).diagram.viewport;return r.queue=!1,r.zoom=e.zoom<a.minZoom&&a.minZoom||e.zoom>a.maxZoom&&a.maxZoom||e.zoom,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.zoom;e.viewport.setViewport(t)}}]),n}();c()(xc,"className","ZoomTo"),c()(xc,"isModelChange",!1);var kc=function(){function e(){m()(this,e),this.clipboardData={setData:function(e,t){this[e]=t},getData:function(e){return this[e]},files:[]}}return v()(e,[{key:"preventDefault",value:function(){}}]),e}();function wc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ac(e,t){return yt(e.reduce((function(e,n){return Sn(n)?e.push.apply(e,[n].concat(D()(n.children),D()(n.contain.map(t.find.bind(t)).filter((function(e){return e}))))):Rn(n)||wn(n)?e.push.apply(e,[n].concat(D()(n.children))):An(n)?n.deepEachWithoutSelf((function(t){e.push(t)})):e.push(n),e}),[]))}function Oc(){return(Oc=G()(V.a.mark((function e(t,n){var r,a,i,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.exporter.blob("png",{cells:Ac(t.selector.selections,t)});case 2:r=e.sent,a=new Blob([n.text],{type:"text/plain"}),i=new Blob([n.html],{type:"text/html"}),o=new window.ClipboardItem({"text/html":i,"text/plain":a,"image/png":r}),window.navigator.clipboard.write([o]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ec(e,t){t.importer.caches={};var n=t.selector.selections;if(0!==n.length){e.preventDefault();var a=t.exporter.clipboard(n);try{var i,o,c;document.hasFocus()&&null!==(i=window)&&void 0!==i&&null!==(o=i.navigator)&&void 0!==o&&null!==(c=o.clipboard)&&void 0!==c&&c.write&&U.ua.chrome&&function(e,t){Oc.apply(this,arguments)}(t,a)}catch(e){console.warn("Asynchronous clipboard is not supported")}e.clipboardData.setData("text/html",a.html),e.clipboardData.setData("text/plain",a.text);try{r.LocalStorageUtil.setItem(rr,JSON.stringify(Cc(Cc({},a),{},{recordTime:Date.now()})))}catch(e){console.warn("Failed to execute 'setItem' on 'Storage': Setting the value of 'lake_diagram_clipboard_data' exceeded the quota.")}}}var Pc=new kc;function Sc(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!document.execCommand(e))if("paste"!==e)t.command.execute(e.charAt(0).toUpperCase()+e.slice(1),{e:Pc});else{var i=r.LocalStorageUtil.getItem(rr);if(i){i=JSON.parse(i);var o=U.ua.macos?"⌘+V":"Ctrl+V";a&&ne.a.info(zn("已粘贴当前页面复制的内容，如需粘贴页面外内容请使用 ")+o+zn(" 粘贴")),Pc.clipboardData.setData("text/html",i.html),Pc.clipboardData.setData("text/plain",i.text),t.command.execute("Paste",{e:Pc,focusPoint:n})}}}window.__lake_diagram_board_custom_clipboard_event=Pc;var jc=Object.freeze({__proto__:null,getCopyImageCells:Ac,handleCopy:Ec,customClipboardEvent:Pc,executeClipboardCommand:Sc});function Rc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Mc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({queue:!1},e))}return v()(n,[{key:"execute",value:function(){Ec(this.e,this.diagram)}}]),n}();c()(Mc,"className","Copy"),c()(Mc,"isModelChange",!1);var Lc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.e,n=this.focusPoint,r=t.clipboardData.getData("text/html"),a=t.clipboardData.getData("text/plain"),i=Array.from(t.clipboardData.files),o={text:a,html:r};i.length>0&&(""===r&&/^.+\.\w+$/.test(a)||""===a&&/^(<meta.+?>)?<img.+?>$/.test(r)||!a||!r)&&(o.files=i);var c=e.importer.clipboard(o,n);c?(this.handler=c,d()(c)&&(this.selectedCellId=e.selector.selections.map((function(e){return e.model.id})),e.destroyed||(e.signal.beforePasteSelect=!0,e.selector.select(this.handler.body.map((function(e){return e.id}))),e.signal.beforePasteSelect=!1))):this.queue=!1}},{key:"forward",value:function(){var e=this.handler,t=this.diagram;e&&(e.execute(),t.selector.select(this.handler.body.map((function(e){return e.id}))))}},{key:"backward",value:function(){var e=this.handler,t=this.diagram,n=this.selectedCellId;e&&(e.body.forEach((function(e){t.remove(e.id)})),n&&t.selector.select(n))}}]),n}();function Bc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Lc,"className","Paste");var Dc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){return m()(this,n),t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({queue:!1},e))}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections[0];e.command.execute("ZoomTo",{zoom:1}),e.viewport.focus([t.x,t.y])}}]),n}();c()(Dc,"className","FocusSelection"),c()(Dc,"enable",(function(e){return 1===e.selector.selections.length}));var Nc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.id,n=this.endHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(e){return{html:e}}))),e.update(t,r)}},{key:"forward",value:function(){var e=this.diagram,t=this.endHTML,n=this.id,r={html:t};Array.isArray(t)&&(r=t.map((function(e){return{html:e}}))),e.update(n,r),this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.startHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(e){return{html:e}}))),e.update(t,r),this.select(t)}}]),n}();c()(Nc,"className","UpdateCellContent");var Ic=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=zn("链接"),n=window.getSelection(),r=null==n?void 0:n.getRangeAt(0),a=null==r?void 0:r.commonAncestorContainer;if(e.contentEditor.dom&&a===e.contentEditor.dom){var i=null==a?void 0:a.querySelectorAll("a");if(1===i.length){var o=i[0].getAttribute("href");o&&(t=o)}}e.contentEditor.execCommand("createLink",t)}}]),n}();c()(Ic,"className","CreateLink"),c()(Ic,"enable",(function(e){var t=e.getCell(e.contentEditor.dom);return!!e.contentEditor.getRange()&&!!t}));var Tc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r.onBeginInsertLine=function(e){if(r.sourceCell){var t=E()(r),n=t.diagram,a=t.beginInsertEvent,i=n.viewport.invertClient([e.clientX,e.clientY]);n.emit("begininsertline",{source:{id:r.sourceCell.model.id,connection:null},target:{id:null,connection:[i[0],i[1]]}}),n.off(a,r.onBeginInsertLine)}},r}return v()(n,[{key:"bindBegineInsertEvent",value:function(){var e=this.diagram,t=this.sourceCell,n=this.beginInsertEvent;e.off(n,this.onBeginInsertLine),t&&e.on(n,this.onBeginInsertLine)}},{key:"execute",value:function(){var e=this.diagram,t=this.shape,n=this.beginInsertEvent,r=e.selector.selections;1!==r.length||r[0].isLine||r[0].isGroup||(this.sourceCell=r[0],n="mousemove"),e.selector.clear(),e.tryFocus(),e.interaction.changeMode("beginInsertLine"),e.settings.line.shape=t,this.beginInsertEvent=n,this.beginInsertEvent&&this.bindBegineInsertEvent()}}],[{key:"enable",value:function(){return!0}}]),n}();c()(Tc,"className","BeginInsertLine"),c()(Tc,"isModelChange",!1),lc.Add=sc,lc.Update=uc;var _c=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.name,n=this.value,r=e.selector,a=e.contentEditor,i=r.selections,o=[];i.forEach((function(e){var t,n=e.getCanTextCell();Array.isArray(n)?(t=o).push.apply(t,D()(n)):o.push(e)}));var c=(o=yt(o)).map((function(e){return e.textareaElement.htmlContainer})),l=c.map((function(e){return e.innerHTML}));e.contentEditor.batchEdit(c,t,n);var s=c.map((function(e){return e.innerHTML})),u={html:s};Array.isArray(s)&&(u=s.map((function(e){return{html:e}}))),this.endHTML=s,this.startHTML=l,this.id=o,e.update(o,u),1!==o.length||a.isBegin||a.prepareEdit()}},{key:"forward",value:function(){var e=this.diagram,t=this.endHTML,n=this.id,r={html:t};Array.isArray(t)&&(r=t.map((function(e){return{html:e}}))),e.update(n,r),this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.startHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(e){return{html:e}}))),e.update(t,r),this.select(t)}}],[{key:"enable",value:function(e){return e.selector.selections.filter((function(e){return e.canUpdateText()})).length>0}}]),n}();c()(_c,"className","ContentCommand");var Fc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(e){var t=this.diagram,n=this.cells,r=n.map((function(e){return e.model.id})),a=n.map((function(e){return t.getCellOptions(e)}));n.forEach((function(t){t[e]()}));var i=n.map((function(e){return t.getCellOptions(e)}));this.beforeCellOptions=a,this.afterCellOptions=i,this.id=r,this.select(r)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.beforeCellOptions;e.update(t,{},n),this.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.id,n=this.afterCellOptions;e.update(t,{},n),this.select(t)}}]),n}();c()(Fc,"className","ZIndex");var zc=function(e){S()(n,Fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"toBack")}}]),n}();c()(zc,"className","ToBack");var qc=function(e){S()(n,Fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"toFront")}}]),n}();c()(qc,"className","ToFront");var Yc=function(e){S()(n,Fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"forward")}}]),n}();c()(Yc,"className","Forward");var Hc=function(e){S()(n,Fc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"backward")}}]),n}();c()(Hc,"className","Backward");var Gc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){this.diagram.viewport.autoFit()}}]),n}();c()(Gc,"className","FitViewport"),c()(Gc,"isModelChange",!1);var Xc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram;e.selector.select(e.getCells().filter((function(e){return e.state.visible})))}}]),n}();c()(Xc,"className","SelectAll"),c()(Xc,"isModelChange",!1);var Vc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.viewport.setViewport(1)}}]),n}();c()(Vc,"className","ActualSize"),c()(Vc,"isModelChange",!1);var Wc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections[0];e.contentEditor.prepareEdit(),e.contentEditor.beginEdit(),e.update(t,{})}}],[{key:"enable",value:function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.textareaElement}))}}]),n}();c()(Wc,"className","BeginEditContent"),c()(Wc,"isModelChange",!1);var Zc=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram;"dragCanvas"===e.interaction.currentMode?(e.interaction.changeMode("edit"),e.signal.buttonDragCanvas=!1):(e.highlight.clear(),e.interaction.changeMode("dragCanvas"),e.signal.buttonDragCanvas=!0)}}]),n}();function Uc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Zc,"className","ButtonDragCanvas"),c()(Zc,"isModelChange",!1);var Kc=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"index",-1),c()(this,"commands",[]),c()(this,"commandConstructors",void 0),this.commandConstructors={ToBack:zc,ToFront:qc,Forward:Yc,Backward:Hc,Add:sc,Update:uc,Compound:dc,NoneExecuteCompound:fc,Collapse:pc,Expand:mc,Undo:yc,Redo:vc,ZoomIn:gc,ZoomOut:bc,ZoomTo:xc,ActualSize:Vc,FitViewport:Gc,UpdateCellContent:Nc,ContentCommand:_c,FocusSelection:Dc,Copy:Mc,Paste:Lc,CreateLink:Ic,BeginInsertLine:Tc,SelectAll:Xc,ButtonDragCanvas:Zc,BeginEditContent:Wc}}return v()(e,[{key:"find",value:function(e){var t=this.diagram;return!e||t&&t.destroyed?null:"string"==typeof e?this.commandConstructors[e]:e.constructor}},{key:"enable",value:function(e){var t=this.find(e);return t&&(!t.enable||t.enable(this.diagram))||!1}},{key:"register",value:function(e){this.commandConstructors[e.className]=e}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this.commandConstructors[e](function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({diagram:this.diagram},t))}},{key:"execute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.diagram;if(!n||!n.destroyed){"string"==typeof e&&(e=this.create(e,t));var r=e.constructor,a={commandName:r.className,command:e,prevent:!1,useTime:0,isModelChange:!0};if(n&&n.emit("beforecommandexecute",a),this.enable(e)&&!0!==a.prevent&&this.commands){var i=+new Date;e.execute(),!1!==e.queue&&(this.index>-1?this.commands=this.commands.slice(0,this.index+1):this.commands=[],this.commands.push(e),this.index=this.commands.indexOf(e)),a.useTime=+new Date-i,a.isModelChange=r.isModelChange,n&&n.emit("aftercommandexecute",a)}return e}}},{key:"redo",value:function(){var e=this.index,t=this.commands,n=this.diagram;if(t&&!(e>=t.length-1)){var r=t[++e];n&&n.emit("beforecommandforward",{command:r}),r.forward(),n&&n.emit("aftercommandforward",{command:r}),this.index=e}}},{key:"undo",value:function(){var e=this.index,t=this.commands,n=this.diagram;if(t&&!(e<0)){var r=t[e];n&&n.emit("beforecommandbackward",{command:r}),r.backward(),n&&n.emit("aftercommandbackward",{command:r}),this.index=--e}}},{key:"destroy",value:function(){this.commands=[]}}]),e}();function Qc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qc(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $c(e,t,n){if(t>0)return!1;if(e===n)return!0;var r=e.parentNode;return!!r&&$c(r,Array.from(r.childNodes).indexOf(e),n)}function el(e,t,n){if(e.nodeType===Node.TEXT_NODE){if(t!==e.data.length)return!1}else if(t!==e.childNodes.length)return!1;if(e===n)return!0;var r=e.parentNode;return!!r&&el(r,Array.from(r.childNodes).indexOf(e)+1,n)}function tl(e,t){var n=e.endContainer,r=e.endOffset;return!!e.collapsed&&el(n,r,t)}function nl(e,t){var n=e.startContainer,r=e.startOffset;return!!e.collapsed&&$c(n,r,t)}function rl(e,t){return e.nodeType===Node.ELEMENT_NODE&&(e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector).call(e,t)}function al(e,t,n){for(;e&&n.contains(e);){if("string"==typeof t&&rl(e,t)||"function"==typeof t&&t(e))return e;e=e.parentNode}return null}function il(e,t){var n=e.getAttribute("style");return n&&n.includes(t)}function ol(e){for(var t=e.firstChild;t;){var n=t.nextSibling;e.parentNode.insertBefore(t,e),t=n}e.parentNode.removeChild(e)}function cl(e,t){return t.tagName!==e||t.childNodes&&t.childNodes[0]&&3!==t.childNodes[0].nodeType&&(t.childNodes[0].tagName===e||1!==t.childNodes.length)?t.childNodes[0]&&cl(e,t.childNodes[0]):t}function ll(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return{};if(t){var i=t.startContainer;if(i===e)n=cl("SPAN",e),r=cl("DIV",e);else{var o=al(i,(function(e){return 1===e.nodeType}),e);n=o,r=o}}else n=cl("SPAN",e),r=cl("DIV",e);return function(e,t,n,r){var a=function(e,t){if(!e)return{};var n=window.getComputedStyle(e),r=n["text-align"],a=parseInt(n["font-size"]),i=n.color;return{textAlign:r,fontSize:t.fontSize?t.fontSize.value:a,color:t.foreColor?t.foreColor.value:i}}(e,n),i=function(e,t,n){if(!e)return{};var r=window.getComputedStyle(e),a=parseInt(r["font-size"]),i=r.color;return{bold:t.bold?!t.bold.cancel:!!al(e,(function(e){return il(e,"bold")}),n),italic:t.italic?!t.italic.cancel:!!al(e,(function(e){return il(e,"italic")}),n),strikethrough:t.strikethrough?!t.strikethrough.cancel:!!al(e,(function(e){return il(e,"line-through")}),n),underline:t.underline?!t.underline.cancel:!!al(e,(function(e){return il(e,"underline")}),n),fontSize:t.fontSize?t.fontSize.value:a,color:t.foreColor?t.foreColor.value:i}}(t,n,r);return Jc(Jc({bold:!1,italic:!1,strikethrough:!1,underline:!1},a),i)}(r,n,a,e)}function sl(e){if(e.preventDefault(),this.isBegin){e.stopPropagation();var t=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("text/html");if(n){var r=(new DOMParser).parseFromString(n,"text/html");if(r&&1===r.body.childNodes.length&&"A"===r.body.childNodes[0].tagName)return this.execCommand("insertHTML",r.body.childNodes[0].outerHTML);if(n.includes("lake_diagram_content_editor_data"))return this.execCommand("insertHTML",r.querySelector("[data-lake_diagram_content_editor_data]").innerHTML)}return t&&/^https?:\/\/\S+$/.test(t)?this.execCommand("insertHTML",'<a href="'.concat(t,'" target="_blank">').concat(t,"</a>")):this.execCommand("insertText",t)}}function ul(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"copy";if(this.isBegin){e.stopPropagation(),"copy"===t&&e.preventDefault();var n=this.getRange(),r=document.createElement("div"),a=n.cloneContents();r.dataset.lake_diagram_content_editor_data=!0,r.appendChild(a),e.clipboardData.setData("text/html",r.outerHTML),e.clipboardData.setData("text",r.innerText)}}function dl(e,t,n){at(t,(function(t){if(1===t.nodeType){var n=t.getAttribute("style");n&&n.includes("font-size: x-small;")&&(t.style["font-size"]="".concat(e,"px"))}}),(function(e){return e.childNodes}));var r=[];at(t,(function(e){1===e.nodeType&&"FONT"===e.tagName&&r.push(e)}),(function(e){return e.childNodes})),r.length>0&&(n&&!n.collapsed&&at(n.commonAncestorContainer,(function(e){1===e.nodeType&&n.isPointInRange(e,0)&&(e.style["font-size"]="")}),(function(e){return e.childNodes})),r.forEach((function(t){var n=t.parentNode,r=document.createElement("span");r.style["font-size"]="".concat(e,"px"),n.insertBefore(r,t),r.appendChild(t),ol(t);var a=r.childNodes[0];a&&"SPAN"===a.tagName&&1===r.childNodes.length&&(Object.keys($n).forEach((function(e){a.style[e]&&"font-size"!==e&&(r.style[e]=a.style[e])})),ol(a)),"SPAN"===n.tagName&&1===n.childNodes.length&&(Object.keys($n).forEach((function(e){r.style[e]&&"font-size"!==e&&(n.style[e]=r.style[e])})),ol(r))})))}c()(Kc,"className","Command");var fl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,e),c()(this,"onKey",void 0),c()(this,"offKey",void 0),c()(this,"events",void 0),c()(this,"destroyed",void 0),this.onKey="on",this.offKey="off",this.events=[],Object.assign(this,t)}return v()(e,[{key:"bind",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e[(e===window||e instanceof HTMLElement||e instanceof SVGElement?"addEventListener":r.onKey)||this.onKey](t,n);var a={object:e,eventName:t,callback:n,options:r};return this.events.push(a),a}},{key:"_unbind",value:function(e){var t=e.object,n=e.eventName,r=e.callback,a=e.options;if(t[(t===window||t instanceof HTMLElement||t instanceof SVGElement?"removeEventListener":a.offKey)||this.offKey](n,r),this.events){var i=this.events.indexOf(e);-1!==i&&this.events.splice(i,1)}}},{key:"unbind",value:function(e){var t=this;e?this._unbind(e):this.events.concat([]).forEach((function(e){t._unbind(e)}))}},{key:"destroy",value:function(){this.events&&this.unbind(),this.events=[],this.destroyed=!0}}]),e}();function hl(e){return"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+e)))}var pl=["http:","https:","data:","dingtalk:","ftp:","mailto:","blob:"];function ml(e){return function(e){return"string"==typeof e&&!(e=e.toLowerCase()).startsWith("data:text/html")&&(!!pl.some((function(t){return e.startsWith(t)}))||!(!e.startsWith("./")&&!e.startsWith("/"))||e.indexOf(":")<0)}(e)?e:""}var yl=new ae.a.FilterXSS({onIgnoreTag:function(){return""},css:{whiteList:$n},whiteList:{p:["style","id"],a:["href","title","target","style"],b:["style"],i:["style"],span:["style"],br:[],div:["style"]},onTag:function(e,t,n){var r=n.isClosing;if("a"===e&&!r&&"string"==typeof t){var a=t.match(/<a\s+(?:[^>]*?\s+)?href=(["'])(.*?)\1/);if(!a||!ml(a[2]))return""}},onTagAttr:function(e,t,n){if("a"===e&&"href"===t){var r=ml(n);return r?"".concat(t,'="').concat(r,'"'):""}}});function vl(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function gl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bl(e){if(!e)return!1;var t=(new DOMParser).parseFromString(e,"text/html").querySelector("[data-lake_diagram_body]");return!!t&&{body:JSON.parse(t.dataset.lake_diagram_body),extraInformations:JSON.parse(t.dataset.lake_extra_informations||t.dataset.lake_computed_props_map)||{},optionsMap:{}}}function xl(e){return e&&(e=yl.process(e)),e||""}function kl(e){try{var t;t=e.includes("\r\n")?e.trim().split("\r\n"):e.trim().split("\n");var n,r,a,i,o,c=[],l=0,s=1/0,u=t.map((function(e){if(0!==e.trim().length){var t=(e=e.replace(decodeURI("%0D"),"")).match(/^(\s*)(\S[\s\S]*)$/),n=b()(t,3),r=n[1],a=n[2],i=r.replace(/\t/g,"");return i.length>0&&i.length<s&&(s=i.length),{indent:r,html:a,spaceLength:i.length}}})).filter((function(e){return e})),d=vl(u);try{for(d.s();!(o=d.n()).done;){var f,h=o.value,p=h.indent,m=h.html,y=s===1/0?p:p.replace(/\t/g," ".repeat(s)),v="",g=!0,x=vl(m);try{for(x.s();!(f=x.n()).done;){var k=f.value;if("\n"!==k)v+=k;else{if(g){v+="<div>",g=!1;continue}v+="</div><div>"}}}catch(e){x.e(e)}finally{x.f()}g||(v+="</div>"),!i&&y&&n&&(i=y.length);var w=y.length/i;if(w)if(w>l)r=a,a={html:v},r.children=[a],l+=1;else if(w===l)a={html:v},r.children.push(a);else{var C=0;for(r=n;C<w-1;)r=r.children[r.children.length-1],C++;a={html:v},l=w,r.children.push(a)}else n=r=a={html:v},c.push(n),l=0}}catch(e){d.e(e)}finally{d.f()}return c}catch(e){return null}}var wl=Object.freeze({__proto__:null,getLakeDataByHtml:bl,parseHTML:xl,structuredPlainText:kl});function Cl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Al=U.HotKeyUtils.isHotkey,Ol=function(e){S()(n,_.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,c()(E()(r),"eventHelper",new fl),c()(E()(r),"isBegin",!1),c()(E()(r),"dom",void 0),c()(E()(r),"eventObj",{}),c()(E()(r),"originCursor",void 0),c()(E()(r),"compositing",!1),c()(E()(r),"readyCommands",{}),r}return v()(n,[{key:"_getFormattingFlags",value:function(e,t){var n=[],r=0;switch(t){case"bold":case"italic":case"underline":case"strikethrough":e.forEach((function(e){var a=e.querySelector("span");("bold"===t?"bold"===(null==a?void 0:a.style.fontWeight):"italic"===t?"italic"===(null==a?void 0:a.style.fontStyle):"underline"===t?null==a?void 0:a.style.textDecorationLine.includes("underline"):null==a?void 0:a.style.textDecorationLine.includes("line-through"))?(r++,n.push(!1)):n.push(!0)})),r===e.length&&(n=n.map((function(){return!0})));break;default:n=e.map((function(){return!0}))}return n}},{key:"batchEdit",value:function(e,t,n){var r,a=this,i=window.getSelection();try{r=null==i?void 0:i.getRangeAt(0)}catch(e){}var o=this._getFormattingFlags(e,t);e.forEach((function(e,r){var c=document.createRange();c.selectNodeContents(e),null==i||i.removeAllRanges(),null==i||i.addRange(c);var l=e.getAttribute("contenteditable");e.setAttribute("contenteditable","true"),"fontSize"===t?(a._execCommand(t,"1"),dl(n,e,c)):o[r]&&a._execCommand(t,n),l||e.removeAttribute("contenteditable")})),null==i||i.removeAllRanges(),r&&(null==i||i.addRange(r))}},{key:"prepareEdit",value:function(){var e=this.dom;if(e){this.updateStartContent();var t=window.getSelection(),n=document.createRange();e.focus(),n.selectNodeContents(e),null==t||t.removeAllRanges(),null==t||t.addRange(n),this.emit("prepareedit")}}},{key:"closest",value:function(e,t){return al(e,t,this.dom)}},{key:"getRange",value:function(){if(!this.dom)return null;var e=window.getSelection();try{var t=null==e?void 0:e.getRangeAt(0);return t&&!this.dom.contains(t.commonAncestorContainer)?null:t}catch(e){return null}}},{key:"_execCommand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];document.execCommand("styleWithCss",!1,"true");var r=document.execCommand(e,n,t);return{result:r,eventObj:{name:e,showUI:n,value:t,result:r,target:void 0}}}},{key:"convertFontSize",value:function(e){var t=this.getRange();dl(e,this.dom,t)}},{key:"execReadyCommand",value:function(){this.readyCommands.fontSize&&this.convertFontSize(this.readyCommands.fontSize.value),this.readyCommands={}}},{key:"execCommand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getRange();if(r&&e){if("fontSize"===e){var a=this._execCommand(e,"1",n),i=a.result,o=a.eventObj;return this.convertFontSize(t),this.afterExecCommand({name:e,value:t,result:i,eventObj:o}),i}if("createLink"===e){var c=this._execCommand(e,t,n),l=c.result,s=c.eventObj;if(l){var u,d,f=null===(u=this.dom)||void 0===u?void 0:u.querySelectorAll("a"),h=null===(d=r=this.getRange())||void 0===d?void 0:d.commonAncestorContainer;if(s.target=al(h,"a",this.dom)||1===h.nodeType&&(null==h?void 0:h.querySelector("a")),f)for(var p=0;p<f.length;p++){var m=f[p];m.setAttribute("target","_blank"),m.style.cursor="default",(!(y=m.getAttribute("href"))||y&&!y.match(/^[\x00-\x7F]/)||y.startsWith("javascript:"))&&m.setAttribute("href","")}}return this.afterExecCommand({name:e,value:t,result:l,eventObj:s}),l}var y,v=this._execCommand(e,t,n),g=v.result,b=v.eventObj;return this.afterExecCommand({name:e,value:t,result:g,eventObj:b}),g}}},{key:"getFirstTag",value:function(e){return cl(e,this.dom)}},{key:"afterExecCommand",value:function(e){var t=e.name,n=e.value,r=e.result,a=e.eventObj,i=this.getRange();if(null!=i&&i.collapsed)if(this.readyCommands[t])Object.assign(this.readyCommands[t],{value:n,result:r,cancel:!this.readyCommands[t].cancel});else{var o=this.getRange(),c=null==o?void 0:o.startContainer,l=c===this.dom?this.getFirstTag("SPAN"):this.closest(c,(function(e){return 1===e.nodeType}));this.readyCommands[t]={value:n,result:r,cancel:!!this.closest(l,(function(e){return il(e,"strikethrough"===t?"line-through":t)}))}}this.emit("execcommand",a),this.emitChangeEvent()}},{key:"emitChangeEvent",value:function(){this.emit("change",{dom:this.dom})}},{key:"emitTextareaKeydownEvent",value:function(e){this.emit("textareaKeydown",e)}},{key:"beginEdit",value:function(){if(this.dom){this.isBegin=!0,this.emit("beginedit",this.eventObj),document.execCommand("styleWithCss",!1,"true"),this.dom.classList.remove("selection-transparent");var e=escape(this.dom.innerText);if(this.dom.style.cursor="text","%u200B"===e||"%u200D"===e){var t=this.getRange();null==t||t.collapse()}this.emit("selectionchange")}}},{key:"forceEndEdit",value:function(){this.isBegin&&(this.endEdit(),this.prepareEdit())}},{key:"updateStartContent",value:function(){var e;this.eventObj&&(this.eventObj.startHTML=xl(null===(e=this.dom)||void 0===e?void 0:e.innerHTML))}},{key:"bind",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.eventHelper,a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cl(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({insertParagraphKey:function(e){},cancelKey:function(e){}},n),i=a.insertParagraphKey,o=a.cancelKey;this.originCursor=e.style.cursor,this.dom=e,e.setAttribute("contenteditable","true"),e.setAttribute("spellcheck","false"),e.focus({preventScroll:!0}),this.eventObj={dom:e},this.updateStartContent(),r.bind(e,"contextmenu",(function(e){t.isBegin&&e.stopPropagation()})),r.bind(document,"selectionchange",(function(){t.compositing||(t.execReadyCommand(),t.emit("selectionchange"))}),{onKey:"addEventListener",offKey:"removeEventListener"}),r.bind(e,"keydown",(function(e){var n=t.dom,r=t.diagram,a=t.getRange(),c=r.viewport.zoom;if(t.emitTextareaKeydownEvent(e),t.isBegin){if(Al("mod+k",e))return e.preventDefault(),e.stopPropagation(),void t.execCommand("createLink",zn("链接"));if(Al("mod+shift+x",e))return e.preventDefault(),e.stopPropagation(),void t.execCommand("strikethrough","");if(i(e))return t.compositing||t.execCommand("insertParagraph",""),e.stopPropagation(),void e.preventDefault();if(o(e))return e.preventDefault(),e.stopPropagation(),void(t.compositing||t.forceEndEdit());if(Al("mod+s",e))return;if(nl(a,n)&&"ArrowLeft"===e.key)return e.preventDefault(),void e.stopPropagation();if(tl(a,n)&&"ArrowRight"===e.key)return e.preventDefault(),void e.stopPropagation();if(function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e.getBoundingClientRect(),i=t.getBoundingClientRect();return n=e.collapsed&&["x","y","width","height"].every((function(e){return 0===a[e]}))&&1===e.commonAncestorContainer.nodeType?e.commonAncestorContainer.getBoundingClientRect().y-i.y:a.y-i.y,(n=Math.abs(n/r))<6}(a,n,c)&&"ArrowUp"===e.key)return e.preventDefault(),void e.stopPropagation();if(function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e.getBoundingClientRect(),i=t.getBoundingClientRect();return n=e.collapsed&&["x","y","width","height"].every((function(e){return 0===a[e]}))&&1===e.commonAncestorContainer.nodeType?e.commonAncestorContainer.getBoundingClientRect().bottom-i.bottom:a.bottom-i.bottom,(n=Math.abs(n/r))<6}(a,n,c)&&"ArrowDown"===e.key)return e.preventDefault(),void e.stopPropagation();e.stopPropagation()}else{if(Al("mod+c",e)||Al("mod+v",e)||Al("mod+x",e)||Al("shift+enter",e)||Al("space",e))return;if(Al("mod+enter",e))return e.preventDefault(),e.stopPropagation(),void t.beginEdit();if(function(e){return!(e.altKey||e.ctrlKey||e.metaKey||["Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Capslock","Esc","Home","Pause","Shift","Option","Alt","Help","Esc","Backspace","Delete","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(e.key))}(e))return e.stopPropagation(),void t.beginEdit();e.preventDefault()}})),r.bind(e,"compositionstart",(function(){t.compositing=!0})),r.bind(e,"compositionend",(function(){t.compositing=!1})),r.bind(e,"input",(function(e){e.stopPropagation(),t.isBegin?t.emitChangeEvent():e.preventDefault()})),r.bind(e,"paste",sl.bind(this)),r.bind(e,"copy",ul.bind(this)),r.bind(e,"cut",(function(e){ul.call(t,e,"cut")}))}},{key:"endEdit",value:function(){this.isBegin=!1,this.dom&&(this.eventObj.endHTML=xl(this.dom.innerHTML),this.dom.style.cursor=this.originCursor,this.dom.classList.add("selection-transparent")),this.emit("endedit",this.eventObj)}},{key:"unbind",value:function(){var e=this.dom,t=this.eventHelper;e&&(e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck"),t.unbind(),this.endEdit(),this.dom=void 0)}},{key:"query",value:function(){return ll(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dom,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getRange(),arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.readyCommands)}},{key:"destroy",value:function(){this.unbind()}}]),n}();c()(Ol,"className","ContentEditor");var El=function(){function e(t){m()(this,e),c()(this,"graphicGroup",void 0),c()(this,"dx",0),c()(this,"dy",0),this.graphicGroup=t}return v()(e,[{key:"translate",value:function(e,t){this.graphicGroup.update({matrix:[1,0,0,0,1,0,e,t,1]}),this.dx=e,this.dy=t}},{key:"getBBox",value:function(){return this.graphicGroup.getBBox()}},{key:"destroy",value:function(){this.graphicGroup.destroy()}}]),e}(),Pl=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"delegations",[])}return v()(e,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.diagram,n=new Zr;"function"==typeof e?e(n):((e=e.map((function(e){return t.find(e)})).filter((function(e){return e}))).sort((function(e,t){return e.getZIndex()-t.getZIndex()})),e.forEach((function(e){var t=new ea({element:e.graphicGroup});n.add(t)}))),t.frontRootGroup.prepend(n);var r=new El(n);return this.delegations.push(r),r}},{key:"clear",value:function(){var e=this;this.delegations.forEach((function(t){e.remove(t)}))}},{key:"remove",value:function(e){var t=this.delegations;t.splice(t.indexOf(e),1),e.destroy()}},{key:"destroy",value:function(){this.delegations=[]}}]),e}();c()(Pl,"className","Delegator");var Sl=function(e,t){var n={};return t.forEach((function(t){var r=e.find(t);if(r){var a=r.mindmapParent;if(a&&a.isMindmap){var i=a.model.id,o=a.getChildren().indexOf(r),c=a.isTwoQuadrantLayout,l=o;if(c){var s,u,d=null!==(s=null===(u=r.model.layout)||void 0===u?void 0:u.quadrant)&&void 0!==s?s:1;i+=":"+d;var f=a.quadrantTreeLists[d-1];if(!f)throw new Error("no correct quad index list"+JSON.stringify(a.quadrantTreeLists));l=f.indexOf(o)}if(r.model.abstract){var h,p,m={id:r.model.id,index:o,q:c?null!==(h=null===(p=r.model.layout)||void 0===p?void 0:p.quadrant)&&void 0!==h?h:1:void 0,start:r.model.start,end:r.model.end};n[i]?n[i].abstracts.push(m):n[i]={indexes:[],childrenIds:[],childrenLength:a.model.children.filter((function(e){return!e.abstract})).length,abstracts:[m]}}else l>=0&&(n[i]?(n[i].indexes.push(l),n[i].childrenIds.push(r.model.id)):n[i]={indexes:[l],childrenIds:[r.model.id],childrenLength:a.model.children.filter((function(e){return!e.abstract})).length,abstracts:[]})}}})),n};function jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jl(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ml=function(e,t,n){var r,a,i="mindmap"===e.type;if(t&&t.isMindmap){if(delete e.type,delete e.x,delete e.y,delete e.zIndex,e.children){var o=e.layout,c=void 0===o?{}:o,l=c.type,s=void 0===l?"standard":l,u=c.quadrantConstraint,d=void 0===u?[1,2]:u;if(!i||"standard"!==s||null!==d&&2!==d.length)e.children.forEach((function(e){var t;2===(null===(t=e.layout)||void 0===t?void 0:t.quadrant)&&(e.layout.quadrant=1)}));else{e.children.sort((function(e,t){var n=e.layout,r=(void 0===n?{}:n).quadrant,a=void 0===r?1:r,i=e.abstract,o=t.layout,c=(void 0===o?{}:o).quadrant,l=void 0===c?1:c,s=t.abstract;return i&&s||!i&&!s?a-l:i?1:s?-1:0}));var f=e.children.filter((function(e){var t=e.layout,n=(void 0===t?{}:t).quadrant,r=void 0===n?1:n,a=e.abstract;return 1===r&&!a}));e.children.forEach((function(e){var t=e.layout,n=(void 0===t?{}:t).quadrant,r=void 0===n?1:n,a=e.abstract,i=e.start,o=void 0===i?0:i,c=e.end,l=void 0===c?0:c;return 2===r&&a&&(e.start=o+f.length,e.end=l+f.length),0}))}}}else e.layout&&delete e.layout.quadrant,delete e.collapsed,delete e.abstract,delete e.start,delete e.end,e.type="mindmap",e.layout=null!==(r=e.layout)&&void 0!==r?r:{type:"standard"},e.layout.type=null!==(a=e.layout.type)&&void 0!==a?a:"standard",i||e.children.forEach((function(e){e.layout&&(e.layout.quadrant=1)}));return e},Ll=function(e,t){t=t.concat([]);var n=Sl(e,t),r=[{},{}],a=t.filter((function(e){return!e.isMindmap})),i=a.map((function(e){return s()(e.model)})),o=t.filter((function(e){return e.isMindmap&&e.isStem})),c=o.length;a.push.apply(a,D()(o)),o.forEach((function(e){var t,n=s()(e.model);null!==(t=n.layout)&&void 0!==t&&t.quadrant&&delete n.layout.quadrant,i.push(n)})),Object.keys(n).forEach((function(t){var a=t.split(":"),i=b()(a,2),o=i[0],c=i[1],l=void 0===c?void 0:parseInt(c),s=null!=l?l:1,u=n[t],d=u.indexes,f=u.abstracts,h=u.childrenIds,p=u.childrenLength,m=e.find(o),y={normal:[],abstract:[]};h.forEach((function(t,n){var r=e.find(t);if(r){var a={cell:r,quadIndex:d[n]};y.normal.push(a)}})),m.getChildren().filter((function(e){return e.model.abstract&&e.realQuadrant===s})).forEach((function(e,t){var n=e.model,r=n.id,a=n.start,i=n.end,o=le()(a,i+1).every((function(e){return d.includes(e)}));if(o){var c={cell:e,quadIndex:t};y.abstract.push(c)}else if(f.find((function(e){return r===e.id}))){var l={cell:e,quadIndex:t+p};y.normal.push(l)}})),r[s-1][t]=y})),r.forEach((function(e,t){Object.keys(e).forEach((function(n){var r,o,c=(null!==(r=null===(o=e[n])||void 0===o?void 0:o.normal)&&void 0!==r?r:[]).sort((function(e,t){return e.quadIndex-t.quadIndex}));a.push.apply(a,D()(c.map((function(e){return e.cell})))),i.push.apply(i,D()(c.map((function(e){var n=s()(e.cell.model),r=e.cell,a=r.x,i=r.y;return delete n.abstract,delete n.start,delete n.end,n.x=a,n.y=i,n.layout=Rl(Rl({},n.layout),{},{quadrant:t+1}),n}))))}))})),r.forEach((function(e,t){Object.keys(e).reduce((function(r,o){var c,l,u,d,f=n[o].indexes.sort(),h=null!==(c=null===(l=e[o])||void 0===l?void 0:l.normal)&&void 0!==c?c:[],p=(null!==(u=null===(d=e[o])||void 0===d?void 0:d.abstract)&&void 0!==u?u:[]).sort((function(e,t){return e.quadIndex-t.quadIndex}));return a.push.apply(a,D()(p.map((function(e){return e.cell})))),i.push.apply(i,D()(p.map((function(e){var n=s()(e.cell.model),a=e.cell,i=a.x,o=a.y;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.start,a=e.end;if(e.start=t.indexOf(r)+n,e.end=t.indexOf(a)+n,e.start===n-1||e.end===n-1)throw new Error("wrong s and e for trans: ".concat(e.start,", ").concat(e.end))}(n,f,r),n.x=i,n.y=o,n.layout&&(n.layout.quadrant=t+1),n})))),r+h.length}),c)}));var l=e.deduplicate(a),u=i.filter((function(e){return l.find((function(t){return t.model.id===e.id}))}));return[l,u]},Bl=function(e,t,n,r,a){var i=[],o=[],c=[];if(t&&En(t)){var l,s=t.isTwoQuadrantLayout;i.push.apply(i,D()(e.filter((function(e){return!!a&&!a(e)})))),i.forEach((function(){o.push({})}));var u=e.filter((function(e){return!a||a(e)}));s||(n=1);var d=[[],[]],f=[[],[]],h=1,p=null!==(l=t.model.children)&&void 0!==l?l:[],m=p.filter((function(e){return e.abstract})),y=p.length-m.length,v=t.quadrantTreeLists,g=[-1,-1];u.forEach((function(e){var t,n=(null===(t=e.layout)||void 0===t?void 0:t.quadrant)||1;e.abstract||(n>h?h=n:h>n&&(n=h,void 0===e.layout&&(e.layout={}),e.layout.quadrant=n),d[n-1].push(e))})),u.forEach((function(e){if(e.abstract){var t=e.start,n=e.end,r=e.layout,a=(void 0===r?{}:r).quadrant,i=void 0===a?1:a,o=d[i-1].length;t>g[i-1]&&t<=n&&n<o?(g[i-1]=n,f[i-1].push(e)):at(e,(function(e){c.push(e.id)}))}})),n&&(d.forEach((function(e){e.forEach((function(e){void 0===e.layout&&(e.layout={}),e.layout.quadrant=n}))})),f.reduce((function(e,t,r){return t.forEach((function(t){t.start+=e,t.end+=e,void 0===t.layout&&(t.layout={}),t.layout.quadrant=n})),e+d[r].length}),0),d=[oe()(d)],f=[oe()(f)]),d.reduce((function(e,a,c){var l=n?n-1:c,s=void 0===r||r>=v[l].length,u=0===l?0===v[l].length?0:v[l][v[l].length-1]+1:y,d=s?u:v[l][r];return a.forEach((function(n,r){Ml(n,t),i.push(n);var a={nth:d+r+e,parent:t.model.id};o.push(a)})),e+a.length}),0),d=[oe()(d)],f.reduce((function(e,a,l){var u=n?n-1:l,f=v[u],h=null!=r?r:f.length,p=m.some((function(e){var t=e.start,n=e.end,r=e.layout,a=(void 0===r?{}:r).quadrant;return u+1===(s?void 0===a?1:a:1)&&t<h&&h<=n}));if(!p){var g=m.findIndex((function(e,t){var n=e.start,r=e.layout,a=(void 0===r?{}:r).quadrant,i=s?void 0===a?1:a:1;return i>u+1||u+1===i&&n>=h})),b=y+d[0].length+(-1===g?m.length:g);return a.forEach((function(n,r){n.start+=h,n.end+=h,Ml(n,t),i.push(n);var a={nth:b+r+e};t&&(a.parent=t.model.id),o.push(a)})),e+a.length}return a.forEach((function(e){at(e,(function(e){c.push(e.id)}))})),e}),0)}else e.forEach((function(e){(!a||a(e))&&Ml(e),i.push(e);var n={};t&&(n.parent=t.model.id),o.push(n)}));return[i,o,c]};function Dl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Il(e,t){var n=t.left,r=t.top,a=t.width,i=t.height,o=t.padding;e.setAttribute("viewBox",[n-o,r-o,a+2*o,i+2*o].join(",")),e.setAttribute("width","".concat(a)),e.setAttribute("height","".concat(i)),e.style.width="".concat(a,"px"),e.style.height="".concat(i,"px")}function Tl(e){return"jpg"===e||"jpeg"===e}function _l(e){var t=(new XMLSerializer).serializeToString(e);return t=t.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/[\x00-\x1F\x7F-\x9F]/g,""),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+t)))}function Fl(e){return zl.apply(this,arguments)}function zl(){return zl=G()(V.a.mark((function e(t){var n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},r=Object.keys(t).map(function(){var e=G()(V.a.mark((function e(r){var a,i,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t[r],e.next=3,fetch(a).then((function(e){return e.blob()}));case 3:return i=e.sent,e.next=6,new Promise((function(e){var t=new FileReader;t.onload=function(){e(t.result)},t.readAsDataURL(i)}));case 6:o=e.sent,n[r]=o;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(r);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),zl.apply(this,arguments)}function ql(e){return Yl.apply(this,arguments)}function Yl(){return Yl=G()(V.a.mark((function e(t){var n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r=t.map(function(){var e=G()(V.a.mark((function e(t){var r,a,i;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,a=t.fontURL,i=t.fontWeight,e.abrupt("return",Fl(a).then((function(e){n.push({name:r,fontDataURL:e,fontWeight:i})})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(r);case 4:return e.abrupt("return",n.map((function(e){var t=e.fontDataURL,n="@font-face{font-family:".concat(e.name,";src:");return Object.entries(t).forEach((function(e,r){var a=b()(e,2),i=a[0],o=a[1];r===Object.keys(t).length-1?n+="url(".concat(o,")format(").concat(i,");"):n+="url(".concat(o,")format(").concat(i,"),")})),n+="font-weight:".concat(e.fontWeight,";font-style:normal;}")})).join(""));case 5:case"end":return e.stop()}}),e)}))),Yl.apply(this,arguments)}function Hl(e,t){var n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;var r=e.querySelector("defs");r?r.appendChild(n):e.insertBefore(n,e.firstChild)}function Gl(e,t){if(t.image&&t.image.src){var n=document.createElement("img");n.setAttribute("src",t.image.src),e.appendChild(n)}}function Xl(e,t){if(t.noteContent){var n=document.createElement("p");n.textContent=t.noteContent,e.appendChild(n)}}function Vl(e){var t=document.createElement("td");return e.textContent&&(t.textContent=e.textContent),Gl(t,e),Xl(t,e),t}var Wl=function(){function e(t){m()(this,e),this.diagram=t}var t,n,r;return v()(e,[{key:"canvas",value:(r=G()(V.a.mark((function e(){var t,n,r,a,i,o,c,l,s,u,d,f,h,p,m,y=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=y.length>0&&void 0!==y[0]?y[0]:{}).backgroundColor,r=t.paperClip,a=t.base64EncodedFonts,i=t.cells,o=this.svg(i),r&&(c=this.diagram.paper,l=c.size,Il(o,{left:0,top:0,width:l[0],height:l[1],padding:2})),a&&Hl(o,a),e.next=7,Promise.all(Array.from(o.querySelectorAll("image"),function(){var e=G()(V.a.mark((function e(t){var n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.getAttribute("href"))){e.next=6;break}return e.next=4,gi(n);case 4:(r=e.sent)&&t.setAttribute("href",r.toDataURL("image/png"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).concat(Array.from(o.querySelectorAll("img"),function(){var e=G()(V.a.mark((function e(t){var n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.getAttribute("src"))){e.next=6;break}return e.next=4,gi(n);case 4:(r=e.sent)&&t.setAttribute("src",r.toDataURL("image/png"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 7:return s=parseFloat((null==o?void 0:o.getAttribute("width"))||"0"),u=parseFloat((null==o?void 0:o.getAttribute("height"))||"0"),d=s/u,f=window.devicePixelRatio>2?window.devicePixelRatio:2,t.width&&null==t.height?(h=t.width,p=t.width/d):t.height&&null==t.width?(p=t.height,h=t.height*d):t.width&&t.height?(h=t.width,p=t.height):(h=s,p=u),m=_l(o),e.next=15,gi(m,{backgroundColor:n,width:h,height:p,ratio:f});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"json",value:function(e){var t=this.diagram,n={head:Nl({},t.head),body:[]};return e?e.forEach((function(e){var t=e.model;if(null!=t&&t.type){var r=s()(e.model);n.body.push(r)}})):t.rootGroup.rendererElement.childNodes.forEach((function(e,r){var a=t.getCell(e);if(a&&(a.model.zIndex=r,a.isRoot&&!a.model.isPlaceholder)){var i=s()(a.model);i.children&&0===i.children.length&&delete i.children,at(i,(function(){void 0!==i.html&&(i.html=xl(i.html))})),n.body.push(i)}})),n}},{key:"svg",value:function(e,t){t=Nl({type:"default"},t);var n=function(e,t){var n,r,a=e.getCells(),i=a.filter((function(e){return e.state.beginEdit||e.state.selected||e.state.highlight}));i.forEach((function(e){e.setDefault()})),t&&a.forEach((function(e){e.graphicGroup.rendererElement.setAttribute("data-id",e.model.id)}));var o=e.canvas.rendererElement.cloneNode(!0),c=o.querySelectorAll("foreignObject");if(o.querySelectorAll("image").forEach((function(e){var t=e.getAttribute("href");t&&t.startsWith("blob:")&&e.setAttribute("href","")})),null===(n=o.querySelector('[data-element="front_group"]'))||void 0===n||n.remove(),null===(r=o.querySelector('[data-element="back_group"]'))||void 0===r||r.remove(),o.style["background-color"]=null,t)for(var l=o.querySelectorAll("[data-id]"),s=0;s<l.length;s++){var u=l[s],d=u.getAttribute("data-id");d&&t.includes(d)||u.remove()}return c&&c.forEach((function(e){var t=e.getAttribute("width");t&&(t=Number(t))>0&&(t+=4,e.setAttribute("width",String(t)))})),i.forEach((function(e){e.updateState()})),t&&a.forEach((function(e){e.graphicGroup.rendererElement.removeAttribute("data-id")})),function(e){e.style.position="fixed",e.style.visibility="hidden",document.body.appendChild(e),Il(e,Object.assign(function(e){var t=1/0,n=1/0,r=-1/0,a=-1/0;return Array.from(e.childNodes).filter((function(e){return"root_group"===e.dataset.element})).forEach((function(e){if("defs"!==e.tagName.toLowerCase()){var i=e.getBBox(),o=i.x,c=i.y,l=i.width,s=i.height;o<t&&(t=o),o+l>r&&(r=o+l),c<n&&(n=c),c+s>a&&(a=c+s)}})),{left:t,top:n,width:r-t,height:a-n}}(e),{padding:2})),e.style.position="relative",e.style.visibility="visible",document.body.removeChild(e)}(o),o}(this.diagram,e&&e.map((function(e){return e.model.id}))),r=t.type;return"string"===r||"dom-string"===r?'<?xml version="1.0" encoding="utf-8"?>'+(new XMLSerializer).serializeToString(n):n}},{key:"image",value:function(){var e=this.svg(),t=new Image;return t.src=_l(e),t}},{key:"blob",value:(n=G()(V.a.mark((function e(){var t,n,r,a,i,o,c,l=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:"jpeg",n=l.length>1&&void 0!==l[1]?l[1]:{},r=this.diagram,Tl(t)&&(n.backgroundColor=null==r||null===(a=r.theme)||void 0===a||null===(i=a.values)||void 0===i?void 0:i.canvasBackgroundColor),window[or]){e.next=8;break}return e.next=7,ql(cr);case 7:window[or]=e.sent;case 8:return o=window[or],e.next=11,this.canvas(Nl(Nl({},n),{},{base64EncodedFonts:o}));case 11:return c=e.sent,e.abrupt("return",new Promise((function(e){null==c||c.toBlob(e,"image/".concat(t),"jpeg"===t?.8:1)})));case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"download",value:(t=G()(V.a.mark((function e(){var t,n,r,a,i,o,c,l,s,u,d=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:"jpeg",n=d.length>1&&void 0!==d[1]?d[1]:{},r=this.diagram,Tl(t)&&(n.backgroundColor=null==r||null===(a=r.theme)||void 0===a||null===(i=a.values)||void 0===i?void 0:i.canvasBackgroundColor),window[or]){e.next=8;break}return e.next=7,ql(cr);case 7:window[or]=e.sent;case 8:return o=window[or],e.next=11,this.canvas(Nl(Nl({},n),{},{base64EncodedFonts:o}));case 11:c=e.sent,l=document.createElement("a"),s=n.filename||"yuque_diagram",l.download="".concat(s,".").concat(t),c&&((u=c.toDataURL("image/".concat(t))).length<20?ne.a.warn(zn("画布尺寸过大，导出图片失败")):"default"!==r.rough.name&&U.ua.windows?ne.a.warn(zn("无法导出手绘字体，可能导致图片失真")):(l.href=u,l.click()));case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_textContent",value:function(e){return e?function(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}(e):""}},{key:"doc",value:function(e){var t=this,n=document.createElement("div");return e.forEach((function(e){at(e,(function(e){if(pt(e.depth,[0,3])){if(e.textContent){var r=document.createElement("h".concat(e.depth+1));r.textContent=e.textContent,n.appendChild(r)}return Gl(n,e),void Xl(n,e)}return t.list([e]).childNodes.forEach((function(e){n.appendChild(e)})),!1}))})),n}},{key:"table",value:function(e){var t=document.createElement("table");e.forEach((function(e){at(e,(function(e,n){if(e.parent=n,!e.children||0===e.children.length){var r=document.createElement("tr"),a=Vl(e);for(r.prepend(a);n;){var i=Vl(n);r.prepend(i),n=n.parent}t.appendChild(r)}}))}));var n=0;return t.childNodes.forEach((function(e){var t=e.childNodes.length;t>n&&(n=t)})),t.childNodes.forEach((function(e){for(var t=e.childNodes.length,r=0;r<n-t;r++){var a=document.createElement("td");e.appendChild(a)}})),t}},{key:"list",value:function(e){var t=document.createElement("div");return e.forEach((function(e){var n=document.createElement("ul");at(e,(function(e,t){e.level=t?t.level+1:1;var r=document.createElement("li");t?t.childContainer.appendChild(r):n.appendChild(r),e.textContent&&(r.textContent=e.textContent),Gl(r,e),Xl(r,e),e.children&&e.children.length>0&&(e.childContainer=document.createElement("ul"),t?t.childContainer.appendChild(e.childContainer):n.appendChild(e.childContainer))})),t.appendChild(n)})),t}},{key:"dom",value:function(e){var t=this,n=this.diagram,r=n.settings.copyType;e||(e=n.getCells().filter((function(e){return e.isStem}))),e=n.deduplicate(e);var a=Ll(n,e),i=b()(a,2),o=i[0],c=i[1],l=document.createElement("div"),u=document.createElement("div"),d=[];o.forEach((function(e){d=d.concat(e.getAllCells())}));var f=d.reduce((function(e,t){var n=s()(t.computedProps)||{};if("line"===t.type)n.points=t.getPoints();else if(Dn(t)){var r=t.getPointBox();n.topLeft=[r.minX,r.minY],n.points=s()(t.model.points)}return n.swimlane=t.swimlane,n.x=t.x,n.y=t.y,Cn(t)&&(n.x=null,n.y=null),n.rootType=t.stem.type,n.nth=t.getNth(),n.hasParent=!!t.parent,e[t.model.id]=n,e}),{})||{};u.dataset.lake_diagram_body=JSON.stringify(c);var h,p=JSON.stringify(f);return u.dataset.lake_extra_informations=p,l.appendChild(u),c.forEach((function(e,n){e.depth=null==o?void 0:o[n].depth,it(e,(function(e,t){e.depth=t.depth+1})),at(e,(function(e){e.textContent=t._textContent(e.html),e.note&&e.note.content&&(e.noteContent=t._textContent(e.note.content))}))})),h="doc"===r?this.doc(c):"table"===r?this.table(c):this.list(c),l.appendChild(h),l}},{key:"html",value:function(){return this.dom().outerHTML}},{key:"getText",value:function(){return this.dom().innerText}},{key:"clipboard",value:function(e){var t=this.dom(e);return{html:t.innerHTML,text:t.textContent}}},{key:"destroy",value:function(){}}]),e}();c()(Wl,"className","Exporter");var Zl=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new Zr),c()(this,"eventHelper",new fl),c()(this,"arr",[]),c()(this,"destroyed",!1),this.group.css({"pointer-events":"none"})}return v()(e,[{key:"bind",value:function(){var e=this,t=this.diagram,n=this.eventHelper;n.unbind(),n.bind(t,"afterchange",(function(t){var n=t.action;e.arr.length>0&&("update"===n||"delete"===n)&&e.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(e){var t=this.diagram.viewport.zoom;e=e.filter((function(e){return e.multiSelectHighlight&&e.state.visible})),this.render(e,(function(e){return e.isLine?{type:"outline",shapeStyle:{fill:"none",stroke:wr,"stroke-width":2/t}}:{type:"rect",shapeStyle:{fill:"none",stroke:"#fff","stroke-width":1/t},shadowStyle:{fill:"none",stroke:wr,"stroke-width":1/t}}}))}},{key:"render",value:function(e,t){var n=this.group,r=this.diagram;vt(e,this.arr.map((function(e){return e.cell})))||(this.clear(),e&&!e.some((function(e){return!e||!e.isCell}))&&(r.frontRootGroup.add(n),this.bind(),this.arr=e.map((function(e){var r=t(e),a=r.type,i=r.shapeStyle,o=r.shadowStyle,c={cell:e,type:"function"==typeof a?a(e):a,shape:i&&new aa(i),shadow:o&&new aa(o)};return c.shadow&&n.add(c.shadow),c.shape&&n.add(c.shape),c})),this.draw()))}},{key:"_updateShape",value:function(e){var t=e.cell,n=e.type,r=e.shape,a=e.shadow,i=t.getKeyShape();if(i){var o,c=i.attr("stroke-width"),l=c/2,s=t.graphicGroup.matrix.concat([]),u=i.getBBox();if(o="outline"===n?i.attr("d"):un(-l,-l,u.width+c,u.height+c),r.update({matrix:s,d:o}),a){var d=parseFloat(a.attr("stroke-width"))+parseFloat(r.attr("stroke-width")),f=u.width+c,h=u.height+c,p=o;t.isLine||(p=ue()(o).scale(1+d/f,1+d/h).translate(-d/2,-d/2).toString()),a.update({matrix:s,d:p})}}}},{key:"_draw",value:function(){var e=this;this.arr.forEach((function(t){e._updateShape(t)}))}},{key:"draw",value:function(){this.arr.length>0&&this._draw()}},{key:"clear",value:function(){this.destroyed||0===this.arr.length||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.arr=[],this.destroyed=!0}}]),e}();c()(Zl,"className","Highlight");var Ul=function(){function e(t){m()(this,e),this.diagram=t}return v()(e,[{key:"json",value:function(e){this.diagram.add(e.body)}},{key:"clipboard",value:function(e,t){return"clipboard"}},{key:"destroy",value:function(){}}]),e}();c()(Ul,"className","Importer");var Kl=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e}},{key:"reset",value:function(){}}]),n}();var Ql=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ki(t)&&!t.shiftKey&&"z"===t.key?(e.command.execute("Undo"),e.tryFocus()):(ki(t)&&"y"===t.key||ki(t)&&t.shiftKey&&wi(t,"z"))&&(e.command.execute("Redo"),e.tryFocus())}))}}]),n}();var Jl=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){if(ki(t)&&"/"===t.key){if(e.command.enable("Collapse"))return e.command.execute("Collapse");if(e.command.enable("Expand"))return e.command.execute("Expand")}}))}}]),n}();var $l=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=e.selector;this.bind(window,"mousedown",(function(n){var r=e.selector.selections,a=e.getCell(n.target);if(!(a&&a.state.selected&&e.contentEditor.isBegin)){if(a)if(n.shiftKey||(U.ua.macos?n.metaKey:n.ctrlKey))if(r.includes(a))t.select(r.filter((function(e){return e!==a})));else{var i=a.parent,o=!1;if(n.shiftKey&&a.isMindmap&&null!=i&&i.isMindmap&&!a.isAbstract)for(var c=function(){var e=r[l];if(e.isMindmap&&!e.isAbstract){var n=e.parent,c=e.realQuadrant;if(n===i&&a.realQuadrant===c){var s=n.quadrantTreeLists[c-1],u=[s.findIndex((function(t){return t===e.getNth()})),s.findIndex((function(e){return e===a.getNth()}))].sort(),d=b()(u,2),f=d[0],h=d[1],p=n.getChildren(),m=[];return le()(f,h+1).forEach((function(e){var t=s[e];m.push(p[t])})),t.select(fe()(r.concat(m))),o=!0,1}}},l=r.length-1;l>=0&&!c();l--);o||t.select(r.concat([a]))}else r.includes(a)||t.select([a]);else Ct(n.target,(function(e){var t,n;return(null==e||null===(t=e.dataset)||void 0===t?void 0:t.lake_prevent_click_unselect)||(null==e||null===(n=e.classList)||void 0===n?void 0:n.contains("lake-diagram-prevent-mouse-select"))}),window.document,(function(e){return e.parentNode}),(function(e){return!e}))||r.length>0&&t.clear();a&&a.state.selected&&!e.contentEditor.isBegin&&n.preventDefault()}}))}}]),n}();var es=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"collapsedbutton:click",(function(t){var n=t.nativeEvent,r=t.cell;if(n.stopPropagation(),n.target.closest("[data-diagram-collapsed-button=true]")){if(e.command.enable("Collapse"))return e.command.execute("Collapse",{onlyCell:r});if(e.command.enable("Expand"))return e.command.execute("Expand",{onlyCell:r})}}))}}]),n}();var ts=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"scroll",(function(e){(e.ctrlKey||U.ua.macos&&e.metaKey)&&(e.preventDefault(),e.stopPropagation())})),this.bind(e,"wheel",(function(t){if(t.ctrlKey||U.ua.macos&&t.metaKey){t.preventDefault(),t.stopPropagation();var n=t.wheelDelta||-t.deltaY;if(e.emit("wheelzoom"),Math.abs(n)>0){var r=e.viewport.zoom;n>0?e.viewport.setViewport(1.05*r):e.viewport.setViewport(r*(1/1.05))}}}))}}]),n}();var ns=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"copy",(function(t){e.command.execute("Copy",{e:t})}))}}]),n}();var rs=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"cut",(function(t){e.command.execute("Cut",{e:t})}))}}]),n}();var as=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"paste",(function(t){t.preventDefault(),e.command.execute("Paste",{e:t})}))}}]),n}();var is=U.HotKeyUtils.isHotkey,os=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){is("mod+=",t)?(t.preventDefault(),e.command.execute("ZoomIn")):is("mod+shift+=",t)?(t.preventDefault(),e.command.execute("FitViewport")):is("mod+-",t)?(t.preventDefault(),e.command.execute("ZoomOut")):is("mod+0",t)?e.command.execute("ActualSize"):is("mod+8",t)&&e.command.execute("FocusSelection")}))}}]),n}();var cs=document.createElement("div"),ls=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=e.contentEditor;this.bind(t,"change",(function(t){var n=t.dom,r=e.getCell(n);!e.signal.preventUpdateCellContent&&r&&e.update(r,{html:n.innerHTML})})),this.bind(t,"beginedit",(function(t){var n=t.dom;e.signal.contentEditing=!0;var r=e.getCell(n);r&&r.beginEditContent()})),this.bind(t,"endedit",(function(t){var n=t.dom,r=t.startHTML,a=t.endHTML;e.signal.contentEditing=!1;var i=e.getCell(n);i&&(i.endEditContent(),cs.innerHTML=a,""===cs.textContent&&(a=-1!==a.indexOf("<br>")?a.replace("<br>","".concat(er,"<br>")):er),r!==a&&a!==er?e.command.execute("UpdateCellContent",{id:i.model.id,startHTML:r,endHTML:a}):i.shouldRefreshEndEditContent()&&e.update(i))}))}}]),n}();var ss=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t;this.bind(e,"mousedown",(function(n){clearTimeout(t),t=setTimeout((function(){e.getCell(n.target)?e.tryFocus():e.focus()}))}))}}]),n}(),us=function(e){return e.reduce((function(e,t){return Sn(t)?e.push.apply(e,D()(t.children)):wn(t)?e.push.apply(e,[t].concat(D()(t.children))):e.push(t),e}),[])};var ds=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),e=t.call(this),c()(E()(e),"selections",void 0),c()(E()(e),"lines",void 0),e.selections=[],e.lines=void 0,e}return v()(n,[{key:"init",value:function(e){var t=this;this.bind(e,"afterselect",(function(e){var n=e.selections,r=t.lines;if(1===n.length){if(function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].model.id!==t[n].model.id)return!1;return!0}(t.selections,n))return void(r&&r.forEach((function(e){return e.resizer.update()})));r&&r.forEach((function(e){return e.resizer.end()})),t.lines=n.filter((function(e){return xn(e)})),t.lines.forEach((function(e){return e.resizer.begin()}))}else r&&r.forEach((function(e){return e.resizer.end()})),t.lines=void 0;t.selections=n}))}}]),n}(),fs=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"_currentMode",null),c()(this,"defaultCursor","default"),c()(this,"defaultCursors",{read:"grab"}),c()(this,"modes",void 0),this.modes={edit:[new Ql,new Jl,new $l,new es,new ts,new ns,new rs,new as,new os,new ls,new ss,new ds],read:[new Jl,new $l,new es,new os,new ts,new ss,new ns],none:[]}}return v()(e,[{key:"currentMode",get:function(){return this._currentMode||"read"},set:function(e){this._currentMode=e}},{key:"_removeCurrentMode",value:function(){var e;this.currentMode&&(null===(e=this.modes[this.currentMode])||void 0===e||e.forEach((function(e){e.reset(),e.unbind()})))}},{key:"init",value:function(e){this.changeMode(e)}},{key:"addDefaultCursor",value:function(e){Object.assign(this.defaultCursors,e)}},{key:"registerMode",value:function(e,t){var n,r=this.modes;r[e]?r[e]=null===(n=r[e])||void 0===n?void 0:n.concat(t):this.modes[e]=t}},{key:"getModeCursor",value:function(){return this.defaultCursors[this.currentMode]||this.defaultCursor}},{key:"changeMode",value:function(e){var t=this,n=this.modes[e],r=this.diagram;r.selector.clear(),r.emit("beforemodechange",e),this._removeCurrentMode(),null==n||n.forEach((function(e){e.diagram=t.diagram,e.init(t.diagram)}));var a=r.viewportContainer;this.currentMode!==e&&(a.dataset.lakeBoardMode=e),this.currentMode=e,r.emit("aftermodechange");var i=this.defaultCursors[e]||this.defaultCursor;this.diagram.setCursor(i)}},{key:"destroy",value:function(){this._removeCurrentMode()}}]),e}();c()(fs,"className","Interaction");var hs=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"fill",{color:"#ffffff"}),c()(this,"eventHelper",new fl),c()(this,"visible",void 0),c()(this,"size",void 0),c()(this,"element",void 0),this.diagram=t}return v()(e,[{key:"init",value:function(e){Object.assign(this,{size:[200,200]},e),this.visible&&this.render(),this.bind()}},{key:"calculateBBox",value:function(){var e=this.diagram,t=this.size,n=e.rootGroup.getBBox(),r=e.viewport.zoom;if("auto"===t){var a={},i=e.width/r,o=e.height/r;if(n.width<i){var c=n.x+n.width/2,l=i/2;a.left=c-l,a.right=c+l}else a.left=n.x,a.right=n.x+n.width;if(n.height<o){var s=n.y+n.height/2,u=o/2;a.top=s-u,a.bottom=s+u}else a.top=n.y,a.bottom=n.y+n.height;return a}return 0===n.width&&0===n.height?Array.isArray(t)?{top:0,bottom:t[1],left:0,right:t[0]}:{top:0,bottom:e.height,left:0,right:e.width}:{top:Math.floor(n.y/t[1])*t[1],bottom:Math.ceil((n.y+n.height)/t[1])*t[1],left:Math.floor(n.x/t[0])*t[0],right:Math.ceil((n.x+n.width)/t[0])*t[0]}}},{key:"getBBox",value:function(){return this.calculateBBox()}},{key:"render",value:function(){var e=this.diagram,t=this.size,n=this.fill,r=e.defs,a=e.backRootGroup,i=Object(F.a)(),o=new Ia,c=new Ba({dx:0,dy:2,stdDeviation:8,"flood-color":"rgba(115, 115, 115, 0.08)"});o.attr({id:i}),o.add(c),r.add(o);var l=b()(t,2),s=l[0],u=l[1],d=new va({x:0,y:0,width:s,height:u,fill:n.color});d.css({filter:"url(#".concat(i,")"),"pointer-events":"none"}),a.add(d),this.element=d}},{key:"bind",value:function(){var e=this;if(this.visible){var t=pe()((function(){e.update()}),16);this.eventHelper.bind(this.diagram,"afterviewportchange",t)}}},{key:"update",value:function(e){e&&Object.assign(this,e);var t=this.diagram,n=this.fill,r=this.size;if(this.visible){this.element||this.render();var a=b()(r,2),i=a[0],o=a[1],c=t.viewport.paperBox,l=c.left,s=c.top;this.element.update({x:l,y:s,width:i,height:o,fill:n&&n.color||"#fff"})}}},{key:"destroy",value:function(){this.element&&this.element.destroy(),this.eventHelper.destroy()}}]),e}();c()(hs,"className","Paper");var ps=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"behaviours",void 0),this.behaviours=[]}return v()(e,[{key:"init",value:function(e){var t=this;e.forEach((function(e){t.registerPlugin(e)}))}},{key:"registerCell",value:function(e){var t=this.diagram;t&&(t.Cells[e.className]=e)}},{key:"registerPlugin",value:function(e){var t=this,n=this.diagram;if(n){var r=e.Cells,a=e.Commands,i=e.Extends,o=e.modes,c=e.defaultCursors,l=e.dataProcessor,s=e.settings;r&&r.forEach((function(e){t.registerCell(e)})),o&&o.forEach((function(e){var r=e.mode,a=e.Behaviours.map((function(e){return e instanceof Kl?e:new e}));n.interaction.registerMode(r,a),t.behaviours=t.behaviours.concat(a)})),a&&a.forEach((function(e){n.command.register(e)})),i&&n.addExtend(i),l&&n.addDataProcessor(l),c&&n.interaction.addDefaultCursor(c),s&&Object.assign(n.settings,s)}}},{key:"destroy",value:function(){this.diagram=void 0,this.behaviours.forEach((function(e){return e.destroy()}))}}]),e}();c()(ps,"className","Register");var ms=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"_selections",void 0),this._selections=[]}return v()(e,[{key:"selections",get:function(){return this._selections}},{key:"_select",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.diagram.cellMap;e.map((function(e){return"string"==typeof e?r[e]:e})).forEach((function(e){if(e.state.selected!==n){var r=t.selections.indexOf(e);n?(e.select(),-1===r&&t.selections.push(e)):(e.unSelect(),-1!==r&&t.selections.splice(r,1))}}))}},{key:"select",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(e)||(e=[e]);var n=this.diagram,r=this.selections,a={selections:D()(r)},i={selections:D()(e).map((function(e){return n.find(e)})).filter((function(e){return e}))},o={before:a,after:i,selections:i.selections},c=vt(a.selections,i.selections);!c&&n.emit("beforeselectionchange",o),n.emit("beforeselect",o),this._select(a.selections,!1),this._select(e,t),n.emit("afterselect",o),!c&&n.emit("afterselectionchange",o)}},{key:"clear",value:function(){this.select([])}},{key:"destroy",value:function(){}}]),e}();c()(ms,"className","Selector");var ys=function(){function e(t){m()(this,e),c()(this,"listeners",[]),c()(this,"params",void 0),this.params=t}return v()(e,[{key:"tap",value:function(e,t){this.listeners.push({name:e,listener:t})}},{key:"call",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.listeners.forEach((function(e){return e.listener.apply(void 0,t)}))}},{key:"apply",value:function(e){this.listeners.forEach((function(t){return t.listener.apply(void 0,D()(e))}))}},{key:"destroy",value:function(){this.listeners=[]}}]),e}();c()(ys,"className","SyncHook");var vs=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"zoom",1),c()(this,"eventHelper",new fl),c()(this,"focusPoint",[0,0]),c()(this,"minZoom",.02),c()(this,"maxZoom",4),c()(this,"m",void 0),c()(this,"n",void 0),c()(this,"autoFitPadding",8),c()(this,"scrollBarSize",20),c()(this,"scrollLeft",void 0),c()(this,"scrollTop",void 0),c()(this,"isPreventDefault",void 0),c()(this,"destroyed",void 0),c()(this,"viewportCanvasBox",void 0),c()(this,"containerBox",void 0),c()(this,"canvasWidth",void 0),c()(this,"canvasHeight",void 0),c()(this,"paperBox",void 0),c()(this,"opRecord",void 0),c()(this,"viewBox",void 0)}return v()(e,[{key:"init",value:function(){this._initContainerSize(),this.setViewport(1),this._bindEvent()}},{key:"getViewportClientBox",value:function(){var e=this.diagram,t=this.scrollBarSize,n=e.viewportContainer.getBoundingClientRect(),r=n.x||n.left,a=n.y||n.top,i=n.width-t,o=n.height-t;return{minX:r,minY:a,maxX:r+i,maxY:a+o,x:r,y:a,width:i,height:o}}},{key:"getViewportCanvasBox",value:function(){var e=this.getViewportClientBox(),t=e.minX,n=e.minY,r=e.maxX,a=e.maxY,i=this.invertClient([t,n]),o=this.invertClient([r,a]);return{minX:i[0],minY:i[1],maxX:o[0],maxY:o[1],x:i[0],y:i[1],width:o[0]-i[0],height:o[1]-i[1]}}},{key:"width",get:function(){return this.diagram.width}},{key:"height",get:function(){return this.diagram.height}},{key:"_resetFocusPoint",value:function(){var e=this.focusPoint,t=this.getViewportClientBox();e[0]=t.x+t.width/2,e[1]=t.y+t.height/2}},{key:"_bindEvent",value:function(){var e=this,t=this.diagram,n=this.eventHelper,r=t.viewportContainer;n.bind(r,"scroll",pe()((function(){Ji(e.scrollLeft,r.scrollLeft,1)&&Ji(e.scrollTop,r.scrollTop,1)||e.setScroll(r.scrollLeft,r.scrollTop)}),16)),n.bind(t,"aftercommandexecute",(function(t){if(t.isModelChange){if(e.isPreventDefault||e.destroyed)return;e.refresh()}})),this._trackVisualFocus()}},{key:"translate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scrollLeft,r=this.scrollTop;this.setScroll(n+e,r+t)}},{key:"preventDefault",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPreventDefault=e}},{key:"scrollIntoView",value:function(e){var t=this.diagram,n=this.scrollBarSize,r=t.width,a=t.height,i=t.canvas.getBoundingClientRect();if(!(i.width<=r&&i.height<=a)){var o=this.convertViewport([e.x,e.y]),c=this.convertViewport([e.x+e.width,e.y+e.height]),l=this.scrollLeft,s=this.scrollTop;o[0]<0?l-=Math.abs(o[0])+20:c[0]>r-n&&(l+=c[0]-r+n+20),o[1]<0?s-=Math.abs(o[1])+20:c[1]>a-n&&(s+=c[1]-a+n+20),l===this.scrollLeft&&s===this.scrollTop||this.setScroll(l,s)}}},{key:"_trackVisualFocus",value:function(){var e=this,t=this.diagram,n=this.focusPoint,r=this.eventHelper;r.bind(t,"mousemove",(function(e){var t=e.clientX,r=e.clientY;n[0]=t,n[1]=r})),r.bind(t,"mouseleave",(function(t){t.relatedTarget&&1===t.relatedTarget.nodeType&&t.relatedTarget.closest(".lake-diagram-prevent-mouseleave-reset-focus-point")||e._resetFocusPoint()}))}},{key:"_resizeViewport",value:function(){var e=this.diagram,t=e.viewportContainer,n=e.width,r=e.height;t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"),t.style.maxWidth="".concat(n,"px"),t.style.maxHeight="".concat(r,"px")}},{key:"_initContainerSize",value:function(){this.diagram.viewportContainer.style.overflow="auto",this._resizeViewport()}},{key:"_change",value:function(){var e=this.scrollLeft,t=this.scrollTop,n=this.canvasWidth,r=this.canvasHeight,a=this.viewBox,i=this.diagram;i.emit("beforeviewportchange"),this._resizeViewport(),i.canvas.rendererElement.style.display="block",i.canvas.rendererElement.style.width="".concat(n,"px"),i.canvas.rendererElement.style.height="".concat(r,"px"),i.canvas.rendererElement.setAttribute("viewBox",a.join(",")),i.viewportContainer.scrollLeft=e,i.viewportContainer.scrollTop=t,this._setMatrix(),i.emit("afterviewportchange"),this.viewportCanvasBox=this.getViewportCanvasBox()}},{key:"_setMatrix",value:function(){var e=this.zoom,t=this.scrollLeft,n=this.scrollTop,r=this.viewBox;this.n=[e,0,0,0,e,0,-e*r[0],-e*r[1],1],this.m=[e,0,0,0,e,0,-t-e*r[0],-n-e*r[1],1]}},{key:"isInnerCanvasPoint",value:function(e){var t=this.viewportCanvasBox,n=t.minX,r=t.maxX,a=t.minY,i=t.maxY;return!(e[0]<n||e[0]>r||e[1]<a||e[1]>i)}},{key:"focusFirstRoot",value:function(){var e=this.diagram,t=e.getCells().filter((function(e){return e.isStem}))[0];t&&(this.autoFit(),e.viewport.focus([t.x+t.width/2,t.y+t.height/2]),e.viewport.setViewport(1))}},{key:"focusGraphicCenter",value:function(){var e=this.diagram;if(e.getCells().length>0){var t=e.rootGroup.getBBox();e.viewport.focus([t.x+t.width/2,t.y+t.height/2]),e.viewport.setViewport(1)}}},{key:"setScroll",value:function(e,t){this.destroyed||(this._setScrollLeft(e),this._setScrollTop(t),this._change())}},{key:"getPadding",value:function(e,t){var n=this.diagram;return n.options.padding||[n.height/2,n.width/2]}},{key:"moveTo",value:function(e,t){var n=this.zoom,r=this.invertViewport([0,0]);this.setScroll(this.scrollLeft+(e-r[0])*n,this.scrollTop+(t-r[1])*n)}},{key:"_restoreCanvasTlPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom;this.setViewport(t),this.moveTo.apply(this,D()(e))}},{key:"refresh",value:function(){var e=this.getViewportClientBox();this.setViewport(this.zoom,[e.x,e.y])}},{key:"_setScrollLeft",value:function(e){var t=this.diagram,n=this.canvasWidth,r=this.scrollBarSize,a=n-t.width+r;this.scrollLeft=ut(e,0,a)}},{key:"_setScrollTop",value:function(e){var t=this.diagram,n=this.canvasHeight,r=this.scrollBarSize,a=n-t.height+r;this.scrollTop=ut(e,0,a)}},{key:"setViewport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoom,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focusPoint;(e=ut(e,this.minZoom,this.maxZoom))!==this.zoom&&(this.opRecord=void 0),this.zoom=e;var n,r,a=this.diagram,i=this.m,o=a.width,c=a.paper.getBBox(),l=this.getPadding(c,e),s=this.getViewportClientBox(),u=c.right-c.left,d=c.bottom-c.top,f=u*e+2*l[1],h=d*e+2*l[0],p=[c.left-l[1]/e,c.top-l[0]/e,f/e,h/e];if(i){var m=[t[0]-s.x,t[1]-s.y,1],y=w.mat3.invert([],i),v=w.vec3.transformMat3([],[m[0],m[1],1],y),g=[e,0,0,0,e,0,-e*p[0],-e*p[1],1],b=w.vec3.transformMat3([],v,g);n=b[0]-m[0],r=b[1]-m[1]}else n=(f-o)/2,r=l[0]-c.top;this.paperBox=c,this.canvasWidth=f,this.canvasHeight=h,this.zoom=e,this.viewBox=p,this.containerBox=s,this._setScrollLeft(n),this._setScrollTop(r),this._change()}},{key:"convertViewport",value:function(e){e=Di(e);var t=this.m;return w.vec3.transformMat3([],[e.x,e.y,1],t)}},{key:"invertViewport",value:function(e){e=Di(e),this.m;var t=w.mat3.invert([],this.m);return w.vec3.transformMat3([],[e.x,e.y,1],t)}},{key:"convertViewportAbs",value:function(e){return w.vec3.transformMat3([],[e[0],e[1],1],this.n)}},{key:"invertViewportAbs",value:function(e){var t=w.mat3.invert([],this.n);return w.vec3.transformMat3([],[e[0],e[1],1],t)}},{key:"convertClient",value:function(e){e=Di(e);var t=this.getViewportClientBox(),n=w.vec3.transformMat3([],[e.x,e.y,1],this.m);return[n[0]+t.x,n[1]+t.y]}},{key:"invertClient",value:function(e){e=Di(e);var t=this.getViewportClientBox(),n=[e.x-t.x,e.y-t.y,1],r=w.mat3.invert([],this.m),a=w.vec3.transformMat3([],[n[0],n[1],1],r);return[a[0],a[1]]}},{key:"getCenter",value:function(){var e=this.getViewportClientBox();return this.invertClient([e.x+e.width/2,e.y+e.height/2])}},{key:"getFocus",value:function(){var e=this.focusPoint;return this.invertClient(e)}},{key:"toObject",value:function(){var e=this.zoom,t=this.diagram;return{zoom:e,tlCanvasPoint:this.invertViewport([0,0]),width:t.width,height:t.height}}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tlCanvasPoint||e.originCanvasTlPoint;if(t){var n=e.zoom;this._restoreCanvasTlPoint(t,n)}else"number"==typeof e.scrollLeft&&"number"==typeof e.scrollTop&&(this.setViewport(e.zoom),this.setScroll(e.scrollLeft,e.scrollTop))}},{key:"setWYSIWYG",value:function(e){var t=this.diagram,n=this.scrollBarSize;if(t.width>e.width&&t.height>e.height)this.set({zoom:e.zoom,tlCanvasPoint:e.tlCanvasPoint});else{var r=Math.min((t.width-n)/(e.width-n),(t.height-n)/(e.height-n))*e.zoom;this.set({zoom:r,tlCanvasPoint:e.tlCanvasPoint})}}},{key:"_focus",value:function(e){var t=this.getViewportClientBox(),n=w.vec3.transformMat3([],[e[0],e[1],1],this.m),r=[t.width/2,t.height/2],a=r[0]-n[0],i=r[1]-n[1];this._setScrollLeft(this.scrollLeft-a),this._setScrollTop(this.scrollTop-i),this._setMatrix()}},{key:"focus",value:function(e){this._focus(e),this._change()}},{key:"autoFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.minZoom,n=e.maxZoom,r=e.zoom,a=this.getViewportClientBox(),i=this.diagram.rootGroup.getBBox();t=t||this.minZoom,n=n||1,null==r&&(a.width-=2*this.autoFitPadding,a.height-=2*this.autoFitPadding,r=Math.min(a.width/i.width,a.height/i.height)),r=ut(r,t,n),this._focus([i.x+i.width/2,i.y+i.height/2]),this._resetFocusPoint(),this.setViewport(r),this.opRecord="autoFit"}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.destroyed=!0}}]),e}();c()(vs,"className","Viewport");var gs,bs,xs,ks=window.getSelection(),ws=function(e){S()(n,_.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,c()(E()(r),"eventHelper",new fl),c()(E()(r),"destroyed",!1),c()(E()(r),"emitQueryChange",void 0),r.emitQueryChange=ye()((function(){r.destroyed||r.emit("querychange",{query:r._getQuery()})}),32),r}return v()(n,[{key:"init",value:function(){var e=this,t=this.diagram,n=this.eventHelper,r=this.emitQueryChange;n.bind(t.contentEditor,"selectionchange",(function(){e._updateEditRange(),r()})),n.bind(t,"afterselect",(function(){e._updateEditRange(),r()}))}},{key:"_updateEditRange",value:function(){var e=this.diagram;try{var t=null==ks?void 0:ks.getRangeAt(0);if(!t)return;e.canvasContainer.contains(t.commonAncestorContainer)&&!xs&&(gs=t.cloneRange()),bs=t.cloneRange()}catch(e){return}}},{key:"_setRange",value:function(e){e&&(null==ks||ks.removeAllRanges(),null==ks||ks.addRange(e))}},{key:"_getSelections",value:function(){return this.diagram.selector.selections.filter((function(e){var t;return null===(t=e.canUpdateText)||void 0===t?void 0:t.call(e)}))}},{key:"_getQuery",value:function(){var e,t=this.diagram,n=this._getSelections();if(n.length>1){var r=n.filter((function(e){return e.textareaElement}));r.sort((function(e,t){return e.x-t.x}));var a=r.map((function(e){return e.textareaElement.htmlContainer}));e=t.contentEditor.query(a[0],null)}else{var i;e=wn(n[0])?t.contentEditor.query(null===(i=n[0].children[0])||void 0===i?void 0:i.textareaElement.htmlContainer,null):Cn(n[0])?t.contentEditor.query(n[0].textareaElement.htmlContainer,null):t.contentEditor.query()}return e}},{key:"execCommand",value:function(e,t){var n=this.diagram,r=this.emitQueryChange;n.contentEditor.isBegin?(gs.commonAncestorContainer!==bs.commonAncestorContainer&&(xs=!0),xs&&this._setRange(gs),n.contentEditor.execCommand(e,t),gs=null==ks?void 0:ks.getRangeAt(0).cloneRange(),xs=!1):n.command.execute("ContentCommand",{name:e,value:t}),r()}},{key:"destroy",value:function(){this.eventHelper&&this.eventHelper.destroy(),this.destroyed=!0}}]),n}();c()(ws,"className","ContentEditorPlus");var Cs=Object.freeze({__proto__:null,CommandManager:Kc,ContentEditor:Ol,Delegator:Pl,Exporter:Wl,Highlight:Zl,Importer:Ul,Interaction:fs,Paper:hs,Register:ps,Selector:ms,SyncHook:ys,Viewport:vs,ContentEditorPlus:ws}),As=function(){function e(t){if(m()(this,e),c()(this,"default",void 0),c()(this,"anchors",void 0),c()(this,"stem",void 0),c()(this,"root",void 0),c()(this,"type",void 0),c()(this,"model",void 0),c()(this,"zIndex",void 0),c()(this,"matrix",void 0),c()(this,"graphicGroup",void 0),c()(this,"state",void 0),c()(this,"diagram",void 0),c()(this,"eventHelper",void 0),c()(this,"destroyed",void 0),c()(this,"cellMap",void 0),c()(this,"parent",void 0),c()(this,"depth",void 0),c()(this,"isStem",void 0),c()(this,"isRoot",void 0),c()(this,"isCell",void 0),c()(this,"cache",void 0),c()(this,"penetratedKeys",void 0),c()(this,"width",void 0),c()(this,"height",void 0),!t.diagram)throw new Error("cell requires diagram!");if(!t.cellMap)throw new Error("cell requires cellMap")}return v()(e,[{key:"init",value:function(e){Object.assign(this,e),this.stem=this.stem||this,this.root=this.root||this,this.type=this.stem.model.type,this.zIndex=this.model.zIndex||0}},{key:"setDefault",value:function(){}},{key:"get",value:function(e){return s()(this[e])}},{key:"draw",value:function(){}},{key:"percentage2Relative",value:function(e){return[(e=Di(e)).x*this.width,e.y*this.height]}},{key:"relative2Percentage",value:function(e){return[(e=Di(e)).x/this.width,e.y/this.height]}},{key:"canvas2percentage",value:function(e){return e=Di(e),this.relative2Percentage(this.canvas2Relative(e))}},{key:"percentage2Canvas",value:function(e){return this.relative2Canvas(this.percentage2Relative(e))}},{key:"relative2Canvas",value:function(e){e=Di(e);var t=w.vec3.transformMat3([],[e.x,e.y,1],this.matrix),n=b()(t,2);return{x:n[0],y:n[1]}}},{key:"canvas2Relative",value:function(e){e=Di(e);var t=w.vec3.transformMat3([],[e.x,e.y,1],w.mat3.invert([],this.matrix)),n=b()(t,2);return{x:n[0],y:n[1]}}},{key:"capture",value:function(e){var t=this.graphicGroup,n=this.state;!0===e?t.css({"pointer-events":"auto"}):!1===e&&t.css({"pointer-events":"none"}),n.capture=e}},{key:"rotateTo",value:function(e){var t=[1,0,0,0,1,0,0,0,1];w.mat3.fromRotation(t,e),this.matrix[0]=t[0],this.matrix[1]=t[1],this.matrix[3]=t[3],this.matrix[4]=t[4],this.graphicGroup.update({matrix:this.matrix})}},{key:"getBBox",value:function(){var e=this.percentage2Canvas([0,0]),t=this.percentage2Canvas([1,0]),n=this.percentage2Canvas([0,1]),r=this.percentage2Canvas([1,1]),a=Math.min(e.x,t.x,n.x,r.x),i=Math.min(e.y,t.y,n.y,r.y),o=Math.max(e.x,t.x,n.x,r.x),c=Math.max(e.y,t.y,n.y,r.y);return{minX:a,minY:i,maxX:o,maxY:c,x:a,y:i,width:o-a,height:c-i}}},{key:"eventDelegation",value:function(){}},{key:"getEventObject",value:function(e){return{cell:this,nativeEvent:e}}},{key:"getChildren",value:function(){var e=this.cellMap;return(this.model.children||[]).map((function(t){return e[t.id]}))}},{key:"getAllChildren",value:function(){var e=[];return this.deepEachWithoutSelf((function(t){return e.push(t),!0})),e}},{key:"getAllCellsByZIndex",value:function(){var e=this.getAllCells();return e.sort((function(e,t){return e.getZIndex()-t.getZIndex()})),e}},{key:"getAllCells",value:function(){var e=this.cellMap,t=[];return at(this.model,(function(n){return t.push(e[n.id]),!0})),t}},{key:"getSiblings",value:function(){var e=this,t=this.cellMap;return this.parent?this.parent.model.children.filter((function(t){return t.id!==e.model.id})).map((function(e){return t[e.id]})):[]}},{key:"delegateEvent",value:function(e,t,n){var r=this,a=this.eventHelper,i=this.diagram;a.bind(e,t,(function(e){i.emit(n,r.getEventObject(e))}))}},{key:"hide",value:function(){this.graphicGroup.css({display:"none"}),this.state.visible=!1}},{key:"show",value:function(){this.graphicGroup.css({display:""}),this.state.visible=!0}},{key:"updateState",value:function(){}},{key:"select",value:function(){this.state.selected=!0,this.state.highlight=!1,this.updateState()}},{key:"unSelect",value:function(){this.state.selected=!1,this.updateState()}},{key:"highlight",value:function(){this.state.highlight=!0,this.updateState()}},{key:"unHighlight",value:function(){this.state.highlight=!1,this.updateState()}},{key:"toBack",value:function(){this.graphicGroup.toBack()}},{key:"toFront",value:function(){this.graphicGroup.toFront()}},{key:"forward",value:function(){this.graphicGroup.forward()}},{key:"backward",value:function(){this.graphicGroup.backward()}},{key:"getZIndex",value:function(){var e=this.graphicGroup.getZIndex();return we()(e)?e:-1}},{key:"getNth",value:function(){return this.parent?this.parent.model.children.indexOf(this.model):0}},{key:"forEach",value:function(e){var t=this.cellMap;this.model.children.forEach((function(n,r){e(t[n.id],r)}))}},{key:"deepEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e.children},n=this.cellMap;at(this.model,(function(t){return e(n[t.id])}),t)}},{key:"deepEachWithoutSelf",value:function(e){var t=this.cellMap;it(this.model,(function(n){return e(t[n.id])}))}},{key:"render",value:function(){}},{key:"update",value:function(e){this.updateModel(e),this.draw()}},{key:"updateModel",value:function(e){e&&(h()(this.model,e,(function(e,t){if(Array.isArray(e))return t})),this._normalize(),this._merge())}},{key:"_normalize",value:function(){var e=this;Object.keys(this.model).forEach((function(t){var n=e.model[t];null==n?e.model[t]=void 0:d()(n)&&(Object.values(n).every((function(e){return null==e}))?e.model[t]=void 0:Object.keys(n).forEach((function(r){null==n[r]&&(e.model[t][r]=void 0)})))}))}},{key:"_merge",value:function(){var e=this,t=this.model,n=this.penetratedKeys;Object.keys(t).filter((function(e){return n.includes(e)})).forEach((function(n){var r=t[n],a=e.default&&s()(e.default[n]);d()(r)&&a?Object.keys(r).forEach((function(t){var i=r[t];e[n][t]=null==i?a[t]:i})):e[n]=null==r?a:r}))}},{key:"isCacheStale",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.some((function(t){return!xe()(e.cache[t],e[t])}))}},{key:"drawPosition",value:function(){}},{key:"drawCollapse",value:function(){}},{key:"drawInherit",value:function(){}},{key:"destroy",value:function(){var e;null===(e=this.diagram)||void 0===e||e.cleanDomCellMap(this.graphicGroup.rendererElement),this.eventHelper.destroy(),this.graphicGroup.destroy(),this.destroyed=!0}}],[{key:"getDefaultProps",value:function(){return{model:{},parent:null,computedProps:{},penetratedKeys:[],anchors:[],state:{visible:!0,capture:!0,selected:!1,beginEdit:!1},cache:{},matrix:[1,0,0,0,1,0,0,0,1],isCell:!0,graphicGroup:new Zr,eventHelper:new fl}}}]),e}();function Os(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(As,"className","Cell"),c()(As,"mergeKeys",["penetratedKeys","Subcells"]),c()(As,"Line",void 0);var Es={plugins:[]};function Ps(e){if(e&&e.body){var t=[];e.body.forEach((function(e){at(e,(function(e,n){e.isPlaceholder?t.push({model:e,parent:n}):(function(e){if(e&&e.layout){var t=e.layout.type,n=e.layout,r=n.quadrants,a=n.direction;"standrad"===t?(1===(r=Array.isArray(r)?r.length:Number(r))&&(vt(a,[-1,0])||vt(a,[0,-1])?e.layout.quadrantConstraint=[2]:e.layout.quadrantConstraint=[1]),vt(a,[-1,0])?e.layout.direction=[1,0]:vt(a,[0,-1])&&(e.layout.direction=[0,1])):"indent"===t&&(vt(a,[1,0])?e.layout.quadrantConstraint=[1]:vt(a,[-1,0])&&(e.layout.quadrantConstraint=[2]),e.layout.direction=[1,1])}}(e),function(e){if("line"===e.type&&e.children&&delete e.children,e.image&&e.image.src){var t=ml(e.image.src);e.image.src=yl.process(t)}}(e))}))})),t.forEach((function(t){var n=t.model,r=t.parent,a=r?r.children:e.body,i=a.indexOf(n);i>-1&&a.splice(i,1)}))}}var Ss="2.0.0";function js(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}var Rs=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","hover","drop","dragover","contextmenu"],Ms=["pointerdown","pointermove","pointerup"],Ls=["touchstart","touchmove","touchend"],Bs=["keydown","keyup","keypress"],Ds=["compositionstart","compositionend"],Ns=["copy","paste","cut"],Is=["wheel","scroll"],Ts=U.HotKeyUtils.isHotkey;function _s(e){!e.target.closest("[data-lake_prevent_click_unselect]")||e.target.matches("input")||e.target.matches("textarea")||e.preventDefault()}var Fs=function(e){S()(n,_.a);var t=js(n);function n(e){var r;m()(this,n),r=t.call(this),c()(E()(r),"options",void 0),c()(E()(r),"nativeEvents",void 0),c()(E()(r),"dataProcessors",void 0),c()(E()(r),"Cells",void 0),c()(E()(r),"head",void 0),c()(E()(r),"cellMap",void 0),c()(E()(r),"elementMap",void 0),c()(E()(r),"domCellMap",void 0),c()(E()(r),"signal",void 0),c()(E()(r),"settings",void 0),c()(E()(r),"container",void 0),c()(E()(r),"viewportContainer",void 0),c()(E()(r),"canvasContainer",void 0),c()(E()(r),"input",void 0),c()(E()(r),"calculatedContainer",void 0),c()(E()(r),"theme",void 0),c()(E()(r),"rough",void 0),c()(E()(r),"width",void 0),c()(E()(r),"height",void 0),c()(E()(r),"extend",void 0),c()(E()(r),"canvas",void 0),c()(E()(r),"rootGroup",void 0),c()(E()(r),"frontRootGroup",void 0),c()(E()(r),"backRootGroup",void 0),c()(E()(r),"defs",void 0),c()(E()(r),"destroyed",void 0),c()(E()(r),"command",void 0),c()(E()(r),"delegator",void 0),c()(E()(r),"contentEditor",void 0),c()(E()(r),"contentEditorPlus",void 0),c()(E()(r),"exporter",void 0),c()(E()(r),"importer",void 0),c()(E()(r),"interaction",void 0),c()(E()(r),"paper",void 0),c()(E()(r),"highlight",void 0),c()(E()(r),"register",void 0),c()(E()(r),"selector",void 0),c()(E()(r),"viewport",void 0),c()(E()(r),"vertexRotateResize",void 0),c()(E()(r),"groupRotateResize",void 0),c()(E()(r),"abstractView",void 0),c()(E()(r),"groupManager",void 0),c()(E()(r),"lineAlign",void 0),c()(E()(r),"connect",void 0),c()(E()(r),"lineCellAlign",void 0),c()(E()(r),"lineResizer",void 0),c()(E()(r),"font",void 0),c()(E()(r),"mouseDragCanvas",void 0),c()(E()(r),"modelManager",void 0),c()(E()(r),"align",void 0),c()(E()(r),"swimlane",void 0),c()(E()(r),"swimlaneResize",void 0),c()(E()(r),"drawBaseResizer",void 0),c()(E()(r),"penDrawInteract",void 0),c()(E()(r),"hooks",{forceDecorateImportModels:new ys(["models"]),decorateImportModels:new ys(["models"]),decorateAddVertexModel:new ys(["model"]),decorateAddStackModel:new ys(["model"]),decorateAddMindmapAbstract:new ys(["model"]),decorateAddMindmapStemModel:new ys(["model"]),decorateAddMindmapCellModel:new ys(["model"]),decorateAddLineModel:new ys(["model"]),decorateAddSwimlaneModel:new ys(["model"]),decorateAddSwimlaneChildModel:new ys(["model"]),decorateAddPenModel:new ys(["model"]),decorateAddDslModel:new ys(["model"]),decorateAddDslChildModel:new ys(["model"]),decorateNonMindmapCellModels:new ys(["models","sourceTheme"])}),c()(E()(r),"spm",void 0);var a=h()({locale:{},width:500,height:500,plugins:[],paper:null,padding:null,mode:"edit",head:{}},e);r.options=a,r.nativeEvents=[].concat(Rs,Ms,Ls,Bs,Ds,Ns,Is),r.dataProcessors=[Ps],r.Cells={Cell:As,Line:As.Line},r.head={version:Ss},r.cellMap={},r.elementMap={},r.signal={keydown:{}},r.settings={};var i=a.container,o=r._createViewportContainer(),l=r._createCanvasContainer(),s=r._createInputElement();return r.container=i,r.viewportContainer=o,r.canvasContainer=l,r.input=s,i.appendChild(o),o.appendChild(l),o.appendChild(s),r.width=a.width,r.height=a.height,r.calculatedContainer=r._appendCalculatedContainer(),r.domCellMap=new WeakMap,r._initCanvas(),r._initExtend(),r._initEvent(),r}return v()(n,[{key:"_initEvent",value:function(){var e,t=this,n=this.viewportContainer,r=this.nativeEvents,a=!1,i=!1,o=0,c=function(e,n){var r=e,a=r.target,i={target:a,clientX:r.clientX,clientY:r.clientY,button:r.button,preventDefault:function(){e.preventDefault()},stopPropagation:function(){e.stopPropagation()}},o=t.getCell(a);o&&(i.cell=o,t.emit("".concat(o.type,":").concat(n),i)),t.emit(n,i)};r.forEach((function(r){"mousedown"===r?n.addEventListener(r,(function(t){a=!0,c(t,r),o=t.button,e=[t.clientX,t.clientY]})):"mousemove"===r?n.addEventListener(r,(function(n){i&&t.emit("drag",{evt:n,button:o}),a&&!i&&ro(n.clientX,n.clientY,e[0],e[1])>8&&(i=!0,t.emit("dragstart",{evt:n,button:o})),t.emit(r,n)})):"mouseup"===r?n.addEventListener(r,(function(e){c(e,r),i?(t.emit("dragend",{evt:e}),i=!1):2===e.button&&t.emit("contextmenu",e),a=!1})):"contextmenu"===r?n.addEventListener(r,(function(e){e.preventDefault()})):"pointerdown"===r||"pointerup"===r?n.addEventListener(r,(function(e){c(e,r)})):n.addEventListener(r,(function(e){"touchmove"!==r||t.interaction.currentMode!==Sr&&t.interaction.currentMode!==jr?t.emit(r,e):e.preventDefault()}))})),zs._boundGlobalEvent||(window.addEventListener("mousedown",_s),zs._boundGlobalEvent=!0)}},{key:"_createViewportContainer",value:function(){var e=document.createElement("div");return e.classList.add("lake-diagram-viewport-container"),e.setAttribute("style","position: relative; outline: none; user-select: text"),e.setAttribute("tabindex","0"),e.setAttribute("focusable","true"),e.setAttribute("dragable","false"),e.addEventListener("dragstart",(function(e){return e.preventDefault()})),e}},{key:"_createCanvasContainer",value:function(){return document.createElement("div")}},{key:"_createInputElement",value:function(){var e=this,t=document.createElement("div");return t.setAttribute("contenteditable","true"),t.style.position="fixed",t.style.top="-300px",t.style.left="-300px",t.style.right="0",t.style.bottom="0",t.style.width="100px",t.style.height="40px",t.margin="auto",t.style["z-index"]=2,t.style.outline="none",t.style.opacity=0,t.style["pointer-events"]="none",t.addEventListener("keydown",(function(t){Ts("mod+c",t)&&0===e.selector.selections.length&&t.preventDefault()})),t.addEventListener("keydown",(function(t){Ts("mod+v",t)||e.selector.selections.length>0&&(Ts("mod+c",t)||Ts("mod+x",t))})),t.addEventListener("beforeinput",(function(e){e.preventDefault()})),U.ua.mobile&&t.addEventListener("focus",(function(){t.blur()})),t}},{key:"_appendCalculatedContainer",value:function(){var e=this.options.container,t=document.createElement("div"),n=document.createElement("div");return t.appendChild(n),e.appendChild(t),t.setAttribute("style","opacity: 0; height: 0;width: 0"),t.style.overflow="hidden",n.style.width="10000px",n}},{key:"_initExtend",value:function(){var e,t=this.options;this.extend={},this.addExtend(Object.keys(Cs).map((function(e){return Cs[e]}))),this.register.init(Es.plugins.concat(t.plugins)),this.paper.init(t.paper||{size:[828,1170]}),this.viewport.init(),this.interaction.init(t.mode),null===(e=this.mouseDragCanvas)||void 0===e||e.init(),this.contentEditorPlus.init()}},{key:"_initCanvas",value:function(){var e=this.canvasContainer,t=this.calculatedContainer;this.canvas=new Kr({container:e,calculatedContainer:t}),this.rootGroup=new Zr,this.frontRootGroup=new Zr,this.backRootGroup=new Zr,this.rootGroup.dataset({element:"root_group"}),this.frontRootGroup.dataset({element:"front_group"}),this.backRootGroup.dataset({element:"back_group"}),this.defs=new Pa,this.canvas.add(this.defs),this.canvas.add(this.backRootGroup),this.canvas.add(this.rootGroup),this.canvas.add(this.frontRootGroup)}},{key:"insertBefore",value:function(e,t){if(e.isStem&&t.isStem)for(var n=this.rootGroup,r=e.getAllCellsByZIndex(),a=t.getAllCellsByZIndex(),i=0;i<r.length;i++)n.insertBefore(r[i].graphicGroup,a[0].graphicGroup)}},{key:"cleanDomCellMap",value:function(e){var t=this.domCellMap;at(e,(function(e){t.delete(e)}),(function(e){return e.childNodes}))}},{key:"addExtend",value:function(e){var t=this;e.forEach((function(e){var n=e.className,r=n.charAt(0).toLowerCase()+n.substring(1),a=new e(t);t.extend[r]=a,t[r]=a}))}},{key:"addDataProcessor",value:function(e){this.dataProcessors.push(e)}},{key:"inherit",value:function(e,t){var n=this.cellMap;t||(t=this.getCells().filter((function(e){return e.isStem}))),t.forEach((function(t){at(t.model,(function(t,r){t=n[t.id],r=r&&n[r.id]||t.parent,t.computedProps=r?te()({},r.computedProps,Et(t,e)):Et(t,e)}))}))}},{key:"deepEach",value:function(e){var t=this.cellMap;Object.keys(t).forEach((function(n){e(t[n])}))}},{key:"focus",value:function(){var e=this.input,t=window.getSelection(),n=document.createRange();e.innerHTML="ddd",n.setStart(e.childNodes[0],1),n.setEnd(e.childNodes[0],2),null==t||t.removeAllRanges(),null==t||t.addRange(n)}},{key:"tryFocus",value:function(){this.viewportContainer.contains(document.activeElement)||this.focus()}},{key:"clear",value:function(){this.rootGroup.clear(),this.cellMap={}}},{key:"destroy",value:function(){var e;if(!this.destroyed){var t=this.canvas,n=this.viewportContainer,r=this.extend,a=this.calculatedContainer;this.deepEach((function(e){e.destroy()})),Object.keys(r).forEach((function(e){r[e].destroy()})),null===(e=n.parentNode)||void 0===e||e.removeChild(n),a.remove(),t.destroy(),this.destroyed=!0}}},{key:"export",value:function(){this.emit("beforeexporter");var e=this.exporter.json();return this.emit("afterexporter"),e}},{key:"import",value:function(e){var t=this.dataProcessors,n=this.head;e.head&&Object.assign(n,e.head),this.emit("beforeimport"),t.forEach((function(t){t(e)}));var r=this.importer.json(e);return this.emit("afterimport"),this.viewport.refresh(),r}},{key:"setCursor",value:function(e){this.canvas.css({cursor:e})}},{key:"resetCursor",value:function(){this.setCursor(this.interaction.getModeCursor())}},{key:"isSelected",get:function(){return this.selector.selections.length>0}}]),n}();c()(Fs,"_boundGlobalEvent",void 0);var zs=function(e){S()(n,e);var t=js(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n)}(function(e){return function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"changePaper",value:function(e){Object.assign(this.paper,e),this.viewport.refresh()}},{key:"changeSize",value:function(e,t){this.width=e,this.height=t,this.viewport.refresh()}}]),n}(e)}(function(e){return function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"deduplicate",value:function(e){var t=this;if(!e||0===e.length)return e;if((e=e.concat([])).every((function(t){return t.depth===e[0].depth})))return e;Ae()(e,["depth"]);for(var n=0;n<e.length;n++){var r=e[n];r&&it(r.model,(function(n){n=t.find(n.id);var r=e.indexOf(n);-1!==r&&(e[r]=null)}))}return e.filter((function(e){return e}))}},{key:"snapshot",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[t.map((function(e){return s()(e.model)})),t.map((function(t){return e.getCellOptions(t)}))]}},{key:"getCell",value:function(e){var t,n=this.canvas,r=this.cellMap,a=this.domCellMap,i=this.rootGroup,o=this.find(null==e||null===(t=e.dataset)||void 0===t?void 0:t.cellid);if(o)return o;if(!e||!i.rendererElement.contains(e)||n.rendererElement===e)return null;var c=a.get(e);if(c)return c;for(var l=Object.keys(r),s=0;s<l.length;s++){var u=r[l[s]];if(u.graphicGroup.rendererElement.contains(e))return a.set(e,u),u}return null}},{key:"getCellOptions",value:function(e){var t=this,n=this.cellMap,r=[];return at(e.model,(function(e){var a=n[e.id],i=t.getSibling(a);i&&(i.unshift(a.model.id),i.push(a.getZIndex()),r.push(i))})),{parent:e.parent&&e.parent.model.id,nth:e.getNth(),siblingSheets:r}}},{key:"getSibling",value:function(e){var t=e.graphicGroup.getSiblingRendererElement();if(t){var n=this.getCell(t[1]);return n?(t[1]=n.model.id,t):null}return null}},{key:"getCells",value:function(){var e=[];return this.deepEach((function(t){e.push(t)})),e}},{key:"getCellsByZIndex",value:function(){var e=[];return this.deepEach((function(t){e.push([t,t.getZIndex()])})),e.sort((function(e,t){var n=b()(e,2)[1],r=b()(t,2)[1];return n>r?1:n<r?-1:0})),e.map((function(e){return e[0]}))}},{key:"getFreehands",value:function(){return this.getCells().filter((function(e){return Ln(e)}))}}]),n}(e)}(function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"find",value:function(e){if(null!=e){var t=this.cellMap;return e instanceof As?e:t[e]}}},{key:"layout",value:function(e){var t=this.find(e);if(t&&!t.destroyed){if(!t.isStem)throw new Error("Only stem type cell can be layouted!");if(t.executeLayout){var n=this.cellMap;t.executeLayout(),this.emit("afterstemcelllayout",{stem:this}),at(t.model,(function(e){var r=n[e.id];return r!==t&&r.drawPosition(),!0}))}}}},{key:"findByContent",value:function(e){return this.getCells().find((function(t){return t.html.includes(e)}))}},{key:"_draw",value:function(e){var t=this;this.emit("beforedraw",e);var n=e.cells,r=void 0===n?[]:n,a=e.stems,i=void 0===a?[]:a,o=e.relatedLines,c=void 0===o?[]:o;i.forEach((function(e){!e.destroyed&&t.layout(e)})),r.forEach((function(e){!e.destroyed&&e.draw()})),c.forEach((function(e){!e.destroyed&&e.draw()})),this.emit("afterdraw",e)}},{key:"_getStems",value:function(e){return yt(e.map((function(e){return e.stem})))}},{key:"_getRoots",value:function(e){return yt(e.map((function(e){return e.root})))}},{key:"_processSiblingSheets",value:function(e){var t=this.cellMap;e.sort((function(e,t){return t[3]-e[3]}));for(var n=0;n<e.length;n++){var r=e[n],a=t[r[0]],i=t[r[2]];if(a&&i){var o=r[1];"before"!==o&&"after"!==o||i.graphicGroup[o](a.graphicGroup)}}}},{key:"getRelatedLines",value:function(e){var t=this.cellMap,n=e.reduce((function(e,t){return e[t.stem.model.id]=!0,e}),{}),r=this.getCells().filter((function(e){return e.isLine})),a=[];return r.forEach((function(e){["source","target"].some((function(r){var a=e[r].id,i=t[a];return a&&!i||i&&n[i.stem.model.id]}))&&a.push(e)})),a}},{key:"_getCellConstructors",value:function(e){var t=this.Cells;if(!e)return[t.Cell];var n=e.charAt(0).toUpperCase()+e.substring(1),r=t[n+"Stem"],a=t[n+"Cell"];return r&&a?[r,a]:a||(a=t[n])?[a]:void 0}},{key:"_getId",value:function(e){var t=this.cellMap;return null==e||t[e]?Object(F.a)():e}},{key:"_add",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={action:"add"};this.emit("beforechange",n);var r=this.cellMap,a=this.rootGroup,i=[],o=[];t.forEach((function(t){var n,a,c,l,s,u=t.model,d=t.options,f=[];if(d.parent){if((l=r[d.parent])&&(a=l.stem.model,c=l.root.model,n=e._getCellConstructors(a.type),s=l,wt(l.model,u),"number"==typeof d.nth&&d.nth>=0)){var h=l.model.children;gt(h,h.indexOf(u),d.nth),l.model.children=l.model.children.filter((function(e){return e}))}}else c=u;if(at(u,(function(t,i){i&&i.id&&(l=r[i.id]);var o=l?l.depth+1:0,s=0===o,u=!!t.type||s;u&&(a=t,n=e._getCellConstructors(t.type)),void 0!==t.html&&(t.html=xl(t.html)),t.id=e._getId(t.id);var d=t.id,h=u?n[0]:n[n.length-1],p={model:t,cellMap:r,parent:l,depth:o,isStem:u,isRoot:s,stem:r[a.id],root:r[c.id],diagram:e},m=new h(p),y=h.getDefaultProps();return m.default=Yi(y),Object.assign(m,y),m.init(p),r[d]=m,f.push(m),!0})),s){var p=e.find(u.id);i.push({cell:p,insertBeforeCell:s})}o=o.concat(f)})),o.sort((function(e,t){return e.zIndex-t.zIndex})),o.forEach((function(e){a.add(e.graphicGroup)})),i.forEach((function(e){var t=e.cell,n=e.insertBeforeCell;a.insertBefore(t.graphicGroup,n.graphicGroup)}));var c=[];t.forEach((function(e){var t=e.options;t.siblingSheets&&(c=c.concat(t.siblingSheets))})),this._processSiblingSheets(c);var l=t.map((function(e){return e.model})),s=this._getStems(o),u=this._getRoots(s),d=this.getRelatedLines(s);return n.models=l,n.stems=s,n.cells=o,n.roots=u,n.relatedLines=d,this._draw(n),this.emit("afterchange",n),l.map((function(e){return r[e.id]}))}},{key:"add",value:function(e,t){var n,r={};if(Array.isArray(e))n=e.map((function(e){return{model:e}}));else{if(!d()(e))throw new Error("Params is illegal");n=[{model:e,options:t}]}return Array.isArray(t)?n.forEach((function(e,n){e.options=t[n]})):d()(t)&&n.forEach((function(e){e.options=t})),n.forEach((function(e){e.options||(e.options=r)})),this._add(s()(n))}},{key:"_update",value:function(e){var t=this,n=this.cellMap,r=[],a={action:"update",models:[]},i=[];e=e.map((function(e){var n=t.find(e.id);return n?(e.cell=n,a.models.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Os(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Os(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:n.model.id},e.model)),e):null})).filter((function(e){return e})),a.arr=e,this.emit("beforechange",a),e.forEach((function(e){var t=e.model,a=e.options,o=e.cell,c=n[a.parent];if(c){var l=o.parent!==c,s=c.stem.type===o.stem.type,u=c.isStem&&o.isStem;if(l&&(s||u)){if(o.parent){var d=o.parent.model.children;d.splice(d.indexOf(o.model),1)}wt(c.model,o.model),o.parent=c,o.isRoot=!1,o.stem!==o&&o.deepEach((function(e){e.stem=c.stem})),o.deepEach((function(e){e.root=c.root,e.depth=e.parent.depth+1}))}}else if(null===a.parent&&o.isStem&&o.parent){var f=o.parent.model.children;f.splice(f.indexOf(o.model),1),o.parent=null,o.isRoot=!0,o.depth=0,o.deepEachWithoutSelf((function(e){e.root=o,e.depth=e.parent.depth+1}))}var h=a.nth;if(void 0!==h&&o.parent){var p=o.parent.model.children;gt(p,p.indexOf(o.model),h)}a.siblingSheets&&(i=i.concat(a.siblingSheets)),o.updateModel(t),r.push(o),void 0!==t.collapsed&&at(o.model,(function(e){var t=n[e.id];return t!==o&&t.drawCollapse(),!0}))})),this._processSiblingSheets(i);var o=this._getStems(r),l=this._getRoots(o),s=this.getRelatedLines(o);a.cells=r,a.stems=o,a.roots=l,a.relatedLines=s,this._draw(a),this.emit("afterchange",a)}},{key:"update",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(("string"==typeof e||"object"===i()(e)&&e.isCell)&&d()(n))t=[{id:e}];else{if(!Array.isArray(e))throw new Error("Please set id !");t=e.map((function(e){return{id:e}}))}d()(n)?t.forEach((function(e){e.model=n})):Array.isArray(n)&&t.forEach((function(e,t){e.model=n[t]})),d()(r)?t.forEach((function(e){e.options=r})):Array.isArray(r)?t.forEach((function(e,t){e.options=r[t]})):t.forEach((function(e){e.options={}})),t.forEach((function(e){e.model=e.model||{},e.model=ge()(e.model),e.options=e.options||{},e.options=ge()(e.options)})),this._update(t)}},{key:"_remove",value:function(e){var t=this,n=e.map((function(e){return t.find(e)})).filter((function(e){return e}));if(0!==n.length){n=this.deduplicate(n);var r=this.cellMap,a=n.map((function(e){return e.getAllCells()})).reduce((function(e,t){return e.concat(t)})),i=yt(n.map((function(e){return e.stem}))),o=this.getRelatedLines(i),c=[],l={},s={action:"remove",stems:i,models:c,relatedLines:o};return n.forEach((function(e,t){if(c.push(e.model),e.parent){var n={nth:e.parent.model.children.indexOf(e.model),model:c[t]};l[e.parent.model.id]=l[e.parent.model.id]?l[e.parent.model.id].concat(n):[n]}else{var r={nth:-1,model:c[t]};l.root=l.root?l.root.concat(r):[r]}})),this.emit("beforechange",s),n.forEach((function(e){if(e.parent){var t=e.parent.model.children;t.splice(t.indexOf(e.model),1)}})),a.forEach((function(e){e.destroy();var n=t.selector.selections.indexOf(e);-1!==n&&t.selector.selections.splice(n,1),delete r[e.model.id]})),this._draw(s),this.emit("afterchange",s),{eventObj:s,deletedModelsInfo:l}}}},{key:"remove",value:function(e){return Array.isArray(e)||(e=[e]),this._remove(e)}}]),n}(Fs)))),qs=function(){function e(t){m()(this,e),c()(this,"cell",void 0),c()(this,"destroyed",!1),c()(this,"shapeElement",void 0),this.cell=t}return v()(e,[{key:"render",value:function(){}},{key:"update",value:function(){}},{key:"draw",value:function(){}},{key:"drawInherit",value:function(){}},{key:"drawPosition",value:function(){}},{key:"setDefault",value:function(){}},{key:"updateState",value:function(){}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();function Ys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}window.____lake_diagram_version=Ss;var Gs=function(e){S()(n,As);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"Subcells",void 0),c()(E()(e),"subcells",void 0),c()(E()(e),"textareaContentStyleSheets",void 0),c()(E()(e),"x",void 0),c()(E()(e),"y",void 0),c()(E()(e),"opacity",void 0),c()(E()(e),"roughFillStyle",void 0),c()(E()(e),"stroke",void 0),c()(E()(e),"isGroup",void 0),c()(E()(e),"isGeometry",void 0),c()(E()(e),"isLine",void 0),c()(E()(e),"isImage",void 0),c()(E()(e),"isText",void 0),c()(E()(e),"isVertex",void 0),c()(E()(e),"isBoardCell",void 0),c()(E()(e),"stem",void 0),e}return v()(n,[{key:"getRoughGraphicOptions",value:function(){var e=this.roughFillStyle;if(e)return{roughFillStyle:e}}},{key:"getOuterWidth",value:function(){return this.model.width}},{key:"shouldRefreshEndEditContent",value:function(){return!1}},{key:"beginEditContent",value:function(){}},{key:"endEditContent",value:function(){}},{key:"isContentEmpty",value:function(){var e=this.html,t=document.createElement("div");return t.innerHTML=e,!t.textContent||"%E2%80%8B"===encodeURI(t.textContent)}},{key:"canRough",value:function(){return!1}},{key:"canTextVerticalAlign",value:function(){return!0}},{key:"canDragCanvas",value:function(){return!0}},{key:"canDelete",value:function(){return!0}},{key:"canFill",value:function(){return!0}},{key:"canStroke",value:function(){return!0}},{key:"canStrokeWidth",value:function(){return!0}},{key:"canStrokeStyle",value:function(){return!0}},{key:"canConnect",value:function(){return!0}},{key:"canRotate",value:function(){return!0}},{key:"canCollapse",value:function(){var e=this.model;return e.children&&e.children.length>0&&!0!==this.collapsed}},{key:"canExpand",value:function(){var e=this.model;return e.children&&e.children.length>0&&!0===this.collapsed}},{key:"canUseAddLineButton",value:function(){return!1}},{key:"canArrange",value:function(){return!!this.isStem}},{key:"canText",value:function(){return!0}},{key:"canUpdateText",value:function(){return this.textareaElement}},{key:"canRound",value:function(){return!1}},{key:"getCanTextCell",value:function(){return this}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"center",get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets,t=this.getPadding(),n=e.find((function(e){return"self"===e.query}));if("self"===n.query){var r=this.getOuterWidth();n.css.width=r?r-t[1]-t[3]+"px":""}}},{key:"getTextareaPosition",value:function(e){return{x:0,y:0}}},{key:"snapAnchor",value:function(e){var t=this,n=this.percentage2Canvas({x:.5,y:.5}),r=[e.x-n.x,e.y-n.y];return this.anchors.map((function(e){var a=t.percentage2Canvas(e);return Hs(Hs({},a),{},{rad:w.vec2.angle(r,[a.x-n.x,a.y-n.y])})})).sort((function(e,t){return e.rad-t.rad}))}},{key:"getPoint",value:function(e){var t=this.anchors;if("string"==typeof e){var n=t.find((function(t){return t.name===e}));if(n)return this.percentage2Canvas(n)}if("number"==typeof e)if(e>=1&&e<t.length){var r=t[e-1];if(r)return this.percentage2Canvas(r)}else if(e>=0)return this.getPointAtPercent(e);if(Array.isArray(e)){var a=b()(e,2),i=a[0],o=a[1];return e.every((function(e){return e>=0&&e<=1}))?this.percentage2Canvas({x:i,y:o}):{x:i,y:o}}throw new Error("unknown connection point ".concat(e))}},{key:"getKeyShape",value:function(){var e;return it(this.graphicGroup,(function(t){if(t.isPath)return e=t,!1})),e}},{key:"isPointInShape",value:function(e){var t=Ii(this.canvas2Relative(e)),n=this.getKeyShape();return n.isPointInFill(t)||n.isPointInStroke(t)}},{key:"isPointInFill",value:function(e){var t=Ii(this.canvas2Relative(e));return this.getKeyShape().isPointInFill(t)}},{key:"isPointInStroke",value:function(e){var t=Ii(this.canvas2Relative(e));return this.getKeyShape().isPointInStroke(t)}},{key:"getIntersectionPoint",value:function(e){var t=this.canvas2Relative(e),n={x:.5*this.width,y:.5*this.height},r=n.x,a=n.y,i=t.x,o=t.y,c=this.getKeyShape(),l=null==c?void 0:c.getIntersectionPoint(i,o,r,a),s={x:ut((l=l||{x:0,y:0}).x/this.width,0,1),y:ut(l.y/this.height,0,1)};return this.percentage2Canvas(s)}},{key:"getPointAtLength",value:function(e){return this.relative2Canvas(this.getKeyShape().getPointAtLength(e))}},{key:"getPointAtPercent",value:function(e){var t=this.getKeyShape(),n=t.getTotalLength(),r=t.getPointAtLength(e*n);return this.relative2Canvas(r)}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var e=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*e)}}return{"stroke-dasharray":"none"}}},{key:"getAlignBBox",value:function(){return this.getBBox()}},{key:"getKeyShapeBox",value:function(){var e=this.getKeyShape().getBBox(),t=this.x+e.x,n=this.y+e.y;return{x:t,y:n,width:e.width,height:e.height,minX:t,minY:n,maxX:t+e.width,maxY:n+e.height}}},{key:"getFullBBox",value:function(){var e=1/0,t=1/0,n=-1/0,r=-1/0;return this.deepEach((function(a){if(a.state.visible){var i=a.getBBox();e=Math.min(e,i.minX),t=Math.min(t,i.minY),n=Math.max(n,i.maxX),r=Math.max(r,i.maxY)}return!0})),{x:e,y:t,width:n-e,height:r-t,minX:e,minY:t,maxX:n,maxY:r}}},{key:"getTextBox",value:function(){return this.getBBox()}},{key:"toBack",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this);if(0!==n&&-1!==n){var r=t[0];e.insertBefore(this,r)}}}},{key:"toFront",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this),r=t.length;if(n!==r-1){var a=t[r-1];e.insertBefore(this,a),e.insertBefore(a,this)}}}},{key:"forward",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this);if(n!==t.length-1){var r=t[n+1];e.insertBefore(r,this)}}}},{key:"backward",value:function(){if(this.isStem){var e=this.diagram,t=e.groupManager.getStemsByZIndex(),n=t.indexOf(this);if(0!==n&&-1!==n){var r=t[n-1];e.insertBefore(this,r)}}}},{key:"updateMatrix",value:function(){if(this.isCacheStale("x","y","width","height","rotate")){var e=this.x,t=this.y,n=this.width,r=this.height,a=this.rotate;this.matrix=Xi(e,t,n,r,a)}}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stroke:{width:1},rotate:0,penetratedKeys:["strokeStyle","defaultContentStyle","roughFillStyle"],multiSelectHighlight:!0,isBoardCell:!0,defaultContentStyle:{color:tr},defaultFontFamily:Jn})}}]),n}();c()(Gs,"className","BoardCell");var Xs=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"geometryClipPath",void 0),c()(E()(e),"clipPath",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell.diagram.defs,t=new Ra({id:this.cell.clipPathID}),n=new aa({"clip-rule":"evenodd","fill-rule":"evenodd"});t.add(n),e.add(t),this.geometryClipPath=n,this.clipPath=t}},{key:"draw",value:function(){var e=this.cell,t=this.geometryClipPath,n=e.outlineElement.attr("d");t.update({d:n})}},{key:"destroy",value:function(){this.geometryClipPath.destroy(),this.clipPath.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function Vs(e){var t=e.radius,n=e.outer,r=e.width+2*n,a=e.height+2*n;return"capsule"===e.shape&&(t=r<a?r/2:a/2),un(-n,-n,r,a,t)}function Ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ws(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ws(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Us=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"clipPathID",Object(F.a)()),c()(E()(r),"group",new Zr),r.subCell=new Xs(E()(r)),r.diagram=e.diagram,r}return v()(n,[{key:"getSytle",value:function(){var e=this.cell,t=e.border,n=e.computedProps,r=Et(t,{fill:!0});return r.stroke=t.stroke||n.treeEdge.stroke,r["stroke-width"]=e.getBorderStrokeWidth(),"line"===t.shape&&(r.stroke="rgba(255,255,255,0)",r.fill="rgba(255,255,255,0)"),r}},{key:"createRendererElement",value:function(){var e=this.group,t=this.cell;if(!this.element||t.stem.isCacheStale("roughFillStyle")){var n=t.getRoughGraphicOptions(),r=new(n?Va:aa)(Zs({},n));n?this.group.update({"clip-path":"null"}):this.group.update({"clip-path":"url(#".concat(this.clipPathID,")")}),e.clear(),this.element=r,t.borderElement=r,this.outlineElement=r,t.cache.borderShape=t.border.shape,e.add(this.element)}}},{key:"render",value:function(){this.cell.graphicGroup.add(this.group),this.subCell.render()}},{key:"drawInherit",value:function(){this.draw()}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=e.getRoughGraphicOptions(),r=e.cache,a=e.width,i=e.height,o=e.border,c=o.outer,l=o.radius,s=o.shape,u=this.getSytle(),d=Pt(u,r.borderStyle,["stroke","fill","stroke-width"]);d["stroke-width"]&&!n&&(d["stroke-width"]*=2),a===r.width&&Ji(i,r.height,1)&&o.shape===r.borderShape||(d.d=Vs({radius:l,outer:c,width:a,height:i,shape:s})),e.stem.isCacheStale("roughFillStyle")&&(d=Zs({d:Vs({radius:l,outer:c,width:a,height:i,shape:s})},u)),Object.keys(d).length>0&&(t.update(d),this.subCell.draw(),r.borderStyle=u)}},{key:"destroy",value:function(){this.element&&this.element.destroy()}}]),n}();c()(Us,"className","Border"),c()(Us,"configName","border"),c()(Us,"zIndex",1);var Ks=da,Qs=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new Ks;this.element=t,e.imageElement=t}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=e.graphicGroup,r=e.image,a=e.contentBox,i=e.diagram.imageManager,o=e.getPadding();if(r.src){if(n.children.includes(t)||n.add(t),r){var c=r.src,l=r.width,s=r.height,u=r.naturalWidth,d=r.naturalHeight;t.update({x:a.x+(a.width-r.width)/2,y:o[0],width:l,height:s}),t.dataset({raw_src:r.src}),i.setImageHref(t,c,u,d)}}else t.remove()}},{key:"destroy",value:function(){this.element.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function Js(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Js(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Js(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Qs,"className","ImageSubcell"),c()(Qs,"configName","image"),c()(Qs,"zIndex",2),rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n[data-lake-mindmap-icon-selected=\"true\"].lake-diagram-mindmap-icon {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-lake-board-mode='edit'] .lake-diagram-mindmap-icon:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n");var eu=sa,tu=["html","width","height","textVerticalAlign","icons"],nu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell,t=e.graphicGroup,n=new eu({styleSheets:e.textareaContentStyleSheets,html:e.html});n.htmlContainer.classList.add("selection-transparent"),t.add(n),this.element=n,e.textareaElement=n,e.textarea=this,this.initCalculatedDOM()}},{key:"initCalculatedDOM",value:function(){var e=this.cell.diagram,t=document.createElement("div");e.calculatedContainer.appendChild(t),this.calculatedDOM=t}},{key:"update",value:function(){var e=this.cell,t=this.calculatedDOM,n=e.cache,r=e.textareaContentStyleSheets,a=$s($s({},e.stem.defaultContentStyle),e.defaultContentStyle);if(n.html!==e.html&&(t.innerHTML=e.html),e.updateTextareaStyleSheets(),this._shouldRender()){if(a){var i=r.find((function(e){return"self"===e.query}));i&&Object.assign(i.css,a),a["font-family"]||(i.css["font-family"]=e.defaultFontFamily)}Ot(t,r),this._setBBox()}}},{key:"getPosition",value:function(){var e=this.cell,t=this.getBBox();return e.getTextareaPosition(t)}},{key:"calculateBBox",value:function(){var e=this.calculatedDOM;e.style.display="inline-block";var t=e.getBoundingClientRect();return e.style.display="none",{x:t.x,y:t.y,width:Math.ceil(t.width),height:Math.ceil(t.height)}}},{key:"_setBBox",value:function(){this.box=this.calculateBBox()}},{key:"_shouldRender",value:function(){var e=this.cell,t=e.cache;return tu.some((function(n){var r=t[n],a=e[n];return"number"==typeof r&&"number"==typeof a?!Ji(a,r,1):!xe()(a,r)}))||e.stem.isCacheStale("roughFillStyle")}},{key:"getBBox",value:function(){return this.box}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=this.box;e.cache;var r=e.textareaContentStyleSheets,a={};if(this._shouldRender()&&(a.html=e.html,Ot(t.htmlContainer,r),Object.assign(a,$s({width:n.width+2,height:n.height},this.getPosition()))),Object.keys(a).length>0){t.update(a),"read"===e.diagram.interaction.currentMode&&t.htmlContainer.querySelectorAll("a").forEach((function(e){var t=e.href,n=window.location.origin+window.location.pathname;(t===n||t.startsWith(n+location.search+"#"))&&e.removeAttribute("target")}));var i=t.getBoundingClientRect();if(0===i.width&&0===i.height){var o=t.attr("width");t.update({width:o})}}}},{key:"destroy",value:function(){this.element.destroy(),this.calculatedDOM.remove()}}]),n}();c()(nu,"className","Textarea"),c()(nu,"configName","textarea"),c()(nu,"zIndex",2);var ru=function(e){S()(n,nu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"drawInherit",value:function(){this.update(),this.draw()}},{key:"calculateBBox",value:function(){var e=I()(L()(n.prototype),"calculateBBox",this).call(this),t=this.cell,r=this.calculatedDOM,a=t.image&&t.image.src;return r.textContent||t.state.beginEdit||!a?e:{x:e.x,y:e.y,width:e.width+1,height:0}}},{key:"getPosition",value:function(){var e=this.cell,t=e.image,n=e.contentBox,r=t&&t.src&&t.height+2||0;return{x:n.x,y:n.y+r}}}]),n}();c()(ru,"className","MindmapTextarea");var au=sa,iu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"container",void 0),c()(E()(e),"size",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell.graphicGroup,t=new au,n=t.htmlContainer;n&&(n.classList.add("lake-diagram-mindmap-icon-container"),n.style.display="flex",n.style.alignItems="center",n.style.boxSizing="border-box"),this.container=t,e.add(t)}},{key:"draw",value:function(){var e=this.cell,t=this.container,n=this.size,r=e.validIconKeys,a=e.model.icons,i=void 0===a?{}:a,o=this.getBBox(),c=t.htmlContainer;if(c){var l=c.children,s=r;if(s.length>0){c.style.width=o.width+"px",c.style.height=n+4+"px",t.attr(o),t.show();for(var u=0,d=0;;){var f=l[d],h=void 0,p=s[u];if(p){var m=s[u];if(f){var y=f.getAttribute("lake-mindmap-icon-key");y===m?(d++,u++):Xn.indexOf(y)<Xn.indexOf(m)?(f.remove(),f=null):(h=this.newIconElement(m),c.insertBefore(h,f),d++,u++)}else h=this.newIconElement(m),c.appendChild(h),d++,u++}else{if(!f)break;f.remove(),f=null}var v=h||f;v&&(Un(p,i[p])!==v.src&&(v.setAttribute("src",Un(p,i[p])),v.setAttribute("lake-mindmap-icon-key",p)),v.style.width=n+4+"px",v.style.height=n+4+"px",v.dataset.lakeMindmapIconSelected="false")}}else t.hide()}}},{key:"updateSize",value:function(){if(this.size=this.getIconSize(),isNaN(this.size))throw new Error("mindmap icon size nan")}},{key:"getIconSize",value:function(){var e=this.cell,t=e.subcells,n=e.isStem?18:14,r=t.find((function(e){return e instanceof ru}));if(!r.calculatedDOM)return n+2;for(var a=r.calculatedDOM,i=r.calculatedDOM,o=n;(null===(c=a.childNodes)||void 0===c?void 0:c.length)>0;){var c;if((a=a.childNodes[0])instanceof HTMLElement)i=a;else if(a){var l=window.getComputedStyle(i).fontSize.match(/^[0-9]*px/);if(l){var s=parseFloat(l[0]);"number"!=typeof s||isNaN(s)||(o=s)}}}return o+2}},{key:"getBBox",value:function(){var e=this.cell.validIconKeys,t=n.style.marginRight;return 0===e.length?{width:0,height:0}:{x:this.cell.getPadding()[3]-2,y:(this.cell.height-this.size-4)/2,width:(this.size+4+t)*e.length-t,height:this.size+4}}},{key:"newIconElement",value:function(e){var t=document.createElement("img");t.className="lake-diagram-mindmap-icon",t.setAttribute("lake-mindmap-icon-key",e);var r=n.style.marginRight;return t.style.border="none",t.style.padding="2px",t.style.marginRight="".concat(r,"px"),t.style.borderRadius="6px",t.style.userSelect="none",t.style.boxSizing="border-box",t}}]),n}();c()(iu,"className","MindmapIcons"),c()(iu,"zIndex",3),c()(iu,"style",{marginRight:0});var ou=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"element",void 0),e}return v()(n,[{key:"setDefault",value:function(){var e=this.element;e&&e.hide()}},{key:"updateState",value:function(){var e=this.element,t=this.cell;if(t.state.selected){var n={d:""};n.d=t.borderElement.attr("d"),e.update(n),e.show()}else e.hide()}},{key:"render",value:function(){this.element=new aa({stroke:pr,fill:"transparent"}),this.element.css({"pointer-events":"none"}),this.cell.outlineElement=this.element,this.cell.graphicGroup.add(this.element)}},{key:"draw",value:function(){}},{key:"destroy",value:function(){I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();c()(ou,"className","MindmapOutline"),c()(ou,"configName","outline"),c()(ou,"zIndex",3);var cu=sa,lu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this,e);var a=e.note,i=a.width,o=a.height,c=a.padding;return r.size=[i+c[1]+c[3],o+c[0]+c[2]],r}return v()(n,[{key:"render",value:function(){var e=this.cell.note,t=e.width,n=e.height,r=new cu({width:t,height:n}),a=r.htmlContainer;a.classList.add("lake-diagram-note"),a.classList.add("lake-icon"),a.classList.add("lake-icon-diagram-cell-note"),a.style.cursor="pointer",a.style["vertical-align"]="top",a.style.color=si,a.style["font-size"]=t+"px",a.style.width=t+"px",a.style.height=n+"px",a.style["line-height"]=t+"px",this.element=r}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=e.model,r=e.note,a=e.graphicGroup,i=e.width,o=e.height,c=e.border;n.note?(t.attr({x:i-r.width-r.padding[1],y:(o-r.height)/2}),c.fill&&(t.htmlContainer.style.color=ui(c.fill)),a.add(t)):t.remove()}}]),n}();function su(e){var t=e.naturalWidth/e.naturalHeight,n=e.firstInsertRatio?e.naturalWidth*e.firstInsertRatio:e.naturalWidth;return e.width=n>=480?480:n,e.height=e.width/t,e}c()(lu,"className","Note"),c()(lu,"zIndex",3);var uu=[Us,ou,Qs,lu,ru,iu],du=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getRoughGraphicOptions",value:function(){var e=this.computedProps.roughFillStyle;if(e)return{roughFillStyle:e}}},{key:"init",value:function(e){var t=this;I()(L()(n.prototype),"init",this).call(this,e),this.model.children||(this.model.children=[]),this.Subcells.sort((function(e,t){return e.zIndex-t.zIndex})),this.Subcells.forEach((function(e){var n=e.configName;n&&!t[n]&&(t[n]={},!t.default[n]&&(t.default[n]={}))})),this.initSubcell(),this.render(),this.eventDelegation()}},{key:"minContentWidth",get:function(){var e=this.border;if(e){var t=e.shape;if("rect"===t)return 38;if("capsule"===t)return 42}return 32}},{key:"minHeight",get:function(){return 16}},{key:"isPlaceholder",get:function(){return this.model.isPlaceholder}},{key:"getMinWidth",value:function(){return this.minContentWidth+this.getIconsWidth()}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets,t=this.model,n=this.minHeight,r=this.subcells;if(!this.model.width){var a=this.getMinWidth(),i=this.getPadding(),o=i[1]+i[3]+this.getNoteWidth()+this.getIconsWidth(),c=i[0]+i[2],l=r.find((function(e){return e instanceof ru})),s=e.find((function(e){return"self"===e.query}));t.image&&t.image.src&&t.image.width?l.calculateBBox().width<t.image.width&&(s.css.width=t.image.width-1+"px",s.css["max-width"]=""):(s.css["max-width"]="480px",s.css.width=""),s.css["min-width"]=a-o+"px",s.css["min-height"]=n-c+"px"}}},{key:"updateTextareaCSS",value:function(){var e=this.textareaContentStyleSheets,t=this.model,n=this.minHeight,r=this.subcells,a=this.getMinWidth(),i=this.getPadding(),o=i[1]+i[3]+this.getNoteWidth()+this.getIconsWidth(),c=i[0]+i[2],l=r.find((function(e){return e instanceof ru})),s=e.find((function(e){return"self"===e.query}));if(t.width){var u=Math.max(t.width,a);s.css.width=u-o+"px",s.css["max-width"]="",s.css["min-width"]=a-o+"px",s.css["min-height"]=n-c+"px"}Ot(l.calculatedDOM,e),l._setBBox()}},{key:"deprecatedGetBBox",value:function(){var e=this.graphicGroup.rendererElement.getBBox(),t=this.x+e.x,n=this.y+e.y;return{x:t,y:n,width:e.width,height:e.height,minX:t,minY:n,maxX:t+e.width,maxY:n+e.height}}},{key:"getKeyShapeBox",value:function(){var e=this.collapsed,t=this.downSignX,n=this.downSignY,r=this.border.shape,a=this.getKeyShape().getBBox(),i=this.x+a.x,o=this.y+a.y,c=Math.abs(t)+Math.abs(n)===2,l=e&&-1===t&&!c?24*t:0,s=e&&-1===n?24*n:0,u=e&&!c?24*Math.abs(t):0,d=e?24*Math.abs(n):0;return"line"===r&&e&&0===n&&(d+=8),{x:i+l,y:o+s,width:a.width+u,height:a.height+d,minX:i,minY:o,maxX:i+a.width,maxY:o+a.height}}},{key:"getTimelineLayoutAlign",value:function(){var e=this.getTimelineLayoutSourceCell(),t="";return[e,this].forEach((function(e){e&&"line"===e.border.shape?t+="b":t+="c"})),t}},{key:"getTimelineLayoutSourceCell",value:function(){var e=this.parent;if(this.isStem)return null;var t=this.getNth();return 0===t?e:this.getSiblings()[t-1]}},{key:"showCollapsedButton",value:function(){this.state.collapsedButtonVisible||(this.state.collapsedButtonVisible=!0,this.updateState())}},{key:"hideCollapsedButton",value:function(){this.state.collapsedButtonVisible&&(this.state.collapsedButtonVisible=!1,this.updateState())}},{key:"findSubcell",value:function(e){return this.subcells.find((function(t){return t.constructor.className===e}))}},{key:"shouldRefreshEndEditContent",value:function(){return this.isContentEmpty()&&this.image&&this.image.src}},{key:"canStroke",value:function(){return"line"!==this.border.shape}},{key:"canRotate",value:function(){return!1}},{key:"canStrokeWidth",value:function(){return!1}},{key:"canStrokeStyle",value:function(){return!1}},{key:"canFill",value:function(){return"line"!==this.border.shape}},{key:"get",value:function(e){var t=I()(L()(n.prototype),"get",this).call(this,e);return"border"===e?(t.stroke=t.stroke||this.computedProps.treeEdge.stroke,t["stroke-width"]=this.getBorderStrokeWidth(),t):"treeEdge"===e?(t.stroke=this.computedProps.treeEdge.stroke,t["stroke-width"]=this.getTreeEdgeStrokeWidth(),t):t}},{key:"getKeyShape",value:function(){return this.borderElement}},{key:"getPadding",value:function(){return[4,8,4,8]}},{key:"getBorderStrokeWidth",value:function(){return this.border["stroke-width"]||this.getDefaultStrokeWidth()}},{key:"getTreeEdgeStrokeWidth",value:function(){return this.computedProps.treeEdge["stroke-width"]||this.getDefaultStrokeWidth()}},{key:"getDefaultStrokeWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.depth;return this.stem.tapered&&function(e){return e<=2?3:e>=2&&e<=4?2:1}(e)||3}},{key:"initSubcell",value:function(){var e=this;this.subcells=this.Subcells.map((function(t){return new t(e)}))}},{key:"eventDelegation",value:function(){var e=this.graphicGroup,t=this.imageElement;this.delegateEvent(t,"mouseenter","mindmapcellimage:mouseenter"),this.delegateEvent(t,"mouseleave","mindmapcellimage:mouseleave"),this.delegateEvent(e,"mouseenter","mindmapcell:mouseenter"),this.delegateEvent(e,"mouseleave","mindmapcell:mouseleave")}},{key:"render",value:function(){this.subcells.forEach((function(e){e.render()})),this.updateModel(this.model)}},{key:"draw",value:function(){this.drawInner(),this.updateCache(),this.updateState()}},{key:"updateModel",value:function(e){e&&""===e.html&&(e.html="&#8203;"),I()(L()(n.prototype),"updateModel",this).call(this,e),this.calculate()}},{key:"isInCollapsed",value:function(){for(var e=this.parent;e;){if(!0===e.collapsed)return!0;e=e.parent}return!1}},{key:"getCellQuadrant",value:function(){for(var e=this;1!==e.depth;)e=e.parent;return e.model.quadrant}},{key:"drawInner",value:function(){this.subcells.forEach((function(e){e.draw()})),this.drawCollapse(),this.drawPosition()}},{key:"drawInherit",value:function(){"capsule"===this.border.shape&&this.image.src&&this.calculate(),this.subcells.forEach((function(e){e.drawInherit()}))}},{key:"drawPosition",value:function(){this.subcells.forEach((function(e){e.drawPosition()}));var e=this.graphicGroup,t=this.x,n=this.y,r=this.cache;if(!r.matrix||t!==r.matrix[6]||n!==r.matrix[7]){var a=[1,0,0,0,1,0,t,n,1];e.update({matrix:a}),r.matrix=a,this.matrix=a}}},{key:"drawCollapse",value:function(){this.isInCollapsed()?this.hide():this.show()}},{key:"getNoteWidth",value:function(){return this.model.note&&this.findSubcell("Note").size[0]||0}},{key:"getIconsWidth",value:function(){return this.model.icons?this.findSubcell("MindmapIcons").getBBox().width:0}},{key:"calculate",value:function(){this.calculateSize()}},{key:"calculateSize",value:function(){var e=this,t=this.cache,n=this.findSubcell("MindmapTextarea");n.update();var r=this.findSubcell("MindmapIcons");r.updateSize(),this.model.width&&this.updateTextareaCSS(),this.textareaBBox=n.box;var a=this.getPadding(),i={noteWidth:this.getNoteWidth(),padding:a,iconsBBox:r.getBBox()};t.html&&this.html&&t.html!==this.html&&(this.model.height=null),(["image","width","height","html"].some((function(n){return t[n]!==e[n]}))||this.isCacheStale("icons"))&&(this.calculateImageSize(i),this.contentHeight=this.getContentHeight(i),this.contentWidth=this.getContentWidth(i),this.height=this.getHeight(i),this.width=this.getWidth(i),this.contentBox=this.getContentBox(i),"capsule"===this.border.shape&&(i.padding=this.getPadding(),this.contentHeight=this.getContentHeight(i),this.contentWidth=this.getContentWidth(i),this.height=this.getHeight(i),this.width=this.getWidth(i),this.contentBox=this.getContentBox(i)))}},{key:"getContentBox",value:function(e){var t=e.padding,n=e.noteWidth,r=e.iconsBBox,a=this.width,i=this.contentWidth,o=this.contentHeight;return{x:(a-i-t[1]-t[3]-n-r.width)/2+t[3]+r.width,y:t[0],width:i,height:o}}},{key:"getHasModelSizeContentWidth",value:function(e){var t,n=e.padding,r=e.noteWidth,a=e.iconsBBox,i=this.model,o=this.border,c=this.getMinWidth(),l=Math.max(i.width,c),s=n[1]+n[3]+r+a.width,u=l-s;return"capsule"===o.shape&&(t=l>i.height?l-i.height+s:l/2,u=Math.min(u,t)),u}},{key:"calculateImageSize",value:function(e){var t=e.padding,r=this.image,a=this.model;if(!r.height||a.height){if(!r.src)return Object.assign(r,{width:0,height:0});var i=r.naturalWidth/r.naturalHeight,o=this.getTextareaHeight(),c=this.getHasModelSizeContentWidth(e),l=a.height-t[0]-t[2]-o-4,s=((l=Math.max(l>0?l:0,36))>0?c/l:i)<=i?c/i:l,u=s*i;I()(L()(n.prototype),"updateModel",this).call(this,{image:{width:u,height:s}})}}},{key:"getWidth",value:function(e){var t=e.padding,n=e.noteWidth,r=e.iconsBBox,a=this.isPlaceholder,i=this.model,o=this.border,c=this.contentWidth,l=this.contentHeight;if(a)return i.width;var s,u=this.getMinWidth();if(i.width)s=Math.max(i.width,u);else if(s=c+t[1]+t[3]+n+r.width,"capsule"===o.shape){var d=t[1]+t[3];l>d&&(s+=l-d)}return ht(Math.ceil(s),u)}},{key:"getHeight",value:function(e){var t=e.padding;return this.isPlaceholder?this.model.height:ht(this.contentHeight+t[0]+t[2],this.minHeight)}},{key:"getContentWidth",value:function(e){var t=e.padding,n=e.noteWidth,r=e.iconsBBox,a=this.textareaBBox,i=this.image,o=this.model;if(o.width){var c=this.getMinWidth();return Math.max(o.width,c)-n-t[1]-t[3]-r.width}return Math.ceil(Math.max(a.width,i.width))||100}},{key:"getTextareaHeight",value:function(){var e=this.textareaBBox,t=this.image,n=this.diagram;return t.src&&this.isContentEmpty()&&!n.contentEditor.isBegin?0:e.height}},{key:"getContentHeight",value:function(e){var t=this.image,n=this.getTextareaHeight();return Math.ceil(n+t.height)}},{key:"updateState",value:function(){this.setDefault(),this.subcells.forEach((function(e){e.updateState()}))}},{key:"setDefault",value:function(){this.subcells.forEach((function(e){e.setDefault()}))}},{key:"updateCache",value:function(){this.cache.width=this.width,this.cache.height=this.height,this.cache.html=this.html,this.cache.collapsed=this.collapsed,this.cache.icons=s()(this.icons),this.cache.roughFillStyle=this.computedProps.roughFillStyle}},{key:"preventDelete",value:function(){return!1}},{key:"beginEditContent",value:function(){this.state.beginEdit=!0,this.updateState()}},{key:"endEditContent",value:function(){this.state.beginEdit=!1,this.updateState()}},{key:"getEventObject",value:function(e){return{cell:this,nativeEvent:e}}},{key:"destroy",value:function(){this.subcells.forEach((function(e){e.destroy()})),I()(L()(n.prototype),"destroy",this).call(this)}},{key:"getNewQuadIndexByNewRealIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.quadrantTreeLists[t-1],r=n.findIndex((function(t){return t>=e}));return-1!==r?r:n.length}},{key:"mindmapParent",get:function(){var e=this.parent;return e&&e.isMindmap?e:void 0}},{key:"quadrantTreeLists",get:function(){var e=this.getChildren();if(this.isTwoQuadrantLayout){var t=[[],[]];return e.forEach((function(e,n){var r=e.model,a=r.layout,i=(void 0===a?{}:a).quadrant,o=void 0===i?1:i,c=r.abstract,l=Math.min(2,Math.max(1,o));c||t[l-1].push(n)})),t}return[le()(e.filter((function(e){return!e.model.abstract})).length)]}},{key:"isTwoQuadrantLayout",get:function(){return n.modelIsTwoQuadrantLayout(this.model)}},{key:"realQuadrant",get:function(){var e=this.mindmapParent;if(e){var t=this.model.layout,n=(void 0===t?{}:t).quadrant,r=void 0===n?1:n;if(e.layoutQuadrantConstraint&&e.layoutQuadrantConstraint.length>1)return r}return 1}},{key:"quadrantNth",get:function(){var e=this.parent&&this.parent.isTwoQuadrantLayout,t=this.getNth();if(e){var n=this.parent.quadrantTreeLists[this.realQuadrant-1];if(!this.isAbstract)return n.indexOf(t)}return this.parent&&this.parent.isMindmap?t:-1}},{key:"abstractCoveredCells",get:function(){var e=this.model,t=e.abstract,n=e.start,r=e.end,a=this.realQuadrant;if(this.parent&&t&&void 0!==n&&void 0!==r){var i=this.parent.getChildren();return this.parent.quadrantTreeLists[a-1].slice(n,r+1).map((function(e){return i[e]}))}return[]}},{key:"abstractCoveredCellsWithAllChildren",get:function(){var e=this.model,t=e.abstract,n=e.start,r=e.end,a=this.realQuadrant,i=function e(t){return t.collapsed?[t]:[t].concat(t.getChildren().map((function(t){return e(t)})).reduce((function(e,t){return e.concat(t)}),[]))};if(this.parent&&t&&void 0!==n&&void 0!==r){var o=this.parent.getChildren();return this.parent.quadrantTreeLists[a-1].slice(n,r+1).map((function(e){return o[e]})).reduce((function(e,t,n){return e.concat(i(t))}),[])}return[]}},{key:"validIconKeys",get:function(){var e=this.model.icons;return e?Xn.filter((function(t,n){return"number"==typeof e[t]&&e[t]>=0&&e[t]<Wn[n]})):[]}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{x:0,y:0,rotate:0,collapsed:!1,html:er,layout:{},image:{width:0,height:0},note:{width:14,height:14,padding:[0,8,0,0]},anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],Subcells:uu,penetratedKeys:["x","y","width","collapsed","quadrant","zIndex","html","layout","rainbow","tapered","note","treeEdge","icons","roughFillStyle"].concat(uu.map((function(e){return e.configName}))),isMindmap:!0,multiSelectHighlight:!1,resizeRotatePoints:["tr"]})}},{key:"modelIsTwoQuadrantLayout",value:function(e){var t=e.layout,n=void 0===t?{}:t,r=n.type,a=void 0===r?"standard":r,i=n.quadrantConstraint,o=void 0===i?void 0:i;return"mindmap"===e.type&&"standard"===a&&(!o||o.length>1)}}]),n}();function fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pu(e){"flowchart"===e.type&&(e.type="geometry"),"edge"===e.type&&(e.type="line")}function mu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vu(e,t){switch((e=yu(yu({"stroke-linecap":"butt","stroke-linejoin":"round"},t),e)).name){case"rect":return new(t?ti:va)(e);case"ellipse":return new(t?Ua:ca)(e);case"polygon":return new(t?Ja:pa)(e);default:return new(t?Va:aa)(e)}}function gu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(du,"className","MindmapBase");var xu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"sceneKeys",[]),c()(E()(e),"group",new Zr),c()(E()(e),"elements",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;Pn(e)?e.clipGroup.add(this.group):e.graphicGroup.add(this.group)}},{key:"renderElements",value:function(){var e=this.group,t=this.cell,n=t.stencil,r=[],a=t.getRoughGraphicOptions();n.scene.forEach((function(t){var n=vu(t,a);t.attr&&n.update(t.attr),e.add(n),r.push(n)})),this.elements=r}},{key:"update",value:function(){var e=this.cell,t=this.elements;e.isCacheStale("shape","roughFillStyle")&&(t&&t.forEach((function(e){return e.remove()})),this.renderElements())}},{key:"draw",value:function(){var e=this.cell,t=this.elements,n=e.stroke,r=e.width,a=e.height,i=e.stencil,o=bu({},e.convertStrokeStyle());e.isCacheStale("stroke","roughFillStyle")&&(o.stroke=n.color,o["stroke-width"]=!0===(null==i?void 0:i.open)?2*n.width:n.width),t.forEach((function(e,t){var n,c,l=null===(n=i.scene[t])||void 0===n?void 0:n.path;if(l)c=l(r,a);else{var s=r/i.width,u=a/i.height;c=e.getPath(s,u)}e.update(bu(bu({},o),{},{d:c},i.scene[t].attr))}))}}]),n}();function ku(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var wu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",void 0),c()(E()(e),"shapeElement",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new Zr;this.group=t,kn(e)||wn(e)?e.clipGroup.add(this.group):Sn(e)?e.group.add(this.group):e.graphicGroup.add(t)}},{key:"update",value:function(){var e=this.cell,t=this.group,n=e.createOutlineShapeElement();if(n){if(t.clear(),Pn(e)){var r=e.stencil.outline;r.style&&n.css(r.style)}t.add(n),this.shapeElement=n,e.outlineElement=n}}},{key:"draw",value:function(){var e=this.cell,t=this.shapeElement,n=e.stroke,r=e.fill,a=e.stencil;if(n){var i={},o=e.getOutlinePath(t),l=e.getRoughGraphicOptions();o&&(i.d=o);var s=n.width;a&&(!1===a.isClip||l||(s*=2)),e.isCacheStale("stroke","roughFillStyle")&&Object.assign(i,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ku(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({stroke:n.color,"stroke-width":s},e.convertStrokeStyle())),Sn(e)||bn(e)||wn(e)?i.fill="transparent":e.isCacheStale("fill","roughFillStyle")&&(i.fill=r.color),t.update(i)}}}]),n}();function Cu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}["getTotalLength","isPointInFill","isPointInStroke"].forEach((function(e){Object.defineProperty(wu.prototype,e,{value:function(){var t;return(t=this.shapeElement)[e].apply(t,arguments)}})}));var Au=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"textareaContentStyleSheets",void 0),c()(E()(e),"rotate",void 0),c()(E()(e),"fill",void 0),c()(E()(e),"textareaRegion",void 0),c()(E()(e),"textVerticalAlign",void 0),c()(E()(e),"outlineElement",void 0),c()(E()(e),"clipPathID",Object(F.a)()),c()(E()(e),"clipGroup",new Zr),e}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,e),this.initSubcell(),this.eventDelegation(),this.render()}},{key:"canUseAddLineButton",value:function(){return!0}},{key:"initSubcell",value:function(){var e=this;this.subcells=this.Subcells.map((function(t){return new t(e)}))}},{key:"getEventObject",value:function(e){return{cell:this,nativeEvent:e}}},{key:"eventDelegation",value:function(){var e=this.graphicGroup;this.delegateEvent(e,"mouseenter","vertexcell:mouseenter"),this.delegateEvent(e,"mouseleave","vertexcell:mouseleave")}},{key:"draw",value:function(){this.subcells.forEach((function(e){return e.draw()})),this.graphicGroup.attr({opacity:this.opacity}),this.drawPosition(),this.updateCache()}},{key:"updateCache",value:function(){var e=this,t=this.cache;["x","y","width","height","rotate","shape","fill","stroke","controlPoints","round","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"render",value:function(){var e=this.model;this.subcells.forEach((function(e){return e.render()})),this.updateModel(e),this.graphicGroup.prepend(this.clipGroup)}},{key:"getTextareaPosition",value:function(e){var t=this.width,n=this.height,r=this.getPadding(),a=e.height;return{x:Math.max((t-e.width)/2,r[3]),y:(n-a)/2}}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}},{key:"updateMatrix",value:function(){if(this.isCacheStale("x","y","width","height","rotate")){var e=this.x,t=this.y,n=this.width,r=this.height,a=this.rotate;this.matrix=Xi(e,t,n,r,a)}}},{key:"getKeyShape",value:function(){var e;return null===(e=this.subcells.find((function(e){return e instanceof wu})))||void 0===e?void 0:e.shapeElement}},{key:"destroy",value:function(){this.subcells.forEach((function(e){return e.destroy()})),I()(L()(n.prototype),"destroy",this).call(this)}},{key:"beforeUpdateModel",value:function(e){if(this.constraints&&this.constraints.proportion){var t=this.width/this.height;e.height>0&&null==e.width?e.width=e.height*t:e.width>0&&(e.height=e.width/t)}}},{key:"afterUpdateModel",value:function(){if(this.updateMatrix(),this.subcells.forEach((function(e){e.update()})),this.stencil){var e=this.getRoughGraphicOptions();!1===this.stencil.isClip||e?this.clipGroup.update({"clip-path":"none"}):this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")})}}},{key:"updateModel",value:function(e){this.beforeUpdateModel(e),I()(L()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{html:"",x:0,y:0,rotate:0,anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],opacity:1,penetratedKeys:["x","y","width","height","category","stroke","fill","rotate","html","shape","image","constraints","opacity"],textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums",margin:0}}],Subcells:[wu,Xs],isVertex:!0})}}]),n}();c()(Au,"className","VertexCell");var Ou=function(e,t){return{minX:4,minY:4,maxX:e-4,maxY:t-4}};var Eu=function(e){S()(n,Au);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"stencil",void 0),c()(E()(e),"stencils",void 0),c()(E()(e),"controlPoints",void 0),c()(E()(e),"round",void 0),c()(E()(e),"shape",void 0),c()(E()(e),"isGeometry",!0),c()(E()(e),"outlineElement",void 0),e}return v()(n,[{key:"canRough",value:function(){return!0}},{key:"canRound",value:function(){return void 0!==this.model.round}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets,t=this.textareaRegion;e.find((function(e){return"self"===e.query})).css.width="".concat(t.maxX-t.minX,"px")}},{key:"getTextareaPosition",value:function(e){var t=this.textareaRegion,n=this.textVerticalAlign,r={x:t.minX,y:0};return r.y="top"===n?t.minY:"bottom"===n?t.maxY-e.height:(t.minY+t.maxY-e.height)/2,r}},{key:"_updateStencil",value:function(){var e=this.shape,t=this.stencils,n=e||"process";if(!this.stencil||this.stencil.name!==n){var r=t.find((function(e){return e.name===n}));if(!r)throw new Error("unknown shape ".concat(n));this.stencil=r,this._updateAnchors(),this._updateDefaultSize(),this.cache={}}}},{key:"_updateTextareaRegion",value:function(){var e,t=this.stencil,n=this.width,r=this.height,a=this.controlPoints,i=(null==t||null===(e=t.textarea)||void 0===e?void 0:e.region)||Ou;this.textareaRegion=i(n,r,a)}},{key:"_updateDefaultSize",value:function(){var e=this,t=this.stencil;["width","height"].forEach((function(n){null==e[n]&&(e[n]=t[n])}))}},{key:"_updateAnchors",value:function(){for(var e=this.anchors,t=this.stencil,n=function(){var n=e[r],a=t.anchors.find((function(e){return e.name===n.name}));a&&(e[r]=a)},r=0;r<e.length;r++)n()}},{key:"afterUpdateModel",value:function(){this._updateStencil(),this._updateTextareaRegion(),I()(L()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.stencil,t=this.getRoughGraphicOptions();return vu(e.outline,t)}}},{key:"getOutlinePath",value:function(e){if(this.isCacheStale("width","height","shape","controlPoints","round","roughFillStyle")){var t,n=this.width,r=this.height,a=this.stencil,i=this.controlPoints,o=this.round;if(a.outline.path)t=a.outline.path(n,r,i,o);else{var c=n/a.width,l=r/a.height;t=e.getPath(c,l)}return t}return null}},{key:"render",value:function(){I()(L()(n.prototype),"render",this).call(this);var e=this.model;e.width||(e.width=this.width),e.height||(e.height=this.height)}},{key:"getOuterWidth",value:function(){return this.width}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stencils:oc,shape:"process",stroke:{color:"#595959",width:2},fill:{color:"#fff"},Subcells:[xu,nu],textVerticalAlign:"center",penetratedKeys:["textVerticalAlign","controlPoints","round"]})}}]),n}();c()(Eu,"className","Geometry");var Pu=aa,Su=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).eventHelper=new fl,r}return v()(n,[{key:"render",value:function(){var e=this.cell.graphicGroup,t=new Pu;e.add(t),this.element=t,this.delegateEvent()}},{key:"delegateEvent",value:function(){var e=this.element,t=this.cell;t.delegateEvent(e,"mouseenter","groupcellrect:mouseenter"),t.delegateEvent(e,"mouseleave","groupcellrect:mouseleave")}},{key:"getClassNames",value:function(){return this.classNames.join(" ")}},{key:"draw",value:function(){var e=this.cell,t=this.element,n=e.width,r=e.height;e.isCacheStale("width","height")&&t.update({d:un(0,0,n,r),"stroke-width":1,fill:"rgba(0, 0, 0, 0)"})}},{key:"updateState",value:function(){var e=this.cell,t=this.element,n=e.diagram,r=e.state,a=r.actived,i=r.hover,o=n.signal;return a||i&&!o.dragging?t.update({stroke:"rgba(9, 109, 217, 0.4)"}):t.update({stroke:"none"})}},{key:"destroy",value:function(){this.element.destroy(),this.eventHelper.destroy()}}]),n}();var ju=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"isGroup",!0),r}return v()(n,[{key:"children",get:function(){return this.getChildren()}},{key:"init",value:function(e){var t=this;I()(L()(n.prototype),"init",this).call(this,e),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.render()}},{key:"canText",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"render",value:function(){var e=this.model;this.subcells.forEach((function(e){return e.render()})),this.updateModel(e)}},{key:"hover",value:function(e){this.state.hover=e,this.updateState()}},{key:"updateState",value:function(){this.subcells.forEach((function(e){e.updateState()}))}},{key:"_hasEntity",value:function(){var e=!1;return this.deepEach((function(t){return!!t.isGroup||(e=!0,!1)})),e}},{key:"_drawInner",value:function(){var e=this.graphicGroup,t=this.getChildren(),n=1/0,r=1/0,a=-1/0,i=-1/0;this.show(),t.forEach((function(e){var t;t=e.isGroup?e.getBBox():xn(e)?e.getPointBox():On(e)?e.getFullBBox():e.getBBox(),n=Math.min(n,t.minX),r=Math.min(r,t.minY),a=Math.max(a,t.maxX),i=Math.max(i,t.maxY)}));var o=[1,0,0,0,1,0,n,r,1];this.x=n,this.y=r,this.width=a-n,this.height=i-r,this.matrix=o,this.isCacheStale("x","y","width","height")&&(this.subcells.forEach((function(e){return e.draw()})),e.update({matrix:o})),this.cache.x=n,this.cache.y=r,this.cache.width=a-n,this.cache.height=i-r}},{key:"draw",value:function(){var e=this.diagram.interaction;if(!this._hasEntity()||"edit"!==e.currentMode)return this.hide();this._drawInner()}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{fill:"rgba(2, 2, 2, 0.3)",x:0,y:0,width:1,height:1,isGroup:!0,Subcells:[Su]})}}]),n}();c()(ju,"className","GroupCell");var Ru=da,Mu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new Ru;this.element=t,e.graphicGroup.add(t)}},{key:"update",value:function(){var e=this.cell,t=this.element,n=e.diagram,r=e.image,a=n.imageManager;if(r&&e.isCacheStale("image","width","height")){var i=r.src,o=r.naturalWidth,c=r.naturalHeight;t.update({width:e.width,height:e.height}),a.setImageHref(t,i,o,c)}}},{key:"destroy",value:function(){this.element.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var Lu=function(e){S()(n,Au);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape"))return vu({name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1})}},{key:"getOutlinePath",value:function(e){if(this.isCacheStale("width","height","shape")){var t=this.width/120,n=this.height/60;return e.getPath(t,n)}return null}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{fill:{color:"rgba(255,255,255,0)"},image:{},shape:"image",stroke:{width:1},Subcells:[Mu],isImage:!0})}}]),n}();c()(Lu,"className","ImageCell");var Bu=function(){function e(t){m()(this,e),c()(this,"line",void 0),c()(this,"points",void 0),this.line=t}return v()(e,[{key:"getFirstInsertControlPoints",value:function(){return!1}},{key:"getTextareaPosition",value:function(){return this.line.getPointByPercent(void 0===this.line.textPosition?.5:this.line.textPosition)}},{key:"getControlPointButtonPosition",value:function(e){return this.line.controlPoints[e]}},{key:"updatePoints",value:function(){var e=this.line,t=e.source,n=e.target,r=e.sourceCell,a=e.targetCell,i=e.controlPoints.map((function(e){var t=b()(e,2);return{x:t[0],y:t[1]}})).filter((function(e){return!isNaN(e.x)})),o=i.length,c=e.getEndpoint(t),l=e.getEndpoint(n);if(Ti(c)&&Ti(l))if(c&&l){if(c.x===l.x&&c.y===l.y&&0===i.length)return l.x+=2,l.y+=2,void(this.points=[c,l]);"elbow"===e.shape?(r&&!t.connection&&(c=r.snapAnchor(i[0]||l)[0]),a&&!n.connection&&(l=a.snapAnchor(i[o-1]||c)[0])):(r&&!t.connection&&(c=r.getIntersectionPoint(i[0]||l)),a&&!n.connection&&(l=a.getIntersectionPoint(i[o-1]||c))),this.points=[c].concat(i).concat(l)}else this.points=[c,l]}},{key:"getPoints",value:function(){return this.points||this.updatePoints(),this.points}},{key:"getPath",value:function(){return""}}]),e}();var Du=function(e){S()(n,Bu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getPath",value:function(){var e,t=this.line,n=t.tailOffset,r=t.tipOffset,a=this.getPoints();if(2===a.length){(e=Ut(t)).unshift(["M",a[0].x,a[0].y]);var i={x:e[0][1],y:e[0][2]},o={x:e[1][1],y:e[1][2]},c={x:e[1][5],y:e[1][6]},l={x:e[1][3],y:e[1][4]};i=io(o.x,o.y,i.x,i.y,n),c=io(l.x,l.y,c.x,c.y,r),e[0][1]=i.x,e[0][2]=i.y,e[1][5]=c.x,e[1][6]=c.y}else if(3===a.length){var s=a[0],u=a[1],d=a[2];s=io((u={x:(u.x-.25*d.x-.25*s.x)/.5,y:(u.y-.25*d.y-.25*s.y)/.5}).x,u.y,s.x,s.y,n),d=io(u.x,u.y,d.x,d.y,r),u={x:(a[1].x-.25*d.x-.25*s.x)/.5,y:(a[1].y-.25*d.y-.25*s.y)/.5},e=[["M",s.x,s.y],["Q",u.x,u.y,d.x,d.y]]}else{(e=Kt(a)).unshift(["M",a[0].x,a[0].y]);var f=e.length-1,h={x:e[f][5],y:e[f][6]},p={x:e[f][3],y:e[f][4]},m={x:e[0][1],y:e[0][2]},y={x:e[1][1],y:e[1][2]};m=io(y.x,y.y,m.x,m.y,n),h=io(p.x,p.y,h.x,h.y,r),e[0][1]=m.x,e[0][2]=m.y,e[f][5]=h.x,e[f][6]=h.y}return Jt(e)}}]),n}();function Nu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Iu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,e),Object.assign(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({expandRectGap:16},t))}return v()(e,[{key:"getExpandedBBox",value:function(e){var t=this.expandRectGap;return{minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t}}},{key:"getRectLines",value:function(e){var t=500;return[{x1:e.minX,y1:e.minY-t,x2:e.minX,y2:e.maxY+t},{x1:e.minX-t,y1:e.minY,x2:e.maxX+t,y2:e.minY},{x1:e.maxX,y1:e.minY-t,x2:e.maxX,y2:e.maxY+t},{x1:e.minX-t,y1:e.maxY,x2:e.maxX+t,y2:e.maxY}]}},{key:"getVertexLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ray",r=500;return"all"===t?[{x1:e.x,y1:e.y,x2:e.x,y2:e.y-r,type:n},{x1:e.x,y1:e.y,x2:e.x-r,y2:e.y,type:n}]:"N"===t||"S"===t?["N"===t?{x1:e.x,y1:e.y,x2:e.x,y2:e.y-r,type:n}:{x1:e.x,y1:e.y,x2:e.x,y2:e.y+r,type:n}]:["W"===t?{x1:e.x,y1:e.y,x2:e.x-r,y2:e.y,type:n}:{x1:e.x,y1:e.y,x2:e.x+r,y2:e.y,type:n}]}},{key:"vMiddleLine",value:function(e,t){var n;n=Math.abs(e.minX-t.maxX)<Math.abs(e.maxX-t.minX)?(e.minX+t.maxX)/2:(e.maxX+t.minX)/2;var r=((e.minY+e.maxY)/2+(t.minY+t.maxY)/2)/2;return{x1:n,y1:r-500,x2:n,y2:r+500}}},{key:"hMiddleLine",value:function(e,t){var n;n=Math.abs(e.minY-t.maxY)<Math.abs(e.maxY-t.minY)?(e.minY+t.maxY)/2:(e.maxY+t.minY)/2;var r=((e.minX+e.maxX)/2+(t.minX+t.maxX)/2)/2;return{x1:r-500,y1:n,x2:r+500,y2:n}}},{key:"cost",value:function(e){var t,n=e.vertex,r=e.end,a=e.middleLine,i=0,o=0;return t=n.distance+so(n.x,n.y,r.x,r.y),n.from&&n.from.from&&co(n.x,n.y,n.from.x,n.from.y)!==co(n.from.x,n.from.y,n.from.from.x,n.from.from.y)&&(i=-1),a&&n.from&&n.from.from&&yo(n,a)&&!yo(n.from.from,a)&&n.from&&n.from.from&&co(n.x,n.y,n.from.x,n.from.y)!==co(n.from.x,n.from.y,n.from.from.x,n.from.from.y)&&(o=2),-t+i+o}},{key:"getSide",value:function(e,t){var n=[(e.minX+e.maxX)/2,(e.minY+e.maxY)/2],r=[e.maxX,e.minY],a=[e.maxX,e.maxY],i=[r[0]-n[0],r[1]-n[1]],o=[a[0]-n[0],a[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]],l=w.vec2.angle(i,o),s=l/2,u=[0,s],d=[u[1],s+Math.PI-l],f=[d[1],s+Math.PI],h=[2*Math.PI-s,2*Math.PI],p=w.vec2.angle(c,[1,0]);return c[1]<0&&(p=2*Math.PI-p),pt(p,u)||pt(p,h)?"E":pt(p,d)?"S":pt(p,f)?"W":"N"}},{key:"dedupePoints",value:function(e){if(e.length>=3){for(var t=[e[0]],n=1;n<e.length-1;n++){var r=e[n-1],a=e[n],i=e[n+1];Ji(r.x,a.x)&&Ji(i.x,a.x)||Ji(r.y,a.y)&&Ji(i.y,a.y)||t.push(a)}return t.push(e[e.length-1]),t}return e}},{key:"getExpandPoint",value:function(e,t,n){return"N"===n?{x:e.x,y:t.minY}:"S"===n?{x:e.x,y:t.maxY}:"W"===n?{x:t.minX,y:e.y}:"E"===n?{x:t.maxX,y:e.y}:null}},{key:"find",value:function(e,t){var n=this,r=e.cell,a=t.cell,i=r&&r.getBBox(),o=a&&a.getBBox(),c=i&&this.getExpandedBBox(i),l=o&&this.getExpandedBBox(o),s=[];s=c?s.concat(this.getRectLines(c)):s,s=l?s.concat(this.getRectLines(l)):s;var u,d,f,h=new Mo("start"),p=new Mo("end"),m=[e.x,e.y],y=[t.x,t.y];Object.assign(h,{x:m[0],y:m[1]}),Object.assign(p,{x:y[0],y:y[1]}),i?(d=this.getSide(i,m),s=s.concat(this.getVertexLine(h,d))):s=s.concat(this.getVertexLine(h,"all","straight")),o?(f=this.getSide(o,y),s=s.concat(this.getVertexLine(p,f))):s=s.concat(this.getVertexLine(p,"all","straight")),a&&r&&("E"===d&&"W"===f?u=r.x+r.width<a.x?this.vMiddleLine(i,o):this.hMiddleLine(i,o):"W"===d&&"E"===f?u=r.x+r.width<a.x?this.hMiddleLine(i,o):this.vMiddleLine(i,o):"S"===d&&"N"===f?u=r.y+r.height>a.y?this.vMiddleLine(i,o):this.hMiddleLine(i,o):"N"===d&&"S"===f&&(u=r.y+r.height>a.y?this.hMiddleLine(i,o):this.vMiddleLine(i,o))),e.d&&("N"===d?h.y-=e.d:"S"===d?h.y+=e.d:"E"===d?h.x+=e.d:"W"===d&&(h.x-=e.d)),t.d&&("N"===f?p.y-=t.d:"S"===f?p.y+=t.d:"E"===f?p.x+=t.d:"W"===f&&(p.x-=t.d)),u&&s.push(u);var v=Io(s);i&&o&&!to(c,l)&&v.getAllEdges().forEach((function(e){var t=e.startVertex,n=e.endVertex,r={x1:t.x,y1:t.y,x2:n.x,y2:n.y};(mo(r,i)||mo(r,o))&&v.deleteEdge(e)}));var g,b=this.getExpandPoint(h,c,d)||h,x=this.getExpandPoint(p,l,f)||p,k=v.snap(b),w=v.snap(x);return k.from=h,w.from=p,g=Ji(k.x,w.x)&&Ji(k.y,w.y)?[]:To(v,k,w,(function(e,t,r){return n.cost({vertex:e,start:t,end:r,middleLine:u})})),g.unshift(h),g.push(p),this.dedupePoints(g)}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();function Tu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fu=new Iu,zu=function(e){S()(n,Bu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"truncate",value:function(e){var t=this.line,n=t.tailOffset,r=t.tipOffset,a=ln(e),i=a[a.length-1],o=a[a.length-2],c=a[0],l=a[1],s=io(o[1],o[2],i[1],i[2],r),u=io(l[1],l[2],c[1],c[2],n);return i[1]=s.x,i[2]=s.y,c[1]=u.x,c[2]=u.y,Jt(a)}},{key:"getPath",value:function(){return this.truncate(this._getPath())}},{key:"_getPath",value:function(){var e=this.line,t=e.source,n=e.target,r=e.diagram;if(!r)return"";var a=this.getPoints();if(e.controlPoints.length>0)return Jt(tn(e.controlPoints,a,e.resizer.getElbowMergeSig()));var i=r.find(t.id),o=r.find(n.id),c=e.getEndpoint(t),l=e.getEndpoint(n);if(null!=i&&i===o&&ro(c.x,c.y,l.x,l.y)<8&&0!==e.controlPoints.length)return Jt([["M",(c=i.getPoint([1,.5])).x,c.y-8],["l",16,0],["l",0,16],["L",c.x,c.y+8]]);if(!c||!l)return Jt([["M",0,0],["L",50,0],["L",50,50]]);if(!i&&!o&&0===e.controlPoints.length){if(c.x===l.x)return"M".concat(c.x,",").concat(c.y," L").concat(l.x,",").concat(l.y);var s=.5*(c.x+l.x);return"M".concat(c.x,",").concat(c.y," L").concat(s,",").concat(c.y," L").concat(s,",").concat(l.y," L").concat(l.x,",").concat(l.y)}return sn(Fu.find(_u(_u({cell:i},a[0]),{},{d:0}),_u(_u({cell:o},a[1]),{},{d:0})))}}]),n}(),qu={none:function(){return{baseOffset:0,pc:0,path:[]}},"open-triangle":function(e){return{baseOffset:0,pc:1,fill:"none",path:[["M",-1*e,-1*e*Math.sin(Qi(30))],["L",0,0],["L",-1*e,e*Math.sin(Qi(30))]]}},"one-side-up":function(e){return{baseOffset:0,pc:0,fill:"none",path:[["M",0,0],["L",-1*e,-1*e*Math.sin(Qi(30))]]}},"one-side-down":function(e){return{baseOffset:0,pc:0,fill:"none",path:[["M",0,0],["L",-1*e,e*Math.sin(Qi(30))]]}},arrow:function(e){var t=20;return{baseOffset:2*e*Math.cos(Qi(t))-e,pc:1/(2*Math.sin(Qi(t))),path:[["M",-e*Math.cos(Qi(t)),-e*Math.sin(Qi(t))],["A",e,e,t,0,1,-e*Math.cos(Qi(t)),e*Math.sin(Qi(t))],["L",0,0],["Z"]]}},"hollow-triangle":function(e){return{baseOffset:e,pc:1,fill:"white",path:[["M",0,0],["L",-1*e,-1*e*Math.sin(Qi(30))],["L",-1*e,e*Math.sin(Qi(30))],["Z"]]}},"sharp-solid-square":function(e){var t=e/=2,n=Math.tan(Qi(60))*t;return{baseOffset:2*n,pc:1,path:[["M",0,0],["L",-n,-t],["L",-2*n,0],["L",-n,t],["Z"]]}},"sharp-hollow-square":function(e){var t=e/=2,n=Math.tan(Qi(60))*t;return{baseOffset:2*n,pc:1,fill:"white",path:[["M",0,0],["L",-n,-t],["L",-2*n,0],["L",-n,t],["Z"]]}},"flat-solid-square":function(e){return{baseOffset:2*(e*=Math.tan(Qi(30))),pc:.5,path:[["M",0,-1*e],["L",-2*e,-1*e],["L",-2*e,e],["L",0,e],["Z"]]}},"flat-hollow-square":function(e){return{baseOffset:2*(e*=Math.tan(Qi(30))),pc:.5,fill:"white",path:[["M",0,-1*e],["L",-2*e,-1*e],["L",-2*e,e],["L",0,e],["Z"]]}},"solid-circle":function(e){return{baseOffset:2*(e*=Math.tan(Qi(30))),pc:.5,path:en(-1*e,0,e)}},"hollow-circle":function(e){return{baseOffset:2*(e*=Math.tan(Qi(30))),pc:.5,fill:"white",path:en(-e,0,e)}},"cross-circle":function(e){var t=-(e*=Math.tan(Qi(30))),n=e;return{baseOffset:2*e,pc:.5,fill:"white",path:en(t,0,n)+Jt([["M",t,-n],["L",t,n],["M",-2*n,0],["L",0,0]])}},"half-open-circle":function(e){return{baseOffset:e*=Math.tan(Qi(30)),pc:0,fill:"none",path:[["M",0,0],["m",0,-e],["A",e,e,0,1,0,0,e]]}},"end-vertical-line":function(e){return{baseOffset:0,pc:.5,fill:"none","stroke-linecap":"square",path:[["M",0,-(e*=Math.tan(Qi(30)))],["L",0,e]]}},"middle-vertical-line":function(e){return{baseOffset:e/=1.5,pc:0,fill:"none",path:[["M",-1*e,2*-e/3],["L",-1*e,2*e/3],["M",-1*e,0],["L",0,0]]}},"double-vertical-line":function(e){var t=2*(e/=1.5)/3;return{baseOffset:2*e,pc:0,fill:"none",path:[["M",-2*e,-t],["L",-2*e,t],["M",-e,-t],["L",-e,t],["M",-2*e,0],["L",0,0]]}},"single-slash":function(e){return{baseOffset:e/=1.5,pc:0,path:[["M",0,0],["L",-e,0],["M",-(e+e*Math.cos(Qi(60))),-e*Math.sin(Qi(60))],["L",-(e-e*Math.cos(Qi(60))),e*Math.sin(Qi(60))]]}},"three-line":function(e){return{baseOffset:e,pc:0,fill:"none",path:[["M",-1*e,0],["L",0,0],["M",-1*e,0],["L",0,-1*Math.sin(Qi(30))*e],["M",-1*e,0],["L",0,Math.sin(Qi(30))*e]]}},"three-line-plus-vertical":function(e){var t=Math.sin(Qi(30))*e;return{baseOffset:e,pc:0,fill:"none",path:[["M",-e,0],["L",0,0],["M",-e,0],["L",0,-t],["M",-e,0],["L",0,t],["M",-e,-t],["L",-e,t]]}},"three-line-plus-circle":function(e){var t=Math.sin(Qi(30))*e,n=-e-t;return{baseOffset:e+2*t,pc:0,fill:"white",path:Jt([["M",-e,0],["L",0,0],["M",-e,0],["L",0,-t],["M",-e,0],["L",0,t]])+en(n,0,t)}},"circle-vertical":function(e){var t=.5*e,n=-(e+t);return{baseOffset:2*e,pc:0,fill:"white",path:Jt([["M",-t,-t],["L",-t,t],["M",0,0],["L",-e,-0]])+en(n,0,t)}}},Yu=["none","open-triangle","one-side-up","one-side-down","arrow","hollow-triangle","sharp-solid-square","sharp-hollow-square","flat-solid-square","flat-hollow-square","solid-circle","hollow-circle","cross-circle","half-open-circle","end-vertical-line","middle-vertical-line","double-vertical-line","single-slash","three-line","three-line-plus-vertical","three-line-plus-circle","circle-vertical"];var Hu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e,r){var a;return m()(this,n),(a=t.call(this,e)).type=r,c()(E()(a),"element",void 0),c()(E()(a),"group",void 0),c()(E()(a),"stencil",void 0),c()(E()(a),"sp",void 0),c()(E()(a),"ep",void 0),c()(E()(a),"cell",void 0),a.cell=e,a}return v()(n,[{key:"render",value:function(){var e=this.cell,t=e.graphicGroup,n=new Zr;n.update({"clip-path":"url(#".concat(e.clipPathID,")")}),this.group=n,t.add(this.group)}},{key:"createRendererElement",value:function(){var e=this.group,t=this.cell;if(t.isCacheStale("shape","roughFillStyle")){var n=new(t.getRoughGraphicOptions()?Va:aa)({"stroke-miterlimit":"10",roughFillStyle:"solid"});e.add(n),this.element&&this.element.remove(),this.element=n}}},{key:"getEndPointName",value:function(){var e=this.cell;return("tip"===this.type?e.target.marker:e.source.marker)||"none"}},{key:"getOhterEndPointName",value:function(){var e=this.cell;return("tail"===this.type?e.target.marker:e.source.marker)||"none"}},{key:"getRatio",value:function(){return 6+2*(this.cell.stroke.width-1)}},{key:"update",value:function(){var e=this.cell,t=this.type,n=this.getEndPointName(),r=this.getRatio();this.stencil=qu[n](r);var a=this.stencil,i=a.baseOffset,o=a.pc,c=qu[this.getOhterEndPointName()](r),l=c.baseOffset+c.pc,s=i+e.stroke.width*o;e["".concat(t,"Offset")]=s;var u=e.getPoints();if(Array.isArray(u)){var d=u.length,f=u[0],h=u[1];if("tip"===t&&(f=u[d-1],h=u[d-2]),f&&h){var p=ro(f,h),m=e.target.marker&&"none"!==e.target.marker&&e.source.marker&&"none"!==e.source.marker?40:20;if(p<=(m=Math.max(m,s+l+20))){var y=ut(p/m*r,.01,r);this.stencil=qu[n](y);var v=this.stencil,g=v.baseOffset,b=v.pc;s=g+e.stroke.width*b}e["".concat(t,"Offset")]=s}}}},{key:"computeEndPoints",value:function(){this.update();var e,t,n,r,a=this.type,i=this.cell,o=i.d,c=i.shape,l=ln(o),s=this.cell.getPoints();if("curve"===c){if(l.length<=1)return;if("tail"===a)e=s[0].x,t=s[0].y,n=l[1][1],r=l[1][2];else{var u=s.length;if(e=s[u-1].x,t=s[u-1].y,2===s.length)n=l[1][3],r=l[1][4];else if(3===s.length)n=l[1][1],r=l[1][2];else{var d=l.length-1;n=l[d][3],r=l[d][4]}}}else if("tail"===a)if("straight"===c)e=s[0].x,t=s[0].y,n=s[1].x,r=s[1].y;else{e=s[0].x,t=s[0].y;var f=b()(l[1],3);n=f[1],r=f[2]}else if("straight"===c){var h=s.length;e=s[h-1].x,t=s[h-1].y,n=s[h-2].x,r=s[h-2].y}else{e=s[s.length-1].x,t=s[s.length-1].y;var p=b()(l[l.length-2],3);n=p[1],r=p[2]}this.sp={x:n,y:r},this.ep={x:e,y:t}}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=this.type,r=e.stroke;if(this.computeEndPoints(),this.ep&&this.sp){var a=[1,0,0,0,1,0,-1*e.stroke.width*this.stencil.pc,0,1],i=[1,0,0,0,1,0,this.ep.x,this.ep.y,1],o=w.mat3.rotate([],[1,0,0,0,1,0,0,0,1],oo(this.sp.x,this.sp.y,this.ep.x,this.ep.y)),c=a;if("tail"===n){var l=e.source.marker;"one-side-up"!==l&&"one-side-down"!==l&&"single-slash"!==l||w.mat3.multiply(c,[1,0,0,0,-1,0,0,0,1],c)}w.mat3.multiply(c,o,c),w.mat3.multiply(c,i,c),t.update({stroke:r.color,d:this.stencil.path,"stroke-width":e.stroke.width,"stroke-linecap":this.stencil["stroke-linecap"]||"butt",fill:this.stencil.fill||r.color,matrix:c}),t.dataset({test_id:("tip"===n?e.target.marker:e.source.marker)||"none"})}}},{key:"destroy",value:function(){this.group.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var Gu=aa,Xu=Ra,Vu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){var e=this.cell.diagram.defs,t=new Xu({id:this.cell.clipPathID}),n=new Gu({"clip-rule":"evenodd","fill-rule":"evenodd"});n.update({fill:"black",opacity:.1}),t.add(n),e.add(t),this.lineTextClipPath=n,this.clipPath=t}},{key:"draw",value:function(){var e=this.cell,t=this.lineTextClipPath,n=e.textarea,r=n.box,a=r.width,i=r.height,o=n.getPosition(),c=o.x,l=o.y,s=e.getBBox(),u=s.x,d=s.y,f=s.width,h=s.height;r.width>0?t.update({d:un(u-15,d-15,f+30,h+30)+un(c,l,a,i)}):t.update({d:un(u-15,d-15,f+30,h+30)})}},{key:"destroy",value:function(){this.lineTextClipPath.destroy(),this.clipPath.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var Wu=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"group",new Zr),c()(E()(r),"element",void 0),c()(E()(r),"cell",void 0),r.cell=e,r}return v()(n,[{key:"render",value:function(){var e=vu({name:"path"});this.element=e,this.group.add(this.element),this.cell.graphicGroup.add(this.group)}},{key:"update",value:function(){}},{key:"draw",value:function(){if("center"!==this.cell.textDirection){this.group.show();var e=this.cell.getPointByPercent(this.cell.textPosition);this.element.update({d:en(e.x,e.y,this.cell.stroke.width),fill:this.cell.stroke.color})}else this.group.hide()}},{key:"destroy",value:function(){var e;null===(e=this.group)||void 0===e||e.remove()}}]),n}();function Zu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zu(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ku(e){return e.reduce((function(e,t){return Array.isArray(t)?[].concat(D()(e),D()(Ku(t))):[].concat(D()(e),[t])}),[])}function Qu(e){for(var t=[],n=1;n<e+1;n++)t.push(n);return t}function Ju(e,t,n){n=n||Qu(t);for(var r,a,i,o={},c=0;c<e.length;c++){for(a=r=e[c],i=1;!n.includes(a)&&i<100;)i%2==1?(a+=i)>t&&(a%=t):(a-=i)<1&&(a=t+a%t),i++;o[r]=a}return o}var $u=function(e){var t=e.abstract,n=e.start,r=void 0===n?0:n,a=e.parent,i=e.direction;if(t&&a){var o=a.children,c=void 0===o?[]:o;if("timeline"===a.layout){var l=c[r].quadrantConstraint,s=(void 0===l?[]:l)[0],u=i[1];switch(s){case 1:case 2:return 0!==u&&(e.quadrantConstraint=[u>0?1:2]),{direction:[0,1],layout:"timeline"};case 3:case 4:return 0!==u&&(e.quadrantConstraint=[u>0?2:1]),{direction:[0,-1],layout:"timeline"};default:return}}if("indent"===a.layout){var d=a,f=d.directions,h=void 0===f?[]:f,p=d.layout,m=void 0===p?"":p,y=e.mergedQuadrant,v=void 0===y?0:y;return{direction:[Math.sign(h[v-1][0]),0],layout:m}}}},ed=function(){function e(t){m()(this,e),c()(this,"algorithms",void 0),c()(this,"model",void 0),c()(this,"options",void 0),c()(this,"tree",void 0),c()(this,"trees",void 0),c()(this,"destroyed",void 0),c()(this,"beforeLayoutAdjust",void 0),c()(this,"afterLayoutAdjust",void 0),Object.assign(this,Uu({algorithms:{},model:{}},t))}return v()(e,[{key:"buildTree",value:function(){var e=this.model,t=this.parse(e);t.x=void 0!==e.x?e.x:0,t.y=void 0!==e.y?e.y:0,t.layout=t.layout||"standard",this.tree=t}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.algorithms,a=Uu(Uu({w:10,h:10,quadrant:void 0,quadrantConstraint:void 0,direction:[1,0],collapsed:!1,layout:void 0},e),{},{origin:e,depth:n,children:[],parent:t,isAbstractUnderTimeline:!1,ax:0,ay:0,al:0,ad:"x",ap:1,quadrantTreeLists:[]});if(a.quadrant?a.quadrant=Number(a.quadrant):a.quadrant=1,e.children&&!e.collapsed)for(var i=0;i<e.children.length;i++){var o=e.children[i];a.children.push(this.parse.call(this,o,a,n+1))}return a.layout&&(a.algorithm=r[a.layout],this.calculateDQ(a)),a}},{key:"calculateDQ",value:function(e){e.quadrants=e.algorithm.constructor.QUADRANTS,e.directionAngles=function(e,t){for(var n=[],r=2*Math.PI/t,a=bo(e,[1,0]),i=0;i<t;i++){var o=a+r*i;o=o>=2*Math.PI?o-2*Math.PI:o,n.push(o)}return n}(e.direction,e.quadrants),e.directions=e.directionAngles.map((function(e){return[Number(Math.cos(e).toFixed(3)),Number(Math.sin(e).toFixed(3))]})),e.quadrantRange=Qu(e.quadrants),e.childQuadrantRange=yt(e.children.map((function(e){return e.quadrant}))),e.quadrantConstraint=e.quadrantConstraint||e.quadrantRange}},{key:"splitSubTrees",value:function(){var e=this.tree,t=[e];it(e,(function(e){e.layout&&(e.isSubTree=!0,e.x=0,e.y=0,e.tx=0,e.ty=0,t.unshift(e))})),this.trees=t}},{key:"firstMergeQuadrant",value:function(){var e=this;this.trees.forEach((function(t){e.mergeQuadrant(t,"mergedQuadrant")}))}},{key:"mergeQuadrant",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mergedQuadrant",r=e.quadrantConstraint,a=e.quadrants,i=Ju(e.childQuadrantRange,a,r);null===(t=e.children)||void 0===t||t.forEach((function(e){e[n]=i[e.quadrant]}))}},{key:"fixQuadrantConflict",value:function(){var e=this;this.trees.concat([]).reverse().forEach((function(t){if(t.parent){for(var n=t.quadrants,r=function(e){if(e.parent){var t=e,n=t.parent;if(e.abstract){var r=$u(e);if(r)return r}for(;n&&!n.layout;)t=n,n=n.parent;var a=n,i=a.directions,o=void 0===i?[]:i,c=a.layout,l=void 0===c?"":c;return{direction:o[t.mergedQuadrant-1],layout:l}}}(t),a=[],i=0,o=function(){var n=t.quadrantRange,o=t.directions,c=void 0===o?[]:o;if(a=n.filter((function(e,t){return Pi(c[t],r.direction)})),0===a.length){var l=t.algorithm.constructor.VAILD_DIRECTION_ANGLES,s=bo(r.direction,[1,0]);if(!l.some((function(e){return Ji(e,s)})))return 1;e.forceUseUpDirection(t,r.direction)}i++};0===a.length&&i<10&&!o(););if(t.upDirection=r.direction,t.upLayoutType=r.layout,a.length>0){var c=Ju(t.quadrantConstraint,n,a);t.quadrantConstraint=Object.keys(c).map((function(e){return c[e]})),e.mergeQuadrant(t,"mergedQuadrant")}else delete t.layout,t.isSubTree=!1}}))}},{key:"forceUseUpDirection",value:function(e,t){e.direction=t,this.calculateDQ(e)}},{key:"filterSimilarSubTree",value:function(){this.trees.forEach((function(e){if(!e.parent)return!0;var t=e.quadrantConstraint,n=void 0===t?[]:t,r=e.upDirection,a=e.upLayoutType,i=e.directions,o=void 0===i?[]:i,c=e.layout;!e.abstract&&a===c&&1===n.length&&$i(r,o[n[0]-1])&&(e.isSubTree=!1)}))}},{key:"removeSubTree",value:function(){this.trees=this.trees.filter((function(e){var t=e.isSubTree;return!e.parent||t}))}},{key:"setUpAndDown",value:function(){var e=this,t=this.trees,n=this.tree;n.upDirection=n.directions[n.quadrantConstraint[0]-1],n.upLayoutType=n.layout,n.upSignX=Math.sign(n.upDirection[0]),n.upSignY=Math.sign(n.upDirection[1]),t.forEach((function(t){var n=e.splitTreeByQuadrant(t);(n=n.filter((function(e){return e.children&&e.children.length>0}))).forEach((function(t){e.setUp(t)})),t.quadrantTrees=n})),this.setDown(n)}},{key:"splitTreeByQuadrant",value:function(e){for(var t=e.quadrants,n=void 0===t?0:t,r=e.directionAngles,a=void 0===r?[]:r,i=e.directions,o=void 0===i?[]:i,c=e.children,l=void 0===c?[]:c,s=[],u=0;u<n;u++){var d=Uu(Uu({},e),{},{directionAngle:a[u],quadrantTreeDirection:o[u],children:[]});s.push(d),e.quadrantTreeLists.push([])}return l.forEach((function(t,n){var r;null===(r=s[t.mergedQuadrant-1].children)||void 0===r||r.push(t),t.abstract||e.quadrantTreeLists[t.mergedQuadrant-1].push(n)})),s.forEach((function(t){t.quadrantTreeLists=e.quadrantTreeLists})),s}},{key:"setUp",value:function(e){var t;null===(t=e.children)||void 0===t||t.forEach((function(t){at(t,(function(t){t.upDirection=e.quadrantTreeDirection;var n=t.abstract,r=t.parent;if(n&&r){var a=$u(t);a&&(t.upDirection=a.direction)}t.upLayoutType=e.layout,t.upSignX=Math.sign(t.upDirection[0]),t.upSignY=Math.sign(t.upDirection[1])}),(function(e){if(!e.isSubTree)return e.children}))}))}},{key:"setDown",value:function(e){at(e,(function(e){e.isSubTree?(e.downDirection=e.directions[e.quadrantConstraint[0]-1],e.downLayoutType=e.layout):(e.downDirection=e.upDirection,e.downLayoutType=e.upLayoutType),e.downSignX=Math.sign(e.downDirection[0]),e.downSignY=Math.sign(e.downDirection[1])}))}},{key:"layout",value:function(){var e=this,t=this.trees,n=this.tree;t.forEach((function(t){var n=t.algorithm,r=t.quadrantTrees,a=[];(void 0===r?[]:r).forEach((function(e){n.layout(e,a)})),e.calculateSubTreeBBox(t),a.push(t),t.zNodes=a})),n.zNodes=Ku(n.zNodes)}},{key:"calculateSubTreeBBox",value:function(e){if(e.collapsed)return e.tx=e.x,e.ty=e.y,e.tw=e.w,void(e.th=e.h);var t=e.x,n=e.x+e.w,r=e.y,a=e.y+e.h;it(e,(function(e){var i,o,c,l;e.isSubTree?(i=e.tx,o=e.ty,c=e.tx+e.tw,l=e.ty+e.th):(i=e.x,o=e.y,c=e.x+e.w,l=e.y+e.h),i<t&&(t=i),o<r&&(r=o),c>n&&(n=c),l>a&&(a=l)}),(function(t){if(!t.isSubTree||t===e)return t.children})),e.tx=t,e.ty=r,e.tw=n-t,e.th=a-r}},{key:"execute",value:function(){return this.buildTree(),this.splitSubTrees(),this.firstMergeQuadrant(),this.fixQuadrantConflict(),this.filterSimilarSubTree(),this.removeSubTree(),this.setUpAndDown(),this.beforeLayoutAdjust&&this.beforeLayoutAdjust(this.tree),this.layout(),this.afterLayoutAdjust&&this.afterLayoutAdjust(this.tree),this.tree}},{key:"destroy",value:function(){var e=this;this.destroyed=!0,Object.keys(this).forEach((function(t){e[t]=void 0}))}}]),e}(),td=Object.freeze({__proto__:null,Event:fl,Layout:ed,Comparator:jo});var nd=function(e){S()(n,_.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),e=t.call(this),Object.assign(E()(e),r);var a=E()(e),i=a.group,o=a.cell,c=["source","target"].map((function(e){return Ri(e)}));return c.forEach((function(e){return i.add(e.group)})),e.buttons=c,e.diagram=o.diagram,e.eventHelper=new fl,e.cellModel=null,e}return v()(n,[{key:"update",value:function(){var e=this.buttons,t=this.cell,n=this.diagram,r=this.group;if(r&&r.parent){var a=b()(e,2),i=a[0],o=a[1],c=t.getPoints(),l=c[0],s=c[c.length-1],u=1/n.viewport.zoom;i.group.update({scale:u,x:l.x,y:l.y}),o.group.update({scale:u,x:s.x,y:s.y})}}},{key:"bindEvent",value:function(){var e,t,n,r,a=this,i=this.buttons,o=this.cell,l=this.diagram,u=this.eventHelper,d=!0,f=function(){l.resetCursor(),e=void 0,t=void 0,n=void 0,r=void 0,d=!0,l.lineResizer.reset()};i.forEach((function(n){var i=n.name,c=n.group;u.bind(c,"mousedown",(function(){l.lineAlign.init(a.cell,i),e=i,t=te()({connection:null,id:null},Et(o.model[e],{connection:!0,id:!0})),r=s()(o.controlPoints),l.emit("endpointcontrolpointmousedown"),l.lineResizer.init(a.cell,i)}))})),u.bind(l,"mousemove",(function(t){if("source"===e||"target"===e){d&&(d=!1,l.emit("endpointcontrolpointmousemovestart"));var i="source"===e?o.target:o.source,s=l.viewport.invertClient([t.clientX,t.clientY]);n=l.lineResizer.resize(t),i.id&&n.id===i.id&&null==i.connection&&null==n.connection&&r.length>0&&(n.id=null,n.connection=s),l.update(o,c()({},e,n)),a.update()}})),u.bind(l,"mouseup",(function(){var i,s,u;"source"!==e&&"target"!==e||("elbow"===o.shape?l.command.execute("Update",{id:o.model.id,model:(i={},c()(i,e,n),c()(i,"controlPoints",Mi(o,!0)),i),originModels:(s={},c()(s,e,t),c()(s,"controlPoints",r),s)}):l.command.execute("Update",{id:o.model.id,model:c()({},e,n),originModels:(u={},c()(u,e,t),c()(u,"controlPoints",r),u)}),a.emit("endpointControlMouseup"),f())})),u.bind(l,"keydown",(function(n){var r=a.cell,i=a.diagram;!e||"Esc"!==n.key&&"Escape"!==n.key||(i.update(r,c()({},e,t)),a.update(),f())})),u.bind(l,"afterviewportchange",pe()((function(){var e=a.buttons,t=a.cell;e&&t&&a.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null}}]),n}();var rd=function(e){S()(n,_.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),e=t.call(this),Object.assign(E()(e),r);var a=E()(e).cell;return e.diagram=a.diagram,e.eventHelper=new fl,e.onMove=!1,e}return v()(n,[{key:"_refresh",value:function(){var e=this.group,t=this.cell,n=Bi(t);e&&e.clear();var r=t.controlPoints.map((function(e,t){return ji(t,!1)})),a=n.map((function(e,t){return ji(t,!0)}));a.forEach((function(t){return e.add(t.group)})),r.forEach((function(t){return e.add(t.group)})),this.buttons=r,this.uiButtons=a,this.uiPoints=n}},{key:"update",value:function(){var e=this.cell;this._refresh();var t=this.buttons,n=this.diagram,r=this.group,a=this.uiButtons,i=this.uiPoints;if(r.parent)if(e.isLoop&&0===e.controlPoints.length)r.css({display:"none"});else{this.onMove?r.css({display:"none"}):r.css({display:""});var o=1/n.viewport.zoom;t.forEach((function(t){var n=t.group,r=t.index,a=e.getControlPointButtonPosition(r);n.update({scale:o,x:a[0],y:a[1]})})),a.forEach((function(e){var t=e.group,n=e.index;t.update({scale:o,x:i[n][0],y:i[n][1]})}))}}},{key:"bindEvent",value:function(){var e,t,n,r,a=this,i=this.cell,o=this.diagram,c=this.eventHelper,l=this.group,u=!1,d={},f=!0,h=!1,p=function(){o.resetCursor(),e=void 0,t=void 0,n=void 0,u=!1,a.onMove=!1,r=void 0,d={},f=!0,h=!1};c.bind(o,"mousedown",(function(r){if("true"===(d=r.target&&r.target.dataset).isUIPoints&&"false"===d.isControlPoint){var c=Number(d.index);t=c,n={controlPoints:s()(i.controlPoints)},u=!0,h=!0}if("false"===d.isUIPoints&&"true"===d.isControlPoint){var l=Number(d.index);e=l,n={controlPoints:s()(i.controlPoints)},u=!1,a.afterMove=!1,h=!0}o.emit("endpointcontrolpointmousedown")})),c.bind(o,"mousemove",(function(n){if(h&&f&&(o.emit("endpointcontrolpointmousemovestart"),f=!1),d!=={}&&"true"===d.isUIPoints&&"false"===d.isControlPoint&&u){var r=Number(d.index);t=r;var c=Li({cell:i,uiPoints:a.uiPoints,uiPointIndex:t});o.update(i,{controlPoints:c}),e=r,u=!1}if(void 0!==e){var l=o.viewport.invertClient([n.clientX,n.clientY]),p=s()(i.controlPoints),m=p[[e]];void 0!==m&&(m[0]=l[0],m[1]=l[1]),o.update(i,{controlPoints:p}),a.onMove=!0}})),c.bind(o,"mouseup",(function(){if(void 0!==e)if(a.onMove){var c=s()(i.controlPoints);o.command.execute("Update",{id:i.model.id,model:{controlPoints:c},originModels:n,diagram:o}),l.css({display:""}),p()}else r=e,e=void 0;else void 0!==t&&p()})),c.bind(o,"dblclick",(function(){if(void 0!==r&&void 0===t){var e=s()(i.controlPoints);o.update(i,n),e.splice(r,1),o.command.execute("Update",{id:i.model.id,model:{controlPoints:e},diagram:o}),p()}})),c.bind(o,"keydown",(function(t){var r=a.cell,i=a.diagram;!e||"Esc"!==t.key&&"Escape"!==t.key||(i.update(r,n),a.update(),p())})),c.bind(o,"afterviewportchange",pe()((function(){var e=a.buttons,t=a.cell;e&&t&&a.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null,this.uiButtons=null,this.uiPoints=null}}]),n}();var ad=function(e){S()(n,_.a);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),e=t.call(this),c()(E()(e),"lastPoints",void 0),Object.assign(E()(e),r);var a=E()(e).cell;return e.diagram=a.diagram,e.eventHelper=new fl,e.onMove=!1,e.mergeSig=!1,e}return v()(n,[{key:"_refresh",value:function(){var e=this.group,t=this.cell,n=Bi(t,this.mergeSig);e&&e.clear();var r=n.map((function(e,r){return 0===t.controlPoints.length||0===r||r===n.length-1?ji(r,!0,!0,e):ji(r,!1,!0,e)}));r.forEach((function(t){return e.add(t.group)})),this.uiButtons=r,this.uiPoints=n}},{key:"update",value:function(){var e=this.cell;xe()(this.lastPoints,e.getPoints())||(this._refresh(),this.lastPoints=e.getPoints());var t=this.diagram,n=this.group,r=this.uiButtons,a=this.uiPoints;if(n.parent){this.onMove?n.css({display:"none"}):n.css({display:""});var i=e.getPoints(),o=i[0],c=i[i.length-1],l=1/t.viewport.zoom;r.forEach((function(e){var t=e.group,n=e.index;0===n?ro(o.x,o.y,a[n][0],a[n][1])<8.5&&t.css({display:"none"}):n===r.length-1&&ro(c.x,c.y,a[n][0],a[n][1])<8.5&&t.css({display:"none"}),t.update({scale:l,x:a[n][0],y:a[n][1]})}))}}},{key:"bindEvent",value:function(){var e,t,n,r,a=this,i=this.cell,o=this.diagram,c=this.eventHelper,l=this.group,u=!1,d={},f=!0,h=!1,p=function(){o.resetCursor(),e=void 0,t=void 0,n=void 0,u=!1,a.onMove=!1,d={},a.mergeSig=!1,r=void 0,f=!0,h=!1};c.bind(o,"mousedown",(function(c){if(d=c.target&&c.target.dataset,r=[c.clientX,c.clientY],"true"===d.isUIPoints&&"false"===d.isControlPoint){var l=Number(d.index);t=l,n={controlPoints:0===i.controlPoints.length?null:s()(i.controlPoints)},u=!0,h=!0,t=void 0,o.setCursor(0===a.uiPoints[l][2]?"row-resize":"col-resize")}if("false"===d.isUIPoints&&"true"===d.isControlPoint){var f=Number(d.index);e=0===f?0:f===a.uiPoints.length-1?i.controlPoints.length-1:f-1,n={controlPoints:s()(i.model.controlPoints)},u=!1,h=!0;var p=a.uiPoints[f];p&&o.setCursor("V"===p[p.length-1]?"row-resize":"col-resize")}o.emit("endpointcontrolpointmousedown")})),c.bind(o,"mousemove",(function(n){if(h&&f&&(o.emit("endpointcontrolpointmousemovestart"),f=!1),d!=={}&&"true"===d.isUIPoints&&"false"===d.isControlPoint&&u){var r=Number(d.index);t=r;var c=Li({cell:i,uiPoints:a.uiPoints,uiPointIndex:t});o.update(i,{controlPoints:c}),e=0===r?0:r===a.uiPoints.length-1?i.controlPoints.length-1:r-1,u=!1,a.mergeSig=!0}if(void 0!==e){a.onMove=!0;var l=o.viewport.invertClient([n.clientX,n.clientY]),p=s()(i.controlPoints),m=p[e];void 0!==m&&("V"===m[m.length-1]?m[1]=l[1]:m[0]=l[0]),o.update(i,{controlPoints:p})}})),c.bind(o,"dblclick",(function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.dataset;"false"===n.isUIPoints&&"true"===n.isControlPoint&&1===i.controlPoints.length&&(o.command.execute("Update",{id:i.model.id,model:{controlPoints:[]}}),p())})),c.bind(o,"mouseup",(function(t){if(void 0!==e&&ro(r[0],r[1],t.clientX,t.clientY)>4){var a=Mi(i,!0);o.command.execute("Update",{id:i.model.id,model:{controlPoints:a},originModels:n,diagram:o}),l.css({display:""}),p()}else p()})),c.bind(o,"keydown",(function(t){var r=a.cell,i=a.diagram;!e||"Esc"!==t.key&&"Escape"!==t.key||(i.update(r,n),a.update(),p())})),c.bind(o,"afterviewportchange",pe()((function(){var e=a.uiButtons,t=a.cell;e&&t&&a.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null,this.uiButtons=null,this.uiPoints=null}}]),n}(),id=function(){function e(t){m()(this,e),this.cell=t,c()(this,"eventHelper",new fl),c()(this,"subResizers",void 0),c()(this,"lineControlPointResizer",void 0),c()(this,"lineEndpointResize",void 0),c()(this,"group",void 0),c()(this,"diagram",void 0),c()(this,"isBegin",void 0),this._init(t)}return v()(e,[{key:"update",value:function(){this.subResizers.forEach((function(e){return e.update()}))}},{key:"bindEvent",value:function(){var e=this,t=this.eventHelper,n=this.cell,r=n.diagram;t.bind(r,"endpointcontrolpointmousedown",(function(){"elbow"===n.shape&&(e.lineControlPointResizer.mergeSig=!0)})),t.bind(r,"endpointcontrolpointmousemovestart",(function(){e.group.hide()})),t.bind(r,"mouseup",(function(){"elbow"===n.shape&&(e.lineControlPointResizer.mergeSig=!1),e.group.show()}))}},{key:"begin",value:function(){var e=this.subResizers;this.diagram.frontRootGroup.add(this.group),e.forEach((function(e){return e.begin()})),this.isBegin=!0}},{key:"end",value:function(){var e=this.subResizers,t=this.group;e.forEach((function(e){return e.end()})),t&&t.remove(),this.isBegin=!1}},{key:"destroy",value:function(){this.group.remove(),this.subResizers.forEach((function(e){return e.destroy()})),this.isBegin=!1,this.eventHelper.destroy()}},{key:"renew",value:function(e){this.destroy(),this._init(e),this.begin()}},{key:"_init",value:function(e){var t=new Zr,n=[],r=new Zr,a=new nd({group:r,cell:e});t.add(r),n.push(a);var i,o=new Zr;i="elbow"===e.shape?new ad({group:o,cell:e}):new rd({group:o,cell:e}),t.add(o),n.push(i),this.cell=e,this.diagram=e.diagram,this.subResizers=n,this.group=t,this.lineEndpointResize=a,this.lineControlPointResizer=i,this.bindEvent()}},{key:"getElbowMergeSig",value:function(){return this.lineControlPointResizer.mergeSig}}]),e}();var od=function(e){S()(n,Bu);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"getPath",value:function(){var e=this.line,t=e.getPoints(),n=e.tipOffset,r=e.tailOffset,a=t[t.length-1],i=t[t.length-2],o=io(i.x,i.y,a.x,a.y,n),c=t[0],l=t[1],s=[io(l.x,l.y,c.x,c.y,r)];return 0===e.controlPoints.length?s.push(o):s=s.concat(e.controlPoints.map((function(e){var t=b()(e,2);return{x:t[0],y:t[1]}})).filter((function(e){return!isNaN(e.x)})),o),sn(s)}}]),n}();function cd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ld(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sd={"stroke-linejoin":"round"},ud=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"element",void 0),c()(E()(e),"hitElement",void 0),e}return v()(n,[{key:"createRendererElement",value:function(){var e=this.cell,t=e.graphicGroup;if(!this.element||e.isCacheStale("shape","roughFillStyle")){var n=e.getRoughGraphicOptions(),r=new(n?Va:aa)(ld(ld({"clip-path":"url(#".concat(e.clipPathID,")")},n),sd)),a=new aa(sd);r.capture(!1),t.prepend(r),this.element&&this.element.remove(),this.hitElement&&this.hitElement.remove(),this.element=r,this.hitElement=a,e.wireElement=r,!a.parent&&t.insertAfter(a,r)}}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=this.hitElement,r=e.d,a=e.stroke,i={d:r};t.update(ld(ld({stroke:a.color,"stroke-width":a.width,fill:"none"},e.convertStrokeStyle()),i)),n.update({stroke:"rgba(255,255,255,0)","stroke-width":a.width+8,fill:"none",d:i.d})}},{key:"destroy",value:function(){var e,t;null===(e=this.element)||void 0===e||e.destroy(),null===(t=this.hitElement)||void 0===t||t.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function dd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var fd=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"clipPathID",Object(F.a)()),c()(E()(r),"tailOffset",0),c()(E()(r),"tipOffset",0),c()(E()(r),"shape",void 0),c()(E()(r),"shapes",void 0),c()(E()(r),"resizer",void 0),c()(E()(r),"textareaElement",void 0),c()(E()(r),"wireElement",void 0),c()(E()(r),"target",void 0),c()(E()(r),"source",void 0),c()(E()(r),"textPosition",void 0),c()(E()(r),"textDirection",void 0),c()(E()(r),"isLoop",void 0),c()(E()(r),"sourceCell",void 0),c()(E()(r),"targetCell",void 0),c()(E()(r),"controlPoints",void 0),c()(E()(r),"d",void 0),r}return v()(n,[{key:"init",value:function(e){var t=this;I()(L()(n.prototype),"init",this).call(this,e),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.subcells.unshift(new Hu(this,"tail")),this.subcells.unshift(new Hu(this,"tip")),this.subcells.push(new Vu(this)),this.shapes={straight:new od(this),curve:new Du(this),elbow:new zu(this)},this.render(),this.resizer=new id(this)}},{key:"canRough",value:function(){return!0}},{key:"canTextVerticalAlign",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){var t=this.getShapeObj().getTextareaPosition(),n=this.getPercentPointSlope(this.textPosition),r=t.x-e.width/2,a=t.y-e.height/2;return"left"===this.textDirection?n>=0&&n<=15?a=t.y-e.height-5:15<n&&n<=75?(r=t.x+5,a=t.y-e.height-5):75<=n&&n<=105?r=t.x+5:105<n&&n<165?(r=t.x+5,a=t.y+5):165<=n&&n<=195?a=t.y+5:195<n&&n<=255?(r=t.x-5-e.width,a=t.y+5):255<=n&&n<=285?r=t.x-5-e.width:285<n&&n<345?(r=t.x-5-e.width,a=t.y-e.height-5):345<=n&&n<=360&&(a=t.y-e.height-5):"right"===this.textDirection&&(n>=0&&n<=15?a=t.y+5:15<n&&n<=75?(r=t.x-5-e.width,a=t.y+5):75<=n&&n<=105?r=t.x-5-e.width:105<n&&n<165?(r=t.x-5-e.width,a=t.y-e.height-5):165<=n&&n<=195?a=t.y-e.height-5:195<n&&n<=255?(r=t.x+5,a=t.y-e.height-5):255<=n&&n<=285?r=t.x+5:285<n&&n<345?(r=t.x+5,a=t.y+5):345<=n&&n<=360&&(a=t.y+5)),{x:r,y:a}}},{key:"getKeyShape",value:function(){return this.wireElement}},{key:"isConnected",value:function(){return this.target.id||this.source.id}},{key:"getPointBox",value:function(){var e=1/0,t=1/0,n=-1/0,r=-1/0;return this.getPoints().forEach((function(a){e=Math.min(e,a.x),t=Math.min(t,a.y),n=Math.max(n,a.x),r=Math.max(r,a.y)})),{x:e,y:t,width:n-e,height:r-t,minX:e,minY:t,maxX:n,maxY:r}}},{key:"getKeyShapeBox",value:function(){var e=this.getKeyShape().getBBox(),t=e.x,n=e.y;return{x:t,y:n,width:e.width,height:e.height,minX:t,minY:n,maxX:t+e.width,maxY:n+e.height}}},{key:"canArrange",value:function(){var e=this;return["source","target"].every((function(t){var n=e[t];return!n.id&&Array.isArray(n.connection)}))}},{key:"isDrawable",value:function(){var e=this.diagram,t=this.target,n=this.source,r=e.find(n.id),a=n.id&&!r||r&&!1===r.state.visible,i=e.find(t.id),o=t.id&&!i||i&&!1===i.state.visible;return!(a||o)}},{key:"updateTextareaStyleSheets",value:function(){var e=this.textareaContentStyleSheets.find((function(e){return"self"===e.query}));this.diagram.contentEditor.isBegin&&this.diagram.contentEditor.dom===this.textareaElement.htmlContainer?(e.css["min-width"]="12px",e.css["min-height"]="24px"):(e.css["min-width"]=0,e.css["min-height"]=0)}},{key:"shouldRefreshEndEditContent",value:function(){return this.isContentEmpty()}},{key:"canFill",value:function(){return!1}},{key:"beginEditContent",value:function(){this.textareaElement.css({outline:"1px solid #096DD9"})}},{key:"endEditContent",value:function(){this.textareaElement.css({outline:"none"})}},{key:"getPointByPercent",value:function(e){var t=this.wireElement,n=t.getTotalLength();return t.getPointAtLength(e*n)}},{key:"getPercentPointSlope",value:function(e){var t=this.getTwoPointsByPercent(e),n=b()(t,2),r=n[0],a=n[1];return Ki(oo(r.x,r.y,a.x,a.y))}},{key:"getTwoPointsByPercent",value:function(e){var t=this.wireElement,n=t.getTotalLength(),r=n*e;return[t.getPointAtLength(ut(r-1,0,n)),t.getPointAtLength(ut(r+1,0,n))]}},{key:"getPadding",value:function(){return[0,0,0,0]}},{key:"getEndpoint",value:function(e){var t=this.diagram,n=e.id,r=e.connection,a=t.find(n);if(a)return r?a.getPoint(r):a.getPoint([.5,.5]);if(Array.isArray(r)){var i=b()(r,2);return{x:i[0],y:i[1]}}return r}},{key:"getAlignBBox",value:function(){var e=this.wireElement.rendererElement.getBBox();return{x:e.x,y:e.y,width:e.width,height:e.height,minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height}}},{key:"getBBox",value:function(){var e=this.graphicGroup.rendererElement.getBBox();return{x:e.x,y:e.y,width:e.width,height:e.height,minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height}}},{key:"getShapeObj",value:function(){var e=this.shape;return this.shapes[e]}},{key:"getFirstInsertControlPoints",value:function(){return this.getShapeObj().getFirstInsertControlPoints()}},{key:"getControlPointButtonPosition",value:function(e){return this.getShapeObj().getControlPointButtonPosition(e)}},{key:"getPath",value:function(){var e=this.shape,t=this.sourceCell,n=this.isLoop,r=this.getShapeObj();if(n&&0===this.controlPoints.length){var a=null==t?void 0:t.getPoint([1,.5]);return Jt([["M",a.x,a.y-8],["l",16,-4],["l",0,24],["L",a.x,a.y+8]])}if(r)return r.getPath();throw new Error("unsupported line shape ".concat(e))}},{key:"updatePath",value:function(){this.isCacheStale("shape","source","target","controlPoints")&&(this.d=this.getPath())}},{key:"render",value:function(){var e=this.model;this.subcells.forEach((function(e){return e.render()})),this.renderModel(e)}},{key:"renderModel",value:function(e){I()(L()(n.prototype),"updateModel",this).call(this,e),this.subcells.forEach((function(e){e.update()}))}},{key:"_updateResizer",value:function(){var e=this.diagram;this.resizer&&this.resizer.update(),1===e.selector.selections.length&&e.selector.selections[0]===this||this.resizer.end()}},{key:"updateModel",value:function(e){var t=!1;void 0!==e.shape&&e.shape!==this.shape&&(e.controlPoints=null,t=!0),I()(L()(n.prototype),"updateModel",this).call(this,e),t&&(this.updatePoints(),this.resizer&&this.resizer.renew(this)),this.subcells.forEach((function(e){e.update()}))}},{key:"draw",value:function(){if(this.isDrawable()){var e=this.source,t=this.target,n=this.diagram,r=n.find(e.id),a=n.find(t.id);this.isLoop=null!=r&&r===a,this.sourceCell=r,this.targetCell=a,this.show(),this.updatePoints(),this.updatePath(),this.subcells.forEach((function(e){return e.draw()})),this.drawPosition(),this.graphicGroup.attr({opacity:this.opacity}),this._updateResizer(),this.updateCache()}else this.hide()}},{key:"updatePoints",value:function(){this.getShapeObj().updatePoints()}},{key:"updateCache",value:function(){var e=this,t=this.cache;["shape","source","target","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t}),this.resizer.update()}}},{key:"getPoints",value:function(){return this.shapes[this.shape].getPoints()}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var e=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*e)}}return{"stroke-dasharray":"none"}}},{key:"destroy",value:function(){this.subcells.forEach((function(e){return e.destroy()})),this.resizer.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","font-family":'PingFangSC-Regular, "PingFang SC", sans-serif',"line-height":"1.74","word-break":"break-word","box-sizing":"border-box"}}],shape:"straight",stroke:{color:"#595959",width:2},textPosition:.5,textDirection:"center",html:'<div style="text-align: center;">'.concat(er,"</div>"),source:{},target:{},controlPoints:[],opacity:1,Subcells:[ud,Wu,nu],penetratedKeys:["source","target","stroke","fill","html","shape","controlPoints","opacity","textPosition","textDirection"],isLine:!0,isLoop:!1})}}]),n}();c()(fd,"className","LineCell"),c()(fd,"Shapes",{});var hd=function(e){S()(n,Au);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"textarea",void 0),e}return v()(n,[{key:"getTextareaPosition",value:function(e){var t=this.textareaRegion,n=this.textVerticalAlign,r={x:t.minX,y:0};return r.y="top"===n?t.minY:"bottom"===n?t.maxY-e.height:(t.minY+t.maxY-e.height)/2,r}},{key:"canRough",value:function(){return!0}},{key:"getRoughGraphicOptions",value:function(){}},{key:"_updateSize",value:function(){var e=this.subcells.find((function(e){return e instanceof nu})),t=this.getPadding();e.update();var n=e.getBBox();n&&(this.width="number"!=typeof this.model.width?n.width+t[1]+t[3]:this.width,this.height="number"!=typeof this.model.height?n.height+t[1]+t[3]:this.height)}},{key:"_updateTextareaRegion",value:function(){var e=this.width,t=this.height;this.textareaRegion={minX:4,minY:4,maxX:e-4,maxY:t-4}}},{key:"afterUpdateModel",value:function(){this._updateSize(),this._updateTextareaRegion(),I()(L()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape"))return vu({name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1})}},{key:"getOutlinePath",value:function(e){if(this.isCacheStale("width","height","shape")){var t=this.width/120,n=this.height/60;return e.getPath(t,n)}return null}},{key:"getPadding",value:function(){return[4,4,4,4]}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{fill:{color:"rgba(255,255,255,0)"},shape:"text",stroke:{width:1},isText:!0,Subcells:[nu],penetratedKeys:["textVerticalAlign"]})}}]),n}();c()(hd,"className","TextCell");var pd=new Map;pd.set(0,new Map([["tc",2],["rc",0],["bc",0],["lc",1],["tl",2],["tr",3],["br",0],["bl",1]]));var md=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"tolerance",5),c()(this,"lengthTolerance",10),c()(this,"bleed",10),c()(this,"toAlignPointSets",[]),c()(this,"toAlignLengths",[]),c()(this,"toAlignDistributes",[]),c()(this,"refLines",[]),c()(this,"widthLines",[]),c()(this,"heightLines",[]),c()(this,"distributeWLines",[]),c()(this,"distributeHLines",[]),c()(this,"showLine",!0),c()(this,"refLinesGroup",void 0),c()(this,"startBox",void 0),c()(this,"preventAlignX",!1),c()(this,"preventAlignY",!1),c()(this,"alignRst",{dx:0,dy:0}),this.diagram=t,this.refLinesGroup=new Zr,t.frontRootGroup.add(this.refLinesGroup)}return v()(e,[{key:"getPointsByBox",value:function(e){var t={x:e.maxX,y:e.minY,weight:0,box:e},n={x:e.minX,y:e.maxY,weight:0,box:e};return[{x:(e.minX+e.maxX)/2,y:(e.minY+e.maxY)/2,weight:1,box:e},t,n]}},{key:"getPointsByPoint",value:function(e){return[e]}},{key:"getPointsByCell",value:function(e){var t=e.getBBox();return this.getPointsByBox(t)}},{key:"drawRefLines",value:function(){var e=this.refLines,t=this.refLinesGroup,n=1/this.diagram.viewport.zoom;e.forEach((function(e){var r=e.x1,a=e.y1,i=e.x2,o=e.y2;t.add(new aa({d:"M".concat(r,",").concat(a," L").concat(i,",").concat(o),stroke:dr,"stroke-width":n}))}))}},{key:"drawDistributeLines",value:function(){var e=this.refLinesGroup,t=1/this.diagram.viewport.zoom,n=3/this.diagram.viewport.zoom,r=1.5/this.diagram.viewport.zoom;this.distributeWLines.forEach((function(a){var i=b()(a,5),o=i[0],c=i[1],l=i[2],s=i[3],u=i[4];o+=r,c-=r,l+=r,s-=r;var d=u-n,f=u+n;e.add(new aa({d:"M".concat(o,",").concat(u," L").concat(c,",").concat(u," M").concat(o,",").concat(d," L").concat(o,",").concat(f," M").concat(c,",").concat(d," L").concat(c,",").concat(f),stroke:dr,"stroke-width":t})),e.add(new aa({d:"M".concat(l,",").concat(u," L").concat(s,",").concat(u," M").concat(l,",").concat(d," L").concat(l,",").concat(f," M").concat(s,",").concat(d," L").concat(s,",").concat(f),stroke:dr,"stroke-width":t}))})),this.distributeHLines.forEach((function(a){var i=b()(a,5),o=i[0],c=i[1],l=i[2],s=i[3],u=i[4];o+=r,c-=r,l+=r,s-=r;var d=u-n,f=u+n;e.add(new aa({d:"M".concat(u,",").concat(o," L").concat(u,",").concat(c," M").concat(d,",").concat(o," L").concat(f,",").concat(o," M").concat(d,",").concat(c," L").concat(f,",").concat(c),stroke:dr,"stroke-width":t})),e.add(new aa({d:"M".concat(u,",").concat(l," L").concat(u,",").concat(s," M").concat(d,",").concat(l," L").concat(f,",").concat(l," M").concat(d,",").concat(s," L").concat(f,",").concat(s),stroke:dr,"stroke-width":t}))}))}},{key:"drawRefLengths",value:function(){var e=this.refLinesGroup,t=1/this.diagram.viewport.zoom,n=5/this.diagram.viewport.zoom,r=15/this.diagram.viewport.zoom;this.widthLines.forEach((function(a){var i=a.x1,o=a.y1,c=a.x2,l=a.y2;o-=r,l-=r,e.add(new aa({d:"M".concat(i,",").concat(o," L").concat(c,",").concat(l," M").concat(i,",").concat(o-n," L").concat(i,",").concat(o+n," M").concat(c,",").concat(l-n," L").concat(c,",").concat(l+n),stroke:dr,"stroke-width":t}))})),this.heightLines.forEach((function(a){var i=a.x1,o=a.y1,c=a.x2,l=a.y2;i-=r,c-=r,e.add(new aa({d:"M".concat(i,",").concat(o," L").concat(c,",").concat(l," M").concat(i-n,",").concat(o," L").concat(i+n,",").concat(o," M").concat(c-n,",").concat(l," L").concat(c+n,",").concat(l),stroke:dr,"stroke-width":t}))}))}},{key:"prepareForDistribute",value:function(e){var t=this.diagram,n=t.viewport.getViewportCanvasBox(),r=Tn(e),a=t.groupManager.getCells().filter((function(t){if(!t.isStem||xn(t)||e.includes(t))return!1;var a=t.getBBox();return!eo(a,r)&&to(a,n)}));this.toAlignDistributes=a.map((function(e){return e.getBBox()}))}},{key:"prepareForLength",value:function(e){this.startBox=e.getBBox();var t=this.diagram,n=t.viewport.getViewportCanvasBox(),r=t.groupManager.getCells().filter((function(t){return!(!t.isStem||xn(t)||t===e)&&to(t.getBBox(),n)}));this.toAlignLengths=r.map((function(e){return e.getBBox()}))}},{key:"updateToAlignPointSet",value:function(e){this.toAlignPointSets=e}},{key:"updateToAlginPoints",value:function(e){var t=this,n=[];Array.isArray(e)?n=e:e&&(n=[e]);var r=this.diagram,a=r.paper,i=r.viewport.getViewportCanvasBox(),o=r.groupManager.getCells().filter((function(e){if("line"===e.model.type)return!1;for(var t=0;t<n.length;t++){var r=n[t];if(e.stem===r.stem)return!1}return to(e.getBBox(),i)})),c=[];if(o.forEach((function(e){c.push(t.getPointsByCell(e))})),a.visible){var l=a.getBBox();c.push(this.getPointsByBox({minX:l.left,minY:l.top,maxX:l.right,maxY:l.bottom}))}this.toAlignPointSets=c}},{key:"alignDistribute",value:function(e){var t=this,n=5/this.diagram.viewport.zoom,r={dx:0,dy:0};if(0===this.toAlignDistributes.length)return r;var a=[],i=[];this.toAlignDistributes.forEach((function(n){t.isIntersectVericallly(n,e)&&a.push(n),t.isIntersectHorizontally(n,e)&&i.push(n)}));var o=1/0,c=1/0,l=1/0,s=1/0,u=(e.minX+e.maxX)/2,d=(e.minY+e.maxY)/2;if(this.distributeWLines=[],this.distributeHLines=[],0===this.alignRst.dx)for(var f=0;f<a.length;f++)for(var h=f+1;h<a.length;h++){var p=a[f],m=a[h],y=m,v=p;if(p.maxX<m.minX&&(y=p,v=m),this.horizontalDistance(p,m)>this.regionWidth(e)&&this.isIntersectVericallly(p,m)){var g=(y.maxX+v.minX)/2;if((c=Math.abs(u-g))<=n&&c<o){o=c,r.dx=g-u,this.distributeWLines=[[y.maxX,e.minX+r.dx,e.maxX+r.dx,v.minX,0]];var b=[y.minY,y.maxY,v.minY,v.maxY];b.sort((function(e,t){return e-t}));var x=(b[1]+b[2])/2;this.distributeWLines[0][4]=x}}}if(0===this.alignRst.dy)for(var k=0;k<i.length;k++)for(var w=k+1;w<i.length;w++){var C=i[k],A=i[w],O=A,E=C;if(C.minY<A.minY&&(O=C,E=A),this.verticalDistance(C,A)>this.regionHeight(e)&&this.isIntersectHorizontally(C,A)){var P=(O.maxY+E.minY)/2;if((s=Math.abs(d-P))<=n&&s<l){l=s,r.dy=P-d,this.distributeHLines=[[O.maxY,e.minY+r.dy,e.maxY+r.dy,E.minY,0]];var S=[O.minX,O.maxX,E.minX,E.maxX];S.sort((function(e,t){return e-t}));var j=(S[1]+S[2])/2;this.distributeHLines[0][4]=j}}}return this.draw(),r}},{key:"regionWidth",value:function(e){return e.maxX-e.minX}},{key:"regionHeight",value:function(e){return e.maxY-e.minY}},{key:"isIntersectVericallly",value:function(e,t){return!(e.maxY<t.minY||e.minY>t.maxY)}},{key:"isIntersectHorizontally",value:function(e,t){return!(e.maxX<t.minX||e.minX>t.maxX)}},{key:"horizontalDistance",value:function(e,t){return Math.min(Math.abs(e.minX-t.maxX),Math.abs(e.maxX-t.minX))}},{key:"verticalDistance",value:function(e,t){return Math.min(Math.abs(e.minY-t.maxY),Math.abs(e.maxY-t.minY))}},{key:"alignByLength",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===Ui(e.r)){var a,i,o=this.diagram,c=this.toAlignLengths,l=this.lengthTolerance/o.viewport.zoom;this.widthLines=[],this.heightLines=[];var s=1/0,u=1/0;c.forEach((function(t){var r=Math.abs(t.width-e.w),o=Math.abs(t.height-e.h);n.preventAlignX||r<=l&&(Ji(r,s)?n.widthLines.push({x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y}):r<s&&(s=r,a=t.width,n.widthLines=[{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y}])),n.preventAlignY||o<=l&&(Ji(o,u)?n.heightLines.push({x1:t.x,y1:t.y,x2:t.x,y2:t.y+t.height}):o<u&&(u=o,i=t.height,n.heightLines=[{x1:t.x,y1:t.y,x2:t.x,y2:t.y+t.height}]))})),this.adjustRect(e,a,i,t,r),this.addItselfRefLengths(e),this.draw()}}},{key:"addItselfRefLengths",value:function(e){var t=In(e);this.widthLines.length>0&&!this.preventAlignX&&this.widthLines.push({x1:t.minX,y1:t.minY,x2:t.maxX,y2:t.minY}),this.heightLines.length>0&&!this.preventAlignY&&this.heightLines.push({x1:t.minX,y1:t.minY,x2:t.minX,y2:t.maxY})}},{key:"adjustRect",value:function(e,t,n,r,a){var i,o=this.startBox;t=t||e.w,n=n||e.h,a&&(n=e.h*t/e.w);var c=In(e);switch(null===(i=pd.get(e.r))||void 0===i?void 0:i.get(r)){case 0:Ji(c.minX,o.minX)||(e.x=o.minX-t),Ji(c.minY,o.minY)||(e.y=o.minY-n);break;case 1:Ji(c.maxX,o.maxX)&&(e.x=o.maxX-t),Ji(c.minY,o.minY)||(e.y=o.minY-n);break;case 2:Ji(c.maxX,o.maxX)&&(e.x=o.maxX-t),Ji(c.maxY,o.maxY)&&(e.y=o.maxY-n);break;case 3:Ji(c.minX,o.minX)||(e.x=o.minX-t),Ji(c.maxY,o.maxY)&&(e.y=o.maxY-n)}e.w=t,e.h=n}},{key:"alignByPoint",value:function(e){return this.align("Point",e)}},{key:"alignByBox",value:function(e){return this.align("Box",e)}},{key:"align",value:function(e,t){var n,r=this,a=this.bleed,i=this.showLine,o=this.toAlignPointSets,c=this.diagram,l=this.preventAlignX,s=this.preventAlignY,u={dx:0,dy:0},d=this.tolerance/c.viewport.zoom;if(0===o.length)return u;"Point"===e?(n=this.getPointsByPoint(t))[1]=n[2]=n[0]:n=this.getPointsByBox(t);var f=[];return this.refLines=[],n.forEach((function(e,t){o.forEach((function(n){if(0===t)f.push(r.computeDis(e,n[0]));else for(var a=1;a<n.length;++a)f.push(r.computeDis(e,n[a]))}))})),l||(f.sort((function(e,t){return e.hDis-t.hDis})),[f[0]].forEach((function(e){e.hDis<d&&(u.dx=e.dx,r.refLines.push({x1:e.to.x,x2:e.to.x,y1:Math.min(e.to.box.minY,e.from.box.minY)-a,y2:Math.max(e.to.box.maxY,e.from.box.maxY)+a}))}))),s||(f.sort((function(e,t){return e.vDis-t.vDis})),[f[0]].forEach((function(e){e.vDis<d&&(u.dy=e.dy,r.refLines.push({x1:Math.min(e.to.box.minX,e.from.box.minX)-a,x2:Math.max(e.to.box.maxX,e.from.box.maxX)+a,y1:e.to.y,y2:e.to.y}))}))),i&&this.draw(),this.alignRst=u,u}},{key:"computeDis",value:function(e,t){var n=t.x-e.x,r=t.y-e.y;return{from:e,to:t,weight:e.weight+t.weight,dx:n,dy:r,hDis:Math.abs(n),vDis:Math.abs(r)}}},{key:"draw",value:function(){this.refLinesGroup.clear(),this.drawRefLengths(),this.drawDistributeLines(),0===this.widthLines.length&&0===this.heightLines.length&&this.drawRefLines()}},{key:"clear",value:function(){this.refLines=[],this.widthLines=[],this.heightLines=[],this.distributeWLines=[],this.distributeHLines=[],this.toAlignPointSets=[],this.refLinesGroup.clear()}},{key:"reset",value:function(){this.alignRst={dx:0,dy:0},this.clear(),this.preventAlignX=!1,this.preventAlignY=!1}},{key:"destroy",value:function(){}}]),e}();function yd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(md,"className","Align");var gd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"startTime",void 0),c()(this,"tmpTargetCell",void 0),c()(this,"lastTmpTargetCell",void 0),c()(this,"sourceCell",void 0),c()(this,"targetCell",void 0),c()(this,"group",new Zr),c()(this,"anchors",void 0),c()(this,"cacheDockCell",void 0),c()(this,"cachePath",new Map),c()(this,"getInnerConnection",(function(e,t){var n=t.canvas2percentage({x:e[0],y:e[1]});return{id:t.model.id,connection:n}})),t.frontRootGroup.prepend(this.group),this.anchors=[]}return v()(e,[{key:"getConnectableCells",value:function(e){return this.diagram.getCellsByZIndex().filter((function(t){var n,r,a,i;return t.canConnect()&&(!e||(r=e,!(eo(a=t.getBBox(),i=r.getBBox())||eo(i,a))))&&(null==e||null===(n=e.model)||void 0===n?void 0:n.id)!==t.model.id}))}},{key:"isPointInPath",value:function(e,t){return Array.isArray(e)&&(e={x:e[0],y:e[1]}),Ln(t)?t.isPointInFill(e):t.isPointInFill(e)&&!t.isPointInStroke(e)}},{key:"init",value:function(e,t){var n=e[t],r=e.getEndpoint(n),a="source"===t?e.target:e.source;if(this.sourceCell=this.diagram.find(a.id),!this.targetCell)for(var i=this.getConnectableCells(this.sourceCell),o=i.length-1;o>=0;o--){var c=i[o];if(this.isPointInPath(r,c))return void(this.targetCell=c)}}},{key:"isPointNearCell",value:function(e,t){t=Di(t);var n=e.canvas2Relative(t),r=e.width,a=e.height,i=8;return Dn(e)&&(i=24),!(n.x<-i||n.x>r+i||n.y<-i||n.y>a+i)}},{key:"findEndPoint",value:function(e){for(var t,n=this.getConnectableCells(this.sourceCell),r=n.length-1;r>=0;r--){var a=n[r];if(this.isPointNearCell(a,e)){this.dock(a);var i=this.getConnection(a,e);if(i){if(this.lastTmpTargetCell=this.tmpTargetCell,this.tmpTargetCell=a,i===a){t={id:a.model.id,connection:null};break}t={id:a.model.id,connection:i};break}}}if(this.cacheDockCell&&!this.isPointNearCell(this.cacheDockCell,e)&&this.clearDock(),!t&&this.tmpTargetCell&&(this.tmpTargetCell=void 0,this.startTime=void 0),this.tmpTargetCell&&this.tmpTargetCell!==this.targetCell&&(this.targetCell=void 0),this.targetCell){if(this.isPointInPath(e,this.targetCell))return this.getInnerConnection(e,this.targetCell);this.startTime=void 0,this.targetCell=void 0}return this.tmpTargetCell&&this.lastTmpTargetCell===this.tmpTargetCell&&this.isPointInPath(e,this.tmpTargetCell)&&(this.startTime||(this.startTime=Date.now()),Date.now()-this.startTime>=1500)?(this.targetCell=this.tmpTargetCell,this.tmpTargetCell=void 0,this.startTime=void 0,this.getInnerConnection(e,this.targetCell)):t||{id:null,connection:e}}},{key:"getCellConnectStateElement",value:function(e){if(Dn(e)){var t;if(this.cachePath.has(e.model.id))t=this.cachePath.get(e.model.id);else{var n=e.getKeyShapeBox();t=new aa({d:un(n.x,n.y,n.width,n.height),stroke:xr,fill:"transparent","stroke-width":2}),this.cachePath.set(e.model.id,t)}return t}var r=new aa({"stroke-width":1,stroke:xr,fill:kr});r.dataset({testid:"connect_dock_line"});var a=e.getKeyShape(),i=D()(e.matrix),o=a.attr("d");return r.update({matrix:i,d:o}),r}},{key:"dock",value:function(e){var t,n=this;if(this.cacheDockCell!==e){this.clearDock(),this.cacheDockCell=e,this.group.add(this.getCellConnectStateElement(e));var r,a=1/this.diagram.viewport.zoom;r=null!==(t=e.stencil)&&void 0!==t&&t.antiAnchors?e.stencil.antiAnchors:e.anchors;var i=0;En(e)||(i=e.rotate/360*2*Math.PI),r.forEach((function(t){var r,o=n.createAnchor(t.name);n.group.add(o.group);var c,l,s=e.percentage2Canvas(t);!1===(null===(r=e.stencil)||void 0===r?void 0:r.closed)||e.isPointInStroke(s)||Dn(e)?(c=s,l=[t.x,t.y]):(c=e.getIntersectionPoint(s),l=e.canvas2percentage(c)),o.group.update(vd(vd({},c),{},{scale:a,rotate:i})),n.anchors.push({x:l[0],y:l[1],shape:o.shape})}))}}},{key:"clearDock",value:function(){this.cacheDockCell=void 0,this.group.clear(),this.anchors=[]}},{key:"getConnection",value:function(e,t){for(var n=e.canvas2Relative({x:t[0],y:t[1]}),r=n.x,a=n.y,i=e.width,o=e.height,c=[r,a],l=Dn(e)?24:8,s=0;s<this.anchors.length;s++){var u=this.anchors[s],d=[u.x*i,u.y*o];if(ro(c[0],c[1],d[0],d[1])<=l)return[ut(u.x,0,1),ut(u.y,0,1)]}var f,h=e.getKeyShape();if(Dn(e)){if(f=Gi(this.cachePath.get(e.model.id),t,8)){var p=e.canvas2percentage(f);return[ut(p[0],0,1),ut(p[1],0,1)]}}else if(f=Gi(h,[r,a],8))return[ut(f[0]/i,0,1),ut(f[1]/o,0,1)];var m=Ii({x:r,y:a});if(Ln(e)){if(e.isPointInFill(Di(t)))return e}else if(Dn(e)){if(h.isPointInFill(Ii({x:t[0],y:t[1]})))return e}else if(h.isPointInFill(m))return e}},{key:"createAnchor",value:function(e){var t=new Jr,n=new aa({d:en(0,0,3),stroke:xr,fill:"white"});return t.add(n),{group:t,shape:n,name:e}}},{key:"reset",value:function(){this.clearDock(),this.cachePath.clear(),this.tmpTargetCell=void 0,this.startTime=void 0,this.sourceCell=void 0}},{key:"destroy",value:function(){}}]),e}();c()(gd,"className","Connect");var bd=new xa;bd.css({fontFamily:"system-ui"});var xd=function(){function e(t){m()(this,e),this.diagram=t,this.diagram.canvas.calculateCanvas.appendChild(bd.rendererElement)}return v()(e,[{key:"measureTextLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fontSize:"12px"};return bd.update({text:e}),bd.css({fontSize:t.fontSize}),bd.getBBox().width}},{key:"destroy",value:function(){}}]),e}();c()(xd,"className","Font");var kd=function(){function e(t){m()(this,e),this.diagram=t,this.group=null}return v()(e,[{key:"getStemsByZIndex",value:function(){var e,t=this.diagram,n=this.group;return(e=n?n.getChildren():t.getCells().filter((function(e){return e.isRoot}))).sort((function(e,t){return e.getZIndex()-t.getZIndex()})),e}},{key:"_getGroupCells",value:function(e){var t=[];return e.deepEachWithoutSelf((function(e){if(e.isGroup)return t.push(e),!1;t.push(e)})),t}},{key:"getCells",value:function(){var e=this.diagram,t=this.group;return t?this._getGroupCells(t):e.getCells().filter((function(e){return e.isRoot})).reduce((function(e,t){return t.isStem&&!t.isGroup?t.deepEach((function(t){e.push(t)})):e.push(t),e}),[])}},{key:"enter",value:function(e,t){this.group&&this.exit();var n,r=this.diagram,a=r.getCells(),i=e.getChildren();return i.forEach((function(e){if(e.isStem&&!e.isGroup)e.deepEach((function(e){if(e.isPointInShape(t))return n=e,!1}));else if(e.isPointInShape(t))return n=e,!1})),n?(a.forEach((function(e){i.includes(e.stem)?e.capture(!0):e.capture(!1)})),e.state.actived=!0,this.group=e,r.emit("afteractivedgroupchange"),n):null}},{key:"exit",value:function(){var e=this.group,t=this.diagram;if(e){for(var n=t.getCells(),r=e;r;)r.isGroup&&r.show(),r=r.parent;n.forEach((function(e){return e.capture(!0)})),e.state.actived=!1}this.group=null,t.emit("afteractivedgroupchange")}},{key:"destroy",value:function(){this.destroyed=!0,this.group=null}}]),e}();c()(kd,"className","GroupManager");var wd=function(e,t,n){var r,a,i,o=new Yt(t);if(void 0!==e.width||void 0!==e.height)r=o.tl,e=Object.assign({},{x:t.x,y:t.y,width:t.w,height:t.h},e),a=[e.width/t.w,e.height/t.h],i=function(e){return[(e[0]-r.x)*a[0]+r.x,(e[1]-r.y)*a[1]+r.y]};else if(void 0!==e.x||void 0!==e.y){var c=o.tl,l=[(e=Object.assign({},{x:t.x,y:t.y,width:t.w,height:t.h},e)).x-c.x,e.y-c.y];a=[1,1],i=function(e){return[e[0]+l[0],e[1]+l[1]]}}return n.map((function(e){var t=e.type;if("line"===t||"points"===t)return{type:t,points:e.points.map((function(e){return i(e)}))};var n=i([e.x,e.y]),r=b()(n,2);return{x:r[0],y:r[1],w:e.w*a[0],h:e.h*a[1],r:e.r,type:t}}))};function Cd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ad(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Od={lake_prevent_click_unselect:!0,group_resize_controller:!0},Ed=function e(t){var n=t.type;if("group"===n){var r=[],a=[],i=[];return t.getChildren().forEach((function(t){var n=e(t);Array.isArray(n)?(r.push.apply(r,D()(n[0])),a.push.apply(a,D()(n[1])),i.push.apply(i,D()(n[2]))):(r.push(n.cell),a.push(n.data),i.push(n.originModel))})),[r,a,i]}if("line"===n){var o={},c=t,l=c.source,u=c.target,d=c.controlPoints,f=[];return!l.id&&l.connection&&(f.push(l.connection),o.source=s()(l)),f.push.apply(f,D()(d)),o.controlPoints=d,!u.id&&u.connection&&(f.push(u.connection),o.target=s()(u)),{cell:t,data:{type:"line",points:f},originModel:o}}if(Dn(t)){var h=s()(t.points);return{cell:t,data:{type:"points",points:h},originModel:{points:h}}}return{cell:t,data:{type:n,x:t.x,y:t.y,w:t.width,h:t.height,r:t.rotate},originModel:{x:t.x,y:t.y,width:t.width,height:t.height,rotate:t.rotate}}},Pd=function(e,t,n){return e.map((function(e,r){if("line"===e.type){var a=e.points,i=t[r],o={};return i.source.id||(o.source={},o.source.connection=a.shift()),i.target.id||(o.target={},o.target.connection=a.pop()),o.controlPoints=D()(a),"elbow"===i.shape&&o.controlPoints.forEach((function(e,t){e.push(i.controlPoints[t][2])})),o}if("points"===e.type)return{points:e.points};var c={x:e.x,y:e.y,width:e.w,height:e.h,rotate:e.r};return"stack"===e.type&&delete c.height,"lc"===n||"rc"===n?c.height=void 0:"tc"!==n&&"bc"!==n||(c.width=void 0),c}))},Sd=function(){function e(t){m()(this,e);var n=new Zr,r=oi("tc",Od),a=oi("bc",Od),i=oi("lc",Od),o=oi("rc",Od),c=ii("tl",Od),l=ii("tr",Od),s=ii("bl",Od),u=ii("br",Od),d=ci("rotate");n.on("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.add(r.group),n.add(a.group),n.add(i.group),n.add(o.group),n.add(c.group),n.add(l.group),n.add(s.group),n.add(u.group),n.add(d.group),this.diagram=t,this.group=n,this.tl=c,this.tr=l,this.bl=s,this.br=u,this.tc=r,this.bc=a,this.lc=i,this.rc=o,this.rotateBtn=d,this.eventHelper=new fl}return v()(e,[{key:"init",value:function(e){var t=this.tl,n=this.tr,r=this.bl,a=this.br,i=this.rotateBtn;Array.isArray(e)?(this.cells=e,t.group.css({display:"none"}),n.group.css({display:"none"}),r.group.css({display:"none"}),a.group.css({display:"none"}),i.group.css({display:"none"})):(this.groupCell=e,t.group.css({display:"initial"}),n.group.css({display:"initial"}),r.group.css({display:"initial"}),a.group.css({display:"initial"}),i.group.css({display:"initial"}))}},{key:"update",value:function(){var e,t,n,r,a,i=this.groupCell,o=this.tl,c=this.tr,l=this.bl,s=this.br,u=this.tc,d=this.bc,f=this.lc,h=this.rc,p=this.diagram,m=this.rotateBtn,y=this.cells,v=1/p.viewport.zoom,g=v,b=8*v;if(y){var x=Tn(y.reduce((function(e,t){return t.isAbstract?e.concat(t.abstractCoveredCellsWithAllChildren,t):e.concat(t)}),[]),(function(e){return En(e)?e.getKeyShapeBox():xn(e)?e.getPointBox():e.getBBox()})),k=x.minX,w=x.minY,C=x.maxX,A=x.maxY;e={x:k,y:w},t={x:C,y:w},n={x:k,y:A},r={x:C,y:A}}else{if(!i)return;e=i.percentage2Canvas({x:0,y:0}),t=i.percentage2Canvas({x:1,y:0}),n=i.percentage2Canvas({x:0,y:1}),r=i.percentage2Canvas({x:1,y:1});var O=14*v;a=i.relative2Canvas({x:-O,y:i.height+O})}o.group.update(Ad(Ad({},e),{},{scale:v,rotate:0})),c.group.update(Ad(Ad({},t),{},{scale:v,rotate:0})),l.group.update(Ad(Ad({},n),{},{scale:v,rotate:0})),s.group.update(Ad(Ad({},r),{},{scale:v,rotate:0})),m.group.update(Ad(Ad({},a),{},{scale:v,rotate:0})),u.shape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(t.x,",").concat(t.y),"stroke-width":b}),d.shape.update({d:"M".concat(n.x,",").concat(n.y," L").concat(r.x,",").concat(r.y),"stroke-width":b}),f.shape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(n.x,",").concat(n.y),"stroke-width":b}),h.shape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(r.x,",").concat(r.y),"stroke-width":b}),u.visShape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(t.x,",").concat(t.y),"stroke-width":g}),d.visShape.update({d:"M".concat(n.x,",").concat(n.y," L").concat(r.x,",").concat(r.y),"stroke-width":g}),f.visShape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(n.x,",").concat(n.y),"stroke-width":g}),h.visShape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(r.x,",").concat(r.y),"stroke-width":g})}},{key:"bindEvent",value:function(){var e,t,n,r,a,i,o,c,l,u,d=this,f=this.groupCell,h=this.tl,p=this.tr,m=this.bl,y=this.br,v=this.tc,g=this.bc,x=this.lc,k=this.rc,C=this.eventHelper,A=this.rotateBtn,O=f.diagram,E=O.viewport.zoom,P=-1;[h,p,m,y,v,g,x,k,A].forEach((function(o){var c=o.shape,l=o.name;C.bind(c,"mousedown",(function(o){u=O.viewport.invertClient([o.clientX,o.clientY]),O.contentEditor.unbind(),e=l,t={x:f.x,y:f.y,w:f.width,h:f.height,r:0};var c=Ed(f),s=b()(c,3);r=s[0],n=s[1],a=s[2];for(var d=0;d<n.length;d++)if("line"!==n[d].type||n[d].points[0]){P=d;break}i=n[P]}))})),C.bind(O,"mousemove",(function(a){if(e){var i,h=O.viewport.invertClient([a.clientX,a.clientY]);if("rotate"===e){var p=function(e,t,n,r){var a=_t(n),i=zt(a,e,t),o=Ui(n.r+i);o=Math.ceil(o);for(var c=[-180,-90,0,90,180],l=0;l<c.length;l++){var s=c[l];if(Ji(o,s,4)){o=s;break}}return{newChildrenRect:r.map((function(e){if("line"===e.type||"points"===e.type)return{type:e.type,points:e.points.map((function(e){var t=[];return w.vec2.rotate(t,[e[0]-a.x,e[1]-a.y],[0,0],Qi(o)),t[0]+=a.x,t[1]+=a.y,t}))};var t=Ao(a,o,[e]),n=b()(t,1)[0];return{x:n.x,y:n.y,w:e.w,h:e.h,r:n.r}})),groupRotate:o}}({x:u[0],y:u[1]},{x:h[0],y:h[1]},t,n);i=p.newChildrenRect,O.emit("cellrotate",{cell:f,rotate:p.groupRotate})}else{var m=!1;["tl","tr","bl","br"].includes(e)&&(m=!0),i=function(e,t,n,r,a){var i,o,c,l=new Yt(n),s=e,u=[];if(a){switch(t){case"tl":case"br":u=[l.tl,l.br];break;case"tr":case"bl":u=[l.tr,l.bl];break;case"tc":case"bc":u=[l.tc,l.bc];break;case"lc":case"rc":u=[l.lc,l.rc];break;default:u=[]}2===u.length&&(s=qt(u,e))}switch(t){case"tl":o=l.tl,i=l.br,c=[o.x-s.x,o.y-s.y];break;case"tr":o=l.tr,i=l.bl,c=[s.x-o.x,o.y-s.y];break;case"bl":o=l.bl,i=l.tr,c=[o.x-s.x,s.y-o.y];break;case"br":o=l.br,i=l.tl,c=[s.x-o.x,s.y-o.y];break;case"rc":o=l.rc,i=l.lc,c=[s.x-o.x,0];break;case"lc":o=l.lc,i=l.rc,c=[o.x-s.x,0];break;case"bc":o=l.bc,i=l.tc,c=[0,s.y-o.y];break;case"tc":o=l.tc,i=l.bc,c=[0,o.y-s.y]}var d=[1+c[0]/n.w,1+c[1]/n.h];d[0]<0&&(d[0]=.01),d[1]<0&&(d[1]=.01);var f=function(e){return[(e[0]-i.x)*d[0]+i.x,(e[1]-i.y)*d[1]+i.y]};return{newChildrenRect:r.map((function(e){var t=e.type;if("line"===t||"points"===t)return{type:t,points:e.points.map((function(e){return f(e)}))};var n=f([e.x,e.y]),r=b()(n,2);return{x:r[0],y:r[1],w:e.w*d[0],h:e.h*d[1],r:e.r,type:t}}))}}({x:h[0],y:h[1]},e,t,n,m).newChildrenRect}o=s()(i[P]),c=Pd(i,r,e),O.update(r,c),"rotate"===e?d.hide():d.update(),O.emit("groupresizestart")}else if(a.target.dataset.group_resize_controller){var y;if("line"===a.target.dataset.type){var v=ln(a.target.getAttribute("d"));y=fi([v[1][1]-v[0][1],v[1][2]-v[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}else y=hi(O.viewport.invertClient([a.clientX,a.clientY]),f.getBBox());l||(l=!0),O.setCursor(y)}else l&&(O.resetCursor(),l=void 0)})),C.bind(O,"mouseup",(function(){var s=d.groupCell;O.resetCursor();var u=!1;if(o&&i&&P>=0)if("line"===i.type||"points"===i.type){var f=i.points[0],h=o.points[0];f[0]===h[0]&&f[1]===h[1]||(u=!0)}else o.x===i.x&&o.y===i.y&&o.w===i.w&&o.h===i.h&&o.r===i.r||(u=!0);u&&O.command.execute("Update",{id:r.map((function(e){return e.model.id})),model:c,originModels:a,select:function(){O.selector.select([s.model.id])}}),e=void 0,t=void 0,n=void 0,r=void 0,a=void 0,o=void 0,i=void 0,c=void 0,l=void 0})),C.bind(O,"afterviewportchange",pe()((function(){E!==O.viewport.zoom&&(d.update(),E=O.viewport.zoom)})))}},{key:"begin",value:function(){this.diagram.frontRootGroup.add(this.group),this.update(),this.show(),this.cells||this.bindEvent()}},{key:"end",value:function(){this.group&&this.group.remove(),this.groupCell=void 0,this.cells=void 0,this.eventHelper.unbind()}},{key:"show",value:function(){this.group.css({display:"initial"})}},{key:"hide",value:function(){this.group.css({display:"none"})}},{key:"destroy",value:function(){this.diagram&&this.diagram.resetCursor(),this.eventHelper.unbind(),this.group&&this.group.remove()}}]),e}();c()(Sd,"className","GroupRotateResize");var jd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new Zr),c()(this,"eventHelper",new fl),c()(this,"arr",[]),c()(this,"destroyed",!1),(new Zr).css({"pointer-events":"none"})}return v()(e,[{key:"bind",value:function(){var e=this,t=this.diagram,n=this.eventHelper;n.unbind(),n.bind(t,"afterchange",(function(t){var n=t.action;e.arr.length>0&&("update"===n||"delete"===n)&&e.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(e){var t=this.diagram.viewport.zoom;e=e.filter((function(e){return e.state.visible})),this.render(e,(function(){return{shapeStyle:{fill:"none",stroke:wr,"stroke-width":1/t}}}))}},{key:"render",value:function(e,t){var n=this.group,r=this.diagram;this.clear(),e&&!e.some((function(e){return!e||!e.isCell}))&&(r.frontRootGroup.add(n),this.bind(),this.arr=e.map((function(e){var r=t(e),a=r.type,i=r.shapeStyle,o={cell:e,type:"function"==typeof a?a(e):a,shape:i&&new aa(i)};return o.shape&&n.add(o.shape),o})),this.draw())}},{key:"updateShape",value:function(e){var t,n=e.cell,r=e.shape,a=[1,0,0,0,1,0,0,0,1];if(xn(n)){var i=n.getPointBox();t=un(i.x,i.y,i.width,i.height)}else if(Ln(n)||Bn(n)){var o=n.getKeyShapeBox();t=un(o.x,o.y,o.width,o.height)}else if(On(n)){var c=n.percentage2Canvas({x:0,y:0}),l=n.percentage2Canvas({x:1,y:0}),s=n.percentage2Canvas({x:0,y:1});t=sn([c,l,n.percentage2Canvas({x:1,y:1}),s,c])+"z"}else En(n)&&(t=n.borderElement.attr("d"),a=D()(n.matrix));r.update({matrix:a,d:t,"stroke-width":1})}},{key:"_draw",value:function(){var e=this;this.arr.forEach((function(t){e.updateShape(t)}))}},{key:"draw",value:function(){this.arr.length>0&&this._draw()}},{key:"clear",value:function(){this.destroyed||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.diagram=void 0,this.group=void 0,this.arr=void 0,this.destroyed=!0}}]),e}();c()(jd,"className","Highlight");var Rd=function(){function e(t){m()(this,e),this.diagram=t,this.eventHelper=new fl,this.zoom=-1/0,this.arr=[],this.maxStashes={},this.bindEvent()}return v()(e,[{key:"bindEvent",value:function(){var e=this,t=this.diagram;this.eventHelper.bind(t,"afterviewportchange",ye()((function(){t.destroyed||e._update()}),100))}},{key:"setImageHref",value:function(e,t,n,r){this.arr.push({image:e,href:t,naturalWidth:n,naturalHeight:r}),this._setImageHref(e,t,n,r)}},{key:"_setImageHref",value:function(e,t,n,a){var i,o=this.diagram,c=this.maxStashes,l=o.viewport.zoom,s=Number(e.attr("width")),u=e.attr("href"),d=c[t],f=s*l;d&&d.clientWidth>f?i=d.href:(i=r.OssUtil.resizeImage({maxWidth:f,src:t,data:{width:f,originWidth:n,originHeight:a}})||t,c[t]={clientWidth:f,href:i}),u!==i&&e.update({href:i})}},{key:"_gc",value:function(){this.arr=this.arr.filter((function(e){return e&&!e.image.destroyed}))}},{key:"_refreshOssUrl",value:function(){var e=this,t=this.arr,n=this.diagram,r=this.zoom;n.viewport.zoom>r&&(t.forEach((function(t){var n=t.image,r=t.href,a=t.naturalWidth,i=t.naturalHeight;e._setImageHref(n,r,a,i)})),this.zoom=n.viewport.zoom)}},{key:"_update",value:function(){this._gc(),this._refreshOssUrl()}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.diagram=void 0,this.destroyed=!0}}]),e}();function Md(e,t,n){if(e&&!e.id){var r=e.connection;e.connection=[r[0]+t,r[1]+n]}}c()(Rd,"className","ImageManager");var Ld=function(e){S()(n,Ul);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).caches={},r}return v()(n,[{key:"clone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.diagram,r=function(e){var t=1/0,n=1/0,r=-1/0,a=-1/0;return e.forEach((function(e){var i,o,c,l;if("edge"===e.type){var s=[];e.source&&!e.source.id&&e.source.connection&&s.push(e.source.connection),e.target&&!e.target.id&&e.target.connection&&s.push(e.target.connection);var u=s.map((function(e){return e[0]})),d=s.map((function(e){return e[1]}));i=Math.min.apply(Math,D()(u)),o=Math.min.apply(Math,D()(d)),c=Math.max.apply(Math,D()(u)),l=Math.max.apply(Math,D()(d))}else i=e.x,o=e.y,c=e.x+(e.width||0),l=e.y+(e.height||0);i<t&&(t=i),o<n&&(n=o),c>r&&(r=c),l>a&&(a=l)})),{minX:t,minY:n,maxX:r,maxY:a}}(e);if(!to(r,n.viewport.viewportCanvasBox)){var a=n.viewport.getCenter(),i=a[0]-(r.minX+r.maxX)/2,o=a[1]-(r.minY+r.maxY)/2;e.forEach((function(e){!function(e,t,n){"edge"===e.type?(Md(e.source,t,n),Md(e.target,t,n)):(e.x=(e.x||0)+t,e.y=(e.y||0)+n)}(e,i,o)}))}return di(e,t),e}}]),n}(),Bd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"line",void 0),c()(this,"refLinesGroup",new Zr),c()(this,"fixedPoint",void 0),c()(this,"ns",void 0),c()(this,"we",void 0),c()(this,"nwse",void 0),c()(this,"nesw",void 0),c()(this,"_enable",!1),this.diagram.frontRootGroup.add(this.refLinesGroup)}return v()(e,[{key:"init",value:function(e,t){this.line=e;var n=e.getPoints();this.fixedPoint="source"===t?n[1]:n[n.length-2]}},{key:"align",value:function(e){if(e=Di(e),e=function(e,t){e=Di(e),t=Di(t);var n=e,r=n.x,a=n.y,i=t,o=i.x,c=i.y,l=no(r,a,o,c);return Math.abs(l)<.1&&Math.abs(c-a)<8?t.y=a:Math.abs(l)>10&&Math.abs(o-r)<8&&(t.x=r),t}(this.fixedPoint,e),!this._enable)return e;var t=this.createOneRefLine(e);if(t){this.refLinesGroup.clear(),this.refLinesGroup.add(t.path);var n=1/(this.diagram.viewport.zoom||1);t.path.update({"stroke-width":n});var r=t.start,a=t.end;return qt([{x:r[0],y:r[1]},{x:a[0],y:a[1]}],e)}return e}},{key:"createOneRefLine",value:function(e){var t=this.fixedPoint,n=t.x,r=t.y,a=5e4,i=Ki(oo(n,r,e.x,e.y));return(i=i>180?i-180:i)>=0&&i<22.5?{path:new aa({d:"M".concat(n-a,",").concat(r," L").concat(n+a,",").concat(r),stroke:dr}),start:[n-a,r],end:[n+a,r]}:i>=22.5&&i<67.5?{path:new aa({d:"M".concat(n-a,",").concat(r-a," L").concat(n+a,",").concat(r+a),stroke:dr}),start:[n-a,r-a],end:[n+a,r+a]}:67.5<=i&&i<112.5?{path:new aa({d:"M".concat(n,",").concat(r-a," L").concat(n,",").concat(r+a),stroke:dr}),start:[n,r-a],end:[n,r+a]}:112.5<=i&&i<157.5?{path:new aa({d:"M".concat(n+a,",").concat(r-a," L").concat(n-a,",").concat(r+a),stroke:dr}),start:[n+a,r-a],end:[n-a,r+a]}:157.5<=i&&i<=180?{path:new aa({d:"M".concat(n-a,",").concat(r," L").concat(n+a,",").concat(r),stroke:dr}),start:[n-a,r],end:[n+a,r]}:void 0}},{key:"reset",value:function(){this.refLinesGroup.clear()}},{key:"setEnable",value:function(e){this._enable=e}},{key:"destroy",value:function(){}}]),e}();c()(Bd,"className","LineAlign");var Dd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new Zr),c()(this,"highlightPath",void 0),t.frontRootGroup.add(this.group)}return v()(e,[{key:"align",value:function(e,t,n){e=Di(e),t=Di(t);var r,a,i=[0,0],o=0,c=!1;return 0===(null==n?void 0:n.rotate)&&(Ji(e.y,t.y,4)?(i=[t.x,e.y],c=!0,o=0):Ji(e.x,t.x,4)&&(i=[e.x,t.y],c=!0,o=1),c&&(Ji((r=function(e){return[ut(e[0],0,1),ut(e[1],0,1)]}(r=n.canvas2percentage(i)))[o],0,.1)?(r[o]=0,a=r):Ji(r[o],1,.1)&&(r[o]=1,a=r),a))?(this.highlight(e,i),a):(this.clearHighlight(),null)}},{key:"highlight",value:function(e,t){var n;this.highlightPath||(this.highlightPath=new aa({stroke:dr}),this.group.add(this.highlightPath)),e=Di(e),t=Di(t);var r,a,i=24/this.diagram.viewport.zoom;e.x===t.x?(r=e.y<t.y?e:t,a=e.y>=t.y?e:t,n="M".concat(r.x,",").concat(r.y-i," L").concat(a.x,",").concat(a.y+i)):(r=e.x<t.x?e:t,a=e.x>=t.x?e:t,n="M".concat(r.x-i,",").concat(r.y," L").concat(a.x+i,",").concat(a.y)),this.highlightPath.update({d:n})}},{key:"clearHighlight",value:function(){this.group.clear(),this.highlightPath=null}},{key:"reset",value:function(){this.clearHighlight()}},{key:"destroy",value:function(){}}]),e}();c()(Dd,"className","LineCellAlign");var Nd=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"line",void 0),c()(this,"name",void 0),c()(this,"basePoint",void 0),c()(this,"highlight",void 0),c()(this,"group",new Zr)}return v()(e,[{key:"init",value:function(e,t){this.line=e,this.name=t,this.diagram.lineAlign.init(e,t),this.diagram.connect.init(e,t),this.highlight=Ri(t,3),this.highlight.group.hide(),this.highlight.shape.update({stroke:xr,fill:xr}),this.diagram.frontRootGroup.add(this.highlight.group);var n=this.line.getPoints();"target"===this.name?this.basePoint=n[0]:this.basePoint=n[n.length-1]}},{key:"resize",value:function(e){if(!this.line)throw new Error("line not exist, must call prepareUpdate before updateEndPoint");var t,n=this.diagram,r=n.viewport.invertClient([e.clientX,e.clientY]),a=n.connect.findEndPoint(r);if(a.id){n.lineAlign.reset();var i=n.lineCellAlign.align(this.basePoint,r,n.find(a.id));i&&(a.connection=i),this.updateHighlight(a)}else if(!a.id&&a.connection){var o=n.lineAlign.align(r);a.connection=[(t=o).x,t.y],this.highlight.group.hide()}return a}},{key:"updateHighlight",value:function(e){if(this.line){var t,n=1/this.diagram.viewport.zoom,r=this.line.getPoints();t=e.id&&!e.connection?Di(r[r.length-1]):this.line.getEndpoint(e),this.highlight.group.show(),this.highlight.group.update({scale:n,x:t.x,y:t.y})}}},{key:"reset",value:function(){var e,t;null===(e=this.highlight)||void 0===e||null===(t=e.group)||void 0===t||t.remove(),this.diagram.lineAlign.reset(),this.diagram.connect.reset(),this.diagram.lineCellAlign.reset(),this.group.clear()}},{key:"destroy",value:function(){}}]),e}();c()(Nd,"className","LineResizer");var Id='<div style="text-align:center;">&nbsp;</div>',Td=["text","mindmap","geometry","stack","image","swimlane","dsl"],_d=function(e){return!!e.type&&Td.includes(e.type)},Fd=function(e){return!!e.type&&"freehand"===e.type},zd=function(e){return!!e.type&&"pen"===e.type};function qd(e,t,n){if(e.type){if(_d(e)){var r="number"==typeof e.x?e.x:0,a="number"==typeof e.y?e.y:0;return{x:r+t,y:a+n}}if(qo(e)){var i={};return e.target&&!e.target.id&&e.target.connection&&(i.target=s()(e.target),Array.isArray(i.target.connection)&&(i.target.connection[0]+=t,i.target.connection[1]+=n)),e.source&&!e.source.id&&e.source.connection&&(i.source=s()(e.source),Array.isArray(i.source.connection)&&(i.source.connection[0]+=t,i.source.connection[1]+=n)),i}if(Fd(e)){var o={};return o.points=e.points.map((function(e){return[e[0]+t,e[1]+n,e[2]]})),o}if(zd(e)){var c={};return c.points=e.points.map((function(e){return[e[0]+t,e[1]+n]})),c}}return{}}function Yd(e,t,n){return!!e.type&&(_d(e)?("number"==typeof e.x?e.x=e.x+t:e.x=t,"number"==typeof e.y?e.y=e.y+n:e.y=n):qo(e)?(e.target&&!e.target.id&&Array.isArray(e.target.connection)&&(e.target.connection[0]+=t,e.target.connection[1]+=n),e.source&&!e.source.id&&Array.isArray(e.source.connection)&&(e.source.connection[0]+=t,e.source.connection[1]+=n),e.controlPoints&&e.controlPoints.forEach((function(e){"number"==typeof e[0]&&(e[0]+=t),"number"==typeof e[1]&&(e[1]+=n)}))):Yo(e)&&e.points.forEach((function(e){e[0]+=t,e[1]+=n})),!0)}function Hd(e,t,n){return e.map((function(e){return qd(e,t,n)}))}function Gd(e,t,n){e.forEach((function(e){at(e,(function(e){return Yd(e,t,n)}))}))}function Xd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Vd=function(){function e(){m()(this,e),c()(this,"destroyed",void 0)}return v()(e,[{key:"bbox",value:function(e){return function(e){var t={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,width:10,height:10};return e.forEach((function(e){at(e,(function(n){var r=1/0,a=1/0,i=-1/0,o=-1/0;if(_d(n)){var c=n.width||50,l=n.height||50;r=n.x,a=n.y,i=n.x+c,o=n.y+l}else if(qo(e)){var s=[],u=[];e.target&&!e.target.id&&e.target.connection&&(s.push(e.target.connection[0]),u.push(e.target.connection[1])),e.source&&!e.source.id&&e.source.connection&&(s.push(e.source.connection[0]),u.push(e.source.connection[1])),e.controlPoints&&e.controlPoints.forEach((function(e){"number"==typeof e[0]&&s.push(e[0]),"number"==typeof e[1]&&u.push(e[1])})),r=Math.min.apply(Math,s),a=Math.min.apply(Math,u),i=Math.max.apply(Math,s),o=Math.max.apply(Math,u)}else if(Yo(e)){var d=[],f=[];e.points.forEach((function(e){d.push(e[0]),f.push(e[1])})),r=Math.min.apply(Math,d),a=Math.min.apply(Math,f),i=Math.max.apply(Math,d),o=Math.max.apply(Math,f)}r<t.minX&&(t.minX=r),a<t.minY&&(t.minY=a),i>t.maxX&&(t.maxX=i),o>t.maxY&&(t.maxY=o)}))})),t.width=t.maxX-t.minX,t.height=t.maxY-t.minY,t}(e)}},{key:"translate",value:function(e,t,n,r){r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({deep:!0,returnUpdateModels:!1},r);var a=r,i=a.deep,o=a.returnUpdateModels?[]:null,l=function(e,t,n){if(Yd(e,t,n),o){var r=qd(e,t,n);r&&o.push(r)}};return e.forEach((function(e){!0===i?at(e,(function(e){l(e,t,n)})):l(e,t,n)})),o}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();c()(Vd,"className","ModelManager");var Wd=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,r}return v()(n,[{key:"init",value:function(){if("read"!==this.diagram.interaction.currentMode){var e,t,n,r,a=this.diagram,i=!1,o=!1,c=!1,l="edit";this.bind(a,"dragstart",(function(l){var s=l.evt,d=l.button;e=s.clientX,t=s.clientY,n=a.viewport.scrollLeft,r=a.viewport.scrollTop,function(e){return!!(2===e||0===e&&c||"dragCanvas"===a.interaction.currentMode)}(d)&&(2===d&&(o=!0),i=!0,a.input.style.display="none","dragCanvas"!==a.interaction.currentMode&&u(),a.setCursor("grabbing"),a.selector.select([]))})),this.bind(a,"drag",pe()((function(i){var o=i.evt;if("dragCanvas"===a.interaction.currentMode){var c=n-(o.clientX-e),l=r-(o.clientY-t);a.viewport.setScroll(c,l)}}),16));var s=function(){o=!1};this.bind(a,"dragend",(function(){s(),!i||c||a.signal.buttonDragCanvas||(d(),a.tryFocus())})),this.bind(a,"mouseleave",(function(){s(),i&&!a.signal.buttonDragCanvas&&d()})),this.bind(a,"keydown",(function(e){" "===e.key&&(e.preventDefault(),c=!0,"dragCanvas"!==a.interaction.currentMode&&(a.highlight.clear(),a.selector.select([]),u()))})),this.bind(a,"keyup",(function(e){" "===e.key&&(c=!1,a.signal.buttonDragCanvas=!1,o||d())})),this.bind(window,"blur",d)}function u(){l=a.interaction.currentMode,a.interaction.changeMode("dragCanvas")}function d(){i=!1,c=!1,o=!1,a.input.style.display="","dragCanvas"===a.interaction.currentMode&&(a.interaction.changeMode(l),l="edit")}}},{key:"destroy",value:function(){this.unbind()}}]),n}();c()(Wd,"className","MouseDragCanvas");var Zd=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,r.init(),r}return v()(n,[{key:"init",value:function(){var e=this.diagram;this.bind(e,"keydown",(function(t){e.interaction.currentMode!==Er&&e.interaction.currentMode!==Or&&("v"!==t.key&&"Esc"!==t.key&&"Escape"!==t.key||e.interaction.changeMode(Or))}))}}]),n}();function Ud(e,t,n){var r=new Yt(n),a=qt([r.tl,r.tr],t),i=qt([r.tl,r.bl],t),o=qt([r.tr,r.br],t),c=qt([r.bl,r.br],t),l=ut(qt([i,o],e).x,0,n.w),s=ut(qt([a,c],e).y,0,n.h);return[Tt(i,{x:l,y:t.y})/n.w,Tt(a,{x:t.x,y:s})/n.h]}function Kd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kd(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Zd,"className","VBackToEdit");var Jd=function(){function e(t){m()(this,e),c()(this,"cell",void 0),c()(this,"diagram",void 0),c()(this,"controlPointsButtons",void 0),c()(this,"roundButton",void 0),c()(this,"group",void 0),c()(this,"eventHelper",void 0),c()(this,"shape",void 0),c()(this,"isMouseMove",void 0),this.diagram=t,this.group=new Zr,this.group.on("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),this.eventHelper=new fl}return v()(e,[{key:"init",value:function(e){this.cell=e,this.shape=this.cell.shape,this.prepareButtons()}},{key:"begin",value:function(){this.controlPointsButtons&&(this.isMouseMove=!1,this.diagram.frontRootGroup.add(this.group),this.update(),this.bindEvent())}},{key:"end",value:function(){this._clear(),this.eventHelper.unbind()}},{key:"_clear",value:function(){this.group&&this.group.clear()}},{key:"update",value:function(){var e=this;if(this.cell){this.shape!==this.cell.shape&&(this._clear(),this.eventHelper.unbind(),this.prepareButtons(),this.bindEvent(),this.shape=this.cell.shape);var t=1/(this.diagram.viewport.zoom||1),n=this.cell.rotate/360*2*Math.PI;if(this.controlPointsButtons.length>0&&this.cell.controlPoints.forEach((function(r,a){var i=e.cell.percentage2Canvas({x:ut(r[0],0,1),y:ut(r[1],0,1)});e.controlPointsButtons[a].group.update(Qd(Qd({},i),{},{scale:t,rotate:n}))})),this.roundButton){var r=ut(this.cell.round/this.cell.width,0,Math.min(this.cell.width,this.cell.height)/2/this.cell.width);this.isMouseMove||(this.cell.round<8&&(r=8/this.cell.width),this.cell.width<8?this.roundButton.group.hide():this.roundButton.group.show());var a=r,i=this.cell.percentage2Canvas({x:r,y:a});this.roundButton.group.update(Qd(Qd({},i),{},{scale:t,rotate:n}))}}}},{key:"destroy",value:function(){this.group.remove()}},{key:"hide",value:function(){this.group.hide()}},{key:"show",value:function(){this.group.show()}},{key:"prepareButtons",value:function(){this.createControlPointsButtons(),this.createRoundButton()}},{key:"bindEvent",value:function(){var e,t,n,r=this,a=!1;function i(){t=void 0,n=void 0}this.controlPointsButtons.forEach((function(o,c){var l=o.shape;r.eventHelper.bind(l,"mousedown",(function(){r.diagram.contentEditor.unbind(),a=!0,e=c,t={controlPoints:r.cell.controlPoints}})),r.eventHelper.bind(r.diagram,"mousemove",pe()((function(t){a&&(n=r.computeControlPoints(t,e),r.diagram.update(r.cell,{controlPoints:n}))}),16)),r.eventHelper.bind(r.diagram,"mouseup",(function(){a&&(a=!1,e=0,xe()(t.controlPoints,n)||(r.diagram.command.execute("Update",{id:r.cell,model:{controlPoints:n},originModels:[t]}),i()))}))})),this.roundButton&&(this.eventHelper.bind(this.roundButton.shape,"mousedown",(function(){r.diagram.contentEditor.unbind(),a=!0,t={round:r.cell.round}})),this.eventHelper.bind(this.diagram,"mousemove",pe()((function(e){a&&(r.isMouseMove=!0,n=r.computeRoundPoint(e),r.diagram.update(r.cell,{round:n}))}),16)),this.eventHelper.bind(this.diagram,"mouseup",(function(){a&&(r.isMouseMove=!1,r.update(),a=!1,xe()(t.round,n)||(r.diagram.command.execute("Update",{id:r.cell,model:{round:n},originModels:[t]}),i()))})))}},{key:"createRoundButton",value:function(){"number"==typeof this.cell.round?this.roundButton=this.createButton("round"):this.roundButton=void 0}},{key:"createControlPointsButtons",value:function(){var e=this;this.cell.controlPoints?this.controlPointsButtons=this.cell.controlPoints.map((function(){return e.createButton("control_point")})):this.controlPointsButtons=[]}},{key:"createButton",value:function(e){var t=new Jr,n=9*Math.sin(Math.PI/4),r=un(n/-2,n/-2,n,n,1.5),a=w.mat3.rotate([],[1,0,0,0,1,0,0,0,1],Math.PI/4),i=new aa({d:r,stroke:gr,"stroke-width":1,fill:br,matrix:a});return i.dataset({testid:e}),t.add(i),this.group.add(t),{group:t,shape:i}}},{key:"computeControlPoints",value:function(e,t){var n=this.diagram.viewport.invertClient([e.clientX,e.clientY]),r=this.cell.stencil.controlPointsConfig,a=this.cell.controlPoints,i=a[t],o=w.vec3.transformMat3([],w.vec3.clone([n[0],n[1],1]),w.mat3.invert([],this.cell.matrix)),c=b()(o,2),l=Ud({x:c[0],y:c[1]},{x:i[0]*this.cell.width,y:i[1]*this.cell.height},{x:0,y:0,w:this.cell.width,h:this.cell.height,r:0}),u=["x","y"].map((function(e,n){var o=[0,1],c=r[t][e].limit;return void 0===c?o=[0,1]:Array.isArray(c)?o=c.map((function(e){return"string"==typeof e?a[Number(e)][n]:e})):!0===c&&(o=[i[n],i[n]]),ut(l[n],o[0],o[1])})),d=s()(a);return d[t]=u,["x","y"].forEach((function(e,n){var a=r[t][e].proportional;if(a){var o=u[n]-i[n];a.forEach((function(e){d[Number(e)][n]+=o}))}})),d}},{key:"computeRoundPoint",value:function(e){var t=this.diagram.viewport.invertClient([e.clientX,e.clientY]),n=w.vec3.transformMat3([],w.vec3.clone([t[0],t[1],1]),w.mat3.invert([],this.cell.matrix)),r=b()(n,2),a=Ud({x:r[0],y:r[1]},{x:ut(this.cell.round,0,Math.min(this.cell.width,this.cell.height)/2),y:0},{x:0,y:0,w:this.cell.width,h:this.cell.height,r:0});return ut(a[0]*this.cell.width,0,Math.min(this.cell.width,this.cell.height)/2)}}]),e}();function $d(e,t){return[e[0]+t[0],e[1]+t[1]]}function ef(e,t){return[e[0]-t[0],e[1]-t[1]]}function tf(e,t){return[e[0]*t,e[1]*t]}function nf(e){return Math.hypot(e[0],e[1])}function rf(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=e[0]-t[0],o=e[1]-t[1],c=i*r+o*a;return[i*a-o*r+t[0],c+t[1]]}function af(e){return e.map((function(e){return Math.round(100*e)/100}))}var of=function(e,t,n){return function(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}(n,function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=function(e){return function(e,t){return[e[0]/t,e[1]/t]}(e,nf(e))}(ef(t,e)),i=$d(e,tf(a,function(e,t){return function(e,t){return e[0]*t[0]+e[1]*t[1]}(e,t)/nf(t)}(ef(n,e),a)));if(r){if(i[0]<Math.min(e[0],t[0]))return e[0]<t[0]?e:t;if(i[0]>Math.max(e[0],t[0]))return e[0]>t[0]?e:t;if(i[1]<Math.min(e[1],t[1]))return e[1]<t[1]?e:t;if(i[1]>Math.max(e[1],t[1]))return e[1]>t[1]?e:t}return i}(e,t,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]))};function cf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sf={lake_prevent_click_unselect:"true",vertex_resize_controller:"true"},uf=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"cell",void 0),c()(this,"group",new Zr),c()(this,"eventHelper",new fl),c()(this,"controlPointsManager",void 0),c()(this,"tl",void 0),c()(this,"tr",void 0),c()(this,"bl",void 0),c()(this,"br",void 0),c()(this,"tc",void 0),c()(this,"bc",void 0),c()(this,"lc",void 0),c()(this,"rc",void 0),c()(this,"rotateBtn",void 0),c()(this,"resizeRotatePoints",[]),c()(this,"cursors",void 0);var n=oi("tc",sf),r=oi("bc",sf),a=oi("lc",sf),i=oi("rc",sf),o=ii("tl",sf),l=ii("tr",sf),s=ii("bl",sf),u=ii("br",sf),d=ci("rotate");this.group.on("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),this.group.add(n.group),this.group.add(r.group),this.group.add(a.group),this.group.add(i.group),this.group.add(o.group),this.group.add(l.group),this.group.add(s.group),this.group.add(u.group),this.group.add(d.group),this.tl=o,this.tr=l,this.bl=s,this.br=u,this.tc=n,this.bc=r,this.lc=a,this.rc=i,this.rotateBtn=d,this.controlPointsManager=new Jd(t)}return v()(e,[{key:"init",value:function(e){var t=this,n=this.tl,r=this.tr,a=this.bl,i=this.br,o=this.tc,c=this.bc,l=this.lc,s=this.rc,u=this.rotateBtn;this.cell=e;var d={tl:n,tr:r,bl:a,br:i,tc:o,bc:c,lc:l,rc:s,rotate:u};e.resizeRotatePoints?this.resizeRotatePoints=e.resizeRotatePoints.map((function(e){return d[e]})):this.resizeRotatePoints=Object.keys(d).map((function(e){return d[e]})),this.cursors={},this.resizeRotatePoints.forEach((function(e){e===l||e===s?t.cursors["ew-resize"]=!0:e===o||e===c?t.cursors["ns-resize"]=!0:e===n||e===i?t.cursors["nwse-resize"]=!0:e!==a&&e!==r||(t.cursors["nesw-resize"]=!0)})),Pn(e)&&this.controlPointsManager.init(e)}},{key:"update",value:function(){var e=this.cell,t=this.tl,n=this.tr,r=this.bl,a=this.br,i=this.tc,o=this.bc,c=this.lc,l=this.rc,s=this.rotateBtn,u=this.diagram;if(e){this.controlPointsManager.update();var d=1/u.viewport.zoom,f=Qi(e.rotate||0),h=e.percentage2Canvas({x:0,y:0}),p=e.percentage2Canvas({x:1,y:0}),m=e.percentage2Canvas({x:0,y:1}),y=e.percentage2Canvas({x:1,y:1});if(En(e)){var v=ln(e.outlineElement.attr("d"));v&&(p=e.getPointAtLength(v[1][1]+v[2][1]))}else Cn(e)&&([h,p,m,y].forEach((function(t){t.x+=e.x,t.y+=e.y})),"stage"===e.parent.shape&&0!==e.nth&&(h.x-=25,m.x-=25));var g=d,b=8*d,x=12*d+e.stroke.width/2,k=e.relative2Canvas({x:0-x,y:e.height+x});t.group.update(lf(lf({},h),{},{scale:d,rotate:f})),n.group.update(lf(lf({},p),{},{scale:d,rotate:f})),r.group.update(lf(lf({},m),{},{scale:d,rotate:f})),a.group.update(lf(lf({},y),{},{scale:d,rotate:f})),s.group.update(lf(lf({},k),{},{scale:d,rotate:f})),i.shape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(p.x,",").concat(p.y),"stroke-width":b}),o.shape.update({d:"M".concat(m.x,",").concat(m.y," L").concat(y.x,",").concat(y.y),"stroke-width":b}),c.shape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(m.x,",").concat(m.y),"stroke-width":b}),l.shape.update({d:"M".concat(p.x,",").concat(p.y," L").concat(y.x,",").concat(y.y),"stroke-width":b}),i.visShape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(p.x,",").concat(p.y),"stroke-width":g}),o.visShape.update({d:"M".concat(m.x,",").concat(m.y," L").concat(y.x,",").concat(y.y),"stroke-width":g}),c.visShape.update({d:"M".concat(h.x,",").concat(h.y," L").concat(m.x,",").concat(m.y),"stroke-width":g}),l.visShape.update({d:"M".concat(p.x,",").concat(p.y," L").concat(y.x,",").concat(y.y),"stroke-width":g}),[t,n,r,a,s].forEach((function(e){return e.group.css({visibility:"hidden"})})),this.resizeRotatePoints.forEach((function(e){return e.group.css({visibility:"initial"})})),En(e)&&[i,o,c,l].forEach((function(e){return e.group.css({visibility:"hidden"})}))}}},{key:"bindEvent",value:function(){var e,t,n,r,a,i,o,c,l=this,u=this.cell,d=this.eventHelper,f=u.diagram,h=f.viewport.zoom,p=function(){if(e&&t&&i&&r.points){var n;if("rotate"===e){var a=[t.x+t.w/2,t.y+t.h/2];return r.points.map((function(e){var t=[e[0],e[1]];return t=rf(t,a,Qi(i.r)),Ln(u)?[].concat(D()(t),[e[2]]):t}))}var o=[0,0],c=1,l=1;switch(null===(n=pd.get(0))||void 0===n?void 0:n.get(e)){case 0:c=Ji((o=[t.x,t.y])[0],i.x)?1:-1,l=Ji(o[1],i.y)?1:-1;break;case 1:c=Ji((o=[t.x+t.w,t.y])[0],i.x+i.w)?1:-1,l=Ji(o[1],i.y)?1:-1;break;case 2:c=Ji((o=[t.x+t.w,t.y+t.h])[0],i.x+i.w)?1:-1,l=Ji(o[1],i.y+i.h)?1:-1;break;case 3:c=Ji((o=[t.x,t.y+t.h])[0],i.x)?1:-1,l=Ji(o[1],i.y+i.h)?1:-1}for(var s=i.w/t.w*c,d=i.h/t.h*l,f=[],h=0;h<r.points.length;h++){var p=r.points[h],m=$d(tf(ef(p,o),s),o),y=b()(m,1)[0],v=$d(tf(ef(p,o),d),o),g=b()(v,2)[1];f.push(Ln(u)?[y,g,p[2]]:[y,g])}return f}};function m(){var t,n,r,a,o;if(Dn(u))return{points:p()};var c,l,s={x:null===(t=i)||void 0===t?void 0:t.x,y:null===(n=i)||void 0===n?void 0:n.y,width:null===(r=i)||void 0===r?void 0:r.w,height:null===(a=i)||void 0===a?void 0:a.h,rotate:null===(o=i)||void 0===o?void 0:o.r};return"lc"===e||"rc"===e?s.height=void 0:"tc"!==e&&"bc"!==e||(s.width=void 0),En(u)&&(s={width:ut(null===(c=i)||void 0===c?void 0:c.w,u.getMinWidth(),1/0),height:ut(null===(l=i)||void 0===l?void 0:l.h,u.minHeight,1/0)}),s}this.resizeRotatePoints.forEach((function(a){var i=a.shape,l=a.name;d.bind(i,"mousedown",(function(a){if(f.contentEditor.unbind(),e=l,n=f.viewport.invertClient([a.clientX,a.clientY]),Dn(u)){r={points:s()(u.points)};var i=u.getPointBox();t={x:i.x,y:i.y,w:i.width,h:i.height,r:0}}else r={x:u.x,y:u.y,width:u.width,height:u.height,rotate:u.rotate},t={x:u.x,y:u.y,w:u.width,h:u.height,r:u.rotate};f.align.updateToAlginPoints(u),f.align.prepareForLength(u),"tc"!==e&&"bc"!==e||(f.align.preventAlignX=!0),"lc"!==e&&"rc"!==e||(f.align.preventAlignY=!0);var d=new Yt(t);c=po(d.tl.x,d.tl.y,d.br.x,d.br.y),o=po(d.tr.x,d.tr.y,d.bl.x,d.bl.y)}))})),d.bind(f,"mousemove",(function(r){if(e){var s=f.viewport.invertClient([r.clientX,r.clientY]),d=f.signal.keydown.Shift||u.constraints&&u.constraints.proportion;if(t)if("rotate"===e&&n)w={x:n[0],y:n[1]},C={x:s[0],y:s[1]},O=d&&15,E=_t(A=t),P=zt(E,w,C),(S=A.r+P)>=180&&(S-=360),S<=-180&&(S+=360),O&&(S=O*Math.round(S/O)),i=Lt(Lt({},A),{},{r:S}),l.alignRotate(i),f.emit("cellrotate",{cell:u,rotate:i.r});else{var h=("tl"===e||"br"===e)&&c||("bl"===e||"tr"===e)&&o;d&&("rc"!==e&&"bc"!==e||(h=c),"lc"!==e&&"tc"!==e||(h=o));var p=h&&h.f(s[0]);s[1]=d&&p?p:s[1];var y,v=f.align.alignByPoint({x:s[0],y:s[1],weight:1,box:u.getBBox()});s[0]+=v.dx,s[1]+=v.dy,d&&h&&(0!==v.dx?(y=h.f(s[0]))&&(s[1]=y):0!==v.dy&&(y=h.fy(s[1]))&&(s[0]=y)),d&&("rc"===e?e="br":"lc"===e?e="bl":"tc"===e?e="tr":"bc"===e&&(e="br")),(i=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Yt(n),i=null,o=[],c=e;if(r){switch(t){case"tl":case"br":o=[a.tl,a.br];break;case"tr":case"bl":o=[a.tr,a.bl];break;case"tc":case"bc":o=[a.tc,a.bc],i="height";break;case"lc":case"rc":o=[a.lc,a.rc],i="width";break;default:o=[]}2===o.length&&(c=qt(o,e))}var l=[];switch(t){case"tl":l=[a.br];break;case"tr":l=[a.bl];break;case"bl":l=[a.tr];break;case"br":l=[a.tl];break;case"bc":l=[a.tl,a.tr];break;case"tc":l=[a.bl,a.br];break;case"lc":l=[a.tr,a.br];break;case"rc":l=[a.tl,a.bl];break;default:l=[]}var s,u,d,f,h,p,m,y,v,g,x=l.length;return 1===x?(u=l[0],d=c,f=n.r,h=Dt(u,d),m=(p=It(d,h,-f)).x,y=p.y,v=Math.abs(2*(m-h.x)),g=Math.abs(2*(y-h.y)),s={x:h.x-v/2,y:h.y-g/2,w:v,h:g,r:f}):2===x&&(s=r?function(e,t,n,r){var a,i,o=b()(e,2),c=o[0],l=o[1],s=Dt(c,l),u=t,d=Dt(s,u),f=Tt(s,u),h=n.w/n.h;return"width"===r?i=(a=f)/h:a=h*(i=f),{x:d.x-a/2,y:d.y-i/2,w:a,h:i,r:n.r}}(l,c,n,i):function(e,t,n){var r=e.map((function(e){return Nt(e,-n)})),a=b()(r,2),i=a[0],o=a[1],c=Nt(t,-n),l=0,s=0,u={x:0,y:0};Ji(i.y,o.y)?(l=Math.abs(i.x-o.x),s=Math.abs(c.y-i.y),u={x:(i.x+o.x)/2,y:(i.y+c.y)/2}):Ji(i.x,o.x)&&(s=Math.abs(i.y-o.y),l=Math.abs(c.x-i.x),u={x:(i.x+c.x)/2,y:(i.y+o.y)/2});var d=Nt(u,n);return{x:d.x-l/2,y:d.y-s/2,w:l,h:s,r:n}}(l,c,n.r)),s}({x:s[0],y:s[1]},e,t))&&!En(l.cell)&&f.align.alignByLength(i,e,d)}if(f.update(u,m()),l.update(),-1!==["tl","bl","tr","br"].indexOf(e)){var g=fi(f.viewport.invertClient([r.clientX,r.clientY]),u.getBBox(),Math.PI/8);f.setCursor(g)}f.signal.vertexResizing=!0,f.emit("vertexresizestart")}else if(r.target.dataset.vertex_resize_controller){var x;if("line"===r.target.dataset.type){var k=ln(r.target.getAttribute("d"));x=fi([k[1][1]-k[0][1],k[1][2]-k[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}else x=hi(f.viewport.invertClient([r.clientX,r.clientY]),u.getBBox());a||(a=!0),l.cursors[x]&&f.setCursor(x)}else a&&(f.resetCursor(),a=void 0);var w,C,A,O,E,P,S})),d.bind(f,"mouseup",(function(){f.emit("vertexresizeend"),i&&t&&(t.x!==i.x||t.y!==i.y||t.w!==i.w||t.h!==i.h||t.r!==i.r)&&(Sn(u)?f.command.execute("UpdateSwimlane",{id:u,model:m(),originModels:[r]}):f.command.execute("Update",{id:u,model:m(),originModels:[r]}),f.signal.vertexResizing=!1,f.emit("aftervertexresize")),e=void 0,t=void 0,i=void 0,n=void 0,a=void 0,r=void 0,f.align.reset()})),d.bind(f,"afterviewportchange",pe()((function(){h!==f.viewport.zoom&&(l.update(),h=f.viewport.zoom)}))),d.bind(f,"vertexresizestart",(function(){return l.hide()})),d.bind(f,"vertexresizeend",(function(){return l.show()}))}},{key:"hide",value:function(){this.group.css({display:"none"}),this.controlPointsManager.hide()}},{key:"show",value:function(){this.group.css({display:"initial"}),this.controlPointsManager.show()}},{key:"begin",value:function(){this.cell.diagram.frontRootGroup.add(this.group),this.controlPointsManager.begin(),this.update(),this.show(),Dn(this.cell)&&this.cell.points.length<=2||this.bindEvent()}},{key:"end",value:function(){this.hide(),this.eventHelper.unbind(),this.controlPointsManager.end(),this.diagram&&this.diagram.align.reset()}},{key:"destroy",value:function(){this.controlPointsManager.destroy(),this.diagram&&this.diagram.resetCursor(),this.eventHelper.unbind(),this.group&&this.group.remove()}},{key:"alignRotate",value:function(e){e.r=Math.ceil(e.r);for(var t=[-180,-90,0,90,180],n=0;n<t.length;n++){var r=t[n];if(Ji(e.r,r,4)){e.r=r;break}}}}]),e}();c()(uf,"className","VertexRotateResize");var df=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),(r=t.call(this)).diagram=e;var a=r.diagram.signal.keydown;function i(e,t){var n=function(e){return function(e){return U.ua.macos?"Meta"===e.key:"Control"===e.key}(e)?["Mod",e.key]:["Alt","Shift"].includes(e.key)&&[e.key]}(e);n&&n.forEach((function(e){a[e]=t}))}return r.bind(window,"keydown",(function(e){i(e,!0)})),r.bind(window,"keyup",(function(e){i(e,!1)})),r.bind(window,"blur",(function(){for(var e in a)a[e]=!1})),r}return v()(n)}();c()(df,"className","KeyboardPressKey");var ff=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"aftercommandexecute",(function(e){var t=e.command,n=e.commandName;if(!("Add"!==n&&"AddVertex"!==n&&"AddStack"!==n&&"AddStackVertex"!==n||"geometry"!==t.model.type&&"stack"!==t.model.type)){var a;try{a=JSON.parse(r.LocalStorageUtil.getItem(ir))||[]}catch(e){a=[]}var i=t.model.shape,o=oc.findIndex((function(e){return e.name===i}));if(o>=0){var c=oc[o],l=a.findIndex((function(e){return e.name===i}));if(l>=0){var s=a.splice(l,1);a.unshift(s[0])}else a.unshift({name:i,category:c.category}),a.length>6&&a.pop();r.LocalStorageUtil.setItem(ir,JSON.stringify(a))}}}))}}]),n}();var hf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"updateControlPoints",value:function(e){var t=this.beforeData,n=this.afterData;e.forEach((function(e){var r=e.model,a=r.controlPoints,i=[0,0];["source","target"].forEach((function(e){var a=r[e]&&r[e].id||"".concat(r.id,"-").concat(e);if(a){var o=t[a],c=n[a];if(i&&o&&c){var l=w.vec2.sub([],c.slice(0,2),o.slice(0,2));i=vt(l,[0,0])?null:w.vec2.add(i,i,l)}}})),i&&!vt(i,[0,0])&&(i=i.map((function(e){return e/2})),xe()(t["".concat(r.id,"-controlPoints")],n["".concat(r.id,"-controlPoints")])&&e.update({controlPoints:a.map((function(e){return[e[0]+i[0],e[1]+i[1],e[2]]}))}))}))}},{key:"getData",value:function(e){var t={},n=this.diagram;return e.forEach((function(e){var r=e.model;["source","target"].forEach((function(e){var a=r[e]&&r[e].id;if(a){var i=n.find(a),o=i.percentage2Canvas([.5,.5]);t[i.model.id]=[o.x,o.y]}else r[e].connection&&(t["".concat(r.id,"-").concat(e)]=r[e].connection)})),t["".concat(r.id,"-controlPoints")]=s()(e.controlPoints)})),t}},{key:"getLines",value:function(){return this.diagram.getCells().filter((function(e){return e.isLine})).filter((function(e){return e.isDrawable()&&e.model.controlPoints}))}},{key:"onBeforeChange",value:function(){var e=this.getLines();this.beforeData=this.getData(e)}},{key:"onAfterChange",value:function(){var e=this.getLines();this.afterData=this.getData(e),this.updateControlPoints(e)}},{key:"reset",value:function(){this.beforeData={},this.afterData={}}},{key:"init",value:function(){var e=this.diagram;this.reset(),this.bind(e,"beforechange",this.onBeforeChange.bind(this)),this.bind(e,"afterchange",this.onAfterChange.bind(this))}}]),n}();var pf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(){this._initParam(),this._initEvent()}},{key:"_initParam",value:function(){this.groups=[]}},{key:"_calculateGroups",value:function(e,t){var n=[];e.concat(t).forEach((function(e){for(var t=e.parent;t&&!n.includes(t);)t.isGroup&&n.push(t),t=t.parent})),this.groups=n.sort((function(e,t){return t.depth-e.depth}))}},{key:"_draw",value:function(){var e=this.groups,t=this.diagram,n=this.action,r=t.rootGroup;e.forEach((function(e){if("add"===n){var t=e.getAllChildren(),a=t.length;if(a>0){t.sort((function(e,t){return e.getZIndex()-t.getZIndex()}));var i=t[a-1];r.insertBefore(e.graphicGroup,i.graphicGroup),r.insertBefore(i.graphicGroup,e.graphicGroup)}}e.draw()}))}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"beforechange",this._onBeforeChange.bind(this)),this.bind(e,"afterchange",this._onAfterChange.bind(this))}},{key:"_onBeforeChange",value:function(e){var t=e.stems,n=e.relatedLines,r=e.action;this.destroyed||"remove"===r&&this._calculateGroups(t,n)}},{key:"_onAfterChange",value:function(e){var t=e.stems,n=e.relatedLines,r=e.action;this.destroyed||("update"!==r&&"add"!==r||this._calculateGroups(t,n),this.action=r,this._draw(),this._initParam())}}]),n}();var mf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterchange",(function(t){if(t){var n=t.models,r=t.action;"remove"===r?function(e,t){t.forEach((function(t){e.emit("vertexcell:remove",{id:t.id})}))}(e,n):"update"===r&&function(e,t){for(var n={},r=!1,a=function(){var a=t[i],o=e.find(a.id),c=["x","y","width","height","shape","rotate","controlPoints","round"];bn(o)&&c.push("html"),En(o)&&c.push("html"),Sn(o)&&c.push("widths","heights"),Dn(o)&&c.push("points");var l,s=!1;En(o)&&(a.hasOwnProperty("width"),s=!0),(kn(o)||An(o)||En(o)||Sn(o)||Dn(o))&&c.some((function(e){return null!=a[e]}))&&(s=!0),s&&(n[a.id]=!0,r||(function(e){for(;e.parent;){if(e.parent.state.selected)return!0;e=e.parent}return!1}(o)||e.selector.selections.length>1)&&(r=!0),o.state.selected&&(Dn(o)?e.drawBaseResizer.update():e.vertexRotateResize.update()),null===(l=e.swimlaneResize)||void 0===l||l.update(),e.emit("vertexcell:update",{cell:o}))},i=0;i<t.length;i++)a();r&&e.groupRotateResize.update()}(e,n)}}))}}]),n}();var yf={default:{insertParagraphKey:function(e){return"Enter"===e.key},cancelKey:function(e){return"Escape"===e.key}}},vf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=e.contentEditor;function n(){if(!e.signal.mouseMultiSelecting){var n=e.selector.selections,r=n[0];if(1===n.length&&r&&r.textareaElement&&r.canText()){var a=r.textareaElement;if(e.destroyed)return;var i=a.htmlContainer;if(t.dom&&t.dom!==i&&t.unbind(),!t.dom&&e.viewportContainer.contains(i)){var o=yf[r.type]||yf.default;t.bind(i,o)}t.isBegin||t.prepareEdit()}else t.unbind(),e.focus()}}var r=ye()(n,32);this.bind(e,"afterselect",(function(){e.signal.beforePasteSelect?r():n()})),this.bind(e,"keydown",(function(n){if(!(e.selector.selections.length>1)&&n.key&&["Up","ArrowUp","Left","ArrowLeft","Down","ArrowDown","Right","ArrowRight"].includes(n.key)){var r=e.getCell(n.target);xn(r)&&(t.unbind(),e.focus())}})),this.bind(e,"mousedown",(function(t){var n=e.getCell(t.target);n&&n.textareaElement&&!n.textareaElement.htmlContainer.contains(t.target)&&t.preventDefault()})),this.bind(e,"dblclick",(function(n){var r=n.target,a=n.clientX,i=n.clientY,o=e.getCell(r);if(o&&o.state.selected&&o.textareaElement&&!e.contentEditor.isBegin&&o.canText()){e.selector.selections.length>1&&e.selector.select([o]),t.prepareEdit(),t.beginEdit();var c={};if(xn(o)&&function(e){var t=(new DOMParser).parseFromString(e,"text/html").body;if(0===t.childElementCount){if(""===t.innerText)return!0}else if(1===t.childElementCount){var n;if("​"===(null===(n=t.firstElementChild)||void 0===n?void 0:n.innerText))return!0}return!1}(o.html)){var l=e.viewport.invertClient([a,i]),s=o.getKeyShape().getClosestPoint(l[0],l[1]);c.textPosition=s.percentage}e.update(o,c)}})),this.bind(e,"click",(function(t){var n=e.getCell(t.target);if(n&&n.textareaElement&&n.textareaElement.htmlContainer.contains(t.target)&&"A"===t.target.tagName){if(e.signal.keydown.Mod){var r=t.target.getAttribute("href");if(r)return void window.open(r,"_blank")}t.preventDefault()}}))}}],[{key:"registerContentEditorOptions",value:function(e,t){yf[e]=t}}]),n}();var gf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t;this.bind(e,"afteractivedgroupchange",(function(){t&&(t.updateState(),t=null);var n=e.groupManager.group;n&&(n.updateState(),t=n)}))}}]),n}();var bf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterselect",(function(t){var n=t.selections;n.length>1?e.highlight.select(n.filter((function(e){return e.multiSelectHighlight}))):e.highlight.clear()}))}}]),n}();var xf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"resizer",void 0),c()(E()(e),"selections",[]),c()(E()(e),"cell",void 0),e}return v()(n,[{key:"init",value:function(e){var t=this,n=e.groupRotateResize,r=e.vertexRotateResize,a=e.swimlaneResize,i=e.drawBaseResizer;this.bind(e,"afterselect",(function(e){var o,c=e.selections;if(t.selections=c,t.resizer&&(t.resizer.end(),t.resizer=void 0),1===c.length)o=c[0],An(o)?t.resizer=n:kn(o)||En(o)||wn(o)||Cn(o)?t.resizer=r:Sn(o)||jn(o)?t.resizer=a:Dn(o)&&(t.resizer=i);else{var l=t.selections.filter((function(e){return!Mn(e)}));l.length>1&&(t.resizer=n,o=l)}t.resizer&&(t.cell=o,t.resizer.init(o),t.resizer.begin())})),this.bind(e,"aftercommandbackward",(function(){t.resizer&&(t.resizer.end(),t.resizer.init(t.cell),t.resizer.begin())})),this.bind(e,"aftercommandforward",(function(){t.resizer&&(t.resizer.end(),t.resizer.init(t.cell),t.resizer.begin())})),this.bind(e,"cell:dragstart",(function(){t.resizer&&t.resizer.hide()})),this.bind(e,"cell:dragend",(function(){t.resizer&&(t.resizer.update(),t.resizer.show())}))}}]),n}();var kf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"beforechange",(function(e){var t=e.action,n=e.arr;"update"===t&&n.forEach((function(e){var t=e.cell,n=e.model;if(n.shape){if("geometry"!==t.type)return;var r=oc.find((function(e){return e.name===n.shape}));["controlPoints","round"].forEach((function(e){var a=null==r?void 0:r[e];a?n[e]=a:(delete t.model[e],delete t[e])}))}}))}))}}]),n}();function wf(e){var t={stems:[],originModels:[]};return e.forEach((function(e){e.deepEach((function(e){if(!e.isStem)return!1;!function(e){var n=function(e){var t,n=e.model;return xn(e)?t={type:n.type,source:s()(n.source),target:s()(n.target)}:Ln(e)||Bn(e)?t={type:n.type,points:s()(n.points)}:e.isGroup||(t={type:n.type,x:e.x,y:e.y}),t}(e);n&&Object.keys(n).length>0&&(t.stems.push(e),t.originModels.push(n))}(e)}),(function(t){return"swimlane"===t.type?t.contain.map((function(t){var n;return null===(n=e.diagram.find(t))||void 0===n?void 0:n.model})).filter((function(e){return e})):t.children}))})),t}var Cf=[],Af=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(){this._initParam(),this._initEvent()}},{key:"_initParam",value:function(){this.originModels=null,this.stems=null,this.dx=0,this.dy=0,this.prepare=!1,this.selectionIds=void 0}},{key:"executeCommand",value:function(){var e=this.diagram,t=this.stems,n=this.dx,r=this.dy,a=this.originModels,i=this.selectionIds;!e.destroyed&&a&&(e.command.execute("Update",{id:t,model:Hd(t,n,r),originModels:a,select:function(){e.selector.select(i)}}),this._initParam())}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"keydown",(function(n){var r,a=t.selector.selections,i=a.filter((function(e){return Cf.every((function(t){return t(e)}))})),o=0,c=0;if(!(i.length<=0)){switch(e.selectionIds=a.map((function(e){return e.model.id})),r=n.shiftKey?10:1,n.key){case"Left":case"ArrowLeft":o=-r;break;case"Right":case"ArrowRight":o=r;break;case"Up":case"ArrowUp":c=-r;break;case"Down":case"ArrowDown":c=r;break;default:return}if(0!==o||0!==c){var l=wf(i),s=l.stems,u=l.originModels;e.originModels=e.originModels||u,e.prepare||(e.prepare=!0,t.align.updateToAlginPoints(a));var d=Tn(a),f=t.align.alignByBox({minX:d.minX+o,minY:d.minY+c,maxX:d.maxX+o,maxY:d.maxY+c}),h=!1;Math.abs(f.dx)<1&&0!==f.dx&&(h=!0,o+=f.dx),Math.abs(f.dy)<1&&0!==f.dy&&(h=!0,c+=f.dy),h||t.align.clear(),n.preventDefault(),t.update(s,Hd(s,o,c)),e.stems=s}}})),this.bind(t,"keyup",ye()((function(){e.executeCommand()}),400))}}],[{key:"filterCell",value:function(e){Cf.push(e)}}]),n}();var Of=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){0!==e.selector.selections.length||"s"!==t.key||ki(t)||(t.preventDefault(),e.command.execute("BeginInsertGeometry"))}))}}]),n}();var Ef=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=this;this.bind(e,"keydown",(function(n){if(ki(n)&&"l"===n.key){n.preventDefault();var r=e.selector.selections;t.cell=r[0];var a="arrow";if(2===r.length&&r.every((function(e){return!e.isLine&&!e.isGroup})))return e.command.execute("Add",{model:{type:"line",shape:null,source:{id:r[0].model.id},target:{id:r[1].model.id,marker:a}}});e.command.execute("BeginInsertLine",{shape:null,marker:a})}}))}}]),n}();var Pf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){0!==e.selector.selections.length||"t"!==t.key||ki(t)||(t.preventDefault(),e.command.execute("BeginInsertText"))}))}}]),n}();var Sf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){e.selector.selections.some((function(e){return e.textareaElement}))&&ki(t)&&("b"===t.key?(t.preventDefault(),e.command.execute("ContentCommand",{name:"bold"})):"i"===t.key?e.command.execute("ContentCommand",{name:"italic"}):"k"===t.key?e.command.execute("CreateLink"):"u"===t.key?e.command.execute("ContentCommand",{name:"underline"}):t.shiftKey&&"x"===t.key&&e.command.execute("ContentCommand",{name:"strikethrough"}))}))}}]),n}();var jf=new kc,Rf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n=e.selector,r=e.viewport;n.selections.length>0&&"d"===t.key&&ki(t)&&(t.preventDefault(),e.command.execute("Copy",{e:jf}),e.command.execute("Paste",{e:jf,focusPoint:r.getFocus()}))}))}}]),n}();function Mf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){if(!ki(t)&&["Backspace","Delete"].includes(t.key)){if(t.preventDefault(),e.selector.selections.every((function(e){return Mn(e)}))||e.selector.selections.every((function(e){return Cn(e)})))return;var n=e.deduplicate(e.selector.selections);if(1===n.length&&n[0].isMindmap){var r=n[0],a=r.graphicGroup.rendererElement.querySelector('[data-lake-mindmap-icon-selected="true"]');if(a){var i=a.getAttribute("lake-mindmap-icon-key"),o={icons:Lf(Lf({},r.model.icons||{}),{},c()({},i,null))};return e.command.execute("Update",{id:r.model.id,model:o,notSelect:!0}),void e.tryFocus()}}e.command.execute("Delete",{cells:n.map((function(e){return e.model.id}))}),e.tryFocus()}}))}}]),n}();var Df=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n=e.selector;e.groupManager.group&&"Escape"===t.key&&!ki(t)&&(t.preventDefault(),n.clear())}))}}]),n}();var Nf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){"g"===t.key&&ki(t)&&!t.shiftKey?(t.preventDefault(),e.command.execute("MakeGroup")):("g"===t.key||"G"===t.key)&&ki(t)&&t.shiftKey&&(t.preventDefault(),e.command.execute("Ungroup"))}))}}]),n}();var If=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n;t.altKey&&(n={ArrowLeft:"AlignLeft",ArrowRight:"AlignRight",ArrowUp:"AlignTop",ArrowDown:"AlignBottom",KeyH:"AlignHCenter",KeyV:"AlignVCenter"}[t.code]),ki(t)&&(n=(t.altKey?{BracketLeft:"Backward",BracketRight:"Forward"}:{BracketLeft:"ToBack",BracketRight:"ToFront"})[t.code]),n&&(t.preventDefault(),e.command.execute(n))}))}}]),n}();var Tf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ki(t)&&"a"===t.key&&(t.preventDefault(),t.stopPropagation(),e.command.execute("SelectAll"),e.tryFocus())}))}}]),n}();var _f=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=function(){e.lineAlign.setEnable(!1),e.lineAlign.reset()};this.bind(window,"keydown",(function(){e.signal.keydown.Shift&&e.lineAlign.setEnable(!0)})),this.bind(window,"keyup",(function(){e.signal.keydown.Shift||t()})),this.bind(window,"blur",(function(){t()}))}}]),n}();function Ff(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ff(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ff(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qf=15.27,Yf=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),e=t.call(this),c()(E()(e),"updateLine",(function(t){var n=E()(e),r=n.diagram,a=n.line,i=n.origin,o=n.sourceCell,c=r.viewport.invertClient([t.clientX,t.clientY]);if(i&&!a&&o&&ro(i[0],i[1],c[0],c[1])>8)e.line=r.add(e.initLine(c))[0],e.line.graphicGroup.css({cursor:"crosshair"}),r.lineResizer.init(e.line,"target"),r.setCursor("crosshair"),e.clearButton();else if(a){var l=r.lineResizer.resize(t);r.update(a,te()({},r.settings.line,{target:l}))}})),c()(E()(e),"commitLine",(function(t){var n=E()(e),r=n.line,a=n.diagram,i=n.origin,o=n.sourceCell;if(r||i){var c;if(r)c=r.model,a.remove(r);else if(i){e.updateCurrentDirection(t);var l=e.getTargetConnection(e.currentDirection);c=e.initLine(l)}var s=Object(F.a)();a.command.execute("Add",{model:zf(zf({},c),{},{id:s})}),e.clear(),null==c.target.id&&requestAnimationFrame((function(){a.emit("vertexcell:prompt",{line:a.find(s),sourceCell:o})}))}})),c()(E()(e),"revertLine",(function(t){var n=E()(e),r=n.line,a=n.diagram;r&&("Esc"!==t.key&&"Escape"!==t.key||(a.remove(r),e.clear()))})),e.cacheEndpointId=null,e.eventHelper=new fl,e}return v()(n,[{key:"_initHoverButtonDefs",value:function(){var e=this.diagram.defs,t=Object(F.a)(),n=new aa({id:t,fill:vr,stroke:mr,"stroke-width":1,d:en(0,0,5)});e.add(n),this.hoverButtonDefId=t,this.hoverButtonDef=n}},{key:"_initButtonDefs",value:function(){var e=this.diagram.defs,t=Object(F.a)(),n=new aa({id:t,fill:yr,stroke:mr,"stroke-width":1,d:en(0,0,3.5)});e.add(n),this.buttonDefId=t,this.buttonDef=n}},{key:"_initDefs",value:function(){this._initHoverButtonDefs(),this._initButtonDefs()}},{key:"_initButton",value:function(){var e=this,t=this.buttonDefId,n=this.hoverButtonDefId,r=this.diagram,a=new Zr,i={};["N","E","S","W"].forEach((function(o){var c=new Jr,l=new Oa({width:qf,height:qf,href:"#".concat(t)}),s=new aa({fill:"rgba(0,0,0,0)",d:un(-7.635,-7.635,qf,qf)});c.add(l),c.add(s),l.css("pointer-events","none"),s.dataset({testid:"add_line_button_".concat(o)}),s.on("mousedown",(function(n){var a=r.viewport.invertClient([n.clientX,n.clientY]),i=b()(a,2),c=i[0],s=i[1];e.origin=[c,s],l.update({href:"#".concat(t)}),e.updateCurrentDirection(o),r.emit("addlinebuttonmousedown"),r.vertexRotateResize.hide()})),s.on("mouseenter",(function(){r.signal.mouseMultiSelecting||l.update({href:"#".concat(n)})})),s.on("mouseleave",(function(){l.update({href:"#".concat(t)})})),a.add(c),i[o]=c})),a.css({cursor:"copy"}),a.dataset({lake_prevent_click_unselect:!0,testid:"add_line_button_group"}),this.buttonMap=i,this.buttonGroup=a}},{key:"updateButton",value:function(){var e=this.diagram,t=this.sourceCell,n=this.buttonGroup,r=this.buttonMap;if(t){var a=1/e.viewport.zoom,i=t.rotate,o=t.width,c=t.height,l=16/e.viewport.zoom;0===o&&(o=1/0),0===c&&(c=1/0),e.frontRootGroup.add(n),Object.keys(r).forEach((function(e){var n,s=r[e];switch(e){case"N":n=t.percentage2Canvas([.5,-l/c]);break;case"E":n=t.percentage2Canvas([1+l/o,.5]);break;case"S":n=t.percentage2Canvas([.5,1+l/c]);break;case"W":n=t.percentage2Canvas([-l/o,.5])}s.update(zf(zf({},n),{},{scale:a,rotate:i}))}))}}},{key:"clearButton",value:function(){var e=this.showButtonGroup;e&&(e.remove(),this.showButtonGroup=null)}},{key:"hide",value:function(){this.buttonGroup.hide()}},{key:"show",value:function(){this.buttonGroup.show()}},{key:"initLine",value:function(e){var t=this.sourceCell,n=this.currentDirection,r=this.diagram,a={type:"line",source:{id:t.model.id,connection:n},target:{connection:e}};return r.hooks.decorateAddLineModel.call(a),a}},{key:"getTargetConnection",value:function(e){var t=this.sourceCell,n=t.getPoint(e),r=n.x,a=n.y,i=t.rotate;switch(e){case"N":i+=270;break;case"E":break;case"S":i+=90;break;case"W":i+=180;break;default:throw new Error("unexpected direction ".concat(e))}var o=Qi(i);return[r+50*Math.cos(o),a+50*Math.sin(o)]}},{key:"updateCurrentDirection",value:function(e){var t=this.diagram;if("string"==typeof e)this.currentDirection=e;else{var n=t.viewport.invertClient([e.clientX,e.clientY]),r=b()(n,2),a=r[0],i=r[1],o=this.sourceCell,c=o.getPoint([.5,.5]);if(ro(c.x,c.y,n[0],n[1])>16){var l=oo(c.x,c.y,a,i),s=o.rotate;s<0&&(s+=360);var u=l-(s=Qi(s));u<0&&(u+=2*Math.PI),this.currentDirection=Fi(u)}}}},{key:"updateBoundingRect",value:function(e){var t=e.graphicGroup.getBoundingClientRect(),n=t.x,r=t.y,a=t.width,i=t.height,o=r-qf-16,c=n+a+qf+16,l=r+i+qf+16,s=n-qf-16;this.boundingRect={top:o,right:c,bottom:l,left:s}}},{key:"update",value:function(e){e&&(this.sourceCell=e,this.showButtonGroup=this.buttonGroup,this.updateBoundingRect(e),this.updateButton())}},{key:"clear",value:function(){this.diagram.lineResizer.reset(),this.clearButton(),this.sourceCell=null,this.boundingRect=null,this.origin=null,this.line=null,this.diagram.resetCursor()}},{key:"init",value:function(e){var t,n=this,r=e.selector;this._initDefs(),this._initButton(),this.eventHelper.bind(e,"afterviewportchange",pe()((function(){t!==e.viewport.zoom&&n.sourceCell&&(n.updateButton(),t=e.viewport.zoom)}))),this.bind(e,"afterselect",(function(){var t=r.selections,a=t[0];1!==t.length||a.isLine||!a.canUseAddLineButton()||n.line||e.signal.cellDragStart?n.clear():n.update(a)})),this.bind(e,"vertexcell:update",(function(e){e.cell===n.sourceCell&&n.updateButton()})),this.bind(e,"vertexcell:remove",(function(e){var t=e.id,r=n.sourceCell;r&&r.model.id===t&&n.clear()})),this.bind(e,"cell:dragstart",(function(){n.clear()})),this.bind(e,"mousemove",pe()((function(e){n.origin&&n.updateLine(e)}),16)),this.bind(e,"mouseup",this.commitLine),this.bind(e,"keydown",this.revertLine),this.bind(e,"vertexresizestart",(function(){return n.hide()})),this.bind(e,"vertexresizeend",(function(){return n.show()}))}},{key:"reset",value:function(){this.hoverButtonDef&&this.hoverButtonDef.destroy(),this.buttonDef&&this.buttonDef.destroy()}}]),n}(),Hf=function(){var e=window.yuqueThemeManager;return"dark"===(null==e?void 0:e.current)},Gf=function(){return Hf()?Tr:Ir},Xf=function(e){return Hf()?Tr[e]:Ir[e]},Vf=[{name:"rect",title:zn("矩形")},{name:"rounded-rect",title:zn("圆角矩形")},{name:"circle",title:zn("圆形")},{name:"triangle",title:zn("三角形")},{name:"diamond",title:zn("菱形")},{name:"parallelogram",title:zn("平行四边形")},{name:"trapezoid",title:zn("梯形")},{name:"cross",title:zn("十字")},{name:"comment-2",title:zn("标注 2")},{name:"comment",title:zn("标注")},{name:"polygon",title:zn("五边形")},{name:"star",title:zn("五角星")},{name:"arrow-1",title:zn("左箭头")},{name:"arrow-2",title:zn("右箭头")},{name:"arrow-3",title:zn("双向箭头")},{name:"pentagon-arrow",title:zn("五边箭头")},{name:"process-arrow",title:zn("流程箭头")},{name:"cloud",title:zn("云")}],Wf=[{name:"swimlane-vertical",title:zn("泳道垂直")},{name:"swimlane-horizontal",title:zn("泳道水平")}],Zf=[{name:"pyramid",title:zn("金字塔")},{name:"segmented pyramid",title:zn("分段金字塔")},{name:"stage",title:zn("阶段图")},{name:"architecture",title:zn("架构图")}],Uf=[{name:"process",title:zn("过程")},{name:"decision",title:zn("决策")},{name:"start-end",title:zn("起止符")},{name:"subroutine",title:zn("预定义流程")},{name:"document",title:zn("文档")},{name:"multi-document",title:zn("多文档")},{name:"manual-input",title:zn("手动输入")},{name:"preparation",title:zn("准备")},{name:"data",title:zn("数据")},{name:"database",title:zn("数据库")},{name:"hard-disk",title:zn("硬盘")},{name:"internal-storage",title:zn("内部存储")},{name:"paper-tape",title:zn("条带")},{name:"manual-loop",title:zn("手动循环")},{name:"delay",title:zn("延迟")},{name:"stored-data",title:zn("存储数据")},{name:"merge",title:zn("合并")},{name:"connector",title:zn("连接器")},{name:"or",title:zn("或者")},{name:"summing-junction",title:zn("汇总连接")},{name:"display",title:zn("显示")},{name:"off-page",title:zn("页外连接符")},{name:"loop-limit",title:zn("循环起止符")},{name:"card",title:zn("卡片")},{name:"sort",title:zn("排序")},{name:"collate",title:zn("整理")},{name:"parallel",title:zn("并行模式")},{name:"annotation",title:zn("批注")}],Kf=[{name:"actor",title:zn("角色")},{name:"use-case",title:zn("用例")},{name:"package",title:zn("包")},{name:"frame",title:zn("组合片段")},{name:"constraint",title:zn("约束")},{name:"note",title:zn("注释")},{name:"class",title:zn("类")},{name:"activity-class",title:zn("活动类")},{name:"simple-class",title:zn("简单类")},{name:"interface",title:zn("接口")},{name:"multiplicity",title:zn("多类例")},{name:"frequency",title:zn("时间信号")},{name:"activation",title:zn("激活")},{name:"entity",title:zn("实体")},{name:"control",title:zn("控制")},{name:"boundary",title:zn("绑定")},{name:"deletion",title:zn("删除")},{name:"state",title:zn("状态")},{name:"object",title:zn("对象")},{name:"start",title:zn("开始")},{name:"finish",title:zn("结束")},{name:"termination-pseudostate",title:zn("流终止")},{name:"history-pseudostate",title:zn("历史")},{name:"choice",title:zn("分支")},{name:"activity",title:zn("活动")},{name:"send-signal",title:zn("发送信号")},{name:"receive-signal",title:zn("接收信号")},{name:"fork",title:zn("同步")},{name:"component",title:zn("组件")},{name:"node",title:zn("节点")}],Qf=[{name:"er-entity",title:zn("实体")},{name:"weak-entity",title:zn("弱实体")},{name:"derived-attribute",title:zn("派生属性")},{name:"attribute",title:zn("属性")},{name:"multivalued-attribute",title:zn("多值属性")},{name:"relationship",title:zn("关系")},{name:"weak-relationship",title:zn("弱关系")},{name:"generalization",title:zn("概化")},{name:"total-generalization",title:zn("全部概化")}];function Jf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jf(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var eh=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var a=$f({width:32,height:32},e),i=a.width,o=a.height,c=a.noFill,l=e.matrix||[1,0,0,0,1,0,0,0,1];i>0&&(l[0]=i/32),o>0&&(l[4]=o/32),r=t.call(this,$f($f({},e),{},{matrix:l}));var s=e.stencil,u=e.title,d=s.name,f=s.thumb,h=new va({x:0,y:0,width:i,height:o,rx:2,fill:c?"none":"#ffffff",stroke:"none"});return r.add(new Ca({title:u})),r.add(h),f.forEach((function(e){var t=vu(e);e.attr&&t.update(e.attr),r.add(t)})),E()(r).rendererElement.setAttribute("data-name",d),r.css({cursor:"pointer"}),r}return v()(n)}();var th=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),r=t.call(this,e),c()(E()(r),"shapes",void 0),c()(E()(r),"_height",0);var a=e.key,i=e.title,o=e.shapes;return r.shapes=o,r.title=i,r.rendererElement.setAttribute("data-group",a),r.init(),r}return v()(n,[{key:"init",value:function(){var e=this,t=12,n=0;if(0!==this.shapes.length){Hf();var r=new xa({text:this.title,matrix:[1,0,0,0,1,0,12,15,1],fill:Xf("text")});this.text=r,r.css({fontSize:"14px","dominant-baseline":"hanging"}),this.add(r),n+=39,this.shapes.forEach((function(r){var a=r.name,i=r.title,o=oc.find((function(e){return e.name===a}));t>=200&&(t=12,n+=34);var c=new eh({stencil:o,matrix:[1,0,0,0,1,0,t,n,1],noFill:!0,stroke:Xf("text"),fill:"transparent",title:i});e.add(c),t+=32})),n+=32,this._height=n}}},{key:"height",get:function(){return this._height}}]),n}();function nh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ah={basic:{title:zn("基础图形"),shapes:Vf},flowchart:{title:zn("流程图"),shapes:Uf},UML:{title:zn("UML"),shapes:Kf},ER:{title:zn("ER"),shapes:Qf},DSL:{title:zn("Smart"),shapes:Zf}},ih=function(e){S()(n,Zr);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var a=rh({groups:["basic"]},e);return r=t.call(this,a),c()(E()(r),"latest",{title:zn("最近使用"),shapes:[]}),c()(E()(r),"latestGroup",void 0),c()(E()(r),"shapeGroups",[]),c()(E()(r),"_height",0),c()(E()(r),"backgroundColor",void 0),c()(E()(r),"groupMap",void 0),c()(E()(r),"cancelThemeListener",void 0),r.groups=a.groups,r.containerHeight=a.containerHeight,r.init(),r.bindEvent(),r}return v()(n,[{key:"width",get:function(){return 215}},{key:"height",get:function(){return this._height}},{key:"init",value:function(){var e,t=this,n=this.options;this.backgroundColor=null!==(e=n.backgroundColor)&&void 0!==e?e:Xf("background");var r=0;this.groupMap=s()(ah);var a=this.groups.map((function(e){var n;if("latest"===e)(n=t.latest).shapes=t.getLatest();else{n=t.groupMap[e];var a=t.options.basicWithSwimlane;"basic"===e&&a&&(n.shapes=[].concat(D()(n.shapes),D()(Wf)))}var i=r,o=new th(rh(rh({},n),{},{key:e,title:n.title}));return o.update({matrix:[1,0,0,0,1,0,0,i,1]}),r+=o.height,n.height=o.height,"latest"===e&&(t.latestGroup=o),t.shapeGroups.push(o),o}));this.background=new va({x:0,y:0,width:215,height:r,fill:this.backgroundColor}),this.add(this.background),a.forEach((function(e){return t.add(e)})),this.updateHeight(r)}},{key:"getLatest",value:function(){var e,t=r.LocalStorageUtil.getItem(ir);try{e=JSON.parse(t)||[]}catch(t){e=[]}for(var n=function(){var t,n=e[a];n.title="";var r=null===(t=ah[n.category])||void 0===t?void 0:t.shapes;if(r){var i=r.findIndex((function(e){return e.name===n.name}));i>=0&&(n.title=r[i].title)}},a=0;a<e.length;a++)n();return e}},{key:"bindEvent",value:function(){var e,t,n,r=this;this.on("mouseover",pe()((function(e){for(var t=e.target.closest("[data-name]"),n=r.rendererElement.querySelectorAll("[data-name]"),a=0;a<n.length;a++){var i=n[a],o=i.querySelector("path");o&&o.setAttribute("fill",i===t?Xf("hover"):"transparent")}}),16)),this.on("mouseleave",pe()((function(){if(e){var t=e.querySelector("path");t&&t.setAttribute("fill","transparent")}}),16)),this.on("click",(function(t){var n=t.target.closest("[data-name]");if(n){var a,i=n.dataset.name,o=n.closest("[data-group]").dataset.group,c=oc[oc.findIndex((function(e){return e.name===i}))],l=(null==c||null===(a=c.outline)||void 0===a?void 0:a.attr)||{},s=c.type||"geometry",u=c.category;r.emit("shape:select",{shape:i,group:o,type:s,category:u,attr:l}),e=n}})),this.cancelThemeListener=(t=function(){r.init()},null==(n=window.yuqueThemeManager)?void 0:n.onChange(t))}},{key:"updateGroups",value:function(e){this.groups=e,this.init(),this.updatePosition()}},{key:"updatePosition",value:function(){var e=this,t=0;this.groups.forEach((function(n,r){var a,i=e.shapeGroups[r];a="latest"===n?e.latest:e.groupMap[n];var o=t;t+=a.height,i.update({matrix:[1,0,0,0,1,0,0,o,1]})})),this.updateHeight(t),this.emit("update:height",{height:t})}},{key:"updateHeight",value:function(e){var t=this.containerHeight,n=this.groups;this._height=t?e+(t-this.groupMap[n[n.length-1]].height):e,this._height+=6,this.background.update({d:un(0,0,215,this._height)})}},{key:"getOffset",value:function(e){for(var t=this.groups,n=t.indexOf(e),r=0,a=0;a<n;a++){var i=t[a];r+=this.groupMap[i].height}return r}},{key:"destroy",value:function(){this.cancelThemeListener&&this.cancelThemeListener(),I()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function oh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ch(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"onShapeSelect",(function(t){var n=t.shape,r=t.type,a=t.category,i=E()(e),o=i.diagram,c=i.line,l=i.sourceCell,s=c.target.connection,u=e.computeInheritedStyles(n,r),d=oc.find((function(e){return e.name===n})),f=e.adjustVertexPosition(s,n,l.stroke,d),h=b()(f,2),p=h[0],m=h[1],y={model:ch({shape:n,type:r,category:a,x:p,y:m},u),lineId:c.model.id,cellOptions:{}};o.hooks.decorateAddVertexModel.call(y.model);var v="AddVertex";["controlPoints","round"].forEach((function(e){null!=d&&d[e]&&!y.model[e]&&(y.model[e]=d[e])})),"stack"===r?(v="AddStackVertex",y.htmls=d.htmls,y.model.row=d.row):y.model.html=d.html||Id,o.command.execute(v,y),e.closePanel()})),e}return v()(n,[{key:"initPanel",value:function(){var e=this.diagram.defs;this.filterId=Object(F.a)();var t=new Ia,n=new Ba({dx:0,dy:0,stdDeviation:4,"flood-color":"rgba(0, 0, 0, 0.13)"});t.attr({id:this.filterId}),t.add(n),e.add(t)}},{key:"computeInheritedStyles",value:function(e,t){var n=this.sourceCell;if(n.type!==t)return{};var r=n.width,a=n.height,i={stroke:n.stroke,fill:n.fill};return n.shape===e&&(Object.assign(i,{width:r,height:a}),["controlPoints","round"].forEach((function(e){n[e]&&Object.assign(i,c()({},e,n[e]))}))),i}},{key:"closePanel",value:function(){var e=this.diagram,t=this.panel,n=e.frontRootGroup;t&&n.removeChild(t),e.signal.addVertexPanelVisibility=!1,this.direction=null,this.line=null,this.sourceCell=null}},{key:"adjustPanelPosition",value:function(e){var t=this.diagram,n=this.direction,r=this.panel,a=t.viewportContainer.getBoundingClientRect(),i=r.getBBox(),o=t.viewport.invertViewport([a.width-i.width-8,a.height-i.height-8]),c=Math.min(e[0]+8,o[0]),l=Math.min(e[1]+8,o[1]);return"N"===n?c<e[0]+8&&(c=e[0]-8-i.width):"E"===n?c<e[0]+8&&l<e[1]+8&&(l=e[1]-8-i.height):"S"===n?c<e[0]+8&&l<e[1]+8&&(c=e[0]-8-i.width):"W"===n&&l<e[1]+8&&(l=e[1]-8-i.height),[c,l]}},{key:"adjustVertexPosition",value:function(e,t,n,r){var a,i,o=this.direction,c=this.sourceCell,l=b()(e,2),s=l[0],u=l[1],d=(n.width||2)/2;switch(t===c.shape?(a=c.width,i=c.height):(a=r.width,i=r.height),o){case"N":s-=a/2,u-=i+d;break;case"E":s+=d,u-=i/2;break;case"S":u+=d,s-=a/2;break;case"W":s-=a+d,u-=i/2}return[s,u]}},{key:"getDirection",value:function(e){var t=ln(e.d).slice(-2),n=t[0].slice(1),r=t[1].slice(1);return Fi({x:n[0],y:n[1]},{x:r[0],y:r[1]})}},{key:"updatePanel",value:function(e){var t=this.diagram,n=t.frontRootGroup,r=e.line,a=e.sourceCell,i=oc.find((function(e){return e.name===a.shape})),o=(null==i?void 0:i.category)||"basic",c=new ih({groups:["latest",o]});c.css({filter:"url(#".concat(this.filterId,")")}),this.panel=c,this.panel.on("shape:select",this.onShapeSelect),n.add(this.panel),this.line=r,this.sourceCell=a,this.direction=this.getDirection(r);var l=r.target.connection,s=this.adjustPanelPosition(l),u=b()(s,2),d=u[0],f=u[1],h=1/t.viewport.zoom;this.panel.update({matrix:[h,0,0,0,h,0,d,f,1]}),t.signal.addVertexPanelVisibility=!0}},{key:"init",value:function(e){var t=this;this.diagram=e,this.line=null,this.sourceCell=null,this.direction=null,this.initPanel(),this.bind(e,"vertexcell:prompt",(function(e){return t.updatePanel(e)})),this.bind(e,"mousedown",(function(e){var n=t.panel;n&&!n.rendererElement.contains(e.target)&&t.closePanel()})),this.bind(e,"keyup",(function(e){!t.panel||"Esc"!==e.key&&"Escape"!==e.key||t.closePanel()}))}}]),n}();function sh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var uh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"onMouseMove",(function(t){e.delegation||e.initDelegation();var n=E()(e).delegation,r=e.getPoint(t),a=b()(r,2),i=a[0],o=a[1];n.translate(i,o)})),c()(E()(e),"onClick",(function(t){e.clear();var n=E()(e).diagram,r=n.settings.image,a=r.insertFiles,i=r.insertModel,o=e.getPoint(t),c=b()(o,2),l=c[0],s=c[1];n.interaction.changeMode("edit"),n.emit("importimage",{files:a,x:l,y:s,from:"clickinsert",width:i.width,height:i.height})})),e}return v()(n,[{key:"getPoint",value:function(e){return this.diagram.viewport.invertClient([e.clientX,e.clientY])}},{key:"initDelegation",value:function(){var e=this.diagram,t=e.settings.image,n=e.add(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:"image",x:0,y:0},t.insertModel))[0];this.delegation=e.delegator.create([n]),this.cell=n,n.hide()}},{key:"init",value:function(e){var t=this;this.diagram=e,this.bind(e,"mousemove",this.onMouseMove),this.bind(e,"click",this.onClick),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(t.clear(),e.interaction.changeMode("edit"))})),this.bind(window,"mousedown",(function(n){e.canvas.rendererElement.contains(n.target)||(t.clear(),e.interaction.changeMode("edit"))}))}},{key:"clear",value:function(){var e=this.cell,t=this.delegation,n=this.diagram;e&&!e.destroyed&&n.remove(e.model.id),t&&t.destroy(),this.cell=null,this.delegation=null}},{key:"unbind",value:function(){this.clear(),I()(L()(n.prototype),"unbind",this).call(this)}}]),n}();function dh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var hh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"line",void 0),c()(E()(e),"source",void 0),c()(E()(e),"target",void 0),c()(E()(e),"onMouseDown",(function(t){var n=E()(e).diagram,r=e.getPoint(t);e.source=n.connect.findEndPoint(r)})),c()(E()(e),"onMouseMove",(function(t){var n=E()(e),r=n.diagram,a=n.line,i=n.source,o=e.getPoint(t),c=r.connect.findEndPoint(o);if(a){var l=r.lineResizer.resize(t);r.update(a,{target:l})}else i&&function(e,t){return t.id!==e.id||(t.connection&&e.connection?ro(t.connection[0],t.connection[1],e.connection[0],e.connection[1])>8:void 0)}(i,c)&&e.beginInsertLine({source:i,target:c})})),c()(E()(e),"onMouseUp",(function(){var t=E()(e),n=t.diagram,r=t.line;e.clear(),n.interaction.changeMode("edit"),r&&n.command.execute("Add",{model:fh(fh({},r.model),{},{id:null})})})),e}return v()(n,[{key:"getPoint",value:function(e){return this.diagram.viewport.invertClient([e.clientX,e.clientY])}},{key:"beginInsertLine",value:function(e){var t=e.source,n=e.target,r=this.diagram;t.id&&(t.connection=null);var a=te()({},r.settings.line,{type:"line",source:t,target:fh({},n)});r.hooks.decorateAddLineModel.call(a);var i=r.add(a)[0];this.line=i,r.lineResizer.init(i,"target")}},{key:"init",value:function(e){var t=this;this.diagram=e,this.bind(e,"begininsertline",(function(e){t.beginInsertLine(e)})),this.bind(e,"mousemove",this.onMouseMove),this.bind(e,"mousedown",this.onMouseDown),this.bind(e,"mouseup",this.onMouseUp),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(t.clear(),e.interaction.changeMode("edit"))}))}},{key:"clear",value:function(){var e=this.line,t=this.diagram;t&&(t.lineResizer.reset(),e&&t.remove(e),this.line=void 0,this.source=void 0)}},{key:"unbind",value:function(){this.clear(),I()(L()(n.prototype),"unbind",this).call(this)}}]),n}();function ph(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ph(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ph(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"delegation",void 0),c()(E()(e),"cell",void 0),c()(E()(e),"lastSwimlane",void 0),c()(E()(e),"onMouseMove",(function(t){e.delegation||e.initDelegation();var n=E()(e).diagram,r=E()(e).delegation,a=e.getPoint(t),i=b()(a,2),o=i[0],c=i[1];if(e.cell){var l;e.cell.matrix=[1,0,0,0,1,0,o,c,1];var s,u=null===(l=n.swimlane)||void 0===l?void 0:l.findSwimlane([e.cell]);if(u&&u!==e.lastSwimlane)null===(s=n.swimlane)||void 0===s||s.highlight(u);else if(!u){var d;null===(d=n.swimlane)||void 0===d||d.unhighlight()}e.lastSwimlane=u}null==r||r.translate(o,c)})),c()(E()(e),"onClick",(function(t){var n=E()(e).diagram;e.clear();var r=n.settings.vertex,a=e.getPoint(t),i=b()(a,2),o=i[0],c=i[1],l=Object(F.a)(),s=oc.find((function(e){return e.name===r.shape})),u={model:mh(mh({},r),{},{id:l,x:o,y:c})};null!=s&&s.controlPoints&&(u.model.controlPoints=s.controlPoints),null!=s&&s.round&&(u.model.round=s.round);var d="Add";if(n.interaction.changeMode("edit"),s)if("stack"===r.type)d="AddStack",u.model.row=s.row,u.htmls=s.htmls,delete u.model.html;else if("swimlane"===r.type)d="AddSwimlane",u.number=s.number,u.model.widths=s.widths,u.model.heights=s.heights,u.htmls=s.htmls,u.stencil=s,delete u.model.html;else if("dsl"===r.type){var f;d="AddDsl";var h=null===(f=s.parse)||void 0===f?void 0:f.call(s,s.htmls);u.models=null==h?void 0:h.models,delete u.model.html}n.hooks.decorateAddVertexModel.call(u.model),n.command.execute(d,u),delete r.fill,delete r.stroke,delete r.controlPoints,delete r.round})),e}return v()(n,[{key:"init",value:function(e){var t=this;this.diagram=e,this.bind(e,"mousemove",this.onMouseMove),this.bind(e,"click",this.onClick),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(t.clear(),e.interaction.changeMode("edit"))})),this.bind(window,"mousedown",(function(n){e.canvas.rendererElement.contains(n.target)||(t.clear(),e.interaction.changeMode("edit"))}))}},{key:"getPoint",value:function(e){return this.diagram.viewport.invertClient([e.clientX,e.clientY])}},{key:"initDelegation",value:function(){var e=this.diagram,t=e.settings.vertex,n=oc[oc.findIndex((function(e){return e.name===t.shape}))],r={};"swimlane"===(null==n?void 0:n.type)&&(r.number=n.number,r.widths=n.widths,r.heights=n.heights,r.htmls=n.htmls);var a=mh(mh(mh({},t),r),{},{x:0,y:0});e.hooks.decorateAddVertexModel.call(a);var i=e.add(a)[0];this.delegation=e.delegator.create([i]),this.cell=i,i.hide()}},{key:"clear",value:function(){var e,t=this.cell,n=this.delegation,r=this.diagram;null==r||null===(e=r.swimlane)||void 0===e||e.unhighlight(),t&&!t.destroyed&&r.remove(t.model.id),n&&n.destroy(),this.cell=null,this.delegation=null}},{key:"unbind",value:function(){this.clear(),I()(L()(n.prototype),"unbind",this).call(this)}}]),n}();var vh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"dblclick",(function(t){var n=e.viewport.invertClient([t.clientX,t.clientY,1]),r=e.getCell(t.target);if(r&&r.isGroup){var a=e.groupManager.enter(r,{x:n[0],y:n[1]});a&&e.selector.select(a)}})),this.bind(e,"afterselect",(function(t){e.groupManager.group&&0===t.selections.length&&e.groupManager.exit()}))}}]),n}();var gh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n,r,a,i=!1;function o(){i=!1,t=0,n=0,r=0,a=0,e.input.style.display=""}this.bind(e,"dragstart",(function(o){var c=o.evt;i=!0,t=c.clientX,n=c.clientY,r=e.viewport.scrollLeft,a=e.viewport.scrollTop,e.input.style.display="none"})),this.bind(e,"drag",pe()((function(o){var c=o.evt;if(i){var l=r-(c.clientX-t),s=a-(c.clientY-n);e.viewport.setScroll(l,s)}}),16)),this.bind(e,"dragend",(function(){o()})),this.bind(e,"mouseleave",(function(){o()}))}}]),n}();var bh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),e=t.call(this),c()(E()(e),"default",void 0),c()(E()(e),"diagram",void 0),c()(E()(e),"selectedCells",void 0),c()(E()(e),"dragCells",void 0),c()(E()(e),"startBox",void 0),c()(E()(e),"originModels",void 0),c()(E()(e),"dragClone",void 0),c()(E()(e),"dragCloneModels",void 0),c()(E()(e),"dx",0),c()(E()(e),"dy",0),c()(E()(e),"startClient",void 0),c()(E()(e),"startPoint",void 0),c()(E()(e),"onMouseMoveEvent",void 0),e.default={selectedCells:void 0,dragClone:void 0,dragCells:void 0,startPoint:void 0,startBox:void 0,originModels:void 0,startClient:void 0,onMouseMoveEvent:void 0,dx:0,dy:0},Object.assign(E()(e),e.default),e}return v()(n,[{key:"reset",value:function(){var e=this.diagram;this.dragCells&&this.dragCells.length>1&&e.highlight.show(),this.onMouseMoveEvent&&this.unbind(this.onMouseMoveEvent),e.signal.cellDragStart=!1,e.align.clear(),Object.assign(this,this.default)}},{key:"initDragData",value:function(){var e=this.diagram;if(!e.contentEditor.isBegin){var t=e.selector.selections;if(1!==t.length||!xn(t[0])||!t[0].isConnected()){var n,r=e.selector.selections.filter((function(e){return e}));if(e.signal.keydown.Alt){var a=r.sort((function(e,t){return e.getZIndex()-t.getZIndex()})).map((function(e){return s()(e.model)}));a.forEach((function(e){"swimlane"===e.type&&(e.contain=[])})),n=e.add(e.importer.clone(a)),this.dragClone=!0,this.dragCloneModels=a}else n=r;var i=n[0];1!==n.length||i.isLine?n.length>1&&e.align.updateToAlginPoints(n):e.align.updateToAlginPoints(i),1!==n.length||i.isLine?n.length>1&&(this.startBox=Tn(n)):(this.startBox=i.getBBox(),n=n.filter((function(e){return!xn(e)||["source","target"].every((function(t){return!e[t].id}))})));var o=wf(n),c=o.stems,l=o.originModels;this.selectedCells=n,e.align.prepareForDistribute(n),this.dragCells=c,this.originModels=l}}}},{key:"getCurrentBox",value:function(){return{minX:this.startBox.minX+this.dx,maxX:this.startBox.maxX+this.dx,minY:this.startBox.minY+this.dy,maxY:this.startBox.maxY+this.dy}}},{key:"init",value:function(){var e,t,n=this,r=this.diagram,a=function(){return Hd(n.originModels,n.dx,n.dy)},i=pe()((function(i){if(r.signal.cellDragStart){var o,c=r.viewport.invertClient([i.clientX,i.clientY]);if(n.dx=c[0]-n.startPoint[0],n.dy=c[1]-n.startPoint[1],n.startBox){var l=r.align.alignByBox(n.getCurrentBox());n.dx+=l.dx,n.dy+=l.dy,l=r.align.alignDistribute(n.getCurrentBox()),n.dx+=l.dx,n.dy+=l.dy}var s,u=a();if(r.update(n.dragCells,u),(t=null===(o=r.swimlane)||void 0===o?void 0:o.findSwimlane(n.dragCells))&&e!==t)null===(s=r.swimlane)||void 0===s||s.highlight(t);else if(!t){var d;null===(d=r.swimlane)||void 0===d||d.unhighlight()}e=t}else{if(ro(n.startClient[0],n.startClient[1],i.clientX,i.clientY)<8)return;if(n.initDragData(),!n.dragCells)return;r.signal.cellDragStart=!0,r.emit("cell:dragstart"),n.dragCells.length>1&&r.highlight.hide(),1===n.dragCells.length&&r.contentEditor&&(r.contentEditor.unbind(),r.focus())}}),16),o=function(){var e,t,o=n.selectedCells,c=n.originModels,l=n.dragCloneModels,s=[],u=function(){var e=o.map((function(e){return e.model.id})).map((function(e){return r.find(e)})).filter((function(e){return e}));r.selector.select(e)};if(n.dragClone)r.remove(o),Gd(l,n.dx,n.dy),s.push("Add",{model:l,select:u});else{var d,f=a(),h=null===(d=r.swimlane)||void 0===d?void 0:d.findSwimlane(n.dragCells);(n.dragCells.some((function(e){return e.swimlane}))||h)&&n.dragCells.every((function(e){return!Sn(e)}))?s.push("InteractSwimlane",{id:n.dragCells,model:f,parent:h,select:u,originModels:c}):s.push("Update",{id:n.dragCells.map((function(e){return e.model.id})),model:f,select:u,originModels:c})}r.emit("cell:dragend",{cells:n.dragCells}),i.cancel(),n.reset(),(e=r.command).execute.apply(e,s),null===(t=r.swimlane)||void 0===t||t.unhighlight()},c=function(){var t;e=void 0,null===(t=r.swimlane)||void 0===t||t.unhighlight(),i.cancel(),n.reset()};this.bind(r,"mousedown",(function(e){if(!r.signal.lineTextMouseDown){var t=e.target,a=e.clientX,o=e.clientY,c=e.button,l=r.getCell(t);0===c&&l&&l.isStem&&(n.startClient=[a,o],n.startPoint=r.viewport.invertClient([a,o]),n.onMouseMoveEvent=n.bind(r,"mousemove",i))}})),this.bind(r,"mouseup",(function(){n.dragCells&&n.dragCells[0]&&r.signal.cellDragStart?o():c()})),this.bind(r,"mouseleave",(function(){n.dragCells&&n.dragCells[0]&&r.signal.cellDragStart?o():c()}))}}]),n}();var xh=aa,kh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"unbindMousemoveEvent",value:function(){this.mouseMoveEvent&&(this.unbind(this.mouseMoveEvent),this.mouseMoveEvent=void 0)}},{key:"init",value:function(e){var t,n,r,a=this;e.signal.mouseMultiSelecting=!1;var i=new xh({fill:nr,stroke:wr});function o(a){if(t){e.signal.mouseMultiSelecting=!0,n=e.viewport.invertClient([a.clientX,a.clientY]);var o={minX:Math.min(t[0],n[0]),minY:Math.min(t[1],n[1]),width:Math.abs(n[0]-t[0]),height:Math.abs(n[1]-t[1])};o.maxX=o.minX+o.width,o.maxY=o.minY+o.height;var c=un(o.minX,o.minY,o.width,o.height);i.update({d:c}),r=e.groupManager.getCells().filter((function(e){if(e.state.visible&&e.state.capture){var t=En(e)?e.getKeyShapeBox():e.getBBox();if(to(t,o)){if(Sn(e))return eo(o,t);if(jn(e))return!1;if(xn(e)){var n=e.d;if(!eo(o,t)&&0===Ee()(c,n).length)return!1}return!0}}return!1})),vt(r,e.selector.selections)||e.selector.select(r)}}i.dataset({testid:"mouse-drag-multi-select"}),this.selectBox=i,this.bind(e,"mousedown",(function(n){(function(t){return 0===t.button&&(t.target===e.canvas.rendererElement||void 0)})(n)&&(a.unbindMousemoveEvent(),a.mouseMoveEvent=a.bind(window,"mousemove",pe()(o,16)),e.frontRootGroup.add(i),t=e.viewport.invertClient([n.clientX,n.clientY]))})),this.bind(window,"mouseup",(function(){t&&e.tryFocus(),e.signal.mouseMultiSelecting=!1,r&&r.length>0&&e.selector.select(r),r=void 0,t=void 0,n=void 0,a.unbindMousemoveEvent(),i.remove(),i.update({d:""})}))}},{key:"unbind",value:function(e){!e&&this.selectBox&&(this.selectBox.remove(),this.selectBox=void 0),I()(L()(n.prototype),"unbind",this).call(this,e)}}]),n}();var wh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"reset",value:function(){this.unbind()}},{key:"init",value:function(e){var t,n,r,a,i,o,c=this,l=!0;this.bind(e,"line:mousedown",(function(s){if(!e.contentEditor.isBegin&&xn(s.cell)&&s.target.closest("foreignObject")){e.selector.select([]),n=s.cell,e.signal.lineTextMouseDown=!0,i={textPosition:void 0===n.textPosition?.5:n.textPosition,textDirection:void 0===n.textDirection?"center":n.textDirection};var u=n.getKeyShape();t=c.bind(e,"mousemove",pe()((function(t){if(n&&u)if(l){e.selector.select([]),l=!1;var i="curve"===n.shape?u.getTotalLength()/500:1.5;o=function(e,t){for(var n,r=e.getTotalLength(),a=[],i=[],o=0;o<=r;o+=t)n=e.getPointAtLength(o),a.push([n.x,n.y]),i.push(o/r);return{points:a,percentages:i}}(u,i)}else if(o){var c=e.viewport.invertClient([t.x,t.y]),s=u.getClosestPoint(n.canvas2Relative(c),o.points),d=o.points[s],f=ro(c[0],c[1],d[0],d[1]);r=o.percentages[s];var h=1;if(f<=20)a="center",h=1;else if(f<=60){var p=n.getTwoPointsByPercent(r),m=b()(p,2),y=m[0],v=m[1],g=n.canvas2Relative(c),x=ko(g,y,v);a=x?"right":"left"}else r=void 0,h=.5;e.update(n,{textPosition:r,textDirection:a,opacity:h})}}),16))}}));var s=function(){e.signal.lineTextMouseDown=!1,t&&n&&(e.update(n,{opacity:1}),r&&n&&e.command.execute("Update",{id:n.model.id,model:{textPosition:r,textDirection:a},originModels:i}),c.unbind(t),t=void 0,n=void 0,i=void 0,l=!0,o=void 0,a=void 0,r=void 0)};this.bind(e,"mouseup",(function(){s()})),this.bind(e,"mouseleave",(function(){s()}))}}]),n}();var Ch=r.FileUtils.isImage,Ah=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"dragover",(function(e){e.preventDefault()})),this.bind(e,"drop",(function(t){t.preventDefault();var n=Array.from(t.dataTransfer.files).filter((function(e){return Ch(e)}));n[0]&&e.emit("importimage",{files:n,from:"drop"})}))}}]),n}();var Oh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"groupcellrect:mouseenter",(function(e){e.cell.hover(!0)})),this.bind(e,"groupcellrect:mouseleave",(function(e){e.cell.hover(!1)}))}}]),n}();var Eh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=this;this.bind(e,"mouseenter",(function(){e.signal.mouseenter=!0})),this.bind(e,"mouseleave",(function(){e.signal.mouseenter=!1})),this.bind(e,"mousedown",(function(){t.mousemovePrevent=t.bind(e,"mousemove",(function(t){e.signal.dragging||(e.signal.dragging=!0)}))})),this.bind(e,"mouseup",(function(){e.signal.dragging=!1,t.mousemovePrevent&&t.unbind(t.mousemovePrevent)}))}}]),n}();var Ph=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"beforecommandexecute",(function(t){var n=t.commandName,r=t.command;if("Add"===n&&"line"===r.model.type){var a={};te()(a,e.settings.line,r.model),r.model=a}})),this.bind(e,"aftercommandexecute",(function(t){var n=t.command;if("Update"===t.commandName&&1===(null==n?void 0:n.id.length)&&n.id[0].isLine){var r,a,i=n.id[0];e.settings.line={shape:i.shape,stroke:i.stroke,target:{marker:null==i||null===(r=i.target)||void 0===r?void 0:r.marker},source:{marker:null==i||null===(a=i.source)||void 0===a?void 0:a.marker}}}}))}}]),n}();var Sh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",new Zr),e}return v()(n,[{key:"init",value:function(e){var t=this,n=new xa({fill:"#fff","dominant-baseline":"hanging"});n.css({fontFamily:"system-ui",fontSize:"".concat(12,"px")});var r=new aa({fill:"rgba(0,0,0,0.7)",stroke:"none"});this.group.add(r),this.group.add(n),this.group.hide(),e.frontRootGroup.add(this.group),this.bind(e,"cellrotate",(function(a){var i=a.cell,o="".concat(a.rotate,"°"),c=1/e.viewport.zoom,l=8*c,s=4*c,u=24*c,d=3*c,f=12*c,h=e.font.measureTextLength(o,{fontSize:"".concat(f,"px")})+l+s,p=16*c,m=i.x,y=i.y,v=i.width,g=i.height,b=i.rotate,x=new Yt({x:m,y:y,w:v,h:g,r:b}),k=x.center.x,w=Math.max(x.tl.y,x.tr.y,x.bl.y,x.br.y)+u,C=4*c,A=h/2,O=p/2,E=A<C?A:C,P=O<C?O:C;r.update({d:un(k-h/2,w,h,p,E,P)}),n.update({x:k-h/2+l,y:w+d,text:o}),n.css({fontSize:"".concat(f,"px")}),t.group.show()})),this.bind(e,"mouseup",(function(){t.group.hide()}))}},{key:"reset",value:function(){this.group.clear(),this.unbind()}}]),n}();var jh=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"manager",void 0),e}return v()(n,[{key:"init",value:function(e){if(U.ua.mobile){var t=e.viewport,n=new Se.a.Manager(e.canvasContainer);this.manager=n;var r=new Se.a.Pan,a=new Se.a.Pinch({enable:!0}),i=new Se.a.Tap({event:"doubleTap",taps:2});n.add(a),n.add(i),n.add(r);var o=1,c=t.scrollLeft,l=t.scrollTop;n.on("panstart",(function(){c=t.scrollLeft,l=t.scrollTop})),n.on("panmove",(function(e){t.setScroll(c-e.deltaX,l-e.deltaY)})),n.on("pinchstart",(function(){o=t.zoom})),n.on("pinchmove",(function(e){t.setViewport(e.scale-1+o,[e.center.x,e.center.y])})),n.on("doubleTap",(function(){t.autoFit()}))}}},{key:"reset",value:function(){var e;null===(e=this.manager)||void 0===e||e.destroy()}}]),n}(),Rh=function(){function e(t){m()(this,e),c()(this,"diagram",void 0),c()(this,"lineCache",void 0),this.diagram=t}return v()(e,[{key:"reset",value:function(){this.diagram.update(this.lineCache.map((function(e){return e.id})),this.lineCache)}},{key:"pin",value:function(){var e=this.diagram;this.lineCache.map((function(t){return e.find(t.id)})).filter((function(e){return e})).forEach((function(e){var t=e.source,n=e.target,r=e.diagram,a=ln(e.wireElement.attr("d")),i={};if(r.find(t.id)||(i.source={id:null,connection:[a[0][1],a[0][2]]}),!r.find(n.id)){var o=a.length-1,c=a[o].length;i.target={id:null,connection:[a[o][c-2],a[o][c-1]]}}e.update(i)}))}},{key:"cache",value:function(e){var t=this.diagram,n=e.reduce((function(e,t){return"string"==typeof t?e[t]=!0:t.getAllCells().forEach((function(t){e[t.model.id]=!0})),e}),{});this.lineCache=t.getCells().filter((function(e){if(e.isLine){var t=e.model,r=t.target.id,a=t.source.id;return r&&n[r]||a&&n[a]}return!1})).map((function(e){var t=e.model,n={id:t.id,target:s()(t.target),source:s()(t.source)};return n.target.connection||(n.target.connection=null),n.source.connection||(n.source.connection=null),n}))}}]),e}();var Mh=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).pinLine=new Rh(e.diagram),r}return v()(n,[{key:"selectParent",value:function(){var e=this.diagram,t=this.changeArguments,n=e.find(t[0][0].id).parent;this.select(n&&n.model.id)}},{key:"findNearestCell",value:function(){var e=this.diagram,t=this.changeArguments,n=e.find(t[0][0].id),r=[];if(!En(n))return r;var a=n.parent;if(t[0].length>1&&a)return r.push(a.model.id),r;if(1===t[0].length&&a){var i=a.getChildren().filter((function(e){return e.upSignX===n.upSignX&&e.upSignY===n.upSignY})),o=i.indexOf(n);if(a.model.children){var c=i[o-1];if(c)return r.push(c.model.id),r;var l=i[o+1];if(l)return r.push(l.model.id),r}return r.push(a.model.id),r}return r}},{key:"execute",value:function(){var e=this.diagram,t=this.id,n=this.pinLine,r=yn(t,{}),a=r[0].map((function(t){return e.find(t)}));a.forEach((function(t,n){r[0][n]=s()(t.model),r[1][n]=e.getCellOptions(t)})),this.changeArguments=r,n.cache(a),this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.changeArguments,n=this.pinLine,r=this.findNearestCell();e.remove(t[0].map((function(e){return e.id}))),this.select(r),e.tryFocus(),n.pin()}},{key:"backward",value:function(){var e=this.diagram,t=this.changeArguments,n=this.pinLine,r=e.add.apply(e,D()(t));n.reset(),this.select(r),e.tryFocus()}}]),n}();function Lh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}c()(Mh,"className","Remove");var Bh=function(e){S()(n,Mh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"diagram",void 0),c()(E()(r),"deletedCells",void 0),c()(E()(r),"records",void 0),r.diagram=e.diagram,r}return v()(n,[{key:"execute",value:function(){var e=this;this.cells||(this.cells=this.diagram.selector.selections);var t=this.cells;this.id=[],this.records=new Map,this.deletedCells=new Set,this.deletedSwimlanes=new Set,t.forEach((function(t){var n=e.diagram.find(t);n&&n.canDelete()&&(e.id.push(n.model.id),e.deletedCells.add(n.model.id))})),I()(L()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var e=this,t=this.diagram,r=new Set;this.deletedCells.forEach((function(n){var a=t.find(n);if(a){var i=li(a);if(Sn(i))i.model.contain.forEach((function(n){if(!e.deletedCells.has(n)){var r=t.find(n);r&&(t.swimlane.unbind(r,i),e.records.set(r.model.id,i.model.id))}}));else if(e.deletedCells.has(i.model.id)&&!r.has(i.model.id)&&i.swimlane&&!e.deletedCells.has(i.swimlane)){var o=t.find(i.swimlane);o&&(r.add(o.model.id),t.swimlane.unbind(i,o),e.records.set(i.model.id,o.model.id))}}})),I()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){I()(L()(n.prototype),"backward",this).call(this);var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Lh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lh(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(this.records.entries());try{for(t.s();!(e=t.n()).done;){var r=b()(e.value,2),a=r[0],i=r[1];this.diagram.swimlane.bind(a,i)}}catch(e){t.e(e)}finally{t.f()}}}]),n}();c()(Bh,"className","Delete"),c()(Bh,"enable",(function(e){return!0}));var Dh=function(e){S()(n,Bh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){Ec(this.e,this.diagram),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Dh,"className","Cut"),c()(Dh,"isModelChange",!0);var Nh=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this);var e=this.diagram,t=this.lineId,r=this.model,a=e.find(t);this.originTarget=["id","connection","marker"].reduce((function(e,t){var n=a.target[t];return e[t]=null==n?null:n,e}),{}),e.update(a,{target:{id:r.id,connection:null}})}},{key:"forward",value:function(){I()(L()(n.prototype),"forward",this).call(this);var e=this.diagram,t=this.lineId,r=this.model,a=e.find(t);a&&!a.destroyed&&e.update(a,{target:{id:r.id,connection:null}})}},{key:"backward",value:function(){var e=this.diagram,t=this.lineId,n=this.originTarget,r=this.model,a=e.find(t);e.remove(r.id),a&&!a.destroyed&&e.update(a.model.id,{target:n}),this.select()}}]),n}();function Ih(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Th(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ih(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ih(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Nh,"className","AddVertex");var _h=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.attr,n=this.shape||"rect",r=oc[oc.findIndex((function(e){return e.name===n}))],a=r.type||"geometry",i=r.category,o=r.html||Id,c=r.controlPoints||void 0,l=r.round||void 0;Object.assign(e.settings.vertex,Th(Th({},t),{},{type:a,html:o,shape:n,category:i,controlPoints:c,round:l})),e.selector.clear(),e.interaction.changeMode(Rr)}}],[{key:"enable",value:function(){return!0}}]),n}();c()(_h,"className","BeginInsertGeometry"),c()(_h,"isModelChange",!1);var Fh=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.model,n=this.files;e.settings.image.insertModel=t,e.settings.image.insertFiles=n,e.selector.clear(),e.interaction.changeMode("beginInsertImage")}}],[{key:"enable",value:function(){return!0}}]),n}();function zh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Fh,"className","BeginInsertImage"),c()(Fh,"isModelChange",!1);var qh=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zh(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({html:zn("文本")},e)),r.queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.html,n=this.stroke;Object.assign(e.settings.vertex,{type:"text",html:t,stroke:n,shape:"text"}),e.selector.clear(),e.interaction.changeMode("beginInsertVertex")}}],[{key:"enable",value:function(){return!0}}]),n}();c()(qh,"className","BeginInsertText"),c()(qh,"isModelChange",!1);var Yh=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"arrange",value:function(){}},{key:"getArrangeTstem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=[],r=[];return e.forEach((function(e,a){var i=wf([e]),o=i.stems,c=i.originModels,l=t(a,e),s=l.dx,u=l.dy;r.push.apply(r,D()(o)),n.push.apply(n,D()(Hd(c,s,u)))})),{tStems:r,models:n}}},{key:"execute",value:function(){var e=this.diagram.selector.selections.concat([]),t=this.arrange(),r=t.tStems,a=t.models;this.id=r,this.model=a,this.selectedIds=e.map((function(e){return e.model.id})),I()(L()(n.prototype),"execute",this).call(this)}},{key:"select",value:function(){I()(L()(n.prototype),"select",this).call(this,this.selectedIds)}}]),n}();c()(Yh,"className","Arrange");var Hh=function(e){S()(n,Yh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"_getAlignCells",value:function(e){return e.filter((function(e){return e.canArrange()}))}},{key:"_getAlignCellPoints",value:function(e){var t=[];return e.forEach((function(e){var n=[],r=e.getAlignBBox();n.push([r.minX,r.minY]),n.push([r.maxX,r.maxY]),n.push([(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]),t.push(n)})),t}},{key:"arrange",value:function(){var e=this.diagram.selector.selections.concat([]),t=this._getAlignCells(e),n=this._getAlignCellPoints(t);return this.align(t,n)}},{key:"align",value:function(){}}]),n}();c()(Hh,"className","AlignBase"),c()(Hh,"enable",(function(e){return e.selector.selections.filter((function(e){return e.canArrange()})).length>1}));var Gh=function(e){S()(n,Hh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.max.apply(Math,D()(n.map((function(e){return e[1]}))));return this.getArrangeTstem(e,(function(e,n){var a=t[e];return{dx:0,dy:n.isLine?r-Math.max.apply(Math,D()(a.map((function(e){return e[1]})))):r-a[1][1]}}))}}]),n}();c()(Gh,"className","AlignBottom");var Xh=function(e){S()(n,Hh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n,r=e.map((function(e){return e.getAlignBBox()})),a=dt(r,"width");if(r.every((function(e){return e.minX>=a.minX&&e.maxX<=a.maxX})))n=a.x+a.width/2;else{var i=t.reduce((function(e,t){return e.concat([t[2]])}),[]).map((function(e){return e[0]}));n=(Math.max.apply(Math,D()(i))+Math.min.apply(Math,D()(i)))/2}return this.getArrangeTstem(e,(function(e,r){var a=t[e];return{dx:(r.isLine,n-a[2][0]),dy:0}}))}}]),n}();c()(Xh,"className","AlignHCenter");var Vh=function(e){S()(n,Hh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.min.apply(Math,D()(n.map((function(e){return e[0]}))));return this.getArrangeTstem(e,(function(e,n){var a=t[e];return{dx:n.isLine?r-Math.min.apply(Math,D()(a.map((function(e){return e[0]})))):r-a[0][0],dy:0}}))}}]),n}();c()(Vh,"className","AlignLeft");var Wh=function(e){S()(n,Hh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.max.apply(Math,D()(n.map((function(e){return e[0]}))));return this.getArrangeTstem(e,(function(e,n){var a=t[e];return{dx:n.isLine?r-Math.max.apply(Math,D()(a.map((function(e){return e[0]})))):r-a[1][0],dy:0}}))}}]),n}();c()(Wh,"className","AlignRight");var Zh=function(e){S()(n,Hh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n=t.reduce((function(e,t){return e.concat(t)}),[]),r=Math.min.apply(Math,D()(n.map((function(e){return e[1]}))));return this.getArrangeTstem(e,(function(e,n){var a=t[e];return{dx:0,dy:n.isLine?r-Math.min.apply(Math,D()(a.map((function(e){return e[1]})))):r-a[0][1]}}))}}]),n}();c()(Zh,"className","AlignTop");var Uh=function(e){S()(n,Hh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"align",value:function(e,t){var n,r=e.map((function(e){return e.getAlignBBox()})),a=dt(r,"height");if(r.every((function(e){return e.minY>=a.minY&&e.maxY<=a.maxY})))n=a.y+a.height/2;else{var i=t.reduce((function(e,t){return e.concat([t[2]])}),[]).map((function(e){return e[1]}));n=(Math.max.apply(Math,D()(i))+Math.min.apply(Math,D()(i)))/2}return this.getArrangeTstem(e,(function(e,r){var a=t[e];return{dx:0,dy:(r.isLine,n-a[2][1])}}))}}]),n}();c()(Uh,"className","AlignVCenter");var Kh=function(e){S()(n,Yh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"distribute",value:function(){}},{key:"arrange",value:function(){var e=this.diagram.selector.selections.filter((function(e){return e.canArrange()}));return this.distribute(e)}}]),n}();c()(Kh,"enable",(function(e){return e.selector.selections.filter((function(e){return e.canArrange()})).length>2}));var Qh=function(e){S()(n,Kh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"distribute",value:function(e){var t=e.length,n=e.map((function(e){return{cell:e,box:e.getAlignBBox()}}));n=n.sort((function(e,t){return e.box.minX-t.box.minX}));var r=Math.min.apply(Math,D()(n.map((function(e){return e.box.minX})))),a=(Math.max.apply(Math,D()(n.map((function(e){return e.box.maxX}))))-r-n.reduce((function(e,t){return e+t.box.width}),0))/(t-1),i=n[0].box;e=n.map((function(e){return e.cell}));var o=0;return this.getArrangeTstem(e,(function(e){var t=0;if(e>0){var r=n[e-1],c=n[e];o=o+a+r.box.width,t=i.minX+o-c.box.minX}return{dx:t,dy:0}}))}}]),n}();c()(Qh,"className","DistributeHorizontally");var Jh=function(e){S()(n,Kh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"distribute",value:function(e){var t=e.length,n=e.map((function(e){return{cell:e,box:e.getAlignBBox()}}));n=n.sort((function(e,t){return e.box.minY-t.box.minY}));var r=Math.min.apply(Math,D()(n.map((function(e){return e.box.minY})))),a=(Math.max.apply(Math,D()(n.map((function(e){return e.box.maxY}))))-r-n.reduce((function(e,t){return e+t.box.height}),0))/(t-1),i=n[0].box;e=n.map((function(e){return e.cell}));var o=0;return this.getArrangeTstem(e,(function(e){var t=0;if(e>0){var r=n[e-1],c=n[e];o=o+a+r.box.height,t=i.minY+o-c.box.minY}return{dx:0,dy:t}}))}}]),n}();c()(Jh,"className","DistributeVertically");var $h=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.diagram,r=n.selector.selections.filter((function(e){return e.isStem}));r.sort(t);var a=r.map((function(e){return e.model.id})),i=r.map((function(e){return n.getCellOptions(e)}));r.forEach((function(t){t[e]()}));var o=r.map((function(e){return n.getCellOptions(e)}));this.beforeCellOptions=i,this.afterCellOptions=o,this.id=a,this.select(a)}},{key:"backward",value:function(){var e=this.diagram,t=this.id,n=this.beforeCellOptions;e.update(t,{},n),this.select(t)}},{key:"forward",value:function(){var e=this.diagram,t=this.id,n=this.afterCellOptions;e.update(t,{},n),this.select(t)}}]),n}();c()($h,"className","ZIndex");var ep=function(e){S()(n,$h);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"backward",(function(e,t){return e.getZIndex()-t.getZIndex()}))}}]),n}();c()(ep,"className","Backward");var tp=function(e){S()(n,$h);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"forward",(function(e,t){return t.getZIndex()-e.getZIndex()}))}}]),n}();c()(tp,"className","Forward");var np=function(e){S()(n,$h);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"toBack",(function(e,t){return t.getZIndex()-e.getZIndex()}))}}]),n}();c()(np,"className","ToBack");var rp=function(e){S()(n,$h);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,"toFront",(function(e,t){return e.getZIndex()-t.getZIndex()}))}}]),n}();c()(rp,"className","ToFront");var ap=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.x,t=this.y,r=this.diagram;this.model={type:"geometry",html:Id,shape:"rect",x:e,y:t},r.hooks.decorateAddVertexModel.call(this.model),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(ap,"className","InsertGeometry"),c()(ap,"enable",(function(e){return"edit"===e.interaction.currentMode}));var ip=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.x,t=this.y,r=this.image,a=this.diagram,i=r.naturalWidth/r.naturalHeight,o=this.width||Math.min(r.naturalWidth,1e3,1e3*i),c=this.height||o/i,l=a.viewport.getCenter();this.model={type:"image",image:r,width:o,height:c,x:null==e?l[0]:e,y:null==t?l[1]:t,constraints:{proportion:!0}},I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(ip,"className","InsertImage"),c()(ip,"enable",(function(e){return e.interaction.currentMode!==Er}));var op=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.x,t=this.y,r=this.diagram;this.model={type:"text",html:zn("文本"),x:e,y:t},r.hooks.decorateAddVertexModel.call(this.model),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(op,"className","InsertText"),c()(op,"enable",(function(e){return"edit"===e.interaction.currentMode}));var cp=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){this.diagram.contentEditor.execCommand("createLink",zn("链接"))}}]),n}();c()(cp,"className","AttachLink"),c()(cp,"enable",(function(e){var t=e.getCell(e.contentEditor.dom);return e.contentEditor.getRange()&&t}));var lp=r.FileUtils.isImage;function sp(e){var t=e.model,n=e.offset;t.x=(t.x||0)+n[0],t.y=(t.y||0)+n[1]}var up={text:{lake:sp,text:function(e){var t=e.text,n=e.focusPoint;return[{type:"text",html:t,x:n[0],y:n[1]}]},textIndex:1},geometry:{lake:sp},stack:{lake:sp},image:{lake:sp},dsl:{lake:sp},group:{lake:function(e){var t=e.model,n=e.offset;Gd([t],n[0],n[1])}},line:{lake:function(e){var t=e.extraInformation,n=e.extraInformations,r=e.offset,a=e.model,i=t.points;["source","target"].forEach((function(e){var t=a[e];if(!t.id&&t.connection&&(t.connection[0]+=r[0],t.connection[1]+=r[1]),t.id&&!n[t.id]){var o="source"===e?i[0]:i[i.length-1];t.connection=[o.x+r[0],o.y+r[1]],delete t.id}})),a.controlPoints&&a.controlPoints.forEach((function(e){e[0]+=r[0],e[1]+=r[1]}))}},freehand:{lake:function(e){var t=e.model,n=e.offset;t.points.forEach((function(e){e[0]+=n[0],e[1]+=n[1]}))}},pen:{lake:function(e){var t=e.model,n=e.offset;t.points.forEach((function(e){e[0]+=n[0],e[1]+=n[1]}))}}},dp=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"_getOptions",value:function(e,t){var n=this.diagram.groupManager.group;return e.map((function(e,r){var a=Object.assign(e.options||{},t[r]);return delete e.options,n&&!a.parent&&(a.parent=n.model.id),Object.assign(t[r],a)}))}},{key:"execute",value:function(){var e,t=this.diagram,n=this.e,r=n.clipboardData.getData("text/html"),a=n.clipboardData.getData("text/plain"),i=this.focusPoint,o=bl(r);if(i=i||t.viewport.getFocus(),o){var c=o.body,l=o.extraInformations,s=function(e,t,n){var r=[[],[]];return e.forEach((function(e){at(e,(function(e){var t=e.id,a=e.x,i=e.y,o=e.type,c=n[t];"line"===o?["source","target"].forEach((function(t){var n=e[t];if(null!=n&&n.id){var a=c.points,i="source"===t?a[0]:a[a.length-1];r[0].push(i.x),r[1].push(i.y)}else null!=n&&n.id||null==n||!n.connection||(r[0].push(n.connection[0]),r[1].push(n.connection[1]))})):"freehand"===o||"pen"===o?(r[0].push(c.topLeft[0]),r[1].push(c.topLeft[1])):(a=null==a?null==c?void 0:c.x:a,i=null==i?null==c?void 0:c.y:i,null!=a&&null!=i&&(r[0].push(a),r[1].push(i)))}))})),r[0]=[r[0].length>0&&Math.min.apply(Math,D()(r[0]))||0],r[1]=[r[1].length>0&&Math.min.apply(Math,D()(r[1]))||0],[t[0]-r[0][0],t[1]-r[1][0]]}(c,i,l);!function(e,t){var n=function(e){return"mindmap"===t[e.id].rootType},r=e.filter((function(e){return n(e)}));e.sort((function(e,t){return e.zIndex-t.zIndex})),e.forEach((function(e){at(e,(function(e){var t=e.children;t&&"group"===e.type&&t.sort((function(e,t){return e.zIndex-t.zIndex}))}))}));var a=0;e.forEach((function(t,i){n(t)&&(e[i]=r[a],a++)}))}(c,l);var u=di(c,l);t.hooks.forceDecorateImportModels.call(c),c.forEach((function(e){pu(e);var n=l[e.id];e.type||(e.type=n.rootType||"text","mindmap"===e.type&&t.hooks.decorateAddMindmapStemModel.call(e)),e.options={},at(e,(function(e){e.zIndex&&delete e.zIndex,"swimlane"===e.type&&(e.contain=e.contain.map((function(e){return u[e]})).filter((function(e){return e})))}));var r=up[e.type];r&&r.lake&&r.lake({model:e,extraInformation:n,extraInformations:l,offset:s,diagram:t})}));var d={body:c,options:c.map((function(){return{}})),extraInfomations:l,offset:s};return t.emit("beforepaste:lake",d),void t.command.execute("Add",{model:d.body,cellOptions:this._getOptions(d.body,d.options)})}if(n.clipboardData.files.length>0&&(""===r&&/^.+\.\w+$/.test(a)||""===a&&/^(<meta.+?>)?<img.+?>$/.test(r)||!a||!r)&&(e=Array.from(n.clipboardData.files)),e){var f=Array.from(e).filter((function(e){return lp(e)}));f[0]&&t.emit("importimage",{files:f,from:"clipboard",x:i[0],y:i[1]})}else if(a){var h,p=Object.keys(up),m=[];p.forEach((function(e){var t,n=up[e].text;n&&m.push({textProcessor:n,textIndex:null!==(t=up[e].textIndex)&&void 0!==t?t:0})})),m.sort((function(e,t){return t.textIndex-e.textIndex})),m=m.map((function(e){return e.textProcessor}));for(var y=0;y<m.length&&!(h=(0,m[y])({text:a,focusPoint:i,diagram:t}));y++);t.hooks.forceDecorateImportModels.call(h);var v={body:h,options:h.map((function(){return{}}))};t.emit("beforepaste:text",v),t.command.execute("Add",{model:v.body,cellOptions:this._getOptions(v.body,v.body.map((function(e){return{}})))}),t.emit("afterpasteplaintext",{body:h,focusPoint:i})}}}],[{key:"registerClipboardProcessor",value:function(e,t){up[e]=t}}]),n}();c()(dp,"className","Paste");var fp=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram.selector.selections,t=e.map((function(e){return{target:{marker:e.source.marker||"none"},source:{marker:e.target.marker||"none"}}}));this.model=t,this.id=e.map((function(e){return e.model.id})),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();function hp(e){return e.isStem}c()(fp,"className","LineSwapEndpoint"),c()(fp,"enable",(function(e){return e.selector.selections.every((function(e){return xn(e)}))}));var pp=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.groupManager.group,n=e.selector.selections.filter(hp),r={},a=Object(F.a)();t&&(r.parent=t.model.id),n.sort((function(e,t){return e.getZIndex()-t.getZIndex()}));var i={id:a,type:"group"},o={parent:a};this.beforeZIndexCache=e.getCellsByZIndex().map((function(e){return e.model.id})),this.newGroupModel=i,this.newGroupOption=r,this.selectionIds=n.map((function(e){return e.model.id})),this.updateModel={},this.updateOption=o,this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.newGroupModel,n=this.selectionIds,r=this.newGroupOption,a=this.updateModel,i=this.updateOption,o=e.rootGroup,c=n.map((function(t){return e.find(t)})),l=t.id,s=c[c.length-1].getAllCellsByZIndex(),u=s[s.length-1];e.add(t,r),e.update(c,a,i);var d=e.find(l);o.insertBefore(d.graphicGroup,u.graphicGroup);for(var f=0;f<c.length;f++)c[f].getAllCellsByZIndex().forEach((function(e){o.insertBefore(e.graphicGroup,d.graphicGroup)}));e.selector.select(l)}},{key:"backward",value:function(){var e=this.diagram,t=this.selectionIds,n=this.newGroupModel,r=this.newGroupOption,a=this.beforeZIndexCache,i=n.id,o=e.rootGroup,c=t.map((function(t){return e.find(t)}));r.parent?e.update(c,{parent:r.parent}):e.update(c,{},{parent:null}),e.groupManager.exit(),e.remove(i);for(var l=0;l<a.length;l++){var s=e.find(a[l]);o.append(s.graphicGroup)}e.selector.select(t)}}]),n}();c()(pp,"className","MakeGroup"),c()(pp,"enable",(function(e){var t=e.selector.selections;return(t=t.filter(hp)).length>1}));var mp=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections,n=t.map((function(e){return e.model.id})),r={};t.forEach((function(e){e.getChildren().forEach((function(t){r[t.model.id]=e.model.id}))})),this.beforeZIndexCache=e.getCellsByZIndex().map((function(e){return e.model.id})),this.selectionIds=n,this.groupMap=r,this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.selectionIds.map((function(t){return e.find(t)})),n=[];t.forEach((function(t){var r=t.parent&&t.parent.model.id||null;t.getChildren().forEach((function(t){n.push(t),e.update(t,{},{parent:r})}))})),e.groupManager.exit(),e.remove(t),e.selector.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.groupMap,n=this.selectionIds,r=this.beforeZIndexCache,a=e.rootGroup;e.add(n.map((function(e){return{id:e,type:"group"}}))),Object.keys(t).forEach((function(n){e.update(n,{},{parent:t[n]})}));for(var i=0;i<r.length;i++){var o=e.find(r[i]);a.append(o.graphicGroup)}e.selector.select(n)}}]),n}();c()(mp,"className","Ungroup"),c()(mp,"enable",(function(e){return e.selector.selections.every((function(e){return e.isGroup}))}));var yp={Extends:[md,Ld,jd,kd,Sd,uf,Rd,gd,Bd,Dd,Nd,xd,Wd,Vd,Zd,df],Cells:[hd,fd,Lu,Eu,ju],Commands:[Mh,Bh,Dh,pp,mp,dp,Nh,_h,qh,Fh,Gh,Xh,Vh,Wh,Zh,Uh,Qh,Jh,np,rp,ep,tp,op,ap,ip,cp,fp],defaultCursors:{edit:"default",read:"grab",dragCanvas:"grab",beginInsertLine:"crosshair"},settings:{line:{shape:"elbow",target:{marker:"arrow"}},image:{},vertex:{},freehand:{}},dataProcessor:function(e){if(e&&e.body){var t=[],n=[],r=[],a={};e.body.forEach((function(e){at(e,(function(e,t){e.id||(e.id=Object(F.a)()),a[e.id]={model:e,parent:t},e.type&&n.push(e)})),e.type?t.push(e):r.push(e.id)})),t.forEach((function(e){pu(e)})),n.forEach((function(e){!function(e){if(function(e){return!!e.type&&"image"===e.type}(e)){var t,n,r=e.width,a=e.height,i=null==e||null===(t=e.image)||void 0===t?void 0:t.naturalWidth,o=null==e||null===(n=e.image)||void 0===n?void 0:n.naturalHeight;if(null==a&&"number"==typeof r&&"number"==typeof i&&"number"==typeof o){var c=o/i;e.height=r*c}}}(e),function(e){"line"===e.type&&e.controlPoints&&(e.controlPoints=e.controlPoints.filter((function(e){return e&&e[0]&&e[1]})))}(e),!1===function(e){if("dsl"===e.type&&null==e.shape)return!1}(e)&&r.push(e.id),!1===function(e){if(Go(e)){var t=oc.find((function(t){return t.name===e.shape}));if(!t)return!1;t.controlPoints&&!e.controlPoints&&(e.controlPoints=t.controlPoints),t.round&&!e.round&&(e.round=t.round)}}(e)&&r.push(e.id),!1===function(e,t){if(qo(e))for(var n=["target","source"],r=0;r<n.length;r++){var a=e[n[r]];if(a&&a.id&&!t[a.id])return!1}}(e,a)&&r.push(e.id)})),r.forEach((function(t){var n=a[t],r=n.model,i=n.parent;bt(i?i.children:e.body,r)})),function(e){e.body.forEach((function(e){at(e,(function(e){"mindmap"===e.type&&(delete e.abstract,delete e.start,delete e.end,at(e,(function(e,t){var n=du.modelIsTwoQuadrantLayout(e),r=e.children;if(r&&0!==r.length){for(var a=n?2:1,i=r.length,o=[1/0,1/0],c=[void 0,void 0],l=r.length-1;l>=0;l--){var s=r[l];if(!s.abstract||void 0===s.start||void 0===s.end){i=l+1;break}var u=s.start,d=s.end,f=s.layout,h=(void 0===f?{}:f).quadrant,p=void 0===h?1:h;if(p>a){if(n){i=l+1;break}s.layout=hu(hu({},s.layout),{},{quadrant:1})}if(p<a&&(a=p),d>=o[a-1]){var m=o[a-1]-1;if(m<0){i=l+1;break}s.end=m}if(u>d||u>o[a-1]||d<0){i=l+1;break}u<0&&(s.start=0),o[a-1]=s.start,s.end,void 0===c[a-1]&&(c[a-1]=l),void 0!==s.border&&void 0!==s.border.shape&&"line"!==s.border.shape||(s.border=hu(hu({},s.border),{},{shape:"rect"}))}var y=function(e,t){var n=r[e],a=n.abstract,i=n.start,o=void 0===i?0:i,c=n.end;return!a||o>=t||((void 0===c?0:c)>=t&&(r[e].end=t-1),!1)},v=!1;if(n){var g=[[],[]],b=[[],[]];r.forEach((function(e,t){var n=e.layout,r=(void 0===n?{}:n).quadrant,a=void 0===r?1:r,o=Math.min(2,Math.max(1,a));t<i?g[o-1].push(t):b[o-1].push(t)})),v=b.some((function(e,t){if(e.length>0){var n=e[e.length-1],r=g[t].length;return y(n,r)}return!1}))}else r[r.length-1].abstract&&(v=y(r.length-1,i));v&&(i=r.length);for(var x=0;x<i;x++)delete r[x].abstract,delete r[x].start,delete r[x].end}})))}))}))}(e)}},modes:[{mode:"edit",Behaviours:[pf,hf,vf,gf,bf,xf,mf,ff,kf,wh,kh,bh,Yf,lh,Ah,vh,Eh,Oh,Bf,Df,Ef,Of,Pf,Af,Tf,Sf,Rf,Nf,If,_f,Ph,Sh]},{mode:"read",Behaviours:[gh,jh]},{mode:"dragCanvas",Behaviours:[]},{mode:"beginInsertLine",Behaviours:[hh,_f]},{mode:Rr,Behaviours:[yh]},{mode:"beginInsertImage",Behaviours:[uh]}]};function vp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var gp=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"element",new aa),c()(E()(r),"isPoints",!0),c()(E()(r),"points",void 0),r}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,e),this.updateModel(this.model),this.graphicGroup.add(this.element)}},{key:"canConnect",value:function(){return!1}},{key:"canUpdateText",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"getKeyShape",value:function(){return this.element}},{key:"getKeyShapeBox",value:function(){var e=this.getKeyShape().getBBox(),t=e.x,n=e.y,r=e.width,a=e.height;return{x:t,y:n,width:r,height:a,minX:t,minY:n,maxX:t+r,maxY:n+a}}},{key:"getBBox",value:function(){return this.getPointBox()}},{key:"getPointBox",value:function(){var e=1/0,t=1/0,n=-1/0,r=-1/0;return this.points.forEach((function(a){e=Math.min(e,a[0]),t=Math.min(t,a[1]),n=Math.max(n,a[0]),r=Math.max(r,a[1])})),{x:e,y:t,width:n-e,height:r-t,minX:e,minY:t,maxX:n,maxY:r}}},{key:"canvas2Relative",value:function(e){e=Di(e);var t=this.getKeyShapeBox();return{x:e.x-t.x,y:e.y-t.y}}},{key:"canvas2percentage",value:function(e){return this.relative2Percentage(this.canvas2Relative(e))}},{key:"relative2Percentage",value:function(e){e=Di(e);var t=this.getKeyShapeBox();return[e.x/t.width,e.y/t.height]}},{key:"relative2Canvas",value:function(e){e=Di(e);var t=this.getKeyShapeBox();return{x:t.x+e.x,y:t.y+e.y}}},{key:"percentage2Canvas",value:function(e){e=Di(e);var t=this.getKeyShapeBox();return{x:t.x+t.width*e.x,y:t.y+t.height*e.y}}},{key:"percentage2Relative",value:function(e){e=Di(e);var t=this.getKeyShapeBox();return[t.width*e.x,e.y*t.height]}},{key:"isPointInFill",value:function(e){return this.getKeyShape().isPointInFill(Ii(e))}},{key:"isPointInStroke",value:function(e){return this.getKeyShape().isPointInStroke(Ii(e))}},{key:"updateModel",value:function(e){var t;null===(t=e.points)||void 0===t||t.forEach((function(e){var t=af([e[0],e[1]]);e[0]=t[0],e[1]=t[1]})),I()(L()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}},{key:"getIntersectionPoint",value:function(e){var t=this.getKeyShapeBox(),n={x:t.x+t.width/2,y:t.y+t.height/2},r=n.x,a=n.y;return this.getKeyShape().getIntersectionPoint(e.x,e.y,r,a)}},{key:"isPointInShape",value:function(e){var t=Ii(e),n=this.getKeyShape();return n.isPointInFill(t)||n.isPointInStroke(t)}},{key:"updateGeometryProperties",value:function(){var e=this.getPointBox();this.height=e.height,this.width=e.width,this.x=e.x,this.y=e.y}},{key:"afterUpdateModel",value:function(){this.updateGeometryProperties()}},{key:"draw",value:function(){this.updateCache()}},{key:"updateCache",value:function(){var e=this,t=this.cache;["points","stroke"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},rotate:0,penetratedKeys:["points","stroke","opacity"],points:[],opacity:1})}}]),n}();function bp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{didIntersect:n.length>0,message:e,points:n}}function xp(e,t,n,r){var a=ef(e,n),i=ef(r,n),o=ef(t,e),c=i[0]*a[1]-i[1]*a[0],l=o[0]*a[1]-o[1]*a[0],s=i[1]*o[0]-i[0]*o[1];if(0===c||0===l)return bp("coincident");if(0===s)return bp("parallel");if(0!==s){var u=c/s,d=l/s;if(u>=0&&u<=1&&d>=0&&d<=1)return bp("intersection",$d(e,tf(o,u)))}return bp("no intersection")}function kp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(gp,"className","Freehand");var wp=function(e){S()(n,gp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"element",new aa),c()(E()(r),"isFreeHand",!0),c()(E()(r),"opacity",void 0),c()(E()(r),"points",void 0),r}return v()(n,[{key:"draw",value:function(){var e={};"mark-pencil"===this.shape&&(e.start={taper:0,cap:!1},e.end={taper:0,cap:!1},e.simulatePressure=!1),e.size=3*this.stroke.width;var t=_i(Object(je.a)(this.points,e));this.element.update({d:t,fill:this.stroke.color,opacity:this.opacity}),I()(L()(n.prototype),"draw",this).call(this)}},{key:"isIntersectLineSegment",value:function(e){var t,n,r,a=this.points,i=this.getKeyShapeBox(),o=b()(e,2),c=o[0],l=o[1];if(i.width<8&&i.height<8)return of(c,l,function(e){return[e.minX+e.width/2,e.minY+e.height/2]}(i))<5;if(n=c,r=l,function(e,t,n,r){var a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[e[0]+t[0]/2,e[1]+t[1]/2],a=rf(e,r,n),i=rf($d(e,[t[0],0]),r,n),o=rf($d(e,t),r,n),c=rf($d(e,[0,t[1]]),r,n);return[["top",[a,i]],["right",[i,o]],["bottom",[o,c]],["left",[c,a]]]}(e,t).reduce((function(e,t){var a=b()(t,2),i=a[0],o=b()(a[1],2),c=o[0],l=o[1],s=xp(n,r,c,l);return s&&e.push(bp.apply(void 0,[i].concat(D()(s.points)))),e}),[]);return a.filter((function(e){return e.didIntersect}))}([(t=i).minX,t.minY],[t.width,t.height],n,r))for(var s=1;s<a.length;s++)if(xp(a[s-1],a[s],c,l).didIntersect)return!0;return!1}},{key:"getIntersectionPoint",value:function(e){var t=this.getKeyShapeBox(),n=[t.x,t.y+t.height/2],r=[t.maxX,t.y+t.height/2],a=[t.x+t.width/2,t.minY],i=[t.x+t.width/2,t.maxY],o=1/0,c=n;return[n,r,a,i].forEach((function(t){var n=ro(e,t);n<o&&(o=n,c=t)})),Di(c)}},{key:"isPointInFill",value:function(e){return wo(e,function(e){return{x:e.x,y:e.y,w:e.width,h:e.height,r:0}}(this.getKeyShapeBox()))}},{key:"updateCache",value:function(){var e=this,t=this.cache;["points","stroke","fill"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},rotate:0,penetratedKeys:["points","stroke","opacity","shape"],Subcells:[],points:[]})}}]),n}();function Cp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ap(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(wp,"className","Freehand");var Op=function(e){S()(n,gp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"isPen",!0),c()(E()(r),"fill",void 0),c()(E()(r),"isClosed",void 0),c()(E()(r),"points",void 0),r}return v()(n,[{key:"createRendererElement",value:function(){if(!this.element||this.isCacheStale("roughFillStyle")){var e=this.getRoughGraphicOptions(),t=new(e?Va:aa)(Ap({},e));this.element&&this.element.remove(),this.element=t,this.graphicGroup.add(this.element)}}},{key:"canRough",value:function(){return!0}},{key:"draw",value:function(){this.createRendererElement();var e=this.points.reduce((function(e,t,n){return e+(0===n?"M ".concat(t[0],",").concat(t[1]):"L ".concat(t[0],",").concat(t[1]))}),"");this.isClosed&&(e+="Z"),this.element.update(Ap({d:e,fill:this.fill.color,stroke:this.stroke.color,opacity:this.opacity,"stroke-width":this.stroke.width},this.convertStrokeStyle())),I()(L()(n.prototype),"draw",this).call(this)}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var e=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*e)}}return{"stroke-dasharray":"none"}}},{key:"updateCache",value:function(){var e=this,t=this.cache;["points","stroke","fill","isClosed","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?Ap({},r):r}))}},{key:"getIntersectionPoint",value:function(e){var t=this.getKeyShapeBox(),n=[t.x,t.y+t.height/2],r=[t.maxX,t.y+t.height/2],a=[t.x+t.width/2,t.minY],i=[t.x+t.width/2,t.maxY],o=1/0,c=n;return[n,r,a,i].forEach((function(t){var n=ro(e,t);n<o&&(o=n,c=t)})),Di(c)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},fill:{color:"transparent"},rotate:0,penetratedKeys:["points","stroke","fill","isClosed"],Subcells:[],points:[],isClosed:!1})}}]),n}();c()(Op,"className","Pen");var Ep=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this)).diagram=e,r._initEvent(),r}return v()(n,[{key:"_initEvent",value:function(){var e,t,n=this,r=this.diagram,a=[],i=[1/0,1/0,0];this.bind(r,"pointerdown",(function(o){var c,l,s,u,d,f,h;if(2!==o.button&&n.isEnable){var p=null===(c=r.settings)||void 0===c||null===(l=c.freehand)||void 0===l?void 0:l.strokeWidth,m=null===(s=r.settings)||void 0===s||null===(u=s.freehand)||void 0===u?void 0:u.stroke,y=null!==(d=null===(f=r.settings)||void 0===f||null===(h=f.freehand)||void 0===h?void 0:h.shape)&&void 0!==d?d:Mr;a=[];var v=n.client2draw(o);a.push(v),e=r.add({shape:y,type:"freehand",points:a,stroke:{width:p,color:m},opacity:y===Mr?1:.5})[0],t=n.bind(window,"pointermove",pe()((function(t){if(n.isEnable&&e){var o=n.client2draw(t);xe()(i,o)||(i=o,a.push(o),r.update(e,{points:a}))}}),16))}})),this.bind(window,"pointerup",(function(o){if(e){var c=s()(e.model);n.count(c),delete c.id,r.remove(e),r.command.execute("Add",{model:c,autoSelect:!1}),n.unbind(t),a=[],e=void 0,i=[1/0,1/0,0]}}))}},{key:"count",value:function(e){var t,n=this.diagram;null!==(t=n.spm)&&void 0!==t&&t.click&&("pencil"===e.shape?n.spm.click(Dr,{shape:e.shape}):"mark-pencil"===e.shape&&n.spm.click(Nr,{shape:e.shape}))}},{key:"client2draw",value:function(e){var t=af(this.diagram.viewport.invertClient([e.clientX,e.clientY]));return t.push(e.pressure),t}},{key:"isEnable",get:function(){return"free-hand"===this.diagram.interaction.currentMode}},{key:"reset",value:function(){this.unbind()}}]),n}();function Pp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Ep,"className","FreehandDraw");var jp="url('https://gw.alipayobjects.com/zos/bmw-prod/b0d18072-618f-49fe-8523-923c08d19764.svg') 14.72 8, auto",Rp="url(https://gw.alipayobjects.com/zos/bmw-prod/87c9f5e3-90b6-46b6-b051-44b013e1dce7.svg) 9 9, auto",Mp=function(e){S()(n,fl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n),(r=t.call(this)).diagram=e,c()(E()(r),"lineElement",vu({stroke:"#aaa","stroke-width":2})),c()(E()(r),"group",new Zr),c()(E()(r),"drawGroup",new Zr),c()(E()(r),"interactGroup",new Zr),c()(E()(r),"pen",void 0),c()(E()(r),"lastPen",void 0),c()(E()(r),"controlPointButtons",[]),c()(E()(r),"controlPoints",[]),c()(E()(r),"activeIndex",0),c()(E()(r),"activeIndexes",[]),c()(E()(r),"drawEvents",[]),c()(E()(r),"interactEvents",[]),c()(E()(r),"uiControlPointButton",ji(1,!0)),c()(E()(r),"_closeToControlPoints",!1),c()(E()(r),"start",!0),c()(E()(r),"startpoint",[1/0,1/0]),c()(E()(r),"interact",!1),r.initEvent(),r.initInteractEvent(),r.group.add(r.drawGroup),r.group.add(r.interactGroup),r.uiControlPointButton.group.hide(),r.group.add(r.uiControlPointButton.group),r.drawGroup.add(r.lineElement),r.diagram.frontRootGroup.prepend(r.group),r.bind(e,"aftermodechange",(function(){var t;if(e.interaction.currentMode===Pr){if(r.start=!0,!r.pen){var n=e.find(r.lastPen);n&&(r.pen=n),r.pen&&(r.start=!1,r.initControlPoints())}}else r.lastPen=null===(t=r.pen)||void 0===t?void 0:t.model.id,r.reset()}));var a=e.viewport.zoom;return r.bind(e,"afterviewportchange",pe()((function(){a!==e.viewport.zoom&&(r.updateControlPoints(),a=e.viewport.zoom)}))),r}return v()(n,[{key:"createElements",value:function(){var e=this;if(this.pen){var t=1/this.diagram.viewport.zoom;this.pen.points.forEach((function(n,r){var a=ji(r,!1);a.group.update(Sp(Sp({},Di(n)),{},{scale:t})),e.controlPointButtons.push(a),e.controlPoints.push(D()(n)),e.interactGroup.add(a.group)})),this.updateActiveButton(this.pen.points.length-1,!0)}}},{key:"closeToControlPoints",value:function(){this._closeToControlPoints=!0,this.diagram.align.clear(),this.lineElement.hide()}},{key:"notCloseToControlPoints",value:function(){this.updateAlignPoints(),this._closeToControlPoints=!1}},{key:"enable",get:function(){return this.diagram.interaction.currentMode===Pr}},{key:"setCursor",value:function(e){var t=this.diagram;t.interaction.currentMode===Pr&&t.setCursor(e)}},{key:"finishDraw",value:function(){var e=this;this._closeToControlPoints=!1,this.start=!0,this.lineElement.hide();var t=this.pen;this.reset(),setTimeout((function(){e.diagram.interaction.changeMode("edit"),t&&e.diagram.selector.select([t])}))}},{key:"initEvent",value:function(){var e,t=this,n=this.diagram;this.drawEvents.push(this.bind(n,"aftercommandforward",(function(){t.initControlPoints()}))),this.drawEvents.push(this.bind(n,"aftercommandbackward",(function(){t.initControlPoints()}))),this.drawEvents.push(this.bind(n,"mousedown",(function(r){var a;if(2!==r.button&&t.enable&&!(t._closeToControlPoints||null!==(a=t.pen)&&void 0!==a&&a.isClosed)){var i=t.client2draw(r);if(t.start){var o;t.start=!1,t.startpoint=i;var c=Object(F.a)(),l={id:c,type:"pen",points:[t.startpoint]};n.hooks.decorateAddPenModel.call(l),n.command.execute("Add",{model:l}),null===(o=n.spm)||void 0===o||o.click(Br),t.pen=n.find(c)}else if(t.pen){if(t.activeIndex!==t.pen.points.length-1)return;if(ro(i,t.pen.points[0])<=6)return n.command.execute("Update",{id:t.pen,model:{isClosed:!0}}),void t.finishDraw();var u=s()(t.pen.points);u.push(e||i),n.command.execute("Update",{id:t.pen,model:{points:u}}),e=void 0}t.updateAlignPoints(),t.initControlPoints(),t.lineElement.update({d:""})}}))),this.drawEvents.push(this.bind(n,"mousemove",pe()((function(n){if(t.enable&&t.pen&&!t.pen.isClosed&&!t.start&&t.isSelectedLast()&&!t.interact){var r=t.client2draw(n);t.align(r),ro(r,t.startpoint)<=6&&(r=t.startpoint),e=r;var a=["M",t.pen.points[t.pen.points.length-1],"L",r].join(" ");t.lineElement.show(),t.lineElement.update({d:a})}}),16))),this.drawEvents.push(this.bind(n,"keyup",(function(e){"Escape"!==e.key&&"Enter"!==e.key||!t.pen||t.finishDraw()})))}},{key:"isSelectedLast",value:function(){return!!this.pen&&this.activeIndex===this.pen.points.length-1}},{key:"cleanInteract",value:function(){var e=this;this.interactGroup.clear(),this.interactEvents.forEach((function(t){e.unbind(t)})),this.controlPointButtons=[],this.controlPoints=[]}},{key:"initControlPoints",value:function(){this.updateAlignPoints(),this.cleanInteract(),this.createElements(),this.initInteractEvent()}},{key:"updateControlPoints",value:function(){var e=this;if(this.pen){this.controlPoints=[];var t=1/this.diagram.viewport.zoom;this.pen.points.forEach((function(n,r){e.controlPointButtons[r].group.update(Sp(Sp({},Di(n)),{},{scale:t})),e.controlPoints.push(D()(n))}))}}},{key:"align",value:function(e){var t=this.diagram.align.alignByPoint(Sp(Sp({},Di(e)),{},{weight:1,box:this.p2b(e)}));e[0]+=t.dx,e[1]+=t.dy}},{key:"selectActiveButton",value:function(e){this.updateActiveButton(e)}},{key:"updateActiveButton",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.diagram,a=s()(this.activeIndexes);if(Array.isArray(e))this.activeIndexes=e;else if(r.signal.keydown.Shift&&!n){var i=this.activeIndexes.indexOf(e);i>=0?this.activeIndexes.splice(i,1):this.activeIndexes.push(e)}else this.activeIndexes=[e];a.forEach((function(e){var n;null===(n=t.controlPointButtons[e])||void 0===n||n.shape.update({stroke:fr,fill:hr})})),this.activeIndexes.forEach((function(e){var n;null===(n=t.controlPointButtons[e])||void 0===n||n.shape.update({stroke:br,"stroke-width":1,fill:Cr})})),1===this.activeIndexes.length?this.activeIndex=this.activeIndexes[0]:this.activeIndex=-1,this.activeIndex===this.controlPointButtons.length-1?(this.lineElement.update({d:""}),this.lineElement.show()):this.lineElement.hide()}},{key:"initInteractEvent",value:function(){var e=this,t=this.diagram,n=this.pen;if(n){var r,a,i=-1,o=!1,c=!1;this.interactEvents.push(this.bind(t,"mousedown",(function(t){var r,l,u=null===(r=t.target)||void 0===r?void 0:r.dataset;null!==(l=u.test_id)&&void 0!==l&&l.startsWith("line-control-point")&&(i=Number(u.index),a={points:s()(n.points)},e.updateActiveButton(i),we()(i)&&(c=!0,e.updateAlignPoints(),e.interact=!0,e.lineElement.hide()),"true"===u.isUIPoints?o=!0:"false"===u.isUIPoints&&(o=!1))}))),this.interactEvents.push(this.bind(this.diagram,"mousemove",pe()((function(t){var a=e.diagram,l=e.client2draw(t);c&&e.align(l);for(var u=!1,d=e.controlPoints,f=0;f<d.length;++f){var h=d[f];if(0===f&&ro(l,h)<=6)return e.notCloseToControlPoints(),e.uiControlPointButton.group.hide(),void(e.isSelectedLast()?e.setCursor("url(https://gw.alipayobjects.com/zos/bmw-prod/eaa8e58e-4b6a-41a2-a17a-c2ac014ca278.svg) 14.72 8, auto"):e.setCursor(Rp));if(ro(l,h)<=6&&!c){e.closeToControlPoints(),e.uiControlPointButton.group.hide(),u=!0,e.setCursor(Rp);break}}if(!u&&!c){i<0&&e.setCursor(jp);var p=n.getKeyShape().getClosestPoint(l[0],l[1]);if(ro(l,p.point)<=6){e.uiControlPointButton.group.show(),e.uiControlPointButton.group.update(Sp(Sp({},Di(p.point)),{},{scale:1/a.viewport.zoom}));for(var m=[],y=0,v=0;v<e.controlPoints.length;v++){var g=void 0;if(v===e.controlPoints.length-1){if(!n.isClosed)break;g=ro(e.controlPoints[v],e.controlPoints[0])}else g=ro(e.controlPoints[v],e.controlPoints[v+1]);m.push(g),y+=g}var b=0,x=0;m.reduce((function(e,t,n){var r=(e+t)/y;return x<=p.percentage&&p.percentage<=r&&(b=n+1),x=r,e+t}),0),e.uiControlPointButton.group.dataset({index:b+""}),e.uiControlPointButton.shape.dataset({index:b+""}),c||e.closeToControlPoints(),e.lineElement.hide(),u=!0}else e.uiControlPointButton.group.hide()}!u&&i<0&&e.notCloseToControlPoints(),i<0||(c||e.closeToControlPoints(),r=s()(n.points),e.interactGroup.hide(),e.uiControlPointButton.group.hide(),o?(r.splice(i,0,l),o=!1):r[i]=l,a.update(n,{points:r}))}),16))),this.interactEvents.push(this.bind(this.diagram,"mouseup",(function(o){e.interactGroup.show(),r&&(t.command.execute("Update",{id:n.model.id,model:{points:r},originModels:a}),e.initControlPoints(),e.updateActiveButton(i),e.lineElement.hide(),e._closeToControlPoints=!1,r=void 0),i<0&&(!e.isSelectedLast()||n.isClosed)&&e.finishDraw(),t.align.reset(),i=-1,c=!1,e.interact=!1}))),this.interactEvents.push(this.bind(t,"keydown",(function(r){if(n){r.preventDefault();var a=s()(n.points),i={points:s()(n.points)};if("Backspace"===r.key)e.activeIndexes.length>=0&&(a.length===e.activeIndexes.length?(t.command.execute("Delete",{cells:[n.model.id],originModels:i}),e.start=!0,e.reset()):(xt(a,e.activeIndexes),t.command.execute("Update",{id:n.model.id,model:{points:a},originModels:i}),e.initControlPoints()));else if("a"===r.key&&ki(r))e.updateActiveButton(n.points.map((function(e,t){return t})));else{var o=0,c=0;switch(r.key){case"Left":case"ArrowLeft":o=-1;break;case"Right":case"ArrowRight":o=1;break;case"Up":case"ArrowUp":c=-1;break;case"Down":case"ArrowDown":c=1;break;default:return}if(e.activeIndexes.length>0){e.activeIndexes.forEach((function(e){a[e][0]+=o,a[e][1]+=c})),t.command.execute("Update",{id:n.model.id,model:{points:a},originModels:i});var l=s()(e.activeIndexes);e.initControlPoints(),e.updateActiveButton(l)}}}})))}}},{key:"init",value:function(e){this.pen=e,this.initControlPoints(),this.start=!1,this.startpoint=s()(e.points[0])}},{key:"client2draw",value:function(e){var t=this.diagram.viewport.invertClient([e.clientX,e.clientY]);return af([t[0],t[1]])}},{key:"updateAlignPoints",value:function(){var e=this,t=this.pen;if(t){var n=[],r=t.getBBox(),a=[r.x+r.width/2,r.y+r.height/2];n.push([Sp(Sp({},Di(a)),{},{weight:1,box:r})]),t.points.forEach((function(t){n.push([Sp(Sp({},Di(t)),{},{weight:1,box:e.p2b(t)})])})),this.diagram.align.updateToAlignPointSet(n)}}},{key:"p2b",value:function(e){return{minX:e[0],minY:e[1],maxX:e[0],maxY:e[1]}}},{key:"reset",value:function(){this.start=!0,this.pen=void 0,this.activeIndexes=[],this.lineElement.hide(),this.uiControlPointButton.group.hide(),this._closeToControlPoints=!1,this.cleanInteract(),this.diagram.align.reset()}},{key:"clearCache",value:function(){this.lastPen=void 0}},{key:"destory",value:function(){this.unbind(),this.group.clear()}}]),n}();c()(Mp,"className","PenDrawInteract");var Lp=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"pen",void 0),c()(E()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram,n=function(n){e.pen=n,t.interaction.changeMode("pen"),t.penDrawInteract.init(n)};this.bind(t,"dblclick",(function(e){var r=t.getCell(e.target);r&&Bn(r)&&n(r)})),this.bind(t,"keyup",(function(e){var r=t.selector.selections;1===r.length&&Bn(r[0])&&"Enter"===e.key&&n(r[0])}))}},{key:"reset",value:function(){this.unbind()}}]),n}();var Bp=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"pen",void 0),c()(E()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"aftermodechange",(function(){"pen"===e.interaction.currentMode&&e.vertexRotateResize.end()}))}},{key:"reset",value:function(){this.unbind()}}]),n}();var Dp=function(e){S()(n,Ql);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=this;I()(L()(n.prototype),"init",this).call(this,e),this.bind(e,"aftercommandbackward",(function(e){var n=e.command;n instanceof sc?t.reDraw():n instanceof Mh&&t.reEnter(n.cells[0])})),this.bind(e,"aftercommandforward",(function(e){var n=e.command;n instanceof sc?t.reEnter(n.model.id):n instanceof Mh&&t.reDraw()}))}},{key:"reDraw",value:function(){this.diagram.penDrawInteract.reset()}},{key:"reEnter",value:function(e){var t=this.diagram,n=t.find(e);n&&Bn(n)&&t.penDrawInteract.init(n)}}]),n}();var Np=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"group",new Zr),c()(E()(e),"eraserPoints",[]),c()(E()(e),"prevPoint",void 0),c()(E()(e),"prevEraserPoint",void 0),c()(E()(e),"timestamp",0),c()(E()(e),"interval",void 0),c()(E()(e),"eraserPath",new aa),c()(E()(e),"loop",(function(){var t=Date.now(),n=t-e.timestamp,r=!1;if(e.prevEraserPoint!==e.prevPoint&&(r=!0,e.eraserPoints.push(e.prevPoint),e.prevEraserPoint=e.prevPoint),n>32&&e.eraserPoints.length>1&&(r=!0,e.eraserPoints.splice(0,Math.ceil(.1*e.eraserPoints.length)),e.timestamp=t),r){var a=e.diagram.viewport.zoom,i=_i(Object(je.a)(e.eraserPoints,{size:16/a,start:{taper:!0}}));e.eraserPath.update({d:i})}e.interval=requestAnimationFrame(e.loop)})),c()(E()(e),"cancel",(function(){e.eraserPath.update({d:""}),e.eraserPoints=[],cancelAnimationFrame(e.interval)})),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.preparePath(),this._initEvent()}},{key:"preparePath",value:function(){this.eraserPath.css({id:"eraser"}),this.eraserPath.update({fill:"#aaa",opacity:.33}),this.group.add(this.eraserPath),this.diagram.frontRootGroup.add(this.group)}},{key:"_initEvent",value:function(){var e=this,t=this.diagram,n=[],r=new Set,a=0,i=!1,o=function(){var e=[];return r.forEach((function(t){return e.push(t)})),e};this.bind(t,"pointerdown",(function(r){n=t.getFreehands(),i=!0;var a=e.client2draw(r);e.eraserPoints=[a],e.prevPoint=a,e.loop()})),this.bind(window,"pointermove",pe()((function(c){if(i){var l=e.client2draw(c);if(n.forEach((function(t){r.has(t.model.id)||t.isIntersectLineSegment([e.prevPoint,l])&&r.add(t.model.id)})),e.prevPoint=l,r.size!==a){a=r.size;var s=o();t.update(s,{opacity:.3})}}}),16)),this.bind(window,"pointerup",(function(n){if(i=!1,cancelAnimationFrame(e.interval),e.eraserPath.update({d:""}),r.size>0){var a=o(),c=[];a.forEach((function(e){var n=t.find(e);(null==n?void 0:n.shape)===Mr?c.push({opacity:1}):c.push({opacity:.5})})),t.update(a,c),t.command.execute("Delete",{cells:a}),r.clear()}}))}},{key:"client2draw",value:function(e){return af(this.diagram.viewport.invertClient([e.clientX,e.clientY]))}},{key:"reset",value:function(){this.unbind(),this.cancel(),this.group.clear()}}]),n}();function Ip(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ip(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ip(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _p={lake_prevent_click_unselect:"true",draw_base_resize_controller:"true"},Fp=function(e){S()(n,uf);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"cell",void 0),c()(E()(r),"drawbaseGroup",new Zr),c()(E()(r),"p0",ii("start",_p)),c()(E()(r),"p1",ii("end",_p)),r.drawbaseGroup.add(r.p0.group),r.drawbaseGroup.add(r.p1.group),r.drawbaseGroup.hide(),e.frontRootGroup.add(r.drawbaseGroup),r}return v()(n,[{key:"init",value:function(e){this.cell=e,this.lowMode()?this._init():I()(L()(n.prototype),"init",this).call(this,e)}},{key:"_init",value:function(){this.bindEvent()}},{key:"update",value:function(){var e=this.p0,t=this.p1,r=this.cell;if(r){var a=1/this.diagram.viewport.zoom;this.lowMode()?(r.points.forEach((function(n,r){n&&(0===r?e:t).group.update(Tp(Tp({},Di(n)),{},{scale:a}))})),1===r.points.length&&t.group.hide()):I()(L()(n.prototype),"update",this).call(this)}}},{key:"bindEvent",value:function(){var e,t,r,a=this,i=this.eventHelper,o=this.p0,c=this.p1,l=this.cell,u=!1;this.lowMode()?([o,c].forEach((function(n){var r=n.shape,a=n.name;i.bind(r,"mousedown",(function(n){u=!0,t=a,e={points:s()(l.points)}}))})),i.bind(this.diagram,"mousemove",(function(e){if(u){a.hide();var n,i=a.client2draw(e),o=s()(l.points),c=o[n="start"===t?0:1];o[n]=D()(i),Ln(l)&&(o[n][2]=c[2]),r={points:o},a.diagram.update(l,r)}})),i.bind(this.diagram,"mouseup",(function(){t&&(u=!1,t="",a.update(),a.show(),a.diagram.command.execute("Update",{id:l,model:r,originModels:e}))}))):I()(L()(n.prototype),"bindEvent",this).call(this)}},{key:"begin",value:function(){this.lowMode()?(this.update(),this.show(),I()(L()(n.prototype),"hide",this).call(this)):(this.hide(),I()(L()(n.prototype),"begin",this).call(this))}},{key:"show",value:function(){this.lowMode()?(this.drawbaseGroup.show(),this.p1.group.show()):I()(L()(n.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.lowMode()?(this.drawbaseGroup.hide(),this.p1.group.hide()):I()(L()(n.prototype),"hide",this).call(this)}},{key:"end",value:function(){this.eventHelper.unbind(),this.drawbaseGroup.hide(),this.p1.group.hide(),I()(L()(n.prototype),"end",this).call(this)}},{key:"lowMode",value:function(){return this.cell.points.length<=2}},{key:"client2draw",value:function(e){var t=this.diagram.viewport.invertClient([e.clientX,e.clientY]);return af([t[0],t[1]])}}]),n}();c()(Fp,"className","DrawBaseResizer");var zp,qp=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ki(t)&&"a"===t.key&&(e.interaction.changeMode(Or),t.preventDefault(),t.stopPropagation(),e.command.execute("SelectAll"),e.tryFocus())}))}}]),n}(),Yp={Cells:[Op,wp],Extends:[Mp,Ep,Fp],defaultCursors:(zp={},c()(zp,Pr,jp),c()(zp,Sr,"url(https://gw.alipayobjects.com/zos/bmw-prod/f16b8ea8-336e-4ea8-a900-70e59408ec3e.svg) 10.61 21.32, auto"),c()(zp,jr,"url(https://gw.alipayobjects.com/zos/bmw-prod/16f33e84-9723-4005-b6ad-4a0d3e37c06b.svg) 14.73 20.61,auto"),zp),modes:[{mode:Or,Behaviours:[Lp]},{mode:Pr,Behaviours:[Bp,Dp]},{mode:Sr,Behaviours:[Ql,qp]},{mode:jr,Behaviours:[Np,Ql]}],Commands:[]};dp.registerClipboardProcessor("mindmap",{text:function(e){var t=e.text,n=e.diagram,r=n.selector.selections,a=r[0];if(1===r.length&&a.isMindmap){var i=kl(t);if(i){a.collapsed&&n.update(a,{collapsed:null});var o=a.model.children.filter((function(e){return!e.abstract})).length;return i.forEach((function(e,t){e.options={parent:a.model.id,nth:o+t}})),i}}return!1},textIndex:2}),vf.registerContentEditorOptions("mindmap",{insertParagraphKey:function(e){return(e.metaKey||e.ctrlKey||e.altKey)&&"Enter"===e.key},cancelKey:function(e){return"Tab"===e.key||"Tag"===e.key||"Enter"===e.key||"Escape"===e.key}}),Af.filterCell((function(e){return!e.isMindmap}));var Hp=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).className="MindmapCollapseButton",r.configName="mindmapCollapseButton",r.current="none",r.zIndex=1,r.radius=8,r.outer=12,r}return v()(n,[{key:"render",value:function(){var e=this.cell,t=e.graphicGroup,n=new Zr;this.group=n,e.collapsedButtonElement=n,t.add(n),this.delegateEvent()}},{key:"delegateEvent",value:function(){var e=this.group;this.cell.delegateEvent(e,"click","collapsedbutton:click")}},{key:"drawPosition",value:function(){this.draw()}},{key:"updateState",value:function(){this.drawButton()}},{key:"_getCurrent",value:function(e){var t=this.cell,n=t.computedProps.treeEdge,r=t.x,a=t.y,i=t.width,o=t.height;return e+r+a+n.stroke+i+o}},{key:"_setDirection",value:function(){var e=this.cell,t=e.downLayoutType,n=e.downDirection;"standard"===t?0===n[0]?Math.sign(-1===n[1])?this.direction="top":this.direction="bottom":Math.sign(-1===n[0])?this.direction="left":this.direction="right":"indent"===t?-1===Math.sign(n[1])?this.direction="top":this.direction="bottom":"timeline"===t&&-1===Math.sign(n[0])?this.direction="left":this.direction="right"}},{key:"_updatePosition",value:function(e){var t,n,r=this.cell,a=this.direction,i=this.bbox,o=r.border,c=i.width,l=i.height;switch(a){case"top":t=r.width/2-c/2,n=-l;break;case"bottom":t=r.width/2-c/2,n=r.height+8;break;case"left":n="line"===o.shape?r.height-l/2:r.height/2-l/2,t=-c;break;default:n="line"===o.shape?r.height-l/2:r.height/2-l/2,t=r.width+8}var s=[1,0,0,0,1,0,t,n,1];e.update({matrix:s})}},{key:"_setBBox",value:function(){var e,t,n=this.direction,r=2*this.radius,a=2*this.radius;switch(n){case"top":case"bottom":e=r,t=a+8;break;default:t=a,e=r+8}this.bbox={width:e,height:t}}},{key:"_drawCollapseButtonHotspot",value:function(){var e=this.bbox,t=this.group,n=this.outer,r=new aa,a=2*n;t.clear(),r.update({fill:"transparent",d:un(-n,-n,e.width+.8*a,e.height+a)}),t.add(r),r.toBack(),this._updatePosition(t)}},{key:"_drawCollapseButton",value:function(){var e,t=this.cell,n=this.group,r=this.direction,a=this.radius,i=t.computedProps,o=t.diagram.viewport.zoom,c=2*a;switch(r){case"top":e=-Math.PI/2;break;case"bottom":e=Math.PI/2;break;case"left":e=Math.PI;break;default:e=0}var l=["border-radius: 16px","width: ".concat(c,"px"),"height: ".concat(c,"px"),"cursor: pointer","background: white","border: 3px solid ".concat(i.treeEdge.stroke),"display: inline-block"],s=[1,0,0,0,1,0,0,0,1];w.mat3.translate(s,s,[a,a,1]),w.mat3.rotate(s,s,e),w.mat3.translate(s,s,[-a,-a,1]);var u=new sa({html:'<span style="'.concat(l.join(";"),'" data-diagram-collapsed-button=true data-testid="diagram-collapsed-button"></span>'),x:0,y:0,width:0,height:0,matrix:s});u.css({"line-height":"normal"}),n.add(u);var d=u.htmlContainer.querySelector("span"),f=d.getBoundingClientRect(),h=f.width/o,p=f.height/o;u.update({width:h,height:p}),d.style.background=i.treeEdge.stroke,d.style.setProperty("background-repeat","no-repeat"),d.style.setProperty("background-position","1px 1px"),d.style.setProperty("background-image","url(".concat("https://gw.alipayobjects.com/zos/bmw-prod/c8f8bbfd-df13-421d-85f1-e310d67c89fc.svg",")"))}},{key:"_drawExpandButton",value:function(){var e=this.cell,t=this.group,n=this.radius,r=e.computedProps,a=e.diagram,i=r.treeEdge.stroke;t.clear();var o=-1;e.deepEach((function(){o++}));var c=a.font.measureTextLength(String(o))+8,l=ui(i),s=new xa({x:4,y:3,text:"".concat(o),fill:l,"dominant-baseline":"hanging"});s.dataset({diagramCollapsedButton:"true"}),s.css({fontFamily:"system-ui",fontSize:"12px",cursor:"pointer"});var u=new va({x:0,y:0,rx:n,width:c,height:2*n,fill:"".concat(i)});t.add(s),s.before(u),this._drawTail(),this._updatePosition(t)}},{key:"_drawTail",value:function(){var e,t=this.group,n=this.direction,r=this.cell,a=r.computedProps,i=2*this.radius,o=2*this.radius,c={x:i/2,y:o/2};switch(n){case"top":e="M".concat(c.x," ").concat(o," L").concat(c.x," ").concat(o+8);break;case"bottom":e="M".concat(c.x," 0 L").concat(c.x," -").concat(8);break;case"left":e="M".concat(i," ").concat(c.y," L").concat(i+8," ").concat(c.y);break;default:e="M0 ".concat(c.y," L-").concat(8," ").concat(c.y)}t.add(new aa({d:e,stroke:a.treeEdge.stroke,"stroke-width":r.getTreeEdgeStrokeWidth()}))}},{key:"draw",value:function(){var e=this.cell,t=this.current,n=e.state;this._setDirection(),this._setBBox(),e.canExpand()?(t!==this._getCurrent("expandButton")&&this._drawExpandButton(),this.current=this._getCurrent("expandButton")):e.canCollapse()&&(this._drawCollapseButtonHotspot(),n.collapsedButtonVisible&&this._drawCollapseButton())}},{key:"drawButton",value:function(){var e=this.cell,t=this.current,n=e.state;this._setDirection(),this._setBBox(),e.canExpand()?t!==this._getCurrent("expandButton")&&(this._drawExpandButton(),this.current=this._getCurrent("expandButton")):e.canCollapse()&&n.collapsedButtonVisible?t!==this._getCurrent("collapseButton")&&(this._drawCollapseButton(),this.current=this._getCurrent("collapseButton")):("none"!==t&&this.draw(),this.current="none")}},{key:"destroy",value:function(){this.group.destroy()}}]),n}();function Gp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Xp=aa,Vp=Ra,Wp=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"createRendererElement",value:function(){var e=this.cell,t=e.graphicGroup,n=e.parent;if(!this.element||e.isCacheStale("roughFillStyle")){var r=e.getRoughGraphicOptions(),a=new(r?Va:Xp)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},r));a.capture(!1),t.add(a),this.element&&this.element.remove(),this.element=a,e.treeEdgeElement=a,e.cache.treeEdgeStyle={},e.cache.treeEdgePath=null,n&&n.isStem&&!e.isAbstract&&this._createClipPath()}}},{key:"_createClipPath",value:function(){var e=this.cell,t=this.element,n=e.parent,r=e.diagram;if(n){var a=r.defs,i=Object(F.a)(),o=new Vp({id:i}),c=new Xp({"fill-rule":"nonzero"});o.add(c),a.add(o),this.clipPath&&this.clipPath.remove(),this.treeEdgeClipPath=c,this.clipPath=o,t.update({"clip-path":"url(#".concat(i,")")})}}},{key:"VH",value:function(e,t){return"M".concat(e[0],",").concat(e[1]," L").concat(e[0],",").concat(t[1]," L").concat(t[0],",").concat(t[1])}},{key:"curveHVH",value:function(){var e,t,n,r,a,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=this.cell,l=c.parent,s="";return c.x>l.x?(t=l.isStem?[l.x-c.x+l.width-36,l.y-c.y+l.height/2]:[l.x-c.x+l.width,l.y-c.y+l.height/2+i],(n=[0,c.height/2])[1]+=o,r=[t[0]+4,t[1]],e=(a=[n[0]-4,n[1]])[0]-r[0],s+="M".concat(t[0]," ").concat(t[1]," "),s+="L".concat(r[0]," ").concat(r[1]," "),s+="C".concat(r[0]+.5*e," ").concat(r[1],", ").concat(a[0]-.5*e," ").concat(a[1],", ").concat(a[0]," ").concat(a[1]," "),s+="L".concat(n[0]," ").concat(n[1]),"line"===c.border.shape&&(s+="L".concat(n[0]+c.width," ").concat(n[1]))):(t=l.isStem?[l.x-c.x+36,l.y-c.y+l.height/2]:[l.x-c.x,l.y-c.y+l.height/2+i],(n=[c.width,c.height/2])[1]+=o,r=[t[0]-4,t[1]],a=[n[0]+4,n[1]],e=r[0]-a[0],s+="M".concat(t[0]," ").concat(t[1]," "),s+="L".concat(r[0]," ").concat(r[1]," "),s+="C".concat(r[0]-.5*e," ").concat(r[1],", ").concat(a[0]+.5*e," ").concat(a[1],", ").concat(a[0]," ").concat(a[1]," "),s+="L".concat(n[0]," ").concat(n[1]),"line"===c.border.shape&&(s+="L".concat(n[0]-c.width," ").concat(n[1]))),s}},{key:"VHV",value:function(){var e,t,n=this.cell,r=n.parent,a={x:r.x-n.x,y:r.y-n.y},i="";n.y<r.y?(e=[a.x+r.width/2,a.y],t=[n.width/2,n.height]):(e=[a.x+r.width/2,a.y+r.height],t=[n.width/2,0]);var o=(e[1]+t[1])/2;return i+="M".concat(e[0]," ").concat(e[1]," "),i+="L".concat(e[0]," ").concat(o," "),(i+="L".concat(t[0]," ").concat(o," "))+"L".concat(t[0]," ").concat(t[1])}},{key:"HVH",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.cell,o=i.parent,c="";return i.x>o.x?(e=o.isStem?[o.x-i.x+o.width,o.y-i.y+o.height/2]:[o.x-i.x+o.width,o.y-i.y+o.height/2+r],(t=[0,i.height/2])[1]+=a,n=(o.x-i.x+o.width)/2,"line"===i.border.shape&&(t[0]+=i.width)):(e=1===i.depth?[o.x-i.x,o.y-i.y+o.height/2]:[o.x-i.x,o.y-i.y+o.height/2+r],(t=[i.width,i.height/2])[1]+=a,n=(o.x-i.x+i.width)/2,"line"===i.border.shape&&(t[0]-=i.width)),c+="M".concat(e[0]," ").concat(e[1]," "),c+="L".concat(n," ").concat(e[1]," "),(c+="L".concat(n," ").concat(t[1]," "))+"L".concat(t[0]," ").concat(t[1])}},{key:"curveVHV",value:function(){var e,t,n,r,a,i=this.cell,o=i.parent,c={x:o.x-i.x,y:o.y-i.y},l="",s=1===i.depth?0:8;return i.y<o.y?(t=[c.x+o.width/2,c.y],n=[i.width/2,i.height],r=[t[0],t[1]-s],a=[n[0],n[1]+0],e=r[1]-a[1]):(t=[c.x+o.width/2,c.y+o.height],n=[i.width/2,0],r=[t[0],t[1]+s],a=[n[0],n[1]-0],e=r[1]-a[1]),l+="M".concat(t[0]," ").concat(t[1]," "),l+="L".concat(r[0]," ").concat(r[1]," "),(l+="C".concat(r[0]," ").concat(r[1]-.5*e,", ").concat(a[0]," ").concat(a[1]+.5*e,", ").concat(a[0]," ").concat(a[1]," "))+"L".concat(n[0]," ").concat(n[1])}},{key:"getStandardLayoutPath",value:function(){var e=this.cell,t=e.parent,n=e.computedProps,r=e.upDirection,a=n.treeEdge.shape;if(0===r[0])return"polyline"===a?this.VHV():this.curveVHV();var i=0,o=0;return"line"===t.border.shape&&(i=t.height/2),"line"===e.border.shape&&(o=e.height/2),"polyline"===a?this.HVH(i,o):this.curveHVH(i,o)}},{key:"getIndentLayoutPath",value:function(){var e,t,n=this.cell,r=n.computedProps,a=n.border,i=n.parent,o=r.treeEdge.shape,c={x:i.x-n.x,y:i.y-n.y},l=i.x+i.width/2-(n.x+n.width)>0,s=i.y-n.y-n.height>0,u="";if(s?(e=[c.x+i.width/2,c.y],t=l?"line"===a.shape?[0,n.height]:[n.width,n.height/2]:"line"===a.shape?[n.width,n.height]:[0,n.height/2]):(e=[c.x+i.width/2,c.y+i.height],t=l?"line"===a.shape?[0,n.height]:[n.width,n.height/2]:"line"===a.shape?[n.width,n.height]:[0,n.height/2]),"polyline"===o)u+="M".concat(e[0],",").concat(e[1]),u+="L".concat(e[0],",").concat(t[1]),u+="L".concat(t[0],",").concat(t[1]);else{var d=16;if(u+="M".concat(e[0],",").concat(e[1]),s){var f=Math.abs(t[1]-e[1]);f<=d&&(d=f),l?(u+="L".concat(e[0],",").concat(t[1]+d),u+="A ".concat(d," ").concat(d,", 0, 0, 0, ").concat(e[0]-d,", ").concat(t[1]),u+="L".concat(t[0],",").concat(t[1])):(u+="L".concat(e[0],",").concat(t[1]+d),u+="A ".concat(d," ").concat(d,", 0, 0, 1, ").concat(e[0]+d,", ").concat(t[1]),u+="L".concat(t[0],",").concat(t[1]))}else l?(u+="L".concat(e[0],",").concat(t[1]-d),u+="A ".concat(d," ").concat(d,", 0, 0, 1, ").concat(e[0]-d,", ").concat(t[1]),u+="L".concat(t[0],",").concat(t[1])):(u+="L".concat(e[0],",").concat(t[1]-d),u+="A ".concat(d," ").concat(d,", 0, 0, 0, ").concat(e[0]+d,", ").concat(t[1]),u+="L".concat(t[0],",").concat(t[1]))}return u}},{key:"getTimelineLayoutPath",value:function(){var e,t=this.cell,n=t.upSignX,r=t.getTimelineLayoutAlign(),a=t.getTimelineLayoutSourceCell(),i={x:a.x-t.x,y:a.y-t.y},o=[0,0];return 1===n?(e="b"===r[0]?[i.x+a.width,i.y+a.height]:[i.x+a.width,i.y+a.height/2],o="b"===r[1]?[t.width,t.height]:[0,t.height/2]):-1===n&&(e="b"===r[0]?[i.x,i.y+a.height]:[i.x,i.y+a.height/2],o="b"===r[1]?[0,t.height]:[t.width,t.height/2]),e&&"M".concat(e[0],",").concat(e[1]," L").concat(o[0],",").concat(o[1])}},{key:"getAbstractLayoutPath",value:function(){var e=this.cell,t=e.al,n=void 0===t?10:t,r=e.ad,a=void 0===r?"x":r,i=e.ap,o=void 0===i?1:i,c=e.width,l=void 0===c?2:c,s=e.height,u=void 0===s?2:s,d=e.computedProps.treeEdge.shape,f=[0,0],h=[0,0],p=[0,0];"x"===a?(f[0]+=.5*l,f[1]+=(1-(o+1)/2)*u,h[0]=f[0]-n/2,p[0]=f[0]+n/2,h[1]=p[1]=f[1]-48*o):(f[0]+=(1-(o+1)/2)*l,f[1]+=.5*u,h[1]=f[1]-n/2,p[1]=f[1]+n/2,h[0]=p[0]=f[0]-48*o);var m="y"===a?[h[0]+12*o,h[1]]:[h[0],h[1]+12*o],y="y"===a?[p[0]+12*o,p[1]]:[p[0],p[1]+12*o],v="y"===a?[f[0]-0*o,f[1]]:[f[0],f[1]-0*o],g="y"===a?[v[0]-16*o,v[1]]:[v[0],v[1]-16*o];return"polyline"===d?"y"===a?"M".concat(m[0],",").concat(m[1]," L").concat(g[0],",").concat(m[1]," L").concat(g[0],",").concat(y[1]," L").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]):"M".concat(m[0],",").concat(m[1]," L").concat(m[0],",").concat(g[1]," L").concat(y[0],",").concat(g[1]," L").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]):"y"===a?"M".concat(m[0],",").concat(m[1]," Q").concat(g[0],",").concat(m[1]," ").concat(g[0],",").concat(g[1]," Q").concat(g[0],",").concat(y[1]," ").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]):"M".concat(m[0],",").concat(m[1]," Q").concat(m[0],",").concat(g[1]," ").concat(g[0],",").concat(g[1]," Q").concat(y[0],",").concat(g[1]," ").concat(y[0],",").concat(y[1]," M").concat(g[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1])}},{key:"getPath",value:function(){var e=this.cell,t=e.upLayoutType,n=e.isAbstract;return t||n?n?this.getAbstractLayoutPath():"indent"===t?this.getIndentLayoutPath():"timeline"===t?this.getTimelineLayoutPath():this.getStandardLayoutPath():""}},{key:"getSytle",value:function(){var e=this.cell;return{stroke:e.computedProps.treeEdge.stroke,"stroke-width":e.getTreeEdgeStrokeWidth()}}},{key:"drawClipPath",value:function(){var e=this.cell,t=this.treeEdgeClipPath;if(t){var n=e.parent,r={x:n.x-e.x,y:n.y-e.y},a=n.getPadding(),i=[r.x+a[3],r.y+a[0]],o=[r.x+n.width-a[1],r.y+n.height-a[2]],c=[Math.min(0,r.x)-50,Math.min(0,r.y)-50],l=[Math.max(e.width,r.x+n.width)+50,Math.max(e.height,r.y+n.height)+50];t.update({d:nn(c[0],c[1],l[0],l[1],i[0],i[1],o[0],o[1])})}}},{key:"_drawPath",value:function(){var e=this.cell,t=this.element,n=e.cache,r=this.getPath();n.treeEdgePath!==r&&(t.update({d:r}),n.treeEdgePath=r,this.drawClipPath())}},{key:"drawPosition",value:function(){this._drawPath()}},{key:"drawInherit",value:function(){this.draw()}},{key:"draw",value:function(){this.createRendererElement();var e=this.cell,t=this.element,n=e.cache,r=this.getSytle(),a=Pt(r,n.treeEdgeStyle,["stroke","stroke-width"]);this._drawPath(),Object.keys(a).length>0&&(t.update(a),n.treeEdgeStyle=s()(r))}},{key:"destroy",value:function(){this.element.destroy(),this.clipPath&&this.clipPath.destroy()}}]),n}();function Zp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Wp,"className","TreeEdge"),c()(Wp,"configName","treeEdge"),c()(Wp,"zIndex",1);var Up=function(e){S()(n,du);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t=1===e.depth?400:"normal",r=1===e.depth?'PingFangSC-Medium, "PingFang SC"':'PingFangSC-Regular, "PingFang SC"';I()(L()(n.prototype),"init",this).call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zp(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"0.1px","font-size":"".concat(14,"px"),"font-weight":"".concat(t),"line-height":"1.74","word-break":"break-word"}}],defaultFontFamily:r},e))}},{key:"_calculateCapsulePadding",value:function(){var e=this.width,t=this.height;return e&&t?Math.min(e,t)*(1-Math.sin(Math.PI/4))/2:this.minHeight*(1-Math.sin(Math.PI/4))/2}},{key:"getPadding",value:function(){var e,t=this.model;if(1===this.depth)if("line"===this.border.shape)e=[2,8,2,8];else if("rect"===this.border.shape)e=[6,12,6,12];else{var r=this._calculateCapsulePadding();e=new Array(4).fill(r)}else if(this.depth>1)if("line"===this.border.shape)e=[2,8,2,8];else if("rect"===this.border.shape)e=[6,8,6,8];else{var a=this._calculateCapsulePadding();e=new Array(4).fill(a)}else e=I()(L()(n.prototype),"getPadding",this).call(this);return t.note&&(e[1]/=2),e}},{key:"isAbstract",get:function(){return this.model.abstract}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{mindmapCollapseButton:{},border:{outer:0,radius:3,shape:"line",fill:"transparent"},treeEdge:{},Subcells:[Wp,Hp]})}}]),n}();c()(Up,"className","MindmapCell");var Kp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,e),c()(this,"zNodes",[]),c()(this,"options",{}),this.options=t,Object.assign(this,t)}return v()(e,[{key:"getHGap",value:function(e){return 20}},{key:"getVGap",value:function(e){return 20}},{key:"getAGap",value:function(e){return 48}},{key:"beforeInsert",value:function(e){var t=this.zNodes;e.isSubTree?t.unshift.apply(t,D()(e.zNodes)):t.unshift(e)}},{key:"getAxisNorm",value:function(e,t,n){var r=e.isSubTree?"t":"";return{axis:r+t,norm:r+n}}},{key:"getAxisNormValue",value:function(e,t,n){var r=e.isSubTree?"t":"",a=r+t,i=r+n;return{coord:null==e[a]?e[t]:e[a],normValue:null==e[i]?e[n]:e[i]}}},{key:"getPureAxisNormValue",value:function(e,t,n){return{coord:e[t],normValue:e[n]}}},{key:"updateParentMaxDepth",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.parent;r;)r.maxDepth=n?Math.max(r.maxDepth,t):Math.min(r.maxDepth,t),r=r.parent}},{key:"setNodeCoord",value:function(e,t,n){if(e.isSubTree){var r="t"+t,a=e[r]-n;at(e,(function(e){e.isSubTree&&(e[r]-=a),e[t]-=a}))}else e[t]=n}},{key:"preOrder",value:function(e,t,n){var r=this,a=e.children,i=void 0===a?[]:a;t(e,n),!i||e.isSubTree&&n||e.collapsed||i.forEach((function(n){r.preOrder(n,t,e)}))}},{key:"preOrderWithOutSelf",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=e.children,l=void 0===c?[]:c;if(l&&(!e.isSubTree||!n)&&!e.collapsed){var s=o.concat(l.filter((function(e){return!e.abstract})).length);l.forEach((function(n,o){var c=i.concat(o);t(n,e,o,l,a,c,s),r.preOrderWithOutSelf(n,t,e,a+1,c,s)}))}}},{key:"postOrder",value:function(e,t,n){var r=this,a=e.children,i=void 0===a?[]:a;!i||e.isSubTree&&n||e.collapsed||i.forEach((function(n){r.postOrder(n,t,e)})),t(e,n)}},{key:"postOrderWithOutSelf",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=e.children,l=void 0===c?[]:c;if(l&&(!e.isSubTree||!n)&&!e.collapsed){var s=o.concat(l.filter((function(e){return!e.abstract})).length);l.forEach((function(n,o){var c=i.concat(o);r.postOrderWithOutSelf(n,t,e,a+1,c,s),t(n,e,o,l,a,c,s)}))}}},{key:"orderByGroupWithoutSelf",value:function(e,t,n){var r=this,a=new Map,i=n.initInfo,o=n.enterGroup,c=n.exitGroup,l=n.beforecallback,s=n.callback,u=n.aftercallback;return e.call(this,t,(function(e,t,n,d,f,h,p){if(0===n){var m=d.filter((function(e){return e.abstract})),y=m.length,v=d.length-y,g=[];m.forEach((function(e){var t=r.getAbstractLocateString(e,v);g.push(t)}));var b={areasQueue:g,nowGroup:null,groupIndex:-1,childrenLength:v,abstractLength:y,nowGroupData:void 0};a.set(t,Object.assign(b,i(b,e,t,n,d,f,h,p)))}var x=a.get(t);if(l&&n<x.childrenLength&&l(x,e,t,n,d,f,h,p),!x.nowGroup){var k=x.areasQueue[0]?r.parseAbstractLocateString(x.areasQueue[0]):void 0;k&&n===k[0]&&(x.nowGroup=k,x.areasQueue.shift(),x.groupIndex++,o&&(x.nowGroupData=o(x,e,t,n,d,f,h,p)))}s&&n<x.childrenLength&&s(x,e,t,n,d,f,h,p),!x.nowGroup||n!==x.nowGroup[0]+x.nowGroup[1]-1&&n!==x.childrenLength-1||(c&&c(x,e,t,n,d,f,h,p),x.nowGroup=null,x.nowGroupData=void 0),u&&n<x.childrenLength&&u(x,e,t,n,d,f,h,p)})),a}},{key:"postOrderByGroupWithoutSelf",value:function(e,t){return this.orderByGroupWithoutSelf(this.postOrderWithOutSelf,e,t)}},{key:"preOrderByGroupWithoutSelf",value:function(e,t){return this.orderByGroupWithoutSelf(this.preOrderWithOutSelf,e,t)}},{key:"deeperAllLast",value:function(e,t,n){for(var r=e+1;r<t.length;r++)if(t[r]!==n[r]-1)return!1;return!0}},{key:"makeAbstractBreadthOffset",value:function(e,t,n,r,a,i,o,c){var l="x"===e?"x":"y",s="x"===e?"w":"h",u=this.getAxisNorm(i,l,s),d=u.norm,f=u.axis,h=i[d],p=Math.abs(c-o),m=(c+o)/2,y=i[s]/2+i[l]-i[f],v=h-y,g=t?Math.max(y-p/2,0):Math.min(p/2-v,0),b=m+g-y;if(this.setNodeCoord(i,l,b),0!==g)for(var x=r[0];x<r[0]+r[1];x++){var k=a[x];"x"===l?this.move(k,g,0):this.move(k,0,g)}var w=t?Math.max(c+g,i[d]+i[f]):Math.min(c+g,i[f]),C=Math.abs(w-o);return i.al=p,i.ad=l,i.ap=n?1:-1,i.breadthPositive=t?1:-1,[g,C,w]}},{key:"move",value:function(e,t,n){at(e,(function(e){e.x+=t,e.y+=n,e.isSubTree&&(e.tx+=t,e.ty+=n)}))}},{key:"moveX",value:function(e,t){at(e,(function(e){e.x+=t,e.isSubTree&&(e.tx+=t)}))}},{key:"moveY",value:function(e,t){at(e,(function(e){e.y+=t,e.isSubTree&&(e.ty+=t)}))}},{key:"layout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.constructor.VAILD_DIRECTION_ANGLES,r=e.directionAngle;this.zNodes=t,n.some((function(e){return Ji(e,r)}))?(this.setKeys(e),this.normalize(e),this.setCoord(e),this.setZIndex(e)):console.warn("The layout does not support the direction")}},{key:"getAbstractLocateString",value:function(e,t){var n=e.start,r=void 0===n?0:n,a=e.end,i=void 0===a?0:a,o=Math.max(0,r);return o+":"+(Math.min(t,i)-o+1)}},{key:"parseAbstractLocateString",value:function(e){return e.split(":").map((function(e){return parseInt(e)}))}},{key:"setKeys",value:function(e){}},{key:"normalize",value:function(e){}},{key:"setCoord",value:function(e){}},{key:"setZIndex",value:function(e){}}]),e}();c()(Kp,"VAILD_DIRECTION_ANGLES",[]),c()(Kp,"QUADRANTS",4);var Qp=function(e){S()(n,Kp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"breadthAxis","y"),c()(E()(e),"depthAxis","x"),c()(E()(e),"breadthNorm","h"),c()(E()(e),"depthNorm","w"),c()(E()(e),"mainGap","vgap"),c()(E()(e),"secondaryGap","hgap"),c()(E()(e),"isMainPositive",!1),c()(E()(e),"isPositive",!1),e}return v()(n,[{key:"setKeys",value:function(e){var t=e.directionAngle,n=this.constructor.MAIN_AXIS,r=!1,a=!1;Ji(t,Math.PI/4)?(r=!0,a=!0):Ji(t,3*Math.PI/4)?(r=!1,a=!0):Ji(t,5*Math.PI/4)?(r=!1,a=!1):Ji(t,7*Math.PI/4)&&(r=!0,a=!1),"x"===n?(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.isMainPositive=r,this.isPositive=a):(this.breadthAxis="y",this.depthAxis="x",this.breadthNorm="h",this.depthNorm="w",this.mainGap="vgap",this.secondaryGap="hgap",this.isMainPositive=a,this.isPositive=r)}},{key:"normalize",value:function(e){var t=this;this.preOrder(e,(function(e){var n={node:e};e.vgap=t.getVGap(n),e.hgap=t.getHGap(n)}))}},{key:"setCoord",value:function(e){this._setMainCoord(e),this._setSecondaryCoord(e)}},{key:"_setMainCoord",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm,a=this.mainGap,i=this.isMainPositive,o=this.isPositive,c=e[n],l=e[r],s=[];this.preOrderByGroupWithoutSelf(e,{initInfo:function(){return{smin:0}},beforecallback:function(e,o){var s,u=t.getAxisNorm(o,n,r).norm,d=o[a],f=o[u];c=s=i?c+l+d:c-f-d,l=f,t.setNodeCoord(o,n,s)},enterGroup:function(e){e.smin=i?c:c+l},exitGroup:function(e,t,n,r,a,i){var o=e.nowGroup,c=a[e.childrenLength+e.groupIndex];s.unshift({smin:e.smin,depth:i,siblings:a,nowGroup:o,abstractNode:c})},aftercallback:function(e,r,a,u,d,f,h,p){if(!r.children||0===r.children.length||r.isSubTree)for(;s.length>0;){var m=s[0],y=m.nowGroup,v=m.siblings,g=m.smin,x=m.depth,k=m.abstractNode;if(!t.deeperAllLast(x,h,p))break;s.shift();var w=i?c+l:c,C=t.makeAbstractBreadthOffset(n,i,o,y,v,k,g,w),A=b()(C,3);A[0];var O=A[1],E=A[2];c=i?g:E,l=O}}})}},{key:"_setSecondaryCoord",value:function(e){var t=this,n=this.depthAxis,r=this.depthNorm,a=this.secondaryGap,i=this.isPositive,o=i?1:-1;this.preOrderWithOutSelf(e,(function(e,c){var l,s=t.getAxisNorm(e,n,r).norm,u=e[a];if(!e.abstract){var d=(l=i?c[n]+c[r]/2+u:c[n]+c[r]/2-e[s]-u)+(o+1)/2*e[s];e.maxDepth=d,t.updateParentMaxDepth(e,d,i),t.setNodeCoord(e,n,l)}})),this.postOrderByGroupWithoutSelf(e,{initInfo:function(){return{maxDepth:void 0}},callback:function(e,t){var n=t.maxDepth,r=void 0===n?0:n,a=e.nowGroupData;e.nowGroup&&(e.nowGroupData=a?i?Math.max(a,r):Math.min(a,r):r)},exitGroup:function(e,a,c,l,s){var u=e.childrenLength,d=e.groupIndex,f=e.nowGroupData,h=void 0===f?0:f,p=s[u+d],m=t.getAxisNorm(p,n,r).norm,y=i?h+o*t.getAGap():h+o*t.getAGap()-p[m];t.setNodeCoord(p,n,y);var v=y+(o+1)/2*p[m];t.updateParentMaxDepth(p,v,i)}})}},{key:"setZIndex",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(e,(function(a){var i=a.children;if(e!==a&&t.beforeInsert(a),i&&!a.collapsed){var o=a[n]+a[r]/2;i.sort((function(e,t){return Math.abs(e[n]+e[r]-o)-Math.abs(t[n]+t[r]-o)}))}}))}},{key:"getHGap",value:function(e){return 16}},{key:"getVGap",value:function(e){var t=e.node,n=t.parent;return n&&t===n.children[0]&&-1===t.upSignY?24:8}}]),n}();c()(Qp,"className","Indent"),c()(Qp,"VAILD_DIRECTION_ANGLES",[Math.PI/4,3*Math.PI/4,5*Math.PI/4,7*Math.PI/4]),c()(Qp,"QUADRANTS",4),c()(Qp,"MAIN_AXIS","y");var Jp=function(e){S()(n,Kp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"depthAxis",void 0),c()(E()(e),"depthNorm",void 0),c()(E()(e),"breadthGap",void 0),c()(E()(e),"depthGap",void 0),c()(E()(e),"breadthAxis",void 0),c()(E()(e),"breadthNorm",void 0),c()(E()(e),"isVertical",!1),c()(E()(e),"isPositive",void 0),e}return v()(n,[{key:"setKeys",value:function(e){var t=e.directionAngle,n=Ji(t,Math.PI/2)||Ji(t,3*Math.PI/2);n?(this.breadthAxis="x",this.breadthNorm="w",this.breadthGap="hgap",this.depthAxis="y",this.depthNorm="h",this.depthGap="vgap"):(this.breadthAxis="y",this.breadthNorm="h",this.breadthGap="vgap",this.depthAxis="x",this.depthNorm="w",this.depthGap="hgap"),Ji(t,0)||Ji(t,Math.PI/2)?this.isPositive=!0:this.isPositive=!1,this.isVertical=n}},{key:"normalize",value:function(e){var t=this,n=this.isVertical;this.preOrderWithOutSelf(e,(function(e,t){e.ancestors=[t].concat(t.ancestors||[])})),this.preOrder(e,(function(e){var r={node:e,isVertical:n};e.vgap=t.getVGap(r),e.hgap=t.getHGap(r)}))}},{key:"setCoord",value:function(e){this._setDepth(e),this._setBreadth(e)}},{key:"_setDepth",value:function(e){var t=this,n=this.depthAxis,r=this.depthNorm,a=this.depthGap,i=this.isPositive,o=i?1:-1;this.preOrderWithOutSelf(e,(function(e,c){var l=t.getAxisNorm(e,n,r).norm;if(!e.abstract){var s,u=e[a],d=(s=i?c[n]+c[r]+u:c[n]-e[l]-u)+(o+1)/2*e[l];e.maxDepth=d,t.updateParentMaxDepth(e,d,i),t.setNodeCoord(e,n,s)}})),this.postOrderByGroupWithoutSelf(e,{initInfo:function(){return{maxDepth:void 0}},callback:function(e,t){var n=t.maxDepth,r=void 0===n?0:n,a=e.nowGroupData;e.nowGroup&&(e.nowGroupData=a?i?Math.max(a,r):Math.min(a,r):r)},exitGroup:function(e,a,c,l,s){var u=e.childrenLength,d=e.groupIndex,f=e.nowGroupData,h=void 0===f?0:f,p=s[u+d],m=t.getAxisNorm(p,n,r).norm,y=i?h+o*t.getAGap():h+o*t.getAGap()-p[m];t.setNodeCoord(p,n,y);var v=y+(o+1)/2*p[m];t.updateParentMaxDepth(p,v,i)}})}},{key:"_setBreadth",value:function(e){var t,n=this,r=this.breadthAxis,a=this.breadthNorm,i=this.breadthGap,o=this.isVertical,c=this.isPositive,l=e.x,s=e.y;this.postOrderByGroupWithoutSelf(e,{initInfo:function(e,t,n,r,a){return{smin:0,emax:0}},beforecallback:function(e,c,l,s,u){var d,f,h,p=n.getAxisNorm(c,r,a),m=p.axis,y=p.norm,v=c.children,g=void 0===v?[]:v,b=c.abstract;if(void 0===t)f=0;else if(0===g.length||c.collapsed||c.isSubTree){if(b)return;var x=n.getBreadthGap(c,t);f=t.maxBreadth+x}else{f=n.getBreadthByChildren({children:g.filter((function(e){return!e.abstract})),breadthAxis:r,node:c,breadthNorm:a,norm:y,isVertical:null!=o&&o}),c.minBreadth=Math.min(c.minBreadth,f);var k=l.children[l.children.indexOf(c)-1];if(k){var w=k.maxBreadth+k[i]-c.minBreadth;w>0&&(h=w)}}n.setNodeCoord(c,r,f),h&&(o?n.move(c,h,0):n.move(c,0,h),c.maxBreadth+=h);var C=c[m]+c[y];c.maxBreadth=Math.max(C,c.maxBreadth||0);var A,O=c[m];c.minBreadth=Math.min(O,null!==(d=c.minBreadth)&&void 0!==d?d:1/0),0===s&&(l.minBreadth=Math.min(O,c.minBreadth,null!==(A=l.minBreadth)&&void 0!==A?A:1/0))},enterGroup:function(e,t,n,r,a){e.smin=t.minBreadth},exitGroup:function(e,t,a,i,o){e.emax=t.maxBreadth;var l=e.childrenLength,s=e.groupIndex,u=e.smin,d=e.emax,f=e.nowGroup,h=o[l+s],p=n.makeAbstractBreadthOffset(r,!0,c,f,o,h,u,d),m=b()(p,3);m[0],m[1];var y=m[2];t.maxBreadth=y},aftercallback:function(e,n,r,a,i){var o;t=n,a===e.childrenLength-1&&(r.maxBreadth=r.maxBreadth=Math.max(t.maxBreadth,null!==(o=r.maxBreadth)&&void 0!==o?o:-1/0))}}),e[r]=this.getBreadthByChildren({children:e.children.filter((function(e){return!e.abstract})),breadthAxis:r,node:e,breadthNorm:a,norm:a,isVertical:o}),o?this.move(e,l-e.x,0):this.move(e,0,s-e.y)}},{key:"getBreadthGap",value:function(e,t){var n,r,a=this.breadthGap;if(e.parent===t.parent)return t[a];e.depth<t.depth?(n=t,r=e):(n=e,r=t);for(var i=n.depth-r.depth,o=0;o<r.ancestors.length;o++){var c=o+i;if(r.ancestors[o]===n.ancestors[c])return n.ancestors[c-1][a]}}},{key:"getBreadthByChildren",value:function(e){var t=e.children,n=e.breadthAxis,r=e.node,a=e.breadthNorm,i=e.isVertical,o=t.length,c=this.getPureAxisNormValue(t[0],n,a),l=this.getPureAxisNormValue(t[o-1],n,a),s=this.getPureAxisNormValue(r,n,a);if(!i&&t[0].border&&r.border){if("line"===t[0].border.shape&&"line"===r.border.shape)return(c.coord+c.normValue+l.coord+l.normValue)/2-s.normValue;if("line"===t[0].border.shape&&"line"!==r.border.shape)return(c.coord+c.normValue+l.coord+l.normValue-s.normValue)/2;if("line"!==t[0].border.shape&&"line"===r.border.shape&&t[0]===t[o-1])return c.coord+c.normValue/2-s.normValue}return(c.coord+l.coord+l.normValue-s.normValue)/2}},{key:"setZIndex",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(e,(function(a){var i=a.children;if(e!==a&&t.beforeInsert(a),i&&!a.collapsed){var o=a[n]+a[r]/2;i.sort((function(e,t){return Math.abs(e[n]+e[r]-o)-Math.abs(t[n]+t[r]-o)}))}}))}},{key:"getHGap",value:function(e){var t=e.isVertical,n=e.node.depth;return t?1===n?48:24:n>1?48:64}},{key:"getVGap",value:function(e){var t,r=e.isVertical,a=e.node,i=a.depth,o=a.border;return o?(r?t=64:1===i?t=24:(t=2===i?10:8,"line"!==o.shape&&(t*=2)),t):I()(L()(n.prototype),"getVGap",this).call(this)}}]),n}();function $p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(Jp,"className","Standard"),c()(Jp,"VAILD_DIRECTION_ANGLES",[0,Math.PI/2,Math.PI,3*Math.PI/2]),c()(Jp,"QUADRANTS",2);var em=function(e){S()(n,Kp);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e=t.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$p(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r)),c()(E()(e),"breadthAxis","x"),c()(E()(e),"depthAxis","y"),c()(E()(e),"breadthNorm","w"),c()(E()(e),"depthNorm","h"),c()(E()(e),"mainGap","hgap"),c()(E()(e),"secondaryGap","vgap"),c()(E()(e),"secondaryDownSign","downSignY"),c()(E()(e),"isMainPositive",!0),c()(E()(e),"hgap1",40),c()(E()(e),"hgap2",32),c()(E()(e),"vgap1",0),c()(E()(e),"vgap2",0),c()(E()(e),"compact",!1),e}return v()(n,[{key:"getAlign",value:function(e){return e.node.cell.getTimelineLayoutAlign()}},{key:"normalize",value:function(e){var t=this;this.preOrder(e,(function(e){var n={node:e};e.align=t.getAlign(n)}))}},{key:"setKeys",value:function(e){var t=e.directionAngle;Ji(t,0)?(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.secondaryDownSign="downSignY",this.isMainPositive=!0):Ji(t,Math.PI)&&(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.secondaryDownSign="downSignY",this.isMainPositive=!1)}},{key:"setCoord",value:function(e){this._setMainCoord(e),this._setSecondaryCoord(e)}},{key:"_setMainCoord",value:function(e){var t=this,n=this.secondaryDownSign,r=this.breadthAxis,a=this.breadthNorm,i=this.mainGap,o=this.isMainPositive,c=this.compact,l="".concat(i,"1"),s="".concat(i,"2"),u=o?1:-1,d=e[r];o&&(d+=e[a]);var f=d,h=d,p=d,m=[];this.preOrderByGroupWithoutSelf(e,{initInfo:function(e,t,n,r,a,i,o,c){return{smin:0}},beforecallback:function(e,i,m,y,v,g,b,x){var k,w=t.getAxisNorm(i,r,a).norm,C=p-f,A=p-h;-1===i[n]&&c?(u*C>0?(k=t[l],d=p):(k=t[s],d=f),o?(f=(d+=k)+i[w],p=d+i[a]):(d=d-k-i[w],f=d,p=d+(i[w]-i[a]))):(u*A>0?(k=t[l],d=p):(k=t[s],d=h),o?(h=(d+=k)+i[w],p=d+i[a]):(d=d-k-i[w],h=d,p=d+(i[w]-i[a]))),t.setNodeCoord(i,r,d)},enterGroup:function(e,n){var i=t.getAxisNorm(n,r,a).norm;e.smin=o?d:d+n[i]},exitGroup:function(e,t,n,r,a,i){var o=e.nowGroup,c=a[e.childrenLength+e.groupIndex];m.unshift({smin:e.smin,depth:i,siblings:a,nowGroup:o,abstractNode:c})},aftercallback:function(e,n,a,i,c,l,s,u){if(!n.children||0===n.children.length||n.isSubTree)for(;m.length>0;){var d=m[0],f=d.nowGroup,y=d.siblings,v=d.smin,g=d.depth,x=d.abstractNode;if(!t.deeperAllLast(g,s,u))break;m.shift();var k=x.downDirection,w=(void 0===k?[0,1]:k)[1]>=0,C=h,A=t.makeAbstractBreadthOffset(r,o,w,f,y,x,v,C),O=b()(A,3),E=O[0];O[1];var P=O[2];h=P,p+=E}}})}},{key:"_setSecondaryCoord",value:function(e){var t,n,r=this,a=this.depthAxis,i=this.depthNorm,o=e.children,c=void 0===o?[]:o,l=a.toUpperCase(),s=this["move".concat(l)].bind(this);c.forEach((function(r,o){var l=0===o?e:c[o-1],u=r.align;if(!r.abstract){"b"===u[0]?t=l[a]+l[i]:"c"===u[0]&&(t=l[a]+l[i]/2),"c"===u[1]?n=function(e){return t-e[i]/2}:"b"===u[1]&&(n=function(e){return t-e[i]});var d=n(r)-r[a];s(r,d)}})),this.preOrderByGroupWithoutSelf(e,{initInfo:function(){return{}},callback:function(e,t,n,o,c){var l=e.nowGroupData,s=e.nowGroup,u=c[e.childrenLength+e.groupIndex].downDirection,d=(void 0===u?[0,1]:u)[1]>=0,f=r.getAxisNorm(t,a,i),h=f.norm,p=f.axis;if(s){var m=d?t[p]+t[h]:t[p];e.nowGroupData=l?d?Math.max(l,m):Math.min(l,m):m}},exitGroup:function(e,t,n,o,c){var l=e.childrenLength,s=e.groupIndex,u=e.nowGroupData,d=void 0===u?0:u,f=c[l+s],h=f.downDirection,p=(void 0===h?[0,1]:h)[1]>=0,m=p?1:-1,y=r.getAxisNorm(f,a,i).norm,v=p?d+m*r.getAGap():d+m*r.getAGap()-f[y];r.setNodeCoord(f,a,v)}})}},{key:"setZIndex",value:function(e){var t=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(e,(function(a){var i=a.children;if(e!==a&&t.beforeInsert(a),i&&!a.collapsed){var o=a[n]+a[r]/2;i.sort((function(e,t){return Math.abs(e[n]+e[r]-o)-Math.abs(t[n]+t[r]-o)}))}}))}}]),n}();function tm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(em,"className","Timeline"),c()(em,"VAILD_DIRECTION_ANGLES",[0,Math.PI]),c()(em,"QUADRANTS",2);var nm=function(e){S()(n,du);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({textareaContentStyleSheets:[{query:"self",css:{"letter-spacing":"normal","font-size":"18px","line-height":"1.74","word-break":"break-word",outline:"none",color:"white"}}],defaultFontFamily:'PingFangSC-Medium, "PingFang SC"'},e)),this.initLayoutEngine()}},{key:"minContentWidth",get:function(){return 52}},{key:"canCollapse",value:function(){return!1}},{key:"getPadding",value:function(){var e,t=this.model;if("capsule"===this.border.shape){var n=this._calculateCapsulePadding();e=new Array(4).fill(n)}else e=[6,16,6,16];return t.note&&(e[1]/=2),e}},{key:"_calculateCapsulePadding",value:function(){var e=this.width,t=this.height;return e&&t?Math.min(e,t)*(1-Math.sin(Math.PI/4))/2:this.minHeight*(1-Math.sin(Math.PI/4))/2}},{key:"_createLayoutModel",value:function(){var e=this.cellMap,t=this.model,n=[],r=ft(t,(function(t){var r,a,i,o,c,l,s=e[t.id],u={x:s.x,y:s.y,w:null!==(r=s.width)&&void 0!==r?r:10,h:null!==(a=s.height)&&void 0!==a?a:10,layout:s.layout.type,direction:null!==(i=s.layout.direction)&&void 0!==i?i:[1,0],quadrantConstraint:s.layout.quadrantConstraint,quadrant:null!==(o=s.layout.quadrant)&&void 0!==o?o:1,collapsed:null!==(c=s.collapsed)&&void 0!==c&&c,border:{shape:s.border.shape},cell:s,abstract:null!==(l=s.isAbstract)&&void 0!==l&&l};return t.abstract&&(u.abstract=!0,u.start=t.start,u.end=t.end,u.layout="standard",u.direction=[1,0],u.quadrantConstraint=[1]),"timeline"===u.layout&&n.push(u),u}));return n.forEach((function(e){e.children.forEach((function(t,n){t.abstract||(t.layout&&!Si("timeline",t.layout)||(t.layout="indent",t.direction=[1,1],0===e.direction[1]?t.quadrantConstraint=n%2==0?[4]:[1]:t.quadrantConstraint=n%2==0?[1]:[2]),t.children&&t.children.forEach((function(t){t.layout||(t.layout="standard",t.direction=[1,0],-1===e.direction[0]?t.quadrantConstraint=[2]:t.quadrantConstraint=[1])})))}))})),r}},{key:"canRough",value:function(){return!0}},{key:"initLayoutEngine",value:function(){this.layoutHelper=new ed({beforeLayoutAdjust:function(e){e.needAfterAdjustedNodes=[];var t=24;it(e,(function(n){"timeline"!==n.parent.layout&&n.collapsed&&(1===n.downSignY?n.h+=t:-1===n.downSignY?(n.h+=t,e.needAfterAdjustedNodes.push({node:n,key:"y",value:t})):1===n.downSignX?n.w+=t:-1===n.downSignX&&(n.w+=t,e.needAfterAdjustedNodes.push({node:n,key:"x",value:t})))}))},afterLayoutAdjust:function(e){e.needAfterAdjustedNodes.forEach((function(e){var t=e.node,n=e.key,r=e.value;t[n]+=r}))},algorithms:{timeline:new em,standard:new Jp,indent:new Qp}})}},{key:"_layoutPosition",value:function(e){e.forEach((function(e){var t=e.cell;t.x=e.x||0,t.y=e.y||0}))}},{key:"_layoutZIndex",value:function(e){var t=this,n=this.diagram,r=n.rootGroup;n.contentEditor.isBegin||e.forEach((function(e,n){var a=e.cell;a.zIndex=n,a!==t&&r.insertBefore(a.graphicGroup,t.graphicGroup)}))}},{key:"_layoutdrectionAngle",value:function(e){e.forEach((function(e){e.cell.upDirection=e.upDirection,e.cell.downDirection=e.downDirection,e.cell.upLayoutType=e.upLayoutType,e.cell.downLayoutType=e.downLayoutType,e.cell.layoutQuadrantConstraint=e.quadrantConstraint||[1],e.cell.downSignX=e.downSignX,e.cell.downSignY=e.downSignY,e.cell.upSignX=e.upSignX,e.cell.upSignY=e.upSignY,e.cell.breadthPositive=e.breadthPositive,e.cell.ad=e.ad,e.cell.ap=e.ap,e.cell.al=e.al}))}},{key:"executeLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.layoutHelper,n=this._createLayoutModel();t.model=n,t.execute();var r=[],a=t.tree;at(a,(function(e){r.push(e)})),this._layoutPosition(r,e),this._layoutZIndex(a.zNodes),this._layoutdrectionAngle(r)}},{key:"drawInner",value:function(){this.subcells.forEach((function(e){e.draw()})),this.drawCollapse(),this.drawPosition()}},{key:"destroy",value:function(){this.layoutHelper.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{border:{outer:0,radius:4,shape:"rect",fill:"#596086","stroke-width":2,stroke:"transparent"},textarea:{className:"lake-diagram-mindmap-root"},layout:{type:"standard",direction:[1,0]},treeEdge:{stroke:"#959EA6"},tapered:!1,rainbow:!0,note:{width:20,height:20,padding:[0,8,0,0]}})}}]),n}();c()(nm,"className","MindmapStem");var rm={treeEdge:!0,layout:!0,roughFillStyle:!0},am=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"beforedraw",(function(t){t&&"remove"!==t.action&&(function(e,t){var n=e.stems.filter((function(e){return e.isMindmap}));n.length>0&&(t.inherit(rm,n),n.forEach((function(e){e.deepEach((function(t){t!==e&&t.drawInherit()}))})))}(t,e),function(e,t){if("update"===e.action){var n=e.models.filter((function(e){var n=t.find(e.id);return n&&n.isMindmap&&n.isStem}));n.length>0&&n.forEach((function(e){if(void 0!==e.tapered||void 0!==e.rainbow){var n=t.find(e.id);void 0!==e.rainbow&&(!1===e.rainbow?n.forEach((function(e){e.isAbstract||e.updateModel({treeEdge:{stroke:qn}})})):n.forEach((function(e,t){e.isAbstract||e.updateModel({treeEdge:{stroke:Yn[t%7]}})})),t.inherit(rm,[n])),n.deepEachWithoutSelf((function(e){e.drawInner()}))}}))}}(t,e))}))}}]),n}();var im=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterselect",(function(){var t=e.selector.selections;if(1===t.length&&t[0].isMindmap){var n=t[0];e.viewport.scrollIntoView(n)}}))}}]),n}();var om=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n=ye()((function(){var n=e.selector.selections;1===n.length&&n[0].isMindmap&&n[0].canCollapse()&&!(t=n[0]).model.isPlaceholder&&t.showCollapsedButton()}),16);this.bind(e,"afterselect",(function(){t&&t.hideCollapsedButton(),t=void 0,n()}))}}]),n}();var cm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"mindmapcell:mouseenter",(function(e){var t=e.cell;t.isMindmap&&!t.model.isPlaceholder&&t.highlight()})),this.bind(e,"mindmapcell:mouseleave",(function(e){var t=e.cell;t&&t.isMindmap&&t.unHighlight()}))}}]),n}();var lm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t;function n(){t&&t.hideCollapsedButton(),t=void 0}this.bind(e,"mindmapcell:mouseenter",(function(n){var r=n.cell;e.signal.dragging||e.signal.buttonDragCanvas||e.signal.vertexResizing||r.isMindmap&&!r.model.isPlaceholder&&r.canCollapse()&&(r.showCollapsedButton(),t=r)})),this.bind(e,"mindmapcell:mouseleave",(function(r){var a=r.cell,i=r.nativeEvent;if(!(e.signal.dragging||e.signal.buttonDragCanvas||e.signal.vertexResizing)){var o=e.selector.selections;!a||!a.isMindmap||1===o.length&&(1!==o.length||a.model.id===o[0].model.id)||i.relatedTarget&&i.relatedTarget.closest('[data-lake_mindmap_add_button="true"]')?a&&a.isMindmap&&1===o.length&&a.model.id===o[0].model.id&&(t=void 0):n()}})),this.bind(e,"addbutton:mouseleave",(function(){e.signal.dragging||e.signal.buttonDragCanvas||e.signal.vertexResizing||n()})),this.bind(e,"aftercommandexecute",(function(e){"Expand"===e.commandName&&n()}))}}]),n}();function sm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var um=function(){function e(){m()(this,e)}return v()(e,[{key:"createHotArea",value:function(e,t){var n=e.stem;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({child:e.child,stem:n},t)}},{key:"stem",value:function(){}},{key:"child",value:function(){}},{key:"prevSibling",value:function(){}},{key:"nextSibling",value:function(){}},{key:"betweenSibling",value:function(){}}]),e}();var dm=function(e){S()(n,um);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"stem",value:function(e){var t=e.child,n=e.hotAreas,r=e.postFix,a=50,i=60,o=t.upDirection,c=Math.sign(o[0]),l=t.children.filter((function(e){return!e.abstract})).length;0===c?(n.push(this.createHotArea(e,{minX:t.minX-a,minY:t.minY-i,maxX:t.maxX+a,maxY:(t.minY+t.maxY)/2,parent:t.id,id:t.id+"2"+r,nth:l,quadrant:2,color:"orange"})),n.push(this.createHotArea(e,{minX:t.minX-a,minY:(t.minY+t.maxY)/2,maxX:t.maxX+a,maxY:t.maxY+i,parent:t.id,id:t.id+"1"+r,nth:l,quadrant:1,color:"pink"}))):(n.push(this.createHotArea(e,{minX:t.minX-a,minY:t.minY-i,maxX:(t.minX+t.maxX)/2,maxY:t.maxY+i,parent:t.id,id:t.id+"2"+r,nth:l,quadrant:2,color:"orange"})),n.push(this.createHotArea(e,{minX:(t.minX+t.maxX)/2,minY:t.minY-i,maxX:t.maxX+a,maxY:t.maxY+i,parent:t.id,id:t.id+"1"+r,nth:l,quadrant:1,color:"pink"})))}},{key:"child",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.postFix,i=e.stem,o=n.upDirection,c=Math.sign(o[0]),l=this.createHotArea(e,{parent:n.id,id:NaN+n.id+a,nth:0,color:"green",quadrant:n.layout.quadrant,addOrder:"push",stem:i});0===c?n.minY>r.minY?Object.assign(l,{minX:n.minX,maxX:n.maxX,minY:n.maxY,maxY:n.maxY+60}):Object.assign(l,{minX:n.minX,maxX:n.maxX,minY:n.minY-60,maxY:n.minY}):n.minX>r.minX?Object.assign(l,{minX:n.maxX,minY:n.minY-0,maxX:n.maxX+100,maxY:n.maxY+0}):Object.assign(l,{minX:n.minX-100,minY:n.minY-0,maxX:n.minX,maxY:n.maxY+0}),t.push(l)}},{key:"prevSibling",value:function(e){var t,n,r=e.hotAreas,a=e.child,i=e.parent,o=e.index,c=e.postFix,l=a.upDirection,s=Math.sign(l[0]),u=this.createHotArea(e,{parent:i.id,id:void 0+a.id+i.id+c,quadrant:a.layout.quadrant,color:"yellow",nth:o});if(0===s){var d=1===a.depth&&1===a.layout.quadrant,f=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:(n=a.minX-16,f||d?n-50:n),minY:d?a.minY-50:a.minY,maxX:(a.minX+a.maxX)/2,maxY:f?a.maxY+50:a.maxY})}else{var h=1===a.depth&&1===a.layout.quadrant,p=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:h?a.minX-50:a.minX,minY:(t=a.minY-16,p||h?t-50:t),maxX:p?a.maxX+50:a.maxX,maxY:(a.minY+a.maxY)/2})}r.push(u)}},{key:"nextSibling",value:function(e){var t,n,r=e.hotAreas,a=e.child,i=e.parent,o=e.index,c=e.postFix,l=a.upDirection,s=Math.sign(l[0]),u=this.createHotArea(e,{parent:i.id,id:a.id+void 0+i.id+c,color:"red",nth:o+1,addOrder:"push",quadrant:a.layout.quadrant});if(0===s){var d=1===a.depth&&1===a.layout.quadrant,f=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:(a.minX+a.maxX)/2,minY:d?a.minY-50:a.minY,maxX:(n=a.maxX+16,f||d?n+50:n),maxY:f?a.maxY+50:a.maxY})}else{var h=1===a.depth&&1===a.layout.quadrant,p=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:h?a.minX-50:a.minX,minY:(a.minY+a.maxY)/2,maxX:p?a.maxX+50:a.maxX,maxY:(t=a.maxY+16,p||h?t+50:t)})}r.push(u)}},{key:"betweenSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.next,o=e.postFix,c=n.upDirection,l=Math.sign(c[0]),s=this.createHotArea(e,{parent:r.id,id:n.id+(i?i.id:void 0)+r.id+o,quadrant:n.layout.quadrant,color:"blue",nth:a+1});if(0===l){var u=1===n.depth&&1===n.layout.quadrant,d=1===n.depth&&2===n.layout.quadrant;Object.assign(s,{minX:(n.minX+n.maxX)/2,minY:2===n.layout.quadrant?Math.max(n.minY,i.minY):u?n.minY-50:n.minY,maxX:(i.minX+i.maxX)/2,maxY:1===n.layout.quadrant?Math.min(n.maxY,i.maxY):d?n.maxY+50:n.maxY})}else Object.assign(s,{minX:2===n.layout.quadrant?n.minX:1===n.depth?n.minX-50:n.minX,minY:(n.minY+n.maxY)/2,maxX:1===n.layout.quadrant?n.maxX:1===n.depth?n.maxX+50:n.maxX,maxY:(i.minY+i.maxY)/2});t.push(s)}}]),n}();var fm=function(e){S()(n,um);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"stem",value:function(e){var t=e.child,n=e.hotAreas,r=e.postFix,a=t.upDirection,i=Math.sign(a[0]),o=Math.sign(a[1]),c=this.createHotArea(e,{parent:t.id,id:t.id+"1"+r,nth:0,quadrant:1,color:"pink"});1===i&&1===o?Object.assign(c,{minX:(t.minX+t.maxX)/2,minY:(t.minY+t.maxY)/2,maxX:t.maxX+50,maxY:t.maxY+30}):-1===i&&1===o?Object.assign(c,{minX:t.minX-50,minY:(t.minY+t.maxY)/2,maxX:(t.minX+t.maxX)/2,maxY:t.maxY+30}):-1===i&&-1===o?Object.assign(c,{minX:t.minX-50,minY:t.minY-30,maxX:(t.minX+t.maxX)/2,maxY:(t.minY+t.maxY)/2}):1===i&&-1===o&&Object.assign(c,{minX:(t.minX+t.maxX)/2,minY:t.minY-30,maxX:t.maxX+50,maxY:(t.minY+t.maxY)/2}),n.push(c)}},{key:"child",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.postFix,i=this.createHotArea(e,{parent:n.id,id:NaN+n.id+a,nth:0,color:"green",quadrant:n.layout.quadrant,addOrder:"push"}),o=n.downDirection,c=1===Math.sign(o[1])?32:-32;n.minX>r.minX?Object.assign(i,{minX:n.maxX,minY:n.minY-0+c,maxX:n.maxX+50,maxY:n.maxY+0+c}):Object.assign(i,{minX:n.minX-50,minY:n.minY-0+c,maxX:n.minX,maxY:n.maxY+0+c}),t.push(i)}},{key:"prevSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.postFix,o=n.upDirection,c=Math.sign(o[1]),l=this.createHotArea(e,{parent:r.id,id:void 0+n.id+r.id+i,quadrant:n.layout.quadrant,color:"yellow",nth:a});1===c?Object.assign(l,{minX:n.minX,minY:n.minY-4,maxX:n.maxX,maxY:(n.minY+n.maxY)/2}):Object.assign(l,{minX:n.minX,minY:(n.minY+n.maxY)/2,maxX:n.maxX,maxY:n.maxY+4}),t.push(l)}},{key:"nextSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.postFix;if(!(n.children.length>1)||n.collapsed){var o=n.upDirection,c=Math.sign(o[1]),l=this.createHotArea(e,{parent:r.id,id:n.id+void 0+r.id+i,color:"red",nth:a+1,addOrder:"push",quadrant:n.layout.quadrant});1===c?Object.assign(l,{minX:n.minX,minY:(n.minY+n.maxY)/2,maxX:n.maxX,maxY:n.maxY+16}):Object.assign(l,{minX:n.minX,minY:n.minY-16,maxX:n.maxX,maxY:(n.minY+n.maxY)/2}),t.push(l)}}},{key:"betweenSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.next,o=e.postFix,c=e.stem,l=this.createHotArea(e,{parent:r.id,id:n.id+(i?i.id:void 0)+r.id+o,color:"blue",nth:a+1,stem:c}),s=(n.minY+n.maxY)/2,u=(i.minY+i.maxY)/2;Object.assign(l,{minX:n.minX,minY:Math.min(s,u),maxX:n.maxX,maxY:Math.max(s,u)}),t.push(l)}}]),n}();var hm=function(e){S()(n,um);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"prevSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.postFix,o=n.upDirection,c=Math.sign(o[0]),l=this.createHotArea(e,{parent:r.id,id:void 0+n.id+r.id+i,quadrant:n.layout.quadrant,color:"yellow",nth:a});1===c?Object.assign(l,{minX:r.maxX,minY:r.minY,maxX:n.minX,maxY:r.maxY}):Object.assign(l,{minX:n.maxX,minY:r.minY,maxX:r.minX,maxY:r.maxY}),t.push(l)}},{key:"betweenSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.next,o=e.postFix,c=e.stem;if(i){var l=n.upDirection,s=Math.sign(l[0]),u=this.createHotArea(e,{parent:r.id,id:n.id+(i?i.id:void 0)+r.id+o,color:"blue",nth:a+1,stem:c});1===s?Object.assign(u,{minX:n.maxX,minY:n.minY,maxX:i.minX,maxY:n.maxY}):Object.assign(u,{minX:i.maxX,minY:n.minY,maxX:n.minX,maxY:n.maxY}),t.push(u)}}},{key:"nextSibling",value:function(e){var t=e.hotAreas,n=e.child,r=e.parent,a=e.index,i=e.postFix,o=e.root,c=n.upDirection,l=Math.sign(c[0]),s=this.createHotArea(e,{parent:r.id,id:n.id+void 0+r.id+i,color:"red",nth:a+1,addOrder:"push",quadrant:n.layout.quadrant,root:o});1===l?Object.assign(s,{minX:n.maxX,minY:n.minY,maxX:n.maxX+32,maxY:n.maxY}):Object.assign(s,{minX:n.minX-32,minY:n.minY,maxX:n.minX,maxY:n.maxY}),t.push(s)}}]),n}(),pm=aa,mm={standard:new dm,indent:new fm,timeline:new hm},ym=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m()(this,e),c()(this,"diagram",void 0),c()(this,"drawHotArea",void 0),c()(this,"eventHelper",void 0),c()(this,"hotAreas",void 0),c()(this,"activated",void 0),c()(this,"maxWidth",void 0),c()(this,"maxHeight",void 0),this.diagram=t,this.drawHotArea=n,this.eventHelper=new fl,this.hotAreas=[],this.activated=!1,this._bindEvent()}return v()(e,[{key:"turnOn",value:function(){this.update(),this.activated=!0}},{key:"turnOff",value:function(){this.activated=!1}},{key:"_bindEvent",value:function(){var e=this,t=this.diagram,n=this.drawHotArea,r=this.eventHelper,a=this.activated;r.bind(t,"afterstemcelllayout",(function(t){var n=t.stem;a&&e.update(n)})),n&&r.bind(t,"afterviewportchange",(function(){e.draw()}))}},{key:"update",value:function(e){var t,n=this.diagram,r=this.drawHotArea;if(t=e?[e]:n.getCells().filter((function(e){return e.isStem&&e.isMindmap})),0!==t.length){var a=[],i=t.map((function(e){return s()(e.model)}));i.forEach((function(e){at(e,(function(e){var t=n.find(e.id);e.minX=t.x,e.minY=t.y,e.maxX=t.x+t.width,e.maxY=t.y+t.height,e.depth=t.depth,e.layout=t.computedProps.layout,e.visible=t.state.visible,e.collapsed=t.collapsed,e.isStem=t.isStem,e.stem=t.stem.model.id,e.upLayoutType=t.upLayoutType,e.downLayoutType=t.downLayoutType,e.upDirection=t.upDirection,e.downDirection=t.downDirection,e.zIndex=t.zIndex,e.children=e.children&&e.children.filter((function(e){return!e.isPlaceholder}))||[]}))})),i.forEach((function(e){at(e,(function(e,t,n){if(!e.isPlaceholder&&e.visible){var r=e.upLayoutType,i=e.downLayoutType,o=e.children,c=t?function(e,t,n){var r=n.children,a=e;if(!n.parent)for(;r[a]&&!$i(r[a].upDirection,t.upDirection);)a++;if(r[a]&&!r[a].abstract&&$i(r[a].upDirection,t.upDirection))return r[a]}(n+1,e,t):null,l=t?function(e,t,n){var r=n.children,a=e;if(!n.parent)for(;r[a]&&!$i(r[a].upDirection,t.upDirection);)a--;if(r[a]&&!r[a].abstract&&$i(r[a].upDirection,t.upDirection))return r[a]}(n-1,e,t):null,s=mm[i],u=mm[r],d={hotAreas:a,child:e,parent:t,next:c,prev:l,index:n,stem:e.stem,postFix:"placeholder"};e.isStem?s.stem(d):(0===o.length&&s.child(d),e.abstract||(l||u.prevSibling(d),c||u.nextSibling(d),c&&u.betweenSibling(d)))}}))})),this.hotAreas=a,this.buildQuadtree(),r&&this.draw()}}},{key:"buildQuadtree",value:function(){var e=Object(Re.a)(),t=this.hotAreas.map((function(e){return[e.minX,e.minY,e.maxX-e.minX,e.maxY-e.minY,e]}));e.addAll(t),this.quadtree=e,this.maxWidth=st(t,(function(e){return e[2]})),this.maxHeight=st(t,(function(e){return e[3]}))}},{key:"_search",value:function(e,t){var n=this.quadtree,r=this.maxWidth,a=this.maxHeight,i=[];return n.visit((function(n,o,c,l,s){var u=n.data;return u&&u[0]+u[2]>=e&&u[0]<e&&u[1]+u[3]>=t&&u[1]<t&&i.push(u[4]),o>=e||c>=t||l+r<e||s+a<t})),i.sort((function(e,t){return e.child.zIndex-t.child.zIndex})),i}},{key:"hit",value:function(e){return this._search(e[0],e[1])[0]}},{key:"draw",value:function(){var e=this.diagram.frontRootGroup;e.clear(),this.hotAreas.forEach((function(t){var n=t.minX,r=t.minY,a=t.maxX,i=t.maxY,o=t.color,c=new pm({d:un(n,r,a-n,i-r),fill:o,opacity:.5,"pointer-events":"none"});e.add(c)}))}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.diagram=void 0,this.drawHotArea=void 0,this.eventHelper=void 0}}]),e}();function vm(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gm(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function gm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bm=function(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=t.children,c=void 0===o?[]:o,l=[],s=[],u=[],d=c.length-1;d>=0;d--){var f=c[d],h=f.start,p=void 0===h?0:h,m=f.end,y=void 0===m?0:m,v=f.abstract,g=f.id,x=(c[d].layout||{}).quadrant,k=void 0===x?1:x;if(!v)break;if((void 0===r||r===k)&&!a.includes(g)){var w,C=!1,A=p,O=y,E=0,P=0,S=vm(n);try{for(S.s();!(w=S.n()).done;){var j=b()(w.value,2),R=j[0],M=j[1];A=A>=R&&A<R-M?R-M:A,O=O>=R&&O<R-M?R-1:O,("prev"===i?A>R:A>=R)&&(E+=M),("next"===i?O>=R-1:O>=R)&&(P+=M)}}catch(e){S.e(e)}finally{S.f()}if(O>=A){c[d].start=A+E,c[d].end=O+P;var L={start:c[d].start,end:c[d].end};s.push(g),u.push(L)}else C=!0;var B={start:p,end:y,id:g,newStart:c[d].start,newEnd:c[d].end,deleted:C,q:r,index:d};l.push(B)}}return e.update(s,u),l},xm=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=n?-1:1,i=Sl(e,t),o={},c=0,l=Object.keys(i);c<l.length;c++){var s,u=l[c],d=u.split(":"),f=b()(d,2),h=f[0],p=f[1],m=void 0===p?void 0:parseInt(p),y=i[u],v=y.indexes,g=y.abstracts,x=null===(s=e.find(h))||void 0===s?void 0:s.model;if(0!==v.length){v.sort();var k,w=[],C=void 0,A=vm(v);try{for(A.s();!(k=A.n()).done;){var O=k.value;if(C){var E=b()(C,2);O===E[0]+a*E[1]?C[1]+=a:(w.push(C),C=[O,a])}else C=[O,a]}}catch(e){A.e(e)}finally{A.f()}C&&w.push(C);var P=g.map((function(e){return e.id}));o[u]=bm(e,x,w,m,P,r)}else o[u]=[]}return n&&Object.keys(o).forEach((function(n){o[n].forEach((function(n){var r=n.id;n.deleted&&-1===t.indexOf(r)&&e.find(r)&&t.push(r)}))})),o},km=function(e,t){Object.keys(t).forEach((function(n){var r=n.split(":"),a=b()(r,2),i=a[0];a[1];var o=t[n];e.find(i),function(e,t,n){var r=[],a=[];n.forEach((function(e){var t=e.start,n=e.end,i=e.id,o={start:t,end:n};r.push(i),a.push(o)})),e.update(r,a)}(e,0,o)}))},wm=function(e,t){Object.keys(t).forEach((function(n){var r=n.split(":"),a=b()(r,2),i=a[0];a[1];var o=t[n],c=e.find(i);!function(e,t,n){var r=t.model.children,a=[],i=[];n.forEach((function(e){var t=e.newStart,n=e.newEnd,o=e.index,c=e.id,l=r[o];l.start=t,l.end=n;var s={start:t,end:n};a.push(c),i.push(s)})),e.update(a,i)}(e,c,o)}))},Cm=function(e,t){var n=t.map((function(t){return e.find(t)}));if(n.some((function(e){return!e})))throw new Error("can not find the cell");return n},Am=function(e,t,n){var r=e.add(t,n),a=xm(e,t.map((function(e){return e.id})).filter((function(e){return e})));return[r,t,n,a]},Om=function(e,t,n,r,a){km(e,a),e.remove(n.map((function(e){return e.id})))},Em=function(e,t,n,r,a){return e.add(n,r),wm(e,a),n.map((function(e){return e.id}))},Pm=function(e,t){t=t.concat([]);var n=xm(e,t,!0);return[e.remove(t),n]},Sm=function(e,t,n){var r=t.deletedModelsInfo,a=[],i=[];return Object.keys(r).forEach((function(e){var t=r[e];"root"!==e&&t.sort((function(e,t){return e.nth-t.nth})),t.forEach((function(t){var n=t.nth,r=t.model,o=-1===n?{}:{nth:n,parent:e};a.push(r),i.push(o)}))})),e.add(a,i),km(e,n),a.map((function(e){return e.id}))},jm=function(e,t,n){wm(e,n),e.remove(t.eventObj.models.map((function(e){return e.id})))},Rm=function(e,t,n,r){for(var a=Cm(e,t),i=a.map((function(e,t){var r=n[t];return Object.keys(r).reduce((function(e,n){if("children"===n)return e;var i=r[n],o=a[t].model[n];return d()(i)?e[n]=Object.keys(i).reduce((function(e,t){var n=o&&o[t];return e[t]=null==n?null:n,e}),{}):e[n]=null==o?null:o,e}),{})})),o=a.map((function(t){return e.getCellOptions(t)})),c=0;c<n.length;c++)St(i[c],n[c]);return e.update(a,n,r),[t,n,r,i,o]},Mm=function(e,t,n,r,a,i){var o=Cm(e,t);return e.update(o,a,i),o},Lm=function(e,t,n,r,a,i){var o=Cm(e,t);return e.update(o,n,r),o};function Bm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nm=va,Im=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n,r,a,i,o,c,l,u,d,f,h,p,m,y,v=new ym(e);function g(){if(e.viewport.preventDefault(!1),n&&Om.apply(void 0,[e].concat(D()(y))),n){var d=s()(r);d.forEach((function(e){at(e,(function(e){delete e.zIndex}))})),n.parent===n.stem&&d.forEach((function(e){var t=n.quadrant||null;e.layout?e.layout.quadrant=t:e.layout={quadrant:t}}));var f=t.map((function(e,t){return{parent:n.parent,nth:n.nth+t}})),g={parent:n.parent,nth:n.nth,quadrant:n.quadrant||1},b=e.find(n.parent);t.forEach((function(e,t){var n=d[t];1===e.depth&&b.depth>0&&n&&n.treeEdge&&n.treeEdge.stroke&&delete n.treeEdge.stroke})),b.isStem&&d.forEach((function(t,n){var r=e.query.appendChildModel(b,n);t.treeEdge?t.treeEdge.stroke||(t.treeEdge.stroke=r.treeEdge.stroke):t.treeEdge={stroke:r.treeEdge.stroke}})),e.command.execute("MindmapMoveNode",{dragCells:t,dragCellModels:r,movedCellsInfo:p,addCellModels:d,addOption:g,addOptions:f,dragCellOptions:l,movedCellsBatch:m})}else r&&Sm.apply(void 0,[e].concat(D()(p)));u&&e.delegator.remove(u),u=void 0,t=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,o=void 0,c=void 0,h=void 0,e.signal.draggingMindmapCell=!1,v.turnOff()}this.mindmapHotAreaHelper=v,this.bind(e,"mousedown",(function(n){var r=n.target,o=n.clientX,c=n.clientY,l=n.button,s=e.getCell(r);!s||!s.isMindmap||s.isStem||0!==l||s.model.abstract||e.signal.contentEditing||(a=o,i=c,e.selector.selections.length>1&&e.selector.selections.includes(s)?(t=(t=e.selector.selections.concat([])).filter((function(e){return!e.isStem})),(t=e.deduplicate(t)).sort((function(e,t){return e.getNth()-t.getNth()})),h=!0):t=[s])})),this.bind(e,"mousemove",(function(g){if(t&&0!==t.length){if(!r&&Math.abs(a-g.clientX)+Math.abs(i-g.clientY)>10&&!e.signal.contentEditing){e.selector.clear(),r=t.map((function(e){return s()(e.model)})),l=t.map((function(t){return e.getCellOptions(t)}));var x=e.viewport.invertClient([g.clientX,g.clientY]);u=e.delegator.create((function(e){!function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=new Nm({x:t-24.5-r,y:n-11+r,height:22,width:49,rx:4,ry:4,fill:Hn}),i=new Nm({x:t-24.5+r,y:n-11-r,height:22,width:49,rx:4,ry:4,fill:Hn});e.add(a),e.add(i)}(e,x[0],x[1],h?3:0)})),m=Ll(e,t),p=Pm(e,t),e.signal.draggingMindmapCell=!0,v.turnOn(),e.viewport.preventDefault(),o=g.clientX,c=g.clientY,e.emit("mindmap:afterdragchildcellstart")}if(u){var k=e.viewport.zoom;d=(g.clientX-o)/k,f=(g.clientY-c)/k,u.translate(d,f)}if(r){var w=e.viewport.invertClient([g.clientX,g.clientY]),C=v.hit(w);n&&(C?n.id!==C.id&&Om.apply(void 0,[e].concat(D()(y))):Om.apply(void 0,[e].concat(D()(y)))),C&&(e.find(C.id)||(y=Am(e,[Dm({isPlaceholder:!0,width:32,height:10,border:{shape:"rect",fill:"#C5E3FF"},treeEdge:{stroke:"#C5E3FF"},layout:{quadrant:C.quadrant}},C)],[{parent:C.parent,nth:C.nth}]),b()(y[0],1)[0].toBack())),n=C}}})),this.bind(e,"keydown",(function(e){"Escape"===e.key&&g()})),this.bind(e,"mouseup",(function(){g()})),this.bind(e,"mouseleave",(function(e){var t;null!==(t=e.relatedTarget)&&void 0!==t&&t.closest(".lake-diagram-board-contextual-toolbar-popover")||g()}))}},{key:"unbind",value:function(){this.mindmapHotAreaHelper&&(this.mindmapHotAreaHelper.destroy(),this.mindmapHotAreaHelper=void 0),I()(L()(n.prototype),"unbind",this).call(this)}}]),n}();function Tm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add_button",t=new Zr,n=new aa({fill:"transparent"}),r=new da({href:Kn,width:18,height:18}),a=new _a,i=new aa({fill:"url(#".concat(a.id,")")});return t.dataset({lake_prevent_click_unselect:!0,lake_mindmap_add_button:!0,testid:e}),n.css({cursor:"default"}),r.css({cursor:"pointer"}),t.add(n),t.add(r),{group:t,background:n,btn:r,tail:i,gradient:a}}function zm(e){var t=e.x,n=e.y,r=e.width,a=e.height,i=e.collapsedButtonWidth,o=e.group,c=e.background,l=e.btn,s=e.tail,u=e.gradient,d=e.zoom,f=e.verticalAlign,h=void 0===f?"center":f,p=e.tailConfig,m=9/d,y={x:t+r/2,y:n+a/2},v=0,g=a;"bottom"===h&&(v=a/2,g+=m),c.update({d:un(t,n,r,g)});var b=y.x,x=y.y+v,k=[1/d,0,0,0,1/d,0,0,0,1];if(w.mat3.translate(k,k,[(b-m)*d,(x-m)*d,1]),l.update({matrix:k,href:Kn}),p){var C=p.stroke,A=p.position,O=(10+i/2)/d,E="rgba(255,255,255,0)";o.add(s),"right"===A?(u.update("l(0) 0:".concat(C," 1:").concat(E)),s.update({d:un(b+m,x-p["stroke-width"]/2,O,p["stroke-width"])})):"left"===A?(u.update("l(0) 0:".concat(E," 1:").concat(C)),s.update({d:un(b-O-m,x-p["stroke-width"]/2,O,p["stroke-width"])})):"bottom"===A?(u.update("l(270) 0:".concat(E," 1:").concat(C)),s.update({d:un(b-p["stroke-width"]/2,x+m,p["stroke-width"],O)})):"top"===A&&(u.update("l(270) 0:".concat(C," 1:").concat(E)),s.update({d:un(b-p["stroke-width"]/2,x-O-m,p["stroke-width"],O)}))}else s.remove()}var qm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),(e=t.call(this)).horizontalElements=Fm(),e.verticalElements=Fm(),e}return v()(n,[{key:"init",value:function(e){var t,n=this,r=e.frontRootGroup,a=e.defs,i=this.horizontalElements,o=this.verticalElements,c=function(){},l=function(){};function s(){i.group.remove(),o.group.remove(),c=function(){},l=function(){},t=void 0}function u(e){return i.group.rendererElement.contains(e)||o.group.rendererElement.contains(e)}a.add(i.gradient),a.add(o.gradient),this.horizontalElements=i,this.verticalElements=o,this.bind(i.btn,"click",(function(n){n.stopPropagation(),e.selector.select([t]),c(),s()})),this.bind(o.btn,"click",(function(n){n.stopPropagation(),e.selector.select([t]),l(),s()})),this.bind(e,"cell:dragstart",(function(){s()})),[i,o].forEach((function(r){var a=r.group,i=r.btn;n.bind(a,"mouseenter",(function(e){e.stopPropagation(),i.update({href:Qn})})),n.bind(a,"mouseleave",(function(n){n.stopPropagation(),i.update({href:Kn}),t&&t.graphicGroup.rendererElement.contains(n.relatedTarget)||u(n.relatedTarget)||(e.emit("addbutton:mouseleave"),s())}))})),this.bind(e,"afterchange",ye()((function(){!t||e.find(t.model.id)&&!t.collapsed||s()}),16)),this.bind(e,"mindmapcell:mouseenter",(function(n){var a=n.cell;if(!(e.signal.buttonDragCanvas||e.signal.dragging||e.signal.vertexResizing||!a.isMindmap||a.collapsed)){var s=a.downSignX,u=a.downSignY,d=0!==u,f=e.viewport.zoom,h=38/f,p=a.canCollapse()?8:0,m=a.canCollapse()?-18:2,y=(d||"line"!==a.border.shape?-1:0)/f+m-p,v={x:a.x+a.width-y,y:a.y,width:h,height:a.height,collapsedButtonWidth:p},g={x:a.x+(a.width-h)/2,y:a.y+a.height-y,width:h,height:h,collapsedButtonWidth:p};t=a,i.group.remove(),o.group.remove(),d?(-1===u&&(g.y=a.y-h+y),v.x-=y,g.tailConfig=_m({position:1===u?"top":"bottom"},e.query.appendChildAddButtonTail(a).treeEdge),l=function(){e.command.execute("MindmapAppendChild")}):(-1===s&&(v.x=a.x-h+y),g.height-=4*y,"line"===a.border.shape&&(v.verticalAlign="bottom"),v.tailConfig=_m({position:1===s?"left":"right"},e.query.appendChildAddButtonTail(a).treeEdge),c=function(){e.command.execute("MindmapAppendChild")}),d?(r.add(o.group),zm(_m(_m({},g),{},{zoom:f},o))):(r.add(i.group),zm(_m(_m({},v),{},{zoom:f},i)))}})),this.bind(e,"mindmapcell:mouseleave",(function(t){var n=t.nativeEvent;e.signal.buttonDragCanvas||e.signal.dragging||e.signal.vertexResizing||u(n.relatedTarget)||e.elementMap.fullScreenBtn.contains(n.relatedTarget)||s()})),this.bind(e.contentEditor,"beginedit",(function(){s()})),this.bind(e.contentEditor,"change",(function(){s()})),this.bind(e,"afterselect",(function(){(e.selector.selections.length>1||1===e.selector.selections.length&&e.selector.selections[0]!==t)&&s()}))}}]),n}();var Ym=aa,Hm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;return m()(this,n),(e=t.call(this)).mask=new Ym({"stroke-width":1,stroke:"#1890FF",fill:"rgba(24, 144, 255, 0.15)"}),e.mask.css({"pointer-events":"none"}),e}return v()(n,[{key:"init",value:function(e){var t=this.mask;t.dataset({lake_prevent_click_unselect:!0});var n=null,r=!0;this.bind(e,"keyup",(function(r){if(n)switch(r.key){case"Delete":case"Backspace":e.command.execute("Update",{id:n,model:{width:null,height:null,image:null}}),t.remove()}})),this.bind(e,"mousedown",(function(t){var n=t.target.closest("image"),a=n&&e.getCell(n);r=!(a&&a.isMindmap&&a.state.selected)})),this.bind(e,"click",(function(a){var i=a.target.closest("image"),o=i&&e.getCell(i);o&&!r?(a.stopPropagation(),o.endEditContent(),e.selector.select([o],!1),function(e,n){var r=["x","y","width","height"].reduce((function(e,t){return e[t]=parseFloat(n.getAttribute(t)),e}),{});t.update({d:un(e.x+r.x-1,e.y+r.y-1,r.width+2,r.height+2,1)})}(o,i),e.frontRootGroup.add(t),n=o.model.id,e.tryFocus(),r=!0):a.target!==t.rendererElement&&(n=null,t.remove())})),this.bind(e,"afterselectionchange",(function(){n&&(n=null,t.remove())})),this.bind(e,"mindmap:afterdragchildcellstart",(function(){n&&(n=null,t.remove())}))}}]),n}();function Gm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gm(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){var t,n,r,a,i,o,c,l=!1;function s(){l?t&&e.remove(t):(c=Object(F.a)(),e.remove(t),e.command.execute("Add",{model:Xm({id:c,x:t.x+i,y:t.y+o},e.query.insertStemModel())})),n&&n.destroy(),t=void 0,r=void 0,a=void 0,i=void 0,o=void 0,l=!1,n=void 0,e.interaction.changeMode("edit"),c&&(e.selector.clear(),e.selector.select([c]),c=void 0)}this.bind(e,"mousemove",(function(c){if(!n){var l=e.viewport.invertClient([c.clientX,c.clientY]);t=e.add(Xm({x:l[0],y:l[1]},e.query.insertStemModel()))[0],n=e.delegator.create([t]),r=c.clientX,a=c.clientY,t.hide()}n&&(i=(c.clientX-r)/e.viewport.zoom,o=(c.clientY-a)/e.viewport.zoom,n.translate(i,o))})),this.bind(window,"mouseleave",(function(){l=!0,s()})),this.bind(window,"mouseup",(function(t){n&&(e.viewportContainer.contains(t.target)||(l=!0),s())})),this.bind(e,"keydown",(function(e){"Escape"===e.key&&(l=!0,s())}))}}]),n}();var Wm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n),e=t.call(this);var a=document.createElement("div"),i=document.createElement("span");return i.classList.add("lake-icon"),i.classList.add("lake-icon-full-screen"),i.classList.add("lake-prevent-card-activated"),a.appendChild(i),a.style["z-index"]="1033",a.style["border-radius"]="4px",a.style.position="absolute",a.style.width="".concat(20,"px"),a.style.height="".concat(20,"px"),a.style.color="#fff",a.style.cursor="pointer",a.style["box-shadow"]="0px 2px 8px 0px rgba(0, 0, 0, 0.08)",a.style["background-color"]="rgba(0, 0, 0, 0.65)",a.style["text-align"]="center",e.fullScreenBtn=a,e.imageBrowser=Object(r.getImageBrowser)(),e}return v()(n,[{key:"init",value:function(e){var t,n,r=this,a=this.fullScreenBtn,i=this.imageBrowser;e.elementMap.fullScreenBtn=a;var o=function(){a.remove(),n&&r.unbind(n),t=void 0,n=void 0};this.bind(a,"click",(function(){if(t){var e=t.image,n=t.imageElement.rendererElement;i.open([{src:n.getAttribute("data-raw_src"),msrc:n.getAttribute("href"),w:e.naturalWidth,h:e.naturalHeight}],0)}})),this.bind(a,"mouseleave",(function(e){t.imageElement.rendererElement.contains(e.relatedTarget)||o()})),this.bind(e,"mindmapcellimage:mouseenter",(function(i){var c=i.cell;if(!e.signal.cellDragStart){document.body.appendChild(a);var l=c.imageElement.getBoundingClientRect(),s=c.image;t=c,s.width>30&&s.height>30?(a.style.top="".concat(l.top+window.pageYOffset+6,"px"),a.style.left="".concat(l.right+window.pageXOffset-26,"px")):(a.style.top="".concat(l.top+window.pageYOffset-20,"px"),a.style.left="".concat(l.left+window.pageXOffset,"px")),n=r.bind(e,"afterviewportchange",(function(){o()}))}})),this.bind(e,"mindmapcellimage:mouseleave",(function(e){var t=e.nativeEvent;a.contains(t.relatedTarget)||o()})),this.bind(e,"mindmap:afterdragchildcellstart",(function(){o()})),this.bind(e,"cell:dragstart",(function(){o()}))}}]),n}();var Zm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(window,"click",(function(t){t.target.closest(".lake-diagram-note")&&e.command.execute("MindmapAttachNote")}))}}]),n}();var Um=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){var n=e.selector.selections[0],r=t.key,a=["Tab","Insert"],i=["Enter"];if(n&&("timeline"===n.upLayoutType||"standard"===n.upLayoutType&&0===n.upSignX)){var o=a;a=i,i=o}a.includes(r)?(t.preventDefault(),t.altKey?e.command.execute("MindmapAppendParent"):e.command.execute("MindmapAppendChild")):i.includes(r)&&(t.preventDefault(),t.shiftKey?e.command.execute("MindmapInsertStem"):n&&n.isStem?e.command.execute("MindmapAppendChild"):t.altKey?e.command.execute("MindmapPrependSibling"):e.command.execute("MindmapAppendSibling"))}))}}]),n}();var Km=[["Left","ArrowLeft"],["Right","ArrowRight"],["Up","ArrowUp"],["Down","ArrowDown"]],Qm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){if(Km.reduce((function(e,t){return e.push.apply(e,D()(t)),e}),[]).includes(t.key)){t.preventDefault();var n=e.selector,r=n.selections;if(1===r.length&&r[0].isMindmap){var a,i,o,c,l=(r=r.filter((function(e){return e.isMindmap})))[r.length-1],s=e.getCells().filter((function(e){return e.state.visible&&e.isMindmap})),u=(a=l.upDirection,"0,1"===(a=String(a))||"0,-1"===a),d=!l.isStem&&"timeline"!==l.upLayoutType;if(Km[1].includes(t.key)){if(d&&l.x<l.parent.x&&!u)return void n.select([l.parent]);o="x",c=!0}else if(Km[0].includes(t.key)){if(d&&l.x>l.parent.x&&!u)return void n.select([l.parent]);o="x",c=!1}else if(Km[2].includes(t.key)){if(d&&l.y>l.parent.y&&u)return void n.select([l.parent]);o="y",c=!1}else if(Km[3].includes(t.key)){if(d&&l.y<l.parent.y&&u)return void n.select([l.parent]);o="y",c=!0}var f="x"===o?"width":"height",h="x"===o?"y":"x",p="x"===o?"height":"width",m=l[h]+l[p]/2,y=l[h]+l[p];(i=(i=(i=c?s.filter((function(e){return l[o]+l[f]<e[o]})):s.filter((function(e){return e[o]+e[f]<l[o]}))).filter((function(e){var t=e[h]+e[p],n=t<l[h],r=e[h]>y,a=e[h]<=l[h]&&t>=y;return!(n||r)||a}))).sort((function(e,t){if(c){if(e[o]!==t[o])return e[o]-t[o]}else if(e[o]+e[f]!==t[o]+t[f])return t[o]+t[f]-(e[o]+e[f]);return Math.min(Math.abs(m-e[h]),Math.abs(m-(e[h]+e[p])))-Math.min(Math.abs(m-t[h]),Math.abs(m-(t[h]+t[p])))})))[0]&&n.select([i[0]])}}}))}}]),n}();var Jm=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){ki(t)&&["Backspace","Delete"].includes(t.key)&&e.command.execute("MindmapRemoveSingleNode")}))}}]),n}();var $m=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"keydown",(function(t){0!==e.selector.selections.length||"m"!==t.key||ki(t)||(t.preventDefault(),e.command.execute("MindmapBeginInsertStem"))}))}}]),n}();var ey=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections,r=t[t.length-1];r.model.collapsed&&(e.update(r,{collapsed:!1}),this.originSelectedCollapsed=!0);var a=r.model.children?r.model.children.filter((function(e){return!e.abstract})).length:0,i={model:{},cellOptions:{parent:r.model.id,nth:a}};te()(i.model,e.query.appendChildModel(r)),i.model.id=this.id,Object.assign(this,i),this.selectedCellId=r.model.id,r.state.collapsedButtonVisible=!1,I()(L()(n.prototype),"execute",this).call(this),e.contentEditor.beginEdit()}},{key:"forward",value:function(){var e=this.selectedCellId,t=this.diagram;this.originSelectedCollapsed&&t.update(e,{collapsed:!1}),I()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this.selectedCellId,t=this.diagram;this.originSelectedCollapsed&&t.update(e,{collapsed:!0}),I()(L()(n.prototype),"backward",this).call(this),t.selector.select([e])}}]),n}();c()(ey,"className","MindmapAppendChild"),c()(ey,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.isMindmap}))}));var ty=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.diagram,r=this.addType,a=t.selector.selections,i=a[a.length-1],o=i.parent,c={model:{html:"".concat(zn(""))},cellOptions:{parent:o.model.id,nth:r&&"prepend"===r?i.getNth():i.getNth()+e}};o.isStem&&(c.model.layout={quadrant:i.computedProps.layout.quadrant}),te()(c.model,t.query.appendChildModel(o)),c.model.id=this.id,Object.assign(this,c),this.selectedCellId=i.model.id,I()(L()(n.prototype),"execute",this).call(this),t.contentEditor.beginEdit()}},{key:"backward",value:function(){var e=this.selectedCellId,t=this.diagram;I()(L()(n.prototype),"backward",this).call(this),t.selector.select([e])}}]),n}();c()(ty,"className","MindmapAddSibling"),c()(ty,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return!e.isStem&&e.isMindmap&&!e.isAbstract}))}));var ny=function(e){S()(n,ty);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n)}();c()(ny,"className","MindmapAppendSibling");var ry=function(e){S()(n,ty);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){I()(L()(n.prototype),"execute",this).call(this,0)}}]),n}();c()(ry,"className","MindmapPrependSibling");var ay=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"addMovedModelsInfo",void 0),c()(E()(e),"addInfo",void 0),c()(E()(e),"pinLine",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.addOption,t=e.parent,n=e.quadrant,r=e.nth,a=this.diagram,i=this.movedCellsBatch,o=a.find(t),c=o&&o.isStem&&o.isTwoQuadrantLayout?o.getNewQuadIndexByNewRealIndex(r,n):r,l=Bl(i[1],o,n,c),s=b()(l,3),u=s[0],d=s[1],f=s[2];this.pinLine=new Rh(a),this.pinLine.cache(f),this.pinLine.pin(),this.addInfo=Am(a,u,d),this.select(this.addInfo[0])}},{key:"forward",value:function(){var e=this.diagram,t=this.movedCellsInfo;jm.apply(void 0,[e].concat(D()(t))),this.pinLine.pin();var n=Em.apply(void 0,[e].concat(D()(this.addInfo)));this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.movedCellsInfo;Om.apply(void 0,[e].concat(D()(this.addInfo))),this.pinLine.reset();var n=Sm.apply(void 0,[e].concat(D()(t)));this.select(n)}}]),n}();c()(ay,"className","MindmapMoveNode");var iy=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.image,r=e.selector.selections,a=r[r.length-1],i=a.model;this.id=i.id,this.model={image:su(t),width:null,height:null},e.signal.preventUpdateCellContent=!0,a.textareaElement.htmlContainer===e.contentEditor.dom&&(e.contentEditor.execCommand("justifyCenter"),e.contentEditor.updateStartContent(),this.model.html=e.contentEditor.dom.innerHTML),e.signal.preventUpdateCellContent=!1,I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(iy,"className","MindmapAttachImage"),c()(iy,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t[0].isMindmap}));var oy=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram;e.selector.clear(),e.interaction.changeMode("beginAddMindmapStem")}}]),n}();function cy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(oy,"className","MindmapBeginInsertStem");var ly=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.x,r=this.y;if(this.model=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.query.insertStemModel()),null!=t&&null!=r)Object.assign(this.model,{x:t,y:r});else{var a=e.getCells().filter((function(e){return e.isStem})),i=a[a.length-1];Object.assign(this.model,{x:i.x+20,y:i.y+i.height+20})}I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(ly,"className","MindmapInsertStem");var sy=function(e){S()(n,Ic);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n)}();c()(sy,"className","MindmapCreateLink");var uy=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this,t=this.diagram,r=this.image;this.model={type:"mindmap",image:su(r),html:""};var a=t.viewport.getCenter();this.model.x=a[0]-this.model.image.width/2,this.model.y=a[1]-this.model.image.height/2,I()(L()(n.prototype),"execute",this).call(this),ye()((function(){var n=t.selector.selections;1===n.length&&n[0].model.id===e.id&&t.contentEditor.execCommand("justifyCenter")}),16)()}}]),n}();function dy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(uy,"className","MindmapInsertImage"),c()(uy,"enable",(function(e){return 0===e.selector.selections.length}));var fy=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"info1",void 0),c()(E()(e),"info2",void 0),c()(E()(e),"info3",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.deduplicate(e.selector.selections).sort((function(e,t){return e.getNth()-t.getNth()})),n=t[0],r=Ll(e,t),a=b()(r,2);a[0];var i=a[1],o=t[0].mindmapParent,l=t[0].parent,s=o?n.quadrantNth:void 0,u=n.realQuadrant,d=Object(F.a)(),f={id:d,html:"",children:[]};o?Object.assign(f,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.query.appendChildModel(o))):Object.assign(f,{type:"mindmap",x:n.x,y:n.y,layout:n.layout}),this.info1=Pm(e,t.map((function(e){return e.model.id})));var h=Bl([f],l,u,s),p=b()(h,2),m=p[0],y=p[1];this.info2=Am(e,m,y);var v=e.find(d),g=Bl(i,v,1),x=b()(g,2),k=x[0],w=x[1];this.info3=Am(e,k,w),e.selector.select(d)}},{key:"forward",value:function(){var e=this.diagram;jm.apply(void 0,[e].concat(D()(this.info1)));var t=Em.apply(void 0,[e].concat(D()(this.info2)));Em.apply(void 0,[e].concat(D()(this.info3))),e.selector.select(t)}},{key:"backward",value:function(){var e=this.diagram;Om.apply(void 0,[e].concat(D()(this.info3))),Om.apply(void 0,[e].concat(D()(this.info2)));var t=Sm.apply(void 0,[e].concat(D()(this.info1)));e.selector.select(t)}}]),n}();c()(fy,"className","MindmapAppendParent"),c()(fy,"enable",(function(e){var t=function(e,t){return e=e.filter((function(e){return e.isMindmap})),t.deduplicate(e)}(e.selector.selections,e);return t.length>0&&t.every((function(e){return e.isMindmap&&e.parent===t[0].parent&&!e.isAbstract}))}));var hy=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"info1",void 0),c()(E()(r),"info2",void 0),c()(E()(r),"transBatch",void 0),r.pinLine=new Rh(e.diagram),r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.pinLine,n=e.selector.selections[0];this.selfId=n.model.id;var r=n.getChildren(),a=n.parent,i=n.realQuadrant,o=a&&a.isMindmap?n.getNth():void 0,c=(null!=a?a:{}).quadrantTreeLists,l=c?c[i-1].indexOf(o):o,s=Ll(e,r)[1];t.cache([n]),this.info1=Pm(e,[this.selfId]),t.pin();var u=Bl(s,a,i,l),d=b()(u,2),f=d[0],h=d[1];this.info2=Am(e,f,h),this.select(this.info2[0])}},{key:"forward",value:function(){var e=this.diagram,t=this.pinLine;jm.apply(void 0,[e].concat(D()(this.info1))),t.pin();var n=Em.apply(void 0,[e].concat(D()(this.info2)));this.select(n)}},{key:"backward",value:function(){var e=this.diagram,t=this.selfId,n=this.pinLine;Om.apply(void 0,[e].concat(D()(this.info2))),Sm.apply(void 0,[e].concat(D()(this.info1))),n.reset(),this.select(t)}}]),n}();c()(hy,"className","MindmapRemoveSingleNode"),c()(hy,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.isMindmap&&!e.isAbstract}))}));var py=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).queue=!1,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=e.selector.selections[0];e.emit("opennote",{cell:t})}}]),n}();function my(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?my(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):my(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}c()(py,"className","MindmapAttachNote"),c()(py,"isModelChange",!1),c()(py,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return e.isMindmap}))}));var gy=function(e){return(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!e.some((function(e){if(e.isMindmap&&e.mindmapParent&&!e.isAbstract){var t=e.realQuadrant,n=e.mindmapParent,r=n.getChildren(),a=n.quadrantTreeLists,i=r.indexOf(e),o=0===a.length?i:a[t-1].indexOf(i),c=r.filter((function(e){return e.model.abstract}));return c.some((function(e){var n=e.model,r=n.start,a=n.end,i=e.realQuadrant;return t===i&&o>=r&&o<=a}))}return!1})))&&e.every((function(e){return e.isMindmap&&e.mindmapParent&&!e.isAbstract}))},by=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"originSelectionsCollapsed",{}),c()(E()(e),"selections",void 0),c()(E()(e),"fatherGroup",{}),c()(E()(e),"updateInfo",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this,t=this.diagram,r=t.deduplicate(t.selector.selections),a={model:[],cellOptions:[]},i=[],o=[],c=[];this.selections=r.map((function(e){return e.model.id})),r.forEach((function(t){if(t.mindmapParent){var n=t.mindmapParent,r=n.model,a=r.id,i=r.children.indexOf(t.model),o=i;if(n.layoutQuadrantConstraint&&n.layoutQuadrantConstraint.length>1){var c,l,s=null!==(c=null===(l=t.model.layout)||void 0===l?void 0:l.quadrant)&&void 0!==c?c:1;a+=":"+s,o=n.quadrantTreeLists[s-1].indexOf(i)}var u=e.fatherGroup[a]||{},d=u.start,f=u.end;if(-1===o)throw new Error("水金");e.fatherGroup[a]=void 0===d?{start:o,end:o}:{start:Math.min(o,d),end:Math.max(o,f)}}}));var l,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return vy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vy(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(Object.keys(this.fatherGroup).sort());try{var u,d=function(){var n=l.value,r=n.split(":"),s=b()(r,2),u=s[0],d=s[1],f=void 0===d?void 0:parseInt(d);if("number"==typeof f&&isNaN(f))throw new Error("new abstract quadrant === nan");var h=e.fatherGroup[n],p=h.start,m=h.end,y=t.find(u);if(y){var v=!0,g=y.model.children.filter((function(e){return!e.abstract})),x=g.length;-1===x&&(x=y.model.children.length);var k=x,w=void 0===f?k:y.quadrantTreeLists[f-1].length;if(p>=w||m>=w||p>m||p<0)return{v:void 0};for(var C=null!=f?f:1;k<y.model.children.length;k++){var A=y.model.children[k],O=A.start,E=A.end,P=A.layout,S=(void 0===P?{}:P).quadrant;if(C===(void 0===f?1:S)){if(p<O)break;if(E>p){v=!1;break}}else if(C<S)break}for(var j=k;j<y.model.children.length;j++){var R=y.model.children[j],M=R.start,L=R.layout.quadrant;if((void 0===f||void 0===L?1:L)===C&&m>=M){v=!1;break}}v&&(y.quadrantTreeLists[C-1].forEach((function(e,t){if(t>=p&&t<=m){var n=g[e];if(!n)return;var r=n.layout,a=(void 0===r?{}:r).quadrant,l=void 0===a?1:a,s=n.id;l!==C&&(i.push(s),o.push({layout:yy(yy({},n.layout),{},{quadrant:C})}),c.push({}))}})),a.model.push({start:p,end:m,abstract:!0,layout:{quadrant:C},border:{shape:"rect",stroke:"#BFBFBF",fill:"transparent","stroke-width":2},treeEdge:{stroke:"#BFBFBF","stroke-width":2},html:zn("概要")}),2===f&&e.fatherGroup[u+":1"]&&k++,a.cellOptions.push({parent:y.model.id,nth:k}))}};for(s.s();!(l=s.n()).done;)if(u=d())return u.v}catch(e){s.e(e)}finally{s.f()}this.updateInfo=Rm(t,i,o,c),a.model.forEach((function(e){t.hooks.decorateAddMindmapAbstract.call(e)})),Object.assign(this,a),I()(L()(n.prototype),"execute",this).call(this),t.contentEditor.beginEdit()}},{key:"forward",value:function(){var e=this.diagram,t=this.updateInfo;I()(L()(n.prototype),"forward",this).call(this),Lm.apply(void 0,[e].concat(D()(t)))}},{key:"backward",value:function(){var e=this.diagram,t=this.updateInfo;Mm.apply(void 0,[e].concat(D()(t))),I()(L()(n.prototype),"backward",this).call(this)}}]),n}();function xy(e,t){return e&&t&&Y()(e).toHex()===Y()(t).toHex()}function ky(e,t){return e.reduce((function(e,t){return"object"===i()(e)?e[t]:e}),t)}function wy(e,t,n){var r=e.length;n=s()(n),e.reduce((function(e,t,a){if(a===r-1)return e[t]=n,n;if("object"===i()(e[t]))return e[t];if(void 0===e[t]){var o={};return e[t]=o,o}return{}}),t)}function Cy(e,t){var n=ll(t.find(e.id).textareaElement.htmlContainer);return e.children&&(n.children=e.children.map((function(e){return Cy(e,t)}))),n}function Ay(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=n.children,i=t.split("."),o=ky(i,n),c="none";if(a&&a.length>1)for(var l=0;l<a.length;l++){var s=ky(i,a[l]);if("none"!==c){if(!xe()(s,c)){c="none";break}}else c=s}return"none"!==c?wy(i,e,c):o&&!r&&wy(i,e,o),e}c()(by,"className","MindmapAppendAbstract"),c()(by,"enable",(function(e){var t=e.deduplicate(e.selector.selections);return gy(t,!0)}));var Oy=function(){function e(t){m()(this,e),c()(this,"diagram",void 0),this.diagram=t}return v()(e,[{key:"_getRainBowColors",value:function(){var e,t=this.diagram,n=null==t||null===(e=t.theme)||void 0===e?void 0:e.values.mindmapRainbowTreeEdgeColors,r=Yn;return n&&(r=n),r}},{key:"appendChildAddButtonTail",value:function(e){var t=this._getRainBowColors(),n=e.stem.rainbow;return e.isStem?{treeEdge:{stroke:n?t[e.model.children.length%t.length]:qn,"stroke-width":e.getDefaultStrokeWidth(e.depth+1)}}:{treeEdge:{stroke:e.computedProps.treeEdge.stroke,"stroke-width":e.getDefaultStrokeWidth(e.depth+1)}}}},{key:"appendChildTransitiveCommon",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Ay(e,"border.shape",t.model,n),Ay(e,"border.stroke",t.model,n),Ay(e,"border.fill",t.model,n),Ay(e,"border.stroke-width",t.model,n),Ay(e,"layout",t.model,!0),Ay(e,"treeEdge.stroke-width",t.model,n)}},{key:"appendChildTransitiveTextFormat",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Cy(t.model,this.diagram),a={},i=[];Ay(a,"fontSize",r,n),Ay(a,"color",r,n),a.fontSize&&14!==a.fontSize&&i.push("font-size: ".concat(a.fontSize,"px")),a.color&&!xy(a.color,tr)&&i.push("color: ".concat(a.color)),i.length>0&&(e.html='<span style="'.concat(i.join(";"),'">').concat(er,"</span>"))}},{key:"appendChildTreeEdge",value:function(e,t){var n,r,a,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=null!==(n=t.model.children)&&void 0!==n?n:[],l=null===(r=c[0])||void 0===r||null===(a=r.treeEdge)||void 0===a?void 0:a.stroke;if(l&&c.length>1&&c.every((function(e){var t;return xy(null==e||null===(t=e.treeEdge)||void 0===t?void 0:t.stroke,l)})))i=l;else if(t.isStem){var s=t.model.children,u=t.rainbow,d=this._getRainBowColors();i=u?d[(s.length+o)%d.length]:qn}i&&wy(["treeEdge","stroke"],e,i)}},{key:"appendChildModel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.diagram,r={};return e&&e.isMindmap&&(this.appendChildTransitiveCommon(r,e,e.isStem),this.appendChildTransitiveTextFormat(r,e,e.isStem),this.appendChildTreeEdge(r,e,t)),n.hooks.decorateAddMindmapCellModel.call(r),r}},{key:"insertStemModel",value:function(){var e=this.diagram,t=Object.assign({},Gn);return e.hooks.decorateAddMindmapStemModel.call(t),t}},{key:"destroy",value:function(){this.diagram=void 0}}]),e}();c()(Oy,"className","Query");var Ey=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"aftercommandexecute",(function(n){var r=n.command;if(r instanceof sc){var a=r.changeArguments?r.changeArguments[0]:[],i=xm(t,a.map((function(e){return e.id})).filter((function(e){return e})),!1,r instanceof ny?"next":r instanceof ry?"prev":"");e.weakMap.set(r,i)}})),this.bind(t,"beforecommandbackward",(function(n){var r=n.command,a=e.weakMap.get(r);a&&r instanceof sc&&km(t,a)})),this.bind(t,"aftercommandforward",(function(n){var r=n.command,a=e.weakMap.get(r);a&&r instanceof sc&&wm(t,a)}))}}]),n}();var Py=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.initEvent()}},{key:"initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"beforecommandexecute",(function(n){var r=n.command;if(r instanceof Bh){var a=r.cells||t.selector.selections.concat([]),i=xm(e.diagram,a,!0);r.cells=a,e.weakMap.set(r,i)}})),this.bind(t,"aftercommandbackward",(function(n){var r=n.command,a=e.weakMap.get(r);a&&r instanceof Bh&&km(t,a)})),this.bind(t,"beforecommandforward",(function(n){var r=n.command,a=e.weakMap.get(r);a&&r instanceof Bh&&wm(t,a)}))}}]),n}();var Sy=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"beforepaste:lake",(function(t){var n,r=t.body,a=t.options,i=t.extraInfomations,o=t.offset,c=function(e){return"mindmap"===i[e.id].rootType},l=e.selector.selections,u=l[0];1===l.length&&u.isMindmap?(u.collapsed&&e.update(u,{collapsed:null}),n=u):r.forEach((function(e){if(c(e)){var t=i[e.id];delete e.collapsed,Object.keys(Gn).forEach((function(t){null==e[t]&&(e[t]=s()(Gn[t]))})),e.x="number"==typeof e.x?e.x:t.x,e.y="number"==typeof e.y?e.y:t.y,e.x+=o[0],e.y+=o[1],e.children&&e.children.forEach((function(e){var t=i[e.id];t.treeEdge&&t.treeEdge.stroke&&(e.treeEdge?e.treeEdge.stroke||(e.treeEdge.stroke=t.treeEdge.stroke):e.treeEdge={stroke:t.treeEdge.stroke})}))}}));var d=Bl(r,n,void 0,void 0,c),f=b()(d,2),h=f[0],p=f[1];t.body=h,t.options=a.map((function(e,t){return Object.assign(e,p[t])}))}))}}]),n}();function jy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ry(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function My(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ly(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?My(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):My(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var By=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.initEvent()}},{key:"initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"beforecommandexecute",(function(n){var r=n.command;if(r instanceof uc){var a=r.id,i=r.model,o=yn(a instanceof Array?a:[a],i),c=b()(o,2),l=c[0],s=c[1],u=l.map((function(e){return t.find(e)})),d=[[],[],[]];if(l.forEach((function(e,n){var r=t.find(e);if(r&&r.isMindmap&&r.isStem){var a=s[n],i=u[n];if(void 0!==i&&a.layout){var o=a.layout.quadrantConstraint,c=i.layout,l=(void 0===c?{}:c).quadrantConstraint;if(r.isTwoQuadrantLayout&&o&&1===o.length){var f,h,p,m=function(e){var t=[],n=[],r=[],a=-1,i=0;return e.forEach((function(e,o){var c=e.abstract,l=e.layout,s=(void 0===l?{}:l).quadrant,u=void 0===s?1:s,d=e.id,f=e.start,h=void 0===f?0:f,p=e.end,m=void 0===p?0:p;c?2===u&&(t.push(d),n.push({layout:Ry(Ry({},e.layout),{},{quadrant:1}),start:h+i,end:m+i}),r.push({})):2===u?(-1===a&&(a=o),t.push(d),n.push({layout:Ry(Ry({},e.layout),{},{quadrant:1})}),r.push({})):(i++,a>=0&&(t.push(d),n.push({layout:Ry(Ry({},e.layout),{},{quadrant:1})}),r.push({nth:a}),a++))})),[t,n,r]}(r.model.children),y=b()(m,3),v=y[0],g=y[1],x=y[2];(f=d[0]).push.apply(f,D()(v)),(h=d[1]).push.apply(h,D()(g)),(p=d[2]).push.apply(p,D()(x))}else if(l&&1===l.length&&(o&&2===o.length||null===o)){var k,w,C,A=r.model.children.filter((function(e){return!e.abstract})).length,O=Math.ceil(A/2),E=[],P=[],S=[];r.model.children.forEach((function(e,t){var n=e.abstract,r=e.id,a=e.start,i=void 0===a?0:a,o=e.end,c=void 0===o?0:o;if(n){var l=i<O?1:2,s=i<O?i:i-O,u=1===l?c<O?c:O-1:c-O;E.push(r),P.push({layout:Ly(Ly({},e.layout),{},{quadrant:l}),start:s,end:u}),S.push({})}else{var d=t<O?1:2;E.push(r),P.push({layout:Ly(Ly({},e.layout),{},{quadrant:d})}),S.push({})}})),(k=d[0]).push.apply(k,E),(w=d[1]).push.apply(w,P),(C=d[2]).push.apply(C,S)}}}})),d[0].length>0){var f=Rm.apply(void 0,[t].concat(d));e.weakMap.set(r,f)}}})),this.bind(t,"aftercommandbackward",(function(n){var r=n.command,a=e.weakMap.get(r);a&&r instanceof uc&&Mm.apply(void 0,[t].concat(D()(a)))})),this.bind(t,"beforecommandforward",(function(n){var r=n.command,a=e.weakMap.get(r);a&&r instanceof uc&&Lm.apply(void 0,[t].concat(D()(a)))}))}}]),n}(),Dy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=e.x,a=e.y,i=e.width,o=e.height,c=b()(t,2),l=c[0],s=c[1],u=b()(n,2);return[r+l*i+u[0],a+s*o+u[1]]},Ny=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return"x"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x")?[e,t]:[t,e]},Iy="rgba(129,179,248,0.6)",Ty="rgba(95,159,246)",_y=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"group",new Zr),c()(this,"eventHelper",new fl),c()(this,"arr",[]),c()(this,"destroyed",!1),(new Zr).css({"pointer-events":"none"})}return v()(e,[{key:"setDragInfo",value:function(e,t,n){this.diagram.contentEditor.unbind();var r=t.cell,a=r.breadthPositive,i=r.abstractCoveredCells,o=r.ad,c=this.diagram.viewport.invertClient([e.clientX,e.clientY]),l=function(e,t){if(e.isAbstract){var n=e.realQuadrant,r=e.parent,a=r.getChildren(),i=r.quadrantTreeLists,o=a.filter((function(e){return e.isAbstract})),c=o.indexOf(e);if(t>0){var l=o[c+1];if(l){var s=l.realQuadrant,u=l.model.start,d=void 0===u?0:u;if(n===s)return a[i[n-1][d-1]]}var f=i[n-1];return a[f[f.length-1]]}if(c>0){var h=o[c-1],p=h.realQuadrant,m=h.model.end,y=void 0===m?0:m;if(n===p)return a[i[n-1][y+1]]}return a[i[n-1][0]]}return e}(r,n),s=-1===n?i[i.length-1]:i[0],u=Dy(s,Ny(o,(a*n+1)/2)),d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=e.minX,a=e.minY,i=e.maxX,o=e.maxY;return Dy({x:r,y:a,width:i-r,height:o-a},t,n)}(Tn(l.getAllChildren().concat([l]),(function(e){return e.getKeyShapeBox()})),Ny(o,(a*n+1)/2)),f="x"===o?u[0]:u[1],h="x"===o?d[0]:d[1];return{renderInfo:t,boundaryCoord:f>h?[h,f]:[f,h],dragNodeOrder:n,dragCoord:c,dragFromNode:s,dragToNode:l}}},{key:"bind",value:function(){var e=this,t=this.diagram,n=this.eventHelper;n.unbind(),n.bind(t,"afterchange",(function(t){var n=t.action;e.arr.length>0&&("update"===n||"delete"===n)&&e.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(e){var t,n,r,a=this,i=this.diagram,o=this.group,c=this.eventHelper;e=e.filter((function(e){return e.isCell&&e.state.visible&&e.isAbstract})),this.clear(),i.frontRootGroup.add(o),this.bind(),this.arr=e.map((function(e,t){var n={fill:"none",stroke:wr,"fill-rule":"nonzero"},r={fill:"none",stroke:"rgba(255,255,255,0)"},a={fill:"none","stroke-linecap":"round"},i=e.abstractCoveredCells,c=e.abstractCoveredCellsWithAllChildren,l=e.ad,s={cell:e,coveredCells:i,coveredCellsWithAllChildren:c,rectStyle:n,handleStyle:r,rectElement:new aa(n),centerBarElements:[new aa(a),new aa(a)],handleElements:[new aa(r),new aa(r)]},u=s.rectElement,d=b()(s.centerBarElements,2),f=d[0],h=d[1],p=b()(s.handleElements,2),m=p[0],y=p[1];return[u,f,h].forEach((function(e){o.add(e)})),[m,y].forEach((function(e,n){o.add(e),e.dataset({lake_prevent_click_unselect:"true",abst_adjust_controller:"".concat(t,"-").concat(n,"-")+l})})),s})),this.draw(),this.arr.forEach((function(e){var n=b()(e.handleElements,2),r=n[0],i=n[1],o=e.cell.breadthPositive;c.bind(r.rendererElement,"mousedown",(function(n){t=a.setDragInfo(n,e,-o)})),c.bind(i.rendererElement,"mousedown",(function(n){t=a.setDragInfo(n,e,o)}))})),c.bind(i,"mousemove",(function(e){if(t)pe()((function(){i.emit("abstadjuststart");var n=i.viewport.invertClient([e.clientX,e.clientY]);t&&(t.dragCoord=n,a.updateShape(t.renderInfo,t))}))();else{var o=e.target.dataset.abst_adjust_controller;if(o){var c=o.split("-"),l=b()(c,3),s=l[0],u=l[1],d=l[2],f=a.arr[s],h=parseInt(u),p=f.centerBarElements[h];p.update({stroke:Ty,"stroke-width":4}),r&&r!==p&&r.update({stroke:Iy,"stroke-width":3}),r=p;var m="x"===d?"ew-resize":"ns-resize";n!==m&&(i.setCursor(m),n=m)}else n?(i.resetCursor(),n=void 0):r&&(r.update({stroke:Iy,"stroke-width":3}),r=void 0)}})),c.bind(i,"mouseup",(function(e){if(t){n=void 0,i.resetCursor();var r=i.viewport.invertClient([e.clientX,e.clientY]);t.dragCoord=r;for(var o,c=t,l=c.dragFromNode,s=c.dragToNode,u=c.renderInfo,d=c.dragNodeOrder,f=c.dragCoord,h=b()(c.boundaryCoord,2),p=h[0],m=h[1],y=u.cell,v=y.realQuadrant,g=y.ad,x=y.breadthPositive,k=y.parent,w=k.quadrantTreeLists[v-1],C=l.getNth(),A=s.getNth(),O=w.findIndex((function(e){return e===C})),E=w.findIndex((function(e){return e===A})),P="x"===g?f[0]:f[1],S=Math.max(p,Math.min(P,m)),j=x*d,R=E;(R-O)*d>=0;R-=d){var M=k.getChildren()[w[R]],L=Dy(M);if((S-("x"===g?L[0]:L[1]))*j>0){o=R;break}}t=void 0;var B=y.model,D=B.start,N=B.end;if(void 0!==o&&(1===d&&N!==o||-1===d&&D!==o)){var I=1===d?{end:o}:{start:o};i.command.execute("Update",{id:y.model.id,model:I})}else a.updateShape(u)}}))}},{key:"updateShape",value:function(e,t){var n=e.coveredCellsWithAllChildren,r=e.rectElement,a=e.handleElements,i=e.cell,o=e.centerBarElements,c=i.ad,l=i.breadthPositive,s=c,u="x"===s?"y":"x",d=t?e.coordCache:Tn(n,(function(e){return e.getKeyShapeBox()})),f=d.minX,h=d.minY,p=d.maxX,m=d.maxY,y=!1;if(t){var v=t.dragNodeOrder,g=t.dragCoord,x=b()(t.boundaryCoord,2),k=x[0],w=x[1],C="x"===s?g[0]:g[1];C=Math.max(k,Math.min(C,w));var A=v*l==1;A?"x"===s?p=C:m=C:"x"===s?f=C:h=C,y=A?"max":"min"}else e.coordCache={minX:f,minY:h,maxX:p,maxY:m},y=!1;f-=2,p+=2,h-=2,m+=2;var O="x"===s?[p,h]:[f,m],E="x"===u?[p,h]:[f,m],P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"x",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=n/2,l=r/2,s=c<a?c:a,u=l<a?l:a,d="x"===i?Math.min(n-2*s,o):Math.min(r-2*u,o);return[["M",+e+ +s,t]].concat("x"===i?[["l",n/2-s-d/2,0],["m",d,0],["l",n/2-s-d/2,0]]:[["l",n-2*s,0]],[["a",s,u,0,0,1,s,u]],"y"===i?[["l",0,r/2-u-d/2],["m",0,d],["l",0,r/2-u-d/2]]:[["l",0,r-2*u]],[["a",s,u,0,0,1,-s,u]],"x"===i?[["l",-(n/2-s-d/2),0],["m",-d,0],["l",-(n/2-s-d/2),0]]:[["l",-(n-2*s),0]],[["a",s,u,0,0,1,-s,-u]],"y"===i?[["l",0,-(r/2-u-d/2)],["m",0,-d],["l",0,-(r/2-u-d/2)]]:[["l",0,-(r-2*u)]],[["a",s,u,0,0,1,s,-u]])}(f,h,p-f,m-h,4,u,22);r.update({d:P,"stroke-width":1});var S="x"===s?(h+m)/2-9:(f+p)/2-9,j="min"===y?4:3;o[0].update({d:"x"===s?"M".concat(f,",").concat(S+j/2," L").concat(f,",").concat(S+18-j/2):"M".concat(S+j/2,",").concat(h," L").concat(S+18-j/2,",").concat(h),"stroke-width":j,stroke:"min"===y?Ty:Iy});var R="max"===y?4:3;o[1].update({d:"x"===s?"M".concat(p,",").concat(S+R/2," L").concat(p,",").concat(S+18-R/2):"M".concat(S+R/2,",").concat(m," L").concat(S+18-R/2,",").concat(m),"stroke-width":R,stroke:"max"===y?Ty:Iy}),a[0].update({d:"M".concat(f,",").concat(h," L").concat(E.join(",")),"stroke-width":8}),a[1].update({d:"M".concat(O.join(",")," L").concat(p,",").concat(m),"stroke-width":8})}},{key:"draw",value:function(){var e=this;this.arr.forEach((function(t){e.updateShape(t)}))}},{key:"clear",value:function(){this.destroyed||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.diagram=void 0,this.group=void 0,this.arr=void 0,this.destroyed=!0}}]),e}();c()(_y,"className","AbstractView");var Fy=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(e,"afterselect",(function(t){var n=t.selections;e.abstractView.select(n)}))}}]),n}();var zy={Cells:[Up,nm],Extends:[Oy,_y],defaultCursors:{},modes:[{mode:"edit",Behaviours:[am,im,om,Im,qm,Hm,Wm,Zm,lm,function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"init",value:function(e){this.bind(window,"click",(function(t){var n=t.target;if(null!=n&&n.closest(".lake-diagram-mindmap-icon")){var r=n.getAttribute("lake-mindmap-icon-key"),a=e.getCell(n);a&&r&&(n.dataset.lakeMindmapIconSelected="true",e.emit("changemindmapicon",{key:r,cell:a,nativeEvent:t}),e.selector.selections.length>1&&e.selector.select([a]))}}))}}]),n}(),Um,Qm,Jm,$m,Ey,Py,Fy,Sy,By]},{mode:"read",Behaviours:[am,om,Qm,cm,Wm,Zm,lm]},{mode:"beginAddMindmapStem",Behaviours:[am,Vm]}],Commands:[ey,ny,ay,iy,oy,sy,ry,ly,uy,fy,hy,py,by]};function qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Yy=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"parent",void 0),c()(E()(r),"offsetY",void 0),r}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,e),this.textarea=new nu(this),this.render(),this.updateModel(this.model),this.parent.children.push(this)}},{key:"getBBox",value:function(){var e=this.offsetY,t=this.height,n=this.parent.getBBox();return n.y+=e,n.height=t,n.minY=n.y,n.maxY=n.minY+n.height,n}},{key:"canTextVerticalAlign",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){return{x:Math.max((this.width-e.width)/2,4),y:(this.height-e.height)/2+(this.offsetY||0)}}},{key:"render",value:function(){var e=vu({name:"rect",x:0,y:0,width:1,height:1});e.update({fill:"transparent"}),this.shapeElement=e,this.graphicGroup.add(e),this.textarea.render(),"edit"===this.diagram.interaction.currentMode&&this.capture(!1,!0)}},{key:"updateModel",value:function(e){var t;I()(L()(n.prototype),"updateModel",this).call(this,e),this.width=(null===(t=this.parent)||void 0===t?void 0:t.width)||0,this.textarea.update()}},{key:"draw",value:function(){this.drawPosition(),this.updateCache()}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(e){this.graphicGroup.attr({opacity:e})}},{key:"drawTextRegion",value:function(){var e=this.offsetY,t=this.width,n=this.height,r={width:t,height:n,d:un(0,e,t,n)};this.shapeElement.update(r)}},{key:"drawPosition",value:function(){this.drawMatrix(),this.isCacheStale("width","height","offsetY")&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"getOuterWidth",value:function(){return this.width}},{key:"capture",value:function(e,t){t&&I()(L()(n.prototype),"capture",this).call(this,e)}},{key:"updateCache",value:function(){var e=this,t=this.cache;["width","offsetY","height","rotate"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"destroy",value:function(){I()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"16px","min-width":"24px","line-height":"1.45","word-break":"break-word"}}],defaultFontFamily:'SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace',multiSelectHighlight:!1,isStackCell:!0,penetratedKeys:["x","y","width","height","rotate","html","shape","offsetY","id","nth"]})}}]),n}();function Hy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Yy,"className","StackCell");var Xy=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",new Zr),c()(E()(e),"elements",void 0),e}return v()(n,[{key:"render",value:function(){this.elements=[],kn(this.cell)&&this.cell.clipGroup.add(this.group)}},{key:"renderElements",value:function(){var e=this,t=this.group,n=this.cell,r=n.stencil,a=n.getRoughGraphicOptions();r.scene.forEach((function(n){var r=vu(n,a);n.attr&&r.update(n.attr),t.add(r),e.elements.push(r)}))}},{key:"update",value:function(){var e=this.cell,t=this.elements;e.isCacheStale("shape")&&(t&&t.forEach((function(e){return e.remove()})),this.renderElements())}},{key:"draw",value:function(){var e,t,n=this.cell,r=this.elements,a=n.stroke,i=n.heights,o=Gy({},n.convertStrokeStyle());n.isCacheStale("stroke")&&(o.stroke=a.color,o["stroke-width"]=a.width);for(var c=[i[0]],l=1;l<i.length;l++){var s=i[l];c[l]=c[l-1]+s}r.forEach((function(r,a){if(n.isCacheStale("width","height")){var i=n.stencil,l=n.width;e=l/i.width,t=c[a]/i.scene[a].height}e&&t?r.update(Gy(Gy({},o),{},{d:r.getPath(e,t)})):r.update(o),e=t=void 0}))}}]),n}();function Vy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Wy=function(e){S()(n,Au);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var a=oc[oc.findIndex((function(t){return t.name===e.model.shape}))],i={row:a.row,heights:a.heights};return r=t.call(this,h()(e,i)),c()(E()(r),"children",void 0),r}return v()(n,[{key:"canRough",value:function(){return!0}},{key:"canText",value:function(){return!1}},{key:"getChildren",value:function(){return this.children}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.getRoughGraphicOptions();return vu(this.stencil.outline,e)}}},{key:"updateStencil",value:function(){var e=this,t=this.shape,n=this.stencils,r=t||"process";if(!this.stencil||this.stencil.name!==r){var a=n.find((function(e){return e.name===r}));if(!a)throw new Error("unknown shape ".concat(r));this.stencil=a,this.updateAnchors(),["width","height"].forEach((function(t){null==e[t]&&(e[t]=a[t])})),this.cache={}}}},{key:"updateAnchors",value:function(){for(var e=this.anchors,t=this.stencil,n=function(){var n=e[r],a=t.anchors.find((function(e){return e.name===n.name}));a&&(e[r]=a)},r=0;r<e.length;r++)n()}},{key:"afterUpdateModel",value:function(){this.updateStencil(),I()(L()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"getKeyShape",value:function(){return this.outlineElement}},{key:"getOutlinePath",value:function(e){var t,n=this.width,r=this.heights,a=this.stencil,i=r.reduce((function(e,t){return e+t}),0);if(a.outline.path)t=a.outline.path(n,i);else{var o=n/a.width,c=i/a.height;t=e.getPath(o,c)}return t}},{key:"render",value:function(){I()(L()(n.prototype),"render",this).call(this);var e=this.model;e.width||(e.width=this.width),e.height||(e.height=this.height)}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(e){return e.capture(!0,!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(e){return e.capture(!1,!0)}))}},{key:"_drawInner",value:function(){this.isCacheStale("height","width","heights","roughFillStyle")&&(this.subcells.forEach((function(e){return e.draw()})),this.updateCache())}},{key:"updateCache",value:function(){var e=this,t=this.cache;["x","y","width","height","heights","rotate","fill","stroke","opacity","shape","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"executeLayout",value:function(){var e=this,t=this.diagram,n=this.getZIndex(),r=[0],a=D()(this.children),i=t.contentEditor,o=t.rootGroup;a.forEach((function(t,a){t.width=e.width,t.textarea.update();var i=t.textarea.getBBox();e.heights[a]=Math.max(i.height+12,30),t.matrix=e.matrix,t.height=e.heights[a],t.offsetY=r[a],t.opacity=e.opacity,r[a+1]=r[a]+e.heights[a],t.model.zIndex=n+a+1,t.textarea.draw()})),this.height=this.heights.reduce((function(e,t){return e+t}),0),a.sort((function(e,t){return t.model.zIndex-e.model.zIndex})),a.forEach((function(t){i.isBegin||o.insertBefore(e.graphicGroup,t.graphicGroup)})),this._drawInner()}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}},{key:"drawOpacity",value:function(){var e=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(t){t.drawOpacity(e.opacity)})))}},{key:"draw",value:function(){this.subcells.forEach((function(e){return e.draw()})),this.drawOpacity(),this.drawPosition(),this.updateCache()}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stencils:oc,stroke:{color:"#595959",width:2},fill:{color:"#fff"},children:[],isStack:!0,resizeRotatePoints:["lc","rc","rotate"],penetratedKeys:["x","y","width","height","rotate","heights","shape"],Subcells:[Xy]})}}]),n}();c()(Wy,"className","StackStem");var Zy=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.htmls,r=this.diagram;e.children=[];for(var a=0;a<e.row;a++)e.children.push({html:t[a],id:Object(F.a)(),nth:a});r.hooks.decorateAddStackModel.call(e),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Zy,"className","AddStack");var Uy=function(e){S()(n,Nh);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.htmls,r=this.diagram;e.children=[];for(var a=0;a<e.row;a++)e.children.push({html:t[a],id:Object(F.a)(),nth:a});r.hooks.decorateAddStackModel.call(e),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Uy,"className","AddStackVertex");var Ky={Cells:[Yy,Wy],Extends:[],defaultCursors:{},modes:[{mode:"edit",Behaviours:[function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"stack",void 0),c()(E()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"dblclick",(function(n){var r=t.viewport.invertClient([n.clientX,n.clientY]),a=t.getCell(n.target);if(a&&Rn(a)){var i,o=a;e.stack=o,o.getChildren().forEach((function(e){e.isPointInShape({x:r[0],y:r[1]})&&(i=e)})),o.enter(),i&&(t.selector.select(i),t.contentEditor.beginEdit())}})),this.bind(t,"afterselect",(function(t){var n=t.selections;e.stack&&n.findIndex((function(t){var n;return t.model.id===e.stack.model.id||(null===(n=t.parent)||void 0===n?void 0:n.model.id)===e.stack.model.id}))<0&&e.stack.exit()}))}}]),n}()]},{mode:"read",Behaviours:[]}],Commands:[Zy,Uy]};function Qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qy(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}dp.registerClipboardProcessor("swimlane",{lake:function(e){var t=e.model,n=e.offset;t.x=(t.x||0)+n[0],t.y=(t.y||0)+n[1],t.contain=[]}});var $y=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",void 0),c()(E()(e),"elements",[]),c()(E()(e),"bc",void 0),c()(E()(e),"lc",void 0),c()(E()(e),"rc",void 0),c()(E()(e),"tc",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;this.group=new Zr;for(var t=0;t<4;t++){var n=vu({stroke:"none","stroke-width":1});this.group.add(n),this.elements.push(n)}e.clipGroup.prepend(this.group),this.tc=this.elements[0],this.rc=this.elements[1],this.bc=this.elements[2],this.lc=this.elements[3]}},{key:"update",value:function(){}},{key:"draw",value:function(){var e=this.cell;if(e.isCacheStale("width","height","stroke")){var t=e.width,n=e.height,r=e.convertStrokeStyle();r.stroke="#fff",r["stroke-width"]=2*e.stroke.width,this.tc.update(Jy(Jy({},r),{},{d:rn(0,0,t,0)})),this.rc.update(Jy(Jy({},r),{},{d:rn(t,0,t,n)})),this.bc.update(Jy(Jy({},r),{},{d:rn(t,n,0,n)})),this.lc.update(Jy(Jy({},r),{},{d:rn(0,n,0,0)}))}}}]),n}();function ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ev(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ev(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nv=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",void 0),c()(E()(e),"horizentalElements",void 0),c()(E()(e),"verticalElements",void 0),c()(E()(e),"length",0),c()(E()(e),"numberWidth",0),c()(E()(e),"numberHeight",0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;this.group=new Zr,e.group.add(this.group)}},{key:"init",value:function(){var e=this,t=this.cell,n=t.getRoughGraphicOptions();this.group.clear(),this.horizentalElements=[],this.verticalElements=[],t.widths.forEach((function(){var t=vu({},n);t.dataset({test_tag:"verticalSwimlaneLine"}),e.group.add(t),e.verticalElements.push(t)})),t.heights.forEach((function(){var t=vu({},n);t.dataset({test_tag:"horizentalSwimlaneLine"}),e.group.add(t),e.horizentalElements.push(t)}))}},{key:"update",value:function(){var e,t,n,r,a,i,o,c;this.numberWidth===(null===(e=this.cell.model)||void 0===e||null===(t=e.widths)||void 0===t?void 0:t.length)&&this.numberHeight===(null===(n=this.cell.model)||void 0===n||null===(r=n.heights)||void 0===r?void 0:r.length)||(this.numberWidth=null===(a=this.cell.model)||void 0===a||null===(i=a.widths)||void 0===i?void 0:i.length,this.numberHeight=null===(o=this.cell.model)||void 0===o||null===(c=o.heights)||void 0===c?void 0:c.length)}},{key:"draw",value:function(){var e=this.cell;if(e.isCacheStale("stroke","width","height","widths","heights","roughFillStyle")){this.init();var t=tv(tv({},e.convertStrokeStyle()),{},{stroke:e.stroke.color,"stroke-width":e.stroke.width,d:""});this.horizentalElements.forEach((function(n,r){var a=e.heights[r]*e.height;t.d="M0,".concat(a," L").concat(e.width,",").concat(a),n.update(t)})),this.verticalElements.forEach((function(n,r){var a=e.widths[r]*e.width;t.d="M".concat(a,",0 L").concat(a,",").concat(e.height),n.update(t)}))}}}]),n}();var rv=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",void 0),c()(E()(e),"element",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell;this.group=new Zr,this.element=vu({stroke:"none",fill:"transparent"}),this.group.add(this.element),e.graphicGroup.prepend(this.group)}},{key:"update",value:function(){}},{key:"draw",value:function(){var e=this.cell;if(e.isCacheStale("width","height","widths","heights")){var t={d:""};t.d=e.isVertical?un(0,0,e.width,e.height*e.heights[0]):un(0,0,e.width*e.widths[0],e.height),this.element.update(t)}}}]),n}();function av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?av(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):av(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ov=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"clipGroup",new Zr),c()(E()(r),"clipPathID",Object(F.a)()),c()(E()(r),"group",new Zr),c()(E()(r),"isSwimlane",!0),c()(E()(r),"stencils",void 0),c()(E()(r),"stencil",void 0),c()(E()(r),"widths",void 0),c()(E()(r),"heights",void 0),c()(E()(r),"children",void 0),c()(E()(r),"contain",void 0),c()(E()(r),"shape",void 0),r}return v()(n,[{key:"init",value:function(e){var t=this;I()(L()(n.prototype),"init",this).call(this,e),this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")}),this.clipGroup.add(this.group),this.group.capture(!1),this.graphicGroup.prepend(this.clipGroup),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.subcells.forEach((function(e){return e.render()})),this.model.contain=this.model.contain||[],this.updateModel(this.model),this.eventDelegation()}},{key:"updateDefaultSize",value:function(){var e=this,t=this.stencil;t&&["width","height"].forEach((function(n){null==e[n]&&(e[n]=t[n])}))}},{key:"isVertical",get:function(){return"swimlane-vertical"===this.model.shape}},{key:"getTextBox",value:function(){var e=this.x,t=this.y,n=this.heights,r=this.width,a=this.height;if(this.isVertical){var i={x:e,y:t,width:r,height:n[0]*a};return iv(iv({},i),Nn(i))}return this.getBBox()}},{key:"containerBBox",get:function(){if(this.isVertical){var e=this.y+this.heights[0]*this.height,t=(1-this.heights[0])*this.height;return{x:this.x,y:e,width:this.width,height:t}}var n=this.x+this.widths[0]*this.width,r=(1-this.widths[0])*this.width;return{x:n,y:this.y,width:r,height:this.height}}},{key:"containerBBoxs",get:function(){var e=this;if(this.isVertical){var t=this.height*this.heights[0];return this.children.map((function(n){return{x:e.x+n.offsetX,y:e.y+t,width:n.width,height:e.height-t}}))}var n=this.width*this.widths[0];return this.children.map((function(t){return{x:e.x+n,y:e.y+t.offsetY,width:e.width-n,height:t.height}}))}},{key:"canUpdateText",value:function(){return!0}},{key:"getCanTextCell",value:function(){return this.children}},{key:"canRough",value:function(){return!0}},{key:"getOutlinePath",value:function(e){var t=this.width,n=this.height,r=this.stencil;if(this.isCacheStale("width","height","roughFillStyle")){var a;if(r.outline.path)a=r.outline.path(t,n);else{var i=t/r.width,o=n/r.height;a=e.getPath(i,o)}return a}}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(e){return e.capture(!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(e){return e.capture(!1)}))}},{key:"getChildren",value:function(){return this.children}},{key:"getKeyShape",value:function(){return this.outlineElement}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.stencil,t=this.getRoughGraphicOptions();return vu(e.outline,t)}}},{key:"updateModel",value:function(e){I()(L()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}},{key:"afterUpdateModel",value:function(){this.updateDefaultSize(),this._updateStencil(),this.updateMatrix(),this.subcells.forEach((function(e){e.update()})),this.getRoughGraphicOptions()?this.clipGroup.update({"clip-path":"none"}):this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")})}},{key:"_updateStencil",value:function(){var e=this.shape,t=this.stencils,n=e||"swimlane-vertical";if(!this.stencil||this.stencil.name!==n){var r=t.find((function(e){return e.name===n}));if(!r)throw new Error("unknown shape ".concat(n));this.stencil=r,this.updateDefaultSize(),this.cache={}}}},{key:"_layoutZIndex",value:function(){var e=this,t=this.diagram,n=t.rootGroup;t.contentEditor.isBegin||this.children.forEach((function(t){n.insertBefore(t.graphicGroup,e.graphicGroup)}))}},{key:"executeLayout",value:function(){var e=this;this._layoutZIndex();var t;t="swimlane-vertical"===this.shape?[0].concat(D()(this.widths),[1]):[0].concat(D()(this.heights),[1]),this.children.forEach((function(n,r){n.matrix=e.matrix,"swimlane-vertical"===e.shape?(n.offsetX=t[r]*e.width,n.offsetY=0,n.width=(t[r+1]-t[r])*e.width,n.height=e.height,n.textHeight=e.height*e.heights[0],n.textWidth=n.width):(n.offsetX=0,n.offsetY=t[r]*e.height,n.width=e.width,n.height=(t[r+1]-t[r])*e.height,n.textHeight=n.height,n.textWidth=e.width*e.widths[0]),n.x=e.x+n.offsetX,n.y=e.y+n.offsetY,n.textarea.update(),n.opacity=e.opacity,n.matrix=Xi(n.x,n.y,n.width,n.height,0)}))}},{key:"updateCache",value:function(){var e=this,t=this.cache;["x","y","width","widths","height","heights","rotate","shape","stroke","controlPoints","round","opacity","roughFillStyle"].forEach((function(n){var r=e[n];t[n]=d()(r)?iv({},r):r}))}},{key:"draw",value:function(){this.isCacheStale("roughFillStyle")&&this.deepEachWithoutSelf((function(e){e.draw()})),this.subcells.forEach((function(e){return e.draw()})),this.drawOpacity(),this.drawPosition(),this.updateCache()}},{key:"drawOpacity",value:function(){var e=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(t){t.drawOpacity(e.opacity)})))}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stencils:oc,stroke:{color:"#595959",width:2},rotate:0,children:[],penetratedKeys:["x","y","width","height","widths","heights","shape","htmls","stroke","contain","opacity"],resizeRotatePoints:["tl","tr","bl","br","tc","bc","lc","rc"],Subcells:[nv,wu,Xs,$y,rv]})}}]),n}();function cv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(ov,"className","SwimlaneStem");var sv=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"textVerticalAlign",void 0),c()(E()(r),"offsetX",0),c()(E()(r),"offsetY",0),c()(E()(r),"textWidth",0),c()(E()(r),"textHeight",0),c()(E()(r),"textRegion",void 0),c()(E()(r),"textarea",void 0),c()(E()(r),"parent",void 0),r}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,e),this.textarea=new nu(this),this.render(),this.updateModel(this.model),this.parent.children.splice(this.nth,0,this)}},{key:"getBBox",value:function(){var e=this.x,t=this.y,n=this.width,r=this.height;return{minX:e,minY:t,maxX:e+n,maxY:t+r,x:e,y:t,width:n,height:r}}},{key:"canRotate",value:function(){return!1}},{key:"contanerBBox",get:function(){return this.parent.containerBBoxs[this.nth]}},{key:"createTextRegion",value:function(){if(!this.textRegion||this.parent.isCacheStale("roughFillStyle")){var e=this.parent,t=vu({name:"rect",x:0,y:0,width:1,height:1,stroke:"none"},null==e?void 0:e.getRoughGraphicOptions());this.cache.fill=null,this.textRegion&&this.textRegion.remove(),this.textRegion=t,this.graphicGroup.prepend(t)}}},{key:"render",value:function(){this.createTextRegion(),this.textarea.render(),this.capture(!1)}},{key:"getKeyShape",value:function(){return this.textRegion}},{key:"updateModel",value:function(e){I()(L()(n.prototype),"updateModel",this).call(this,e),this.textarea.update()}},{key:"canConnect",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){var t=this.textVerticalAlign,n={x:Math.max((this.textWidth-e.width)/2,4),y:0};return n.y="top"===t?4:"bottom"===t?this.textHeight-e.height:(this.textHeight-e.height)/2,n}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"getOuterWidth",value:function(){return this.textWidth}},{key:"getTextBox",value:function(){var e={x:this.x,y:this.y,width:this.textWidth,height:this.textHeight};return lv(lv({},e),Nn(e))}},{key:"drawTextRegion",value:function(){var e=this.width,t=this.textHeight,n={width:e,textHeight:t,d:un(0,0,this.textWidth,t)};this.textRegion.update(n)}},{key:"updateCache",value:function(e){var t=this,n=this.cache;(e=e||["html","width","offsetX","offsetY","height","textWidth","textHeight","textVerticalAlign"]).forEach((function(e){var r=t[e];n[e]=d()(r)?lv({},r):r}))}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(e){this.isCacheStale("opacity")&&(e=e||this.opacity,this.graphicGroup.attr({opacity:e}),this.updateCache(["opacity"]))}},{key:"drawFill",value:function(){this.isCacheStale("fill")&&(0===this.nth&&(this.parent.fill=this.fill),this.textRegion.update({fill:this.fill.color}))}},{key:"drawPosition",value:function(){this.drawMatrix(),(this.isCacheStale("textWidth","textHeight","offsetY","offsetX","html","textVerticalAlign")||this.parent.isCacheStale("roughFillStyle"))&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"draw",value:function(){this.createTextRegion(),this.drawPosition(),this.drawOpacity(),this.drawFill(),this.updateCache()}},{key:"destroy",value:function(){bt(this.parent.children,this),I()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums",margin:0}}],multiSelectHighlight:!1,isSwimlaneCell:!0,textVerticalAlign:"center",penetratedKeys:["html","id","nth","fill","textVerticalAlign"],resizeRotatePoints:[],width:0,height:0,fill:{color:"#fff"},matrix:[1,0,0,0,1,0,0,0,1]})}}]),n}();c()(sv,"className","SwimlaneCell");var uv=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.htmls,r=this.number,a=this.diagram;e.children=[],e.id=e.id||Object(F.a)();for(var i=0;i<r;i++){var o=Object(F.a)();e.children.push({html:t[i],id:o,nth:i})}a.hooks.decorateAddSwimlaneModel.call(e),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(uv,"className","AddSwimlane");var dv=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"set",void 0),c()(E()(e),"swimlaneID",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this,t=this.id,r=this.diagram,a="string"==typeof t?r.find(t):t;this.swimlaneID=a.model.id,this.set=new Set,a.contain.forEach((function(t){var n=r.find(t);if(n){var i=li(n);e.set.has(i.model.id)||r.swimlane.isCellsInSwimlane([i],a)||(e.set.add(i.model.id),r.swimlane.unbind(i,a))}})),I()(L()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var e=this;this.set.forEach((function(t){e.diagram.swimlane.unbind(t,e.swimlaneID)})),I()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this;this.set.forEach((function(t){e.diagram.swimlane.bind(t,e.swimlaneID)})),I()(L()(n.prototype),"backward",this).call(this)}}]),n}();function fv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return hv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}c()(dv,"className","UpdateSwimlane"),c()(dv,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return Sn(e)}))}));var pv=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"originMap",new Map),c()(E()(e),"newMap",new Map),c()(E()(e),"ids",void 0),c()(E()(e),"parentID",void 0),e}return v()(n,[{key:"execute",value:function(){var e,t=this,r=this.id,a=this.parent,i=this.diagram;this.parentID=null==a||null===(e=a.model)||void 0===e?void 0:e.id;var o=r.map((function(e){return"string"==typeof e?t.diagram.find(e):e}));this.ids=r.map((function(e){return e.model.id})),o.forEach((function(e){var n=li(e),r=n.model.id;t.originMap.has(r)||(t.originMap.set(r,n.swimlane),t.newMap.set(r,t.parentID),i.swimlane.unbind(r,n.swimlane),i.swimlane.bind(r,t.parentID))})),I()(L()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var e,t=fv(this.originMap);try{for(t.s();!(e=t.n()).done;){var r=b()(e.value,2),a=r[0],i=r[1],o=this.newMap.get(a);this.diagram.swimlane.unbind(a,i),this.diagram.swimlane.bind(a,o)}}catch(e){t.e(e)}finally{t.f()}I()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e,t=fv(this.originMap);try{for(t.s();!(e=t.n()).done;){var r=b()(e.value,2),a=r[0],i=r[1],o=this.newMap.get(a);this.diagram.swimlane.unbind(a,o),this.diagram.swimlane.bind(a,i)}}catch(e){t.e(e)}finally{t.f()}I()(L()(n.prototype),"backward",this).call(this)}}]),n}();c()(pv,"className","InteractSwimlane");var mv=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"swimlaneID",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.diagram.selector.selections[0];this.swimlaneID=e.model.id,this._execute()}},{key:"forward",value:function(){this._execute()}},{key:"backward",value:function(){this._execute()}},{key:"_execute",value:function(){var e=this.diagram.find(this.swimlaneID);if(e&&Sn(e)){var t=this.switch(e),n=t.ids,r=t.nmodels;n.unshift(e.model.id);var a={width:e.height,height:e.width,widths:e.heights,heights:e.widths,shape:""};e.isVertical?a.shape="swimlane-horizontal":a.shape="swimlane-vertical",r.unshift(a),this.diagram.update(n,r)}}},{key:"getSwimlaneContainModels",value:function(e){var t=this.diagram,n=[];return it(e.model,(function(e){return"group"===e.type||!e.type||(n.push(e),!0)}),(function(e){return"swimlane"===e.type?e.contain.map((function(e){var n;return null===(n=t.find(e))||void 0===n?void 0:n.model})):e.children})),n}},{key:"switch",value:function(e){var t=this.getSwimlaneContainModels(e),n=e.isVertical?-90:90,r=e.center,a=[],i=t.map((function(t){a.push(t.id);var i={};e.isVertical?(i.x=r.x-t.x+r.x,i.y=t.y):(i.x=t.x,i.y=r.y-t.y+r.y);var o=Ao(r,n,[{x:i.x,y:i.y,w:0,h:0,r:0}]),c=b()(o,1)[0];i.x=c.x,i.y=c.y;var l=Math.abs(e.width-e.height)/2;return e.width>e.height?(i.x-=l,i.y+=l):(i.x+=l,i.y-=l),i}));return{ids:a,nmodels:i}}}],[{key:"enable",value:function(e){return 1===e.selector.selections.length&&Sn(e.selector.selections[0])}}]),n}();c()(mv,"className","SwitchSwimlane");var yv=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"swimlaneID",void 0),c()(E()(r),"removeLaneModel",void 0),c()(E()(r),"addLaneModel",void 0),c()(E()(r),"field",void 0),c()(E()(r),"number",void 0),c()(E()(r),"startNumber",void 0),c()(E()(r),"ids",[]),c()(E()(r),"removedChildIDSet",new Set),r.number=e.number,r}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.number;if(!(t<1||50<t)){var n=e.selector.selections[0];if(jn(n)&&(n=n.parent),n&&Sn(n)){this.swimlaneID=n.model.id,this.field="height",n.isVertical&&(this.field="width");var r=n.children.length;if(this.startNumber=r,this.options={model:[],cellOptions:[]},this.processModel(n),t>this.startNumber){for(var a=r;a<t;a++){var i=Object(F.a)();this.ids.push(i),this.options.model.push({html:'<div style="text-align:center;"><span style="font-weight:bold;">Lane '.concat(a+1,"</span></div>"),fill:n.children[r-1].model.fill,id:i,nth:a}),this.options.cellOptions.push({parent:n.model.id,nth:a})}this.addLane(n)}else if(t<r){for(var o=t;o<r;o++){var c=n.children[o],l=c.model,s=l.nth,u=l.id,d=l.html,f=l.fill;this.ids.push(c.model.id),this.options.model.push({html:d,id:u,nth:s,fill:f}),this.options.cellOptions.push({parent:n.model.id,nth:s})}this.removeLane(n),this.unbind(n)}}}}},{key:"forward",value:function(){var e=this,t=this.diagram.find(this.swimlaneID);t&&(this.number>this.startNumber?this.addLane(t):(this.removeLane(t),this.removedChildIDSet.forEach((function(n){e.diagram.swimlane.unbind(n,t)}))))}},{key:"backward",value:function(){var e=this,t=this.diagram.find(this.swimlaneID);t&&(this.number>this.startNumber?this.removeLane(t):(this.addLane(t),this.removedChildIDSet.forEach((function(n){e.diagram.swimlane.bind(n,t)}))))}},{key:"unbind",value:function(e){var t=this;this.diagram.swimlane.updateContain(e).forEach((function(e){t.removedChildIDSet.add(e)}))}},{key:"processModel",value:function(e){var t=this,n=this.field,r=e.children.length;if(this.number>r){var a,i;this.removeLaneModel=(c()(a={},"".concat(n,"s"),e["".concat(n,"s")]),c()(a,n,e[n]),a);var o=[0].concat(D()(e["".concat(n,"s")]),[1]),l=e[n],s=e[n]+150*(this.number-r),u=[];o.forEach((function(e,t){t!==o.length-1&&u.push(l*(o[t+1]-o[t]))}));for(var d=r;d<this.number;d++)u.push(150);var f=[];u.reduce((function(e,t,n){return n>=u.length-1?0:(f.push((e+t)/s),e+t)}),0),this.addLaneModel=(c()(i={},"".concat(n,"s"),f),c()(i,n,s),i)}else if(this.number<r){var h,p;this.addLaneModel=(c()(h={},"".concat(n,"s"),e["".concat(n,"s")]),c()(h,n,e[n]),h);var m=[0].concat(D()(e["".concat(n,"s")]),[1]),y=e[n],v=[];m.forEach((function(e,n){n>=t.number||v.push(y*(m[n+1]-m[n]))}));var g=v.reduce((function(e,n,r){return r>=t.number?e:e+n}),0),b=[];v.reduce((function(e,t,n){return n===v.length-1?0:(b.push((e+t)/g),e+t)}),0),this.removeLaneModel=(c()(p={},"".concat(n,"s"),b),c()(p,n,g),p)}}},{key:"addLane",value:function(e){var t=this.diagram,n=this.field;e["".concat(n,"s")]=this.addLaneModel["".concat(n,"s")],e[n]=this.addLaneModel[n],t.hooks.decorateAddSwimlaneChildModel.call(this.options.model[0]),t.add(this.options.model,this.options.cellOptions),t.update(e,this.addLaneModel)}},{key:"removeLane",value:function(e){var t=this.diagram,n=this.field;this.isRemovedInSelections()&&t.selector.select([]),t.remove(this.ids),e["".concat(n,"s")]=this.removeLaneModel["".concat(n,"s")],e[n]=this.removeLaneModel[n],t.update(e,this.removeLaneModel)}},{key:"isRemovedInSelections",value:function(){var e=this;return this.ids.some((function(t){return e.diagram.selector.selections.find((function(e){return e.model.id===t}))}))}}]),n}();c()(yv,"className","ChangeLaneNumber"),c()(yv,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&Sn(t[0])||t.every((function(e){return e.swimlane===t[0].swimlane}))}));var vv=function(){function e(t){m()(this,e),this.diagram=t,c()(this,"swimlanes",void 0),c()(this,"group",new Zr),this.swimlanes=[],t.frontRootGroup.add(this.group)}return v()(e,[{key:"findSwimlane",value:function(e){if(0!==e.length&&!e.some((function(e){return Sn(e)}))){for(var t,n=this.getSwimlanes(),r=this.computeRegion(e),a=0;a<n.length;a++){var i=n[a];if(eo(Nn(i.containerBBox),r)){t=i;break}}return this.swimlanes=[],t}}},{key:"highlight",value:function(e){var t=this.diagram.connect.getCellConnectStateElement(e);this.group.clear(),this.group.add(t)}},{key:"unhighlight",value:function(){this.group.clear()}},{key:"updateContain",value:function(e){var t=this,n=[],r=this.diagram;return e.model.contain.forEach((function(a){var i=r.find(a);i&&(t.isCellsInSwimlane([i],e)||(r.swimlane.unbind(i,e),n.push(i.model.id)))})),n}},{key:"resetNth",value:function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){var n=t.diagram.find(e);n&&n.children.forEach((function(e,t){e.nth=t,e.model.nth=t}))}))}},{key:"isCellsInSwimlane",value:function(e,t){var n=this.diagram,r=e.map((function(e){return n.find(e)})).filter((function(e){return e})),a=this.computeRegion(r),i=n.find(t);return!!i&&eo(Nn(i.containerBBox),a)}},{key:"bind",value:function(e,t){var n=this.diagram,r=n.find(e),a=n.find(t);r&&(a&&Sn(a)?(r.swimlane=a.model.id,kt(a.model.contain,r.model.id)):r.swimlane=void 0)}},{key:"unbind",value:function(e,t){var n=this.diagram,r=n.find(e),a=t?n.find(t):n.find(null==r?void 0:r.swimlane);a&&Sn(a)&&(r?(r.swimlane=void 0,bt(a.model.contain,r.model.id)):"string"==typeof e&&bt(a.model.contain,e))}},{key:"getSwimlanes",value:function(){return this.swimlanes.length>0?this.swimlanes:this.swimlanes=this.diagram.getCells().filter((function(e){return Sn(e)})).sort((function(e,t){return t.getZIndex()-e.getZIndex()}))}},{key:"getCellofSwimlane",value:function(e,t){for(var n=t.containerBBoxs,r=0,a=-1,i=0;i<n.length;i++){var o=n[i],c=Co(o,e);c>r&&(r=c,a=i)}return t.children[a]}},{key:"computeRegion",value:function(e){return Tn(e,(function(e){return xn(e)?e.getPointBox():e.getBBox()}))}},{key:"destroy",value:function(){this.group.remove()}}]),e}();c()(vv,"className","Swimlane");var gv={lake_prevent_click_unselect:"true",swimlane_resize_controller:"true"},bv=function(e){S()(n,uf);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"cell",void 0),c()(E()(r),"horizontals",[]),c()(E()(r),"verticals",[]),c()(E()(r),"swimlaneGroup",new Zr),c()(E()(r),"swimlane",void 0),r}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,e),this.swimlane=Sn(e)?e:e.parent,this._init()}},{key:"_init",value:function(){this.swimlane.widths.length===this.verticals.length&&this.swimlane.heights.length===this.horizontals.length||(this.prepareResizeLines(),this.bindEvent())}},{key:"prepareResizeLines",value:function(){var e=this;this.swimlaneGroup.clear(),this.verticals=[],this.horizontals=[],this.swimlane.widths.forEach((function(){var t=oi("vertical",gv);t.visShape.update({stroke:"rgba(255,255,255,0)"}),e.swimlaneGroup.add(t.group),e.verticals.push(t)})),this.swimlane.heights.forEach((function(){var t=oi("horizontal",gv);t.visShape.update({stroke:"rgba(255,255,255,0)"}),e.swimlaneGroup.add(t.group),e.horizontals.push(t)}))}},{key:"update",value:function(){var e=this.swimlane,t=this.diagram;if(e){this._init();var r=1/t.viewport.zoom,a=r,i=8*r;I()(L()(n.prototype),"update",this).call(this),this.verticals.forEach((function(t,n){var r=e.percentage2Canvas([e.widths[n],0]),o=e.percentage2Canvas([e.widths[n],1]);t.shape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":i}),t.visShape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":a})})),this.horizontals.forEach((function(t,n){var r=e.percentage2Canvas([0,e.heights[n]]),o=e.percentage2Canvas([1,e.heights[n]]);t.shape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":i}),t.visShape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":a})}))}}},{key:"bindEvent",value:function(){var e,t,r,a,i=this,o=this.eventHelper,c=this.diagram,l=this.swimlane;this.eventHelper.unbind();var u={},d={},f=!1;[].concat(D()(this.verticals),D()(this.horizontals)).forEach((function(n,s){o.bind(n.shape,"mouseenter",(function(){n.visShape.update({stroke:pr})})),o.bind(n.shape,"mouseleave",(function(){n.visShape.update({stroke:"rgba(255,255,255,0)"})})),o.bind(n.shape,"mousedown",(function(o){c.contentEditor.unbind(),r=n.name,e=l.widths,t=l.heights,a="horizontal"===n.name?s-i.verticals.length:s,u={widths:e,heights:t}}))})),o.bind(c,"mousemove",(function(n){if(r&&e&&t&&void 0!==a){var o,l,u=c.viewport.invertClient([n.clientX,n.clientY]),h=i.swimlane.canvas2percentage(u),p=[0].concat(D()(e),[1]),m=[0].concat(D()(t),[1]);"vertical"===r?(o=p[a],l=p[a+2],d.widths=s()(e),d.widths[a]=ut(h[0],o,l)):(o=m[a],l=m[a+2],d.heights=s()(t),d.heights[a]=ut(h[1],o,l)),c.update(i.swimlane,d)}else if(n.target.dataset.swimlane_resize_controller){var y;if("line"===n.target.dataset.type){var v=ln(n.target.getAttribute("d"));y=fi([v[1][1]-v[0][1],v[1][2]-v[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}f||(f=!0),y&&c.setCursor(y)}else f&&(c.resetCursor(),f=!1)})),o.bind(c,"mouseup",(function(){Object.keys(d).length>0&&(xe()(d.widths,e)&&xe()(d.heights,t)||c.command.execute("Update",{id:l,model:d,originModels:[u],select:function(){}})),t=void 0,t=void 0,r=void 0,a=void 0,f=!1,u={},d={}})),I()(L()(n.prototype),"bindEvent",this).call(this)}},{key:"begin",value:function(){this.group.add(this.swimlaneGroup),I()(L()(n.prototype),"begin",this).call(this)}}]),n}();c()(bv,"className","SwimlaneResize");var xv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"swimlane",void 0),c()(E()(e),"diagram",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"dblclick",(function(n){var r=t.viewport.invertClient([n.clientX,n.clientY]),a=t.getCell(n.target);if(a&&Sn(a)){var i,o=a;e.swimlane=o,o.children.forEach((function(e){e.isPointInShape({x:r[0],y:r[1]})&&(i=e)})),o.enter(),i&&(t.selector.select(i),t.contentEditor.beginEdit())}})),this.bind(t,"afterselect",(function(t){var n=t.selections;e.swimlane&&n.findIndex((function(t){return t===e.swimlane||t.parent===e.swimlane}))<0&&e.swimlane.exit()}))}}]),n}();var kv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"group",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.group=new Zr,e.backRootGroup.add(this.group),this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram,n=[];this.bind(t,"afterselectionchange",(function(t){var r=t.selections.filter((function(e){return Sn(e)}));e.group.clear(),n=[],r.forEach((function(t){var r=vu({stroke:"none",fill:"transparent",d:un(t.x,t.y,t.width,t.height)});r.css({cursor:"move"}),r.dataset({cellid:t.model.id}),n.push(r),e.group.add(r)}))}));var r=function(){n.forEach((function(e){var n=t.find(e.rendererElement.dataset.cellid);if(n){var r=n.containerBBox,a=r.x,i=r.y,o=r.width,c=r.height;e.update({d:un(a,i,o,c)})}}))};this.bind(t,"cell:dragend",(function(){r()})),this.bind(t,"aftervertexresize",(function(){r()}))}},{key:"reset",value:function(){this.group.remove()}}]),n}();var wv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"group",void 0),c()(E()(e),"swimlane",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.group=new Zr,e.backRootGroup.add(this.group)}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"afterselectionchange",(function(t){var n,r,a=t.selections,i=a[0];i&&(Sn(i)?r=i:jn(i)&&(r=i.parent),r&&(e.swimlane=r,a.every((function(e){return Sn(e)?r===e:!!jn(e)&&r===e.parent}))))?r.swimlaneExtension.show():null===(n=e.swimlane)||void 0===n||n.swimlaneExtension.hide()}))}},{key:"reset",value:function(){this.group.remove()}}]),n}();var Cv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"group",void 0),c()(E()(e),"swimlane",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.group=new Zr,e.backRootGroup.add(this.group),this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram;this.bind(e,"afterimport",(function(){e.getCells().forEach((function(t){if(Sn(t)){var n,r=[];null===(n=t.model.contain)||void 0===n||n.forEach((function(n){var a=e.find(n);a?a.swimlane=t.model.id:r.push(n)})),bt.apply(void 0,[t.model.contain].concat(r))}}))}))}}]),n}();function Av(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ov(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ov(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function Ov(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ev=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=["Add","AddVertex","AddStack","AddStackVertex"],n=this.diagram;this.bind(n,"aftercommandexecute",(function(r){var a=r.commandName,i=r.command;if(t.includes(a)){var o=new Map,c=Array.isArray(i.model)?i.model:[i.model],l=!1;c.forEach((function(e){var t=n.find(e.id);if(t){var r=li(t);if(!o.has(r.model.id)){var a,i=null===(a=n.swimlane)||void 0===a?void 0:a.findSwimlane([r]);i&&(l=!0,n.swimlane.bind(r,i),o.set(r.model.id,i.model.id))}}})),l&&e.weakMap.set(i,o)}})),this.bind(n,"beforecommandbackward",(function(n){var r=n.command,a=e.weakMap.get(r);if(a&&t.includes(r.commandName)){var i,o=Av(a);try{for(o.s();!(i=o.n()).done;){var c=b()(i.value,2),l=c[0],s=c[1];e.diagram.swimlane.unbind(l,s)}}catch(e){o.e(e)}finally{o.f()}}})),this.bind(n,"aftercommandforward",(function(n){var r=n.command,a=e.weakMap.get(r);if(a&&t.includes(r.commandName)){var i,o=Av(a);try{for(o.s();!(i=o.n()).done;){var c=b()(i.value,2),l=c[0],s=c[1];e.diagram.swimlane.bind(l,s)}}catch(e){o.e(e)}finally{o.f()}}}))}}]),n}();function Pv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Sv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function Sv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jv=v()((function e(){m()(this,e),c()(this,"map",new Map),c()(this,"groupID",void 0),c()(this,"swimlaneID",void 0)})),Rv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"weakMap",new WeakMap),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e,t=this,n=this.diagram;this.bind(n,"beforecommandexecute",(function(r){var a=r.commandName;if("MakeGroup"===a)e=D()(n.selector.selections);else if("Ungroup"===a){var i=new jv,o=!1;n.selector.selections.forEach((function(e){e.swimlane&&(i.map.set(e.model.id,e.swimlane),o=!0)})),o&&(t.weakMap.set(r.command,i),t.unGroupForward(i))}})),this.bind(n,"aftercommandexecute",(function(r){if(e&&"MakeGroup"===r.commandName){var a=new jv,i=a.map,o=!1,c=!1;if(e.some((function(e){return e.swimlane}))&&(o=!0),e.forEach((function(e){Sn(e)&&(c=!0),i.set(e.model.id,e.swimlane)})),o&&!c){e.forEach((function(e){n.swimlane.unbind(e,e.swimlane)}));var l=e[0].parent;if(l){a.groupID=l.model.id;var s=n.swimlane.findSwimlane([l]);s&&(n.swimlane.bind(l,s),a.swimlaneID=s.model.id)}e=void 0,t.weakMap.set(r.command,a)}}})),this.bind(n,"aftercommandbackward",(function(e){var r=e.command,a=t.weakMap.get(r);if(a)if("MakeGroup"===r.commandName){n.swimlane.unbind(a.groupID,a.swimlaneID);var i,o=Pv(a.map.entries());try{for(o.s();!(i=o.n()).done;){var c=b()(i.value,2),l=c[0],s=c[1];n.swimlane.bind(l,s)}}catch(e){o.e(e)}finally{o.f()}}else if("Ungroup"===r.commandName){var u,d=Pv(a.map);try{var f=function(){var e=b()(u.value,2),t=e[0],r=e[1],a=n.find(t),i=n.find(r);a&&i&&(n.swimlane.bind(a,i),a.children.forEach((function(e){n.swimlane.unbind(e,i)})))};for(d.s();!(u=d.n()).done;)f()}catch(e){d.e(e)}finally{d.f()}}})),this.bind(n,"aftercommandforward",(function(e){var r=e.command;if("MakeGroup"===r.commandName){var a=t.weakMap.get(r);if(a){var i=n.find(a.groupID);if(i){var o,c=Pv(a.map);try{for(c.s();!(o=c.n()).done;){var l=b()(o.value,1)[0];n.swimlane.unbind(l)}}catch(e){c.e(e)}finally{c.f()}var s=n.swimlane.findSwimlane([i]);s&&n.swimlane.bind(i,s)}}}})),this.bind(n,"beforecommandforward",(function(e){var n=e.command,r=t.weakMap.get(n);r&&"Ungroup"===n.commandName&&t.unGroupForward(r)}))}},{key:"unGroupForward",value:function(e){var t,n=this.diagram,r=Pv(e.map);try{var a=function(){var e=b()(t.value,2),r=e[0],a=e[1],i=n.find(r),o=n.find(a);i&&o&&(n.swimlane.unbind(i,o),i.children.forEach((function(e){n.swimlane.isCellsInSwimlane([e],o)&&n.swimlane.bind(e,o)})))};for(r.s();!(t=r.n()).done;)a()}catch(e){r.e(e)}finally{r.f()}}}]),n}();function Mv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Lv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function Lv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"weakMap",new WeakMap),c()(E()(e),"DeleteNames",["Delete"]),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this.initEvent()}},{key:"getRecords",value:function(e){return this.weakMap.get(e)}},{key:"check",value:function(e){var t=this.getRecords(e);if(t&&this.DeleteNames.includes(e.commandName))return t}},{key:"initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"beforecommandexecute",(function(n){var r=n.commandName,a=n.command;if(e.DeleteNames.includes(r)){var i=a.cells||t.selector.selections,o=i.map((function(e){return t.find(e)}));if(o.some((function(e){return jn(e)}))){var l=new Set,s=new Map;o.forEach((function(e){if(Sn(e))l.add(e.model.id);else if(jn(e)){var t,n=e.parent.model.id,r=e.model.id;s.has(n)?null===(t=s.get(n))||void 0===t||t.add(r):s.set(n,new Set([r]))}}));var u={unbindIDs:new Map,newModels:new Map,originModels:new Map};e.weakMap.set(a,u);var d,f=Mv(s);try{var h,p=function(){var e=b()(d.value,2),n=e[0],r=e[1];if(l.has(n))return bt.apply(void 0,[i].concat(D()(Le()(Array,D()(r))))),0;var a=t.find(n);if(!a)return{v:void 0};if(r.size===a.children.length)bt.apply(void 0,[i].concat(D()(Le()(Array,D()(r))))),i.push(n);else{var o,s,f="height";a.isVertical&&(f="width");var h=0,p=[],m=[];a.children.forEach((function(e){r.has(e.model.id)||(h+=e[f],p.push(e[f]))})),p.reduce((function(e,t,n){return n>=p.length-1?e:(m.push((e+t)/h),e+t)}),0),u.originModels.set(a.model.id,(c()(o={},f,a[f]),c()(o,"".concat(f,"s"),a["".concat(f,"s")]),o)),u.newModels.set(a.model.id,(c()(s={},f,h),c()(s,"".concat(f,"s"),m),s)),a["".concat(f,"s")]=m,a[f]=h,u.unbindIDs.set(a.model.id,t.swimlane.updateContain(a))}};for(f.s();!(d=f.n()).done;)if(0!==(h=p())&&h)return h.v}catch(e){f.e(e)}finally{f.f()}a.cells=i}}}));var n=function(t){var n,r=e.diagram,a=[],i=[],o=Mv(t.newModels);try{var c=function(){var e,o=b()(n.value,2),c=o[0],l=o[1];if(a.push(c),i.push(l),!r.find(c))return 1;null===(e=t.unbindIDs.get(c))||void 0===e||e.forEach((function(e){r.swimlane.unbind(e,c)}))};for(o.s();!(n=o.n()).done;)c()}catch(e){o.e(e)}finally{o.f()}a.length>0&&(r.update(a,i),r.swimlane.resetNth(a))};this.bind(t,"aftercommandexecute",(function(t){var r=t.command;if(e.check(r)){var a=e.getRecords(r);a&&n(a)}})),this.bind(t,"aftercommandforward",(function(t){var r=t.command;if(e.check(r)){var a=e.getRecords(r);a&&n(a)}})),this.bind(t,"beforecommandbackward",(function(t){var n=t.command,r=e.weakMap.get(n);if(r&&e.DeleteNames.includes(n.commandName)){var a,i=e.diagram,o=[],c=[],l=Mv(r.originModels);try{var s=function(){var e,t=b()(a.value,2),n=t[0],l=t[1],s=i.find(n);if(!s)return 1;null===(e=r.unbindIDs.get(n))||void 0===e||e.forEach((function(e){i.swimlane.bind(e,n)})),Object.assign(s,l),o.push(n),c.push(l)};for(l.s();!(a=l.n()).done;)s()}catch(e){l.e(e)}finally{l.f()}}})),this.bind(t,"aftercommandbackward",(function(n){var r=n.command,a=e.weakMap.get(r);if(a&&e.DeleteNames.includes(r.commandName)){var i,o=[],c=[],l=Mv(a.originModels);try{for(l.s();!(i=l.n()).done;){var s=b()(i.value,2),u=s[0],d=s[1];t.find(u)&&(o.push(u),c.push(d))}}catch(e){l.e(e)}finally{l.f()}o.length>0&&(t.update(o,c),t.swimlane.resetNth(o))}}))}}]),n}(),Dv={Cells:[ov,sv],Extends:[vv,bv],defaultCursors:{},modes:[{mode:"edit",Behaviours:[wv,xv,kv,Cv,Ev,Rv,Bv]},{mode:"read",Behaviours:[]}],Commands:[yv,uv,dv,pv,mv]};function Nv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Iv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tv=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",void 0),c()(E()(e),"elements",[]),e}return v()(n,[{key:"render",value:function(){this.group=new Zr,this.cell.clipGroup.add(this.group)}},{key:"init",value:function(){var e=this,t=this.cell;switch(this.elements=[],this.group.clear(),this.cell.shape){case"pyramid":t.info.forEach((function(n,r){if(r!==t.info.length-1)for(var a=1;a<=n;a++)e.createElement()}));break;case"segmented pyramid":for(var n=2;n<=t.otherInfo.rows;n++)for(var r=1;r<n;r++)this.createElement({fill:"transparent"});break;case"stage":t.info.forEach((function(t,n){e.createElement({fill:"transparent"})}));break;case"architecture":for(var a=t.info.reduce((function(e,t){return e+t}),0),i=0;i<a;i++)this.createElement({fill:"transparent"})}}},{key:"createElement",value:function(){var e=vu(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},this.cell.getRoughGraphicOptions());this.group.add(e),this.elements.push(e)}},{key:"update",value:function(){this.cell.isCacheStale("htmls")&&this.init()}},{key:"draw",value:function(){var e=this,t=this.cell;if(t.isCacheStale("stroke","width","height","htmls","roughFillStyle")){this.init();var n=Iv(Iv({},t.convertStrokeStyle()),{},{stroke:t.stroke.color,"stroke-width":t.stroke.width,d:""});if("architecture"!==t.shape)if("segmented pyramid"!==t.shape){var r=0,a=t.info.length;t.info.forEach((function(i,o){if("pyramid"===t.shape){if(o===a-1)return;for(var c=1;c<=i;c++)if(1===c){var l=(o+1)/a,s=(1-(o+1)/a)*(t.width/2),u=t.width-s,d=l*t.height;n.d="M".concat(s,",").concat(d," L").concat(u,",").concat(d),e.elements[r++].update(n)}}else if("stage"===t.shape){var f=o/a,h=t.width*f;n.d="M".concat(h-25,",",0," L").concat(h,",").concat(t.height/2," L").concat(h-25,",").concat(t.height),e.elements[r++].update(n)}}))}else for(var i=t.otherInfo.rows,o=0,c=2;c<=t.otherInfo.rows;c++)for(var l=(c-1)/i,s=1-l,u=l*t.height,d=s*(t.width/2),f=t.width-d,h=c/i,p=1-h,m=h*t.height,y=p*(t.width/2),v=c-1,g=(f-d)/v,b=(t.width-y-y)/(v+1),x=0;x<v;x++){var k=this.elements[o++],w=d+x*g,C=w+g,A=y+(x+1)*b;n.d="M".concat(w,",").concat(u," L").concat(C,",").concat(u," L").concat(A,",").concat(m," Z"),k.update(n)}else{var O=0,E=t.info.length,P=10,S=(t.height-P*(E+1))/E;t.info.forEach((function(r,a){for(var i=r,o=(t.width-P*(i+1))/i,c=0;c<r;c++){var l=P+(o+P)*c,s=P+(S+P)*a;n.d=Wi(o,S,4,l,s),e.elements[O++].update(n)}}))}}}}]),n}();function _v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Fv=function(e){S()(n,qs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"group",void 0),c()(E()(e),"shapeElement",void 0),e}return v()(n,[{key:"render",value:function(){var e=this.cell,t=new Zr;this.group=t,e.backGroup.add(t)}},{key:"update",value:function(){var e=this.cell,t=this.group,n=e.createOutlineShapeElement();n&&(t.clear(),t.add(n),this.shapeElement=n)}},{key:"draw",value:function(){var e=this.cell,t=this.shapeElement,n=e.stroke,r=e.fill;if(n){var a={},i=e.getOutlinePath(t);i&&(a.d=i),e.isCacheStale("stroke","roughFillStyle")&&Object.assign(a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_v(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({stroke:"none"},e.convertStrokeStyle())),a.fill=r.color,t.update(a)}}}]),n}();function zv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var qv=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"isDsl",!0),c()(E()(e),"stencils",void 0),c()(E()(e),"stencil",void 0),c()(E()(e),"info",void 0),c()(E()(e),"clipGroup",new Zr),c()(E()(e),"clipPathID",Object(F.a)()),c()(E()(e),"backGroup",new Zr),c()(E()(e),"group",new Zr),c()(E()(e),"children",void 0),c()(E()(e),"shape",void 0),e}return v()(n,[{key:"init",value:function(e){var t=this;I()(L()(n.prototype),"init",this).call(this,e),this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")}),this.graphicGroup.prepend(this.clipGroup),"architecture"===e.model.shape&&(this.graphicGroup.prepend(this.backGroup),this.Subcells.push(Fv)),this.subcells=this.Subcells.map((function(e){return new e(t)})),this.subcells.forEach((function(e){return e.render()})),this.updateModel(this.model)}},{key:"getOutlinePath",value:function(e){var t,n=this.width,r=this.height,a=this.stencil;if(a.outline.path)t=a.outline.path(n,r);else{var i=n/a.width,o=r/a.height;t=e.getPath(i,o)}return t}},{key:"canUpdateText",value:function(){return!0}},{key:"canRotate",value:function(){return!1}},{key:"canRough",value:function(){return!0}},{key:"getCanTextCell",value:function(){return this.children}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var e=this.stencil,t=this.getRoughGraphicOptions();return vu(e.outline,t)}}},{key:"canConnect",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"getKeyShape",value:function(){var e;return null===(e=this.subcells.find((function(e){return e instanceof wu})))||void 0===e?void 0:e.shapeElement}},{key:"updateModel",value:function(e){I()(L()(n.prototype),"updateModel",this).call(this,e),this.afterUpdateModel()}},{key:"afterUpdateModel",value:function(){this.updateStencil(),this.parse(),this.updateMatrix(),this.subcells.forEach((function(e){return e.update()}))}},{key:"parse",value:function(){var e,t,n=null===(e=(t=this.stencil).parse)||void 0===e?void 0:e.call(t,this.htmls);this.info=null==n?void 0:n.info,this.otherInfo=null==n?void 0:n.otherInfo}},{key:"updateDefaultSize",value:function(){var e=this,t=this.stencil;t&&["width","height"].forEach((function(n){null==e[n]&&(e[n]=t[n])}))}},{key:"updateStencil",value:function(){var e=this.shape,t=this.stencils,n=e||"pyramid";if(!this.stencil||this.stencil.name!==n){var r,a,i,o=t.find((function(e){return e.name===n}));if(!o)throw new Error("unknown shape ".concat(n));this.stencil=o,this.updateDefaultSize(),this.htmls=null!==(r=this.htmls)&&void 0!==r?r:o.htmls,this.model.width=null!==(a=this.model.width)&&void 0!==a?a:o.width,this.model.height=null!==(i=this.model.height)&&void 0!==i?i:o.height,this.cache={}}}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var e=this.graphicGroup,t=this.matrix;e.update({matrix:t})}}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(e){return e.capture(!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(e){return e.capture(!1)}))}},{key:"layoutZIndex",value:function(){var e,t=this,n=this.diagram,r=n.rootGroup;n.contentEditor.isBegin||this.children.forEach((function(e){r.insertBefore(e.graphicGroup,t.graphicGroup)})),"architecture"===this.shape&&(this.backGroup.update({matrix:this.matrix}),r.insertBefore(this.backGroup,null!==(e=this.children[0].graphicGroup)&&void 0!==e?e:this.graphicGroup))}},{key:"executeLayout",value:function(){var e=this;if(0!==this.children.length){this.layoutZIndex();var t=this.info,n=0,r=t.length;if("architecture"===this.shape){var a=this.info.length,i=10,o=(this.height-i*(a+1))/a;this.info.forEach((function(t,r){for(var a=t,c=(e.width-i*(a+1))/a,l=0;l<t;l++){var s=i+(c+i)*l,u=i+(o+i)*r,d=e.children[n++];if(!d)return;d.offsetX=s,d.offsetY=u,d.width=c,d.height=o,d.matrix=e.matrix,d.opacity=e.opacity,d.textWidth=d.width,d.textHeight=d.height,d.x=d.offsetX,d.y=d.offsetY,d.textarea.update()}}))}if("segmented pyramid"!==this.shape)t.forEach((function(t,a){if("pyramid"===e.shape)for(var i=r,o=(a+1)/i,c=e.width*o,l=e.height/i,s=(e.width-c)/2,u=a/i*e.height,d=c/t,f=0;f<t;f++){var h=e.children[n++];h.offsetX=s+d*f,h.offsetY=u,h.width=d,h.height=l,h.matrix=e.matrix,h.opacity=e.opacity,h.textWidth=h.width,h.textHeight=h.height,h.x=h.offsetX,h.y=h.offsetY,h.textarea.update()}else if("stage"===e.shape){var p=e.children[n++],m=e.width/r,y=a/r;p.offsetX=y*e.width,p.offsetY=0,p.width=m,p.height=e.height,p.matrix=e.matrix,p.opacity=e.opacity,p.textWidth=p.width,p.textHeight=p.height,p.x=p.offsetX,p.y=p.offsetY,p.textarea.update()}}));else for(var c=this.height/this.otherInfo.rows,l=this.width/this.otherInfo.rows,s=1;s<=this.otherInfo.rows;s++)for(var u=(1-s/this.otherInfo.rows)*(this.width/2),d=(s-1)*c,f=l/2,h=1;h<=2*s-1;h++){var p=this.children[n++];if(!p)return;p.offsetX=u+(h-1)*f,p.offsetY=d,p.width=l,p.height=c,p.matrix=this.matrix,p.opacity=this.opacity,p.textWidth=p.width,p.textHeight=p.height,p.x=p.offsetX,p.y=p.offsetY,p.textarea.update()}}}},{key:"draw",value:function(){this.isCacheStale("roughFillStyle")&&this.deepEachWithoutSelf((function(e){e.draw()})),this.drawOpacity(),this.drawPosition(),this.subcells.forEach((function(e){return e.draw()})),this.updateCache()}},{key:"drawOpacity",value:function(){var e=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(t){t.drawOpacity(e.opacity)})))}},{key:"updateCache",value:function(){var e=this,t=this.cache;["matrix","shape","htmls","stroke","roughFillStyle","width","height","opacity","fill"].forEach((function(n){var r=e[n];t[n]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"destroy",value:function(){var e;null===(e=this.backGroup)||void 0===e||e.destroy(),I()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{stencils:oc,stroke:{color:"#595959",width:2},fill:{color:"#fff"},rotate:0,children:[],penetratedKeys:["shape","htmls","stroke","opacity","x","y","width","height","rotate","fill"],resizeRotatePoints:["tl","tr","bl","br","tc","bc","lc","rc"],Subcells:[wu,Tv,Xs]})}}]),n}();function Yv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}c()(qv,"className","DslStem");var Hv=function(e){S()(n,Gs);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;return m()(this,n),r=t.call(this,e),c()(E()(r),"isDslCell",!0),c()(E()(r),"textVerticalAlign",void 0),c()(E()(r),"offsetX",0),c()(E()(r),"offsetY",0),c()(E()(r),"textWidth",0),c()(E()(r),"textHeight",0),c()(E()(r),"textRegion",void 0),c()(E()(r),"textarea",void 0),c()(E()(r),"parent",void 0),r}return v()(n,[{key:"init",value:function(e){I()(L()(n.prototype),"init",this).call(this,e),this.graphicGroup.update({"clip-path":"url(#".concat(this.parent.clipPathID,")")}),this.textarea=new nu(this),this.render(),this.updateModel(this.model),this.parent.children.splice(this.nth,0,this)}},{key:"getBBox",value:function(){var e=this.offsetY,t=this.height,n=this.width,r=this.offsetX,a=this.parent.getBBox();return a.height=t,a.width=n,a.x+=r,a.minX=a.x,a.maxX=a.minX+a.width,a.y+=e,a.minY=a.y,a.maxY=a.minY+a.height,a}},{key:"canRotate",value:function(){return!1}},{key:"canUpdateText",value:function(){return!0}},{key:"canText",value:function(){return!1}},{key:"contanerBBox",get:function(){return this.parent.containerBBoxs[this.nth]}},{key:"createTextRegion",value:function(){if(!this.textRegion||this.parent.isCacheStale("roughFillStyle")){var e=this.parent,t=vu({name:"path",x:0,y:0,width:1,height:1,stroke:"none"},null==e?void 0:e.getRoughGraphicOptions());this.cache.fill=null,this.textRegion&&this.textRegion.remove(),this.textRegion=t,this.graphicGroup.prepend(t)}}},{key:"render",value:function(){this.createTextRegion(),this.textarea.render(),this.capture(!1)}},{key:"getKeyShape",value:function(){return this.textRegion}},{key:"updateModel",value:function(e){I()(L()(n.prototype),"updateModel",this).call(this,e),this.textarea.update()}},{key:"canConnect",value:function(){return!1}},{key:"getTextareaPosition",value:function(e){var t=this.textVerticalAlign,n={x:Math.max((this.textWidth-e.width)/2,4)+this.offsetX,y:0};if(n.y="top"===t?4:"bottom"===t?this.textHeight-e.height:(this.textHeight-e.height)/2,"pyramid"===this.parent.shape)0===this.nth&&(n.y+=this.textHeight/6);else if("segmented pyramid"===this.parent.shape){var r=Math.ceil(Math.sqrt(this.nth+1)),a=r*r-(2*r-1)+1;(this.nth+1-a)%2==0?n.y+=this.textHeight/6:n.y-=this.textHeight/6}else"stage"===this.parent.shape&&0!==this.nth&&(n.x-=12.5);return n.y+=this.offsetY,n}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"getOuterWidth",value:function(){return this.width}},{key:"getTextBox",value:function(){var e=this.x,t=this.y,n=this.textWidth,r=this.textHeight;return{x:e,y:t,width:n,height:r,minX:e,minY:t,maxX:e+n,maxY:t+r}}},{key:"drawTextRegion",value:function(){var e=this.width,t=this.textHeight,n=this.textWidth,r=this.offsetX,a=this.offsetY,i="";switch(this.parent.shape){case"pyramid":i=un(r,a,n,t);break;case"segmented pyramid":var o=Math.ceil(Math.sqrt(this.nth+1)),c=o*o-(2*o-1)+1;i=Jt((this.nth+1-c)%2==0?[["M",this.offsetX+this.width/2,this.y],["L",this.offsetX+this.width,this.y+this.height],["L",this.offsetX,this.y+this.height],["Z"]]:[["M",this.offsetX,this.y],["L",this.offsetX+this.width,this.y],["L",this.offsetX+this.width/2,this.y+this.height],["Z"]]);break;case"stage":var l=r-25;i=Jt([["M",l,0],["L",l+n,0],["L",r+n,t/2],["L",l+n,t],["L",l,t],["L",r,t/2],["Z"]]);break;case"architecture":i=Jt(Wi(this.width,this.height,4,this.x,this.y));break;default:i=""}var s={width:e,height:t,d:i};this.textRegion.update(s)}},{key:"updateCache",value:function(e){var t=this,n=this.cache;(e=e||["html","width","offsetX","offsetY","height","textWidth","textHeight","textVerticalAlign"]).forEach((function(e){var r=t[e];n[e]=d()(r)?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r):r}))}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(e){this.isCacheStale("opacity")&&(e=e||this.opacity,this.graphicGroup.attr({opacity:e}),this.updateCache(["opacity"]))}},{key:"drawFill",value:function(){this.isCacheStale("fill")&&(0===this.nth&&(this.parent.fill=this.fill),this.textRegion.update({fill:this.fill.color}))}},{key:"drawPosition",value:function(){this.drawMatrix(),(this.isCacheStale("textWidth","textHeight","offsetY","offsetX","html","textVerticalAlign")||this.parent.isCacheStale("roughFillStyle"))&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"draw",value:function(){this.createTextRegion(),this.drawPosition(),this.drawOpacity(),this.drawFill(),this.updateCache()}},{key:"destroy",value:function(){bt(this.parent.children,this),I()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return qi(I()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums","text-align":"center",margin:0}}],multiSelectHighlight:!1,textVerticalAlign:"center",penetratedKeys:["html","id","nth","fill","textVerticalAlign"],resizeRotatePoints:[],width:0,height:0,fill:{color:"#fff"},matrix:[1,0,0,0,1,0,0,0,1]})}}]),n}();c()(Hv,"className","DslCell");var Gv=function(e){S()(n,sc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.model,t=this.diagram,r=this.models;e.id=e.id||Object(F.a)(),r.forEach((function(e,t){var n=Object(F.a)();e.id=n,e.nth=t})),e.children=r,t.hooks.decorateAddDslModel.call(e),I()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Gv,"className","AddDsl");var Xv=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"queue",!1),e}return v()(n,[{key:"execute",value:function(){this.queue=!1;var e=this.diagram,t=e.selector.selections[0];t=Cn(t)?t.parent:t,e.emit("opendsleditor",{cell:t}),[t].concat(D()(t.getChildren())).forEach((function(e){return e.hide()})),e.vertexRotateResize.hide()}}]),n}();function Vv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vv(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}c()(Xv,"className","OpenDslEditNote"),c()(Xv,"isModelChange",!1),c()(Xv,"enable",(function(e){var t=e.selector.selections;return 1===t.length&&t.every((function(e){return wn(e)||Cn(e)}))}));var Zv=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"oldHtmls",void 0),c()(E()(e),"oldIds",void 0),c()(E()(e),"newIds",[]),c()(E()(e),"newHtmls",void 0),c()(E()(e),"dslId",void 0),e}return v()(n,[{key:"execute",value:function(){var e=this.dsl,t=this.htmls;this.dslId=e.model.id,this.oldHtmls=e.htmls,this.oldIds=e.children.map((function(e){return e.model.id})),this.newHtmls=t,this.forward()}},{key:"forward",value:function(){this.updateHtml(this.newHtmls,0===this.newIds.length?void 0:this.newIds)}},{key:"backward",value:function(){this.updateHtml(this.oldHtmls,this.oldIds)}},{key:"updateHtml",value:function(e,t){var n,r,a=this;t||(this.newIds=[]);var i=this.diagram,o=i.find(this.dslId),c=null===(n=(r=o.stencil).parse)||void 0===n?void 0:n.call(r,e),l=o.children.map((function(e){return[e.fill,e.textVerticalAlign]})),s=l[l.length-1][0],u=l[l.length-1][1];i.remove(o.model.children.map((function(e){return e.id})));var d=null==c?void 0:c.models.map((function(e,n){var r;return t?r=t[n]:(r=Object(F.a)(),a.newIds.push(r)),Wv(Wv({},e),{},{id:r,nth:n,fill:n<l.length?l[n][0]:s,textVerticalAlign:n<l.length?l[n][1]:u})})),f=d.map((function(e,t){return{parent:o.model.id,nth:t}}));i.update(o,{htmls:e}),i.hooks.decorateAddDslChildModel.call(d[0]),i.add(d,f)}}]),n}();c()(Zv,"className","UpdateDslHtml");var Uv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"dsl",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this,t=this.diagram;this.bind(t,"dblclick",(function(n){var r=t.viewport.invertClient([n.clientX,n.clientY]),a=t.getCell(n.target);if(a&&wn(a)){var i,o=a;e.dsl=o,o.children.forEach((function(e){e.isPointInShape({x:r[0],y:r[1]})&&(i=e)})),o.enter(),i&&t.selector.select(i)}})),this.bind(t,"afterselect",(function(t){var n=t.selections;e.dsl&&n.findIndex((function(t){return t===e.dsl||t.parent===e.dsl}))<0&&e.dsl.exit()}))}}]),n}();var Kv=function(e){S()(n,Kl);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),c()(E()(e),"diagram",void 0),c()(E()(e),"dsl",void 0),e}return v()(n,[{key:"init",value:function(e){this.diagram=e,this._initEvent()}},{key:"_initEvent",value:function(){var e=this.diagram,t=function(e){return"ContentCommand"===(null==e?void 0:e.commandName)&&e.id.every((function(e){return Cn(e)}))},n=function(t,n){var r=t[0].parent;if("architecture"===r.shape){var a=[];r.htmls.forEach((function(e){a.push.apply(a,D()(e))})),t.forEach((function(e,t){a[e.nth]=n[t]}));var i=[],o=0;return r.info.forEach((function(e){for(var t=[],n=0;n<e;n++)t.push(a[o++]);i.push(t)})),void e.update(r,{htmls:i})}var c=r.htmls;t.forEach((function(e,t){c[e.nth]=n[t]})),e.update(r,{htmls:c})};this.bind(e,"aftercommandexecute",(function(e){var r=e.command;t(r)&&n(r.id,r.endHTML)})),this.bind(e,"aftercommandforward",(function(e){var r=e.command;t(r)&&n(r.id,r.endHTML)})),this.bind(e,"aftercommandbackward",(function(e){var r=e.command;t(r)&&n(r.id,r.startHTML)}))}}]),n}(),Qv={Cells:[qv,Hv],Extends:[],Commands:[Gv,Xv,Zv],modes:[{mode:"edit",Behaviours:[Uv,Kv]}]},Jv={roughFillStyle:"hachure",defaultContentStyle:{"font-family":"shouxie"}},$v={default:{roughFillStyle:null},hachure:{roughFillStyle:"hachure"},"cross-hatch":{roughFillStyle:"cross-hatch"},solid:{roughFillStyle:"solid"}};function eg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eg(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ng(e){return Object.values(e).every((function(e){return null===e}))?{roughFillStyle:null,defaultContentStyle:{"font-family":null}}:tg(tg({},Jv),e)}function rg(e,t,n){zo(e,"roughFillStyle",ng(t).roughFillStyle,n)}function ag(e,t,n){var r=ng(t);(Go(e)||Wo(e)||Xo(e)||Vo(e)||Ho(e))&&(zo(e,"roughFillStyle",r.roughFillStyle,n),zo(e,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n))}function ig(e,t,n){var r=ng(t);zo(e,"roughFillStyle",r.roughFillStyle,n),zo(e,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n)}function og(e,t,n){var r=ng(t);zo(e,"roughFillStyle",r.roughFillStyle,n),zo(e,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n)}function cg(e,t,n){e.forEach((function(e){at(e,(function(e){Go(e)||Wo(e)||Xo(e)||Vo(e)||Ho(e)?ag(e,t,n):function(e){return!!e.type&&"pen"===e.type}(e)?rg(e,t,n):qo(e)?ig(e,t,n):function(e){return!!e.type&&"mindmap"===e.type}(e)&&og(e,t,n)}))}))}function lg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var sg=function(){function e(t){m()(this,e),c()(this,"diagram",void 0),c()(this,"name","default"),c()(this,"destroyed",!1),this.diagram=t,this.bindEvent(),this.tabHook()}return v()(e,[{key:"tabHook",value:function(){var e=this,t=this.diagram.hooks;t.forceDecorateImportModels.tap("rough",(function(t){cg(t,$v[e.name],!0)})),t.decorateImportModels.tap("rough",(function(t){cg(t,$v[e.name])})),t.decorateAddPenModel.tap("rough",(function(t){rg(t,$v[e.name])})),t.decorateAddVertexModel.tap("rough",(function(t){ag(t,$v[e.name])})),t.decorateAddLineModel.tap("rough",(function(t){ig(t,$v[e.name])})),t.decorateAddMindmapStemModel.tap("rough",(function(t){og(t,$v[e.name])}))}},{key:"bindEvent",value:function(){var e=this,t=this.diagram;t.on("beforeimport",(function(){var n,r=t.head,a=(null==r||null===(n=r.rough)||void 0===n?void 0:n.name)||"default";a&&e.setRough(a)})),t.on("beforeexporter",(function(){t.head.rough={name:e.name}}))}},{key:"setRough",value:function(e){var t=$v[e];if(t){var n=this.diagram.getCells().filter((function(e){return e.isStem&&(null==e?void 0:e.canRough())})).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lg(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.model.id},ng(t))}));return this.name=e,n}}},{key:"destroy",value:function(){this.destroyed=!0}}]),e}();c()(sg,"className","Rough");var ug=function(e){S()(n,lc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram.theme;this.originColor=e.values.canvasBackgroundColor,this.forward()}},{key:"forward",value:function(){var e=this.diagram,t=this.color;e.theme.setTheme({canvasBackgroundColor:t})}},{key:"backward",value:function(){var e=this.diagram,t=this.originColor;e.theme.setTheme({canvasBackgroundColor:t})}}],[{key:"enable",value:function(){return!0}}]),n}();c()(ug,"className","SetCanvasBackgroundColor");var dg=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.name,r=e.rough,a=r.name,i=r.setRough(t),o=r.name;i&&(this.id=i.map((function(e){return e.id})),this.model=i,this.beforeName=a,this.afterName=o,this.autoSelect=!1,I()(L()(n.prototype),"execute",this).call(this))}},{key:"forward",value:function(){var e=this.diagram,t=this.afterName,r=e.rough;t&&r.setRough(t),I()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this.diagram,t=this.beforeName,r=e.rough;t&&r.setRough(t),I()(L()(n.prototype),"backward",this).call(this)}}]),n}();c()(dg,"className","SetRough");var fg=function(e){S()(n,uc);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"execute",value:function(){var e=this.diagram,t=this.name,r=e.theme,a=s()(r.values),i=r.setTheme(t),o=s()(r.values);i&&(this.id=i.map((function(e){return e.id})),this.model=i,this.beforeValues=a,this.afterValues=o,this.autoSelect=!1,I()(L()(n.prototype),"execute",this).call(this),e.emit("afterThemeChange",t))}},{key:"forward",value:function(){var e=this.diagram,t=this.afterValues,r=e.theme;t&&(r.setTheme(t),e.emit("afterThemeChange",t.themeName)),I()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var e=this.diagram,t=this.beforeValues,r=e.theme;t&&(r.setTheme(t),e.emit("afterThemeChange",t.themeName)),I()(L()(n.prototype),"backward",this).call(this)}}],[{key:"enable",value:function(){return!0}}]),n}();function hg(e,t){var n,r=t.stackFill,a=t.stackStroke,i=t.fontColor;zo(e,"fill.color",r),zo(e,"stroke.color",a),null===(n=e.children)||void 0===n||n.forEach((function(e){zo(e,"defaultContentStyle.color",i)}))}function pg(e,t){var n=t.swimlaneHeadFill,r=t.fontColor;zo(e,"fill.color",n),zo(e,"defaultContentStyle.color",r)}function mg(e,t){var n,r=t.swimlaneStroke;null===(n=e.children)||void 0===n||n.forEach((function(e){pg(e,t)})),zo(e,"stroke.color",r)}function yg(e,t){var n,r=t.dslStroke,a=t.dslFill;null===(n=e.children)||void 0===n||n.forEach((function(e){pg(e,t)})),zo(e,"fill.color",a),zo(e,"stroke.color",r)}c()(fg,"className","SetTheme");var vg=["#A287E1","#6F81DB","#6EC4C4","#DFB85D","#77C386","#E48484","#E482D4","#69B1E4"],gg=["#00B090","#D87C25","#DB699B","#FFC849","#6EC25A","#4C6DC7","#946BB1","#268FAC"],bg=["#00AEBF","#0086FF","#15CA52","#FF8710","#8958E5","#E53385","#F25D4B","#456FF2"],xg=["#F2CF66","#149EC1","#CF8502","#59985A","#216AC7","#00648F","#2D7E75","#787865"],kg=["#6FC07F","#88ABC5","#C5CD29","#6D89C2","#61B4D1","#E89400","#AB8F61","#8C8C92"],wg=["#93AC8F","#D6B235","#439476","#D48344","#C14B41","#9A884F","#CB6743","#6F8E63"],Cg={default:{themeName:"default",swatches:Pg(vg),canvasBackgroundColor:"#FFFFFF",fontColor:"#262626",geometryFill:"#FFFFFF",geometryStroke:"#585A5A",lineStroke:"#585A5A",mindmapRainbowTreeEdgeColors:vg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#EFF0F0",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#FFFFFF",swimlaneStroke:"#585A5A",dslStroke:"#585A5A",dslFill:"#FFFFFF",stackFill:"#FFFFFF",stackStroke:"#585A5A",specialUMLFill:"#FFFFFF",specialUMLStroke:"#585A5A",drawColor:"#585A5A"},dark:{themeName:"dark",swatches:Pg(gg),canvasBackgroundColor:"#141414",fontColor:"#EFF0F0",geometryFill:"#141414",geometryStroke:"#BEC0BF",lineStroke:"#BEC0BF",mindmapRainbowTreeEdgeColors:gg,mindmapSingleTreeEdgeStroke:"#848484",mindmapStemFill:"#262626",mindmapStemStroke:"rgb(255, 255, 255, 0)",mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#141414",swimlaneStroke:"#BEC0BF",dslStroke:"#BEC0BF",dslFill:"#141414",stackFill:"#141414",stackStroke:"#BEC0BF",specialUMLFill:"#141414",specialUMLStroke:"#BEC0BF",drawColor:"#BEC0BF"},colorful_kano:{themeName:"colorful_kano",swatches:Pg(bg),canvasBackgroundColor:"#FFFFFF",fontColor:"#262626",geometryFill:"#FFFFFF",geometryStroke:"#00AEBF",lineStroke:"#00AEBF",mindmapRainbowTreeEdgeColors:bg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#EFF0F0",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#FFFFFF",swimlaneStroke:"#00AEBF",stackFill:"#FFFFFF",dslStroke:"#00AEBF",dslFill:"#FFFFFF",stackStroke:"#00AEBF",specialUMLFill:"#FFFFFF",specialUMLStroke:"#00AEBF",drawColor:"#00AEBF"},van_cogh_starry_sky:{themeName:"van_cogh_starry_sky",swatches:Pg(xg.concat(["#0B1822"])),canvasBackgroundColor:"#0B1822",fontColor:"#EFF0F0",geometryFill:"#0B1822",geometryStroke:"#149EC1",lineStroke:"#149EC1",mindmapRainbowTreeEdgeColors:xg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#262626",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#0B1822",swimlaneStroke:"#149EC1",stackFill:"#0B1822",stackStroke:"#149EC1",dslStroke:"#149EC1",dslFill:"#0B1822",specialUMLFill:"#0B1822",specialUMLStroke:"#149EC1",drawColor:"#149EC1"},iris:{themeName:"iris",swatches:Pg(kg),canvasBackgroundColor:"#F3F3F6",fontColor:"#262626",geometryFill:"#CFDDE8",geometryStroke:"#88ABC5",lineStroke:"#88ABC5",mindmapRainbowTreeEdgeColors:kg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#FFFFFF",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#CFDDE8",swimlaneStroke:"#88ABC5",dslStroke:"#88ABC5",dslFill:"#CFDDE8",stackFill:"#CFDDE8",stackStroke:"#88ABC5",specialUMLFill:"#CFDDE8",specialUMLStroke:"#88ABC5",drawColor:"#88ABC5"},wuxia_qingqiu:{themeName:"wuxia_qingqiu",swatches:Pg(wg),canvasBackgroundColor:"#FBF7EF",fontColor:"#585A5A",geometryFill:"#F7F0D7",geometryStroke:"#D6B235",lineStroke:"#D6B235",mindmapRainbowTreeEdgeColors:wg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#FFFFFF",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#F7F0D7",swimlaneStroke:"#D6B235",dslStroke:"#D6B235",dslFill:"#F7F0D7",stackFill:"#F7F0D7",stackStroke:"#D6B235",specialUMLFill:"#F7F0D7",specialUMLStroke:"#D6B235",drawColor:"#D6B235"}},Ag=["finish"],Og=["start","fork"];function Eg(e){var t=[];return[[[0,0,0,1],[.4,.8,1]],[[255,255,255,1],[.7,.4,.2]]].forEach((function(n){var r=b()(n,2),a=r[0];r[1].forEach((function(n){var r,i,o,c,l,s,u,d,f,h=new Y.a(e).toRgb(),p=(r=h.r,i=h.g,o=h.b,c=n,l=a[0],s=a[1],u=a[2],d=a[3],"rgb(".concat((r*c+l*d*(1-c))/(f=1-(1-c)*(1-d)),", ").concat((i*c+s*d*(1-c))/f,", ").concat((o*c+u*d*(1-c))/f,")"));t.push(p)}))})),t.reverse()}function Pg(e){return[{title:"主题配色",palettes:["transparent",{standard:"#262626",gradient:["#D8DAD9","#BEC0BF","#8A8F8D","#585A5A","#262626","#000000"]},{standard:"#FFFFFF",gradient:["#FFFFFF","#FAFAFA","#F4F5F5","#EFF0F0","#E7E9E8"]}].concat(D()(e.map((function(e){return{standard:e,gradient:Eg(e)}}))))},{title:"默认配色",palettes:[{standard:"#FFFFFF",gradient:["#FFFFFF","#FAFAFA","#F4F5F5","#EFF0F0","#E7E9E8"]},{standard:"#FDE6D3",gradient:["#FDE6D3","#F8B881","#F38F39","#ED740C","#C75C00","#663000"]},{standard:"#F9EFCD",gradient:["#F9EFCD","#F5D480","#F3BB2F","#ECAA04","#C99103","#664900"]},{standard:"#D9DFFC",gradient:["#D9DFFC","#96A7FD","#4861E0","#2F4BDA","#213BC0","#101E60"]},{standard:"#FBDFEF",gradient:["#FBDFEF","#F297CC","#E746A4","#D22D8D","#AE146E","#5C0036"]},{standard:"#CEF5F7",gradient:["#CEF5F7","#5ED3D9","#1DC0C9","#01B2BC","#07787E","#004347"]},{standard:"#262626",gradient:["#D8DAD9","#BEC0BF","#8A8F8D","#585A5A","#262626","#000000"]},{standard:"#DF2A3F",gradient:["#FBE4E7","#F1A2AB","#E4495B","#DF2A3F","#AD1A2B","#70000D"]},{standard:"#FBDE28",gradient:["#FBF5CB","#FCE75A","#FBDE28","#EDCE02","#A58F04","#665800"]},{standard:"#117CEE",gradient:["#D9EAFC","#81BBF8","#2F8EF4","#117CEE","#0C68CA","#00346B"]},{standard:"#601BDE",gradient:["#E6DCF9","#BA9BF2","#7E45E8","#601BDE","#4C16B1","#270070"]},{standard:"#74B602",gradient:["#E8F7CF","#C1E77E","#8CCF17","#74B602","#5C8D07","#2A4200"]}]}]}function Sg(e){var t,n=null==e||null===(t=e.stencil)||void 0===t?void 0:t.name;return Pn(e)&&n&&-1!==Og.indexOf(n)}function jg(e){var t,n=null==e||null===(t=e.stencil)||void 0===t?void 0:t.name;return Pn(e)&&n&&-1!==Ag.indexOf(n)}function Rg(e,t){return e.map((function(e,n){return e+t[n]}))}function Mg(e,t){return e instanceof Array?e.map((function(e){return e*t})):e*t}function Lg(e){return[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16)]}function Bg(e){var t=e.map((function(e){var t=e/255;return 100*(t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)})),n=[(.4124*t[0]+.3576*t[1]+.1805*t[2])/95.047,(.2126*t[0]+.7152*t[1]+.0722*t[2])/100,(.0193*t[0]+.1192*t[1]+.9505*t[2])/108.883].map((function(e){return e>.008856?Math.pow(e,1/3):7.787*e+16/116}));return[116*n[1]-16,500*(n[0]-n[1]),200*(n[1]-n[2])]}function Dg(e,t){return e.reduce((function(e,n,r){return e+Math.pow(n-t[r],2)}),0)}function Ng(e,t){return Math.pow(Math.abs(Math.atan2(e[0],e[1])-Math.atan2(t[0],t[1])),2)}function Ig(e){switch(e){case"lab":return Ng;case"hct":return Dg;default:throw new Error("Unsupported color space")}}function Tg(e,t){var n;return(n=e<26?5:e<51?4:e<63?3:e<74?2:e<85?1:0)<=2&&"dark"===t&&(n=5-n),n>=4&&"light"===t&&(n=5-n),n}function _g(e,t,n,r,a){var i=Ig(a),o=!1,c=n||100,l=e.length,s=e[0].length,u=[],d=[],f=new Array(l).fill(-1),h=new Array(l).fill(0);if("rand"===r)for(var p,m=0;u.length<t;)-1===f[p=Math.floor(Math.random()*l)]&&(u[m++]=e[p],f[p]=0);for("kspp"===r&&u.push.apply(u,D()(function(e,t,n){var r=[],a=e.length,i=Ig(n),o=Math.floor(Math.random()*a);for(r.push(e[o]);r.length<t;){for(var c=[],l=[],s=r.length,u=0,d=0;d<a;d++){for(var f=1/0,h=0;h<s;h++){var p=i(e[d],r[h]);p<=f&&(f=p)}c[d]=f}for(var m=0;m<a;m++)u+=c[m];for(var y=0;y<a;y++)l[y]=c[y]/u;for(var v=Math.random(),g=0,b=-1,x=0;x<a;x++)if((g+=l[x])>=v){b=x;break}r.push(e[b])}return r}(e,t,a)));!o&&c-- >0;){for(var y=void 0,v=void 0,g=void 0,b=0;b<l;b++){y=1/0,v=-1;for(var x=0;x<t;x++)(g=i(e[b],u[x]))<=y&&(y=g,v=x);f[b]=v,h[v]++}for(var k=0;k<t;k++)d[k]=u[k],u[k]=new Array(s).fill(0);for(var w=0;w<l;w++)u[f[w]]=Rg(u[f[w]],e[w]);for(var C=0;C<t;C++)u[C]=Mg(u[C],1/h[C]);o=!0;for(var A=0;A<t;A++)if(i(d[A],u[A])>1e-4){o=!1;break}for(var O=0;O<t;O++)h[O]=0}return{centroids:u,idxs:f}}function Fg(e,t,n,r){if(1===e.length)return 0;var a=function(e,t,n){for(var r=Ig(n),a=0,i=0;i<e.length;i++)a+=r(t,e[i]);return a/e.length}(e,n,r),i=function(e,t,n){for(var r=Ig(n),a=0,i=0;i<e.length;i++)a+=r(t,e[i]);return a/e.length}(t,n,r);return(i-a)/Math.max(a,i)}function zg(e,t,n,r){for(var a=0,i=0,o=function(e){for(var t,n=1/0,r=-1,a=[],i=0;i<e.length;i++){for(var o=0;o<e.length;o++)i!==o&&(t=Dg(e[i],e[o]))<=n&&(n=t,r=o);a[i]=r}return a}(e),c=0;c<e.length;c++){for(var l=[],s=[],u=0;u<t.length;u++)n[u]===c&&l.push(t[u]),n[u]===o[c]&&s.push(t[u]);for(var d=0;d<l.length;d++)a+=Fg(l,s,l[d],r),i++}return a/i}function qg(e,t,n,r,a,i){for(var o,c,l,s=-1/0,u=-1,d=t;d<=n;d++)c=(o=_g(e,d,r,a,i)).idxs,(l=zg(o.centroids,e,c,i))>s&&(s=l,u=d);return u}var Yg=function(){function e(){var t=this;m()(this,e),c()(this,"residualColors",void 0),c()(this,"paletteColors",void 0),c()(this,"colorHues",void 0),c()(this,"residualColorSetting",void 0),c()(this,"paletteColorSetting",void 0),c()(this,"colorHueSetting",void 0);var n={default:{palette:["#A287E1","#6F81DB","#6EC4C4","#DFB85D","#77C386","#E48484","#E482D4","#69B1E4"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#FFFFFF","#585A5A"]},dark:{palette:["#00B090","#D87C25","#DB699B","#FFC849","#6EC25A","#4C6DC7","#946BB1","#268FAC"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#141414","#BEC0BF"]},colorful_kano:{palette:["#00AEBF","#0086FF","#15CA52","#FF8710","#8958E5","#E53385","#F25D4B","#456FF2"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#FFFFFF","#00AEBF"]},van_cogh_starry_sky:{palette:["#F2CF66","#149EC1","#CF8502","#59985A","#216AC7","#00648F","#2D7E75","#787865"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#0B1822","#149EC1"]},iris:{palette:["#6FC07F","#88ABC5","#C5CD29","#6D89C2","#61B4D1","#E89400","#AB8F61","#8C8C92"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#CFDDE8","#88ABC5"]},wuxia_qingqiu:{palette:["#93AC8F","#D6B235","#439476","#D48344","#C14B41","#9A884F","#CB6743","#6F8E63"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#F7F0D7","#D6B235"]}};this.residualColorSetting={},this.paletteColorSetting={},this.colorHueSetting={},this.residualColors=Object.entries(n).reduce((function(e,n,r){var a=b()(n,2),i=a[0],o=a[1].residual.map((function(e){return e.toLowerCase()}));return t.residualColorSetting[i]={idx:0===r?0:e.length,len:o.length},e.concat(o)}),[]),this.paletteColors=Object.entries(n).reduce((function(e,n,r){var a=b()(n,2),i=a[0],o=a[1],c=D()(o.palette.reduce((function(e,t){var n=Eg(t).map((function(e){return Y()(e).toHexString()}));return e.concat.apply(e,D()(n))}),[]));return t.paletteColorSetting[i]={idx:0===r?0:e.length,len:c.length},e.concat(c)}),[]),this.colorHues=Object.entries(n).reduce((function(e,n,r){var a=b()(n,2),i=a[0],o=a[1].palette.map((function(e){return e.toLowerCase()}));return t.colorHueSetting[i]={idx:0===r?0:e.length,len:o.length},e.concat(o)}),[])}return v()(e,[{key:"getResidualColors",value:function(){return this.residualColors}},{key:"getPaletteColors",value:function(){return this.paletteColors}},{key:"getColorHues",value:function(){return this.colorHues}},{key:"isClusterable",value:function(e){var t=e.toLowerCase();return!this.paletteColors.includes(t)&&!this.residualColors.includes(t)}},{key:"isPaletteMapping",value:function(e){return this.paletteColors.includes(e.toLowerCase())}},{key:"indexMapping",value:function(e,t,n){return(e+n)%t}},{key:"adjustLuminanceLevel",value:function(e,t){var n=e;return e<=2&&"dark"===t&&(n=5-e),e>=4&&"light"===t&&(n=5-e),n}},{key:"getResidualColorIndex",value:function(e,t,n){var r=this.residualColorSetting[e].idx,a=this.residualColorSetting[t].idx,i=this.residualColors.indexOf(n);Object.entries(this.residualColorSetting).forEach((function(e){var t=b()(e,2);t[0];var n=t[1];i>=n.idx&&i<n.idx+n.len&&(r=n.idx)}));var o=a>=r?a-r:a+(this.residualColors.length-r);return this.indexMapping(i,this.residualColors.length,o)}},{key:"getPaletteColorIndex",value:function(e,t,n,r){var a=this.paletteColorSetting[e].idx,i=this.paletteColorSetting[t].idx,o=this.paletteColors.indexOf(n);Object.entries(this.paletteColorSetting).forEach((function(e){var t=b()(e,2);t[0];var n=t[1];o>=n.idx&&o<n.idx+n.len&&(a=n.idx)}));var c=i>=a?i-a:i+(this.paletteColors.length-a),l=this.getColorHueIndexByPaletteColorIndex(o),s=this.adjustLuminanceLevel(o%6,r),u=this.getPaletteColorIndexByColorHueIndexAndLuminanceLevel(l,s);return this.indexMapping(u,this.paletteColors.length,c)}},{key:"getColorHueIndexByPaletteColorIndex",value:function(e){return Math.floor(e/6)}},{key:"getPaletteColorIndexByColorHueIndexAndLuminanceLevel",value:function(e,t){return 6*e+t}},{key:"getMappedColors",value:function(e,t,n,r){var a=this,i={};return n.forEach((function(n){i[n]||(a.isPaletteMapping(n)?i[n]=a.paletteColors[a.getPaletteColorIndex(e,t,n,r)]:i[n]=a.residualColors[a.getResidualColorIndex(e,t,n)])})),i}},{key:"getMappedColorsFromClusteredColors",value:function(e,t){for(var n,r,a,i=Object.values(t).map((function(e){return e[0]})),o={},c=Object.values(t).map((function(e){return e[1]})),l=Object.keys(t),s=this.colorHueSetting[e].idx,u=this.colorHueSetting[e].len,d=0;d<i.length;d++)n=i[d]%u+s,a=c[d],r=this.getPaletteColorIndexByColorHueIndexAndLuminanceLevel(n,a),o[l[d]]=this.paletteColors[r];return o}},{key:"destroy",value:function(){this.colorHues=[],this.paletteColors=[],this.residualColors=[]}}]),e}(),Hg=function(){function e(t){m()(this,e),c()(this,"name","default"),c()(this,"values",s()(Cg.default)),c()(this,"themes",Cg),c()(this,"palette",new Yg),c()(this,"destroyed",!1),c()(this,"diagram",void 0),this.diagram=t,this.bindEvent(),this.tapHook()}return v()(e,[{key:"tapHook",value:function(){var e=this,t=this.diagram.hooks;t.decorateAddVertexModel.tap("theme",(function(t){Go(t)?function(e,t){var n=t.geometryFill,r=t.geometryStroke,a=t.fontColor;zo(e,"fill.color",n),zo(e,"stroke.color",r),zo(e,"defaultContentStyle.color",a)}(t,e.values):Wo(t)?function(e,t){zo(e,"defaultContentStyle.color",t.fontColor)}(t,e.values):Xo(t)?hg(t,e.values):Vo(t)?mg(t,e.values):Ho(t)&&yg(t,e.values)})),t.decorateAddStackModel.tap("theme",(function(t){hg(t,e.values)})),t.decorateAddMindmapAbstract.tap("theme",(function(t){!function(e,t){var n=t.mindmapAbstractStroke,r=t.fontColor;zo(e,"treeEdge.stroke",n),zo(e,"border.stroke",n),zo(e,"defaultContentStyle.color",r)}(t,e.values)})),t.decorateAddMindmapStemModel.tap("theme",(function(t){!function(e,t){var n=t.mindmapStemFill,r=t.fontColor;zo(e,"border.fill",n),zo(e,"defaultContentStyle.color",r)}(t,e.values)})),t.decorateAddMindmapCellModel.tap("theme",(function(t){!function(e,t){zo(e,"defaultContentStyle.color",t.fontColor)}(t,e.values)})),t.decorateAddLineModel.tap("theme",(function(t){!function(e,t){var n=t.lineStroke,r=t.fontColor;zo(e,"stroke.color",n),zo(e,"defaultContentStyle.color",r)}(t,e.values)})),t.decorateAddSwimlaneModel.tap("theme",(function(t){mg(t,e.values)})),t.decorateAddSwimlaneChildModel.tap("theme",(function(t){pg(t,e.values)})),t.decorateNonMindmapCellModels.tap("theme",(function(t,n){e.setNonMindmapCells(t,n)})),t.decorateAddDslModel.tap("theme",(function(t){yg(t,e.values)})),t.decorateAddDslChildModel.tap("theme",(function(t){!function(e,t){var n=t.dslFill,r=t.fontColor;zo(e,"fill.color",n),zo(e,"defaultContentStyle.color",r)}(t,e.values)}))}},{key:"bindEvent",value:function(){var e=this,t=this.diagram;t.on("beforeimport",(function(){var n,r=t.head,a=(null==r||null===(n=r.theme)||void 0===n?void 0:n.name)||"default";a&&e.setTheme(a)})),t.on("beforeexporter",(function(){t.head.theme={name:e.name}}))}},{key:"setThemeName",value:function(e){this.values.themeName=e}},{key:"setNonMindmapCells",value:function(e,t){var n=this;if(e.length){var r=this.diagram,a=!1,i=[],o=[];e.forEach((function(e){var t=e.color;o.push(t),n.palette.isClusterable(t)&&(a=!0)}));var l,s=["default","colorful_kano","iris","wuxia_qingqiu"].includes(this.name)?"light":"dark";if(a){var u=function(e,t){for(var n,r=e.map(Lg).map(Bg),a=r.map((function(e){return e[0]})),i=r.map((function(e){return e.slice(1)})),o=Array.from(new Set(e)).length,c={},l=qg(i,1,o,100,"kspp","lab"),s=-1/0,u=0;u<5;u++)c[n=qg(i,1,o,100,"kspp","lab")]?c[n]++:c[n]=1;Object.entries(c).forEach((function(e){var t=b()(e,2),n=t[0],r=t[1];r>s&&(s=r,l=Number(n))}));for(var d=_g(i,l,100,"kspp","lab").idxs.reduce((function(n,r,i){return n[e[i]]=[r,Tg(a[i],t)],n}),{}),f=Object.values(d).map((function(e){return e[0]})),h=0,p={},m=0;m<f.length;m++)p[f[m]]||(p[f[m]]=h,h++);return Object.keys(d).forEach((function(e,t){d[e][0]=p[f[t]]})),d}(o,s);l=this.palette.getMappedColorsFromClusteredColors(this.name,u)}else l=this.palette.getMappedColors(t,this.name,o,s);e.forEach((function(e){var t=e.alpha,n=e.color,r=e.id,a=e.type,o=Y()(l[n]).toRgb(),s=o.r,u=o.g,d=o.b,f="rgba(".concat(s,", ").concat(u,", ").concat(d,", ").concat(t,")");i.push(c()({id:r},a,{color:f}))})),r.update(i.map((function(e){return e.id})),i)}}},{key:"setStackFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return Rn(e)}));return this.values.stackFill=e,t.map((function(t){return{id:t.id,fill:{color:e}}}))}},{key:"setStackStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return Rn(e)}));return this.values.stackStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setDslFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return Cn(e)}));return this.values.dslFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setDslStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return wn(e)}));return this.values.dslStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setSwimlaneHeadFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return jn(e)}));return this.values.swimlaneHeadFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setSwimlaneStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return Sn(e)}));return this.values.swimlaneStroke=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setMindmapAbstractStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return En(e)&&e.isAbstract}));return this.values.mindmapAbstractStroke=e,t.map((function(t){return{id:t.model.id,border:{stroke:e},treeEdge:{stroke:e}}}))}},{key:"setMindmapStemStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return En(e)&&e.isStem}));return this.values.mindmapStemStroke=e,t.map((function(t){return{id:t.model.id,border:{stroke:e}}}))}},{key:"setMindmapStemFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return En(e)&&e.isStem}));return this.values.mindmapStemFill=e,t.map((function(t){return{id:t.model.id,border:{fill:e}}}))}},{key:"setFontColor",value:function(e){var t=this.diagram,n=t.getCells().filter((function(e){return e.textareaElement})),r=n.map((function(e){return e.textareaElement.htmlContainer}));return t.contentEditor.batchEdit(r,"foreColor",e),this.values.fontColor=e,n.map((function(t,n){return{id:t.model.id,html:r[n].innerHTML,defaultContentStyle:{color:e}}}))}},{key:"setGeometryFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return Pn(e)&&!Sg(e)}));return this.values.geometryFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setGeometryStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return Pn(e)&&!jg(e)}));return this.values.geometryStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setLineStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return xn(e)}));return this.values.lineStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"setMindmapRainbowTreeEdgeColors",value:function(e){var t=[];return this.diagram.getCells().filter((function(e){return En(e)&&!e.isStem&&e.stem.rainbow})).forEach((function(n){n.depth===n.stem.depth+1?t.push({id:n.model.id,treeEdge:{stroke:e[n.getNth()%e.length]}}):t.push({id:n.model.id,treeEdge:{stroke:null}})})),this.values.mindmapRainbowTreeEdgeColors=e,t}},{key:"setCanvasBackgroundColor",value:function(e){this.diagram.canvas.css({"background-color":e}),this.values.canvasBackgroundColor=e}},{key:"setSpecialUMLFill",value:function(e){var t=this.diagram.getCells().filter((function(e){return Sg(e)}));return this.values.specialUMLFill=e,t.map((function(t){return{id:t.model.id,fill:{color:e}}}))}},{key:"setSpecialUMLStroke",value:function(e){var t=this.diagram.getCells().filter((function(e){return jg(e)}));return this.values.specialUMLStroke=e,t.map((function(t){return{id:t.model.id,stroke:{color:e}}}))}},{key:"deleteMindmapAttrs",value:function(){return this.diagram.getCells().filter((function(e){return En(e)&&!e.isStem})).map((function(e){return{id:e.model.id,border:{fill:null,stroke:null,"stroke-width":null}}}))}},{key:"setSwatches",value:function(e){this.values.swatches=e}},{key:"setDrawColor",value:function(e){var t=this.diagram;t.settings.freehand&&(t.settings.freehand.stroke=e),this.values.drawColor=e}},{key:"register",value:function(e,t){this.themes[e]=t}},{key:"getTheme",value:function(e){return e=e||this.name,s()(this.themes[e])}},{key:"setTheme",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.themes,i=this.diagram,o=[],c=[];return"string"==typeof e?(Object.keys(a).includes(e)&&(c=s()(a[e])),this.name=e):d()(e)&&(c=e,this.name=e.themeName),Object.keys(c).forEach((function(e){var t=c[e];switch(e){case"mindmapAbstractStroke":var r;"string"==typeof t&&(r=o).push.apply(r,D()(n.setMindmapAbstractStroke(t)));break;case"stackStroke":var a;"string"==typeof t&&(a=o).push.apply(a,D()(n.setStackStroke(t)));break;case"stackFill":var i;"string"==typeof t&&(i=o).push.apply(i,D()(n.setStackFill(t)));break;case"swimlaneHeadFill":var l;"string"==typeof t&&(l=o).push.apply(l,D()(n.setSwimlaneHeadFill(t)));break;case"swimlaneStroke":var s;"string"==typeof t&&(s=o).push.apply(s,D()(n.setSwimlaneStroke(t)));break;case"dslStroke":var u;"string"==typeof t&&(u=o).push.apply(u,D()(n.setDslStroke(t)));break;case"dslFill":var d;"string"==typeof t&&(d=o).push.apply(d,D()(n.setDslFill(t)));break;case"fontColor":var f;"string"==typeof t&&(f=o).push.apply(f,D()(n.setFontColor(t)));break;case"geometryFill":var h;"string"==typeof t&&(h=o).push.apply(h,D()(n.setGeometryFill(t)));break;case"geometryStroke":var p;"string"==typeof t&&(p=o).push.apply(p,D()(n.setGeometryStroke(t)));break;case"lineStroke":var m;"string"==typeof t&&(m=o).push.apply(m,D()(n.setLineStroke(t)));break;case"mindmapStemStroke":var y;"string"==typeof t&&(y=o).push.apply(y,D()(n.setMindmapStemStroke(t)));break;case"mindmapStemFill":var v;"string"==typeof t&&(v=o).push.apply(v,D()(n.setMindmapStemFill(t)));break;case"mindmapRainbowTreeEdgeColors":var g;Array.isArray(t)&&(g=o).push.apply(g,D()(n.setMindmapRainbowTreeEdgeColors(t)));break;case"canvasBackgroundColor":"string"==typeof t&&n.setCanvasBackgroundColor(t);break;case"specialUMLFill":var b;"string"==typeof t&&(b=o).push.apply(b,D()(n.setSpecialUMLFill(t)));break;case"specialUMLStroke":var x;"string"==typeof t&&(x=o).push.apply(x,D()(n.setSpecialUMLStroke(t)));break;case"swatches":t&&n.setSwatches(t);break;case"drawColor":"string"==typeof t&&n.setDrawColor(t);break;case"themeName":"string"==typeof t&&n.setThemeName(t)}})),(t=o).push.apply(t,D()(this.deleteMindmapAttrs())),o=o.filter((function(e){return"string"==typeof e.id})),o=function(e){var t={};return e.forEach((function(e){var n=e.id;if(n){var r=t[n];r?te()(r,e):t[n]=s()(e)}})),Object.keys(t).map((function(e){return t[e]}))}(o),r&&i.update(o.map((function(e){return e.id})),o),o}},{key:"destroy",value:function(){this.palette.destroy(),this.destroyed=!0}}]),e}();c()(Hg,"className","Theme");var Gg=function(){var e={};return Array.from(arguments).forEach((function(t){Object.keys(t).forEach((function(n){var r=t[n];d()(r)?e[n]?Object.assign(e[n],r):e[n]=Object.assign({},r):Array.isArray(r)?e[n]?e[n]=[].concat(e[n],r):e[n]=[].concat(r):e[n]=r}))})),e}({Extends:[Hg,sg],Commands:[fg,dg,ug]},yp,zy,Ky,Dv,Yp,Qv),Xg=Object.freeze({__proto__:null,Board:Gg});rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-toolbar-dropdown .ant-btn:after {\n  display: none;\n}\n.lake-diagram-toolbar-dropdown .ant-btn.ant-dropdown-trigger:hover {\n  background: var(--yq-border-primary);\n  border-radius: 2px;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button {\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  display: flex;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: 30px;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon:before {\n  content: '';\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown-menu .lake-icon {\n  font-size: 16px;\n}\n");var Vg=["mode"];function Wg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wg(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ug(e){return e.overlay?e.overlay:Ie.a.createElement(Ve.a,{onClick:e.onSelect,className:ze()("lake-diagram-toolbar-dropdown-menu",e.menuClassName)},e.data.map((function(e){return Ie.a.createElement(Ve.a.Item,{key:e.key},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}))})))}function Kg(e){var t=e.command,n=e.name;return Ie.a.createElement("div",{className:"lake-diagram-toolbar-command lake-diagram-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ug(Zg(Zg({},e),{},{onSelect:function(n){var r=n.key;e.onSelect?e.onSelect({key:r}):e.execCommand(t,{key:r})}}))},Ie.a.createElement(Ye.a,{"data-testid":n},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}))))}function Qg(e){var t=e.name,n=e.command,r=e.defaultKey,a=e.data,i=Object(Ne.useState)(r),o=b()(i,2),c=o[0],l=o[1],s=a.find((function(e){return e.key===c}));return Ie.a.createElement("div",{className:"lake-diagram-toolbar-command lake-diagram-toolbar-dropdown"},Ie.a.createElement(Xe.a.Button,{onClick:function(){e.onClick?e.onClick({key:c}):e.execCommand(n,{key:c})},overlay:Ug(Zg(Zg({},e),{},{onSelect:function(t){var n=t.key;l(n),e.onSelect&&e.onSelect({key:n})}})),icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-dropdown-arrow"}),"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon||s.icon)})))}function Jg(e){var t=e.mode,n=Ge()(e,Vg);return"button"===t?Ie.a.createElement(Qg,n):Ie.a.createElement(Kg,n)}function $g(e){var t=e.name,n=e.icon,r=e.accept,a=e.disabled,i=e.title,o=e.onChange,c=Object(Ne.useRef)();return Ie.a.createElement("div",{className:"lake-diagram-toolbar-command","data-testid":t},Ie.a.createElement(qe.a,{disabled:a||!i,placement:"bottom",title:Ie.a.createElement("div",{className:"lake-diagram-toolbar-tooltip"},i&&Ie.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-title"},i))},Ie.a.createElement(Ye.a,{className:"lake-diagram-toolbar-upload",onClick:function(){return c.current.click()},disabled:a},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),Ie.a.createElement("input",{type:"file",accept:r,onChange:o,ref:c}))))}function eb(e){var t=e.name,n=e.title,r=e.hotkey,a=e.icon,i=e.label,o=e.command,c=e.disabled,l=e.active,s=Object.keys(e).reduce((function(t,n){return n.startsWith("data-")&&(t[n]=e[n]),t}),{});return Ie.a.createElement("div",De()({className:"lake-diagram-toolbar-command","data-testid":t},s),Ie.a.createElement(qe.a,{disabled:c||!(n||r),placement:"bottom",title:Ie.a.createElement("div",{className:"lake-diagram-toolbar-tooltip"},n&&Ie.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-title"},n),r&&Ie.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-hotkey"},r))},Ie.a.createElement(Ye.a,{onClick:function(t){t.stopPropagation(),e.onClick?e.onClick():e.execCommand(o)},disabled:c,className:ze()({"lake-button-active":l}),"data-testid":"".concat(t,"-button")},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(a)}),i&&Ie.a.createElement("span",{className:"lake-diagram-toolbar-command-label"},i))))}function tb(e){switch(e.type){case"separator":return Ie.a.createElement("div",{className:"lake-diagram-toolbar-separator"});case"dropdown":return Ie.a.createElement(Jg,e);case"upload":return Ie.a.createElement($g,e);default:return Ie.a.createElement(eb,e)}}function nb(e){var t=e.commands,n=e.extra,r=e.execCommand;return Ie.a.createElement("div",{className:ze()("lake-diagram-toolbar",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-toolbar-title"},e.title),Ie.a.createElement("div",{className:"lake-diagram-toolbar-body"},t.map((function(e,t){return Ie.a.createElement(tb,De()({key:"".concat(e.name||e.type,"-").concat(t),execCommand:r},e))}))),Ie.a.createElement("div",{className:"lake-diagram-toolbar-extra"},n))}Ug.propTypes={data:_e.a.array,overlay:_e.a.node,onSelect:_e.a.func,menuClassName:_e.a.string},Kg.propTypes={command:_e.a.string,name:_e.a.string,icon:_e.a.string,onSelect:_e.a.func,execCommand:_e.a.func},Qg.propTypes={command:_e.a.string,name:_e.a.string,defaultKey:_e.a.string,title:_e.a.string,data:_e.a.array,icon:_e.a.string,onClick:_e.a.func,onSelect:_e.a.func,execCommand:_e.a.func},Jg.propTypes={mode:_e.a.string},rt(".lake-diagram-toolbar-upload {\n  position: relative;\n}\n.lake-diagram-toolbar-upload input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display: none;\n}\n"),$g.propTypes={name:_e.a.string,icon:_e.a.string,accept:_e.a.string,disabled:_e.a.bool,title:_e.a.string,onChange:_e.a.func},eb.defaultProps={disabled:!0},eb.propTypes={disabled:_e.a.bool,name:_e.a.string,title:_e.a.string,hotkey:_e.a.string,type:_e.a.string,icon:_e.a.string,label:_e.a.string,command:_e.a.string,onClick:_e.a.func,execCommand:_e.a.func,active:_e.a.bool},tb.propTypes={type:_e.a.string},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-toolbar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 38px;\n  border: solid var(--yq-border-primary);\n  border-width: 1px 0;\n  padding-left: 16px;\n  padding-right: 12px;\n  background: var(--yq-bg-secondary);\n}\n.lake-diagram-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n.lake-diagram-toolbar-separator {\n  width: 1px;\n  height: 100%;\n  margin: 0 4px;\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-command .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 8px;\n  height: 32px;\n  min-width: 32px;\n  margin-left: 4px;\n  margin-right: 4px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-toolbar-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-toolbar-command .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-toolbar-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-toolbar-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-toolbar-command .ant-btn .lake-icon {\n  margin-right: 0;\n  font-size: 16px;\n}\n.lake-diagram-toolbar-command .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-toolbar-command-label {\n  display: inline-block;\n  margin-left: 0.25em;\n}\n.lake-diagram-toolbar-tooltip {\n  text-align: center;\n}\n.lake-diagram-toolbar-tooltip-hotkey {\n  font-size: 12px;\n  color: var(--yq-text-caption);\n  margin-top: 4px;\n}\n.lake-diagram-toolbar-tooltip-hotkey:first-child {\n  margin-top: 0;\n}\n"),nb.defaultProps={commands:[],toggleProperties:function(){},domContainer:null},nb.propTypes={className:_e.a.string,commands:_e.a.array,domContainer:_e.a.object,title:_e.a.node,extra:_e.a.node,execCommand:_e.a.func},nb.Control=tb,rt("/* stylelint-disable */\n.lake-diagram-link-editor {\n  max-width: 398px;\n  display: inline-block;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  box-shadow: rgba(216, 218, 217, 0.5) 0px 1px 3px;\n  background: var(--yq-bg-primary);\n}\n.lake-diagram-link-editor .lake-link-invalid-link {\n  color: var(--yq-red-6);\n}\n.lake-diagram-link-editor p {\n  margin-top: 0;\n  margin-bottom: 14px;\n}\n.lake-diagram-link-editor .lake-diagram-link-editor-slash {\n  margin: 0 2px;\n}\n.lake-diagram-link-editor .lake-diagram-link-editor-slash {\n  width: 1px;\n  height: 14px;\n  border-left: 1px solid var(--yq-border-primary);\n  margin: 0 1px;\n  margin-top: 5px;\n  vertical-align: top;\n}\n.lake-diagram-link-editor .lake-icon {\n  color: #8590a6;\n  font-size: 16px;\n}\n.lake-diagram-link-editor-preview {\n  line-height: 16px;\n  padding: 6px 8px;\n  vertical-align: middle;\n  white-space: nowrap;\n}\n.lake-diagram-link-editor-preview * {\n  display: inline-block;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-button {\n  color: var(--yq-text-body);\n  margin: 0px 0px 0px 8px;\n  padding: 4px;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-button:hover {\n  background: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-container {\n  color: var(--yq-blue-5);\n  height: 16px;\n  padding: 0 6px;\n  min-width: 180px;\n  max-width: 292px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-decoration: none;\n  line-height: 12px;\n  font-size: 14px;\n  letter-spacing: 1.2px;\n  vertical-align: middle;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-empty {\n  height: 16px;\n  padding: 0 6px;\n  min-width: 146px;\n  max-width: 292px;\n  line-height: 20px;\n  font-size: 14px;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-container:hover {\n  cursor: pointer;\n}\n.lake-diagram-link-editor-edit {\n  width: 365px;\n  padding: 16px 12px;\n  padding-bottom: 4px;\n}\n");var rb={"zh-cn":{text:"文本",link:"链接",editLink:"编辑链接",addDescription:"添加描述",linkAddress:"链接地址",deleteLink:"删除链接",confirm:"确定",pleaseInputLink:"请输入链接",emptyLink:"空链接",pleaseEnterCorrectLink:"请输入正确的链接",selectedContent:"多行文字被选中，暂不支持修改文本"},en:{text:"Text",link:"Link",editLink:"Edit link",addDescription:"Add a description",linkAddress:"Link address",deleteLink:"Delete link",confirm:"Confirm",pleaseInputLink:"Please input link address",emptyLink:"Empty link",pleaseEnterCorrectLink:"Please enter the correct link",selectedContent:"Selected in the document"}};rb["en-us"]=rb.en;var ab=function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(e){var r;m()(this,n);var a=(r=t.call(this,e)).props,i=a.lang,o=a.target;return r.locale=rb[i],r.nativeEvents=[],r.rect=o.getBoundingClientRect(),r.link=o.getAttribute("href"),r.isMultiLink=o.length>1,r.state={invalidLink:r.isInvalidLink(r.link)},r.preventScrollCancel=!1,r}return v()(n,[{key:"adjustPosition",value:function(){var e=this.container,t=this.props.target,n=e.getBoundingClientRect(),r=e.offsetParent.getBoundingClientRect(),a=t.getBoundingClientRect(),i=a.bottom+4-r.top,o=a.left-r.left;r.top+i+n.height>window.innerHeight-20&&(i-=n.height-4),n.right>window.innerWidth-20?o=window.innerWidth-n.width-4:o<20&&(o=20),e.style.top="".concat(i,"px"),e.style.left="".concat(o,"px")}},{key:"componentDidMount",value:function(){this.bindNativeEvents(),this.adjustPosition()}},{key:"componentDidUpdate",value:function(){this.adjustPosition()}},{key:"componentWillUnmount",value:function(){this.removeNativeEvents()}},{key:"bindNativeEvents",value:function(){var e=this,t=this.container,n=!1;this.addNativeEvent(window,"scroll",(function(t){!0!==e.preventScrollCancel?t.target.className&&-1!==t.target.className.indexOf("lake-link")||e.cancel():t.preventDefault()}),!0),this.addNativeEvent(window,"resize",(function(){e.cancel()}),!0),this.addNativeEvent(window,"mousedown",(function(e){var r=e.target;t.contains(r)||(n=!0)}),!0),this.addNativeEvent(window,"mouseup",(function(r){var a=r.target;n&&!t.contains(a)&&e.cancel(),n=!1}))}},{key:"cancel",value:function(){var e=this.props,t=e.onCancel,n=e.target;t({link:n&&n.getAttribute("href")})}},{key:"addNativeEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,n,r),this.nativeEvents.push({dom:e,name:t,callback:n,useCapture:r})}},{key:"removeNativeEvents",value:function(){this.nativeEvents.forEach((function(e){var t=e.dom,n=e.name,r=e.callback,a=e.useCapture;t.removeEventListener(n,r,a)})),this.nativeEvents=[]}},{key:"confirm",value:function(){var e=this.props.onConfirm,t=this.state.invalidLink,n=this.getText(),r=this.getLink();t||e(n,r)}},{key:"renderPreview",value:function(){var e,t=this.props,n=t.onDeleteLink,r=t.shouldTargetBlank,a=t.onSwitchToEdit,i=t.dataset,o=this.getLink(),c=this.locale,l=o||c.emptyLink;return e=o?r(o)?Ie.a.createElement("a",{className:"lake-diagram-link-editor-link-container",href:ml(o),target:"_blank"},l):Ie.a.createElement("a",{className:"lake-diagram-link-editor-link-container",href:ml(o)},l):Ie.a.createElement("span",{className:"lake-diagram-link-editor-link-empty"},l),Ie.a.createElement("div",{className:"lake-diagram-link-editor lake-diagram-link-editor-preview"},Ie.a.createElement("span",{className:"lake-icon lake-icon-link"}),e,Ie.a.createElement("span",{className:"lake-diagram-link-editor-slash"}),Ie.a.createElement(qe.a,{title:c.editLink},Ie.a.createElement("a",De()({},i,{className:"lake-icon lake-icon-edit lake-diagram-link-editor-button",onClick:function(){a()}}))),Ie.a.createElement(qe.a,{title:c.deleteLink},Ie.a.createElement("a",De()({},i,{className:"lake-icon lake-icon-unlink lake-diagram-link-editor-button",onClick:n}))))}},{key:"isInvalidLink",value:function(e){return function(e){return!e||e&&!e.match(/^[\x00-\x7F]/)||e.startsWith("javascript:")}(e)}},{key:"renderEditorContent",value:function(){var e=this,t=this.props.dataset,n=this.state.invalidLink,r=this.getText(),a=this.getLink(),i=this.locale;return Ie.a.createElement("div",{className:"lake-diagram-link-editor lake-diagram-link-editor-edit",onKeyDown:function(t){var n=t.key,r=e.state.invalidLink;"Enter"!==n||r||e.confirm(),"Escape"===n&&e.cancel()}},Ie.a.createElement("p",null,i.text),Ie.a.createElement("p",null,Ie.a.createElement(We.a,{className:"lake-link-text-input",defaultValue:this.isMultiLink?i.selectedContent:r,ref:function(t){e.textInputDom=t},placeholder:i.addDescription,disabled:this.isMultiLink,onChange:function(t){e.text=t.target.value}})),Ie.a.createElement("p",null,i.link),Ie.a.createElement("p",null,Ie.a.createElement(We.a,{className:"lake-link-link-input",defaultValue:a,ref:function(t){e.preventScrollCancel=!0,t&&t.focus(),e.linkInputDom=t,setTimeout((function(){e.preventScrollCancel=!1}),32)},placeholder:i.linkAddress,onChange:function(t){e.link=t.target.value,e.setState({invalidLink:e.isInvalidLink(e.link)})}})),n&&""!==a?Ie.a.createElement("p",{className:"lake-link-invalid-link"},i.pleaseEnterCorrectLink):"",Ie.a.createElement("p",null,Ie.a.createElement(Ye.a,De()({},t,{className:"lake-link-confirm-button",onClick:function(){e.confirm()},disabled:!this.link||n}),i.confirm)))}},{key:"getLink",value:function(){var e=this.props.getLink;return this.link&&e(this.link)||""}},{key:"getText",value:function(){var e=this.props.target;return this.isMultiLink?"":this.text||e.textContent}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.type,a=n.className,i=n.dataset;return e="edit"===r?this.renderEditorContent():this.renderPreview(),Ie.a.createElement("div",De()({},i,{className:a,ref:function(e){t.container=e},style:{top:"0px",position:"absolute",zIndex:"1400"}}),e)}}]),n}(Ie.a.Component);function ib(e){var t=window.location,n=(t.origin+t.pathname.replace("/edit","")).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp("^".concat(n,"#"));return e=e.replace(r,"#").trim(),/^(\w+\.)+\w+(\/|$)/.test(e)&&(e="https://"+e),e}function ob(e){var t=e.diagram,n=Object(Ne.useState)(null),r=b()(n,2),a=r[0],i=r[1],o=Object(Ne.useState)("preview"),c=b()(o,2),l=c[0],s=c[1];return Object(Ne.useEffect)((function(){function e(e,t){i(e),s(t)}function n(t){var n=t.result,r=t.target,a=t.name;n&&"createLink"===a&&e(r,"edit")}function r(){i(null)}var a=ye()((function(){var n=t.contentEditor.getRange();if(n){var r=t.contentEditor.closest(n.commonAncestorContainer,"a");r?e(r,"preview"):i(null)}}),16);return t.contentEditor.on("execcommand",n),t.contentEditor.on("endedit",r),t.contentEditor.on("selectionchange",a),function(){t.contentEditor.off("execcommand",n),t.contentEditor.off("endedit",r),t.contentEditor.off("selectionchange",a)}}),[t]),a?Ie.a.createElement(ab,{dataset:{"data-lake_prevent_click_unselect":!0},target:a,type:l,lang:Fn.locale,getLink:ib,onConfirm:function(e,n){a.textContent=e,a.setAttribute("href",n),setTimeout((function(){if(a&&t.viewportContainer.contains(a)){var e=window.getSelection(),n=document.createRange();n.selectNode(a),n.collapse(),e.removeAllRanges(),e.addRange(n)}}),16),i(null)},onSwitchToEdit:function(){s("edit")},onCancel:function(){i(null)},onDeleteLink:function(){a.removeAttribute("href"),function(e){for(var t=e.firstChild;t;){var n=t.nextSibling;e.parentNode.insertBefore(t,e),t=n}e.parentNode.removeChild(e)}(a),i(null)},shouldTargetBlank:function(){return!0}}):Ie.a.createElement("div",null)}ab.defaultProps={dataset:{},className:null,type:"preview",lang:"zh-cn",onDeleteLink:function(){},onSwitchToEdit:function(){},onConfirm:function(){},onCancel:function(){},shouldTargetBlank:function(){},getLink:function(e){return e}},ab.propTypes={dataset:_e.a.object,className:_e.a.string,target:_e.a.object,type:_e.a.string,lang:_e.a.string,onDeleteLink:_e.a.func,onSwitchToEdit:_e.a.func,onConfirm:_e.a.func,onCancel:_e.a.func,shouldTargetBlank:_e.a.func,getLink:_e.a.func},rt(""),ob.defaultProps={diagram:null},ob.propTypes={diagram:_e.a.object.isRequired};var cb=Hf(),lb=function(e){var t=e.shapeSelect,n=e.groups,r=e.basicWithSwimlane,a=e.diagram;e.popoverVisible;var i=e.pen,o=Object(Ne.useRef)(),c=Object(Ne.useState)(""),l=b()(c,2),s=l[0];return l[1],t||(t=Object(Ne.useMemo)((function(){return new ih({groups:n,basicWithSwimlane:r})}),D()(n))),Object(Ne.useEffect)((function(){var n,r=cb?8.5:0,c=new da({href:cb?"https://gw.alipayobjects.com/zos/bmw-prod/d9d2b1a7-fe9b-41f9-8450-a9aacab3b014.svg":"https://gw.alipayobjects.com/zos/bmw-prod/ab304cc5-55d8-4bfc-a551-b884d0b88824.svg",matrix:[1,0,0,0,1,0,r,r,1]}),l=new va({x:0,y:0,width:32,height:32,rx:4,fill:cb?"#141414":"#fff"}),s=new Zr({matrix:[1,0,0,0,1,0,172,4,1]});s.add(new Ca({title:"矢量绘图"})),s.add(l),s.add(c),s.dataset({test_id:"pen"}),s.css({cursor:"pointer"});var u=function(e){l.attr({fill:Xf("hover")})},d=function(e){l.attr({fill:cb?"#141414":"#fff"})},f=function(t){var n,r;a.penDrawInteract.clearCache(),null==a||null===(n=a.interaction)||void 0===n||n.changeMode("pen"),null===(r=e.hide)||void 0===r||r.call(e)};s.on("mouseover",u),s.on("mouseleave",d),s.on("click",f),i&&t.add(s),o.current.appendChild(t.rendererElement),o.current.setAttribute("height",t.height),null===(n=o.current)||void 0===n||n.setAttribute("width",t.width);var h=function(e){var t,n=e.height;null===(t=o.current)||void 0===t||t.setAttribute("height",n)};return t.on("update:height",h),function(){t.off("update:height",h),s.off("mouseover",u),s.off("mouseleave",d),s.off("click",f),s.destroy()}}),[t]),Object(Ne.useEffect)((function(){function n(t){var n=t.shape,r=t.group,a=t.category,i=t.attr;e.onSelect({key:n,group:r,category:a,attr:i})}return t.on("shape:select",n),function(){t.off("shape:select",n)}}),[e.onSelect]),Ie.a.createElement("svg",{viewBox:s,className:ze()(e.className,"lake-prevent-card-activated"),"data-lake_prevent_click_unselect":"true",ref:o,onClick:function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)},"data-testid":"shape-overlay"})};lb.propTypes={groups:_e.a.array,onSelect:_e.a.func,onClick:_e.a.func,className:_e.a.string,shapeSelect:_e.a.object,basicWithSwimlane:_e.a.bool,diagram:_e.a.object,pen:_e.a.bool,popoverVisible:_e.a.bool},rt('.lake-diagram-toolbar-shape-select-container {\n  max-height: 272px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n  max-width: 220px;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs {\n  height: 40px;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-tab-btn {\n  font-weight: 400;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-tab .ant-tabs-tab-active {\n  font-weight: 500;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-nav {\n  padding-left: 12px !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-operations,\n.lake-diagram-toolbar-shape-select-container .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-operations {\n  width: auto !important;\n  padding: 0 !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-more,\n.lake-diagram-toolbar-shape-select-container .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-more {\n  padding: 0;\n  margin-left: 8px !important;\n  margin-right: 8px !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-ink-bar {\n  background: var(--yq-yuque-grey-9);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after {\n  opacity: 0;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before {\n  opacity: 0;\n}\n.lake-diagram-toolbar-shape-container {\n  overflow: scroll;\n  display: flex;\n  justify-content: center;\n  max-height: 218px;\n}\n.lake-diagram-toolbar-shape-container::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-diagram-toolbar-shape-container::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n[data-kumuhana="pouli"] .lake-diagram-toolbar-shape-container::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.3);\n}\n');var sb=["groups","popoverVisible"];function ub(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var db=Ze.a.TabPane;function fb(e){var t=e.groups,n=e.popoverVisible,r=Ge()(e,sb),a=Object(Ne.useRef)(),i=Object(Ne.useMemo)((function(){var e=new ih(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ub(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ub(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({groups:t,containerHeight:218,backgroundColor:"transparent"},r)),n=t.map((function(t){return e.getOffset(t)}));return{shapeSelect:e,offsets:n}}),D()(t)),o=i.shapeSelect,l=i.offsets,s=Object(Ne.useState)(t[0]),u=b()(s,2),d=u[0],f=u[1],h=Object(Ne.useRef)();return Object(Ne.useEffect)((function(){var e,n=pe()((function(e){for(var n=e.target.scrollTop,r=l.length-1;r>=0&&!(n>l[r]-32);r--);f((function(e){return e!==t[r]?t[r]:e}))}),16);return null===(e=a.current)||void 0===e||e.addEventListener("scroll",n),function(){var e;return null===(e=a.current)||void 0===e?void 0:e.removeEventListener("scroll",n)}}),[]),Object(Ne.useEffect)((function(){var e;Array.from(null===(e=h.current)||void 0===e?void 0:e.querySelectorAll(".ant-tabs-tab")).forEach((function(e,t){0!==t&&(e.style.marginLeft="16px")}))}),[]),Ie.a.createElement("div",{className:"lake-diagram-toolbar-shape-select-container",ref:h},Ie.a.createElement(Ze.a,{tabBarStyle:{width:"100%",padding:"0 8px",height:"40px",color:"#8c8c8c",fontSize:"14px"},animated:{inkBar:!0,tabPane:!0},onChange:function(e){var t;return null===(t=a.current)||void 0===t?void 0:t.scrollTo(0,o.getOffset(e))},activeKey:d,onTabClick:function(e){f(e)}},t.map((function(e){return Ie.a.createElement(db,{tab:ah[e].title,key:e})}))),Ie.a.createElement("div",{ref:a,className:"lake-diagram-toolbar-shape-container"},Ie.a.createElement(lb,De()({groups:t,shapeSelect:o,popoverVisible:n},r))))}fb.propTypes={groups:_e.a.array,popoverVisible:_e.a.bool},rt("/* stylelint-disable */\n.lake-zoom-tool {\n  padding: 0 5px;\n  width: auto;\n  height: 25px;\n  border: 1px solid var(--yq-border-primary);\n  box-shadow: 0px 2px 4px rgba(231, 233, 232, 0.5);\n  color: var(--yq-yuque-grey-3);\n  background: var(--yq-yuque-grey-6);\n  position: absolute;\n  top: 16px;\n  right: 28px;\n  border-radius: 6px;\n  font-size: 14px;\n  line-height: 24px;\n  letter-spacing: 0.05em;\n  outline-style: none;\n  word-wrap: break-word;\n}\n.lake-zoom-tool .ant-dropdown {\n  left: -2.5px;\n}\n.lake-zoom-tool ul {\n  list-style-type: none;\n  margin: 0;\n}\n.lake-zoom-tool ul.lake-zoom-tool-menu {\n  width: 86px;\n  background: var(--yq-yuque-grey-8);\n}\n.lake-zoom-tool ul.lake-zoom-tool-menu li {\n  font-size: 12px;\n  margin-left: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n.lake-zoom-tool .ant-dropdown-menu-item:hover {\n  background: var(--yq-yuque-grey-9);\n}\n.lake-zoom-tool .ant-dropdown-menu-item {\n  color: var(--yq-white);\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-zoom-tool .lake-icon {\n  margin: 3.5px;\n  margin-top: 2px;\n  font-size: 14px;\n  width: 14px;\n  height: 14px;\n}\n.lake-zoom-tool .lake-icon:hover {\n  cursor: pointer;\n}\n.lake-zoom-tool .lake-zoom-tool-precent {\n  vertical-align: top;\n  line-height: 23px;\n}\n.lake-zoom-tool span {\n  display: inline-block;\n  padding: 0;\n  font-size: 12px;\n  height: 26px;\n  text-align: center;\n  user-select: none;\n}\n.lake-zoom-tool .lake-zoom-tool-dropdown:hover {\n  cursor: pointer;\n}\n.lake-zoom-tool:hover {\n  background: var(--yq-yuque-grey-8);\n}\n.lake-card-block-max .lake-zoom-tool {\n  margin: 8px;\n}\n");var hb=function(e){S()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"_setZoom",value:function(e){var t=this.props,n=t.onChange,r=t.minZoom,a=t.maxZoom;e<r&&(e=r),e>a&&(e=a),n(e)}},{key:"_clickZoomIn",value:function(){var e=this.props,t=e.zoomStep,n=e.zoom;this._setZoom(n+t)}},{key:"_clickZoomOut",value:function(){var e=this.props,t=e.zoomStep,n=e.zoom;this._setZoom(n-t)}},{key:"render",value:function(){var e=this,t=this.props.zoom,n=Ie.a.createElement(Ve.a,{className:"lake-zoom-tool-menu",onClick:function(t){var n=t.item;e._setZoom(n.props.value)}},Ie.a.createElement(Ve.a.Item,{value:"resetView"},zn("回到中心")),Ie.a.createElement(Ve.a.Item,{value:.2},"20%"),Ie.a.createElement(Ve.a.Item,{value:.5},"50%"),Ie.a.createElement(Ve.a.Item,{value:1},"100%"),Ie.a.createElement(Ve.a.Item,{value:2},"200%"),Ie.a.createElement(Ve.a.Item,{value:4},"400%"),Ie.a.createElement(Ve.a.Item,{value:"autoFit"},zn("适应画布")));return Ie.a.createElement("div",{className:"lake-zoom-tool",ref:function(t){e.zoomToolDOM=t}},Ie.a.createElement("span",{className:"lake-icon lake-icon-zoom-out",onClick:this._clickZoomOut.bind(this)}),Ie.a.createElement(Xe.a,{className:"lake-zoom-tool-dropdown",overlay:n,placement:"bottomCenter",trigger:["click"],getPopupContainer:function(){return e.zoomToolDOM}},Ie.a.createElement("span",{className:"lake-zoom-tool-precent"},Math.round(100*t)+"%")),Ie.a.createElement("span",{className:"lake-icon lake-icon-zoom-in",onClick:this._clickZoomIn.bind(this)}))}}]),n}(Ie.a.Component);function pb(e){var t=e.diagram,n=Object(Ne.useState)(null),r=b()(n,2),a=r[0],i=r[1];return Object(Ne.useEffect)((function(){if(t){i(t.viewport.zoom);var e=ye()((function(){i(t.viewport.zoom)}),32);return t.on("afterviewportchange",e),function(){t.off("afterviewportchange",e)}}}),[a,t]),t?Ie.a.createElement(hb,{zoom:a,onChange:function(e){"autoFit"===e?t.viewport.autoFit():"resetView"===e?t.viewport.focusFirstRoot():t.viewport.setViewport(e)}}):Ie.a.createElement("div",null)}hb.defaultProps={zoom:1,onChange:function(){},minZoom:.2,maxZoom:4,zoomStep:.2},hb.propTypes={zoom:_e.a.number,onChange:_e.a.func,minZoom:_e.a.number,maxZoom:_e.a.number,zoomStep:_e.a.number},pb.propTypes={diagram:_e.a.object};var mb=function(e){return Ne.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-help-search",e.className].filter(Boolean).join(" ")}),Ne.createElement("path",{d:"M114 20c51.362 0 93 41.638 93 93 0 21.782-7.489 41.816-20.032 57.666l45.82 46.277c4.275 4.317 4.24 11.282-.077 15.556-4.317 4.275-11.281 4.24-15.556-.077l-45.774-46.23C155.576 198.602 135.652 206 114 206c-51.362 0-93-41.638-93-93s41.638-93 93-93Zm0 20c-40.317 0-73 32.683-73 73s32.683 73 73 73 73-32.683 73-73-32.683-73-73-73Z",fill:"currentColor",fillRule:"nonzero"}))},yb=function(e){return Ne.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{className:["larkui-icon","larkui-icon-review-arrow-down",e.className].filter(Boolean).join(" ")}),Ne.createElement("defs",null,Ne.createElement("path",{id:"3742204692a",d:"M0 0h256v256H0z"})),Ne.createElement("g",{fill:"none",fillRule:"evenodd"},Ne.createElement("mask",{id:"3742204692b",fill:"#fff"},Ne.createElement("use",{xlinkHref:"#3742204692a"})),Ne.createElement("path",{d:"M181.1 118.925 135 165.096a9.889 9.889 0 0 1-14 0l-46.1-46.17c-3.866-3.873-3.866-10.15 0-14.022a9.892 9.892 0 0 1 7-2.904h92.2c5.468 0 9.9 4.439 9.9 9.915a9.922 9.922 0 0 1-2.9 7.01Z",fill:"currentColor",fillRule:"nonzero",mask:"url(#3742204692b)"})))},vb=function(e){return Ne.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},e,{className:["larkui-icon","larkui-icon-review-arrow-right",e.className].filter(Boolean).join(" ")}),Ne.createElement("path",{d:"m115.925 74.9 46.171 46.1a9.889 9.889 0 0 1 0 14l-46.17 46.1c-3.873 3.866-10.15 3.866-14.022 0a9.892 9.892 0 0 1-2.904-7V81.9c0-5.468 4.439-9.9 9.915-9.9a9.922 9.922 0 0 1 7.01 2.9Z",fill:"currentColor",fillRule:"nonzero"}))};function gb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}rt("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n/**\n * lake/editor 的卡片容器实现方式会导致文档样式影响卡片编辑器样式\n */\n.lake-diagram-panel-properties ~ div .ant-dropdown-menu-item {\n  margin-left: 0;\n  list-style-type: none;\n}\n.lake-diagram-panel-properties {\n  background-color: var(--yq-bg-secondary);\n  border-left: 1px solid var(--yq-border-primary);\n  height: 100%;\n  width: 100%;\n  min-width: 212px;\n  max-width: 286px;\n  cursor: default;\n  user-select: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-menu-hide-header {\n  margin-top: 8px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-menu-hide-header .ant-collapse-header {\n  display: none;\n}\n.lake-diagram-panel-properties .lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body {\n  height: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs {\n  height: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav {\n  width: 100%;\n  margin-bottom: 0px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.09);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list {\n  width: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab {\n  flex-grow: 1;\n  margin: 0 2px;\n  display: inline-block;\n  text-align: center;\n  border: none;\n  color: var(--yq-text-caption);\n  border-radius: 0;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab:hover {\n  color: var(--yq-text-primary);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn {\n  color: var(--yq-text-primary);\n  font-weight: 400;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-content-holder {\n  overflow: auto;\n  height: calc(100% - 38px);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs-bar {\n  margin: 0;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse {\n  border: none;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-header {\n  padding: 0 16px;\n  margin: 8px 0;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-header .larkui-icon {\n  padding: 0;\n  margin-right: 8px;\n  top: 6px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item {\n  padding-top: 8px;\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item .ant-collapse-content {\n  border: none;\n  background: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item .ant-collapse-content .ant-collapse-content-box {\n  margin: 0px 16px;\n  padding: 0px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.09);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item:last-child .ant-collapse-content-box {\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item:last-child {\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty {\n  height: 100%;\n  position: relative;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty .lake-diagram-background-wrapper {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  margin: auto;\n  padding-bottom: 96px;\n  width: 200px;\n  height: 140px;\n  text-align: center;\n  color: var(--yq-text-disable);\n  line-height: 24px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty .lake-diagram-background-wrapper p {\n  margin-bottom: 0;\n}\n.lake-diagram-control {\n  margin-bottom: 8px;\n}\n.lake-diagram-control.disabled .lake-diagram-control-title {\n  color: var(--yq-text-caption);\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra {\n  border-color: var(--yq-border-primary);\n  background: none;\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra > svg {\n  display: none;\n}\n.lake-diagram-control-title {\n  color: var(--yq-text-body);\n  letter-spacing: 0;\n}\n.lake-diagram-control-head {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.lake-diagram-control-extra {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 92px;\n  min-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n.lake-diagram-control-extra > svg {\n  display: block;\n}\n.lake-diagram-control-body .ant-checkbox + span {\n  letter-spacing: 0;\n}\n.lake-diagram-panel-head {\n  border-bottom: 1px solid var(--yq-border-primary);\n  margin-bottom: 12px;\n  padding-bottom: 4px;\n}\n.lake-diagram-panel-head-title {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  font-weight: 500;\n}\n");var bb=Ze.a.TabPane;function xb(e,t){var n="object"===i()(e)?e:c()({},e,t),r={},a=function(e){e.split(".").reduce((function(t,r,a,i){return t[r]=a+1===i.length?n[e]:{}}),r)};for(var o in n)a(o);return r}function kb(e){var t,n,r=e.diagram,a=e.menus,i=e.tabs,o=e.emptyImg,l=e.className,s=Object(Ne.useState)(e.selections||r.selector.selections.concat([])),u=b()(s,2),d=u[0],f=u[1],h=Object(Ne.useState)(null),p=b()(h,2),m=p[0],y=p[1],v=function(e,t,n){var r={},a=[];return e.forEach((function(e,t){var n=e.name,a=e.key;r[a]={name:n,menus:[],index:t,key:a}})),t.forEach((function(e){e.condition(n)&&(r[e.tabKey].menus.push(e),a.push(e.name))})),Object.values(r).filter((function(e){return e.menus.length>0})).sort((function(e,t){return e.index-t.index}))}(i,a,d);function g(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;if("function"==typeof t)return t(),void f(D()(d));if(e.onChange)return e.onChange(xb(t,n),a);if(a.every((function(e){return e.isGroup}))){var i,o=[],c=[],l=[],s=xb(t,n);return s.hasOwnProperty("width")?i="lc":s.hasOwnProperty("height")&&(i="tc"),a.forEach((function(e){var t=Ed(e),n=b()(t,3),r=n[0],a=n[1],u=n[2],d=wd(s,{x:e.x,y:e.y,w:e.width,h:e.height,r:0},a);l.push.apply(l,D()(Pd(d,r,i))),c.push.apply(c,D()(r)),o.push.apply(o,D()(u))})),r.command.execute("Update",{id:c,model:l,originModels:o,autoSelect:!1}),void f(D()(d))}r.command.execute("Update",{id:a,model:xb(t,n),autoSelect:!1}),f(D()(d))}return Object(Ne.useEffect)((function(){Array.isArray(e.selections)&&f(e.selections)}),[e.selections]),Object(Ne.useEffect)((function(){if(r){var e=ye()((function(e){e&&y(e),f(r.selector.selections.concat([]))}),32),t=function(){e()};return r.on("afterselect",t),function(){r.off("afterselect",t)}}}),[r,m]),Ie.a.createElement("div",{className:ze()("lake-diagram-panel lake-diagram-panel-properties",l),"data-lake_prevent_click_unselect":"true"},v.length>0?(t=a.map((function(e){return e.name})),n=v.map((function(e){return e.key})),Ie.a.createElement("div",{className:"lake-diagram-panel-body"},Ie.a.createElement(Ze.a,{type:"card",activeKey:m&&-1!==n.indexOf(m)?m:d.length>0&&d.every((function(e){return e.isText}))?"text":v[0].key,onChange:function(e){y(e)}},v.map((function(e){var n=e.name,a=e.menus,i=e.key;return Ie.a.createElement(bb,{tab:n,key:i},Ie.a.createElement(Ue.a,{defaultActiveKey:t,expandIcon:function(e){return e.isActive?Ie.a.createElement(yb,{style:{color:"#595959"}}):Ie.a.createElement(vb,{style:{color:"#595959"}})}},a.map((function(e){return Ie.a.createElement(Ue.a.Panel,{header:e.name,key:e.name,className:!0===e.hideHeader?"lake-diagram-panel-menu-hide-header":""},e.controls.map((function(e,t){return e.display&&!e.display(d)?null:Ie.a.createElement(e.Control,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({key:t,path:e.path,title:e.title,selections:d,diagram:r,onChange:g},e.props))})))}))))}))))):Ie.a.createElement("div",{className:"lake-diagram-panel-body lake-diagram-panel-body-empty"},Ie.a.createElement("div",{className:"lake-diagram-background-wrapper"},Ie.a.createElement("img",{src:o}),Ie.a.createElement("p",null,zn("点击选中元素")),Ie.a.createElement("p",null,zn("可设置颜色、布局、文字等样式")))))}function wb(e){var t=e.title,n=e.extra,r=e.children,a=e.disabled,i=e.onMouseDown,o=ze()("lake-diagram-control",e.className,{disabled:a});return Ie.a.createElement("div",{className:o,onMouseDown:i},t&&Ie.a.createElement("div",{className:"lake-diagram-control-head"},Ie.a.createElement("div",{className:"lake-diagram-control-title"},t),n&&Ie.a.createElement("div",{className:"lake-diagram-control-extra"},n)),r&&Ie.a.createElement("div",{className:"lake-diagram-control-body"},r))}function Cb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ab(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ob(e){var t=e.zoom;e=Ab(Ab({},e),{},{zoomToolDOM:null});var n=function(t){var n=e,r=n.onChange,a=n.minZoom,i=n.maxZoom;t<a&&(t=a),t>i&&(t=i),r(t)},r=Ie.a.createElement(Ve.a,{className:"lake-zoom-tool-menu",onClick:function(e){var t=e.item;n(t.props.value)}},[{value:.2,title:"20%"},{value:.5,title:"50%"},{value:.75,title:"75%"},{value:1,title:"100%"},{value:1.5,title:"150%"},{value:2,title:"200%"},{value:3,title:"300%"},{value:4,title:"400%"}].map((function(e,t){return Ie.a.createElement(Ve.a.Item,{key:t,value:e.value},e.title)})));return Ie.a.createElement("div",{className:"lake-board-zoom-tool",ref:function(t){e.zoomToolDOM=t}},Ie.a.createElement("span",{className:"lake-icon lake-icon-board-zoom-out",onClick:function(){var t=e,r=t.zoomStep,a=t.zoom;n(a-r)}}),Ie.a.createElement(Xe.a,{overlayClassName:"lake-board-zoom-tool-dropdown-overlay ne-ignore-pointer-events",overlay:r,placement:"bottomCenter",trigger:["click"]},Ie.a.createElement("span",{className:"lake-zoom-tool-precent"},Math.round(100*t)+"%")),Ie.a.createElement("span",{className:"lake-icon lake-icon-board-zoom-in",onClick:function(){var t=e,r=t.zoomStep,a=t.zoom;n(a+r)}}))}function Eb(e){var t=e.diagram,n=Object(Ne.useState)(null),r=b()(n,2),a=r[0],i=r[1];return Object(Ne.useEffect)((function(){if(t){i(t.viewport.zoom);var e=ye()((function(){i(t.viewport.zoom)}),32);return t.on("afterviewportchange",e),function(){t.off("afterviewportchange",e)}}}),[a,t]),t?Ie.a.createElement(Ob,{zoom:a,onChange:function(e){"autoFit"===e?t.viewport.autoFit():"resetView"===e?t.viewport.focusFirstRoot():t.viewport.setViewport(e)}}):Ie.a.createElement("div",null)}function Pb(e){var t=e.onClose;return Ie.a.createElement(tt.a,{className:"lake-board-iconfont-copyright-notice",title:zn("素材版权说明"),visible:!0,centered:!0,onCancel:t,zIndex:3e3,footer:null},Ie.a.createElement("p",{className:"lake-board-iconfont-copyright-notice-description"},zn("所有 icon 素材均来自 iconfont 平台，仅供广大用户交流学习使用，未经 iconfont 或其关联公司书面授权许可，不得用于任何商业用途。")),Ie.a.createElement("p",{className:"lake-board-iconfont-copyright-notice-links"},Ie.a.createElement("a",{href:"https://mos.m.taobao.com/iconfont-legal-agreement?spm=a313x.7781069.0.0"},"法律声明"),Ie.a.createElement("a",{href:"https://www.yuque.com/yuque/wknab3/pg3x76"},"更多说明"),Ie.a.createElement(Ye.a,{type:"primary",onClick:t},"我知道了")))}function Sb(){var e=Object(Ne.useState)(!1),t=b()(e,2),n=t[0],r=t[1],a=Hf()?"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*7X8oSpr2xkkAAAAAAAAAAAAADvuFAQ/original":"https://mdn.alipayobjects.com/huamei_0prmtq/afts/img/A*U6yhS4Ir_VwAAAAAAAAAAAAADvuFAQ/original";return Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-header"},Ie.a.createElement("img",{onClick:function(){window.open("https://www.iconfont.cn/","_blank")},className:"lake-board-iconfont-searcher-header-icon",src:a}),Ie.a.createElement("a",{className:"lake-board-iconfont-searcher-header-copyright",target:"_blank",href:"https://www.yuque.com/yuque/wknab3/pg3x76"}),n&&Ie.a.createElement(Pb,{onClose:function(){r(!1)}}))}function jb(){return Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-container","data-testid":"lake-board-iconfont-searcher-offline"},Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-background-image"}),Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-background-tips"},zn("暂时无法从 iconfont 获取资源")))}function Rb(){return Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-container","data-testid":"lake-board-iconfont-searcher-empty"},Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-background-image"}),Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-background-tips"},zn("搜索结果为空")))}kb.defaultProps={diagram:null,menus:null,tabs:null,emptyImg:"",className:""},kb.propTypes={diagram:_e.a.object,menus:_e.a.array,tabs:_e.a.array,emptyImg:_e.a.string,selections:_e.a.arrayOf(_e.a.object),onChange:_e.a.func,className:_e.a.string},rt("/* stylelint-disable */\n.lake-diagram-control .lake-diagram-control-extra .ant-input-number {\n  border: none;\n}\n.lake-diagram-control .lake-diagram-control-extra .lake-diagram-dropdown-input {\n  border: none;\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra {\n  background-color: var(--yq-bg-secondary);\n}\n.lake-diagram-control.disabled .ant-input-number.ant-input-number-disabled {\n  background-color: var(--yq-bg-secondary);\n}\n"),Object.assign(wb,{get:function(e,t,n){var r=n;if(e.length>0)if((r=e.map((function(e){return t.split(".").reduce((function(e,t){return e?e.isCell&&e.get(t)||e[t]:e}),e)}))).every((function(e){return e===r[0]})))r=r[0];else{if(!r.every((function(e){return"number"==typeof e})))return"multiValue";r.sort(),r=r[r.length-1]}return r}}),wb.propTypes={title:_e.a.string,extra:_e.a.object,children:_e.a.node,className:_e.a.string,disabled:_e.a.bool,onMouseDown:_e.a.func},kb.Control=wb,rt(".lake-board-zoom-tool-dropdown-overlay {\n  padding-top: 6px;\n  min-width: 111px;\n}\n.lake-board-zoom-tool-dropdown-overlay ul {\n  list-style-type: none;\n  margin: 0;\n}\n.lake-board-zoom-tool-dropdown-overlay ul.lake-zoom-tool-menu {\n  width: 111px;\n}\n.lake-board-zoom-tool-dropdown-overlay ul.lake-zoom-tool-menu li {\n  font-size: 12px;\n  margin-left: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n.lake-board-zoom-tool-dropdown-overlay .ant-dropdown-menu {\n  border-radius: 5px;\n}\n.lake-board-zoom-tool-dropdown-overlay .ant-dropdown-menu .ant-dropdown-menu-item {\n  color: var(--yq-black);\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-board-zoom-tool {\n  display: flex;\n  align-items: center;\n  height: 100%;\n  padding: 0 4px;\n}\n.lake-board-zoom-tool .lake-icon {\n  color: var(--yq-text-primary);\n  margin-left: 2px;\n  margin-right: 2px;\n  font-size: 14px;\n  line-height: 18px;\n  width: 18px;\n  height: 18px;\n}\n.lake-board-zoom-tool .lake-icon:hover {\n  cursor: pointer;\n}\n.lake-board-zoom-tool .lake-zoom-tool-precent {\n  vertical-align: middle;\n  width: 40px;\n  line-height: 25px;\n}\n.lake-board-zoom-tool span {\n  display: inline-block;\n  padding: 0;\n  font-size: 12px;\n  height: 26px;\n  text-align: center;\n  user-select: none;\n}\n.lake-card-block-max .lake-zoom-tool {\n  margin: 8px;\n}\n"),Ob.defaultProps={zoom:1,onChange:function(){},minZoom:.2,maxZoom:4,zoomStep:.2},Ob.propTypes={zoom:_e.a.number,onChange:_e.a.func,minZoom:_e.a.number,maxZoom:_e.a.number,zoomStep:_e.a.number,zoomToolDOM:_e.a.element},Eb.propTypes={diagram:_e.a.object},rt("/* stylelint-disable */\n.lake-board-iconfont-copyright-notice .ant-modal-close {\n  top: -8px;\n}\n.lake-board-iconfont-copyright-notice .ant-modal-header {\n  padding-top: 12px;\n  padding-bottom: 0px;\n  border-bottom: none;\n}\n.lake-board-iconfont-copyright-notice .ant-modal-header .ant-modal-title {\n  font-size: 14px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-description {\n  color: var(--yq-text-body);\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links {\n  margin-top: 24px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links a:first-child {\n  padding-right: 8px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links button {\n  float: right;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links a ~ a {\n  border-left: 1px solid var(--yq-border-primary);\n  padding: 0 8px;\n}\n"),rt('/* stylelint-disable */\n.lake-board-iconfont-searcher-header {\n  height: 44px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 0 16px;\n}\n.lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-icon {\n  cursor: pointer;\n}\n.lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-copyright {\n  width: 16px;\n  height: 16px;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/c50d07f1-891a-4dea-84f7-0c08fd92bc6a.svg);\n}\n[data-kumuhana="pouli"] .lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-copyright {\n  filter: invert(100%);\n}\n'),rt("/* stylelint-disable */\n.lake-board-iconfont-searcher-offline-container {\n  height: 256px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: start;\n}\n.lake-board-iconfont-searcher-offline-container .lake-board-iconfont-searcher-offline-background-image {\n  width: 70px;\n  height: 59px;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/82cfa582-d999-4c73-bfbe-5b9945af9726.svg);\n  background-position: center;\n  margin-top: 48px;\n  margin-bottom: 24px;\n}\n.lake-board-iconfont-searcher-offline-container .lake-board-iconfont-searcher-offline-background-tips {\n  color: var(--yq-text-disable);\n  width: 100%;\n  text-align: center;\n}\n"),rt("/* stylelint-disable */\n.lake-board-iconfont-searcher-empty-container {\n  height: 212px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: start;\n}\n.lake-board-iconfont-searcher-empty-container .lake-board-iconfont-searcher-empty-background-image {\n  width: 100px;\n  height: 68px;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/80736e19-e03c-44c7-9223-1d67449e98cf.svg);\n  background-position: center;\n  margin-top: 40px;\n  margin-bottom: 15px;\n}\n.lake-board-iconfont-searcher-empty-container .lake-board-iconfont-searcher-empty-background-tips {\n  color: var(--yq-text-disable);\n  width: 100%;\n  text-align: center;\n}\n"),rt("/* stylelint-disable */\n.lake-board-iconfont-searcher-container {\n  width: 230px;\n  height: 300px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content {\n  border-top: 1px solid var(--yq-border-primary);\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-search-input-container {\n  width: calc(100% - 16px);\n  margin: 8px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list {\n  height: 200px;\n  display: flex;\n  flex-wrap: wrap;\n  align-content: flex-start;\n  overflow: auto;\n  margin-left: 8px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container {\n  display: inline-block;\n  margin-right: 4px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container .lake-board-iconfont-searcher-content-list-item-img {\n  width: 16px;\n  height: 16px;\n  background-position: center;\n  margin: 8px;\n  background-repeat: no-repeat;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container:hover {\n  background-color: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n");var Mb=100,Lb=32,Bb={};function Db(e){var t=function(e){var t=e.diagram,n=e.onSelect,r=Object(Ne.useState)([]),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)(!0),l=b()(c,2),s=l[0],u=l[1];function d(){return d=G()(V.a.mark((function t(n,r){var a,i,c,l,s,u,d,f,h;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Bb.data,i=Bb.keyword,c=Bb.count,l=Bb.page,s=e.boardWebProxy,a&&l&&i&&null!=s&&s.iconfont&&c){t.next=4;break}return t.abrupt("return");case 4:if(!((u=(null==a?void 0:a.length)||0)>=c)){t.next=7;break}return t.abrupt("return");case 7:if(!(u/6*Lb-r<=1.5*n)){t.next=14;break}return d=l+1,t.next=12,s.iconfont.search({keyword:i,page_size:Mb,page:d});case 12:(f=t.sent)&&(h=a.concat(f.data),o(h),Bb.data=h,Bb.page=d);case 14:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=G()(V.a.mark((function t(n){var r,a,i;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.boardWebProxy).iconfont){t.next=13;break}return a=1,t.next=5,r.iconfont.search({keyword:n,page_size:Mb,page:a});case 5:if(!(i=t.sent)){t.next=13;break}return o(i.data),Bb.page=a,Bb.count=i.count,Bb.data=i.data,Bb.keyword=n,t.abrupt("return");case 13:o([]);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(){return p=G()(V.a.mark((function e(r){var a,i,o,c,l;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.svg,i=hl(a),e.next=4,yi(i);case 4:return o=e.sent,e.next=7,fetch(i).then((function(e){return e.blob()}));case 7:c=e.sent,l=new File([c],"iconfont.svg",{type:"image/svg+xml"}),t.command.execute("BeginInsertImage",{model:{image:{src:i,naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight},width:32,height:32},files:[l]}),n&&n();case 11:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function m(){return(m=G()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("");case 2:u(!1);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=ye()(f,200);return Object(Ne.useEffect)((function(){t&&function(){m.apply(this,arguments)}()}),[t]),{state:{data:i,loading:s},onSearch:function(e){Object.assign(Bb,{data:void 0,keyword:void 0,count:void 0,page:void 0}),y(e)},onItemClick:function(e){return p.apply(this,arguments)},onListScroll:ye()((function(e,t){return d.apply(this,arguments)}),200)}}(e);return Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-container"},Ie.a.createElement(Sb,null),function(e){var t,n=e.state,r=n.data,a=n.loading;return r?(a||(t=Array.isArray(r)&&0===r.length?Ie.a.createElement(Rb,null):function(e){var t=e.state.data;return Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-content-list",onScroll:function(t){e.onListScroll(t.target.offsetHeight,t.target.scrollTop)}},Array.isArray(t)&&t.map((function(t,n){var r=t.svg;return Ie.a.createElement("div",{"data-testid":"lake-board-iconfont-searcher-content-list-item-".concat(n),onClick:function(){null==e||e.onItemClick(t)},key:n,className:"lake-board-iconfont-searcher-content-list-item-container"},Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-content-list-item-img",style:{backgroundImage:"url(".concat(hl(r),")")}}))})))}(e)),Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-content"},Ie.a.createElement("div",{className:"lake-board-iconfont-searcher-search-input-container","data-testid":"lake-board-iconfont-searcher-search-input-container"},Ie.a.createElement(We.a,{onCompositionEnd:function(t){e.onSearch(t.target.value)},placeholder:zn("请搜索"),maxLength:50,prefix:Ie.a.createElement(mb,null),onInput:function(t){t.nativeEvent.isComposing||e.onSearch(t.target.value)}})),t)):Ie.a.createElement(jb,null)}(t))}rt("/* stylelint-disable */\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header {\n  padding: 10px 16px;\n  padding-bottom: 4px;\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-board-theme-picker-header-title {\n  font-size: 14px;\n  color: var(--yq-text-primary);\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-icon-alert {\n  margin-left: 4px;\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-icon-alert:hover {\n  cursor: pointer;\n}\n.lake-board-theme-picker-header-help-tips {\n  font-size: 14px;\n  max-width: 212px;\n}\n"),rt("/* stylelint-disable */\n.lake-board-theme-picker-container {\n  width: 230px;\n  overflow: auto;\n  padding: 12px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-content: flex-start;\n  padding-bottom: 6px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container {\n  border-radius: 4px;\n  outline: 1px solid #d8d8d8;\n  width: 98px;\n  height: 64px;\n  margin-bottom: 12px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container .lake-board-theme-picker-item-title {\n  font-size: 14px;\n  width: 82px;\n  height: 18px;\n  margin: 4px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container .lake-board-theme-picker-item-cover {\n  background-position: center;\n  background-repeat: no-repeat;\n  width: 86px;\n  height: 18px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container.lake-board-theme-picker-item-container-selected {\n  outline: 1px solid #1672f3;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container:hover {\n  cursor: pointer;\n  outline: 1px solid #1672f3;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container:nth-child(odd) {\n  margin-right: 10px;\n}\n");var Nb="https://gw.alipayobjects.com/zos/bmw-prod/9ad1c2ce-f565-421b-a867-fb9c5ef1206b.svg",Ib=zn("未命名"),Tb="lake-board-theme-picker-item-container-selected",_b=[{cover:"https://gw.alipayobjects.com/zos/bmw-prod/1b30aa39-33a1-4d27-b4c7-9e1e0b5ac1f1.svg",theme:"default",backgroundColor:"white",titleFontColor:"#262626",title:zn("浅色风")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/ce15e90d-b07e-4da5-9dce-3f7b126c6015.svg",theme:"dark",backgroundColor:"rgba(41, 41, 41, 0.96)",titleFontColor:"rgba(255, 255, 255, 0.88)",title:zn("暗色风")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/db33a600-59c1-4ec2-b0e6-ad9b6953194c.svg",theme:"colorful_kano",backgroundColor:"white",titleFontColor:"#262626",title:zn("多彩卡诺")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/59d288e4-280f-48d1-9940-a3e0ba0e5ce7.svg",theme:"van_cogh_starry_sky",backgroundColor:"rgba(41, 41, 41, 0.96)",titleFontColor:"rgba(255, 255, 255, 0.88)",title:zn("星空")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/a3c840a3-63a0-4d11-9dca-de8cdb3572eb.svg",theme:"iris",backgroundColor:"#F3F3F6",titleFontColor:"#163866",title:zn("鸢尾花")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/60a05954-c6d0-41ab-8899-3e63f09c63c8.svg",theme:"wuxia_qingqiu",backgroundColor:"#FAF5EC",titleFontColor:"#5B4E26",title:zn("巫峡清秋")}];function Fb(e){var t=s()(_b);return t.forEach((function(t){t.cover=t.cover||Nb,t.title=t.title||Ib,t.theme===e&&(t.selected=!0)})),t}function zb(e){var t=e.className,n=function(e){var t,n=e.diagram,r=e.data,a=e.sourceTheme,i=Object(Ne.useState)(Fb((null==n||null===(t=n.theme)||void 0===t?void 0:t.name)||"default")),o=b()(i,2),c=o[0],l=o[1];function s(e){var t=e.commandName;["SetTheme","Undo","Redo"].includes(t)&&l(Fb(n.theme.name))}return Object(Ne.useEffect)((function(){if(n)return n.on("aftercommandexecute",s),function(){n.off("aftercommandexecute",s)}}),[n]),{onItemClick:function(e){n&&n.command.execute("SetTheme",{name:e.theme}),n&&n.hooks.decorateNonMindmapCellModels.call(r,a)},state:{items:c}}}(e),r=n.state.items;return Ie.a.createElement("div",{className:ze()("lake-board-theme-picker-container",t)},r.map((function(e,t){var r=e.cover,a=e.title,i=e.selected,o=e.backgroundColor,c=e.titleFontColor,l=i?Tb:null,s={},u={};return o&&(s.backgroundColor=o),c&&(u.color=c),Ie.a.createElement("div",{className:ze()("lake-board-theme-picker-item-container",l),key:t,style:s,onClick:function(){n.onItemClick(e)}},Ie.a.createElement("div",{className:"lake-board-theme-picker-item-title",style:u},a),Ie.a.createElement("div",{className:"lake-board-theme-picker-item-cover",style:{backgroundImage:"url(".concat(r,")")}}))})))}function qb(e){var t=Y()(e).toRgb(),n=t.r,r=t.g,a=t.b;return t.a,Y()("rgb(".concat(n,", ").concat(r,", ").concat(a,")")).toHexString()}function Yb(e){var t=function(e){var t=e.diagram,n=e.popoverVisible,r=Object(Ne.useState)([]),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)("default"),l=b()(c,2),s=l[0],u=l[1];return Object(Ne.useEffect)((function(){!function(){if(!t.destroyed&&n){var e=t.getCells().filter((function(e){return Pn(e)||xn(e)||Rn(e)||Mn(e)||Sn(e)||jn(e)||Bn(e)||wn(e)||Cn(e)})),r=[];e.forEach((function(e){e.fill&&"transparent"!==e.fill.color&&"rgba(0,0,0,0)"!==e.fill.color&&r.push({id:e.model.id,type:"fill",color:qb(e.fill.color),alpha:Y()(e.fill.color).getAlpha()}),e.stroke&&"transparent"!==e.stroke.color&&"rgba(0,0,0,0)"!==e.stroke.color&&r.push({id:e.model.id,type:"stroke",color:qb(e.stroke.color),alpha:Y()(e.stroke.color).getAlpha()})})),o(r),u(t.theme.name)}}()}),[t,n]),{state:{data:i,sourceTheme:s}}}(e).state;return Ie.a.createElement("div",{className:ze()("lake-board-toolbard-theme-picker-outer-container")},Ie.a.createElement("div",{className:ze()("lake-board-theme-picker-header")},Ie.a.createElement("span",{className:ze()("lake-board-theme-picker-header-title")},zn("主题配色")),Ie.a.createElement(qe.a,{title:Ie.a.createElement("div",{className:ze()("lake-board-theme-picker-header-help-tips")},zn("切换主题时会对画布上已有图形生效，  \n          ⌘/Ctrl+Z 可撤销")),open:!0})),Ie.a.createElement(zb,De()({},e,t)))}function Hb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}rt("/* stylelint-disable */\n.lake-board-rough-setting-container {\n  padding: 10px 16px;\n  padding-bottom: 0px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container .lake-board-rough-setting-title {\n  font-size: 14px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container .lake-board-rough-setting-title .lake-icon-question {\n  color: inherit;\n}\n.lake-board-rough-setting-container .lake-diagam-rough-setting-switch {\n  float: right;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 8px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas {\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0);\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas:hover {\n  cursor: pointer;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas.lake-diagram-rough-setting-fill-style-selected {\n  border: 1px solid var(--yq-blue-6);\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container.disable canvas:hover {\n  cursor: not-allowed;\n}\n");var Gb=61,Xb=20,Vb=["hachure","cross-hatch","solid"];function Wb(e){return"default"!==(null==e?void 0:e.rough.name)}function Zb(e){var t=e.diagram,n=Object(Ne.useState)(Wb(t)),r=b()(n,2),a=r[0],i=r[1],o=Object(Ne.useState)(null==t?void 0:t.rough.name),l=b()(o,2),s=l[0],u=l[1],d=Object(Ne.useRef)(null);function f(e){["SetRough","Undo","Redo"].includes(e.commandName)&&(i(Wb(t)),u(null==t?void 0:t.rough.name))}return Object(Ne.useEffect)((function(){if(t)return t.on("aftercommandexecute",f),function(){t.off("aftercommandexecute",f)}}),[t]),Object(Ne.useEffect)((function(){var e=d.current;if(e){!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(e);var n=Gf();Vb.forEach((function(r){var i={fillStyle:r};"solid"===r?(i.roughness=0,i.fill=a?n.roughIconSolidfill:n.roughIconSolidDisablefill):"hachure"===r?i.fill=a?n.roughIconHachurefill:n.roughIconHachureDisablefill:"cross-hatch"===r&&(i.fill=a?n.roughIconCrossHatchfill:n.roughIconCrossHatchDisablefill);var o=function(e){var t=document.createElement("canvas"),n=$.a.canvas(t),r=2*Gb,a=2*Xb;return t.width=r,t.height=a,t.style.width="".concat(Gb,"px"),t.style.height="".concat(Xb,"px"),n.rectangle(0,0,r,a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({seed:20,stroke:"none",hachureGap:12},e)),t}(i);s===r&&a&&o.classList.add("lake-diagram-rough-setting-fill-style-selected"),a&&o.addEventListener("click",(function(){(null==t?void 0:t.rough.name)!==r&&t.command.execute("SetRough",{name:r})})),e.appendChild(o)}))}}),[d,s,a]),Ie.a.createElement("div",{className:ze()("lake-board-rough-setting-container")},Ie.a.createElement("p",{className:ze()("lake-board-rough-setting-open-switch-container")},Ie.a.createElement("span",{className:"lake-board-rough-setting-title"},zn("手绘风格")," ",Ie.a.createElement("a",{className:ze()("lake-icon","lake-icon-question"),href:"https://www.yuque.com/yuque/wknab3/nu8ptz",target:"_blank"})),Ie.a.createElement(nt.a,{size:"small",checked:!!a,onChange:function(e){var n;n=e?"default"!==s?s:"hachure":"default",t.command.execute("SetRough",{name:n})},className:"lake-diagam-rough-setting-switch"})),Ie.a.createElement("div",{ref:d,className:ze()("lake-board-rough-setting-fill-style-container",{disable:!a})}))}var Ub=r.FileUtils.isImage;function Kb(e,t){var n=Array.from(e.nativeEvent.target.files).filter((function(e){return Ub(e)}));n[0]&&t.emit("importimage",{files:n,from:"uploadButton"})}function Qb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qb(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $b(e){return e.overlay?e.overlay({onSelect:e.onSelect,setPopoverVisible:e.setPopoverVisible,popoverVisible:e.popoverVisible}):Ie.a.createElement(Ve.a,{onClick:e.onSelect,className:ze()("lake-diagram-board-toolbar-menu",e.menuClassName)},e.data.map((function(e){return Ie.a.createElement(Ve.a.Item,{key:e.key,style:{marginTop:"2px"}},Ie.a.createElement("div",{className:"lake-icon lake-icon-".concat(e.icon)}))})))}function ex(e){var t=e.name,n=e.icon,r=e.tooltipPlacement,a=e.popoverPlacement,i=e.defaultKey,o=e.data,c=e.titleTag,l=e.shouldClickUpdateOverlay,s=e.className,u=Object(Ne.useState)(i),d=b()(u,2),f=d[0],h=d[1],p=o&&o.find((function(e){return e.key===f})),m=Object(Ne.useState)(!1),y=b()(m,2),v=y[0],g=y[1],x=Object(Ne.useState)(!1),k=b()(x,2),w=k[0],C=k[1];function A(t){var n=t.key;h(n),C(!1),e.onSelect&&e.onSelect({key:n})}function O(){return $b(Jb(Jb({},e),{},{onSelect:A,setPopoverVisible:C,popoverVisible:w}))}var E=Object(Ne.useState)(O()),P=b()(E,2),S=P[0],j=P[1];return Object(Ne.useEffect)((function(){j(O())}),[w]),Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-command"},Ie.a.createElement(Ke.a,{overlayClassName:"lake-diagram-board-toolbar-popover",content:S,trigger:"click",placement:"".concat(a),visible:w,onVisibleChange:function(){return C(!w)}},Ie.a.createElement(qe.a,{visible:v,placement:r,overlayClassName:ze()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===r}),title:c},Ie.a.createElement(Ye.a,{className:s,"data-testid":t,onClick:function(){g(!1),C(!w),l&&j(O()),e.onClick&&e.onClick({key:f,popoverVisible:w})},onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},function(e){return"string"==typeof e?Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(e||p.icon)}):e}(n)))))}function tx(e){var t=e.name,n=e.icon,r=e.accept,a=e.disabled,i=e.title,o=e.tooltipPlacement,c=e.onChange,l=e.titleTag,s=Object(Ne.useRef)();return Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-command","data-testid":t},Ie.a.createElement(qe.a,{disabled:a||!i,placement:o,title:l,overlayClassName:ze()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===o})},Ie.a.createElement(Ye.a,{className:"lake-diagram-board-toolbar-upload",onClick:function(){s.current.value="",s.current.click()},disabled:a},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),Ie.a.createElement("input",{type:"file",accept:r,onChange:c,ref:s}))))}function nx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ax(e){var t=e.name,n=e.titleTag,r=e.title,a=e.hotkey,i=e.label,o=e.tooltipPlacement,c=e.disabled,l=e.diagram,s=e.defaultKey,u=e.active,d=Object.keys(e).reduce((function(t,n){return n.startsWith("data-")&&(t[n]=e[n]),t}),{}),f="string"==typeof e.icon?Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}):e.icon;return Ie.a.createElement("div",De()({className:"lake-diagram-board-toolbar-command","data-testid":t},d),Ie.a.createElement(qe.a,{disabled:c||!(r||a),placement:o,title:n,overlayClassName:ze()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===o})},Ie.a.createElement(Ye.a,{onClick:function(t){t.stopPropagation(),e.onClick?e.onClick({key:s}):e.execCommand&&e.execCommand(l)},disabled:c,className:ze()({"lake-button-active":u})},f,i&&Ie.a.createElement("span",{className:"lake-diagram-board-toolbar-command-label"},i))))}function ix(e){var t=e.speratorAlignment,n=e.tooltipPlacement,r=e.title,a=e.hotkey,i=e.diagram,o=e.className,c=e.disabled,l=e.active;c="function"==typeof c?c(i):c,l="function"==typeof l?l(i):l;var s=rx(rx({},e),{},{disabled:c,active:l,className:o}),u="bottom"===n?Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip"},r&&Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-title"},r),a&&Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-hotkey"},a)):Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip"},r&&Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-title"},r,a&&Ie.a.createElement("span",{className:"lake-diagram-board-toolbar-popover-shortcut"},a)));switch(e.type){case"separator":return Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-".concat(t,"-separator")});case"popover":return Ie.a.createElement(ex,De()({},s,{titleTag:u}));case"upload":return Ie.a.createElement(tx,De()({},s,{titleTag:u}));case"custom":return e.component;default:return Ie.a.createElement(ax,De()({},s,{titleTag:u}))}}function ox(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ox(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ox(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}rt("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-board-toolbar-popover .ant-btn::after {\n  display: none;\n}\n.lake-diagram-board-toolbar-popover .ant-btn.ant-dropdown-trigger:hover {\n  background: var(--yq-border-primary);\n  border-radius: 2px;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button {\n  display: flex;\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: auto;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon::before {\n  content: '';\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover-menu .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 16px;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n  border-radius: 3px;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-board-toolbar-menu.ant-menu {\n  width: 38px;\n  padding-top: 3px;\n  padding-bottom: 3px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item {\n  padding: 0 5px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  width: 28px;\n  margin-left: 4px;\n  margin-right: 4px;\n  height: 28px;\n  line-height: 32px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item-selected {\n  background-color: transparent;\n}\n"),$b.propTypes={data:_e.a.array,overlay:_e.a.node,onSelect:_e.a.func,menuClassName:_e.a.string},ex.defaultProps={popoverPlacement:"rightTop"},ex.propTypes={command:_e.a.string,name:_e.a.string,icon:_e.a.oneOfType([_e.a.string,_e.a.element]),overlay:_e.a.func,onSelect:_e.a.func,onClick:_e.a.func,execCommand:_e.a.func,defaultKey:_e.a.string,data:_e.a.array,tooltipPlacement:_e.a.string,popoverPlacement:_e.a.string,diagram:_e.a.object,titleTag:_e.a.object,shouldClickUpdateOverlay:_e.a.bool,className:_e.a.string},rt(".lake-diagram-board-toolbar-upload {\n  position: relative;\n}\n.lake-diagram-board-toolbar-upload input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display: none;\n}\n"),tx.propTypes={name:_e.a.string,icon:_e.a.string,accept:_e.a.string,disabled:_e.a.bool,title:_e.a.string,onChange:_e.a.func,diagram:_e.a.object,tooltipPlacement:_e.a.string,titleTag:_e.a.object},rt(".lake-diagram-board-toolbar-tooltip-overlay .ant-tooltip-content {\n  padding-left: 4px;\n}\n"),ax.propTypes={disabled:_e.a.bool,active:_e.a.bool,name:_e.a.string,title:_e.a.string,hotkey:_e.a.string,titleTag:_e.a.object,type:_e.a.string,icon:_e.a.oneOfType([_e.a.string,_e.a.object]),label:_e.a.string,command:_e.a.string,onClick:_e.a.func,execCommand:_e.a.func,diagram:_e.a.object,tooltipPlacement:_e.a.string,defaultKey:_e.a.string},ix.propTypes={type:_e.a.string,component:_e.a.object,speratorAlignment:_e.a.string,tooltipPlacement:_e.a.string,title:_e.a.string,hotkey:_e.a.string,disabled:_e.a.oneOfType([_e.a.bool,_e.a.func]),active:_e.a.oneOfType([_e.a.bool,_e.a.func]),diagram:_e.a.object,className:_e.a.string},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-uniform-toolbar-body {\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-uniform-toolbar-separator {\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-side-toolbar:empty {\n  display: none;\n}\n.lake-diagram-board-top-toolbar {\n  position: absolute;\n  top: 10px;\n  left: 0;\n  right: 0;\n  z-index: 1;\n  padding-left: 8px;\n  padding-right: 16px;\n  height: 40px;\n  display: flex;\n  justify-content: space-between;\n  pointer-events: none;\n}\n.lake-diagram-board-top-toolbar > div {\n  pointer-events: auto;\n}\n.lake-diagram-board-top-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-left: 8px;\n  margin-right: 8px;\n  height: 100%;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-top-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-board-toolbar-left {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-board-toolbar-right {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n.lake-diagram-board-side-toolbar {\n  position: absolute;\n  width: 40px;\n  left: 16px;\n  height: 100%;\n  z-index: 1;\n  display: flex;\n  align-content: center;\n  pointer-events: none;\n}\n.lake-diagram-board-side-toolbar-body {\n  display: flex;\n  align-items: center;\n  flex-flow: column;\n  margin: auto;\n  pointer-events: initial;\n  padding: 4px 0;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-side-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-board-toolbar-vertical-separator {\n  width: 1px;\n  height: 60%;\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-vertical-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-toolbar-horizontal-separator {\n  height: 1px;\n  margin-top: 4px;\n  margin-bottom: 4px;\n  width: calc(100% - 16px);\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-horizontal-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-toolbar-command .ant-btn {\n  border: none;\n  padding: 0 5px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  width: 32px;\n  margin-left: 3px;\n  margin-right: 3px;\n  color: var(--yq-text-primary);\n  vertical-align: middle;\n  border-radius: 6px;\n  background-color: transparent;\n}\n.lake-diagram-board-toolbar-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-board-toolbar-command .ant-btn:hover,\n.lake-diagram-board-toolbar-command .ant-btn.lake-button-active {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-command .ant-btn:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-command .ant-btn.lake-button-active {\n  background: rgba(255, 255, 255, 0.12);\n  border-radius: 6px;\n}\n.lake-diagram-board-toolbar-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-board-toolbar-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-board-toolbar-command .ant-btn .lake-icon {\n  font-size: 18px;\n  margin: 0;\n}\n.lake-diagram-board-toolbar-command .lake-diagram-toolbar-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-command-label {\n  font-size: 12px;\n  display: inline-block;\n  margin-left: 0.25em;\n}\n.lake-diagram-board-toolbar-tooltip {\n  text-align: center;\n  font-size: 12px;\n}\n.lake-diagram-board-toolbar-tooltip .lake-diagram-board-toolbar-tooltip-hotkey {\n  color: var(--yq-text-caption);\n  margin-top: 4px;\n}\n.lake-diagram-board-toolbar-tooltip .lake-diagram-board-toolbar-tooltip-hotkey:first-child {\n  margin-top: 0;\n}\n.lake-diagram-board-toolbar-popover-shortcut {\n  font-size: 12px;\n  color: #d8dad9;\n  padding-left: 4px;\n}\n");var lx={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",LEFT_MIDDLE:"left-middle"};function sx(e){var t=e.items,n=e.tooltipPlacement,r=e.className,a=e.diagram;return Ie.a.createElement("div",{className:r},t.map((function(t,r){return Ie.a.createElement(ix,De()({key:"".concat(t.name||t.type,"-").concat(r),execCommand:t.execCommand,tooltipPlacement:n,diagram:a},t,e,{className:t.className}))})))}function ux(e){var t=e.items,n={placement:lx.TOP_LEFT,tooltipPlacement:"bottom",speratorAlignment:"vertical",className:"lake-diagram-board-top-toolbar-body"},r=function(n){return(r=n.placement,t.reduce((function(e,t){return t.align===r&&e.push(t.subItems),e}),[])).map((function(t,r){return Ie.a.createElement(sx,{key:r,items:t,tooltipPlacement:n.tooltipPlacement,speratorAlignment:n.speratorAlignment,className:n.className,diagram:e.diagram})}));var r};return Ie.a.createElement(Ie.a.Fragment,null,Ie.a.createElement("div",{className:ze()("lake-diagram-board-top-toolbar",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-left"},r(n)),Ie.a.createElement("div",{className:"lake-diagram-board-toolbar-right"},r(cx(cx({},n),{},{placement:lx.TOP_RIGHT})))),Ie.a.createElement("div",{className:ze()("lake-diagram-board-side-toolbar",e.className),"data-lake_prevent_click_unselect":"true"},r(cx(cx({},n),{},{placement:lx.LEFT_MIDDLE,tooltipPlacement:"right",speratorAlignment:"horizontal",className:"lake-diagram-board-side-toolbar-body"}))))}sx.defaultProps={items:[]},sx.propTypes={items:_e.a.array,tooltipPlacement:_e.a.string,className:_e.a.string,diagram:_e.a.object},ux.defaultProps={items:[]},ux.propTypes={className:_e.a.string,items:_e.a.array,execCommand:_e.a.func,diagram:_e.a.object},ux.Control=ix,rt(".ne-embed-icon {\n  display: inline-flex;\n  width: 16px;\n  height: 16px;\n}\n");var dx=function(e){S()(n,Ne.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L()(e);if(t){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){return m()(this,n),t.apply(this,arguments)}return v()(n,[{key:"_isLowContrast",value:function(e){var t=Y()(e).toRgb();return.3*t.r+.59*t.g+.11*t.b>=248}},{key:"_isTransparent",value:function(e){return!e||"transparent"===e||"rgba(255,255,255,0)"===e.replace(/ /g,"")||"rgba(0,0,0,0)"===e.replace(/ /g,"")}},{key:"requireStroke",value:function(e){return this._isTransparent(e)||this._isLowContrast(e)}},{key:"render",value:function(){return this._getIcon()}},{key:"_getIcon",value:function(){var e,t=this.props,n=t.type,r=t.fill,a=t.stroke,i=t.strokeWidth,o=t.pen;if(this._isTransparent(r))return Ie.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ie.a.createElement("defs",null,Ie.a.createElement("pattern",{id:"rect",viewBox:"0,0,8,8",width:"35%",height:"35%"},Ie.a.createElement("rect",{id:"矩形",fill:"#FAFAFA",x:"0",y:"0",width:"4",height:"4"}),Ie.a.createElement("rect",{id:"矩形备份-21",fill:"#FAFAFA",x:"4",y:"4",width:"4",height:"4"}),Ie.a.createElement("rect",{id:"矩形备份-20",fill:"#D9D9D9",x:"4",y:"0",width:"4",height:"4"}),Ie.a.createElement("rect",{id:"矩形备份-22",fill:"#D9D9D9",x:"0",y:"4",width:"4",height:"4"}))),Ie.a.createElement("circle",{cx:"8",cy:"8",r:"8",fill:"url(#rect)"}));if("stroke-color"===n&&this._isTransparent(a))return Ie.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ie.a.createElement("title",null,"透明环"),Ie.a.createElement("g",{id:"控件",stroke:"none",strokeWidth:"0.5",fill:"none",fillRule:"evenodd"},Ie.a.createElement("g",{id:"透明环",transform:"translate(-0.000000, 0.000000)"},Ie.a.createElement("path",{d:"M8,0 C12.418278,0 16,3.581722 16,8 C16,12.418278 12.418278,16 8,16 C3.581722,16 0,12.418278 0,8 C0,3.581722 3.581722,0 8,0 Z M8,3 C5.23857625,3 3,5.23857625 3,8 C3,10.7614237 5.23857625,13 8,13 C10.7614237,13 13,10.7614237 13,8 C13,5.23857625 10.7614237,3 8,3 Z",id:"形状",fill:"#FAFAFA"}),Ie.a.createElement("path",{d:"M8,13 L8,12.999 L8,16 C6.91549955,16 5.88140117,15.7842031 4.93830231,15.3932066 L6.08631593,12.6207031 C6.67578581,12.8651081 7.32214006,13 8,13 Z M11.5247537,11.5462815 L13.6458509,13.6678364 C12.905585,14.4052487 12.0216994,14.9985887 11.0398062,15.4022444 L9.89058451,12.6302127 C10.5062584,12.3785637 11.0605479,12.0076869 11.5247537,11.5462815 Z M4.48114009,11.5521301 L2.36015992,13.6738177 C1.61882513,12.9368948 1.02109994,12.0556625 0.612650477,11.075787 L3.38472128,9.92671467 C3.64106728,10.5400536 4.01611047,11.091429 4.48114009,11.5521301 Z M16,7.999 C16,9.08450045 15.7842031,10.1185988 15.3932066,11.0616977 L12.6207031,9.91368407 C12.8651081,9.32421419 13,8.67785994 13,8 L16,7.999 Z M3,8 L2.999,8 L4.45652404e-11,8 C4.45652404e-11,6.91549955 0.215796936,5.88140117 0.606793361,4.93830231 L3.37929685,6.08631593 C3.13489185,6.67578581 3,7.32214006 3,8 Z M13.6398401,2.32618229 C14.3811749,3.06310522 14.9789001,3.94433749 15.3873495,4.92421296 L12.6152787,6.07328533 C12.3589327,5.45994637 11.9838895,4.90857096 11.5188599,4.44786988 L13.6398401,2.32618229 Z M8,9.09494702e-13 C9.0848864,9.09494702e-13 10.1193348,0.215950555 11.0627045,0.607210861 L9.91368407,3.37929685 C9.32421419,3.13489185 8.67785994,3 8,3 L7.999,9.09494702e-13 L8,9.09494702e-13 Z M2.37521442,2.31125673 C2.36817981,2.31821274 2.36115804,2.32518171 2.35414914,2.33216359 C2.47280694,2.21398682 2.594547,2.10004476 2.71975554,1.98995348 L2.91043586,1.82748893 C3.08291716,1.68509277 3.26177813,1.54957175 3.44628096,1.42161318 L3.44587689,1.42189343 C3.64121394,1.28642097 3.84244471,1.15967042 4.04944431,1.04189047 L4.04893797,1.04217859 L4.35587152,0.876283146 L4.35587152,0.876283146 L4.67022901,0.723755702 L4.96019384,0.597755619 L6.10941549,3.36978734 L6.08230453,3.38096211 C6.01729624,3.40798236 5.95298109,3.43633501 5.88939319,3.46598597 L6.10941549,3.36978734 C6.00994969,3.41044274 5.91208604,3.45421002 5.81594555,3.50096817 C5.67093771,3.57146782 5.52925326,3.64913643 5.39194239,3.73324727 C5.36336599,3.75074884 5.33464738,3.76874189 5.30612657,3.78701662 C5.2498994,3.8230481 5.19464208,3.86003397 5.14017772,3.89807688 C5.13087827,3.90457251 5.12161081,3.91109266 5.11236658,3.91764341 C5.0411436,3.96811355 4.9712726,4.02042159 4.90284866,4.07448042 C4.89157281,4.08338639 4.8797933,4.09277659 4.86805733,4.10221872 C4.81544399,4.14455883 4.76415727,4.18754838 4.71376093,4.2315324 C4.69109675,4.25131063 4.66840717,4.2714759 4.64590384,4.29184316 L4.61016998,4.32449924 L4.61016998,4.32449924 L4.47532075,4.45364446 L4.47532075,4.45364446 L2.35414914,2.33216359 L2.359,2.326 L2.36467214,2.32170046 L2.361,2.325 Z",id:"形状结合",fill:"#D9D9D9"}))));var c=this._isLowContrast(a)?"#e8e8e8":a;switch(n){case"t-font-color":e=function(e){return Ie.a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18"},Ie.a.createElement("title",null,"color-font"),Ie.a.createElement("desc",null,"Created with Sketch."),Ie.a.createElement("g",{id:"color-font",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Ie.a.createElement("rect",{fill:e,id:"Rectangle-55",stroke:"none",strokeWidth:"1",x:"2",y:"13.75",width:"12",height:"1.5",rx:"0.125"}),Ie.a.createElement("path",{d:"M5.29102819,11.25 L3.96365715,11.25 C3.87952002,11.25 3.8113134,11.1817934 3.8113134,11.0976562 C3.8113134,11.08076 3.81412419,11.0639814 3.81963067,11.0480076 L7.0756112,1.60269506 C7.09679504,1.5412426 7.15463644,1.5 7.21963767,1.5 L8.81868806,1.5 C8.883726,1.5 8.94159158,1.54128846 8.96274706,1.60278951 L12.2118,11.048102 C12.239168,11.1276636 12.1968568,11.2143472 12.1172952,11.2417152 C12.1013495,11.2472004 12.0846037,11.25 12.067741,11.25 L10.6761419,11.25 C10.6099165,11.25 10.5512771,11.2072154 10.531066,11.1441494 L9.69970662,8.55 L6.27433466,8.55 L5.43599205,11.1444975 C5.41567115,11.2073865 5.35711879,11.25 5.29102819,11.25 Z M8.02635163,3.18571429 L7.96199183,3.18571429 L6.63904023,7.30714286 L9.33500105,7.30714286 L8.02635163,3.18571429 Z",id:"A",fill:"#595959"})))}(r);break;case"t-bg-color":e=function(e,t){return Ie.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ie.a.createElement("g",{id:"控件",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Ie.a.createElement("g",{id:"Z图标/2.编辑器/2.格式/背景色",transform:"translate(-5.000000, -6.000000)"},Ie.a.createElement("g",{id:"编组-9",transform:"translate(-1.000000, 0.000000)"},Ie.a.createElement("mask",{id:"mask-2",fill:"black"},Ie.a.createElement("use",{xlinkHref:"#path-1"})),Ie.a.createElement("circle",{fill:e,stroke:t,strokeWidth:"1",cx:"14",cy:"14",r:"7.5"})))))}(r,a);break;case"stroke-color":e=function(e,t){return Ie.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Ie.a.createElement("title",null,"编组 10"),Ie.a.createElement("g",{id:"控件",stroke:"none",fill:"none",fillRule:"evenodd"},Ie.a.createElement("g",{id:"Z图标/2.编辑器/2.格式/描边",transform:"translate(-6.000000, -8.000000)"},Ie.a.createElement("g",{id:"编组-10",transform:"translate(6.000000, 8.000000)"},Ie.a.createElement("circle",{id:"椭圆形",stroke:t,fill:"none",cx:"8",cy:"8",r:"6.5",strokeWidth:"3"})),Ie.a.createElement("g",{id:"编组-11",transform:"translate(6.000000, 8.000000)"},Ie.a.createElement("circle",{id:"椭圆形2",stroke:e,fill:"none",cx:"8",cy:"8",r:"6.5",strokeWidth:"1"})))))}(a,c);break;case"properties-cb-trans":e=Ie.a.createElement("svg",{width:"90",viewBox:"0 0 90 30",xmlns:"http://www.w3.org/2000/svg"},Ie.a.createElement("path",{d:"M0 30L90 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"}));break;case"context-cb-trans":e=Ie.a.createElement("svg",{width:"30",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg"},Ie.a.createElement("path",{d:"M0 30L30 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"}));break;case"freehand-stroke":e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="#b3b3b3";return"pencil"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pencil")?Ie.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ie.a.createElement("path",{d:"M16.2475842,16.3512937 L16.0279135,16.3959976 L15.8755758,16.4439378 L15.8755758,16.4439378 L15.6885047,16.5214086 L15.5037725,16.6091468 L15.1502378,16.7917247 L14.1582912,17.3270847 C12.5308696,18.169164 11.3207925,18.3244874 10.2613836,17.253022 C9.07268531,16.050796 9.45279022,14.0280592 11.1264226,11.012497 L11.4449119,10.4532344 C11.5557853,10.2631412 11.6713488,10.0693629 11.7915409,9.87186119 L12.1659422,9.26814722 C12.4768539,8.77557644 13.1282051,8.62831267 13.6207759,8.93922439 C14.1133467,9.2501361 14.2606104,9.90148735 13.9496987,10.3940581 L13.606469,10.9483066 L13.2933472,11.4749154 L13.1478871,11.7277362 L13.1478871,11.7277362 L12.8787892,12.2121732 L12.7549996,12.4436944 L12.7549996,12.4436944 L12.5285601,12.8851048 C12.422311,13.0985518 12.3264419,13.3010641 12.2406117,13.492428 L12.0822349,13.8602279 C12.0580359,13.9190293 12.034927,13.9765762 12.0128956,14.0328607 L11.8935358,14.3553545 C11.626955,15.1233988 11.5971181,15.6038285 11.7613521,15.7699316 C11.9337328,15.944274 12.2587181,15.9156574 13.0191883,15.5396003 L13.3553885,15.3660406 L14.0683854,14.9777715 L14.5588768,14.7208035 L14.5588768,14.7208035 L14.8283108,14.5909996 C14.9959703,14.5142859 15.1424127,14.4562192 15.283892,14.4108156 L15.4944206,14.3514596 L15.6411755,14.3193385 L15.6411755,14.3193385 L15.8229221,14.288223 L15.8229221,14.288223 C16.0206409,14.257605 16.2316784,14.2449705 16.3867188,14.2421875 C16.9895921,14.2313658 17.5330764,14.5999486 17.8897979,15.0602489 C18.5859881,15.7413305 18.8037075,17.0609002 18.528112,18.9499392 C18.2631318,20.7662161 19.8942188,21.4062736 22.0220888,20.5801796 C22.4202909,20.4255872 22.8684194,20.6230719 23.0230117,21.0212741 C23.1776041,21.4194762 22.9801193,21.8676047 22.5819172,22.022197 C19.586905,23.1849381 16.6409228,22.0776091 16.9718374,18.9302877 L17.056926,18.2825549 L17.0985526,17.8865412 C17.1398894,17.4151216 17.1382613,17.0537588 17.0932478,16.7824691 C16.9205623,16.4164746 16.7376596,16.3526922 16.3718084,16.3487976 L16.2475842,16.3512937 L16.2475842,16.3512937 Z",stroke:Hf()?t:"#000",strokeWidth:e/3.3,fill:Hf()?t:"#000"})):Ie.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ie.a.createElement("defs",null,Ie.a.createElement("linearGradient",{x1:"6.80751023%",y1:"2.11021409%",x2:"93.1924898%",y2:"100%",id:"linearGradient-1"},Ie.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.7",offset:"0%"}),Ie.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.9",offset:"11.7862402%"}),Ie.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.9",offset:"89.2893774%"}),Ie.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.7",offset:"100%"}))),Ie.a.createElement("g",{id:"马克笔笔触",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinejoin:"round"},Ie.a.createElement("line",{x1:"12",y1:"11",x2:"20.8528558",y2:"20.5249844",id:"路径-3",stroke:Hf()?t:"url(#linearGradient-1)",strokeWidth:e})))}(i,o);break;default:e=null}return Ie.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:this.props.onClick},e)}}]),n}();c()(dx,"propTypes",{className:_e.a.string,type:_e.a.string.isRequired,fill:_e.a.string,stroke:_e.a.string,onClick:_e.a.func,strokeWidth:_e.a.number,pen:_e.a.string}),c()(dx,"defaultProps",{fill:"red"}),rt("/* stylelint-disable */\n.lake-diagram-color-pick-v2-container {\n  z-index: 1050;\n}\n.lake-diagram-color-pick-v2-container .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-color-pick-v2-overlay {\n  z-index: 1051;\n}\n");var fx=function(e){var t,n=e.color,a=e.defaultColor,i=e.disabled,o=e.onClear,c=e.diagram,l=e.transSVG,s=e.onSelect,u=c&&(null==c||null===(t=c.theme)||void 0===t?void 0:t.values.swatches);return Ie.a.createElement(Ke.a,{overlayClassName:"lake-prevent-card-activated lake-diagram-color-pick-v2-container lake-diagram-prevent-mouse-select",disabled:i,trigger:["click"],destroyTooltipOnHide:!0,content:Ie.a.createElement(r.ColorPickerV2,{overlayClassName:"lake-diagram-color-pick-v2-overlay lake-prevent-card-activated lake-diagram-prevent-mouse-select",defaultColor:a,currentColor:n,onSelect:s,onClear:o,swatches:u}),placement:"topRight",getPopupContainer:function(){return document.querySelector(".yuque-sdk-extra-container")||document.body}},!n||function(e){return!e||"transparent"===e||"rgba(255,255,255,0)"===e.replace(/ /g,"")||"rgba(0,0,0,0)"===e.replace(/ /g,"")}(n)?l||Ie.a.createElement("svg",{width:"90",viewBox:"0 0 90 30",xmlns:"http://www.w3.org/2000/svg"},Ie.a.createElement("path",{d:"M0 30L90 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"})):e.children)};rt(".lake-diagram-toolbar-free-hand-container {\n  display: flex;\n  flex-direction: column;\n  align-content: center;\n  margin: auto;\n  background: var(--yq-bg-primary);\n  border-radius: 3px;\n  box-shadow: 0 1px 2px -2px #00000014, 0 2px 6px 0 #0000000a, 0 4px 8px 1px #00000005;\n  border: 1px solid var(--yq-border-primary);\n  pointer-events: initial;\n  padding: 4px 4px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row {\n  width: 32px;\n  height: 32px;\n  border-radius: 3px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row .lake-diagram-toolbar-free-hand-stroke-width {\n  width: 32px;\n  height: 32px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row .lake-icon {\n  font-size: 32px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row:hover {\n  background-color: var(--yq-border-primary);\n}\n"),rt(".lake-diagram-toolbar-free-hand-stroke-container .lake-diagram-toolbar-free-hand-stroke-slider {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 160px;\n}\n");var hx=function(e){var t=e.strokeWidth,n=e.setStrokeWidth,r="lake-diagram-toolbar-free-hand-stroke";return Ie.a.createElement("div",{className:"".concat(r,"-container")},Ie.a.createElement("div",null,zn("粗细")),Ie.a.createElement("div",{className:"".concat(r,"-slider")},Ie.a.createElement(et.a,{style:{width:125},min:1,max:10,step:1,value:t,onChange:function(e){n(e)}}),Ie.a.createElement("div",null,t)))},px=function(e){var t=e.diagram,n=e.boardWebProxy,r=Object(Ne.useState)("pencil"),a=b()(r,2),i=a[0],o=a[1],l=Object(Ne.useState)(Ar),s=b()(l,2),u=s[0],d=s[1],f=Object(Ne.useRef)(null),h=Object(Ne.useState)(2),p=b()(h,2),m=p[0],y=p[1],v=Object(Ne.useState)(!1),g=b()(v,2),x=g[0],k=g[1],w=function(e){e!==Mr&&e!==Lr||(t.settings.freehand.shape=e),o(e)},C=function(e){t.settings.freehand.stroke=e,d(e)},A=function(e){t.settings.freehand.strokeWidth=e,y(e)};Object(Ne.useEffect)((function(){var e,r=function(e){var r=e.target;if(null!=r&&r.classList.contains("lake-icon-board-toolbar-pencil"))t.interaction.changeMode(Sr),w("pencil"),A(2),C("#595959");else if(null!=r&&r.classList.contains("lake-icon-board-toolbar-mark-pencil"))t.interaction.changeMode(Sr),w("mark-pencil"),A(8),C("#DFB85D");else if(null!=r&&r.classList.contains("lake-icon-board-toolbar-eraser")){var a,i;t.interaction.changeMode(jr),null==n||null===(a=n.spm)||void 0===a||null===(i=a.click)||void 0===i||i.call(a,"a385.b4693.c121188.d251469"),w("eraser")}};return null===(e=f.current)||void 0===e||e.addEventListener("click",r),function(){var e;return null===(e=f.current)||void 0===e?void 0:e.removeEventListener("click",r)}}),[]);var O="lake-diagram-toolbar-free-hand",E=function(e){C(e)};return Ie.a.createElement("div",{ref:f,className:"".concat(O,"-container")},Ie.a.createElement("div",{className:ze()("".concat(O,"-row"),c()({},"".concat(O,"-selected"),"pencil"===i))},Ie.a.createElement(qe.a,{placement:"right",title:zn("铅笔")},Ie.a.createElement("span",{className:ze()("lake-icon","lake-icon-board-toolbar-pencil")}))),Ie.a.createElement("div",{className:ze()("".concat(O,"-row"),c()({},"".concat(O,"-selected"),"mark-pencil"===i))},Ie.a.createElement(qe.a,{placement:"right",title:zn("马克笔")},Ie.a.createElement("span",{"data-testid":"free-hand-mark",className:ze()("lake-icon","lake-icon-board-toolbar-mark-pencil")}))),Ie.a.createElement("div",{className:ze()("".concat(O,"-row"),c()({},"".concat(O,"-selected"),"eraser"===i))},Ie.a.createElement(qe.a,{placement:"right",title:zn("橡皮")},Ie.a.createElement("span",{"data-testid":"free-hand-eraser",className:ze()("lake-icon","lake-icon-board-toolbar-eraser")}))),"eraser"!==i&&Ie.a.createElement(Ie.a.Fragment,null,Ie.a.createElement("div",{className:"".concat(O,"-row")},Ie.a.createElement(Ke.a,{trigger:"click",visible:x,onVisibleChange:function(e){k(e)},content:Ie.a.createElement(hx,{strokeWidth:m,setStrokeWidth:A}),placement:"rightTop"},Ie.a.createElement("div",{className:"".concat(O,"-stroke-width")},Ie.a.createElement(qe.a,{placement:"right",title:zn("粗细")},Ie.a.createElement("div",null,Ie.a.createElement(dx,{type:"freehand-stroke",strokeWidth:m,pen:i,onClick:function(){return k(!x)}})))))),Ie.a.createElement("div",{className:"".concat(O,"-row")},Ie.a.createElement(fx,{color:u,defaultColor:Ar,onSelect:E,onClear:function(){return E("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ie.a.createElement(dx,{type:"context-cb-trans"})},Ie.a.createElement(qe.a,{placement:"right",title:zn("颜色")},Ie.a.createElement("div",null,Ie.a.createElement(dx,{type:"t-bg-color",fill:u})))))))},mx={basic:"a385.b4693.c111722.d231218",flowchart:"a385.b4693.c111722.d231226",UML:"a385.b4693.c111722.d231225",ER:"a385.b4693.c111722.d231227",swimlane:"a385.b4693.c111722.d231186",DSL:{pyramid:"ca33306.da22351","segmented pyramid":"ca33306.da22352",stage:"ca33306.da22353",architecture:"ca33306.da22354"}},yx=function(e,t){if(e){var n=oc.find((function(e){return e.name===t}));if(n)if("DSL"===n.category){var r=mx[n.category];e.click(r[t])}else e.click(mx[n.category],{shape:t})}};function vx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bx(e){var t=e.diagram,n=e.mini,r=e.onProperties,a=e.onSave,i=Object(Ne.useState)([]),o=b()(i,2),c=o[0],l=o[1];return Object(Ne.useEffect)((function(){if(t){var n=function(){var t=function(e){var t=e.focusMode,n=e.mini,r=e.readOnly,a=e.showProperties,i=e.boardWebProxy,o=function(e){var t=e.diagram,n=e.mini,r=e.boardWebProxy;return[{align:"top-left",subItems:[{name:"save",type:"button",title:zn("保存"),hotkey:U.ua.macos?"⌘+S":"Ctrl+S",noMini:!0,noReadOnly:!0,icon:"board-save",disabled:!1,execCommand:function(){return e.onSave&&e.onSave()}},{type:"separator",noMini:!0,noReadOnly:!0},{name:"undo",type:"button",title:zn("撤销"),hotkey:U.ua.macos?"⌘+Z":"Ctrl+Z",icon:"board-undo",noMini:!0,noReadOnly:!0,disabled:function(e){return!e.command.enable("Undo")},execCommand:function(e){return e.command.execute("Undo")}},{name:"redo",title:zn("重做"),hotkey:U.ua.macos?"⌘+Shift+Z":"Ctrl+Shift+Z",icon:"board-redo",noMini:!0,noReadOnly:!0,disabled:function(e){return!e.command.enable("Redo")},execCommand:function(e){return e.command.execute("Redo")}}],focusHidden:!0},{align:"top-right",subItems:[{name:"hand",type:"button",title:zn("拖拽"),noReadOnly:!0,hotkey:"Space",icon:"board-hand",active:function(e){return"dragCanvas"===e.interaction.currentMode},disabled:function(e){return!e.command.enable("ButtonDragCanvas")},execCommand:function(e){return e.command.execute("ButtonDragCanvas")}},{type:"separator",noReadOnly:!0},{name:"fitViewport",type:"button",title:zn("适应画布"),hotkey:U.ua.macos?"⌘+Shift+=":"Ctrl+Shift+=",icon:"board-viewport-autofit",disabled:function(){return!1},execCommand:function(e){return e.command.execute("FitViewport")}},{type:"separator",noReadOnly:!0},{type:"custom",component:Ie.a.createElement(Eb,{diagram:t}),show:function(){return!(n&&U.ua.mobile)}}],focusHidden:!0},{align:"top-right",subItems:[{name:"theme",type:"popover",title:zn("更换主题"),noReadOnly:!0,popoverPlacement:"bottomRight",icon:"board-toolbar-theme",overlay:function(e){var n=e.popoverVisible;return Ie.a.createElement("div",{className:"lake-board-toolbar-theme-setting"},Ie.a.createElement(Zb,{diagram:t}),Ie.a.createElement(Yb,{diagram:t,popoverVisible:n}))}},{name:"properties",type:"button",title:zn("打开设置"),noReadOnly:!0,icon:"board-setting",disabled:function(){return!1},execCommand:function(){e.onProperties&&e.onProperties()},noMini:!0}],focusHidden:!0},{align:"top-right",subItems:[{name:"focusmode",type:"button",title:zn("隐藏工具栏"),hotkey:U.ua.macos?"⌘+.":"Ctrl+.",noMini:!1,noReadOnly:!0,noMaxim:!1,icon:"board-toolbar-hide",disabled:!1,execCommand:function(){return e.setFocusMode&&e.setFocusMode(!0)}}],focusHidden:!0},{align:"top-right",subItems:[{name:"focusmode",type:"button",title:zn("展开工具栏"),hotkey:U.ua.macos?"⌘+.":"Ctrl+.",noMini:!1,noReadOnly:!0,noMaxim:!1,icon:"board-toolbar-show",disabled:!1,execCommand:function(){return e.setFocusMode&&e.setFocusMode(!1)}}],focusHidden:!1},{align:"left-middle",subItems:[{type:"button",name:"material",title:zn("素材库"),noReadOnly:!0,icon:Ie.a.createElement("span",{className:"lake-board-toolbar-material-icon",style:{backgroundImage:Hf()?"url(https://gw.alipayobjects.com/zos/bmw-prod/b0db2f07-dfa1-4ae8-86bc-baa44c9e42b1.svg)":"url(https://gw.alipayobjects.com/zos/bmw-prod/4bdfc4e6-e50c-493b-a809-33016c1f95e2.svg)"}}),execCommand:function(){var t;null!==(t=window.yuqueNetworkStatus)&&void 0!==t&&t.onLine?null==e||e.onMaterialMaximize():ne.a.warn(zn("离线状态该功能不可用"))}},{name:"iconfont",title:zn("插入 Iconfont"),type:"popover",noReadOnly:!0,icon:"board-iconfont",overlay:function(n){var r=n.setPopoverVisible;return Ie.a.createElement(Db,{diagram:t,boardWebProxy:null==e?void 0:e.boardWebProxy,onSelect:function(){r(!1)}})}},{type:"separator",noReadOnly:!0},{name:"hand",type:"button",title:"".concat(zn("选择")," V"),noReadOnly:!0,icon:"board-toolbar-select",active:function(e){return"edit"===e.interaction.currentMode},execCommand:function(e){"edit"!==e.interaction.currentMode&&e.interaction.changeMode("edit")}},{type:"popover",name:"free-hand",title:zn("画笔"),className:t.interaction.currentMode===Sr||t.interaction.currentMode===jr?"lake-diagram-toolbar-selected":"",icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-board-toolbar-free-hand"}),noReadOnly:!0,overlay:function(){return Ie.a.createElement(px,{diagram:t,boardWebProxy:r})},execCommand:function(e){return e.interaction.changeMode("free-hand")},onClick:function(){t.interaction.changeMode("free-hand")}},{type:"button",name:"pen",title:zn("矢量绘图"),active:function(e){return e.interaction.currentMode===Pr},icon:Ie.a.createElement("span",{"data-testid":"toolbar-pen",className:"lake-icon lake-icon-board-toolbar-pen"}),noReadOnly:!0,execCommand:function(e){var t;e.penDrawInteract.clearCache(),null===(t=e.interaction)||void 0===t||t.changeMode("pen")}},{type:"button",name:"insertText",title:zn("文本"),noReadOnly:!0,hotkey:"T",icon:"board-insert-text",disabled:function(e){return!e.command.enable("BeginInsertText")},execCommand:function(e){return e.command.execute("BeginInsertText")}},{name:"board:insertShape",title:zn("图形"),hotkey:"S",type:"popover",noReadOnly:!0,icon:"board-insert-shape",execCommand:function(e){return e.command.execute("BeginInsertGeometry")},overlay:function(e){var n=e.onSelect,r=e.setPopoverVisible,a=e.popoverVisible;return Ie.a.createElement(fb,{diagram:t,basicWithSwimlane:!0,groups:["basic","flowchart","DSL","UML","ER"],onSelect:function(r){var a,i=r.key,o=r.attr;n({key:i}),yx(null==e||null===(a=e.boardWebProxy)||void 0===a?void 0:a.spm,i),t.command.execute("BeginInsertGeometry",{shape:i,attr:o})},hide:function(){r(!1)},popoverVisible:a})}},{type:"popover",name:"insertEdge",title:zn("连线"),hotkey:U.ua.macos?"⌘+L":"Ctrl+L",defaultKey:"straight-line-arrow",icon:"board-straight-line-arrow",noReadOnly:!0,disabled:function(e){return!e.command.enable("BeginInsertLine")},data:[{key:"straight-line-arrow",icon:"board-straight-line-arrow"},{key:"curve-line-arrow",icon:"board-curve-line-arrow"},{key:"elbow-line-arrow",icon:"board-elbow-line-arrow"}],onClick:function(){t.selector.clear(),t.command.execute("BeginInsertLine",t.settings.line)},onSelect:function(e){var n=e.key.split("-"),r=b()(n,3),a=r[0],i=r[2];t.command.execute("BeginInsertLine",{shape:a,marker:i})}},{type:"button",name:"insertMindmap",title:zn("思维导图"),hotkey:"M",icon:"board-mind",noReadOnly:!0,disabled:function(e){return!e.command.enable("MindmapBeginInsertStem")},execCommand:function(e){return e.command.execute("MindmapBeginInsertStem")}},{type:"separator",noReadOnly:!0},{name:"insertImage",title:zn("图片"),type:"upload",icon:"board-upload-image",noReadOnly:!0,accept:U.EXTS.IMAGE_EXT.map((function(e){return"."+e})).join(","),disabled:!1,onChange:function(e){Kb(e,t)}}],focusHidden:!0}]}(e).map((function(e){if(t===e.focusHidden)return null;var o=e.subItems.filter((function(e){return e.show instanceof Function?e.show():!(n&&e.noMini||!n&&e.noMaxim||r&&e.noReadOnly||"properties"===e.name&&a||!("material"!==e.name||null!=i&&i.material)||"iconfont"===e.name&&(null==i||!i.iconfont||null!=i&&null!==(t=i.iconfont)&&void 0!==t&&t.disable));var t}));return o.length>0?gx(gx({},e),{},{subItems:o}):null}));return o.filter((function(e){return e}))}(e);l(t)};n();var r=function(e){e.isModelChange&&n()};return t.on("aftercommandexecute",r),t.on("aftermodechange",n),function(){t.off("aftercommandexecute",r),t.off("aftermodechange",n)}}return function(){return!1}}),[t,n,r,a]),Ie.a.createElement(ux,{diagram:t,items:c,className:"lake-diagram-board-toolbar"})}function xx(e){var t=e.icon,n=e.title,r=e.hotkey;return Ie.a.createElement("div",null,t,n,r&&Ie.a.createElement("span",{className:"lake-context-menu-hotkey"},r))}function kx(e){var t=e.title,n=e.hotkey,r=e.accept,a=e.icon,i=e.onChange,o=Object(Ne.useRef)();return Ie.a.createElement("div",{className:"lake-board-context-menu-upload-item-content",onClick:function(e){e.stopPropagation(),o.current.click()}},a,t,n&&Ie.a.createElement("span",{className:"lake-context-menu-hotkey"},n),Ie.a.createElement("input",{type:"file",accept:r,onChange:i,ref:o}))}function wx(e,t){var n=e.disabled,r=e.title,a=e.key,i=e.hotkey,o=e.type,c=e.accept,l=e.onChange;if(e.data)return Ie.a.createElement(Ve.a.SubMenu,{key:a,title:r,disabled:n,popupClassName:"lake-context-submenu lake-prevent-card-activated lake-diagram-dialog-popover lake-diagram-prevent-mouse-select"},e.data.map(wx));if("separator"===o)return Ie.a.createElement(Ve.a.Divider,{key:a+"_"+t});var s,u="string"==typeof e.icon?Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon)}):e.icon;return s="upload"===o?Ie.a.createElement(kx,{icon:u,title:r,hotkey:i,accept:c,onChange:l}):Ie.a.createElement(xx,{icon:u,title:r,hotkey:i}),Ie.a.createElement(Ve.a.Item,{key:a,className:"ant-menu-item",disabled:n},s)}function Cx(e){var t=e.coord,n=e.overlayClassName,r=e.diagram,a=e.onClose,i=Object(Ne.useState)(null),o=b()(i,2),c=o[0],l=o[1],s=Object(Ne.useRef)();if(Object(Ne.useEffect)((function(){if(t){var e=s.current.offsetParent.getBoundingClientRect();l([t[0]-e.x,t[1]-e.y])}else l(null)}),[t]),Object(Ne.useEffect)((function(){function e(){a()}function t(t){t.target.closest(".lake-diagram-dialog-popover")||e()}function n(){e()}return window.addEventListener("mousedown",t),window.addEventListener("scroll",e,{passive:!0}),r.on("afterviewportchange",n),function(){window.removeEventListener("mousedown",t),window.removeEventListener("scroll",e),r.off("afterviewportchange",n)}}),[r,a]),c){var u="lake-diagram-dialog-popover lake-prevent-card-activated lake-diagram-prevent-mouse-select lake-diagram-prevent-mouseleave-reset-focus-point";return Ie.a.createElement(Ke.a,De()({},e,{getPopupContainer:function(){return e.getPopupContainer?e.getPopupContainer():document.querySelector(".yuque-sdk-extra-container")||document.body},visible:!0,overlayClassName:n?n+" "+u:u}),Ie.a.createElement("div",{ref:s,style:{position:"absolute",left:"".concat(c[0],"px"),top:"".concat(c[1],"px"),pointerEvents:"none",width:"0px",height:"0px"}}))}return Ie.a.createElement("span",{ref:s})}function Ax(e){var t=e.getMenuData,n=e.diagram,r=e.boardWebProxy,a=Object(Ne.useState)(e.coord),i=b()(a,2),o=i[0],c=i[1],l=Object(Ne.useState)(t()),s=b()(l,2),u=s[0],d=s[1],f=Object.keys(e).reduce((function(t,n){return n.startsWith("data-")&&(t[n]=e[n]),t}),{});Object(Ne.useEffect)((function(){function e(e){d(t()),c([e.clientX,e.clientY])}return n.on("contextmenu",e),function(){n.off("contextmenu",e)}}),[n]);var h=Ie.a.createElement("div",De()({},f,{className:ze()("lake-context-menu",e.className)}),Ie.a.createElement(Ve.a,{className:"lake-context-submenu",onMouseDown:function(e){e.preventDefault()},onClick:function(t){var r=n.viewport.invertClient(o);e.onClick({key:t.key,canvasPoint:r}),c(null)},selectable:!1},u.map(wx)));return Ie.a.createElement(Cx,{placement:"rightTop",content:h,visible:!0,overlayClassName:"lake-diagram-context-menu-popover ne-ignore-pointer-events",diagram:n,coord:o,onClose:function(){c(null)},boardWebProxy:r})}rt("/* stylelint-disable */\n.lake-board-toolbar-material-icon {\n  width: 24px;\n  height: 24px;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.ant-btn > span.lake-board-toolbar-material-icon {\n  display: block;\n}\n.lake-diagram-toolbar-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-board-toolbar-theme-setting {\n  border-radius: 8px;\n  background: var(--yq-bg-primary);\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n}\n"),bx.defaultProps={mini:!1,readOnly:!1,diagram:null,showProperties:!0,boardWebProxy:{},onProperties:function(){return!1},onSave:function(){return!1},onMaterialUse:function(){return!1},onMaterialMore:function(){return!1},onMaterialMaximize:function(){return!1}},bx.propTypes={mini:_e.a.bool,readOnly:_e.a.bool,diagram:_e.a.object,showProperties:_e.a.bool,onProperties:_e.a.func,onSave:_e.a.func,focusMode:_e.a.bool,setFocusMode:_e.a.func,boardWebProxy:_e.a.object,onMaterialMore:_e.a.func,onMaterialUse:_e.a.func,onMaterialMaximize:_e.a.func},xx.propTypes={title:_e.a.string,hotkey:_e.a.string,icon:_e.a.node},rt(".lake-board-context-menu-upload-item-content input {\n  display: none;\n}\n"),kx.propTypes={title:_e.a.string,hotkey:_e.a.string,icon:_e.a.oneOf([_e.a.string,_e.a.node]),data:_e.a.arrayOf(_e.a.object),onChange:_e.a.func,accept:_e.a.string},wx.propTypes={title:_e.a.string,key:_e.a.string,hotkey:_e.a.string,type:_e.a.string,disabled:_e.a.bool,icon:_e.a.oneOf([_e.a.string,_e.a.node]),data:_e.a.arrayOf(_e.a.object),onChange:_e.a.func,accept:_e.a.string},rt("/* stylelint-disable */\n.lake-diagram-dialog-popover .ant-popover-inner-content {\n  padding: 0;\n}\n"),Cx.defaultProps={coord:null,diagram:null,onClose:function(){}},Cx.propTypes={coord:_e.a.array,diagram:_e.a.object,onClose:_e.a.func,overlayClassName:_e.a.string,getPopupContainer:_e.a.object},rt("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-context-menu-popover {\n  z-index: 1033;\n}\n.lake-diagram-context-menu-popover .ant-popover-arrow {\n  display: none;\n}\n.lake-context-menu {\n  z-index: 13;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.13);\n}\n.lake-context-menu,\n.lake-context-submenu {\n  list-style-type: none !important;\n}\n.lake-context-menu li,\n.lake-context-submenu li {\n  margin-left: 0 !important;\n}\n.lake-context-menu .ant-menu,\n.lake-context-submenu .ant-menu {\n  border-radius: 2px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-context-menu .ant-menu .ant-menu-submenu,\n.lake-context-submenu .ant-menu .ant-menu-submenu,\n.lake-context-menu .ant-menu .ant-menu-item,\n.lake-context-submenu .ant-menu .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  min-width: 164px;\n}\n.lake-context-menu .ant-menu .ant-menu-item-active,\n.lake-context-submenu .ant-menu .ant-menu-item-active,\n.lake-context-menu .ant-menu .ant-menu-submenu-active,\n.lake-context-submenu .ant-menu .ant-menu-submenu-active {\n  background: var(--yq-bg-tertiary);\n  color: var(--yq-text-body);\n}\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-title,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-title {\n  height: auto;\n  line-height: inherit;\n  color: var(--yq-text-body);\n}\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::before,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::before,\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::after,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::after {\n  width: 5px;\n  height: 1px;\n  background-image: linear-gradient(90deg, var(--yq-yuque-grey-900), var(--yq-yuque-grey-900));\n}\n.lake-context-menu .ant-menu.ant-menu-vertical .ant-menu-item,\n.lake-context-submenu .ant-menu.ant-menu-vertical .ant-menu-item {\n  margin-bottom: 4px;\n}\n.lake-context-menu .ant-menu.ant-menu-vertical .ant-menu-submenu,\n.lake-context-submenu .ant-menu.ant-menu-vertical .ant-menu-submenu {\n  margin-bottom: 4px;\n}\n.lake-context-menu .ant-menu.ant-menu-sub,\n.lake-context-submenu .ant-menu.ant-menu-sub {\n  width: auto;\n}\n.lake-context-menu .ant-menu.ant-menu-sub > li,\n.lake-context-submenu .ant-menu.ant-menu-sub > li {\n  width: auto;\n}\n.lake-context-menu .lake-icon,\n.lake-context-submenu .lake-icon {\n  display: inline-block;\n  margin-right: 0.25em;\n}\n.lake-context-menu-hotkey {\n  float: right;\n  color: var(--yq-text-caption);\n  margin-left: 16px;\n}\n"),Ax.defaultProps={},Ax.propTypes={className:_e.a.string,coord:_e.a.object,data:_e.a.arrayOf(_e.a.object),onClick:_e.a.func,diagram:_e.a.object,getMenuData:_e.a.func,boardWebProxy:_e.a.object};var Ox=[{key:"Align",title:zn("对齐"),data:[{key:"AlignLeft",icon:"align-left",title:zn("左对齐"),hotkey:"Option+←"},{key:"AlignHCenter",icon:"align-h-center",title:zn("左右居中"),hotkey:"Option+H"},{key:"AlignRight",icon:"align-right",title:zn("右对齐"),hotkey:"Option+→"},{key:"DistributeHorizontally",icon:"distribute-horizontally",title:zn("水平均分")},{type:"separator"},{key:"AlignTop",icon:"align-top",title:zn("顶对齐"),hotkey:"Option+↑"},{key:"AlignVCenter",icon:"align-v-center",title:zn("上下居中"),hotkey:"Option+V"},{key:"AlignBottom",icon:"align-bottom",title:zn("底对齐"),hotkey:"Option+↓"},{key:"DistributeVertically",icon:"distribute-vertically",title:zn("垂直均分")}]},{key:"ZIndex",title:zn("层级"),data:[{key:"ToFront",title:zn("置顶"),hotkey:"⌘+]"},{key:"ToBack",title:zn("置底"),hotkey:"⌘+["},{key:"Forward",title:zn("上移一层"),hotkey:"\t⌘+Option+]"},{key:"Backward",title:zn("下移一层"),hotkey:"⌘+Option+["}]},{key:"AttachToVertex",title:zn("插入"),data:[{key:"AttachLink",title:zn("链接"),hotkey:"⌘+K"}]},{key:"MindmapAppendAbstract",title:zn("添加概要")},{key:"AttachToMindmapCell",title:zn("插入"),data:[{key:"MindmapAppendChild",title:zn("子级"),hotkey:"Tab"},{key:"MindmapAppendParent",title:zn("父级"),hotkey:"Option+Tab"},{key:"MindmapAppendSibling",title:zn("同级"),hotkey:"Enter"},{key:"separator",type:"separator"},{key:"AttachLink",title:zn("链接"),hotkey:"⌘+K"},{key:"MindmapAttachImage",title:zn("图片"),type:"upload",accept:U.EXTS.IMAGE_EXT.map((function(e){return"."+e})).join(",")},{key:"MindmapAttachNote",title:zn("备注")}]},{key:"Cut",title:zn("剪切"),hotkey:"⌘+X"},{key:"Copy",title:zn("复制"),hotkey:"⌘+C"},{key:"CopyOtherFormat",title:zn("复制为其它格式"),data:[{key:"CopyDoc",title:zn("语雀文档")},{key:"CopyTable",title:zn("语雀表格")}]},{key:"Paste",title:zn("粘贴"),hotkey:"⌘+V"},{key:"Collapse",title:zn("折叠"),hotkey:"⌘+/"},{key:"Expand",title:zn("展开"),hotkey:"⌘+/"},{key:"MindmapAppendParent",title:zn("插入父级"),hotkey:"Option+Tab"},{key:"MindmapInsertStem",title:zn("添加思维导图"),hotkey:"M"},{key:"MindmapAppendSibling",title:zn("插入同级"),hotkey:"Enter"},{key:"MindmapAppendChild",title:zn("插入子级"),hotkey:"Tab"},{key:"ActualSize",title:zn("实际尺寸"),hotkey:"⌘+0"},{key:"FitViewport",title:zn("适应画布"),hotkey:"⌘+Shift+="},{key:"Delete",title:zn("删除"),hotkey:"Delete"},{key:"MindmapRemoveSingleNode",title:zn("删除单个节点"),hotkey:"⌘+Delete"},{key:"BeginInsertLine",title:zn("添加连线"),hotkey:"⌘+L"},{key:"BeginEditContent",title:zn("编辑文本")},{key:"separator",type:"separator"},{key:"InsertText",title:zn("添加文字"),hotkey:"T"},{key:"InsertGeometry",title:zn("添加图形"),hotkey:"S"},{key:"MakeGroup",title:zn("成组"),hotkey:"⌘+G"},{key:"Ungroup",title:zn("取消成组"),hotkey:"⌘+Shift+G"},{key:"AddMaterialLib",title:zn("添加到素材库")},{key:"SaveImage",title:zn("另存为图片")}],Ex={};function Px(e,t){Ex[e]=t}function Sx(e){return Ex[e]}function jx(e){return Rx.apply(this,arguments)}function Rx(){return(Rx=G()(V.a.mark((function e(t){var n,r,a,i,o,c,l;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.arrayBuffer();case 3:return n=e.sent,e.next=6,crypto.subtle.digest("SHA-256",n);case 6:return r=e.sent,a=Array.from(new Uint8Array(r)),i=a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""),e.abrupt("return",i);case 12:return e.prev=12,e.t0=e.catch(0),e.next=16,t.arrayBuffer();case 16:return o=e.sent,c=Array.from(new Uint8Array(o)),l=c.map((function(e){return e.toString(16).padStart(2,"0")})).join(""),e.abrupt("return",l.length>100&&l.substring(l.length-100,l.length));case 20:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function Mx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bx(e,t){return e.every((function(t){return e.includes(t.stem)}))?t.deduplicate(e).filter((function(e){return e.isStem})):[]}function Dx(e,t,n){return Nx.apply(this,arguments)}function Nx(){return(Nx=G()(V.a.mark((function e(t,n,r){var a,i,o,c,l,s,u,d,f,h;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.destroyed){e.next=2;break}return e.abrupt("return");case 2:return t=Bx(t,n),a=t.reduce((function(e,t){return t.deepEach((function(t){e.push(t)})),e}),[]),e.next=6,n.exporter.blob("png",{cells:a,width:220});case 6:if(i=e.sent){e.next=10;break}return ne.a.warn(zn("导出素材图片失败")),e.abrupt("return",!1);case 10:return o=Object(F.a)(),ne.a.loading({content:zn("上传素材中"),key:o,duration:0}),c=Array.from(new Set(t.map((function(e){var t,n,r;return e.isImage&&(null===(t=e.model)||void 0===t||null===(n=t.image)||void 0===n||null===(r=n.uploadInfo)||void 0===r?void 0:r.hash)})))),l=c.map((function(e){var t;return null===(t=Sx(e))||void 0===t?void 0:t.imageCdnPromise})),e.next=16,Promise.all(l);case 16:return s=new File([i],"lake_board_material.jpeg"),e.next=19,r.uploader.image(s);case 19:if(u=e.sent,ne.a.destroy(o),u){e.next=24;break}return ne.a.warn(zn("上传素材图片失败")),e.abrupt("return",!1);case 24:return d=n.exporter.json(t),f=Tn(a),e.next=28,r.material.create({cover:u,diagramData:d,graphicsBBox:Lx(Lx({},f),{},{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY})});case 28:return h=e.sent,e.abrupt("return",h);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ix(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ix(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ix(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}window.___lakeDiagramUploadFileHashMap=Ex;var _x=Ox.reduce((function(e,t){var n;return e[t.key]=t,t.hotkey&&(t.hotkey=(n=t.hotkey,U.ua.macos?n:n.replace(/⌘/g,"Ctrl").replace(/Option/g,"Alt"))),e}),{});function Fx(e,t){var n=e.key;e.disabled=!!t.command.find(n)&&!t.command.enable(n),"MindmapAttachImage"===n&&(e.onChange=function(e){Kb(e,t)})}function zx(e,t){return(e=e.filter((function(e){return null!=e}))).map((function(e,n){var r=Tx(Tx({},s()(_x[e])),{},{disabled:!!t.command.find(e)&&!t.command.enable(e)});return Fx(r,t),r.data&&r.data.forEach((function(e){Fx(e,t)})),"separator"===e&&(r.key=e+"-"+n),r}))}function qx(e){return e.command.enable("Expand")?["Expand"]:["Collapse"]}function Yx(e){var t=[],n=e.filter((function(e){return e.isStem}));return n.length>1&&t.push("Align"),n.length>0&&t.push("ZIndex"),t.length>0?t.push("separator"):t=null,t}function Hx(e){var t=[];return e.filter((function(e){return e.isStem})).length>1?(t.push("MakeGroup"),t.push("separator")):t=null,t}function Gx(e,t,n){var r=Bx(e,t),a=[];return e.length>0&&a.push("SaveImage"),n&&r.length>0&&!function(e){for(var t=e.reduce((function(e,t){return t.deepEach((function(t){e.push(t)})),e}),[]),n=t.reduce((function(e,t){return e[t.model.id]=t,e}),{}),r=t.filter((function(e){return e.isLine})),a=0;a<r.length;a++){var i,o,c,l,s=r[a],u=null===(i=s.model)||void 0===i||null===(o=i.target)||void 0===o?void 0:o.id,d=null===(c=s.model)||void 0===c||null===(l=c.source)||void 0===l?void 0:l.id;if(u&&!n[u]||d&&!n[d])return!0}return!1}(r)&&a.push("AddMaterialLib"),a.length>0?(a.push("separator"),a):null}function Xx(){return(Xx=G()(V.a.mark((function e(t,n,r,a){var i,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dx(t,n,r);case 2:(i=e.sent)&&((o=r.spm)&&o.click("b4693.c107432.d223055",{material_id:null==i?void 0:i.id}),a&&a(null==i?void 0:i.id));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vx(e){try{Sc("copy",e),ne.a.success(zn("复制成功"))}catch(e){ne.a.error(zn("复制失败"))}}function Wx(e){var t=e.diagram,n=e.boardWebProxy,r=e.onAddMaterial,a=!(null==n||!n.material);return Ie.a.createElement(Ax,{diagram:t,getMenuData:function(){return function(e,t){var n=t.materialLibEnable;return"read"===e.interaction.currentMode?function(e){var t=e.selector.selections,n=["ActualSize","FitViewport"];return t.length>0&&t.every((function(e){return e.isMindmap}))&&(n=["Copy"].concat(qx(e)).concat(["separator"]).concat(n)),zx(n,e)}(e):function(e,t){var n=e.selector.selections,r=[];return 0===n.length?r=["InsertText","InsertGeometry","BeginInsertLine","MindmapInsertStem","separator","Paste","separator","ActualSize","FitViewport"]:n.every((function(e){return e.isMindmap}))?(1===n.length&&(r=["AttachToMindmapCell","separator"]),gy(n,!0)&&r.push("MindmapAppendAbstract","separator"),r=r.concat(qx(e)).concat(["separator","Cut","Copy","CopyOtherFormat","Paste","separator"]).concat(Gx(n,e,t)).concat(Yx(n)).concat(Hx(n)).concat(["Delete","MindmapRemoveSingleNode"])):n.every((function(e){return e.isVertex}))?(1!==n.length||n[0].isImage||(r=["AttachToVertex","separator"]),r=r.concat(["Cut","Copy","Paste","separator"]).concat(Gx(n,e,t)).concat(Yx(n)).concat(Hx(n)).concat(["Delete"])):r=n.every((function(e){return e.isGroup}))?r.concat(["Cut","Copy","Paste","separator"]).concat(Gx(n,e,t)).concat(Yx(n)).concat(Hx(n)).concat(["Ungroup","separator"]).concat(["Delete"]):["Cut","Copy","Paste","separator"].concat(Gx(n,e,t)).concat(Yx(n)).concat(Hx(n)).concat(["Delete"]),zx(r,e)}(e,n)}(t,{materialLibEnable:a})},boardWebProxy:n,onClick:function(e){var a=e.key,i=e.canvasPoint;t.tryFocus();var o=t.selector.selections;switch(a){case"Cut":!function(e){try{Sc("cut",e),ne.a.success(zn("剪切成功"))}catch(e){ne.a.error(zn("剪切失败"))}}(t);break;case"Copy":Vx(t);break;case"CopyDoc":t.settings.copyType="doc",Vx(t),t.settings.copyType="default";break;case"CopyTable":t.settings.copyType="table",Vx(t),t.settings.copyType="default";break;case"Paste":!function(e,t){try{Sc("paste",e,t)}catch(e){ne.a.error(zn("粘贴失败"))}}(t,i);break;case"MindmapInsertStem":t.command.execute("MindmapInsertStem",{x:i[0],y:i[1]});break;case"InsertText":t.command.execute("InsertText",{x:i[0],y:i[1]});break;case"InsertGeometry":t.command.execute("InsertGeometry",{x:i[0],y:i[1]});break;case"AddMaterialLib":!function(e,t,n,r){Xx.apply(this,arguments)}(o,t,n,r);break;case"SaveImage":!function(e,t){t.exporter.download("png",{cells:Ac(e,t)})}(o,t);break;default:if(a)try{"MindmapAppendAbstract"===a&&n&&n.spm&&n.spm.click("b4693.c116586.d241682",{"right-click(MindmapAppendAbstract)":1}),t.command.execute(a)}catch(e){throw new Error("unknown command ".concat(a))}}t.tryFocus()}})}function Zx(e){var t=e.diagram;return Ie.a.createElement("div",{className:"lake-diagram-properties-alignment"},Ie.a.createElement(Qe.a.Group,{onChange:function(e){t.command.execute(e.target.value)},value:null},Ie.a.createElement(Qe.a.Button,{value:"AlignLeft",disabled:!t.command.enable("AlignLeft")},Ie.a.createElement("span",{className:"lake-icon lake-icon-align-left"})),Ie.a.createElement(Qe.a.Button,{value:"AlignHCenter",disabled:!t.command.enable("AlignHCenter")},Ie.a.createElement("span",{className:"lake-icon lake-icon-align-h-center"})),Ie.a.createElement(Qe.a.Button,{value:"AlignRight",disabled:!t.command.enable("AlignRight")},Ie.a.createElement("span",{className:"lake-icon lake-icon-align-right"})),Ie.a.createElement(Qe.a.Button,{value:"AlignTop",disabled:!t.command.enable("AlignTop")},Ie.a.createElement("span",{className:"lake-icon lake-icon-align-top"})),Ie.a.createElement(Qe.a.Button,{value:"AlignVCenter",disabled:!t.command.enable("AlignVCenter")},Ie.a.createElement("span",{className:"lake-icon lake-icon-align-v-center"})),Ie.a.createElement(Qe.a.Button,{value:"AlignBottom",disabled:!t.command.enable("AlignBottom")},Ie.a.createElement("span",{className:"lake-icon lake-icon-align-bottom"}))))}function Ux(e){var t=e.selections,n=e.diagram,r=t.filter((function(e){return e.canArrange()})).length<3;return Ie.a.createElement("div",{className:"lake-diagram-properties-distribute"},Ie.a.createElement(Qe.a.Group,{onChange:function(e){n.command.execute(e.target.value)},value:null},Ie.a.createElement(Qe.a.Button,{value:"DistributeHorizontally",disabled:r},Ie.a.createElement("span",{className:"lake-icon lake-icon-horizontally"})),Ie.a.createElement(Qe.a.Button,{value:"DistributeVertically",disabled:r},Ie.a.createElement("span",{className:"lake-icon lake-icon-vertically"}))),Ie.a.createElement("div",{className:"lake-diagram-properties-distribute-label-group"},Ie.a.createElement("span",{className:"lake-diagram-properties-distribute-label"},zn("水平均分")),Ie.a.createElement("span",{className:"lake-diagram-properties-distribute-label"},zn("垂直均分"))))}function Kx(e){var t=e.diagram,n=e.selections,r=t.getCells(),a=n.some((function(e){return e.locked}))||1===n.length&&n[0].getZIndex()===r.length-1,i=n.some((function(e){return e.locked}))||1===n.length&&0===n[0].getZIndex();function o(r){e.onChange((function(){t.command.execute(r.target.value,{cells:n})}))}return Ie.a.createElement("div",{className:"lake-diagram-properties-z-index"},Ie.a.createElement("div",{className:"lake-diagram-properties-z-index-btn-group"},Ie.a.createElement(Qe.a.Group,{onChange:o,value:null},Ie.a.createElement(qe.a,{title:zn("置顶")},Ie.a.createElement(Qe.a.Button,{value:"ToFront",disabled:a},Ie.a.createElement("span",{className:"lake-icon lake-icon-to-front"}))),Ie.a.createElement(qe.a,{title:zn("置底")},Ie.a.createElement(Qe.a.Button,{value:"ToBack",disabled:i},Ie.a.createElement("span",{className:"lake-icon lake-icon-to-back"}))))),Ie.a.createElement("div",{className:"lake-diagram-properties-z-index-btn-group"},Ie.a.createElement(Qe.a.Group,{onChange:o,value:null},Ie.a.createElement(qe.a,{title:zn("上移")},Ie.a.createElement(Qe.a.Button,{value:"Forward",disabled:a},Ie.a.createElement("span",{className:"lake-icon lake-icon-forward"}))),Ie.a.createElement(qe.a,{title:zn("下移")},Ie.a.createElement(Qe.a.Button,{value:"Backward",disabled:i},Ie.a.createElement("span",{className:"lake-icon lake-icon-backward"}))))))}function Qx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qx(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $x(e){var t=e,n=t.onBlur,r=t.onPressEnter,a=t.onStep,i=t.value,o=Object(Ne.useState)(null),c=b()(o,2),l=c[0],s=c[1];return e=Jx(Jx({},e),{},{value:"number"==typeof l?l:i,onChange:function(e){s(e)},onBlur:function(e){s(null),n&&n(e)},onPressEnter:function(e){s(null),r&&r(e)},onStep:function(e){s(null),a&&a(e)}}),$x.propTypes={value:_e.a.number,onStep:_e.a.func,onBlur:_e.a.func,onPressEnter:_e.a.func},Ie.a.createElement(Je.a,e)}function ek(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked})),r={width:zn("宽"),height:zn("高")};function a(t,n){n>=1&&e.onChange(t,n)}return Ie.a.createElement(wb,{className:"lake-diagram-size-control",disabled:n},Object.keys(r).map((function(e){return Ie.a.createElement("div",{className:"lake-diagram-size-control-".concat(e),key:e},r[e],Ie.a.createElement($x,{disabled:n,min:1,max:2560,value:Math.round(wb.get(t,e)),onBlur:function(t){return a(e,parseFloat(t.target.value))},onPressEnter:function(t){return a(e,parseFloat(t.target.value))},onStep:function(t){return a(e,t)}}))})))}function tk(e){var t=e.path,n=e.selections,r=0===n.length||n.some((function(e){return e.locked}));return Ie.a.createElement(wb,{className:"lake-diagram-ratio-control",disabled:r},Ie.a.createElement($e.a,{disabled:r,checked:wb.get(n,t),onChange:function(n){e.onChange(t,n.target.checked)}},zn("保持宽高比")))}function nk(e){var t=e.selections,n=e.onChange,r=0===t.length||t.some((function(e){return e.locked}));return Ie.a.createElement(wb,{className:"lake-diagram-reset-size-control",disabled:r},Ie.a.createElement(Ye.a,{disabled:r,onClick:function(){var e=t[0];e.isImage?n({width:e.image.naturalWidth,height:e.image.naturalHeight}):e.isVertex&&n({width:e.stencil.width,height:e.stencil.height})}},zn("原始大小")))}function rk(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked}));function r(t,n){e.onChange(t,n)}return Ie.a.createElement(wb,{className:"lake-diagram-position-control",disabled:n},["x","y"].map((function(e){return Ie.a.createElement("div",{className:"lake-diagram-position-control-".concat(e),key:e},e.toUpperCase(),Ie.a.createElement($x,{disabled:n,value:Math.round(wb.get(t,e)),onBlur:function(t){return r(e,parseFloat(t.target.value))},onPressEnter:function(t){return r(e,parseFloat(t.target.value))},onStep:function(t){return r(e,t)}}))})))}function ak(e){return""===e?e:"".concat(Math.round(e),"°")}function ik(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace("°","");return""===e?e:parseInt(e,10)%360||0}function ok(e){var t=e.selections,n=0===t.length||t.some((function(e){return null==e.rotate}))||t.some((function(e){return e.locked}));function r(t){isFinite(t)&&e.onChange("rotate",t)}function a(e){var t=e.target.value.replace("°","");t<-180||t>180||r(parseFloat(t))}return Ie.a.createElement(wb,{className:"lake-diagram-rotate-control",disabled:n},zn("角度"),Ie.a.createElement($x,{disabled:n,min:-180,max:180,formatter:ak,parser:ik,value:wb.get(t,"rotate"),onBlur:a,onPressEnter:a,onStep:r}))}function ck(e){var t=e.selections,n=[],r=[];t.forEach((function(e){n.push(e.width,e.height),r.push(e.round)}));var a;a=r.every((function(e){return e===r[0]}))?r[0]:zn("多个值");var i=Math.min.apply(Math,n)/2,o=pe()((function(t){t=parseInt(t),isFinite(t)&&e.onChange("round",ut(t,0,i))}),16);function c(e){o(e.target.value)}return Object(Ne.useEffect)((function(){return function(){return o.cancel()}})),Ie.a.createElement(wb,{className:"lake-diagram-opacity-control"},Ie.a.createElement(et.a,{min:0,max:i,step:1,tooltipVisible:!1,value:a,onChange:o}),Ie.a.createElement($x,{min:0,max:i,step:1,value:a,formatter:function(e){return Math.floor(ut(e,0,i))},onBlur:c,onPressEnter:c,onStep:o}))}Wx.defaultProps={boardWebProxy:null,onAddMaterial:null},Wx.propTypes={diagram:_e.a.object,boardWebProxy:_e.a.object,onAddMaterial:_e.a.func},rt(".lake-diagram-properties-alignment {\n  margin-top: 8px;\n  margin-bottom: 16px;\n}\n.lake-diagram-properties-alignment .ant-radio-group {\n  display: flex;\n}\n.lake-diagram-properties-alignment .ant-radio-group label {\n  flex-grow: 1;\n  padding: 0;\n  text-align: center;\n}\n"),Zx.defaultProps={},Zx.propTypes={diagram:_e.a.object.isRequired,selections:_e.a.arrayOf(_e.a.object).isRequired},Zx.key="AlignControl",rt(".lake-diagram-properties-distribute {\n  margin-bottom: 8px;\n}\n.lake-diagram-properties-distribute .ant-radio-group {\n  width: 100%;\n}\n.lake-diagram-properties-distribute .ant-radio-button-wrapper {\n  width: 50%;\n  text-align: center;\n}\n.lake-diagram-properties-distribute-label-group {\n  width: 100%;\n}\n.lake-diagram-properties-distribute-label {\n  display: inline-block;\n  width: 50%;\n  text-align: center;\n}\n"),Ux.propTypes={selections:_e.a.arrayOf(_e.a.object),diagram:_e.a.object},rt(".lake-diagram-properties-z-index {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 8px;\n}\n.lake-diagram-properties-z-index .ant-radio-button-wrapper {\n  padding: 0 14px;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-label {\n  display: inline-block;\n  width: 50%;\n  text-align: center;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group {\n  width: calc(50% - 4px);\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group .ant-radio-group {\n  display: flex;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group .ant-radio-group label {\n  text-align: center;\n  flex-grow: 1;\n  flex-shrink: 1;\n}\n"),Kx.defaultProps={onChange:function(){}},Kx.propTypes={onChange:_e.a.func.isRequired,diagram:_e.a.object.isRequired,selections:_e.a.arrayOf(_e.a.object).isRequired},Kx.key="ZIndexControl",rt(".lake-diagram-size-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-size-control-width,\n.lake-diagram-size-control-height {\n  display: flex;\n  align-items: center;\n  width: calc(50% - 8px);\n}\n.lake-diagram-size-control-width .ant-input-number,\n.lake-diagram-size-control-height .ant-input-number {\n  margin-left: 16px;\n  width: calc(100% - 32px);\n}\n"),ek.propTypes={selections:_e.a.array,onChange:_e.a.func},tk.defaultProps={path:"constraints.proportion"},tk.propTypes={path:_e.a.string,selections:_e.a.array,onChange:_e.a.func},rt(".lake-diagram-reset-size-control .lake-diagram-control-body {\n  margin-top: 12px;\n}\n.lake-diagram-reset-size-control .ant-btn {\n  width: 100%;\n}\n"),nk.propTypes={selections:_e.a.array,onChange:_e.a.func},rt(".lake-diagram-position-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-position-control-x,\n.lake-diagram-position-control-y {\n  display: flex;\n  align-items: center;\n  width: calc(50% - 8px);\n}\n.lake-diagram-position-control-x .ant-input-number,\n.lake-diagram-position-control-y .ant-input-number {\n  margin-left: 16px;\n  width: calc(100% - 32px);\n}\n"),rk.propTypes={selections:_e.a.array,onChange:_e.a.func},rt(".lake-diagram-rotate-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n"),ok.propTypes={selections:_e.a.arrayOf(_e.a.object),onChange:_e.a.func},rt(".lake-diagram-opacity-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-opacity-control .lake-diagram-control-body .ant-slider {\n  flex: 1 0 auto;\n  margin-left: 0;\n  margin-right: 16px;\n}\n"),ck.propTypes={selections:_e.a.arrayOf(_e.a.object),onChange:_e.a.func};var lk=[{name:zn("排列"),hideHeader:!0,tabKey:"arrangement",condition:function(e){return e.length>0&&e.some((function(e){return e.isStem}))},controls:[{Control:Zx},{Control:Ux},{Control:Kx}]},{name:zn("位置"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return(e.isVertex&&e.isStem||e.isGroup)&&!Dn(e)}))},controls:[{Control:rk,display:function(e){return e.every((function(e){return e.isGroup}))||e.every((function(e){return!e.isGroup}))}}]},{name:zn("大小"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry&&e.isStem||e.isGroup}))},controls:[{Control:ek,display:function(e){return e.every((function(e){return e.isGroup}))||e.every((function(e){return!e.isGroup}))}},{Control:tk,display:function(e){return!e.some((function(e){return e.isGroup}))}},{Control:nk,display:function(e){return!e.some((function(e){return e.isGroup}))}}]},{name:zn("圆角半径"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry&&e.canRound()}))},controls:[{Control:ck}]},{name:zn("旋转"),tabKey:"arrangement",condition:function(e){return e.length>0&&e.every((function(e){return e.canRotate()&&!Dn(e)}))},controls:[{Control:ok}]}];function sk(e){var t=e.path,n=e.title,r=e.diagram,a=e.selections.filter((function(e){return e.canFill()})),i=0===a.length||a.some((function(e){return e.locked})),o=wb.get(a,t),c="multiValue"===o?"#FFFFFF":o;function l(n){e.onChange(t,n,us(a))}return Ie.a.createElement(wb,{disabled:i,title:n,extra:Ie.a.createElement(fx,{disabled:i,color:c,defaultColor:e.defaultColor,onSelect:l,onClear:function(){return l("rgba(0, 0, 0, 0)")},diagram:r},Ie.a.createElement("div",{className:ze()("lake-diagram-fill",{"lake-diagam-multi-properties-selection":"multiValue"===o}),style:"multiValue"===o?void 0:{backgroundColor:c}}))})}function uk(e){var t=e.path,n=e.title,r=e.diagram,a=e.selections.filter((function(e){return e.canStroke()})),i=function(e,t){return wb.get(e,t)||(e.length>0&&!e[0].isStem?wb.get(e,"treeEdge.stroke"):void 0)}(a,t)||"rgba(0, 0, 0, 0)",o=0===a.length||a.some((function(e){return e.locked})),c="multiValue"===i?"#FFFFFF":i;function l(n){e.onChange(t,n,a)}return Ie.a.createElement(wb,{disabled:o,title:n||zn("颜色"),extra:Ie.a.createElement(fx,{disabled:o,color:c,defaultColor:e.defaultColor,onSelect:l,onClear:function(){return l("rgba(0, 0, 0, 0)")},diagram:r},Ie.a.createElement("div",{className:ze()("lake-diagram-stroke",{"lake-diagam-multi-properties-selection":"multiValue"===i}),style:"multiValue"===i?void 0:{backgroundColor:c}}))})}function dk(e){var t=e.selections,n=e.path,r=0===t.length||t.some((function(e){return e.locked})),a=t.filter((function(e){return e.canStrokeWidth()})),i=wb.get(a,n);function o(t){var r=Math.min(Math.max(t,1),10);r!==i&&e.onChange(n,r,a)}function c(e){o(parseFloat(e.target.value))}return Ie.a.createElement(wb,{className:"lake-diagram-stroke-width-control",disabled:r,title:zn("粗细"),extra:Ie.a.createElement($x,{disabled:r,min:1,max:10,value:i,onBlur:c,onPressEnter:c,onStep:o})})}rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control .lake-diagram-fill {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 32px;\n}\n.lake-diagram-control.disabled .lake-diagram-fill {\n  display: none;\n}\n"),sk.defaultProps={defaultColor:"transparent",title:zn("填充颜色"),onChange:function(){}},sk.propTypes={defaultColor:_e.a.string,selections:_e.a.arrayOf(_e.a.object).isRequired,path:_e.a.string.isRequired,title:_e.a.string,onChange:_e.a.func.isRequired,diagram:_e.a.object},sk.key="FillControl",rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control.disabled .lake-diagram-stroke {\n  display: none;\n}\n.lake-diagram-stroke {\n  border: 4px solid var(--yq-white);\n  height: 30px;\n}\n"),uk.defaultProps={defaultColor:"transparent",onChange:function(){}},uk.propTypes={defaultColor:_e.a.string,selections:_e.a.arrayOf(_e.a.object).isRequired,path:_e.a.string.isRequired,onChange:_e.a.func.isRequired,title:_e.a.string,diagram:_e.a.object},uk.key="StrokeControl",rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-stroke-width-control .ant-input-number {\n  width: 100%;\n}\n"),dk.defaultProps={onChange:function(){}},dk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,path:_e.a.string.isRequired,onChange:_e.a.func.isRequired},dk.key="StrokeWidthControl",rt(".lake-diagram-stroke-style-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.lake-diagram-stroke-style-selected {\n  line-height: 0;\n}\n.lake-diagram-stroke-style-selected .lake-diagram-stroke-style-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n.lake-diagram-stroke-style-selected .lake-properties-stroke-style-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-stroke-style-selected .lake-diagram-properties-stroke-style {\n  width: 100%;\n  height: 100%;\n}\n");var fk={none:"https://gw.alipayobjects.com/zos/bmw-prod/5e3dbea7-f3c3-418f-91de-cfbcb825343c.svg",dash:"https://gw.alipayobjects.com/zos/bmw-prod/3d7118e9-1bac-465d-acb9-cc0766ece25e.svg"};function hk(e){var t=e.selections,n=e.path,r=0===t.length||t.some((function(e){return e.locked})),a=t.filter((function(e){return e.canStrokeStyle()})),i=wb.get(a,n);return Ie.a.createElement(wb,{className:"lake-diagram-properties-stroke-style",disabled:r,title:zn("样式"),extra:Ie.a.createElement(Xe.a,{disabled:r,trigger:["click"],overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var r=t.key;e.onChange(n,"none"===r?null:r,a)}},Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-stroke-style-item","test-id":"lake-diagram-stroke-style-item-none",key:"none",style:{backgroundImage:"url(".concat(fk.none,")")}}),Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-stroke-style-item","test-id":"lake-diagram-stroke-style-item-dash",key:"dash",style:{backgroundImage:"url(".concat(fk.dash,")")}})),placement:"bottomRight"},Ie.a.createElement("div",{className:"lake-diagram-stroke-style-selected"},Ie.a.createElement("span",{className:"lake-diagram-stroke-style-item lake-diagram-stroke-style-selected-item",style:{backgroundImage:"url(".concat(fk[i||"none"],")")}}),Ie.a.createElement(yb,{className:"lake-properties-stroke-style-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}hk.defaultProps={onChange:function(){},path:"stroke.style"},hk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired,path:_e.a.string.isRequired},hk.key="StrokeStyleControl",rt(".lake-diagram-opacity-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-opacity-control .lake-diagram-control-body .ant-slider {\n  flex: 1 0 auto;\n  margin-left: 0;\n  margin-right: 16px;\n}\n");var pk=0,mk=1;function yk(e){return""===e?e:"".concat(Math.round(100*e),"%")}function vk(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace("%","");return""===e?e:Math.min(Math.max(parseFloat(e)/100||0,pk),mk)}function gk(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked})),r=parseFloat(wb.get(t,"opacity"))||1,a=pe()((function(t){isFinite(t)&&e.onChange("opacity",t)}),16);function i(e){a(vk(e.target.value))}return Object(Ne.useEffect)((function(){return function(){return a.cancel()}})),Ie.a.createElement(wb,{className:"lake-diagram-opacity-control",disabled:n},Ie.a.createElement(et.a,{disabled:n,min:pk,max:mk,step:.01,tooltipVisible:!1,value:r,onChange:a}),Ie.a.createElement($x,{disabled:n,min:pk,max:mk,step:.01,value:r,formatter:yk,parser:vk,onBlur:i,onPressEnter:i,onStep:a}))}function bk(e){var t=Object(Ne.useRef)(),n=e.width,r=e.height,a=e.shape,i=a&&oc.find((function(e){return e.name===a}));return Object(Ne.useEffect)((function(){if(t.current&&i){var e=new eh({stencil:i,width:n,height:r,noFill:!0,stroke:Xf("text"),fill:"transparent"}).rendererElement;Array.from(t.current.children,(function(e){return e.remove()})),t.current.appendChild(e)}}),[t,n,r,i]),i?Ie.a.createElement("svg",{ref:t,width:n,height:r,viewBox:[0,0,n,r].join(" ")}):null}function xk(e){var t,n=e.selections,r=0===n.length,a=n.filter((function(e){return e.isGeometry})),i=wb.get(a,e.path),o=(null===(t=oc[oc.findIndex((function(e){return e.name===i}))])||void 0===t?void 0:t.category)||"basic";return Ie.a.createElement(wb,{className:"lake-diagram-geometry-shape-control",disabled:r,title:zn("形状"),extra:Ie.a.createElement(Xe.a,{disabled:r,overlay:Ie.a.createElement("div",{className:"lake-diagram-properties-shape-select-container"},Ie.a.createElement(lb,{onSelect:function(t){var n=t.key;e.onChange(e.path,n,a)},groups:[o]})),placement:"bottomRight",trigger:["click"]},Ie.a.createElement(Ye.a,null,Ie.a.createElement("div",{className:ze()("lake-diagram-geometry-shape-current",{"multi-geometry-selection":"multiValue"===i})},Ie.a.createElement(bk,{shape:i,width:32,height:32}))))})}gk.propTypes={selections:_e.a.arrayOf(_e.a.object),onChange:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-geometry-shape-control .lake-diagram-control-extra {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-geometry-shape-control .lake-diagram-control-extra .ant-btn {\n  background: none;\n  border: none;\n  height: 32px;\n  width: 100%;\n  padding: 0;\n}\n.lake-diagram-geometry-shape-control .multi-geometry-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-geometry-shape-control .lake-diagram-geometry-shape-current {\n  width: 100%;\n  min-height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-properties-shape-select-container {\n  background-color: var(--yq-bg-primary);\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n}\n"),bk.propTypes={width:_e.a.number,height:_e.a.number,shape:_e.a.string},xk.defaultProps={path:"shape",groups:["basic","flowchart"],onChange:function(){}},xk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,path:_e.a.string.isRequired,groups:_e.a.array,onChange:_e.a.func.isRequired},xk.key="GeometryShapeControl";var kk=[{name:zn("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry||Bn(e)}))},controls:[{path:"shape",Control:xk,display:function(e){return e.every((function(e){return"UML"!==e.category&&!Dn(e)}))}},{path:"fill.color",Control:sk}]},{name:zn("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isGeometry||Dn(e)}))},controls:[{path:"stroke.color",Control:uk},{path:"stroke.width",Control:dk},{display:function(e){return e.every((function(e){return!Ln(e)}))},Control:hk}]},{name:zn("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return(e.isGeometry||Bn(e))&&null!=e.opacity}))},controls:[{Control:gk}]}],wk=[{name:zn("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isStack}))},controls:[{path:"fill.color",Control:sk}]},{name:zn("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isStack}))},controls:[{path:"stroke.color",Control:uk},{path:"stroke.width",Control:dk},{Control:hk}]},{name:zn("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isStack&&null!=e.opacity}))},controls:[{Control:gk}]}];function Ck(e){var t=e.selections,n=e.diagram,r=t.filter((function(e){return e.isMindmap})),a=Oi(r,wb),i=Object(Ne.useState)(!1),o=b()(i,2),c=o[0],l=o[1],s=r.map((function(e){return e.upDirection}));r.map((function(e){return e.upLayoutType}));var u=Ai.filter((function(e){if(r.every((function(e){return e.isStem})))return!0;var n=e.key.split("-")[0],a=t.some((function(e){var t=e.upLayoutType,r=e.isAbstract;return Si(t,n,r)})),i=!e.directions.every((function(e){return s.every((function(t){return Pi(t,e)}))}));return!a&&!i}));function d(e){0!==u.length&&l(e)}return Ie.a.createElement(wb,{className:"lake-diagram-layout-control",title:zn("结构"),disabled:0===u.length,extra:Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement(Ie.a.Fragment,null,u.map((function(t){var i=t.key;return Ie.a.createElement("div",{key:i,"data-lake_prevent_click_unselect":"true",className:ze()("lake-diagram-layout-thumb",{selected:i===a}),onClick:function(){d(!c),function(t){e.onChange("layout",Ei(t),r),n&&n.selector.select(r)}(i)}},Ie.a.createElement("div",{className:i}))}))),overlayClassName:"lake-diagram-layout-dropdown",placement:"bottomRight",onClick:function(){d(!c)},visible:c,onVisibleChange:function(e){d(e)},trigger:["click"]},Ie.a.createElement("div",{className:ze()("lake-diagram-layout-current",{"lake-diagam-multi-properties-selection":"multiValue"===a})},Ie.a.createElement("div",{className:"lake-diagram-layout-thumb"},Ie.a.createElement("div",{className:a}))))})}function Ak(e){var t=e.selections,n=Object(Ne.useState)(!1),r=b()(n,2),a=r[0],i=r[1],o=0===t.length;return Object(Ne.useEffect)((function(){var e=wb.get(t,"model.width");i("multiValue"===e?"multiValue":null!=e)}),[t]),Ie.a.createElement(wb,{disabled:o},Ie.a.createElement($e.a,{disabled:o,indeterminate:"multiValue"===a,checked:!!a,onChange:function(n){var r=n.target.checked?wb.get(t,"width"):null;i(n.target.checked),e.onChange({width:r,height:null})},"data-testid":"checkbox-node-width"},zn("手动设置节点尺寸")))}rt("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control.lake-diagram-layout-control .lake-diagram-control-extra {\n  padding: 0;\n  justify-content: space-around;\n}\n.lake-diagram-layout-dropdown {\n  width: 168px;\n  border-radius: 4px;\n  border: 1px solid var(--yq-border-primary);\n  display: flex;\n  flex-wrap: wrap;\n  background: var(--yq-bg-primary);\n  justify-content: initial;\n  padding: 8px 11px;\n}\n.lake-diagram-layout-dropdown.ant-dropdown-hidden {\n  display: none;\n}\n.lake-diagram-layout-thumb {\n  width: 48px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n}\n.lake-diagram-layout-thumb > div {\n  transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n  width: 100%;\n  height: 100%;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb > div {\n  filter: invert(100%);\n}\n.lake-diagram-layout-thumb > .indent-bl {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/bc67f2b4-b84a-4b09-970f-92bc893cdc1a.svg);\n}\n.lake-diagram-layout-thumb > .indent-br {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/103fb753-229b-4717-9e49-356f013b3309.svg);\n}\n.lake-diagram-layout-thumb > .indent-tr {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/15763057-474a-4b44-a999-3058a5328e9a.svg);\n}\n.lake-diagram-layout-thumb > .indent-tl {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/44546c1d-75f7-4839-a198-6f7d4049798f.svg);\n}\n.lake-diagram-layout-thumb > .standard-t {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f2060601-21d5-4882-8159-01a1fa4c241a.svg);\n}\n.lake-diagram-layout-thumb > .standard-b {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f9e3e9f4-638c-46bb-ba35-9d9bf5a87f41.svg);\n}\n.lake-diagram-layout-thumb > .standard-l {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f7687207-ddcc-4e07-abfa-a9985f86e70a.svg);\n}\n.lake-diagram-layout-thumb > .standard-r {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/af8bdfa5-f0ae-446b-836e-1d0340d2f5c6.svg);\n}\n.lake-diagram-layout-thumb > .standard-h {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/069fa8cc-c99f-4d1b-98a5-371367ace0e5.svg);\n}\n.lake-diagram-layout-thumb > .timeline-r {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/56c34bb7-b888-4103-bc03-3124cd7b99a3.svg);\n}\n.lake-diagram-layout-thumb > .timeline-l {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/23f1801a-504c-4254-a5d2-f33fcee86de7.svg);\n}\n.lake-diagram-layout-thumb:hover,\n.lake-diagram-layout-thumb.selected {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background-color: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb.selected {\n  background-color: rgba(255, 255, 255, 0.12);\n}\n.lake-diagram-layout-current {\n  background: var(--yq-bg-primary);\n  width: 100%;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-layout-current .lake-diagram-layout-thumb:hover {\n  background-color: transparent;\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-current .lake-diagram-layout-thumb:hover {\n  background-color: transparent;\n}\n"),Ck.defaultProps={onChange:function(){}},Ck.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired,diagram:_e.a.object},Ck.key="LayoutControl",Ak.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired},Ak.key="NodeWidthControl",rt("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-border-shape-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.lake-diagram-border-shape-selected {\n  line-height: 0;\n}\n.lake-diagram-border-shape-selected .lake-diagram-border-shape-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n.lake-diagram-border-shape-selected .lake-properties-border-shape-dropdown-icon {\n  width: 10x;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-border-shape-selected .lake-diagram-properties-border-shape {\n  width: 100%;\n  height: 100%;\n}\n");var Ok=["line","rect","capsule"],Ek={none:"https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg",line:"https://gw.alipayobjects.com/zos/bmw-prod/6ffe619f-04e8-48c7-af45-5f0f3cf2c4a1.svg",rect:"https://gw.alipayobjects.com/zos/bmw-prod/7b0ba540-6360-430b-a960-90c928ca037c.svg",capsule:"https://gw.alipayobjects.com/zos/bmw-prod/3818284f-32e3-44cb-875c-1b722074ddaa.svg"};function Pk(e){var t=e.selections,n=wb.get(t,"border.shape","line")||null,r=t.length>0&&t.some((function(e){return e.isStem})),a=t.length>0&&t.some((function(e){return e.isAbstract})),i=r||a?Ok.filter((function(e){return"line"!==e})):Ok,o=i.find((function(e){return e===n}))?n:"",c=0===t.length;return Ie.a.createElement(wb,{className:"lake-diagram-properties-border-shape",disabled:c,title:zn("节点形状"),extra:Ie.a.createElement(Xe.a,{disabled:c,trigger:["click"],overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,onClick:function(n){var r=n.key;e.onChange("border.shape",r,t)}},i.map((function(e){return Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-border-shape-item","test-id":"lake-diagram-border-shape-item-".concat(e),key:e,style:{backgroundImage:"url(".concat(Ek[e],")")}})}))),placement:"bottomRight",getPopupContainer:function(){return document.querySelector(".yuque-sdk-extra-container")||document.body}},Ie.a.createElement("div",{className:"lake-diagram-border-shape-selected"},Ie.a.createElement("span",{className:"lake-diagram-border-shape-item lake-diagram-border-shape-selected-item",style:{backgroundImage:"url(".concat(Ek[o||"none"],")")}}),Ie.a.createElement(yb,{className:"lake-properties-border-shape-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}function Sk(e){var t=e.selections.filter((function(e){return e.canStroke()&&e.isMindmap})),n=0===t.length,r=wb.get(t,"border.stroke-width");function a(n){var a=Math.min(Math.max(n,1),10);a!==r&&e.onChange("border.stroke-width",a,t)}function i(e){a(parseFloat(e.target.value))}return Ie.a.createElement(wb,{className:"lake-diagram-border-stroke-width-control",disabled:n,title:zn("边框粗细"),extra:Ie.a.createElement($x,{disabled:n,min:1,max:10,value:r,onBlur:i,onPressEnter:i,onStep:a})})}function jk(e){var t=yt(e.selections.map((function(e){return e.stem}))),n=Object(Ne.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Object(Ne.useEffect)((function(){i(wb.get(t,"rainbow"))}),[t]),Ie.a.createElement(wb,null,Ie.a.createElement($e.a,{indeterminate:"multiValue"===a,checked:!!a,onChange:function(n){var r=n.target.checked;i(r),e.onChange("rainbow",r,t)}},zn("彩虹分支")))}function Rk(e){var t=yt(e.selections.map((function(e){return e.stem}))),n=wb.get(t,"tapered");return Ie.a.createElement(wb,null,Ie.a.createElement($e.a,{indeterminate:"multiValue"===n,checked:!!n,onChange:function(n){var r=n.target.checked;e.onChange("tapered",r,t)}},zn("分支线条宽度逐渐变细")))}function Mk(e){var t=e.selections,n=e.onChange,r=yt(t.map((function(e){return e.stem}))),a=wb.get(r,"treeEdge.shape",null);a="multiValue"===a?null:void 0===a?"curve":a;var i=0===t.length;return Ie.a.createElement(wb,{className:"lake-diagram-properties-edge-shape",disabled:i,title:zn("分支类型"),extra:Ie.a.createElement(Qe.a.Group,{disabled:i,value:a,onChange:function(e){var t="curve"===e.target.value?null:e.target.value;n("treeEdge.shape",t,r)}},Ie.a.createElement(Qe.a.Button,{value:"curve"},Ie.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-none"})),Ie.a.createElement(Qe.a.Button,{value:"polyline"},Ie.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-polyline"})))})}function Lk(e){var t=e.selections,n=e.diagram,r=wb.get(t,"treeEdge.stroke","#A287E1"),a="multiValue"===r?"#FFFFFF":r;return Ie.a.createElement(wb,{disabled:0===t.length,title:zn("分支颜色"),extra:Ie.a.createElement(fx,{disabled:0===t.length,color:a,onSelect:function(t){e.onChange("treeEdge.stroke",t)},diagram:n},Ie.a.createElement("div",{className:ze()("lake-diagram-tree-edge-stroke",{"lake-diagam-multi-properties-selection":"multiValue"===r})},Ie.a.createElement("svg",{width:"64",viewBox:"0 0 64 12",xmlns:"http://www.w3.org/2000/svg"},Ie.a.createElement("path",{d:"M64 2c-27.42 0-35.012 8-64 8",stroke:"multiValue"===r?"none":r,strokeWidth:"4",fill:"none",fillRule:"evenodd"}))))})}function Bk(e){var t=e.selections.filter((function(e){return e.isMindmap&&!e.isStem})),n=0===t.length,r=wb.get(t,"treeEdge.stroke-width");function a(n){var a=Math.min(Math.max(n,1),5);"number"==typeof a&&a!==r&&e.onChange("treeEdge.stroke-width",a,t)}function i(e){a(parseFloat(e.target.value))}return Ie.a.createElement(wb,{className:"lake-diagram-tree-edge-stroke-width-control",disabled:n,title:zn("分支粗细"),extra:Ie.a.createElement($x,{disabled:n,min:1,max:5,value:r,onBlur:i,onPressEnter:i,onStep:a})})}Pk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired},Pk.key="BorderShapeControl",rt("/* stylelint-disable */\n.lake-diagram-border-stroke-width-control .ant-input-number {\n  width: 100%;\n}\n"),Sk.defaultProps={onChange:function(){}},Sk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired},Sk.key="BorderStrokeWidthControl",jk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func},jk.key="TreeEdgeRainbowControl",Rk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func},Rk.key="TreeEdgeTaperedControl",rt(".lake-diagram-properties-edge-shape .lake-diagram-control-extra {\n  border: none;\n}\n.lake-diagram-properties-edge-shape .lake-diagram-control-extra button {\n  padding: 0 13px;\n}\n"),Mk.defaultProps={onChange:function(){}},Mk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired},Mk.key="TreeEdgeShapeControl",rt(".lake-diagram-tree-edge-stroke {\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n}\n"),Lk.defaultProps={onChange:function(){}},Lk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired,diagram:_e.a.object},Lk.key="TreeEdgeStrokeControl",rt("/* stylelint-disable */\n"),Bk.defaultProps={onChange:function(){}},Bk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired},Bk.key="TreeEdgeStrokeWidthControl";var Dk=[{name:zn("布局"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isMindmap}))},controls:[{Control:Ck}]},{name:zn("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isMindmap}))},controls:[{Control:Pk},{path:"border.fill",Control:sk},{path:"border.stroke",title:zn("边框颜色"),Control:uk},{Control:Sk},{Control:Ak}]},{name:zn("分支"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isMindmap&&e.isStem}))},controls:[{Control:jk},{Control:Rk},{Control:Mk}]},{name:zn("分支"),tabKey:"style",condition:function(e){return e.length>0&&!e.every((function(e){return e.isStem}))&&e.every((function(e){return e.isMindmap&&!e.isStem}))},controls:[{Control:Lk},{Control:Bk},{Control:Mk},{Control:jk},{Control:Rk}]}];rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-dropdown-input {\n  position: relative;\n  overflow: hidden;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  transition: border-color 0.3s;\n}\n.lake-diagram-dropdown-input:hover {\n  border-color: var(--yq-yuque-green-500);\n}\n.lake-diagram-dropdown-input-focus {\n  border-color: var(--yq-yuque-green-500);\n  box-shadow: 0 0 0 2px rgba(11, 208, 125, 0.2);\n  outline: none;\n}\n.lake-diagram-dropdown-input .ant-input {\n  padding-right: 24px;\n  border: none;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger {\n  position: absolute;\n  top: -1px;\n  right: -1px;\n  padding: 0;\n  border-width: 0 0 0 1px;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  width: 24px;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger .lake-icon {\n  position: absolute;\n  right: 8px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  border: 4px solid;\n  border-color: var(--yq-yuque-grey-7) transparent transparent transparent;\n  box-sizing: border-box;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger .lake-icon::before {\n  content: ' ';\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger:hover {\n  background: var(--yq-bg-tertiary);\n  border-color: var(--yq-border-primary);\n}\n");var Nk=["disabled"];function Ik(e){var t=e.disabled,n=Ge()(e,Nk),r=Object(Ne.useState)(e.value),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)(!1),l=b()(c,2),s=l[0],u=l[1];return Object(Ne.useEffect)((function(){o(e.value)}),[e.value]),Ie.a.createElement("div",{className:ze()("lake-diagram-dropdown-input",{"lake-diagram-dropdown-input-focus":s})},Ie.a.createElement(We.a,{disabled:t,value:i,onFocus:function(){u(!0)},onBlur:function(t){parseInt(t.target.value,10)>0&&e.onChange(t),u(!1)},onChange:function(e){o(e.target.value)},onKeyDown:function(t){"Enter"===t.key&&parseInt(t.target.value,10)>0&&(e.onChange(t),t.target.select())}}),Ie.a.createElement(Xe.a,De()({disabled:t},n),Ie.a.createElement(Ye.a,null,Ie.a.createElement("span",{className:"lake-icon lake-icon-dropdown-arrow"}))))}function Tk(e){var t=e.selections,n=e.diagram,r=0===t.length||t.some((function(e){return e.locked})),a=Object(Ne.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=n.contentEditorPlus,s=o.fontSize,u=o.color,d=o.bold,f=o.italic,h=o.strikethrough,p=o.underline;return Object(Ne.useEffect)((function(){function e(e){var t=e.query;c(t)}return l.emitQueryChange(),n&&l.on("querychange",e),function(){l.off("querychange",e)}}),[n]),Ie.a.createElement(wb,{disabled:r,className:"text-format-control"},Ie.a.createElement("div",{className:"text-format-li",style:{display:"flex",justifyContent:"space-between"}},Ie.a.createElement("span",{style:{display:"flex",flexWrap:"nowrap"}},Ie.a.createElement(Ye.a,{disabled:r,className:ze()("bisu-btn",{active:d}),onClick:function(){return l.execCommand("bold")}},Ie.a.createElement("span",{className:"lake-icon lake-icon-bold"})),Ie.a.createElement(Ye.a,{disabled:r,className:ze()("bisu-btn",{active:f}),onClick:function(){return l.execCommand("italic")}},Ie.a.createElement("span",{className:"lake-icon lake-icon-italic"})),Ie.a.createElement(Ye.a,{disabled:r,className:ze()("bisu-btn",{active:h}),onClick:function(){return l.execCommand("strikethrough")}},Ie.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})),Ie.a.createElement(Ye.a,{disabled:r,className:ze()("bisu-btn",{active:p}),onClick:function(){return l.execCommand("underline")}},Ie.a.createElement("span",{className:"lake-icon lake-icon-underline"})))),Ie.a.createElement("div",{className:"text-format-li text-format-font-color"},zn("字号"),Ie.a.createElement("div",{className:"lake-diagram-control-extra lake-diagrm-font-color-control-extra"},Ie.a.createElement(Ik,{disabled:r,trigger:["click"],value:s,onChange:function(e){return l.execCommand("fontSize",parseInt(e.target.value))},overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,className:"lake-user-select-none text-format-font-size-menu",selectedKeys:[s&&s.toString()],onClick:function(e){var t=e.key;return l.execCommand("fontSize",parseInt(t))}},[12,14,16,18,22,24,32,36,48,64,92].map((function(e){return Ie.a.createElement(Ve.a.Item,{key:e},e===s&&Ie.a.createElement("span",{className:"lake-icon lake-icon-success"}),e,"px")}))),placement:"bottomRight"}))),Ie.a.createElement("div",{className:"text-format-li text-format-font-color"},zn("文本颜色"),Ie.a.createElement("div",{className:"lake-diagram-control-extra lake-diagrm-font-color-control-extra"},Ie.a.createElement(fx,{disabled:r,color:u,defaultColor:e.defaultColor,onSelect:ye()((function(e){return l.execCommand("foreColor",e)}),16),diagram:n},Ie.a.createElement("div",{className:"lake-diagram-font-color",style:{backgroundColor:u}})))))}Ik.propTypes={value:_e.a.oneOfType([_e.a.string,_e.a.number]),disabled:_e.a.bool,onChange:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.text-format-control .text-format-font-color {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.text-format-control .text-format-li {\n  margin-bottom: 16px;\n}\n.text-format-control .text-format-li:last-child {\n  margin-bottom: 0;\n}\n.text-format-control .lake-diagram-control-extra {\n  display: inline-block;\n  vertical-align: bottom;\n  margin-left: 8px;\n}\n.text-format-control .lake-diagram-font-color {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 30px;\n}\n.text-format-control.disabled .lake-diagram-font-color {\n  display: none;\n}\n.text-format-control .control-body {\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: nowrap;\n}\n.text-format-control .bisu-btn {\n  padding: 0;\n  text-align: center;\n  width: 32px;\n  line-height: 30px;\n  margin-right: 8px;\n}\n.text-format-control .bisu-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.text-format-control .bisu-btn.active {\n  border-color: var(--yq-yuque-green-500);\n}\n.lake-diagram-control-extra.lake-diagrm-font-color-control-extra {\n  width: auto;\n  flex: auto;\n  max-width: 90px;\n}\n.text-format-font-size {\n  max-width: 90px;\n  display: inline-block;\n  flex: auto;\n  height: 32px;\n  line-height: 30px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  padding: 0 8px;\n  font-size: 14px;\n  font-weight: 400;\n}\n.text-format-font-size[disabled] {\n  color: var(--yq-text-caption);\n  cursor: not-allowed;\n  border-color: var(--yq-border-primary);\n}\n.text-format-font-size .lake-icon-arrow-down {\n  width: 8px;\n  height: 8px;\n  float: right;\n  margin-top: 12px;\n  background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjhweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA4IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Mi41ICg2NzQ2OSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPkdyb3VwIENvcHkgNjwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuNDUiPg0KICAgICAgICA8ZyBpZD0idG9vbGJhciIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMyOC4wMDAwMDAsIC0xOC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJwYXJhZ3JhcGgtc3R5bGUiPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyNi4wMDAwMDAsIDQuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC1Db3B5LTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMi4wMDAwMDAsIDEyLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjgiIGhlaWdodD0iOCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTAuNTk2MDkzNzUsMi41NTcwMzEyNSBMMy43NDUzMTI1LDYuMzc4MTI1IEMzLjg3NzM0Mzc1LDYuNTI1NzgxMjUgNC4xMDg1OTM3NSw2LjUyNTc4MTI1IDQuMjQwNjI1LDYuMzc4MTI1IEw3LjQwNTQ2ODc1LDIuNTU3MDMxMjUgQzcuNTk2MDkzNzUsMi4zNDI5Njg3NSA3LjQ0NDUzMTI1LDIuMDAzOTA2MjUgNy4xNTc4MTI1LDIuMDAzOTA2MjUgTDAuODQ0NTMxMjUsMi4wMDM5MDYyNSBDMC41NTcwMzEyNSwyLjAwMzkwNjI1IDAuNDA0Njg3NSwyLjM0Mjk2ODc1IDAuNTk2MDkzNzUsMi41NTcwMzEyNSBaIiBpZD0iU2hhcGUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPg0KICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+) no-repeat;\n}\n.text-format-font-size .lake-icon-arrow-down::before {\n  display: none;\n}\n.text-format-font-size-menu {\n  min-width: 104px;\n}\n.text-format-font-size-menu .ant-dropdown-menu-item {\n  text-align: center;\n  position: relative;\n}\n.text-format-font-size-menu .ant-dropdown-menu-item .lake-icon {\n  position: absolute;\n  left: 12px;\n  top: 9px;\n}\n.text-format-color {\n  margin-top: 8px;\n  width: 92px;\n  height: 32px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  padding: 4px;\n}\n.text-format-color-indicator {\n  width: 100%;\n  height: 100%;\n}\n.text-format-color[disabled] {\n  cursor: not-allowed;\n  border-color: var(--yq-border-primary);\n}\n.text-format-color[disabled]-indicator {\n  display: none;\n}\n"),Tk.defaultProps={defaultColor:tr},Tk.propTypes={defaultColor:_e.a.string,selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired,diagram:_e.a.object.isRequired},Tk.key="TextBasicFormat",rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.properties-text-format-text-h-align.ant-radio-group {\n  display: flex;\n}\n.properties-text-format-text-h-align.ant-radio-group .ant-radio-button-wrapper {\n  flex-grow: 1;\n  padding: 0 17.5px;\n  text-align: center;\n}\n.properties-text-format-text-h-align.ant-radio-group .ant-radio-button-wrapper-disabled {\n  border-color: var(--yq-border-primary);\n}\n");var _k={left:"justifyLeft",center:"justifyCenter",right:"justifyRight",justify:"justifyFull"};function Fk(e){var t=e.selections,n=e.diagram,r=0===t.length||t.some((function(e){return e.locked})),a=Object(Ne.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=n.contentEditorPlus,s=o.textAlign;return Object(Ne.useEffect)((function(){function e(e){var t=e.query;c(t)}return l.emitQueryChange(),n&&l.on("querychange",e),function(){l.off("querychange",e)}}),[n]),Ie.a.createElement(wb,{disabled:r,className:"text-format-control"},Ie.a.createElement(Qe.a.Group,{className:"text-format-li properties-text-format-text-h-align",disabled:r,defaultValue:_k.left,value:_k[s]},Ie.a.createElement(Qe.a.Button,{value:_k.left,onClick:function(){return l.execCommand(_k.left)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-left"})),Ie.a.createElement(Qe.a.Button,{value:_k.center,onClick:function(){return l.execCommand(_k.center)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-center"})),Ie.a.createElement(Qe.a.Button,{value:_k.right,onClick:function(){return l.execCommand(_k.right)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-right"})),Ie.a.createElement(Qe.a.Button,{value:_k.justify,onClick:function(){return l.execCommand(_k.justify)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-justify"}))))}function zk(e){var t=e.selections,n=0===t.length||t.some((function(e){return e.locked})),r=wb.get(t,"textVerticalAlign");return ur.includes(r)||(r=lr),Ie.a.createElement(wb,{disabled:n,className:"text-format-control"},Ie.a.createElement(Qe.a.Group,{className:"text-format-li properties-text-format-text-v-align",disabled:n,defaultValue:lr,value:r},sr.map((function(n){var r=n.key,a=n.icon;return Ie.a.createElement(Qe.a.Button,{key:r,value:r,onClick:function(){return function(n){e.onChange("textVerticalAlign",n,us(t))}(r)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(a)}))}))))}function qk(e){var t=e.diagram;return Ie.a.createElement(Ye.a,{block:!0,onClick:function(){t.command.execute("AttachLink")}},zn("添加链接"))}Fk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,diagram:_e.a.object.isRequired},Fk.key="TextHAlign",rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.properties-text-format-text-v-align.ant-radio-group {\n  display: flex;\n}\n.properties-text-format-text-v-align.ant-radio-group .ant-radio-button-wrapper {\n  flex-grow: 1;\n  padding: 0 17.5px;\n  text-align: center;\n}\n.properties-text-format-text-v-align.ant-radio-group .ant-radio-button-wrapper-disabled {\n  border-color: var(--yq-border-primary);\n}\n"),zk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,diagram:_e.a.object.isRequired,onChange:_e.a.func.isRequired},zk.key="TextVAlign",qk.propTypes={diagram:_e.a.object.isRequired},qk.key="TextLink";var Yk=[{name:zn("基础格式"),hideHeader:!0,tabKey:"text",condition:function(e){return e.length>0&&e.every((function(e){return e.canUpdateText()}))},controls:[{Control:Tk}]},{name:zn("对齐方式"),tabKey:"text",condition:function(e){return e.length>0&&e.every((function(e){return e.canUpdateText()}))},controls:[{Control:Fk},{Control:zk,display:function(e){return e.some((function(e){return e.canTextVerticalAlign()}))}}]},{name:zn("链接"),tabKey:"text",condition:function(e){return e.length>0&&e.every((function(e){return e.canText()&&!Cn(e)}))},controls:[{Control:qk}]}];function Hk(e){var t=e.selections,n=e.diagram,r=0===t.length,a=t.filter((function(e){return e.isLine})),i={source:zn("起点"),target:zn("终点")},o=Object.keys(i).map((function(t){var n,i="".concat(t,".marker"),o=wb.get(a,i)||"none";return Ie.a.createElement("div",{className:"lake-diagram-line-arrow-control-".concat(t),key:t},Ie.a.createElement(Xe.a,{disabled:r,trigger:["click"],overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var n=t.key;e.onChange(i,"none"===n?null:n,a)},style:{padding:"5px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)"}},Yu.map((function(e){return Ie.a.createElement(Ve.a.Item,{className:ze()("lake-diagram-line-endpoint-item",{active:e===o}),"test-id":"lake-diagram-line-endpoint-item-".concat(e),key:e,style:{textAlign:"center"}},Ie.a.createElement("span",{className:ze()("lake-icon lake-icon-contextual-".concat(e),{source:"source"===t})}))}))),placement:"bottomRight"},Ie.a.createElement("div",{className:ze()("lake-diagram-line-arrow-selected")},Ie.a.createElement("span",{className:ze()("lake-diagram-line-arrow-selected-item","lake-icon",(n={"lake-diagam-multi-properties-selection":"multiValue"===o},c()(n,"lake-icon-contextual-".concat(o),o),c()(n,"source","source"===t),n))}),Ie.a.createElement(yb,{className:"lake-properties-line-arrow-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}}))))}));return o.splice(1,0,Ie.a.createElement("span",{key:"lake-icon-contextual-line-swap-endpoint",onClick:function(){n.command.execute("LineSwapEndpoint",{autoSelect:!0})},style:{fontSize:"14px",cursor:"pointer"},className:"lake-icon lake-icon-contextual-line-swap-endpoint"})),Ie.a.createElement(wb,{className:"lake-diagram-line-arrow-control",disabled:r},o)}rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-line-arrow-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 16px;\n}\n.lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.lake-diagram-line-endpoint-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-line-endpoint-item.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-line-arrow-selected {\n  line-height: 0;\n}\n.lake-diagram-line-arrow-selected .lake-diagram-line-arrow-selected-item {\n  width: 32px;\n  height: 32px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.lake-diagram-line-arrow-selected .lake-properties-line-arrow-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-line-arrow-selected .lake-diagram-properties-line-arrow {\n  width: 100%;\n  height: 100%;\n}\n.lake-diagram-line-arrow-control-source,\n.lake-diagram-line-arrow-control-target {\n  display: flex;\n  align-items: center;\n}\n.lake-diagram-line-arrow-control-source .lake-diagram-line-arrow-selected,\n.lake-diagram-line-arrow-control-target .lake-diagram-line-arrow-selected {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n}\n"),Hk.defaultProps={onChange:function(){}},Hk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired,diagram:_e.a.object},Hk.key="LineArrowControl",rt('.lake-diagram-line-shape-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n  text-align: center;\n}\n.lake-diagram-line-shape-item > img {\n  margin: auto;\n}\n[data-kumuhana="pouli"] .lake-diagram-line-shape-item > img {\n  filter: invert(100%);\n}\n.lake-diagram-line-shape-selected {\n  line-height: 0;\n}\n.lake-diagram-line-shape-selected .lake-diagram-line-shape-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n[data-kumuhana="pouli"] .lake-diagram-line-shape-selected .lake-diagram-line-shape-selected-item {\n  filter: invert(100%);\n}\n.lake-diagram-line-shape-selected .lake-properties-line-shape-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-line-shape-selected .lake-diagram-properties-line-shape {\n  width: 100%;\n  height: 100%;\n}\n');var Gk={none:"https://gw.alipayobjects.com/zos/bmw-prod/a9d015cf-7b31-496c-b60d-e224f7f0df29.svg",straight:"https://gw.alipayobjects.com/zos/bmw-prod/a9d015cf-7b31-496c-b60d-e224f7f0df29.svg",curve:"https://gw.alipayobjects.com/zos/bmw-prod/e683ab4e-70b3-4bcf-8eb1-ad843acf2add.svg",elbow:"https://gw.alipayobjects.com/zos/bmw-prod/96671966-3f77-469f-afa7-40ff402dc773.svg"};function Xk(e){var t=e.selections,n="shape",r=0===t.length,a=t.filter((function(e){return e.isLine})),i=wb.get(a,n);return Ie.a.createElement(wb,{className:"lake-diagram-properties-line-shape",disabled:r,title:zn("类型"),extra:Ie.a.createElement(Xe.a,{disabled:r,trigger:["click"],overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var r=t.key;e.onChange(n,"none"===r?null:r,a)}},Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-none",key:"none"},Ie.a.createElement("img",{src:Gk.none,alt:zn("直线")})),Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-curve",key:"curve"},Ie.a.createElement("img",{src:Gk.curve,alt:zn("曲线")})),Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-elbow",key:"elbow"},Ie.a.createElement("img",{src:Gk.elbow,alt:zn("折线")}))),placement:"bottomRight"},Ie.a.createElement("div",{className:"lake-diagram-line-shape-selected"},Ie.a.createElement("span",{className:"lake-diagram-line-shape-item lake-diagram-line-shape-selected-item",style:{backgroundImage:"url(".concat(Gk[i||"none"],")")}}),Ie.a.createElement(yb,{className:"lake-properties-line-shape-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}Xk.defaultProps={onChange:function(){}},Xk.propTypes={selections:_e.a.arrayOf(_e.a.object).isRequired,onChange:_e.a.func.isRequired},Xk.key="LineShapeControl";var Vk=[{name:zn("线条"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isLine}))},controls:[{Control:Xk},{path:"stroke.color",Control:uk},{path:"stroke.width",Control:dk},{Control:hk}]},{name:zn("端点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isLine}))},controls:[{Control:Hk}]},{name:zn("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isLine}))},controls:[{Control:gk}]}],Wk=[{name:zn("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return e.isImage&&null!=e.opacity}))},controls:[{Control:gk}]}],Zk=function(e){var t,n=e.diagram;n.selector.selections.length>0&&(t=n.selector.selections[0]);var r,a=0;t&&(jn(t)&&(t=t.parent),a=(null===(r=t.children)||void 0===r?void 0:r.length)||0);var i=Object(Ne.useState)(a),o=b()(i,2),c=o[0],l=o[1];function s(e){we()(e)&&(e=ut(e,1,50))!==a&&(n.command.execute("ChangeLaneNumber",{number:e}),l(e))}return Ie.a.createElement($x,{min:1,max:50,value:c,onBlur:function(){},onPressEnter:function(e){s(Number(e.target.value))},onStep:s})},Uk=function(e){var t=e.title,n=e.diagram;return Ie.a.createElement(wb,{title:t,extra:Ie.a.createElement(Zk,{diagram:n})})};Uk.defaultProps={title:zn("泳道数"),onChange:function(){}},Uk.propTypes={title:_e.a.string,diagram:_e.a.object},Uk.key="LaneNumberControl";var Kk=[{name:zn("泳道"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return Sn(e)}))},controls:[{display:function(e){return 1===e.length&&Sn(e[0])},Control:Uk},{path:"fill.color",Control:sk}]},{name:zn("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return Sn(e)}))},controls:[{path:"stroke.color",Control:uk},{path:"stroke.width",Control:dk},{Control:hk}]},{name:zn("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return Sn(e)}))},controls:[{Control:gk}]}];function Qk(e){if(e.length<1)return!1;var t=e[0],n=jn(t)?t.parent:void 0;return!!n&&e.every((function(e){return e.parent===n}))}var Jk=[{name:zn("泳道"),tabKey:"style",condition:function(e){return Qk(e)},controls:[{display:function(e){return Qk(e)},Control:Uk},{path:"fill.color",Control:sk}]}],$k=[{name:zn("节点"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return wn(e)}))},controls:[{path:"fill.color",Control:sk}]},{name:zn("边框"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return wn(e)}))},controls:[{path:"stroke.color",Control:uk},{path:"stroke.width",Control:dk},{Control:hk}]},{name:zn("不透明度"),tabKey:"style",condition:function(e){return e.length>0&&e.every((function(e){return wn(e)}))},controls:[{Control:gk}]},{name:zn("编辑"),tabKey:"style",condition:function(e){return 1===e.length&&e.every((function(e){return wn(e)}))},controls:[{Control:function(e){var t=e.diagram;return Ie.a.createElement(Ye.a,{block:!0,onClick:function(){t.command.execute("OpenDslEditNote")}},zn("编辑"))}}]}];rt(".lake-diagram-properties-viewport .lake-diagram-control-extra {\n  display: inline-block;\n  width: auto;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected-name {\n  display: inline-block;\n  padding-left: 8px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 30px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected .lake-icon {\n  padding: 0 8px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected .lake-properties-viewport-dropdown-icon {\n  padding: 0 8px;\n}\n");var ew={WYSIWYG:{name:zn("与编辑一致"),icon:"viewport-option-WYSIWYG"},adapt:{name:zn("自动适配"),icon:"viewport-option-WYSIWYG"}};function tw(e){var t=e.onChange,n=e.viewportOption,r=ew[n]||ew.adapt;return Ie.a.createElement(wb,{className:"lake-diagram-properties-viewport",title:zn("默认窗口"),extra:Ie.a.createElement(Xe.a,{trigger:["click"],overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,onClick:function(e){var n=e.key;t(n)}},Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-properties-viewport-item",key:"WYSIWYG"},ew.WYSIWYG.name),Ie.a.createElement(Ve.a.Item,{className:"lake-diagram-properties-viewport-item",key:"adapt"},ew.adapt.name)),placement:"bottomRight"},Ie.a.createElement("div",{className:"lake-diagram-properties-viewport-selected"},Ie.a.createElement("span",{className:"lake-diagram-properties-viewport-selected-name"},r.name),Ie.a.createElement(yb,{className:"lake-properties-viewport-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}tw.defaultProps={viewportOption:"adapt",onChange:function(){}},tw.propTypes={viewportOption:_e.a.string,onChange:_e.a.func.isRequired},tw.key="ViewportControl",rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control .lake-diagram-canvas-background-color {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 32px;\n}\n.lake-diagram-control.disabled .lake-diagram-canvas-background-color {\n  display: none;\n}\n"),zn("画布颜色"),_e.a.string,_e.a.object,rt("/* stylelint-disable */\n.lake-board-theme-picker-container.lake-board-properties-theme-picker-container {\n  width: 100%;\n  padding: 12px 1px;\n  box-shadow: none;\n}\n.lake-board-theme-picker-container.lake-board-properties-theme-picker-container .lake-board-theme-picker-item-container {\n  width: 118px;\n  height: 86px;\n}\n");var nw={Control:tw,props:{}},rw=[{name:zn("阅读页配置"),tabKey:"global",condition:function(e){return 0===e.length},controls:[nw]}];function aw(e){var t=e.diagram,n=e.onClose;Object.assign(nw.props,e.viewportOptionProps);var r={tabs:[{name:zn("样式"),key:"style"},{name:zn("文本"),key:"text"},{name:zn("排列"),key:"arrangement"},{name:zn("全局"),key:"global"}],className:"lake-diagram-properties-board",menus:[].concat(rw).concat(lk).concat(kk).concat(wk).concat(Kk).concat(Jk).concat($k).concat(Yk).concat(Dk).concat(Vk).concat(Wk),diagram:t,emptyImg:"https://gw.alipayobjects.com/zos/bmw-prod/209ef531-e33b-4e55-8273-5b56b6df44be.svg"};return Ie.a.createElement("div",{className:"lake-diagram-properties-board-wrapper","data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-properties-board-header"},Ie.a.createElement("span",{className:"lake-diagram-properties-board-header-title"},zn("设置")),Ie.a.createElement("span",{className:"lake-diagram-properties-board-header-close-button",onClick:n})),Ie.a.createElement("div",{className:"lake-diagram-properties-body-wrapper"},Ie.a.createElement(kb,r)))}rt(".lake-diagram-properties-board-wrapper {\n  height: 100%;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-body-wrapper {\n  height: calc(100% - 40px);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-left: 1px solid var(--yq-border-primary);\n  border-bottom: 1px solid var(--yq-border-primary);\n  padding: 4px 8px;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-title {\n  margin: 4px 8px;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-close-button {\n  margin-right: 8px;\n  width: 16px;\n  height: 16px;\n  display: block;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/3a5cc682-0502-44f1-80cf-4a8de2d89e1e.svg);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-close-button:hover {\n  cursor: pointer;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board {\n  background-color: var(--yq-white);\n  top: 0;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .ant-radio-button-wrapper {\n  background: var(--yq-bg-primary);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab {\n  flex-grow: inherit;\n  padding: 8px 0;\n  margin: 0 16px;\n  border-bottom: 2px solid rgba(0, 0, 0, 0);\n  animation: none;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab.ant-tabs-tab-active {\n  border-bottom: 2px solid black;\n}\n"),aw.defaultProps={diagram:null,onClose:function(){},menus:[],viewportOptionProps:{}},aw.propTypes={diagram:_e.a.object,onClose:_e.a.func,menus:_e.a.array,viewportOptionProps:_e.a.object};var iw=function(e){var t=e.name,n=e.diagram,r=e.selections,a=0===r.length||r.some((function(e){return e.locked})),i=Object(Ne.useState)({}),o=b()(i,2),c=o[0],l=o[1],s=n.contentEditorPlus,u=c.bold;return Object(Ne.useEffect)((function(){function e(e){var t=e.query;l(t)}return n&&(s.on("querychange",e),s.emitQueryChange()),function(){s.off("querychange",e)}}),[n]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:a,placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-bold"}),className:ze()({active:u}),onClick:function(e){e.stopPropagation(),s.execCommand("bold")}})))};iw.propTypes={title:_e.a.string,selections:_e.a.array,name:_e.a.string,execCommand:_e.a.func,diagram:_e.a.object};var ow=function(e){var t=e.name,n=e.diagram,r=e.title,a=e.disabled;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:a,placement:"top",title:r},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-link"}),onClick:function(e){e.preventDefault(),e.stopPropagation(),n.command.execute("CreateLink")}})))};ow.propTypes={title:_e.a.string,name:_e.a.string,execCommand:_e.a.func,diagram:_e.a.object,disabled:_e.a.oneOfType([_e.a.bool,_e.a.func])};var cw=function(e){var t=e.name,n=e.title,r=e.diagram;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:!1,placement:"top",title:n},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-dsl-edit"}),onClick:function(){r.command.execute("OpenDslEditNote")}})))},lw=function(e){var t=e.name,n=e.onProperties,r=e.title;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:!1,placement:"top",title:r},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-board-properties"}),onClick:n})))};lw.defaultProps={onProperties:function(){}},lw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,onProperties:_e.a.func},rt(".lake-diagram-board-color-pick-container {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 0;\n  min-width: 74px;\n}\n");var sw=function(e){var t,n=e.name,r=e.diagram,a=Object(Ne.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=r.contentEditorPlus;r&&(null==r||null===(t=r.theme)||void 0===t||t.values.palette),Object(Ne.useEffect)((function(){function e(e){var t=e.query;c(t)}return r&&(l.on("querychange",e),l.emitQueryChange()),function(){l.off("querychange",e)}}),[r]);var s="#"+Y()(o.color).toHex().toUpperCase(),u=Object(Ne.useState)(s||tr),d=b()(u,2),f=d[0],h=d[1],p=Object(Ne.useState)(!1),m=b()(p,2);function y(e){h(e),l.execCommand("foreColor",e)}return m[0],m[1],Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(fx,{color:f,defaultColor:e.defaultColor,onSelect:y,onClear:function(){return y("rgba(0, 0, 0, 0)")},diagram:r,transSVG:Ie.a.createElement(Ye.a,{"data-testid":n},Ie.a.createElement("span",{style:{marginTop:"5px"}},Ie.a.createElement(dx,{type:"t-font-color",fill:s})))},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":n},Ie.a.createElement("span",{style:{marginTop:"5px"}},Ie.a.createElement(dx,{type:"t-font-color",fill:s}))))))};sw.defaultProps={defaultColor:"transparent"},sw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,currColor:_e.a.string,defaultColor:_e.a.string},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .lake-diagram-dropdown-item {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  text-align: left;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item.active {\n  background: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item-selected {\n  background: none;\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var uw=function(e){return Ie.a.createElement(Ve.a,{className:ze()("lake-diagram-contextual-toolbar-dropdown-menu lake-diagram-contextual-toolbar-text-h-align",e.menuClassName),onSelect:e.onSelect,"data-lake_prevent_click_unselect":"true"},e.data.map((function(t){return Ie.a.createElement(Ve.a.Item,{key:t.key},Ie.a.createElement("span",{className:ze()("lake-icon lake-diagram-dropdown-item",{"lake-icon-success":t.key===e.currIcon})}),Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon," lake-diagram-dropdown-item")}),Ie.a.createElement("span",{className:"lake-diagram-dropdown-item"},t.title))})))},dw="center",fw=[{key:"left",icon:"left",title:"左对齐"},{key:"center",icon:"center",title:"居中对齐"},{key:"right",icon:"right",title:"右对齐"},{key:"justify",icon:"justify",title:"两端对齐"}],hw=fw.map((function(e){return e.key}));uw.propTypes={title:_e.a.string,menuClassName:_e.a.string,data:_e.a.array,onSelect:_e.a.func,currIcon:_e.a.string};var pw=function(e){var t=e.name,n=e.diagram,r=n.contentEditorPlus,a=Object(Ne.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=Object(Ne.useState)(!1),s=b()(l,2),u=s[0],d=s[1],f=o.textAlign;return hw.includes(f)||(f=dw),Object(Ne.useEffect)((function(){function e(e){var t=e.query;c(t)}return n&&(r.on("querychange",e),r.emitQueryChange()),function(){r.off("querychange",e)}}),[n]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement(uw,{data:fw,onSelect:function(e){!function(e){"justify"===e?r.execCommand("justifyFull"):r.execCommand("justify".concat(e&&e[0].toUpperCase()+e.slice(1)))}(e.key),d(!1)},currIcon:f}),placement:"bottomCenter",trigger:"click",visible:u,onVisibleChange:function(e){d(e)}},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t,onClick:function(){return d(!0)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(f)})))))};pw.defaultProps={defaultAlign:dw},pw.propTypes={title:_e.a.string,data:_e.a.array,name:_e.a.string,diagram:_e.a.object,defaultAlign:_e.a.string},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n.contextual-text-size-font-size-menu {\n  min-width: 104px;\n}\n.contextual-text-size-font-size-menu .ant-dropdown-menu-item {\n  text-align: center;\n  position: relative;\n}\n.contextual-text-size-font-size-menu .ant-dropdown-menu-item .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  left: 12px;\n  top: 9px;\n}\n");var mw=function(e){var t=e.name,n=e.diagram,r=Object(Ne.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=n.contentEditorPlus,l=i.fontSize;return Object(Ne.useEffect)((function(){function e(e){var t=e.query;o(t)}return n&&(c.on("querychange",e),c.emitQueryChange()),function(){c.off("querychange",e)}}),[n]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{trigger:["click"],value:l,onChange:function(e){return c.execCommand("fontSize",parseInt(e.target.value))},overlay:Ie.a.createElement(Ve.a,{"data-lake_prevent_click_unselect":!0,className:"lake-user-select-none contextual-text-size-font-size-menu",selectedKeys:[l&&l.toString()],onClick:function(e){var t=e.key;return c.execCommand("fontSize",parseInt(t))}},[12,14,15,16,18,22,24,32,36,48,64,92].map((function(e){return Ie.a.createElement(Ve.a.Item,{key:e},e===l&&Ie.a.createElement("span",{className:"lake-icon lake-icon-success"}),e,"px")}))),placement:"bottomCenter"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"text-msg"}," ",l?"".concat(l,"px"):e.defaultFontSize," ")))))};mw.defaultProps={defaultFontSize:"14px"},mw.propTypes={title:_e.a.string,data:_e.a.array,name:_e.a.string,selections:_e.a.array,diagram:_e.a.object,defaultFontSize:_e.a.string},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .lake-diagram-dropdown-item {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  text-align: left;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item.active {\n  background: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item-selected {\n  background: none;\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var yw=function(e){return Ie.a.createElement(Ve.a,{className:ze()("lake-diagram-contextual-toolbar-dropdown-menu lake-diagram-contextual-toolbar-text-v-align",e.menuClassName),onSelect:e.onSelect,"data-lake_prevent_click_unselect":"true"},e.data.map((function(t){return Ie.a.createElement(Ve.a.Item,{key:t.key},Ie.a.createElement("span",{className:ze()("lake-icon lake-diagram-dropdown-item",{"lake-icon-success":t.key===e.currIcon})}),Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon," lake-diagram-dropdown-item")}),Ie.a.createElement("span",{className:"lake-diagram-dropdown-item"},t.title))})))};yw.propTypes={title:_e.a.string,menuClassName:_e.a.string,data:_e.a.array,onSelect:_e.a.func,currIcon:_e.a.string};var vw=function(e){var t=e.name,n=e.selections,r=Object(Ne.useState)(!1),a=b()(r,2),i=a[0],o=a[1],c=e.get(n,"textVerticalAlign");return ur.includes(c)||(c=lr),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{disabled:!0,overlay:Ie.a.createElement(yw,{data:sr,onSelect:function(t){!function(t){e.execCommand("textVerticalAlign",t,us(n))}(t.key),o(!1)},currIcon:c}),placement:"bottomCenter",trigger:"click",visible:i,onVisibleChange:function(e){o(e)}},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t,onClick:function(){return o(!0)}},Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(c)})))))};vw.defaultProps={defaultAlign:lr},vw.propTypes={title:_e.a.string,data:_e.a.array,name:_e.a.string,selections:_e.a.array,defaultAlign:_e.a.string,execCommand:_e.a.func.isRequired,get:_e.a.func.isRequired},rt(".lake-diagram-board-color-pick-container {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 0;\n  min-width: 74px;\n}\n");var gw="#e8e8e8",bw=function(e){var t,n=e.name,r=e.diagram,a=e.selections,i=a.every((function(e){return e.isMindmap})),o=Object(Ne.useState)(e.defaultColor),c=b()(o,2),l=c[0],s=c[1],u=Object(Ne.useState)(!1),d=b()(u,2);d[0],d[1];var f=Object(Ne.useState)(null),h=b()(f,2),p=h[0],m=h[1];r&&(null==r||null===(t=r.theme)||void 0===t||t.values.palette);var y=function(e){var t=Y()(e).toRgb();return.3*t.r+.59*t.g+.11*t.b>=248},v=function(t){s(t),i?e.execCommand("border.fill",t,a):e.execCommand("fill.color",t,us(a)),y(t)?m(gw):m(null)};return Object(Ne.useEffect)((function(){if(a&&a.length>0){var t=i?"border.fill":"fill.color",n=e.get(a,t),r="multiValue"===n?"#FFFFFF":n;s(r),y(r)?m(gw):m(null)}return function(){}}),[]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(fx,{color:l,defaultColor:e.defaultColor,onSelect:v,onClear:function(){return v("rgba(0, 0, 0, 0)")},diagram:r,transSVG:Ie.a.createElement(Ye.a,{"data-testid":n},Ie.a.createElement(dx,{type:"t-bg-color",fill:l,stroke:p}))},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":n},Ie.a.createElement(dx,{type:"t-bg-color",fill:l,stroke:p})))))};function xw(e){var t=Object(Ne.useRef)(),n=e.width,r=e.height,a=e.shape,i=a&&oc.find((function(e){return e.name===a}));return Object(Ne.useEffect)((function(){if(t.current&&i){var e=new eh({stencil:i,width:n,height:r,noFill:!0,stroke:Xf("text"),fill:"transparent"}).rendererElement;Array.from(t.current.children,(function(e){return e.remove()})),t.current.appendChild(e)}}),[t,n,r,i]),i?Ie.a.createElement("svg",{ref:t,width:n,height:r,viewBox:[0,0,n,r].join(" ")}):null}bw.defaultProps={defaultColor:"transparent"},bw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,currColor:_e.a.string,defaultColor:_e.a.string,execCommand:_e.a.func,get:_e.a.func,disabled:_e.a.oneOfType([_e.a.bool,_e.a.func])},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-contextual-shape-current {\n  width: 100%;\n  height: 32px;\n  min-width: 34px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagrm-contexual-shape-select-container {\n  max-height: 272px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  display: flex;\n}\n"),xw.propTypes={width:_e.a.number,height:_e.a.number,shape:_e.a.string};var kw=function(e){var t,n=e.name,r=e.selections,a=e.get(r,"shape"),i=(null===(t=oc[oc.findIndex((function(e){return e.name===a}))])||void 0===t?void 0:t.category)||"basic";return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement("div",{className:"lake-diagrm-contexual-shape-select-container"},Ie.a.createElement(lb,{onSelect:function(t){var n=t.key;e.execCommand("shape",n,r)},groups:[i]})),key:e.key,placement:"bottomCenter",trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":n},Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-shape-current",{"lake-diagam-multi-properties-selection":"multiValue"===a})},Ie.a.createElement(xw,{shape:a,width:30,height:30}))))))};function ww(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ww(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ww(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}kw.propTypes={title:_e.a.string,command:_e.a.string,name:_e.a.string,onSelect:_e.a.func,key:_e.a.string,diagram:_e.a.object,selections:_e.a.array,execCommand:_e.a.func,get:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-stroke-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn {\n  padding: 0;\n  width: 32px;\n  line-height: 30px;\n  margin-right: 8px;\n  border: none;\n  background: none;\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn.active {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-stroke-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-toolbar-separator {\n  height: 1px;\n  background: var(--yq-border-primary);\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner .ant-input-number-focused {\n  box-shadow: none;\n}\n.lake-diagram-board-contextual-stroke-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  max-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var Aw=function(e){var t=e.diagram,n=e.selections,r=e.strokeProps,a=e.setStrokeProps,i=Object(Ne.useState)(r.style?"dash":"none"),o=b()(i,2),c=o[0],l=o[1],s=function(t){if((t=Number(t))>=1&&t<=10){var i=Math.min(Math.max(t,1),10);i!==r.width&&(a(Cw(Cw({},r),{},{width:i})),e.execCommand("stroke.width",i,n))}},u=function(t){e.onSelect&&e.onSelect(t)},d=function(t){e.execCommand("stroke.style",t,n)};return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-stroke-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},n.every((function(e){return!Ln(e)}))&&Ie.a.createElement(Ie.a.Fragment,null,Ie.a.createElement("div",{className:"lake-diagram-contextual-stroke-dropdown-row"},Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-none"}),className:ze()("geo-btn",{active:"none"===c}),onClick:function(e){e.preventDefault(),l("none"),d(null)}}),Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-dash"}),target:"dash",className:ze()("geo-btn",{active:"dash"===c}),onClick:function(e){e.preventDefault(),l("dash"),d("dash")}})),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"})),Ie.a.createElement("div",{className:"lake-diagram-contextual-stroke-dropdown-row"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-width-control"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-width-inner"},Ie.a.createElement($x,{min:1,max:10,value:r.width,onInput:s,onStep:s}))),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-color"},Ie.a.createElement(fx,{color:r.color,defaultColor:e.defaultColor,onSelect:u,onClear:function(){return u("rgba(0, 0, 0, 0)")},transSVG:Ie.a.createElement(dx,{type:"context-cb-trans"}),diagram:t},Ie.a.createElement("div",{className:ze()("lake-diagram-stroke"),style:{backgroundColor:r.color}})))))};Aw.propTypes={title:_e.a.string,colorBadge:_e.a.object,name:_e.a.string,className:_e.a.string,diagram:_e.a.object,onSelect:_e.a.func,defaultColor:_e.a.string,strokeProps:_e.a.object,selections:_e.a.array,setStrokeProps:_e.a.func,execCommand:_e.a.func};var Ow=function(e){var t=e.name,n=e.selections,r=Object(Ne.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)(!1),l=b()(c,2),s=l[0],u=l[1];return Object(Ne.useEffect)((function(){return n&&n.length>0&&o(n[0].stroke),function(){}}),[]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{visible:s,onVisibleChange:function(e){u(e)},overlay:Ie.a.createElement(Aw,De()({setStrokeProps:o,strokeProps:i,onSelect:function(t){o(Cw(Cw({},i),{},{color:t})),e.execCommand("stroke.color",t,n)}},e)),placement:"bottomCenter",trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement(dx,{type:"stroke-color",stroke:i.color})))))};Ow.defaultProps={defaultColor:"transparent"},Ow.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,currColor:_e.a.string,defaultColor:_e.a.string,execCommand:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-geometry-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-geometry-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Ew=function(e){var t=e.diagram,n=Object(Ne.useState)({}),r=b()(n,2),a=r[0],i=r[1],o=t.contentEditorPlus;Object(Ne.useEffect)((function(){function e(e){var t=e.query;i(t)}return t&&(o.on("querychange",e),o.emitQueryChange()),function(){o.off("querychange",e)}}),[t]);var c=a.bold,l=a.italic,s=a.strikethrough,u=a.underline;return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-geometry-text-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ie.a.createElement(Ye.a,{className:ze()({active:c}),icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return o.execCommand("bold")}}),Ie.a.createElement(Ye.a,{className:ze()({active:l}),onClick:function(){return o.execCommand("italic")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Ie.a.createElement(Ye.a,{className:ze()({active:s}),onClick:function(){return o.execCommand("strikethrough")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Ie.a.createElement(Ye.a,{className:ze()({active:u}),onClick:function(){return o.execCommand("underline")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ie.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ie.a.createElement(mw,De()({},e,{textStyle:a,title:zn("字号")})),Ie.a.createElement(sw,De()({},e,{textStyle:a,title:zn("字色")})),Ie.a.createElement(pw,De()({},e,{textStyle:a,title:zn("水平对齐")})),Ie.a.createElement(vw,De()({},e,{title:zn("竖直对齐")}))))};Ew.defaultProps={defaultColor:"transparent"},Ew.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,className:_e.a.string};var Pw=function(e){var t=e.name,n=Object(Ne.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{trigger:"click",visible:a,onVisibleChange:function(e){i(e)},overlay:Ie.a.createElement(Ew,e)},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};Pw.defaultProps={defaultColor:"transparent"},Pw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-toolbar-dropdown .lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu::before {\n  display: none;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu::after {\n  display: none;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-diagram-dropdown-item {\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item {\n  min-width: 32px;\n  height: 32px;\n  padding: 0 6px;\n  border-radius: 3px;\n  text-align: center;\n  line-height: 32px;\n  margin: 0 2px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item-selected {\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var Sw=function(e){var t=e.onSelect,n=e.source,r=e.marker;return Ie.a.createElement(Ve.a,{className:ze()("lake-diagram-contextual-toolbar-dropdown-menu"),"data-lake_prevent_click_unselect":"true",onSelect:t,style:{padding:"5px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)"}},Yu.map((function(e){return Ie.a.createElement(Ve.a.Item,{key:e,className:ze()({active:e===r})},Ie.a.createElement("span",{className:ze()("lake-icon lake-icon-contextual-".concat(e," lake-diagram-dropdown-item"),{source:n})}))})))};Sw.propTypes={source:_e.a.bool,title:_e.a.string,className:_e.a.string,diagram:_e.a.object,onSelect:_e.a.func,marker:_e.a.string};var jw=function(e){var t=e.name,n=e.selections,r=e.type,a=Object(Ne.useState)(null),i=b()(a,2),o=i[0],c=i[1],l=Object(Ne.useState)(e.defaultIcon),s=b()(l,2),u=s[0],d=s[1],f=Object(Ne.useState)(!1),h=b()(f,2),p=h[0],m=h[1];return Object(Ne.useEffect)((function(){if(n&&n.length>0){var e=n[0][r];e.marker?c(e.marker):c("none"),Yu.filter((function(t){return t===e.marker})).forEach((function(e){return d("contextual-".concat(e))}))}return function(){}}),[]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement(Sw,De()({onSelect:function(t){var a=t.key;e.execCommand("".concat(r,".marker"),"none"===a?null:a,n),c(a),Yu.filter((function(e){return e===a})).forEach((function(e){return d("contextual-".concat(e))})),m(!1)},marker:o,source:"source"===r,trigger:"click"},e)),placement:"bottomCenter",trigger:"click",visible:p,onVisibleChange:function(e){m(e)}},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t,onClick:function(){return m(!0)}},Ie.a.createElement("span",{className:ze()("lake-icon lake-icon-".concat(u),{source:"source"===r})})))))};function Rw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rw(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}jw.defaultProps={defaultIcon:"contextual-stroke-none"},jw.propTypes={type:_e.a.string,title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,defaultIcon:_e.a.string,execCommand:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-line-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn .lake-icon {\n  font-size: 18px;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-toolbar-separator {\n  height: 1px;\n  background: var(--yq-border-primary);\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.lake-diagram-board-contextual-line-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-line-width-control .lake-diagram-board-contextual-line-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-line-width-control .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-line-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  min-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var Lw=function(e){var t=e.diagram,n=e.selections,r=e.strokeProps,a=e.setStrokeProps,i=Object(Ne.useState)(r.style?"dash":"none"),o=b()(i,2),c=o[0],l=o[1],s=function(t){if((t=Number(t))>=1&&t<=10){var i=Math.min(Math.max(t,1),10);i!==r.width&&(a(Mw(Mw({},r),{},{width:i})),e.execCommand("stroke.width",i,n))}},u=function(t){e.onSelect&&e.onSelect(t)},d=function(t){e.execCommand("stroke.style",t,n)},f=function(t){e.execCommand("shape",t,n)};return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-line-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-straight-line"}),className:ze()({active:"straight"===e.currShape}),onClick:function(t){t.preventDefault(),f("straight"),e.setCurrShape("straight")}}),Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-curve-line"}),target:"dash",className:ze()({active:"curve"===e.currShape}),onClick:function(t){t.preventDefault(),f("curve"),e.setCurrShape("curve")}}),Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-elbow-line"}),target:"dash",className:ze()({active:"elbow"===e.currShape}),onClick:function(t){t.preventDefault(),f("elbow"),e.setCurrShape("elbow")}})),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ie.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-none"}),className:ze()({active:"none"===c}),onClick:function(e){e.preventDefault(),l("none"),d(null)}}),Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-dash"}),target:"dash",className:ze()({active:"dash"===c}),onClick:function(e){e.preventDefault(),l("dash"),d("dash")}})),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ie.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-line-width-control"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-line-width-inner"},Ie.a.createElement($x,{min:1,max:10,value:r.width,onStep:s,onInput:s}))),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-line-color"},Ie.a.createElement(fx,{color:r.color,defaultColor:e.defaultColor,onSelect:u,onClear:function(){return u("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ie.a.createElement(dx,{type:"context-cb-trans"})},Ie.a.createElement("div",{className:ze()("lake-diagram-stroke"),style:{backgroundColor:r.color}})))))};Lw.propTypes={title:_e.a.string,colorBadge:_e.a.object,name:_e.a.string,className:_e.a.string,diagram:_e.a.object,onSelect:_e.a.func,defaultColor:_e.a.string,strokeProps:_e.a.object,selections:_e.a.array,setStrokeProps:_e.a.func,currShape:_e.a.string,setCurrShape:_e.a.func,execCommand:_e.a.func};var Bw=function(e){var t=e.name,n=e.selections,r=Object(Ne.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)(e.defaultShape),l=b()(c,2),s=l[0],u=l[1];return Object(Ne.useEffect)((function(){return n&&n.length>0&&(o(n[0].stroke),u(n[0].shape)),function(){}}),[]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement(Lw,De()({setStrokeProps:o,strokeProps:i,onSelect:function(t){o(Mw(Mw({},i),{},{color:t})),e.execCommand("stroke.color",t,n)},currShape:s,setCurrShape:u},e)),placement:"bottomCenter",trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-".concat(s,"-line")})))))};Bw.defaultProps={defaultShape:"straight"},Bw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,defaultShape:_e.a.string,execCommand:_e.a.func};var Dw=function(e){var t=e.title,n=e.name,r=e.diagram;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command","data-lake_prevent_click_unselect":"true"},Ie.a.createElement(qe.a,{placement:"top",title:t},Ie.a.createElement(Ye.a,{"data-testid":n,onClick:function(){r.command.execute("LineSwapEndpoint",{autoSelect:!1})}},Ie.a.createElement("span",{className:ze()("lake-icon lake-icon-".concat(n))}))))};rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-line-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-line-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Nw=function(e){var t=e.diagram,n=Object(Ne.useState)({}),r=b()(n,2),a=r[0],i=r[1],o=t.contentEditorPlus;Object(Ne.useEffect)((function(){function e(e){var t=e.query;i(t)}return t&&(o.on("querychange",e),o.emitQueryChange()),function(){o.off("querychange",e)}}),[t]);var c=a.bold,l=a.italic,s=a.strikethrough,u=a.underline;return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-line-text-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ie.a.createElement(Ye.a,{className:ze()({active:c}),icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return o.execCommand("bold")}}),Ie.a.createElement(Ye.a,{className:ze()({active:l}),onClick:function(){return o.execCommand("italic")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Ie.a.createElement(Ye.a,{className:ze()({active:s}),onClick:function(){return o.execCommand("strikethrough")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Ie.a.createElement(Ye.a,{className:ze()({active:u}),onClick:function(){return o.execCommand("underline")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ie.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ie.a.createElement(mw,De()({},e,{textStyle:a,title:zn("字号")})),Ie.a.createElement(sw,De()({},e,{textStyle:a,title:zn("字色")})),Ie.a.createElement(pw,De()({},e,{textStyle:a,title:zn("水平对齐")}))))};Nw.defaultProps={defaultColor:"transparent"},Nw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,className:_e.a.string};var Iw=function(e){var t=e.name,n=Object(Ne.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{trigger:"click",visible:a,onVisibleChange:function(e){i(e)},overlay:Ie.a.createElement(Nw,e)},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};Iw.defaultProps={defaultColor:"transparent"},Iw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array};var Tw=function(e){var t=e.name,n=e.title,r=e.diagram,a=e.boardWebProxy;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:!1,placement:"top",title:n},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-abstract"}),onClick:function(){a&&a.spm&&a.spm.click("b4693.c116586.d241682",{"toolbar(MindmapAppendAbstract)":1}),r.command.execute("MindmapAppendAbstract")}})))};Tw.defaultProps={onProperties:function(){}},Tw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,onProperties:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-layout-current {\n  width: 100%;\n  height: 30px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-contextual-command {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-contextual-command > * {\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-contextual-mindmap-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn {\n  padding: 0;\n  width: 32px;\n  line-height: 30px;\n  margin-left: 3px;\n  margin-right: 3px;\n  border: none;\n  background: none;\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn.active {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-mindmap-dropdown .lake-diagram-contextual-mindmap-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-mindmap-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner .ant-input-number-focused {\n  box-shadow: none;\n}\n.lake-diagram-board-contextual-mindmap-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  max-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var _w=function(e){var t=e.layouts,n=e.selectedKey,r=e.setVisible,a=e.visible;return Ie.a.createElement("div",{className:"lake-diagram-layout-dropdown","data-lake_prevent_click_unselect":"true"},t.map((function(t){var i=t.key;return Ie.a.createElement("div",{key:i,"data-lake_prevent_click_unselect":"true",className:ze()("lake-diagram-layout-thumb",i,{selected:i===n}),onClick:function(){r(!a),e.onSelect(i)}},Ie.a.createElement("div",{className:i}))})))};_w.propTypes={title:_e.a.string,diagram:_e.a.object,layouts:_e.a.array,selectedKey:_e.a.string,setVisible:_e.a.func,onSelect:_e.a.func,visible:_e.a.bool};var Fw=function(e){var t=e.name,n=e.selections.filter((function(e){return e.isMindmap})),r=Oi(n,wb),a=n.map((function(e){return e.upDirection}));n.map((function(e){return e.upLayoutType}));var i=Object(Ne.useState)(!1),o=b()(i,2),c=o[0],l=o[1],s=Ai.filter((function(e){if(n.every((function(e){return e.isStem})))return!0;var t=e.key.split("-")[0],r=n.some((function(e){var n=e.upLayoutType,r=e.isAbstract;return Si(n,t,r)})),i=!e.directions.every((function(e){return a.every((function(t){return Pi(t,e)}))}));return!r&&!i}));function u(e){0!==s.length&&l(e)}return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement(_w,De()({setVisible:u,selectedKey:r,layouts:s,onSelect:function(t){e.execCommand("layout",Ei(t),n)},visible:c},e)),placement:"bottomCenter",onClick:function(){return u(!c)},visible:c,onVisibleChange:function(e){return u(e)},trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-layout-current"),"data-testid":t},Ie.a.createElement("div",{className:ze()("lake-diagram-layout-thumb",{"lake-diagam-multi-properties-selection":"multiValue"===r})},Ie.a.createElement("div",{className:r}))))))};Fw.defaultProps={selections:[]},Fw.propTypes={title:_e.a.string,className:_e.a.string,diagram:_e.a.object,selections:_e.a.array,execCommand:_e.a.func,name:_e.a.string};var zw=function(e){var t=function(t){e.execCommand("border.shape",t,e.selections),e.setShape(t)},n=e.diagram.selector.selections.every((function(e){return!e.isAbstract}));return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-mindmap-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},n?Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-mindmap-line"}),className:ze()("mindmap-btn",{active:"line"===e.shape}),onClick:function(e){e.preventDefault(),t("line")}}):null,Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-mindmap-rect"}),className:ze()("mindmap-btn",{active:"rect"===e.shape}),onClick:function(e){e.preventDefault(),t("rect")}}),Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-mindmap-capsule"}),className:ze()("mindmap-btn",{active:"capsule"===e.shape}),onClick:function(e){e.preventDefault(),t("capsule")}})))};zw.propTypes={title:_e.a.string,className:_e.a.string,borderProps:_e.a.object,selections:_e.a.array,execCommand:_e.a.func,shape:_e.a.string,setShape:_e.a.func,isLine:_e.a.bool};var qw=function(e){var t=e.name,n=e.selections,r=Object(Ne.useState)(e.get(n,"border.shape","line")||null),a=b()(r,2),i=a[0],o=a[1];return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{overlay:Ie.a.createElement(zw,De()({shape:i,isLine:"line"===i,setShape:o},e)),placement:"bottomCenter",trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-layout-current",{"lake-diagam-multi-properties-selection":"multiValue"===i})},Ie.a.createElement("span",{className:"lake-icon lake-icon-mindmap-".concat(i)}))))))};function Yw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yw(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}qw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,defaultShape:_e.a.string,get:_e.a.func};var Gw=function(e){var t=e.diagram,n=e.selections,r=e.strokeProps,a=e.setStrokeProps,i=function(t){var i=Math.min(Math.max(t,1),10);i!==r.strokeWidth&&(a(Hw(Hw({},r),{},{strokeWidth:i})),e.execCommand("border.stroke-width",i,n))},o=function(e){i(e.target.value)},c=function(t){e.onSelect&&e.onSelect(t)};return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-mindmap-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-control"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-inner"},Ie.a.createElement($x,{min:1,max:10,value:r.strokeWidth,onBlur:o,onPressEnter:o,onStep:i}))),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-color"},Ie.a.createElement(fx,{color:r.strokeColor,defaultColor:e.defaultColor,onSelect:c,onClear:function(){return c("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ie.a.createElement(dx,{type:"context-cb-trans"})},Ie.a.createElement(qe.a,{placement:"top",title:zn("边框颜色")},Ie.a.createElement("div",{className:ze()("lake-diagram-stroke"),style:{backgroundColor:r.strokeColor}}))))))};Gw.propTypes={title:_e.a.string,colorBadge:_e.a.object,name:_e.a.string,className:_e.a.string,diagram:_e.a.object,onSelect:_e.a.func,defaultColor:_e.a.string,strokeProps:_e.a.object,selections:_e.a.array,setStrokeProps:_e.a.func,execCommand:_e.a.func};var Xw=function(e){var t=e.name,n=e.selections,r=Object(Ne.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)(!1),l=b()(c,2),s=l[0],u=l[1],d=Object(Ne.useState)(!0),f=b()(d,2),h=f[0],p=f[1];return Object(Ne.useEffect)((function(){if(n&&n.length>0){var t=n.filter((function(e){return e.canStroke()&&e.isMindmap})),r=e.get(t,"border.stroke-width"),a=e.get(n,"border.shape","line")||null,i=e.get(n,"border.stroke","transparent")||null;o({strokeWidth:r,shape:a,strokeColor:i}),p("line"===a)}return function(){}}),[]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{visible:s,onVisibleChange:function(e){u(e)},overlay:Ie.a.createElement(Gw,De()({setStrokeProps:o,strokeProps:i,onSelect:function(t){o(Hw(Hw({},i),{},{strokeColor:t})),e.execCommand("border.stroke",t,n)},isLine:h},e)),placement:"bottomCenter",trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement(dx,{type:"stroke-color",stroke:i.strokeColor})))))};Xw.defaultProps={defaultColor:"transparent"},Xw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,currColor:_e.a.string,defaultColor:_e.a.string,get:_e.a.func,execCommand:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-mindmap-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Vw=function(e){var t=e.diagram,n=Object(Ne.useState)({}),r=b()(n,2),a=r[0],i=r[1],o=t.contentEditorPlus;Object(Ne.useEffect)((function(){function e(e){var t=e.query;i(t)}return t&&(o.on("querychange",e),o.emitQueryChange()),function(){o.off("querychange",e)}}),[t]);var c=a.bold,l=a.italic,s=a.strikethrough,u=a.underline;return Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-mindmap-text-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ie.a.createElement(Ye.a,{className:ze()({active:c}),icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return o.execCommand("bold")}}),Ie.a.createElement(Ye.a,{className:ze()({active:l}),onClick:function(){return o.execCommand("italic")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Ie.a.createElement(Ye.a,{className:ze()({active:s}),onClick:function(){return o.execCommand("strikethrough")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Ie.a.createElement(Ye.a,{className:ze()({active:u}),onClick:function(){return o.execCommand("underline")},icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ie.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Ie.a.createElement(mw,De()({},e,{textStyle:a,title:zn("字号")})),Ie.a.createElement(sw,De()({},e,{textStyle:a,title:zn("字色")})),Ie.a.createElement(pw,De()({},e,{textStyle:a,title:zn("水平对齐")}))))};Vw.defaultProps={defaultColor:"transparent"},Vw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,className:_e.a.string};var Ww=function(e){var t=e.name,n=Object(Ne.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{trigger:"click",visible:a,onVisibleChange:function(e){i(e)},overlay:Ie.a.createElement(Vw,e)},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};function Zw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zw(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ww.defaultProps={defaultColor:"transparent"},Ww.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array};var Kw=function(e){var t=e.diagram,n=e.selections,r=e.treeEdgeProps,a=e.setTreeEdgeProps,i=e.containRoot,o=yt(n.map((function(e){return e.stem}))),c=Object(Ne.useState)(""),l=b()(c,2),s=l[0],u=l[1],d=function(t){var i=Math.min(Math.max(t,1),5);i!==r.width&&(a(Uw(Uw({},r),{},{"stroke-width":i})),e.execCommand("treeEdge.stroke-width",i,n))},f=function(e){d(e.target.value)},h=function(t){e.onSelect&&e.onSelect(t)},p=function(t){e.execCommand("treeEdge.shape",t,o),e.setTreeRootProps({shape:t?"polyline":"none"})};return Object(Ne.useEffect)((function(){return o.length>0&&u(o[0].treeEdge.shape||"none"),function(){}}),[]),Ie.a.createElement("div",{className:ze()("lake-diagram-contextual-mindmap-dropdown",e.className),"data-lake_prevent_click_unselect":"true"},Ie.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-none"}),className:ze()("mindmap-btn",{active:"none"===s}),onClick:function(e){e.preventDefault(),u("none"),p(null)}}),Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-polyline"}),target:"dash",className:ze()("mindmap-btn",{active:"polyline"===s}),onClick:function(e){e.preventDefault(),u("polyline"),p("polyline")}})),!i&&Ie.a.createElement(Ie.a.Fragment,null,Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Ie.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-control"},Ie.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-inner"},Ie.a.createElement($x,{min:1,max:5,value:r["stroke-width"]||e.defaultStrokeWidth,onBlur:f,onPressEnter:f,onStep:d}))),Ie.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-color"},Ie.a.createElement(fx,{color:r.stroke,defaultColor:e.defaultColor,onSelect:h,onClear:function(){return h("rgba(0, 0, 0, 0)")},diagram:t,transSVG:Ie.a.createElement(dx,{type:"context-cb-trans"})},Ie.a.createElement("div",{className:ze()("lake-diagram-stroke"),style:{backgroundColor:r.stroke}}))))))};Kw.defaultProps={defaultStrokeWidth:3},Kw.propTypes={title:_e.a.string,colorBadge:_e.a.object,containRoot:_e.a.bool,name:_e.a.string,className:_e.a.string,diagram:_e.a.object,onSelect:_e.a.func,defaultColor:_e.a.string,treeEdgeProps:_e.a.object,selections:_e.a.array,setTreeEdgeProps:_e.a.func,defaultStrokeWidth:_e.a.number,execCommand:_e.a.func,setTreeRootProps:_e.a.func};var Qw=function(e){var t=e.name,n=e.selections,r=Object(Ne.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ne.useState)({}),l=b()(c,2),s=l[0],u=l[1],d=Object(Ne.useState)(!1),f=b()(d,2),h=f[0],p=f[1],m=n.some((function(e){return e.isStem}));return Object(Ne.useEffect)((function(){if(n&&n.length>0){var e=n[0];o(e.treeEdge),u(e.stem.treeEdge)}return function(){}}),[]),Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{visible:h,onVisibleChange:function(e){p(e)},overlay:Ie.a.createElement(Kw,De()({setTreeEdgeProps:o,setTreeRootProps:u,treeEdgeProps:i,onSelect:function(t){o(Uw(Uw({},i),{},{stroke:t})),e.execCommand("treeEdge.stroke",t,n)},containRoot:m},e)),placement:"bottomCenter",trigger:"click"},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-".concat(s.shape?s.shape:"none")})))))};Qw.defaultProps={defaultColor:"transparent"},Qw.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object,selections:_e.a.array,currColor:_e.a.string,defaultColor:_e.a.string,execCommand:_e.a.func},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-align-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-align-dropdown p {\n  margin-bottom: 0;\n}\n");var Jw=function(e){var t=e.diagram;function n(e,n,r){return t.command.enable(e)&&Ie.a.createElement(qe.a,{title:r},Ie.a.createElement(Ye.a,{icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),onClick:function(){return t.command.execute(e)}}))}return Ie.a.createElement("div",{className:"lake-diagram-contextual-align-dropdown","data-lake_prevent_click_unselect":"true"},Ie.a.createElement("p",null,n("AlignLeft","align-left",zn("左对齐")),n("AlignHCenter","align-h-center",zn("左右居中")),n("AlignRight","align-right",zn("右对齐")),n("DistributeHorizontally","distribute-horizontally",zn("水平均分"))),Ie.a.createElement("p",null,n("AlignTop","align-top",zn("顶对齐")),n("AlignVCenter","align-v-center",zn("上下居中")),n("AlignBottom","align-bottom",zn("底对齐")),n("DistributeVertically","distribute-vertically",zn("垂直均分"))))};Jw.defaultProps={diagram:null},Jw.propTypes={diagram:_e.a.object};var $w=function(e){var t=e.name,n=Object(Ne.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{trigger:"click",visible:a,onVisibleChange:function(e){i(e)},overlay:Ie.a.createElement(Jw,e)},Ie.a.createElement(qe.a,{placement:"top",title:e.title},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-align"})))))};$w.defaultProps={title:"",name:"",diagram:null},$w.propTypes={title:_e.a.string,name:_e.a.string,diagram:_e.a.object};var eC=function(e){var t=e.name,n=e.diagram,r=e.title,a=e.disabled;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:a,placement:"top",title:r},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-group"}),onClick:function(e){e.preventDefault(),e.stopPropagation(),n.command.execute("MakeGroup")}})))};eC.propTypes={title:_e.a.string,name:_e.a.string,execCommand:_e.a.func,diagram:_e.a.object,disabled:_e.a.oneOfType([_e.a.bool,_e.a.func])};var tC=function(e){var t=e.name,n=e.diagram,r=e.title,a=e.disabled;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{disabled:a,placement:"top",title:r},Ie.a.createElement(Ye.a,{"data-testid":t,icon:Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-ungroup"}),onClick:function(e){e.preventDefault(),e.stopPropagation(),n.command.execute("Ungroup")}})))};tC.propTypes={title:_e.a.string,name:_e.a.string,execCommand:_e.a.func,diagram:_e.a.object,disabled:_e.a.oneOfType([_e.a.bool,_e.a.func])};var nC=function(e){var t=e.diagram,n=e.title,r=e.name;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command"},Ie.a.createElement(qe.a,{placement:"top",title:zn(n)},Ie.a.createElement(Ye.a,{"data-testid":r,onClick:function(e){e.preventDefault(),e.stopPropagation(),t.command.execute("Delete",{cells:t.deduplicate(t.selector.selections).map((function(e){return e.model.id}))})}},Ie.a.createElement("span",{className:"lake-icon lake-icon-delete-lane"}))))},rC=function(e){var t=e.diagram,n=e.title;return Ie.a.createElement("div",{className:"lake-diagram-contextual-command",style:{width:"72px"}},Ie.a.createElement(qe.a,{placement:"top",title:zn(n)},Ie.a.createElement(Zk,{diagram:t})))};function aC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aC(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-mindmap-icons-table {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-yuque-grey-4);\n  border-radius: 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 16px 10px 0 10px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-mindmap-icons-table .icon-title {\n  margin-bottom: 6px;\n  margin-left: 4px;\n}\n.lake-diagram-mindmap-icons-table .icons-container {\n  margin-bottom: 22px;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn {\n  border: none;\n  background: none;\n  padding: 2px;\n  height: 26px;\n  width: 26px;\n  margin: 0 4px;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  display: inline-block;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-mindmap-icons-table .icons-container .icon-btn:hover {\n  background: rgba(226, 226, 226, 0.15);\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn:focus {\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn::after {\n  display: none;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn.active {\n  background: var(--yq-yuque-grey-4);\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-table .lake-button-active {\n  background-color: var(--yq-yuque-grey-4);\n}\n.lake-diagram-mindmap-icons-table .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var oC=function(e){var t=e.diagram,n=e.className,r=Object(Ne.useMemo)((function(){return Xn.map((function(e,r){var a=Wn[r];return Ie.a.createElement("div",{key:e},Ie.a.createElement("div",{className:ze()("icon-title",n)},Vn[r]),Ie.a.createElement("div",{className:ze()("icons-container",n)},le()(a).map((function(n){return Ie.a.createElement("img",{className:"icon-btn",key:e+n,src:Un(e,n),id:"insert-icon-".concat(e,"-").concat(n),onClick:function(){var r=t.selector.selections.filter((function(e){return e.isMindmap}));t.command.execute("Update",{id:r.map((function(e){return e.model.id})),model:r.map((function(t){return{icons:iC(iC({},t.model.icons||{}),{},c()({},e,n))}})),notSelect:!0})}})}))))}))}),[]);return Ie.a.createElement("div",{className:ze()("lake-diagram-mindmap-icons-table",n),"data-lake_prevent_click_unselect":"true"},r)},cC=function(e){var t=e.name,n=e.title,r=Object(Ne.useState)(!1),a=b()(r,2),i=a[0],o=a[1];return Ie.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Ie.a.createElement(Xe.a,{trigger:"click",visible:i,onVisibleChange:function(e){o(e)},overlay:Ie.a.createElement(oC,e)},Ie.a.createElement(qe.a,{placement:"top",title:n},Ie.a.createElement(Ye.a,{"data-testid":t},Ie.a.createElement("span",{className:"lake-icon lake-icon-contextual-mindmap-icon"})))))},lC={name:"properties",type:"custom",custom:lw,title:zn("打开设置"),noMini:!0},sC=function(e){return{type:"separator",noMini:e}},uC=function(e){var t=e&&1!==e.length?[]:[sC(),{name:"add-link",type:"custom",custom:ow,title:zn("插入链接"),hotkey:U.ua.macos?"⌘+K":"Ctrl+K"}];return[{name:"contextual-text-size",type:"custom",custom:mw,title:zn("字号"),disabled:!1},sC(),{name:"contextual-text-color",type:"custom",title:zn("字色"),disabled:!1,custom:sw},{name:"contextual-text-h-alignment",title:zn("水平对齐"),type:"custom",custom:pw,disabled:!1},{name:"contextual-text-v-alignment",title:zn("竖直对齐"),type:"custom",custom:vw,disabled:function(e){return!e.selector.selections.some((function(e){return e.canTextVerticalAlign()}))}},{name:"contextual-text-bold",type:"custom",custom:iw,title:zn("加粗"),disabled:!1}].concat(t,[sC(!0),lC])},dC=function(){return[{name:"arrangement",type:"custom",custom:$w,title:zn("排列"),disabled:function(e){return e.selector.selections.filter((function(e){return!e.isLine||e.isLine&&!e.source.id&&!e.target.id})).length<2}},{name:"group",type:"custom",custom:eC,title:zn("成组")},sC(!0)]};function fC(e){var t=e.coord,n=e.overlayClassName,r=Object(Ne.useRef)();if(t){var a="lake-prevent-card-activated lake-diagram-prevent-mouse-select lake-diagram-prevent-mouseleave-reset-focus-point";return Ie.a.createElement(Ke.a,De()({},e,{getPopupContainer:function(){return e.getPopupContainer?e.getPopupContainer():document.querySelector(".yuque-sdk-extra-container")||e.diagram.container},visible:!0,overlayClassName:n?"".concat(n," ").concat(a):a,"data-lake_prevent_click_unselect":!0}),Ie.a.createElement("div",{ref:r,"data-lake_prevent_click_unselect":"true",style:{position:"absolute",left:"".concat(t[0],"px"),top:"".concat(t[1]-16,"px"),pointerEvents:"none",width:"".concat(e.width,"px"),height:"".concat(e.height+32,"px")}}))}return Ie.a.createElement("span",{ref:r})}fC.defaultProps={coord:null,diagram:null,onClose:function(){}},fC.propTypes={coord:_e.a.array,diagram:_e.a.object,onClose:_e.a.func,overlayClassName:_e.a.string,getPopupContainer:_e.a.object,height:_e.a.number,width:_e.a.number},rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-uniform-toolbar-body {\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-uniform-toolbar-separator {\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-contextual-toolbar {\n  display: flex;\n  height: 40px;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 0 6px;\n}\n.lake-diagram-board-contextual-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-left: 4px;\n  margin-right: 4px;\n  height: 100%;\n  border-radius: 5px;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner {\n  background-clip: none;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button {\n  display: flex;\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: auto;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon::before {\n  content: '';\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-command .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-contextual-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-command .ant-btn:hover,\n.lake-diagram-contextual-command .ant-btn.lake-button-active {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-contextual-command .ant-btn:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-contextual-command .ant-btn.lake-button-active {\n  background: rgba(255, 255, 255, 0.12);\n  border-radius: 6px;\n}\n.lake-diagram-contextual-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-command .ant-btn .lake-icon {\n  margin-right: 0;\n  font-size: 18px;\n}\n.lake-diagram-contextual-command .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-command .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-button-popover {\n  padding-top: 0;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-inner {\n  background-color: inherit;\n  box-shadow: none;\n  border-radius: 0;\n  background-clip: none;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n  stroke: '@yuque-grey-4';\n  box-shadow: rgba(0, 0, 0, 0.08) 0 0 4px;\n}\n.lake-diagram-board-contextual-vertical-separator {\n  width: 1px;\n  height: 60%;\n  margin: 0 6px;\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-contextual-vertical-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n");var hC=["diagram","custom","boardWebProxy"];function pC(e,t,n){var r=n;if(e.length>0)if((r=e.map((function(e){return t.split(".").reduce((function(e,t){return e?e.isCell&&e.get(t)||e[t]:e}),e)}))).every((function(e){return e===r[0]})))r=r[0];else{if(!r.every((function(e){return"number"==typeof e})))return"multiValue";r.sort(),r=r[r.length-1]}return r}var mC=function(e){var t=e.diagram,n=e.custom;e.boardWebProxy;var r=Ge()(e,hC),a=Object(Ne.useCallback)((function(e,n,r){t.command.execute("Update",{id:r,model:jt(e,n),autoSelect:!1})}),[t]);switch(e.type){case"separator":default:return Ie.a.createElement("div",{className:"lake-diagram-board-contextual-vertical-separator"});case"custom":return Ie.a.createElement(n,De()({diagram:t,get:pC,execCommand:a},r))}};mC.propTypes={type:_e.a.string,curr:_e.a.string,custom:_e.a.func,diagram:_e.a.object};function yC(e){var t=e.diagram,n=e.onProperties,r=e.mini,a=e.boardWebProxy,i=Object(Ne.useState)(null),o=b()(i,2),c=o[0],l=o[1],s=Object(Ne.useState)(null),u=b()(s,2),d=u[0],f=u[1],h=Object(Ne.useState)(null),p=b()(h,2),m=p[0],y=p[1],v=Object(Ne.useState)(0),g=b()(v,2),x=g[0],k=g[1],w=Object(Ne.useState)(0),C=b()(w,2),A=C[0],O=C[1],E=Object(Ne.useState)(!0),P=b()(E,2),S=P[0];P[1];var j=t.contentEditor;function R(){return function(e,t,n){var r=e.length,a=[];if(0===r)return[];if(function(e){return e.every((function(t){return t.type===e[0].type}))}(e))switch(e[0].type){case"line":a=[{name:"contextual-line-style",type:"custom",title:zn("线条样式"),custom:Bw},sC(),{name:"contextual-line-source",type:"custom",title:zn("起点"),custom:function(e){return Ie.a.createElement(jw,De()({},e,{type:"source"}))}},{name:"contextual-line-swap-endpoint",type:"custom",title:zn("转换"),custom:Dw},{name:"contextual-line-target",type:"custom",title:zn("终点"),custom:function(e){return Ie.a.createElement(jw,De()({},e,{type:"target"}))}},sC(),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Iw},sC(!0),lC];break;case"mindmap":a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[{name:"contextual-mindmap-layout",type:"custom",title:zn("结构"),custom:Fw,disabled:function(e){return e.selector.selections.some((function(e){return e.isAbstract}))}},{name:"contextual-mindmap-tree-edge",type:"custom",title:zn("分支"),custom:Qw,disabled:!1},sC(),{name:"contextual-mindmap-shape",type:"custom",title:zn("节点形状"),custom:qw,disabled:!1},{name:"contextual-mindmap-fill",type:"custom",title:zn("节点填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-mindmap-stroke",type:"custom",title:zn("节点描边"),custom:Xw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canStroke()})).length}},sC(),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Ww,disabled:!1},{name:"add-icon",type:"custom",title:zn("添加标记"),custom:cC,disabled:!1},{name:"add-link",type:"custom",custom:ow,title:zn("插入链接"),disabled:!1}];return e&&t.push(sC(),{name:"add-abstract",type:"custom",title:zn("添加概要"),custom:Tw,disabled:!1}),t.concat([sC(!0),lC])}(gy(e,!0));break;case"text":a=uC(e);break;case"geometry":a=[{name:"contextual-geometry-shape",type:"custom",custom:kw,title:zn("图形"),disabled:!1},sC(),{name:"contextual-geometry-fill-color",type:"custom",title:zn("填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:zn("描边"),disabled:!1,custom:Ow},sC(),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Pw,disabled:!1},{name:"add-link",type:"custom",custom:ow,title:zn("插入链接"),hotkey:U.ua.macos?"⌘+K":"Ctrl+K"},sC(!0),lC];break;case"group":a=1===e.length?[{name:"ungroup",type:"custom",custom:tC,title:zn("取消成组")},sC(!0),lC]:[];break;case"stack":case"pen":a=[{name:"contextual-geometry-fill-color",type:"custom",title:zn("填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:zn("描边"),disabled:!1,custom:Ow},sC(!0),lC];break;case"swimlane":a=Sn(e[0])?[{name:"contextual-swimlane-lane-number",type:"custom",title:zn("泳道数"),custom:rC,disabled:function(e){var t=e.selector.selections;return!(1===t.length&&Sn(t[0]))}},sC(!0),{name:"contextual-geometry-fill-color",type:"custom",title:zn("填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:zn("描边"),disabled:!1,custom:Ow},sC(!0),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Pw,disabled:!1},sC(!0),lC]:[{name:"contextual-swimlane-lane-number",type:"custom",title:zn("泳道数"),custom:rC,disabled:function(e){var t=e.selector.selections;return t.some((function(e){return e.swimlane!==t[0].swimlane}))}},sC(!0),{name:"contextual-geometry-fill-color",type:"custom",title:zn("填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},sC(!0),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Pw,disabled:!1},{name:"add-link",type:"custom",custom:ow,title:zn("插入链接"),disabled:!1},sC(!0),{name:"delete-lane",type:"custom",custom:nC,title:zn("删除泳道"),disabled:!1},sC(!0),lC];break;case"freehand":a=[{name:"contextual-geometry-stroke-color",type:"custom",title:zn("描边"),disabled:!1,custom:Ow},sC(!0),lC];break;case"dsl":a=wn(e[0])?[{name:"contextual-geometry-fill-color",type:"custom",title:zn("填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:zn("描边"),disabled:!1,custom:Ow},sC(!0),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Pw,disabled:!1},sC(!0),{name:"enter-dsl-edit",type:"custom",title:zn("编辑"),disabled:!1,custom:cw},sC(!0),lC]:[{name:"contextual-geometry-fill-color",type:"custom",title:zn("填充"),custom:bw,disabled:function(e){return 0===e.selector.selections.filter((function(e){return e.canFill()})).length}},sC(!0),{name:"font-style",type:"custom",title:zn("文字样式"),custom:Pw,disabled:!1},sC(!0),{name:"enter-dsl-edit",type:"custom",title:zn("编辑"),disabled:!1,custom:cw},sC(!0),lC];break;default:a=[]}if(e.filter((function(e){return e.isStem})).length>1){var i,o=0===a.length?[].concat(D()(dC()),[lC]):dC();(i=a).splice.apply(i,[a.length-1,0].concat(D()(o)))}return e.some((function(e){return"UML"===e.category}))&&0===a.findIndex((function(e){return"contextual-geometry-shape"===e.name}))&&a.splice(0,2),1===e.length&&Mn(e[0])&&(a=uC()),r>1&&(a=a.filter((function(e){return"add-link"!==e.name}))),(a=a.filter((function(t){return!(n&&t.noMini||("function"==typeof t.disabled?t.disabled(e[0].diagram):t.disabled))}))).forEach((function(e){"properties"===e.name&&(e.onProperties=t)})),a}(t.selector.selections,n,r)}Object(Ne.useEffect)((function(){var e=function(){if(t.signal.addVertexPanelVisibility)return l(null),void f(null);var e=t.selector.selections,n=R();e&&l(n),1===n.length||n.length>1&&!t.signal.mouseMultiSelecting?function(e){f(null);var n=function(e,t){var n=Tn(e,(function(e){if(En(e)){var t=e.getKeyShapeBox();if(e.isAbstract){var n=Tn(e.abstractCoveredCellsWithAllChildren,(function(e){return e.getKeyShapeBox()}));t.minY=Math.min(n.minY,t.minY),t.maxY=Math.max(n.maxY,t.maxY)}return function(e){var t=e.minX,n=e.minY;return{x:t,y:n,width:e.maxX-t,height:e.maxY-n}}(t)}return xn(e)?e.getPointBox():e.getBBox()})),r=n.minX,a=n.minY,i=n.maxX,o=n.maxY,c=t.viewport.convertViewport([r,a]),l=t.viewport.convertViewport([i,o]),s=l[0]-c[0],u=l[1]-c[1];return{x:c[0],y:c[1],width:s,height:u}}(e,t),r=n.x,a=n.y,i=n.width,o=n.height;k(o),O(i),f([r,a])}(e):f(null)},n=function(){l(null),f(null)},r=ye()(n,24),a=ye()((function(){e()}),20),i=ye()((function(){if(!(t.signal.buttonDragCanvas||t.signal.dragging||t.signal.vertexResizing)){var n=t.selector.selections;1!==n.length||n[0].isPen||n[0].isFreehand||n[0].isGroup||c||e()}}),28),o=ye()((function(){var e=R();l(e)}),16),s=function(){var e=t.viewport.invertViewport([0,0]);m&&Ji(m[0],e[0],1)&&Ji(m[1],e[1],1)||(l(null),f(null),y(e),a())},u=function(e){e.isModelChange&&o()},d=function(){y(t.viewport.invertViewport([0,0]))};return t.on("afterselect",a),t.on("keydown",r),t.on("mousemove",i),t.on("cell:dragstart",n),t.on("vertexresizestart",n),t.on("groupresizestart",n),t.on("abstadjuststart",n),t.on("endpointcontrolpointmousedown",n),t.on("addlinebuttonmousedown",n),t.on("aftercommandexecute",u),t.on("afterviewportchange",s),t.on("afterimport",d),j.on("textareaKeydown",r),function(){t.off("afterselect",a),t.off("keydown",r),t.off("mousemove",i),t.off("cell:dragstart",n),t.off("vertexresizestart",n),t.off("groupresizestart",n),t.off("abstadjuststart",n),t.off("endpointcontrolpointmousedown",n),t.off("addlinebuttonmousedown",n),t.off("aftercommandexecute",u),t.off("afterviewportchange",s),t.off("afterimport",d),j.off("textareaKeydown",r)}}),[t,c,m,S]);var M=Ie.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar"},c&&c.map((function(e,n){return Ie.a.createElement(mC,De()({key:n,diagram:t,boardWebProxy:a,selections:t.selector.selections},e))})));return Ie.a.createElement("div",{"data-testid":"board-contextual-toolbar"},Ie.a.createElement(fC,{height:x,width:A,content:M,visible:!0,overlayClassName:"lake-diagram-board-contextual-toolbar-popover",diagram:t,coord:d}))}yC.propTypes={className:_e.a.string,position:_e.a.string,items:_e.a.array,domContainer:_e.a.object,title:_e.a.node,extra:_e.a.node,execCommand:_e.a.func,diagram:_e.a.object,onProperties:_e.a.func,mini:_e.a.bool,boardWebProxy:_e.a.object};function vC(e,t){var n={},r=[],a=[];return e.forEach((function(e){var t=e.category;e.cover||(e.cover="https://gw.alipayobjects.com/zos/bmw-prod/8681f102-cc41-4685-b75a-faadb0af0a61.svg"),"personal"===t?r.push(e):"official"===t&&a.push(e),t&&!n[t]&&(n[t]=!0)})),{personalData:r.splice(0,t),officialData:a.splice(0,t)}}rt(".lake-diagram-scroll-tabs-container {\n  background-color: var(--yq-bg-primary);\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container {\n  overflow: scroll;\n  position: relative;\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-wrap {\n  padding-left: 0 !important;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav::before {\n  display: none;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab:first-child {\n  margin-left: 0;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab {\n  padding: 0;\n  margin-left: 8px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab a {\n  display: block;\n  color: var(--yq-yuque-grey-8);\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.57;\n  height: 32px;\n  border-radius: 6px;\n  padding: 5px 16px 27px 16px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab a:hover {\n  background-color: var(--yq-bg-primary-hover);\n  color: var(--yq-text-primary);\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab-active a {\n  color: var(--yq-text-primary);\n  font-weight: 500;\n  background-color: var(--yq-bg-primary-hover);\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-ink-bar {\n  display: none;\n}\n");var gC=Ze.a.TabPane;function bC(e){var t=e.tabs,n=void 0===t?[]:t,r=e.InnerRCNode,a=e.className,i=e.scrollToName;if(0===n.length||!r)return Ie.a.createElement("div",null);var o=Object(Ne.useRef)(null),c=Object(Ne.useRef)(null),l=Object(Ne.useState)(n[0].name),s=b()(l,2),u=s[0],d=s[1];return Object(Ne.useEffect)((function(){var e,t=o.current;if(t){var r,a=n.map((function(e){var n=t.querySelector("[data-lake-tab-scroll=".concat(e.name,"]"));return n?n.offsetTop:0}));e=pe()((function(e){for(var t=e.target.scrollTop,r=a.length-1;r>0&&!(t>a[r]-48);r--);d((function(e){var t=n[r].name;return e!==t?t:e}))}),16),null===(r=o.current)||void 0===r||r.addEventListener("scroll",e)}return function(){var t;return e&&(null===(t=o.current)||void 0===t?void 0:t.removeEventListener("scroll",e))}}),[n]),Object(Ne.useEffect)((function(){if(i&&o&&o.current){var e,t=o.current.querySelector('[data-lake-tab-scroll="'.concat(i,'"]'));t&&1===t.nodeType&&(null===(e=o.current)||void 0===e||e.scrollTo(0,t.offsetTop))}}),[i]),Object(Ne.useEffect)((function(){c.current&&Array.from(c.current.querySelectorAll(".ant-tabs-tab")).forEach((function(e,t){0!==t&&1===e.nodeType&&(e.style.marginLeft="16px")}))}),[]),Ie.a.createElement("div",{className:"lake-diagram-scroll-tabs-container ".concat(a)},Ie.a.createElement(Ze.a,{animated:!1,onChange:function(e){var t=o.current;if(t){var n,r=t.querySelector('[data-lake-tab-scroll="'.concat(e,'"]'));r&&1===r.nodeType&&(null===(n=o.current)||void 0===n||n.scrollTo(0,r.offsetTop))}},activeKey:u,onTabClick:function(e){d(e)}},n.map((function(e){return Ie.a.createElement(gC,{tab:Ie.a.createElement("a",null,e.title),key:e.name})}))),Ie.a.createElement("div",{ref:o,className:"lake-diagram-scroll-tabs-inner-container"},r))}rt(".lake-board-material-lib-container {\n  text-align: left;\n  position: relative;\n  display: inline-block;\n  height: 560px;\n  width: 762px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n}\n.lake-board-material-lib-container .lake-board-material-lib-close {\n  border-radius: 2px;\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/3ee0285f-a1ad-4051-82a6-89e802514ef4.svg);\n  background-position: center;\n  background-repeat: no-repeat;\n  top: 8px;\n  right: 14px;\n}\n.lake-board-material-lib-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-wrap {\n  padding-left: 24px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container {\n  padding-left: 24px;\n  height: 498px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container .lake-diagram-scroll-tabs-inner-container {\n  height: 450px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container .lake-board-material-lib-scroll-inner-container {\n  width: 762px;\n}\n.lake-board-material-lib-container .lake-board-personal-material-tab-pane-container {\n  padding-left: 24px;\n}\n.lake-board-material-lib-container .lake-board-personal-material-tab-pane-container .lake-board-material-lib-item-pane-container {\n  height: 498px;\n  overflow-y: scroll;\n}\n.lake-board-material-lib-container .lake-board-material-lib-close:hover {\n  background-color: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty {\n  width: 400px;\n  color: var(--yq-text-body);\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  margin: auto;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty .lake-board-material-lib-personal-empty-tips-h1 {\n  font-size: 18px;\n  margin: 24px 0;\n  font-weight: bold;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty p {\n  font-size: 14px;\n  margin-bottom: 8px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty img {\n  margin-top: 16px;\n  opacity: 0.5;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item {\n  position: relative;\n  margin-right: 24px;\n  margin-bottom: 24px;\n  font-size: 14px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-title {\n  height: 54px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-left: 16px;\n  border-top: 1px solid var(--yq-border-primary);\n  font-weight: bold;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-cover {\n  width: 220px;\n  height: 142px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n  border-radius: 4px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control {\n  padding: 16px;\n  display: none;\n  background-color: rgba(250, 250, 250, 0.9);\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  border-radius: 4px;\n}\n[data-kumuhana='pouli'] .lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control {\n  background-color: rgba(20, 20, 20, 0.9);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-button {\n  position: absolute;\n  width: calc(100% - 32px);\n  bottom: 16px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-title {\n  height: 14px;\n  font-weight: bold;\n  margin-bottom: 12px;\n  display: flex;\n  align-items: center;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-description {\n  height: 90px;\n  margin-bottom: 24px;\n  overflow: hidden;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete {\n  position: absolute;\n  width: 16px;\n  height: 16px;\n  top: 16px;\n  right: 16px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/0b88a90e-d1fd-4e14-b74d-dc5355e9de8d.svg);\n}\n[data-kumuhana='pouli'] .lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete {\n  filter: invert(100%);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete:hover {\n  cursor: pointer;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-href {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-left: 4px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/712ccc64-9efb-4889-89d0-3531ff478a22.svg);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item:hover .lake-board-material-lib-item-control {\n  display: block;\n}\n");var xC=Ze.a.TabPane,kC=[{name:"official",title:zn("推荐素材")},{name:"personal",title:zn("自定义素材")}],wC=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ie.a.createElement("div",null),a=arguments.length>4?arguments[4]:void 0;return Ie.a.createElement("div",{className:"lake-board-material-lib-item-pane-container","data-lake-tab-scroll":e},(null==n?void 0:n.length)>0?Ie.a.createElement("div",{className:"lake-board-material-lib-item-container"},n.map((function(e,t){return function(e,t,n){var r=e.id,a=e.cover,i=e.doclet_id,o=e.title;return Ie.a.createElement("div",{className:"lake-board-material-lib-item",key:r,"data-testid":"material-lib-item-doclet-id-".concat(i),"data-lake-tab-scroll":r},Ie.a.createElement("div",{className:"lake-board-material-lib-item-cover",style:{backgroundImage:"url(".concat(a,")")}}),o&&Ie.a.createElement("div",{className:"lake-board-material-lib-item-title"},Ie.a.createElement("span",null,o)),Ie.a.createElement("div",{className:"lake-board-material-lib-item-control"},function(e,t){var n=e.title,r=e.href,a=e.description,i=e.category,o=e.id;return Ie.a.createElement("div",null,Ie.a.createElement("div",{className:"lake-board-material-lib-item-use-control-title"},n,r&&Ie.a.createElement("a",{target:"_blank",className:"lake-board-material-lib-item-use-control-href",href:r})),a&&Ie.a.createElement("div",{className:"lake-board-material-lib-item-use-control-description"},a),"personal"===i&&Ie.a.createElement("div",{onClick:function(e){e.target.closest(".lake-board-material-lib-item").style.display="none",null==t||t.onDelete(o)},className:"lake-board-material-lib-item-use-control-delete"}),Ie.a.createElement(Ye.a,{onClick:function(){t.onUse(e)},className:"lake-board-material-lib-item-use-control-button",block:!0},zn("使用")))}(e,n)))}(e,0,a)}))):r)},CC=function(e,t){var n=e.map((function(e){return wC(e.group_id,e.group,e.data,Ie.a.createElement("div",null),t)}));return Ie.a.createElement("div",{className:"lake-board-material-lib-scroll-inner-container"},n)},AC=Object.freeze({__proto__:null,ZoomTool:Eb,Toolbar:bx,ContextMenu:Wx,Properties:aw,ContextualMenu:yC,MaterialLibMaxi:function(e){var t=e.scrollToName,n=function(e,t){var n=e.boardWebProxy,r=e.diagram,a=e.forceUpdate,i=Object(Ne.useState)(null),o=b()(i,2),c=o[0],l=o[1],s=function(){var e=G()(V.a.mark((function e(){var a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.destroyed&&n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.material["find".concat(t)]();case 4:a=e.sent,l(vC(a,100));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var t=G()(V.a.mark((function t(a){var i,o,c,l,s,u,d,f,h,p,m,y,v;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.destroyed&&n){t.next=2;break}return t.abrupt("return");case 2:return i=n.spm,o=a.id,c=a.category,t.next=6,n.material.use(o);case 6:if(l=t.sent){t.next=9;break}return t.abrupt("return");case 9:s=l.diagramData,u=l.graphicsBBox,s&&(d=s.body,f=s.head,di(d),h=u||(null==f?void 0:f.bbox)||r.modelManager.bbox(d),p=r.viewport.getCenter(),"number"==typeof(g=h).x&&"number"!=typeof g.minX&&(g.minX=g.x,g.maxX=g.x+g.width),"number"==typeof g.y&&"number"!=typeof g.minY&&(g.minY=g.y,g.maxY=g.y+g.height),m=p[0]-h.minX-h.width/2,y=p[1]-h.minY-h.height/2,r.modelManager.translate(d,m,y),r.hooks.forceDecorateImportModels.call(d),r.command.execute("Add",{model:d}),i&&(v={material_id:a.id},"personal"===c?i.click("b4693.c107432.d223038",v):i.click("b4693.c107432.d223037",v)),e.onUse&&e.onUse());case 11:case"end":return t.stop()}var g}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(Ne.useEffect)((function(){s()}),[r,a]),{state:{data:c,maxCount:100},onUse:u,onMore:function(t){e.onMore&&e.onMore(t)},onDelete:function(t){n.material.destroy(t),e.onDelete&&e.onDelete(t)},onClose:function(){e.onClose&&e.onClose()}}}(e,"Maxi"),r=n.state.data,a=kC[0].name,i=Object(Ne.useState)(a),o=b()(i,2),c=o[0],l=o[1];if(Object(Ne.useEffect)((function(){t&&l(t)}),[t]),!r)return Ie.a.createElement("div",null);var s=r.personalData,u=r.officialData,d=function(e){return!!Array.isArray(e)&&e.every((function(e){return e.hasOwnProperty("group")&&e.hasOwnProperty("group_id")}))}(u)?u.reduce((function(e,t){var n=t.group,r=t.group_id;return e[r]||(e[r]={group_id:r,group:n,data:[]}),e[r].data.push(t),e}),{}):{},f=["Hot","team","Design","Technology","Mind"];Object.keys(d).length>f.length&&Object.keys(d).filter((function(e){return!f.includes(e)})).forEach((function(e){f.push(e)}));var h=Object.keys(d).length?f.map((function(e){return d[e]})):[],p=h.map((function(e){return{name:e.group_id,title:zn(e.group)}}));return Ie.a.createElement("div",{className:"lake-board-material-lib-container"},Ie.a.createElement(Ze.a,{animated:!1,defaultActiveKey:c,onTabClick:function(e){l(e)}},Ie.a.createElement(xC,{tab:kC[0].title,key:kC[0].name},Ie.a.createElement(bC,{tabs:p,className:"lake-board-material-lib-scroll-container",InnerRCNode:CC(h,n)})),Ie.a.createElement(xC,{tab:kC[1].title,key:kC[1].name},Ie.a.createElement("div",{className:"lake-board-personal-material-tab-pane-container"},wC(kC[1].name,kC[1].title,s,Ie.a.createElement("div",{className:"lake-board-material-lib-personal-empty","data-testid":"material-lib-personal-empty"},Ie.a.createElement("h1",{className:"lake-board-material-lib-personal-empty-tips-h1"},zn("添加自定义素材")),Ie.a.createElement("p",null," ",zn("步骤一：框选需要添加的内容")),Ie.a.createElement("p",null," ",zn("步骤二：右键打开面板，选择“添加到素材库”")),Ie.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/bmw-prod/5f652093-571b-4c7c-bd3f-fd81ff7fe2e1.svg"})),n)))),Ie.a.createElement("div",{className:"lake-board-material-lib-close","data-testid":"material-lib-close",onClick:function(){n.onClose()}}))}}),OC=Object.freeze({__proto__:null});function EC(e){var t,n=e.diagram,r=e.readonly,a=Object(Ne.useState)(null),i=b()(a,2),o=i[0],c=i[1],l=Object(Ne.useState)(""),s=b()(l,2),u=s[0],d=s[1],f=Object(Ne.useState)(null),h=b()(f,2),p=h[0],m=h[1],y=Object(Ne.useRef)();return Object(Ne.useEffect)((function(){function e(e){var t=e.cell,n=t.getKeyShape().getBoundingClientRect();c(null),c([n.x+n.width,n.y+n.height/2]),m(t),d(t.note.content)}return n.on("opennote",e),function(){n.off("opennote",e)}}),[n,o,c,m,u]),Object(Ne.useEffect)((function(){setTimeout((function(){var e=document.querySelector("textarea.lake-diagram-note-area");if(e){var t=e.value.length;e.focus(),e.setSelectionRange(t,t)}}),16)}),[o,y.current,p]),t=r?Ie.a.createElement("div",{className:"lake-diagram-note-area"},u):Ie.a.createElement("textarea",{className:"lake-diagram-note-area",value:u,onChange:function(e){var t=e.target.value;d(t)},ref:y}),Ie.a.createElement(Cx,{placement:"right",content:t,visible:!0,overlayClassName:"lake-diagram-note-popover",diagram:n,coord:o,onClose:function(){o&&p&&(m(null),c(null),p.note.content!==u&&n.command.execute("Update",{id:p,model:{note:u?{content:u}:null}}))}})}function PC(e){return Ie.a.createElement(EC,e)}function SC(e){return Ie.a.createElement(EC,De()({},e,{readonly:!0}))}rt("/* stylelint-disable */\n.lake-diagram-note-popover {\n  z-index: 1033;\n}\n.lake-diagram-note-popover .lake-diagram-note-area {\n  font-size: 12px;\n  border: none;\n  resize: none;\n  outline: none;\n  box-shadow: none;\n  width: 294px;\n  height: 128px;\n  padding: 16px 18px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  word-break: break-word;\n  white-space: pre-wrap;\n}\n"),EC.defaultProps={diagram:null,readonly:!1},EC.propTypes={diagram:_e.a.object,readonly:_e.a.bool},PC.defaultProps={diagram:null},PC.propTypes={diagram:_e.a.object},SC.defaultProps={diagram:null},SC.propTypes={diagram:_e.a.object};var jC=Object.freeze({__proto__:null,Editor:PC,Reader:SC});function RC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RC(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}rt("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-mindmap-icons-change-overlay .ant-popover-inner {\n  border: 0;\n  background: none;\n  box-shadow: none;\n}\n.lake-diagram-mindmap-icons-change {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-yuque-grey-4);\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 13px;\n  display: flex;\n  align-items: center;\n}\n.lake-diagram-mindmap-icons-change .icon-btn {\n  border: none;\n  background: none;\n  padding: 2px 2px;\n  height: 26px;\n  width: 26px;\n  margin: 3px 8px 3px 0;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  display: block;\n}\n.lake-diagram-mindmap-icons-change .icon-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-mindmap-icons-change .icon-btn:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-mindmap-icons-change .icon-btn:hover {\n  background: rgba(226, 226, 226, 0.15);\n}\n.lake-diagram-mindmap-icons-change .icon-btn:focus {\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-change .icon-btn::after {\n  display: none;\n}\n.lake-diagram-mindmap-icons-change .icon-btn.active {\n  background: var(--yq-yuque-grey-4);\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-change .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n  padding: 2px 2px;\n  margin: 3px 0;\n  display: inline-block;\n  cursor: pointer;\n  border-radius: 6px;\n}\n.lake-diagram-mindmap-icons-change .lake-icon:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-mindmap-icons-change .lake-diagram-icon-change-vertical-separator {\n  width: 1px;\n  height: 28px;\n  margin: 0 14px 0 6px;\n  background: var(--yq-border-primary);\n  display: inline-block;\n}\n"),rt(".lake-diagram-dsl-editor-container {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 8px;\n  background-color: white;\n  min-width: 300px;\n  min-height: 120px;\n  display: flex;\n  flex-direction: column;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container {\n  padding-top: 12px;\n  padding-left: 10px;\n  padding-right: 10px;\n  flex: 1 0 40px;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container .lake-diagram-dsl-editor-textarea {\n  border: none;\n  resize: none;\n  outline: none;\n  box-shadow: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n  word-break: break-word;\n  white-space: pre-wrap;\n  width: 100%;\n  height: 100%;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container .lake-diagram-dsl-editor-textarea > div {\n  display: flex;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper {\n  display: flex;\n  font-size: 12px;\n  justify-content: space-between;\n  height: 40px;\n  min-height: 40px;\n  background: transparent;\n  border-top: 1px solid var(--yq-border-primary);\n  line-height: 24px;\n  padding: 8px 8px;\n  text-align: left;\n  text-indent: 0;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper a {\n  font-size: 12px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper .larkui-icon {\n  margin-right: 6px;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper button {\n  width: 40px;\n  height: 24px;\n  text-align: center;\n  line-height: 24px;\n  background-color: var(--yq-theme);\n  color: white;\n  font-size: 12px;\n  border: none;\n  padding: 0;\n  border-radius: 4px;\n  cursor: pointer;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper a:hover {\n  color: var(--yq-text-body);\n}\n");var LC=!1,BC=Object.freeze({__proto__:null,Properties:kb,Note:jC,Toolbar:nb,LinkEditor:ob,ShapeOverlay:lb,Dropdown:Jg,ZoomTool:pb,ContextMenu:OC,Board:AC,ToolbarShapeOverlay:fb,IconChange:function(e){var t=e.diagram;e.readonly;var n=e.className,r=Object(Ne.useState)(),a=b()(r,2),i=a[0],o=a[1],l=Object(Ne.useState)(),s=b()(l,2),u=s[0],d=s[1],f=Object(Ne.useState)(),h=b()(f,2),p=h[0],m=h[1];Object(Ne.useEffect)((function(){function e(e){var t=e.cell,n=e.key,r=e.nativeEvent;if(t&&n){var a=r.target,i=a.getBoundingClientRect();o(void 0),o([i.x+i.width,i.y+i.height]),d(t),m(a)}}return t.on("changemindmapicon",e),function(){t.off("changemindmapicon",e)}}),[t,i,o,d]);var y=Object(Ne.useMemo)((function(){var e=null==p?void 0:p.getAttribute("lake-mindmap-icon-key"),r=Xn.findIndex((function(t){return t===e}));if(e&&r>-1){var a=Wn[r];return Ie.a.createElement("div",{className:ze()("lake-diagram-mindmap-icons-change",n),"data-lake_prevent_click_unselect":"true"},le()(a).map((function(n){return Ie.a.createElement("img",{className:"icon-btn",key:e+n,src:Un(e,n),id:"change-icon-".concat(e,"-").concat(n),onClick:function(){var r=t.selector.selections.filter((function(e){return e.isMindmap}));t.command.execute("Update",{id:r.map((function(e){return e.model.id})),model:r.map((function(t){return{icons:MC(MC({},t.model.icons||{}),{},c()({},e,n))}}))})}})})),Ie.a.createElement("div",{className:"lake-diagram-icon-change-vertical-separator"}),Ie.a.createElement("span",{className:"lake-icon lake-icon-table-new-delete",onClick:function(){var n=t.selector.selections.filter((function(e){return e.isMindmap}));t.command.execute("Update",{id:n.map((function(e){return e.model.id})),model:n.map((function(t){return{icons:MC(MC({},t.model.icons||{}),{},c()({},e,null))}}))})}}))}return[]}),[null==p?void 0:p.getAttribute("lake-mindmap-icon-key")]);return Ie.a.createElement(Cx,{placement:"bottom",content:y,style:{borderRadius:"8px"},visible:!0,overlayClassName:"lake-diagram-mindmap-icons-change-overlay",diagram:t,coord:i,onClose:function(){i&&u&&(d(void 0),o(void 0),p&&(p.dataset.lakeMindmapIconSelected="false"))}})},DslEditor:function(e){var t=e.diagram,n=Object(Ne.useState)(""),a=b()(n,2),i=a[0],o=a[1],c=Object(Ne.useState)(null),l=b()(c,2),s=l[0],u=l[1],d=Object(Ne.useState)([0,0]),f=b()(d,2),h=f[0],p=f[1],m=Object(Ne.useState)([0,0]),y=b()(m,2),v=y[0],g=y[1],x=Object(Ne.useRef)(null);Object(Ne.useEffect)((function(){var e=function(e){var n=e.cell;LC=!0,u(n),o(n.stencil.toText(n.htmls));var r=t.viewport.convertViewport([n.x,n.y]),a=b()(r,2),i=a[0],c=a[1];p([i,c]),g([n.width*t.viewport.zoom,n.height*t.viewport.zoom]),t.destroyed};return t.on("opendsleditor",e),function(){t.off("opendsleditor",e)}}),[t]);var k=function(){if(s){var e=s;LC=!1,u(null),[e].concat(D()(e.getChildren())).forEach((function(e){return e.show()})),i!==e.stencil.toText(e.htmls)&&t.command.execute("UpdateDslHtml",{dsl:e,htmls:e.stencil.toHtmls(i,e.htmls)}),t.selector.select(e)}};return Object(Ne.useEffect)((function(){if(x.current&&s){var e=function(e){"Enter"===e.key&&("stage"===s.shape||(r.ua.macos?e.metaKey:e.ctrlKey))&&(e.preventDefault(),LC&&k())};return x.current.addEventListener("keydown",e),window.addEventListener("mousedown",n),t.on("afterviewportchange",a),function(){var r;null===(r=x.current)||void 0===r||r.removeEventListener("keydown",e),window.removeEventListener("mousedown",n),t.off("afterviewportchange",a)}}function n(e){var t;null!==(t=e.target)&&void 0!==t&&t.closest(".lake-diagram-dsl-editor-container")||!LC||k()}function a(e){if(s){var n=t.viewport.convertViewport([s.x,s.y]),r=b()(n,2),a=r[0],i=r[1];p([a,i]),g([s.width*t.viewport.zoom,s.height*t.viewport.zoom])}}}),[s,i]),Ie.a.createElement("div",{className:"lake-diagram-dsl-editor-container",style:{position:"absolute",left:"".concat(h[0],"px"),top:"".concat(h[1],"px"),width:v[0]+5,height:v[1]+5,visibility:s?"initial":"hidden"},ref:x},Ie.a.createElement("div",{className:"lake-diagram-dsl-editor-textarea-container"},Ie.a.createElement("textarea",{className:"lake-diagram-dsl-editor-textarea",value:i,onChange:function(e){o(e.target.value)}})),Ie.a.createElement("div",{className:"lake-diagram-dsl-editor-helper"},Ie.a.createElement("a",{href:"https://www.yuque.com/yuque/wknab3/af4k4xq4ma35qvv2",target:"_blank"},Ie.a.createElement("span",{className:"lake-icon lake-icon-board-question"})),Ie.a.createElement("button",{onClick:k},Ie.a.createElement(qe.a,{title:Ie.a.createElement("p",{style:{textAlign:"center"}},r.ua.macos?"Cmd":"Ctrl","+Enter"),placement:"bottom"},zn("确定")))))}}),DC=new r.MessageManager;function NC(e){return IC.apply(this,arguments)}function IC(){return IC=G()(V.a.mark((function e(t){var n,a,i,o,c,l,s,u,d,f,h,p,m,y;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,i=t.uploader,o=t.enable,c=t.onTemporaryOnLoad,l=t.onCompleted,a){e.next=3;break}return e.abrupt("return");case 3:if(r.FileUtils.isImage(a)){e.next=5;break}return e.abrupt("return");case 5:if(!o||o()){e.next=7;break}return e.abrupt("return");case 7:if(!a.size){e.next=12;break}if(null===(s=r.FileSizeChecker.check("image",a.size))){e.next=12;break}return s.callback(DC.show(s.level,s.msg,!s.alwaysOpen)),e.abrupt("return");case 12:return e.next=14,jx(a);case 14:if(u=e.sent,d=(null===(n=Sx(u))||void 0===n?void 0:n.cdn)||URL.createObjectURL(a),f=new Image,h={src:d,naturalWidth:void 0,naturalHeight:void 0,uploadInfo:{hash:u,fileName:a.name,fileType:a.type,fileSize:a.size,localTempSrc:d,state:0}},f.onload=function(){Object.assign(h,{naturalWidth:f.naturalWidth,naturalHeight:f.naturalHeight}),c&&c(h)},f.src=d,"string"!=typeof d||!d.startsWith("blob:")){e.next=32;break}return p=i.image(a),Px(u,m={imageCdnPromise:p}),e.next=26,p;case 26:if(y=e.sent){e.next=30;break}return h.uploadInfo.state=-1,e.abrupt("return",h);case 30:m.cdn=y,l&&l({hash:u,cdn:y});case 32:return e.abrupt("return",h);case 33:case"end":return e.stop()}}),e)}))),IC.apply(this,arguments)}function TC(e){if(e.image&&e.image.uploadInfo&&e.image.uploadInfo.hash){var t,n=null===(t=Sx(e.image.uploadInfo.hash))||void 0===t?void 0:t.cdn;n?(e.image.src=n,e.image.uploadInfo.state=2):e.image.uploadInfo.state=-2}}function _C(e){e.body.forEach((function(e){at(e,(function(e){TC(e)}))}))}function FC(e){return zC.apply(this,arguments)}function zC(){return zC=G()(V.a.mark((function e(t){var n,r,a,i,o,c,l,s,u,d,f;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.model,r=t.diagram,a=t.uploader,n){e.next=3;break}return e.abrupt("return");case 3:if((i=n.image||n.sourceImage)&&i.src){e.next=6;break}return e.abrupt("return");case 6:if(o=n.id,c=i.src,l=i.uploadInfo,!c.startsWith("blob:")){e.next=24;break}return e.prev=10,e.next=13,fetch(c).then((function(e){return e.blob()}));case 13:return s=e.sent,u=new File([s],l&&"".concat(i.uploadInfo.fileName)),e.next=17,NC({file:u,uploader:a});case 17:d=e.sent,r&&!r.destroyed&&(f=r.find(o))&&f.updateModel({image:d}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),console.warn("Failed to save image when importing, src: ".concat(c));case 24:case"end":return e.stop()}}),e,null,[[10,21]])}))),zC.apply(this,arguments)}function qC(e){return e.command.enable("Collapse")?e.command.execute("Collapse"):e.command.enable("Expand")?e.command.execute("Expand"):void 0}function YC(e){return e.command.enable("Collapse")||e.command.enable("Expand")}function HC(e){return e.command.enable("Expand")}function GC(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"curve-arrow").split("-"),n=b()(t,2),r=n[0],a=n[1],i=e.selector.selections;if(2===i.length&&i.every((function(e){return e.isMindmap}))){var o=e.add([{type:"line",source:{id:i[0].model.id},target:{id:i[1].model.id}}]),c=o[0].getPointAtPercent(.5);return e.remove(o),e.command.execute("Add",{model:{type:"line",shape:r,source:{id:i[0].model.id},target:{id:i[1].model.id,marker:a},controlPoints:[[c.x,c.y]]}})}e.command.execute("BeginInsertLine",{shape:r,marker:a})}var XC=[{name:"save",title:zn("保存"),hotkey:U.ua.macos?"⌘+S":"Ctrl+S",icon:"save",disabled:!1,execCommand:function(){}},{name:"undo",title:zn("撤销"),hotkey:U.ua.macos?"⌘+Z":"Ctrl+Z",icon:"undo",disabled:function(e){return!e.command.enable("Undo")},execCommand:function(e){return e.command.execute("Undo")}},{name:"redo",title:zn("重做"),hotkey:U.ua.macos?"⌘+Shift+Z":"Ctrl+Shift+Z",icon:"redo",disabled:function(e){return!e.command.enable("Redo")},execCommand:function(e){return e.command.execute("Redo")}},{type:"separator"},{name:"beginInsertRoot",title:zn("插入主节点"),hotkey:(U.ua.macos,"Shift+Enter"),icon:"insert-root",disabled:function(e){return!e.command.enable("MindmapBeginInsertStem")},execCommand:function(e){return e.command.execute("MindmapBeginInsertStem")}},{name:"append",title:zn("插入同级"),hotkey:"Enter",icon:"insert-sibling",disabled:function(e){return!e.command.enable("MindmapAppendSibling")},execCommand:function(e){return e.command.execute("MindmapAppendSibling")}},{name:"appendChild",title:zn("插入子级"),hotkey:"Tab",icon:"insert-child",disabled:function(e){return!e.command.enable("MindmapAppendChild")},execCommand:function(e){return e.command.execute("MindmapAppendChild")}},{name:"insertLine",title:zn("线条"),hotkey:U.ua.macos?"⌘+L":"Ctrl+L",type:"dropdown",mode:"button",defaultKey:"curve-arrow",data:[{key:"curve",icon:"line-curve"},{key:"curve-arrow",icon:"line-curve-arrow"}],execCommand:function(e,t){return GC(e,t)}},{name:"insertNote",title:zn("备注"),icon:"diagram-toolbar-note",disabled:function(e){return!e.command.enable("MindmapOpenNote")},execCommand:function(e){return e.command.execute("MindmapOpenNote")}},{name:"createLink",title:zn("插入链接"),hotkey:U.ua.macos?"⌘+K":"Ctrl+K",icon:"link",disabled:function(e){return!e.command.enable("CreateLink")},execCommand:function(e){return e.command.execute("CreateLink")}},{name:"insertImage",title:zn("插入图片"),type:"upload",icon:"image",accept:U.EXTS.IMAGE_EXT.map((function(e){return"."+e})).join(","),disabled:function(e){return!e.command.enable("MindmapAttachImage")&&!e.command.enable("MindmapInsertImage")},onChange:function(){}},{type:"separator"},{name:"collapseExpand",title:zn("折叠"),hotkey:U.ua.macos?"⌘+/":"Ctrl+/",icon:"collapse-node",disabled:function(e){return!YC(e)},active:function(e){return HC(e)},execCommand:function(e){return qC(e)}}],VC=function(){function e(){m()(this,e),Object.assign(this,{format:"lakeboard",type:"Board",version:"1.0",diagramData:{head:{},body:[]},mode:"edit",viewportSetting:null,viewportOption:"adapt",text:"",graphicsBBox:null})}return v()(e,[{key:"get",value:function(e){return this[e]}},{key:"set",value:function(e,t){this[e]=t}},{key:"export",value:function(){var e=this;return Object.keys(this).reduce((function(t,n){return t[n]=e[n],t}),{})}}]),e}();function WC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ZC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WC(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var UC=Fn.locale,KC=new VC,QC=Object.freeze({__proto__:null,uploadImage:NC,onBeforeSave:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){if(e.destroyed)r();else if(t.isCompleted())r();else{var a,i=Date.now();!n&&ne.a.warning(zn("图片上传中，请稍候")),Promise.resolve().then((function e(){t.isCompleted()||Date.now()-i>=72e4?(a&&clearTimeout(a),r()):a=setTimeout(e,6e3)}))}}))},processImageModel:TC,processExportData:_C,exportData:function(e){var t=e.export();return _C(t),t},tryTransferBlobUrl:FC,importData:function(e){var t=e.diagram,n=e.data,r=e.uploader;if(n&&(n.body||n.head)&&t){if(t.import(n),r&&"edit"===t.interaction.currentMode){var a=[];return n.body.forEach((function(e){at(e,(function(e){a.push(FC({model:e,diagram:t,uploader:r}))}))})),a}return[]}},get map(){return Ex},cleanHashCache:function(){Ex={}},addHashCache:Px,getHashCache:Sx,generateHash:jx,executeCollapseExpand:qC,enableCollapseExpand:YC,collapseActive:HC,mindmapInsertLine:GC,mindToolbarConfigs:XC,uploadMindmapImage:function(e){var t=e.file,n=e.uploader,r=e.diagram,a=e.from;return new Promise((function(e){NC({file:t,uploader:n,enable:function(){return r.command.enable("MindmapAttachImage")||r.command.enable("MindmapInsertImage")},onTemporaryOnLoad:function(t){"clipboard"===a&&(t.firstInsertRatio=1/window.devicePixelRatio),0===r.selector.selections.length||"drop"===a?r.command.execute("MindmapInsertImage",{image:t}):1===r.selector.selections.length&&r.command.execute("MindmapAttachImage",{image:t}),e(t)}})}))},generateBoardWebProxy:function(e,t,n,a){var i,o;if(null==e||null===(i=e.templates)||void 0===i||!i.v2||!t)return null;var c,l,s,u,d,f=new r.Uploader({docId:t,docDomain:"User"});function h(){return p.apply(this,arguments)}function p(){return p=G()(V.a.mark((function t(){var n,r,a,i=arguments;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.templates.v2.find(ZC({include_types:"official",official_channel:"material_lib_board_config",format:"lakeboard"},n));case 3:return r=t.sent,t.next=6,e.templates.v2.find(ZC({include_types:"personal",scene:"material",format:"lakeboard"},n));case 6:return a=t.sent,t.abrupt("return",[].concat(D()(null==r?void 0:r.data.map((function(e){var t,n,a,i,o=null==r?void 0:r.meta,c=null==o?void 0:o.official,l={id:e.id,title:e.name,doclet_id:e.doclet_id,cover:e.cover,category:"official"};return null!=e&&null!==(t=e.meta)&&void 0!==t&&t.description&&(l.description=null==e||null===(a=e.meta)||void 0===a?void 0:a.description),null!=e&&null!==(n=e.meta)&&void 0!==n&&n.descriptionUrl&&(l.href=null==e||null===(i=e.meta)||void 0===i?void 0:i.descriptionUrl),c&&c.forEach((function(t){var n=t.id,r=t.name_en,a=t.name_zh;t.template_ids.includes(e.id)&&(l.group="zh-cn"!==UC?r:a,l.group_id=n)})),l}))),D()(null==a?void 0:a.data.map((function(e){return{id:e.id,doclet_id:e.doclet_id,cover:e.cover,category:"personal"}})))));case 8:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}return{iconfont:{disable:!(null==a||null===(o=a.settings)||void 0===o||!o.disable_iconfont),search:(d=G()(V.a.mark((function t(n){var r,a,i,o;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.keyword,a=n.page_size,i=n.page,t.prev=1,t.next=4,e.editor.iconfont({query:r,page_size:a,page:i});case 4:if(!(o=t.sent)){t.next=7;break}return t.abrupt("return",{data:o.icons.map((function(e){return{name:e.name,svg:e.show_svg.replace("currentColor","#666")}})),count:o.count});case 7:return t.abrupt("return",null);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),function(e){return d.apply(this,arguments)})},uploader:{image:(u=G()(V.a.mark((function e(){var t=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.image.apply(f,t));case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},material:{use:(s=G()(V.a.mark((function t(n){var r,a,i,o;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.templates.v2.useMaterial({template_id:n});case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:if(a=r.data){t.next=8;break}return t.abrupt("return",null);case 8:if(!(i=a.doclet.body)){t.next=12;break}return o=JSON.parse(i),t.abrupt("return",o);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)}))),function(e){return s.apply(this,arguments)}),destroy:(l=G()(V.a.mark((function t(n){return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.templates.v2.destroy({id:n});case 1:case"end":return t.stop()}}),t)}))),function(e){return l.apply(this,arguments)}),create:(c=G()(V.a.mark((function t(n){var r,a,i,o,c,l;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.cover,a=n.diagramData,i=n.graphicsBBox,t.prev=1,!r||!a){t.next=13;break}return KC.set("graphicsBBox",i),KC.set("diagramData",a),o=Date.now(),c=new Date(o),t.next=9,e.templates.v2.create({scene:"material",in_edit:!1,name:"用户自定义素材".concat(c.toLocaleDateString()),target_type:"User",format:"lakeboard",cover:r,template_type:3,type:"Board",body:JSON.stringify(KC.export())});case 9:if(l=t.sent){t.next=12;break}return t.abrupt("return");case 12:return t.abrupt("return",l);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[1,15]])}))),function(e){return c.apply(this,arguments)}),findMaxi:function(){return G()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h({limit:100}));case 1:case"end":return e.stop()}}),e)})))()},findMini:function(){return G()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h({limit:16}));case 1:case"end":return e.stop()}}),e)})))()}},spm:n}},Model:VC,MAXI_MAX_MATERIAL_COUNT:100,MINI_MAX_MATERIAL_COUNT:16,getMaterialCells:Bx,createMaterial:Dx})}}]);